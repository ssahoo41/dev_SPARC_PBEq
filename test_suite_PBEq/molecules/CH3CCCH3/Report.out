---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:28
Job ID:    2266947
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:37
Job ID:    2266947
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 34.980 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 8.136 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 72.288 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.893 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.115 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.446091	   14.644694	
    8.330198	    8.553909	   14.644694	
   11.669802	    8.553909	   14.644694	
   10.000000	   11.446091	    5.355306	
   11.669802	    8.553909	    5.355306	
    8.330198	    8.553909	    5.355306	
   10.000000	    9.517970	   11.137267	
   10.000000	    9.517970	    8.862733	
   10.000000	    9.517970	   13.889100	
   10.000000	    9.517970	    6.110900	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.204 ms
Set up communicators.

--set up spincomm took 2.228 ms

--set up kptcomm took 0.377 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.005 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.052 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.086 ms

Calculate_SplineDerivRadFun took 0.112 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.874 ms.
time spent on vectorized spline interp: 3.506 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.650 ms.
time spent on vectorized spline interp: 1.793 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.531 ms.

Calculating rb for all atom types took 12.362 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.071 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000265802, sum_int_rho = 21.3912789395205
PosCharge = 22.000000026580, NegCharge = -21.391278939521, scal_fac = 1.028456507382
After scaling, int_rho = 22.0000000265802, PosCharge + NegCharge - NetCharge = -6.040e-14
--Calculate Vref took 0.587 ms
--Calculate rho_guess took 3.950 ms

 integral of b = -22.0000000265802,
 int{b} + Nelectron + NetCharge = -2.658e-08,
 Esc = -50.1251901625570,
 MPI_Reduce took 2.679 ms

Calculating b & b_ref took 15.323 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.039 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.107 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.030 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.262 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.012 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.013 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.005 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.049 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 34.013 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658016, int_b + int_rho = -6.039e-13, checking this took 1.089 ms
2-norm of RHS = 732.2622917151108, which took 0.458 ms

iter_count = 420, r_2norm = 6.270e-04, tol*||rhs|| = 7.323e-04

Anderson update took 274.423 ms, out of which F'*F took 119.013 ms; b-Ax took 802.400 ms, out of which Lap took 715.205 ms
Solving Poisson took 1772.028 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.824 ms
Total time for convolution: 	 convolve: 5.109164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.373 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
Total time for convolution: 	 convolve: 5.131647 
Total time for convolution: 	 convolve: 5.105475 
Total time for convolution: 	 convolve: 5.139969 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.390 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
rank = 0, XC calculation took 24371.916 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 2.775 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.270 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.166 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.165 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.001 ms
rank =  0, One H*x took 2.029 ms
    Lanczos iter 58, eigmin  = -0.827770999, eigmax = 264.964255752, err_eigmin = 4.116e-04, err_eigmax = 9.650e-03
rank =   0, Lanczos took 166.230 ms, eigmin = -0.827770998788, eigmax = 267.613898309495

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.343064, lowerbound = -0.927771, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1728.144 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.465 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.832 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.111 ms
rank =  0, Distribute data + matrix mult took 27.442 ms
rank =  0, finding HY took 29.626 ms
rank =  0, distributing HY into block cyclic form took 19.053 ms
rank =  0, finding Y'*HY took 5.847 ms
Rank 0, Project_Hamiltonian used 82.028 ms
Total time for projection: 82.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.628 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.727 ms
    first calculated eigval = 2.762406153694673
    last  calculated eigval = 3.216087046295855
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.78317365525846
lambda[   3] =   2.80238575927799
lambda[   4] =   2.81635796793027
lambda[   5] =   2.85329661749138
lambda[   6] =   2.88705046958340
lambda[   7] =   2.92519413118466
lambda[   8] =   2.93314224375528
lambda[   9] =   2.95595190521391
lambda[  10] =   2.99208978704433
lambda[  11] =   3.03568387793840
lambda[  12] =   3.07280310916761
lambda[  13] =   3.08533725355253
lambda[  14] =   3.09348145828683
lambda[  15] =   3.10486847848373
lambda[  16] =   3.14822373895708
lambda[  17] =   3.19108061426062
lambda[  18] =   3.21608704629586
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.746 ms
rank =  0, subspace rotation using ScaLAPACK took 8.203 ms
rank =  0, Distributing orbital back into band + domain format took 18.241 ms
rank = 0, Subspace_Rotation used 26.473 ms

Total time for subspace rotation: 26.476 ms
rank = 0, Efermi =   3.054243540243 calculate fermi energy took 0.061 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.316087, lowerbound = -0.927771, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1714.362 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.191 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.889 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.038 ms
rank =  0, Distribute data + matrix mult took 22.145 ms
rank =  0, finding HY took 28.280 ms
rank =  0, distributing HY into block cyclic form took 44.720 ms
rank =  0, finding Y'*HY took 6.101 ms
Rank 0, Project_Hamiltonian used 101.300 ms
Total time for projection: 101.320 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.197 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.283 ms
    first calculated eigval = -0.669602383512262
    last  calculated eigval = 0.447710583122187
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.53489951566193
lambda[   3] =  -0.44547063508059
lambda[   4] =  -0.23835166166913
lambda[   5] =  -0.11944772711443
lambda[   6] =  -0.10165928958383
lambda[   7] =  -0.00246627483177
lambda[   8] =   0.08619591430324
lambda[   9] =   0.16025150311187
lambda[  10] =   0.21643776998772
lambda[  11] =   0.29106698061497
lambda[  12] =   0.31836691681259
lambda[  13] =   0.33324466137229
lambda[  14] =   0.34729745406297
lambda[  15] =   0.37364861709155
lambda[  16] =   0.38856237801450
lambda[  17] =   0.40852200037828
lambda[  18] =   0.44771058312219
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 7.972 ms
rank =  0, Distributing orbital back into band + domain format took 18.277 ms
rank = 0, Subspace_Rotation used 26.274 ms

Total time for subspace rotation: 26.279 ms
rank = 0, Efermi =   0.304716947298 calculate fermi energy took 0.047 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.547711, lowerbound = -0.927771, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1714.895 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.512 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.952 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.502 ms
rank =  0, finding HY took 28.238 ms
rank =  0, distributing HY into block cyclic form took 18.040 ms
rank =  0, finding Y'*HY took 5.514 ms
Rank 0, Project_Hamiltonian used 74.339 ms
Total time for projection: 74.349 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.158 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.246 ms
    first calculated eigval = -0.836985578919545
    last  calculated eigval = 0.165318453311275
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78623114078107
lambda[   3] =  -0.74989613694554
lambda[   4] =  -0.53517003773234
lambda[   5] =  -0.50921114408535
lambda[   6] =  -0.48364666562606
lambda[   7] =  -0.47667781409166
lambda[   8] =  -0.46883152877718
lambda[   9] =  -0.46165791672859
lambda[  10] =  -0.30096093681733
lambda[  11] =  -0.27840139941077
lambda[  12] =   0.01374676641555
lambda[  13] =   0.07277760624347
lambda[  14] =   0.08174823057689
lambda[  15] =   0.09195457898232
lambda[  16] =   0.10198786811121
lambda[  17] =   0.11977115158242
lambda[  18] =   0.16531845331128
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 7.965 ms
rank =  0, Distributing orbital back into band + domain format took 18.557 ms
rank = 0, Subspace_Rotation used 26.543 ms

Total time for subspace rotation: 26.548 ms
rank = 0, Efermi =  -0.015162778709 calculate fermi energy took 0.044 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.265318, lowerbound = -0.927771, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1702.097 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.565 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.779 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.380 ms
rank =  0, finding HY took 28.514 ms
rank =  0, distributing HY into block cyclic form took 18.070 ms
rank =  0, finding Y'*HY took 5.541 ms
Rank 0, Project_Hamiltonian used 74.555 ms
Total time for projection: 74.560 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -0.838370270815105
    last  calculated eigval = 0.088977873642426
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.78946282579334
lambda[   3] =  -0.75164601305636
lambda[   4] =  -0.54261015263678
lambda[   5] =  -0.51532733878627
lambda[   6] =  -0.48957106414402
lambda[   7] =  -0.48936100824957
lambda[   8] =  -0.47919539360512
lambda[   9] =  -0.47906578070349
lambda[  10] =  -0.32138440861501
lambda[  11] =  -0.32076676492698
lambda[  12] =  -0.03793056151973
lambda[  13] =   0.00087190238778
lambda[  14] =   0.01100567748866
lambda[  15] =   0.03509926805317
lambda[  16] =   0.06404632224313
lambda[  17] =   0.07415707482076
lambda[  18] =   0.08897787364243
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 8.182 ms
rank =  0, Distributing orbital back into band + domain format took 18.162 ms
rank = 0, Subspace_Rotation used 26.366 ms

Total time for subspace rotation: 26.370 ms
rank = 0, Efermi =  -0.066840106648 calculate fermi energy took 0.036 ms
rank = 0, --- Calculate rho: sum over local bands took 4.224 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.111 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.344 ms
rank = 0, Calculating density took 7479.570 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.174 ms
rank = 0, D2D took 1.353 ms
rank = 0, Transfering density took 1.361 ms
Etot    =   -27.766954427066
Eband   =   -12.033522043672
E1      =    24.692792455192
E2      =    -8.490105726973
E3      =   -11.294308878460
Exc     =   -10.085449280670
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 2.777e+00, dEband = 1.203e+00
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -27.766954427, dEtot = 2.777e+00, dEband = 1.203e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 43.5749612158561, which took 0.051 ms

iter_count = 96, r_2norm = 1.709e-03, tol*||rhs|| = 1.743e-03

Anderson update took 58.163 ms, out of which F'*F took 27.246 ms; b-Ax took 181.065 ms, out of which Lap took 161.211 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.528 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658019, int_b + int_rho = -5.784e-13, checking this took 0.914 ms
2-norm of RHS = 727.7513152797667, which took 0.171 ms

iter_count = 288, r_2norm = 6.203e-04, tol*||rhs|| = 7.278e-04

Anderson update took 174.315 ms, out of which F'*F took 81.672 ms; b-Ax took 542.695 ms, out of which Lap took 486.186 ms
Solving Poisson took 1205.869 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.465 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
Total time for convolution: 	 convolve: 5.251174 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.649 ms
Total time for convolution: 	 convolve: 5.237344 
Total time for convolution: 	 convolve: 5.208452 
Total time for convolution: 	 convolve: 5.175730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.613 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 1.889 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 4.073 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.004 ms

This SCF took 34341.819 ms, scf error = 2.226e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188978, lowerbound = -0.838370, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1709.449 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.288 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.748 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.059 ms
rank =  0, Distribute data + matrix mult took 22.110 ms
rank =  0, finding HY took 28.652 ms
rank =  0, distributing HY into block cyclic form took 18.956 ms
rank =  0, finding Y'*HY took 5.789 ms
Rank 0, Project_Hamiltonian used 75.541 ms
Total time for projection: 75.557 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.799125935048137
    last  calculated eigval = 0.056505658955401
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.75610977228236
lambda[   3] =  -0.70758043663442
lambda[   4] =  -0.51070267613777
lambda[   5] =  -0.47858109404941
lambda[   6] =  -0.45952097119341
lambda[   7] =  -0.45947762588342
lambda[   8] =  -0.44862086438544
lambda[   9] =  -0.44854190852621
lambda[  10] =  -0.29303082956042
lambda[  11] =  -0.29299314413498
lambda[  12] =  -0.03111650863975
lambda[  13] =  -0.02321517371972
lambda[  14] =  -0.01601721797451
lambda[  15] =   0.01100920929422
lambda[  16] =   0.03087205989924
lambda[  17] =   0.04800832431259
lambda[  18] =   0.05650565895540
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 8.022 ms
rank =  0, Distributing orbital back into band + domain format took 18.044 ms
rank = 0, Subspace_Rotation used 26.081 ms

Total time for subspace rotation: 26.086 ms
rank = 0, Efermi =  -0.060026101946 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.273 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.941 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.370 ms
rank = 0, Calculating density took 1823.002 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.180 ms
rank = 0, D2D took 1.350 ms
rank = 0, Transfering density took 1.355 ms
Etot    =   -27.690317340067
Eband   =   -11.308570516499
E1      =    24.047488518043
E2      =    -8.454753592248
E3      =   -11.478179538518
Exc     =   -10.236978309029
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 7.664e-03, dEband = 7.250e-02
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -27.690317340, dEtot = 7.664e-03, dEband = 7.250e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.7803620934878, which took 0.119 ms

iter_count = 102, r_2norm = 5.486e-04, tol*||rhs|| = 5.512e-04

Anderson update took 61.264 ms, out of which F'*F took 28.651 ms; b-Ax took 191.759 ms, out of which Lap took 170.676 ms
rank = 0, Mixing (+ precond) took 432.781 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658016, int_b + int_rho = -6.075e-13, checking this took 0.118 ms
2-norm of RHS = 720.5591226695179, which took 0.202 ms

iter_count = 306, r_2norm = 6.174e-04, tol*||rhs|| = 7.206e-04

Anderson update took 183.650 ms, out of which F'*F took 86.280 ms; b-Ax took 576.650 ms, out of which Lap took 515.811 ms
Solving Poisson took 1276.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.024 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.169979 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.183404 
Total time for convolution: 	 convolve: 5.197169 
Total time for convolution: 	 convolve: 5.195788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.744 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.666 ms
---Transfer Veff_loc: D2D took 1.886 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 3.160 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.073 ms

This SCF took 28264.429 ms, scf error = 1.533e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.156506, lowerbound = -0.799126, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1726.093 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.119 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.898 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.437 ms
rank =  0, Distribute data + matrix mult took 24.471 ms
rank =  0, finding HY took 29.281 ms
rank =  0, distributing HY into block cyclic form took 18.651 ms
rank =  0, finding Y'*HY took 5.678 ms
Rank 0, Project_Hamiltonian used 78.111 ms
Total time for projection: 78.127 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.730785680053330
    last  calculated eigval = 0.043561210082928
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.69604743117261
lambda[   3] =  -0.62416375622090
lambda[   4] =  -0.45232230433130
lambda[   5] =  -0.40999110502723
lambda[   6] =  -0.40445189434579
lambda[   7] =  -0.40440291439819
lambda[   8] =  -0.39281478298153
lambda[   9] =  -0.39275658574756
lambda[  10] =  -0.23838023823135
lambda[  11] =  -0.23836031313798
lambda[  12] =  -0.03300789356297
lambda[  13] =   0.00534496072361
lambda[  14] =   0.00738641524077
lambda[  15] =   0.00918339113212
lambda[  16] =   0.01668781620278
lambda[  17] =   0.03338997006896
lambda[  18] =   0.04356121008293
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 3.291 ms
rank =  0, Distributing orbital back into band + domain format took 22.615 ms
rank = 0, Subspace_Rotation used 25.919 ms

Total time for subspace rotation: 25.924 ms
rank = 0, Efermi =  -0.061917438678 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.210 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.015 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.376 ms
rank = 0, Calculating density took 1842.071 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.187 ms
rank = 0, D2D took 1.446 ms
rank = 0, Transfering density took 1.467 ms
Etot    =   -27.625031643553
Eband   =    -9.968954012173
E1      =    22.891238017863
E2      =    -8.263077399012
E3      =   -11.878456502622
Exc     =   -10.563659387529
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 6.529e-03, dEband = 1.340e-01
rank = 0, Calculating/Estimating energy took 1.010 ms, Etot = -27.625031644, dEtot = 6.529e-03, dEband = 1.340e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.2014645652973, which took 0.066 ms

iter_count = 108, r_2norm = 1.528e-04, tol*||rhs|| = 2.481e-04

Anderson update took 64.673 ms, out of which F'*F took 30.391 ms; b-Ax took 203.587 ms, out of which Lap took 181.326 ms
rank = 0, Mixing (+ precond) took 456.854 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658024, int_b + int_rho = -5.202e-13, checking this took 0.128 ms
2-norm of RHS = 720.3949329709251, which took 0.190 ms

iter_count = 264, r_2norm = 6.351e-04, tol*||rhs|| = 7.204e-04

Anderson update took 158.935 ms, out of which F'*F took 74.678 ms; b-Ax took 498.737 ms, out of which Lap took 447.308 ms
Solving Poisson took 1103.942 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.156215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.193402 
Total time for convolution: 	 convolve: 5.156678 
Total time for convolution: 	 convolve: 5.212006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.855 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.762 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.642 ms

This SCF took 28111.175 ms, scf error = 4.634e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.143561, lowerbound = -0.730786, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1710.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.063 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.817 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.046 ms
rank =  0, Distribute data + matrix mult took 21.948 ms
rank =  0, finding HY took 28.409 ms
rank =  0, distributing HY into block cyclic form took 18.420 ms
rank =  0, finding Y'*HY took 5.373 ms
Rank 0, Project_Hamiltonian used 74.181 ms
Total time for projection: 74.197 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.722113687446873
    last  calculated eigval = 0.035172030860165
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.68832769312419
lambda[   3] =  -0.61395957419043
lambda[   4] =  -0.44424684520411
lambda[   5] =  -0.40147274100975
lambda[   6] =  -0.39614836284644
lambda[   7] =  -0.39608811975603
lambda[   8] =  -0.38440454518230
lambda[   9] =  -0.38433306561525
lambda[  10] =  -0.22952021702632
lambda[  11] =  -0.22949813800967
lambda[  12] =  -0.03567348001119
lambda[  13] =   0.00553821564907
lambda[  14] =   0.01217848621605
lambda[  15] =   0.01307040778514
lambda[  16] =   0.01347604252830
lambda[  17] =   0.02527172872312
lambda[  18] =   0.03517203086017
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 8.055 ms
rank =  0, Distributing orbital back into band + domain format took 17.823 ms
rank = 0, Subspace_Rotation used 25.892 ms

Total time for subspace rotation: 25.897 ms
rank = 0, Efermi =  -0.064583025121 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.440 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.050 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.759 ms
rank = 0, Calculating density took 1822.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.281 ms
rank = 0, D2D took 1.441 ms
rank = 0, Transfering density took 1.446 ms
Etot    =   -27.621005095599
Eband   =    -9.780225979771
E1      =    22.776041026699
E2      =    -8.176659317015
E3      =   -11.946951322192
Exc     =   -10.615240618385
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 4.027e-04, dEband = 1.887e-02
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -27.621005096, dEtot = 4.027e-04, dEband = 1.887e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6002619387953, which took 0.109 ms

iter_count = 114, r_2norm = 4.785e-05, tol*||rhs|| = 6.401e-05

Anderson update took 68.306 ms, out of which F'*F took 31.897 ms; b-Ax took 218.945 ms, out of which Lap took 195.698 ms
rank = 0, Mixing (+ precond) took 484.428 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658021, int_b + int_rho = -5.566e-13, checking this took 0.126 ms
2-norm of RHS = 720.5920753994077, which took 0.181 ms

iter_count = 258, r_2norm = 6.645e-04, tol*||rhs|| = 7.206e-04

Anderson update took 154.444 ms, out of which F'*F took 73.361 ms; b-Ax took 486.313 ms, out of which Lap took 436.442 ms
Solving Poisson took 1078.263 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.174082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.181569 
Total time for convolution: 	 convolve: 5.154894 
Total time for convolution: 	 convolve: 5.199455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.877 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.750 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.673 ms

This SCF took 28110.909 ms, scf error = 2.148e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.135172, lowerbound = -0.722114, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1710.346 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.912 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.882 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.096 ms
rank =  0, Distribute data + matrix mult took 21.903 ms
rank =  0, finding HY took 28.529 ms
rank =  0, distributing HY into block cyclic form took 18.313 ms
rank =  0, finding Y'*HY took 5.585 ms
Rank 0, Project_Hamiltonian used 74.364 ms
Total time for projection: 74.381 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.715261508627835
    last  calculated eigval = 0.028872153494927
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.68149732158910
lambda[   3] =  -0.60671396135738
lambda[   4] =  -0.43738044048337
lambda[   5] =  -0.39467558140658
lambda[   6] =  -0.38911643002504
lambda[   7] =  -0.38905066115587
lambda[   8] =  -0.37721810461038
lambda[   9] =  -0.37714412333586
lambda[  10] =  -0.22286724193332
lambda[  11] =  -0.22284419226981
lambda[  12] =  -0.03626438089809
lambda[  13] =   0.00526736920521
lambda[  14] =   0.01253589305835
lambda[  15] =   0.01709431608615
lambda[  16] =   0.01751101739599
lambda[  17] =   0.02036543997594
lambda[  18] =   0.02887215349493
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 4.791 ms
rank =  0, Distributing orbital back into band + domain format took 20.862 ms
rank = 0, Subspace_Rotation used 25.667 ms

Total time for subspace rotation: 25.671 ms
rank = 0, Efermi =  -0.065173926015 calculate fermi energy took 1.829 ms
rank = 0, --- Calculate rho: sum over local bands took 4.994 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.144 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.373 ms
rank = 0, Calculating density took 1823.033 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.226 ms
rank = 0, D2D took 1.396 ms
rank = 0, Transfering density took 1.402 ms
Etot    =   -27.619166524182
Eband   =    -9.627539134553
E1      =    22.694798807062
E2      =    -8.093247300428
E3      =   -11.997706120079
Exc     =   -10.652189453850
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.839e-04, dEband = 1.527e-02
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -27.619166524, dEtot = 1.839e-04, dEband = 1.527e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6740548443381, which took 0.118 ms

iter_count = 114, r_2norm = 1.891e-05, tol*||rhs|| = 2.696e-05

Anderson update took 68.060 ms, out of which F'*F took 32.243 ms; b-Ax took 215.129 ms, out of which Lap took 191.838 ms
rank = 0, Mixing (+ precond) took 482.951 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658026, int_b + int_rho = -5.020e-13, checking this took 0.126 ms
2-norm of RHS = 720.9849866832830, which took 0.167 ms

iter_count = 252, r_2norm = 6.143e-04, tol*||rhs|| = 7.210e-04

Anderson update took 151.845 ms, out of which F'*F took 72.115 ms; b-Ax took 475.839 ms, out of which Lap took 427.301 ms
Solving Poisson took 1054.291 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.195513 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.177734 
Total time for convolution: 	 convolve: 5.185920 
Total time for convolution: 	 convolve: 5.151205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.314 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 2.028 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.430 ms

This SCF took 28092.461 ms, scf error = 7.877e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.128872, lowerbound = -0.715262, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1692.163 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.087 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.777 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.262 ms
rank =  0, Distribute data + matrix mult took 22.143 ms
rank =  0, finding HY took 28.390 ms
rank =  0, distributing HY into block cyclic form took 18.255 ms
rank =  0, finding Y'*HY took 5.538 ms
Rank 0, Project_Hamiltonian used 74.360 ms
Total time for projection: 74.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.709315058642439
    last  calculated eigval = 0.025724765867305
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.67473084958747
lambda[   3] =  -0.60132310610972
lambda[   4] =  -0.43102554939930
lambda[   5] =  -0.38855320396963
lambda[   6] =  -0.38298915874042
lambda[   7] =  -0.38292841507110
lambda[   8] =  -0.37092457576398
lambda[   9] =  -0.37085729089172
lambda[  10] =  -0.21797573493849
lambda[  11] =  -0.21795458428493
lambda[  12] =  -0.03579430235331
lambda[  13] =   0.00582908894259
lambda[  14] =   0.01291652625334
lambda[  15] =   0.01671215969227
lambda[  16] =   0.02124812382693
lambda[  17] =   0.02151292394250
lambda[  18] =   0.02572476586730
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 6.650 ms
rank =  0, Distributing orbital back into band + domain format took 19.940 ms
rank = 0, Subspace_Rotation used 26.606 ms

Total time for subspace rotation: 26.611 ms
rank = 0, Efermi =  -0.064703847452 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.831 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.294 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.383 ms
rank = 0, Calculating density took 1804.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.094 ms
rank = 0, D2D took 1.212 ms
rank = 0, Transfering density took 1.215 ms
Etot    =   -27.618469449908
Eband   =    -9.497155055750
E1      =    22.629799665935
E2      =    -8.020328626846
E3      =   -12.025213442483
Exc     =   -10.671465966073
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 6.971e-05, dEband = 1.304e-02
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -27.618469450, dEtot = 6.971e-05, dEband = 1.304e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4593359749921, which took 0.084 ms

iter_count = 114, r_2norm = 1.166e-05, tol*||rhs|| = 1.837e-05

Anderson update took 68.965 ms, out of which F'*F took 32.035 ms; b-Ax took 213.056 ms, out of which Lap took 190.539 ms
rank = 0, Mixing (+ precond) took 482.237 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658026, int_b + int_rho = -5.020e-13, checking this took 0.115 ms
2-norm of RHS = 721.1935517809640, which took 0.180 ms

iter_count = 228, r_2norm = 7.052e-04, tol*||rhs|| = 7.212e-04

Anderson update took 136.854 ms, out of which F'*F took 64.439 ms; b-Ax took 427.016 ms, out of which Lap took 382.728 ms
Solving Poisson took 948.187 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.194995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.257 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.178580 
Total time for convolution: 	 convolve: 5.212903 
Total time for convolution: 	 convolve: 5.157218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.636 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.254 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 2.151 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.272 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.464 ms

This SCF took 28017.776 ms, scf error = 3.961e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.125725, lowerbound = -0.709315, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1716.530 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.137 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.795 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.194 ms
rank =  0, Distribute data + matrix mult took 22.141 ms
rank =  0, finding HY took 28.417 ms
rank =  0, distributing HY into block cyclic form took 18.233 ms
rank =  0, finding Y'*HY took 5.403 ms
Rank 0, Project_Hamiltonian used 74.224 ms
Total time for projection: 74.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.706800137330604
    last  calculated eigval = 0.025012390640930
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.67243815366898
lambda[   3] =  -0.59895230709729
lambda[   4] =  -0.42866665216433
lambda[   5] =  -0.38621366934971
lambda[   6] =  -0.38083446337578
lambda[   7] =  -0.38077509977543
lambda[   8] =  -0.36885034700550
lambda[   9] =  -0.36878470300458
lambda[  10] =  -0.21538747983375
lambda[  11] =  -0.21536688961966
lambda[  12] =  -0.03482720315383
lambda[  13] =   0.00676597016831
lambda[  14] =   0.01367256005822
lambda[  15] =   0.01578022060724
lambda[  16] =   0.02277696451716
lambda[  17] =   0.02348651031705
lambda[  18] =   0.02501239064093
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 5.312 ms
rank =  0, Distributing orbital back into band + domain format took 21.275 ms
rank = 0, Subspace_Rotation used 26.607 ms

Total time for subspace rotation: 26.612 ms
rank = 0, Efermi =  -0.063736748278 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.636 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.505 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.378 ms
rank = 0, Calculating density took 1829.295 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.107 ms
rank = 0, D2D took 1.234 ms
rank = 0, Transfering density took 1.242 ms
Etot    =   -27.618361933525
Eband   =    -9.446139805377
E1      =    22.610091754606
E2      =    -7.987024040646
E3      =   -12.030483520910
Exc     =   -10.674631280960
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.075e-05, dEband = 5.102e-03
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -27.618361934, dEtot = 1.075e-05, dEband = 5.102e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2284751561831, which took 0.064 ms

iter_count = 114, r_2norm = 6.549e-06, tol*||rhs|| = 9.139e-06

Anderson update took 68.171 ms, out of which F'*F took 31.990 ms; b-Ax took 214.594 ms, out of which Lap took 191.170 ms
rank = 0, Mixing (+ precond) took 480.999 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658025, int_b + int_rho = -5.166e-13, checking this took 0.135 ms
2-norm of RHS = 721.2439506383422, which took 0.180 ms

iter_count = 234, r_2norm = 5.918e-04, tol*||rhs|| = 7.212e-04

Anderson update took 140.035 ms, out of which F'*F took 65.579 ms; b-Ax took 438.124 ms, out of which Lap took 393.844 ms
Solving Poisson took 973.176 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.163088 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.198252 
Total time for convolution: 	 convolve: 6.352101 
Total time for convolution: 	 convolve: 5.160580 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.845 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 2.111 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.279 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.424 ms

This SCF took 29197.199 ms, scf error = 2.497e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125012, lowerbound = -0.706800, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1739.979 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.882 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.124 ms
rank =  0, Distribute data + matrix mult took 22.063 ms
rank =  0, finding HY took 28.459 ms
rank =  0, distributing HY into block cyclic form took 18.170 ms
rank =  0, finding Y'*HY took 5.328 ms
Rank 0, Project_Hamiltonian used 74.056 ms
Total time for projection: 74.073 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.702812274336145
    last  calculated eigval = 0.027225382814489
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66874938959198
lambda[   3] =  -0.59475113863701
lambda[   4] =  -0.42496730299924
lambda[   5] =  -0.38231133975777
lambda[   6] =  -0.37738654235074
lambda[   7] =  -0.37732817103089
lambda[   8] =  -0.36546526818709
lambda[   9] =  -0.36540092833357
lambda[  10] =  -0.21156417751791
lambda[  11] =  -0.21154388444220
lambda[  12] =  -0.03256662626180
lambda[  13] =   0.00942896537970
lambda[  14] =   0.01558994931332
lambda[  15] =   0.01713123066309
lambda[  16] =   0.02381335090395
lambda[  17] =   0.02582217992378
lambda[  18] =   0.02722538281449
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 8.261 ms
rank =  0, Distributing orbital back into band + domain format took 18.068 ms
rank = 0, Subspace_Rotation used 26.353 ms

Total time for subspace rotation: 26.358 ms
rank = 0, Efermi =  -0.061476171353 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.794 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.432 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.364 ms
rank = 0, Calculating density took 1852.362 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.220 ms
rank = 0, D2D took 1.392 ms
rank = 0, Transfering density took 1.411 ms
Etot    =   -27.618218760245
Eband   =    -9.364560835235
E1      =    22.565602244593
E2      =    -7.946762638428
E3      =   -12.043295423778
Exc     =   -10.684128068461
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.432e-05, dEband = 8.158e-03
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -27.618218760, dEtot = 1.432e-05, dEband = 8.158e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1614911058739, which took 0.067 ms

iter_count = 114, r_2norm = 4.302e-06, tol*||rhs|| = 6.460e-06

Anderson update took 68.599 ms, out of which F'*F took 31.626 ms; b-Ax took 211.959 ms, out of which Lap took 188.943 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.176 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658021, int_b + int_rho = -5.493e-13, checking this took 0.132 ms
2-norm of RHS = 721.2392233967273, which took 0.089 ms

iter_count = 210, r_2norm = 6.161e-04, tol*||rhs|| = 7.212e-04

Anderson update took 126.663 ms, out of which F'*F took 59.024 ms; b-Ax took 395.482 ms, out of which Lap took 355.762 ms
Solving Poisson took 878.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.191054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.255 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.159871 
Total time for convolution: 	 convolve: 5.144990 
Total time for convolution: 	 convolve: 5.179555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.588 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.184 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.274 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.492 ms

This SCF took 27865.012 ms, scf error = 1.529e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127225, lowerbound = -0.702812, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1698.966 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.150 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.827 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 22.001 ms
rank =  0, finding HY took 28.526 ms
rank =  0, distributing HY into block cyclic form took 18.028 ms
rank =  0, finding Y'*HY took 5.526 ms
Rank 0, Project_Hamiltonian used 74.143 ms
Total time for projection: 74.158 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.701711464664349
    last  calculated eigval = 0.028690276716283
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66775316974302
lambda[   3] =  -0.59366079266362
lambda[   4] =  -0.42393596844446
lambda[   5] =  -0.38130978889767
lambda[   6] =  -0.37632558615048
lambda[   7] =  -0.37626586441838
lambda[   8] =  -0.36443391741656
lambda[   9] =  -0.36436810440819
lambda[  10] =  -0.21031335747988
lambda[  11] =  -0.21029257447557
lambda[  12] =  -0.02990351077035
lambda[  13] =   0.01226455589795
lambda[  14] =   0.01826669714488
lambda[  15] =   0.01984491618513
lambda[  16] =   0.02435393356682
lambda[  17] =   0.02737929038380
lambda[  18] =   0.02869027671628
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 5.943 ms
rank =  0, Distributing orbital back into band + domain format took 19.921 ms
rank = 0, Subspace_Rotation used 25.882 ms

Total time for subspace rotation: 25.886 ms
rank = 0, Efermi =  -0.058813055900 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 4.774 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.404 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.417 ms
rank = 0, Calculating density took 1810.971 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.180 ms
rank = 0, D2D took 1.512 ms
rank = 0, Transfering density took 1.515 ms
Etot    =   -27.618189657359
Eband   =    -9.340741178319
E1      =    22.556115954968
E2      =    -7.932340535789
E3      =   -12.043845365941
Exc     =   -10.684560172389
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 2.910e-06, dEband = 2.382e-03
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -27.618189657, dEtot = 2.910e-06, dEband = 2.382e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0630092810895, which took 0.146 ms

iter_count = 114, r_2norm = 2.372e-06, tol*||rhs|| = 2.520e-06

Anderson update took 68.718 ms, out of which F'*F took 32.565 ms; b-Ax took 214.077 ms, out of which Lap took 191.720 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.894 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658022, int_b + int_rho = -5.457e-13, checking this took 0.128 ms
2-norm of RHS = 721.2136330132299, which took 0.193 ms

iter_count = 204, r_2norm = 5.747e-04, tol*||rhs|| = 7.212e-04

Anderson update took 122.490 ms, out of which F'*F took 56.490 ms; b-Ax took 393.915 ms, out of which Lap took 354.918 ms
Solving Poisson took 887.515 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.167711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.661 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.182192 
Total time for convolution: 	 convolve: 5.159107 
Total time for convolution: 	 convolve: 5.174607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.413 ms
---Transfer Veff_loc: D2D took 2.107 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.432 ms

This SCF took 27874.953 ms, scf error = 1.024e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128690, lowerbound = -0.701711, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1698.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.077 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.857 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.127 ms
rank =  0, Distribute data + matrix mult took 22.079 ms
rank =  0, finding HY took 28.361 ms
rank =  0, distributing HY into block cyclic form took 18.197 ms
rank =  0, finding Y'*HY took 5.354 ms
Rank 0, Project_Hamiltonian used 74.021 ms
Total time for projection: 74.034 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.700309026868214
    last  calculated eigval = 0.030266254213363
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66631511678521
lambda[   3] =  -0.59226757509368
lambda[   4] =  -0.42254036155390
lambda[   5] =  -0.37990990748375
lambda[   6] =  -0.37493971429844
lambda[   7] =  -0.37487963759240
lambda[   8] =  -0.36304149862919
lambda[   9] =  -0.36297531888960
lambda[  10] =  -0.20898595766609
lambda[  11] =  -0.20896488433674
lambda[  12] =  -0.02656904196778
lambda[  13] =   0.01537149484771
lambda[  14] =   0.02195554270822
lambda[  15] =   0.02362596463476
lambda[  16] =   0.02607234284542
lambda[  17] =   0.02931042425387
lambda[  18] =   0.03026625421336
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.892 ms
rank =  0, Distributing orbital back into band + domain format took 18.081 ms
rank = 0, Subspace_Rotation used 25.986 ms

Total time for subspace rotation: 25.991 ms
rank = 0, Efermi =  -0.055478587109 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.724 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.514 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.384 ms
rank = 0, Calculating density took 1810.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.203 ms
rank = 0, D2D took 1.466 ms
rank = 0, Transfering density took 1.469 ms
Etot    =   -27.618180890268
Eband   =    -9.310257999101
E1      =    22.539708705937
E2      =    -7.917605190140
E3      =   -12.047317631209
Exc     =   -10.687364255105
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 8.767e-07, dEband = 3.048e-03
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -27.618180890, dEtot = 8.767e-07, dEband = 3.048e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0648387486833, which took 0.071 ms

iter_count = 114, r_2norm = 1.897e-06, tol*||rhs|| = 2.594e-06

Anderson update took 68.007 ms, out of which F'*F took 31.656 ms; b-Ax took 213.557 ms, out of which Lap took 190.032 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.384 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658021, int_b + int_rho = -5.493e-13, checking this took 0.129 ms
2-norm of RHS = 721.2193665635924, which took 0.176 ms

iter_count = 168, r_2norm = 6.877e-04, tol*||rhs|| = 7.212e-04

Anderson update took 100.255 ms, out of which F'*F took 47.359 ms; b-Ax took 319.282 ms, out of which Lap took 285.871 ms
Solving Poisson took 701.374 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.213642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.177674 
Total time for convolution: 	 convolve: 5.184795 
Total time for convolution: 	 convolve: 5.151564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.438 ms
---Transfer Veff_loc: D2D took 2.054 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.117 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.218 ms

This SCF took 27735.055 ms, scf error = 5.496e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130266, lowerbound = -0.700309, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1700.637 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.001 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.813 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.088 ms
rank =  0, Distribute data + matrix mult took 21.926 ms
rank =  0, finding HY took 28.366 ms
rank =  0, distributing HY into block cyclic form took 18.207 ms
rank =  0, finding Y'*HY took 5.367 ms
Rank 0, Project_Hamiltonian used 73.897 ms
Total time for projection: 73.912 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.699648037051466
    last  calculated eigval = 0.030939401546010
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66565028262960
lambda[   3] =  -0.59162613419658
lambda[   4] =  -0.42188847911813
lambda[   5] =  -0.37925386293247
lambda[   6] =  -0.37431688926246
lambda[   7] =  -0.37425677603868
lambda[   8] =  -0.36242246721802
lambda[   9] =  -0.36235624990659
lambda[  10] =  -0.20836104494686
lambda[  11] =  -0.20833991812222
lambda[  12] =  -0.02497352690044
lambda[  13] =   0.01682270689081
lambda[  14] =   0.02309335314534
lambda[  15] =   0.02578281346202
lambda[  16] =   0.02740209100575
lambda[  17] =   0.03030804133270
lambda[  18] =   0.03093940154601
==subpsace eigenproblem: bcast eigvals took 0.061 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 6.696 ms
rank =  0, Distributing orbital back into band + domain format took 19.197 ms
rank = 0, Subspace_Rotation used 25.906 ms

Total time for subspace rotation: 25.910 ms
rank = 0, Efermi =  -0.053883072024 calculate fermi energy took 0.098 ms
rank = 0, --- Calculate rho: sum over local bands took 4.744 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.405 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.403 ms
rank = 0, Calculating density took 1812.424 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.176 ms
rank = 0, D2D took 1.551 ms
rank = 0, Transfering density took 1.554 ms
Etot    =   -27.618201095419
Eband   =    -9.296240283510
E1      =    22.532314022148
E2      =    -7.910642540623
E3      =   -12.048857659431
Exc     =   -10.688584870763
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 2.021e-06, dEband = 1.402e-03
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -27.618201095, dEtot = 2.021e-06, dEband = 1.402e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0395775849259, which took 0.103 ms

iter_count = 108, r_2norm = 1.497e-06, tol*||rhs|| = 1.583e-06

Anderson update took 64.992 ms, out of which F'*F took 30.937 ms; b-Ax took 203.924 ms, out of which Lap took 181.884 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.429 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658025, int_b + int_rho = -5.093e-13, checking this took 0.120 ms
2-norm of RHS = 721.2373397239891, which took 0.864 ms

iter_count = 180, r_2norm = 6.558e-04, tol*||rhs|| = 7.212e-04

Anderson update took 108.034 ms, out of which F'*F took 51.181 ms; b-Ax took 338.112 ms, out of which Lap took 302.721 ms
Solving Poisson took 749.235 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.193073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.506 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.215542 
Total time for convolution: 	 convolve: 5.177755 
Total time for convolution: 	 convolve: 5.163962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.437 ms
---Transfer Veff_loc: D2D took 2.501 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.848 ms

This SCF took 27788.290 ms, scf error = 4.601e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130939, lowerbound = -0.699648, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1705.762 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 17.932 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.932 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.136 ms
rank =  0, Distribute data + matrix mult took 22.016 ms
rank =  0, finding HY took 28.363 ms
rank =  0, distributing HY into block cyclic form took 18.177 ms
rank =  0, finding Y'*HY took 5.464 ms
Rank 0, Project_Hamiltonian used 74.054 ms
Total time for projection: 74.070 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.699007579257790
    last  calculated eigval = 0.033462025385952
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66504353612238
lambda[   3] =  -0.59101249045966
lambda[   4] =  -0.42126769520563
lambda[   5] =  -0.37864708504735
lambda[   6] =  -0.37371249868222
lambda[   7] =  -0.37365154777700
lambda[   8] =  -0.36183123776219
lambda[   9] =  -0.36176404337467
lambda[  10] =  -0.20768034921518
lambda[  11] =  -0.20765887517415
lambda[  12] =  -0.02176472562850
lambda[  13] =   0.01934070378578
lambda[  14] =   0.02542977200900
lambda[  15] =   0.03008470220181
lambda[  16] =   0.03077850144451
lambda[  17] =   0.03170923670928
lambda[  18] =   0.03346202538595
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.902 ms
rank =  0, Distributing orbital back into band + domain format took 17.945 ms
rank = 0, Subspace_Rotation used 25.860 ms

Total time for subspace rotation: 25.865 ms
rank = 0, Efermi =  -0.050674270769 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 4.748 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.438 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.432 ms
rank = 0, Calculating density took 1817.657 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.175 ms
rank = 0, D2D took 1.568 ms
rank = 0, Transfering density took 1.571 ms
Etot    =   -27.618319706024
Eband   =    -9.282553876735
E1      =    22.526214342335
E2      =    -7.902884876690
E3      =   -12.049391645941
Exc     =   -10.689066530906
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.186e-05, dEband = 1.369e-03
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -27.618319706, dEtot = 1.186e-05, dEband = 1.369e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0412051604705, which took 0.078 ms

iter_count = 108, r_2norm = 1.468e-06, tol*||rhs|| = 1.648e-06

Anderson update took 64.981 ms, out of which F'*F took 30.756 ms; b-Ax took 204.446 ms, out of which Lap took 182.617 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.621 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658026, int_b + int_rho = -5.057e-13, checking this took 0.133 ms
2-norm of RHS = 721.2399148523591, which took 0.170 ms

iter_count = 144, r_2norm = 5.883e-04, tol*||rhs|| = 7.212e-04

Anderson update took 85.903 ms, out of which F'*F took 40.337 ms; b-Ax took 271.075 ms, out of which Lap took 240.331 ms
Solving Poisson took 601.142 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.197790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.161999 
Total time for convolution: 	 convolve: 5.181941 
Total time for convolution: 	 convolve: 5.167545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
---Transfer Veff_loc: D2D took 2.101 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.278 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.416 ms

This SCF took 28810.344 ms, scf error = 2.565e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133462, lowerbound = -0.699008, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1739.034 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.235 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.799 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.115 ms
rank =  0, Distribute data + matrix mult took 22.166 ms
rank =  0, finding HY took 28.358 ms
rank =  0, distributing HY into block cyclic form took 18.238 ms
rank =  0, finding Y'*HY took 5.311 ms
Rank 0, Project_Hamiltonian used 74.104 ms
Total time for projection: 74.118 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.698819186860212
    last  calculated eigval = 0.034933478586875
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66485805971675
lambda[   3] =  -0.59081558225252
lambda[   4] =  -0.42108500744684
lambda[   5] =  -0.37846109728702
lambda[   6] =  -0.37353234812413
lambda[   7] =  -0.37347135414821
lambda[   8] =  -0.36165072427391
lambda[   9] =  -0.36158348477225
lambda[  10] =  -0.20750057775428
lambda[  11] =  -0.20747905457935
lambda[  12] =  -0.02102543123644
lambda[  13] =   0.01997722369575
lambda[  14] =   0.02570034395275
lambda[  15] =   0.03088504859039
lambda[  16] =   0.03133924605592
lambda[  17] =   0.03191797351674
lambda[  18] =   0.03493347858688
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 7.921 ms
rank =  0, Distributing orbital back into band + domain format took 18.056 ms
rank = 0, Subspace_Rotation used 25.991 ms

Total time for subspace rotation: 25.996 ms
rank = 0, Efermi =  -0.049934976332 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.739 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.439 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.416 ms
rank = 0, Calculating density took 1851.067 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.200 ms
rank = 0, D2D took 1.503 ms
rank = 0, Transfering density took 1.507 ms
Etot    =   -27.618352154268
Eband   =    -9.278512954990
E1      =    22.524111537402
E2      =    -7.900845840531
E3      =   -12.049751993475
Exc     =   -10.689358407338
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 3.245e-06, dEband = 4.041e-04
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -27.618352154, dEtot = 3.245e-06, dEband = 4.041e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0350100784214, which took 0.067 ms

iter_count = 108, r_2norm = 1.065e-06, tol*||rhs|| = 1.400e-06

Anderson update took 64.760 ms, out of which F'*F took 30.644 ms; b-Ax took 204.445 ms, out of which Lap took 182.830 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.341 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658024, int_b + int_rho = -5.202e-13, checking this took 0.113 ms
2-norm of RHS = 721.2432008134119, which took 0.184 ms

iter_count = 138, r_2norm = 6.813e-04, tol*||rhs|| = 7.212e-04

Anderson update took 82.449 ms, out of which F'*F took 38.507 ms; b-Ax took 261.415 ms, out of which Lap took 232.299 ms
Solving Poisson took 575.094 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.167432 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.181261 
Total time for convolution: 	 convolve: 5.165535 
Total time for convolution: 	 convolve: 5.169671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.138 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.473 ms

This SCF took 27588.893 ms, scf error = 1.958e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134933, lowerbound = -0.698819, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1701.126 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 17.997 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.846 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.872 ms
rank =  0, finding HY took 28.533 ms
rank =  0, distributing HY into block cyclic form took 18.158 ms
rank =  0, finding Y'*HY took 5.388 ms
Rank 0, Project_Hamiltonian used 73.984 ms
Total time for projection: 73.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.698736786338595
    last  calculated eigval = 0.036078722873316
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66477020646375
lambda[   3] =  -0.59072307596270
lambda[   4] =  -0.42100049653797
lambda[   5] =  -0.37838101112248
lambda[   6] =  -0.37343805288576
lambda[   7] =  -0.37337710078821
lambda[   8] =  -0.36155265414218
lambda[   9] =  -0.36148546958873
lambda[  10] =  -0.20742315884412
lambda[  11] =  -0.20740161303032
lambda[  12] =  -0.02185670296462
lambda[  13] =   0.01931479140061
lambda[  14] =   0.02466157901122
lambda[  15] =   0.02925183090438
lambda[  16] =   0.03100694944585
lambda[  17] =   0.03180967796122
lambda[  18] =   0.03607872287332
==subpsace eigenproblem: bcast eigvals took 0.064 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 7.920 ms
rank =  0, Distributing orbital back into band + domain format took 18.048 ms
rank = 0, Subspace_Rotation used 25.981 ms

Total time for subspace rotation: 25.987 ms
rank = 0, Efermi =  -0.050766248081 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.795 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.421 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.441 ms
rank = 0, Calculating density took 1813.136 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.168 ms
rank = 0, D2D took 1.431 ms
rank = 0, Transfering density took 1.433 ms
Etot    =   -27.618410549352
Eband   =    -9.276579251991
E1      =    22.523364034520
E2      =    -7.899638586756
E3      =   -12.049602284797
Exc     =   -10.689246040086
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 5.840e-06, dEband = 1.934e-04
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -27.618410549, dEtot = 5.840e-06, dEband = 1.934e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0328078507485, which took 0.066 ms

iter_count = 108, r_2norm = 1.033e-06, tol*||rhs|| = 1.312e-06

Anderson update took 65.014 ms, out of which F'*F took 31.114 ms; b-Ax took 205.322 ms, out of which Lap took 183.504 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.658 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658020, int_b + int_rho = -5.639e-13, checking this took 0.109 ms
2-norm of RHS = 721.2432226352680, which took 0.170 ms

iter_count = 90, r_2norm = 6.448e-04, tol*||rhs|| = 7.212e-04

Anderson update took 53.809 ms, out of which F'*F took 25.135 ms; b-Ax took 169.890 ms, out of which Lap took 151.183 ms
Solving Poisson took 376.265 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.192995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
Total time for convolution: 	 convolve: 5.204444 
Total time for convolution: 	 convolve: 5.181930 
Total time for convolution: 	 convolve: 5.173022 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 2.118 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.282 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.438 ms

This SCF took 27386.712 ms, scf error = 1.571e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136079, lowerbound = -0.698737, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1704.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.175 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.785 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.123 ms
rank =  0, Distribute data + matrix mult took 22.099 ms
rank =  0, finding HY took 28.400 ms
rank =  0, distributing HY into block cyclic form took 18.212 ms
rank =  0, finding Y'*HY took 5.331 ms
Rank 0, Project_Hamiltonian used 74.073 ms
Total time for projection: 74.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.698637905979090
    last  calculated eigval = 0.036509566999997
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66467840314405
lambda[   3] =  -0.59062527509225
lambda[   4] =  -0.42090871010841
lambda[   5] =  -0.37828395244735
lambda[   6] =  -0.37335606456478
lambda[   7] =  -0.37329508597016
lambda[   8] =  -0.36147298824844
lambda[   9] =  -0.36140577510585
lambda[  10] =  -0.20733022258461
lambda[  11] =  -0.20730867465926
lambda[  12] =  -0.02161299425073
lambda[  13] =   0.01947842140240
lambda[  14] =   0.02480228549151
lambda[  15] =   0.02942906733548
lambda[  16] =   0.03110796735456
lambda[  17] =   0.03187495311591
lambda[  18] =   0.03650956700000
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.981 ms
rank =  0, Distributing orbital back into band + domain format took 18.085 ms
rank = 0, Subspace_Rotation used 26.105 ms

Total time for subspace rotation: 26.110 ms
rank = 0, Efermi =  -0.050522539360 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.824 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.461 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.405 ms
rank = 0, Calculating density took 1817.089 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.216 ms
rank = 0, D2D took 1.491 ms
rank = 0, Transfering density took 1.500 ms
Etot    =   -27.618422833906
Eband   =    -9.274606116383
E1      =    22.522254022678
E2      =    -7.898703954258
E3      =   -12.049844281446
Exc     =   -10.689428812556
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.228e-06, dEband = 1.973e-04
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -27.618422834, dEtot = 1.228e-06, dEband = 1.973e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0136962527609, which took 0.056 ms

iter_count = 114, r_2norm = 3.439e-07, tol*||rhs|| = 5.479e-07

Anderson update took 68.433 ms, out of which F'*F took 31.951 ms; b-Ax took 213.768 ms, out of which Lap took 190.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.010 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658019, int_b + int_rho = -5.712e-13, checking this took 0.107 ms
2-norm of RHS = 721.2412131695488, which took 0.205 ms

iter_count = 132, r_2norm = 6.404e-04, tol*||rhs|| = 7.212e-04

Anderson update took 78.986 ms, out of which F'*F took 36.620 ms; b-Ax took 248.921 ms, out of which Lap took 221.286 ms
Solving Poisson took 550.395 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.200204 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.167326 
Total time for convolution: 	 convolve: 5.166683 
Total time for convolution: 	 convolve: 5.179723 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.521 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 2.167 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.324 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.528 ms

This SCF took 27553.447 ms, scf error = 1.203e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136510, lowerbound = -0.698638, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1707.208 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.946 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 22.080 ms
rank =  0, finding HY took 28.524 ms
rank =  0, distributing HY into block cyclic form took 18.193 ms
rank =  0, finding Y'*HY took 5.435 ms
Rank 0, Project_Hamiltonian used 74.277 ms
Total time for projection: 74.290 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.698559314322465
    last  calculated eigval = 0.037207926790612
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66459651619405
lambda[   3] =  -0.59055795517037
lambda[   4] =  -0.42082600272428
lambda[   5] =  -0.37820657533294
lambda[   6] =  -0.37327595205107
lambda[   7] =  -0.37321498639657
lambda[   8] =  -0.36139277242488
lambda[   9] =  -0.36132557324574
lambda[  10] =  -0.20725246621820
lambda[  11] =  -0.20723094803743
lambda[  12] =  -0.02125308985818
lambda[  13] =   0.01955279264192
lambda[  14] =   0.02512606573537
lambda[  15] =   0.02971621213106
lambda[  16] =   0.03125203588459
lambda[  17] =   0.03187600672442
lambda[  18] =   0.03720792679061
==subpsace eigenproblem: bcast eigvals took 0.086 ms
Total time for solving subspace eigenvalue problem: 0.285 ms
rank =  0, subspace rotation using ScaLAPACK took 5.238 ms
rank =  0, Distributing orbital back into band + domain format took 20.725 ms
rank = 0, Subspace_Rotation used 26.004 ms

Total time for subspace rotation: 26.010 ms
rank = 0, Efermi =  -0.050162634965 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.738 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.251 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.814 ms
rank = 0, Calculating density took 1819.777 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.299 ms
rank = 0, D2D took 1.631 ms
rank = 0, Transfering density took 1.641 ms
Etot    =   -27.618435018294
Eband   =    -9.272878124801
E1      =    22.521573140833
E2      =    -7.897648625468
E3      =   -12.049768148084
Exc     =   -10.689356644529
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.218e-06, dEband = 1.728e-04
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -27.618435018, dEtot = 1.218e-06, dEband = 1.728e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0100627786851, which took 0.081 ms

iter_count = 108, r_2norm = 3.853e-07, tol*||rhs|| = 4.025e-07

Anderson update took 64.960 ms, out of which F'*F took 30.160 ms; b-Ax took 202.889 ms, out of which Lap took 181.155 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.976 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658026, int_b + int_rho = -4.984e-13, checking this took 0.115 ms
2-norm of RHS = 721.2401074994712, which took 0.180 ms

iter_count = 96, r_2norm = 6.497e-04, tol*||rhs|| = 7.212e-04

Anderson update took 57.412 ms, out of which F'*F took 26.867 ms; b-Ax took 181.321 ms, out of which Lap took 161.169 ms
Solving Poisson took 401.302 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.167271 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.680 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.148495 
Total time for convolution: 	 convolve: 5.213443 
Total time for convolution: 	 convolve: 5.166286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 2.148 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.269 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.461 ms

This SCF took 27423.981 ms, scf error = 1.095e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137208, lowerbound = -0.698559, upperbound = 267.613898

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1724.843 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.210 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.910 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.156 ms
rank =  0, finding HY took 28.401 ms
rank =  0, distributing HY into block cyclic form took 18.105 ms
rank =  0, finding Y'*HY took 5.466 ms
Rank 0, Project_Hamiltonian used 74.169 ms
Total time for projection: 74.186 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.698443173143106
    last  calculated eigval = 0.037680442426735
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.66448626577313
lambda[   3] =  -0.59044416917012
lambda[   4] =  -0.42071506307120
lambda[   5] =  -0.37809174088804
lambda[   6] =  -0.37317466496644
lambda[   7] =  -0.37311375269269
lambda[   8] =  -0.36129347537379
lambda[   9] =  -0.36122633566132
lambda[  10] =  -0.20714123561113
lambda[  11] =  -0.20711975231353
lambda[  12] =  -0.02079810540579
lambda[  13] =   0.01984100361657
lambda[  14] =   0.02560730620709
lambda[  15] =   0.03028867081083
lambda[  16] =   0.03152268369231
lambda[  17] =   0.03198819104072
lambda[  18] =   0.03768044242674
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 7.993 ms
rank =  0, Distributing orbital back into band + domain format took 18.041 ms
rank = 0, Subspace_Rotation used 26.059 ms

Total time for subspace rotation: 26.064 ms
rank = 0, Efermi =  -0.049707650547 calculate fermi energy took 0.118 ms
rank = 0, --- Calculate rho: sum over local bands took 4.789 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.351 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.407 ms
rank = 0, Calculating density took 1837.112 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.210 ms
rank = 0, D2D took 1.492 ms
rank = 0, Transfering density took 1.501 ms
Etot    =   -27.618446534552
Eband   =    -9.270499257882
E1      =    22.520242075377
E2      =    -7.896519520566
E3      =   -12.050064642461
Exc     =   -10.689583351725
Esc     =   -50.125190162557
Entropy =    -0.000000000792
dE = 1.152e-06, dEband = 2.379e-04
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -27.618446535, dEtot = 1.152e-06, dEband = 2.379e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0094527210545, which took 0.161 ms

iter_count = 108, r_2norm = 2.872e-07, tol*||rhs|| = 3.781e-07

Anderson update took 65.335 ms, out of which F'*F took 30.908 ms; b-Ax took 205.098 ms, out of which Lap took 182.899 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.541 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000002658076, int_rho =  22.00000002658022, int_b + int_rho = -5.384e-13, checking this took 0.115 ms
2-norm of RHS = 721.2406261285329, which took 0.123 ms

iter_count = 90, r_2norm = 7.016e-04, tol*||rhs|| = 7.212e-04

Anderson update took 53.929 ms, out of which F'*F took 24.967 ms; b-Ax took 170.741 ms, out of which Lap took 150.650 ms
Solving Poisson took 376.479 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.167432 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.602 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.212337 
Total time for convolution: 	 convolve: 5.181749 
Total time for convolution: 	 convolve: 5.190340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 2.141 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.872 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.046 ms

This SCF took 27501.809 ms, scf error = 6.959e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.66448626577313, occ[   2] =   2.00000000000000
lambda[   3] =  -0.59044416917012, occ[   3] =   2.00000000000000
lambda[   4] =  -0.42071506307120, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37809174088804, occ[   5] =   2.00000000000000
lambda[   6] =  -0.37317466496644, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37311375269269, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36129347537379, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36122633566132, occ[   9] =   2.00000000000000
lambda[  10] =  -0.20714123561113, occ[  10] =   2.00000000000000
lambda[  11] =  -0.20711975231353, occ[  11] =   2.00000000000000
lambda[  12] =  -0.02079810540579, occ[  12] =   0.00000002658023
lambda[  13] =   0.01984100361657, occ[  13] =   0.00000000000000
lambda[  14] =   0.02560730620709, occ[  14] =   0.00000000000000
lambda[  15] =   0.03028867081083, occ[  15] =   0.00000000000000
lambda[  16] =   0.03152268369231, occ[  16] =   0.00000000000000
lambda[  17] =   0.03198819104072, occ[  17] =   0.00000000000000
lambda[  18] =   0.03768044242674, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.994 ms, time for Allreduce/Reduce: 5.378 ms 
Time for calculating local force components: 18.363 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000001716632  -0.04559273409880  -0.01797023216330
  0.03957423857974   0.02287009388645  -0.01800805987149
 -0.03957418140375   0.02287006775868  -0.01800805834834
  0.00000002846244  -0.04559273313804   0.01797014342604
 -0.03957420122628   0.02287011552467   0.01800794645969
  0.03957424293174   0.02287008984226   0.01800796448494
 -0.00000005657688   0.00006571535848   0.04055395339953
  0.00000032829722   0.00006553361170  -0.04056047396486
  0.00000063195548   0.00003058847152  -0.08293420717839
  0.00000048422932   0.00003115420766   0.08292810955323
force_loc = 
 -0.00000011820252   0.04702076949799   0.01831398184111
 -0.04067748893909  -0.02350055024292   0.01826393613989
  0.04067682169378  -0.02350018443127   0.01826375366753
 -0.00000010667176   0.04701984045071  -0.01831358493157
  0.04067600341853  -0.02349989031329  -0.01826325529257
 -0.04067643513824  -0.02349965455806  -0.01826351469332
 -0.00000054024654  -0.00007368854316  -0.00971312320825
 -0.00000057171295  -0.00007340636110   0.00972024535147
 -0.00000122555050  -0.00018774682979   0.07895085656198
 -0.00000023621860  -0.00019048694858  -0.07894610338798
Time for calculating nonlocal force components: 43.700 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000001165947   0.00000092437029  -0.01437039670591
[0m[32m -0.00000004920994   0.00000096094731   0.01437059545111
[0m[32m -0.00000002517021  -0.00000415872271   0.00374752804218
[0m[32m -0.00000004986611  -0.00000428098289  -0.00374730252049
[0mTime for calculating XC forces components: 26.631 ms
 Cartesian force = 
  0.00000014906963   0.00142840152348   0.00034367946659
 -0.00110300025351  -0.00063009023219   0.00025580605718
  0.00110289039586  -0.00062975054829   0.00025562510796
  0.00000017189652   0.00142747343696  -0.00034351171675
  0.00110205229808  -0.00062940866433  -0.00025537904410
 -0.00110194210068  -0.00062919859150  -0.00025562041960
 -0.00000035837706  -0.00000668269011   0.01647036327415
 -0.00000004251985  -0.00000654567779  -0.01646970337351
 -0.00000036865941  -0.00016095095669  -0.00023589278545
  0.00000044825044  -0.00016324759952   0.00023463343354
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Time for printing density: 390.463 ms
The program took 509.652 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:37:07
Job ID:        2266947
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:44:36,vmem=8384K,walltime=00:08:43,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-26-2
---------------------------------------
