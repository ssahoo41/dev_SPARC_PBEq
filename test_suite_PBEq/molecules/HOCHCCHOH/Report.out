---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:06
Job ID:    2267031
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:14
Job ID:    2267031
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.082 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 20.715 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 7.859 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 100.275 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.957 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.476751	   14.053483	    9.174327	
    8.523249	    5.946517	    9.174327	
    8.779003	   13.567652	   11.853885	
   11.220997	    6.432348	   11.853885	
   12.543987	   12.994326	    8.146115	
    7.456013	    7.005674	    8.146115	
   10.000000	   10.000000	   10.558955	
   10.000000	   12.487524	   10.616634	
   10.000000	    7.512476	   10.616634	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.185 ms
Set up communicators.

--set up spincomm took 2.226 ms

--set up kptcomm took 0.367 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.045 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.373 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.347 ms

Calculate_SplineDerivRadFun took 0.213 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.763 ms.
time spent on vectorized spline interp: 3.103 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.715 ms.
time spent on vectorized spline interp: 1.339 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.301 ms.
time spent on vectorized spline interp: 1.637 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.273 ms.

Calculating rb for all atom types took 16.142 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.822 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000314402, sum_int_rho = 27.5897046073566
PosCharge = 28.000000031440, NegCharge = -27.589704607357, scal_fac = 1.014871323558
After scaling, int_rho = 28.0000000314401, PosCharge + NegCharge - NetCharge = 1.847e-13
--Calculate Vref took 0.589 ms
--Calculate rho_guess took 3.342 ms

 integral of b = -28.0000000314402,
 int{b} + Nelectron + NetCharge = -3.144e-08,
 Esc = -84.8967696970510,
 MPI_Reduce took 9.313 ms

Calculating b & b_ref took 20.899 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.075 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.083 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.109 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.685 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.480 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144010, int_b + int_rho = 5.457e-14, checking this took 0.512 ms
2-norm of RHS = 735.0520978345415, which took 0.522 ms

iter_count = 420, r_2norm = 6.699e-04, tol*||rhs|| = 7.351e-04

Anderson update took 232.495 ms, out of which F'*F took 105.792 ms; b-Ax took 721.846 ms, out of which Lap took 648.044 ms
Solving Poisson took 1524.918 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.111732 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.835 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.100695 
Total time for convolution: 	 convolve: 5.183244 
Total time for convolution: 	 convolve: 5.148443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.966 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.475 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, XC calculation took 24427.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 4.785 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.362 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.272 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.139 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.685 ms
    Lanczos iter 53, eigmin  = -1.043548903, eigmax = 264.934185962, err_eigmin = 8.955e-04, err_eigmax = 9.799e-03
rank =   0, Lanczos took 120.746 ms, eigmin = -1.043548903484, eigmax = 267.583527821804

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.219989, lowerbound = -1.143549, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1431.585 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 75.367 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.789 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 78.172 ms
rank =  0, finding HY took 25.997 ms
rank =  0, distributing HY into block cyclic form took 19.476 ms
rank =  0, finding Y'*HY took 4.091 ms
Rank 0, Project_Hamiltonian used 128.502 ms
Total time for projection: 128.522 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.298 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.282 ms
rank = 0, Solve_Generalized_EigenProblem used 1.584 ms
    first calculated eigval = 2.745124178103765
    last  calculated eigval = 3.257130630140979
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.82678871830641
lambda[   6] =   2.85038556226658
lambda[   7] =   2.90457403534780
lambda[   8] =   2.92566348874960
lambda[   9] =   2.97451692457698
lambda[  10] =   2.98587307854382
lambda[  11] =   3.00120862530649
lambda[  12] =   3.00716369943933
lambda[  13] =   3.02318468419205
lambda[  14] =   3.03219569030464
lambda[  15] =   3.07409901095960
lambda[  16] =   3.12259192421890
lambda[  17] =   3.14125882426174
lambda[  18] =   3.15721985442604
lambda[  19] =   3.17089255460735
lambda[  20] =   3.21704975466661
lambda[  21] =   3.25713063014098
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.600 ms
rank =  0, subspace rotation using ScaLAPACK took 8.147 ms
rank =  0, Distributing orbital back into band + domain format took 18.088 ms
rank = 0, Subspace_Rotation used 26.244 ms

Total time for subspace rotation: 26.247 ms
rank = 0, Efermi =   3.053147786624 calculate fermi energy took 0.046 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.357131, lowerbound = -1.143549, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1472.325 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 45.213 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.986 ms
rank =  0, finding HY took 25.088 ms
rank =  0, distributing HY into block cyclic form took 19.747 ms
rank =  0, finding Y'*HY took 4.079 ms
Rank 0, Project_Hamiltonian used 96.933 ms
Total time for projection: 96.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -0.940162625673373
    last  calculated eigval = 0.439715879594682
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.33135217940842
lambda[   6] =  -0.29088795738484
lambda[   7] =  -0.13923139957259
lambda[   8] =  -0.10403753558288
lambda[   9] =  -0.00828384403538
lambda[  10] =   0.01519670543041
lambda[  11] =   0.11710076406377
lambda[  12] =   0.19978465832268
lambda[  13] =   0.20975454770280
lambda[  14] =   0.27961577116181
lambda[  15] =   0.31398713985239
lambda[  16] =   0.34016909618847
lambda[  17] =   0.34112382277937
lambda[  18] =   0.36250028688960
lambda[  19] =   0.38428837057054
lambda[  20] =   0.42239274097928
lambda[  21] =   0.43971587959468
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.225 ms
rank =  0, subspace rotation using ScaLAPACK took 8.076 ms
rank =  0, Distributing orbital back into band + domain format took 17.920 ms
rank = 0, Subspace_Rotation used 26.006 ms

Total time for subspace rotation: 26.010 ms
rank = 0, Efermi =   0.296801479757 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.539716, lowerbound = -1.143549, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1472.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 33.396 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 35.951 ms
rank =  0, finding HY took 25.469 ms
rank =  0, distributing HY into block cyclic form took 18.097 ms
rank =  0, finding Y'*HY took 4.053 ms
Rank 0, Project_Hamiltonian used 84.486 ms
Total time for projection: 84.491 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.053390438268973
    last  calculated eigval = 0.150789480476102
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.63237194157644
lambda[   6] =  -0.60564033047727
lambda[   7] =  -0.51482024729991
lambda[   8] =  -0.51050856829458
lambda[   9] =  -0.43141958324957
lambda[  10] =  -0.41591180910674
lambda[  11] =  -0.41073295880849
lambda[  12] =  -0.39446291532201
lambda[  13] =  -0.28439908205724
lambda[  14] =  -0.26208735904059
lambda[  15] =  -0.03775178229967
lambda[  16] =  -0.03006952895567
lambda[  17] =   0.05998636043414
lambda[  18] =   0.09845337006475
lambda[  19] =   0.10339187099968
lambda[  20] =   0.11795775333419
lambda[  21] =   0.15078948047610
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.105 ms
rank =  0, Distributing orbital back into band + domain format took 17.850 ms
rank = 0, Subspace_Rotation used 25.964 ms

Total time for subspace rotation: 25.968 ms
rank = 0, Efermi =  -0.066508776166 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.250789, lowerbound = -1.143549, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1468.544 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 43.489 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.602 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.106 ms
rank =  0, finding HY took 25.370 ms
rank =  0, distributing HY into block cyclic form took 18.016 ms
rank =  0, finding Y'*HY took 4.024 ms
Rank 0, Project_Hamiltonian used 93.538 ms
Total time for projection: 93.542 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.053487716278431
    last  calculated eigval = 0.086425853956472
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.63425083029240
lambda[   6] =  -0.60757413956660
lambda[   7] =  -0.52013470334730
lambda[   8] =  -0.51897319540022
lambda[   9] =  -0.43988988151366
lambda[  10] =  -0.42900989849423
lambda[  11] =  -0.42395875556093
lambda[  12] =  -0.42250134718178
lambda[  13] =  -0.30463134338610
lambda[  14] =  -0.30378777736918
lambda[  15] =  -0.10666043767136
lambda[  16] =  -0.10074119790162
lambda[  17] =   0.01715359947528
lambda[  18] =   0.03408545533740
lambda[  19] =   0.06566507635256
lambda[  20] =   0.07072527619683
lambda[  21] =   0.08642585395647
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.106 ms
rank =  0, Distributing orbital back into band + domain format took 17.930 ms
rank = 0, Subspace_Rotation used 26.048 ms

Total time for subspace rotation: 26.928 ms
rank = 0, Efermi =  -0.135418093253 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 5.167 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.093 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.607 ms
rank = 0, Calculating density took 6497.169 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.906 ms
rank = 0, Transfering density took 1.912 ms
Etot    =   -53.572099063233
Eband   =   -16.577322987075
E1      =    32.223669822177
E2      =   -13.904819147700
E3      =   -17.391609782899
Exc     =   -15.618105130951
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.952e+00, dEband = 1.842e+00
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -53.572099063, dEtot = 5.952e+00, dEband = 1.842e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 64.6870683220996, which took 1.279 ms

iter_count = 96, r_2norm = 1.662e-03, tol*||rhs|| = 2.587e-03

Anderson update took 51.272 ms, out of which F'*F took 24.067 ms; b-Ax took 162.962 ms, out of which Lap took 146.267 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.916 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144006, int_b + int_rho = 1.455e-14, checking this took 0.101 ms
2-norm of RHS = 730.7079329536762, which took 0.121 ms

iter_count = 288, r_2norm = 6.089e-04, tol*||rhs|| = 7.307e-04

Anderson update took 157.889 ms, out of which F'*F took 71.863 ms; b-Ax took 482.847 ms, out of which Lap took 434.007 ms
Solving Poisson took 1037.190 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.159777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.185631 
Total time for convolution: 	 convolve: 5.182373 
Total time for convolution: 	 convolve: 5.154145 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.440 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.233 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.703 ms

This SCF took 32569.036 ms, scf error = 1.458e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186426, lowerbound = -1.053488, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1421.393 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 79.251 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 81.841 ms
rank =  0, finding HY took 24.997 ms
rank =  0, distributing HY into block cyclic form took 18.471 ms
rank =  0, finding Y'*HY took 4.093 ms
Rank 0, Project_Hamiltonian used 129.426 ms
Total time for projection: 129.450 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -1.027668225441810
    last  calculated eigval = 0.051500072545780
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60974542276567
lambda[   6] =  -0.57693349134956
lambda[   7] =  -0.49431814459747
lambda[   8] =  -0.49280641163637
lambda[   9] =  -0.40976814717674
lambda[  10] =  -0.40123069804786
lambda[  11] =  -0.39887734356180
lambda[  12] =  -0.39370982262240
lambda[  13] =  -0.27209397872478
lambda[  14] =  -0.27170709478490
lambda[  15] =  -0.08707674556318
lambda[  16] =  -0.08583343980681
lambda[  17] =  -0.01356926585275
lambda[  18] =   0.00828301730199
lambda[  19] =   0.04185848053972
lambda[  20] =   0.04694753070646
lambda[  21] =   0.05150007254578
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 8.198 ms
rank =  0, Distributing orbital back into band + domain format took 18.068 ms
rank = 0, Subspace_Rotation used 26.280 ms

Total time for subspace rotation: 26.287 ms
rank = 0, Efermi =  -0.116033622509 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.253 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.606 ms
rank = 0, Calculating density took 1594.748 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.923 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -53.507429690069
Eband   =   -15.749326798765
E1      =    31.536212393289
E2      =   -13.787984574794
E3      =   -17.598047638026
Exc     =   -15.783577799416
Esc     =   -84.896769697051
Entropy =    -0.000000000946
dE = 7.185e-03, dEband = 9.200e-02
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -53.507429690, dEtot = 7.185e-03, dEband = 9.200e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.1531891238912, which took 0.055 ms

iter_count = 102, r_2norm = 6.303e-04, tol*||rhs|| = 9.661e-04

Anderson update took 55.054 ms, out of which F'*F took 25.704 ms; b-Ax took 174.394 ms, out of which Lap took 156.099 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.969 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144014, int_b + int_rho = 9.823e-14, checking this took 0.108 ms
2-norm of RHS = 726.2113936249334, which took 0.101 ms

iter_count = 300, r_2norm = 6.674e-04, tol*||rhs|| = 7.262e-04

Anderson update took 175.503 ms, out of which F'*F took 75.847 ms; b-Ax took 511.553 ms, out of which Lap took 457.425 ms
Solving Poisson took 1101.892 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.149751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.890 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.159560 
Total time for convolution: 	 convolve: 5.153768 
Total time for convolution: 	 convolve: 5.215484 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.513 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.470 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.274 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.777 ms

This SCF took 27846.661 ms, scf error = 9.709e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.151500, lowerbound = -1.027668, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1441.324 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 62.527 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.965 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 65.504 ms
rank =  0, finding HY took 25.477 ms
rank =  0, distributing HY into block cyclic form took 18.380 ms
rank =  0, finding Y'*HY took 4.186 ms
Rank 0, Project_Hamiltonian used 113.573 ms
Total time for projection: 113.596 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.991258219509447
    last  calculated eigval = 0.044168180446966
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.56974563742346
lambda[   6] =  -0.52663237687141
lambda[   7] =  -0.45053404778218
lambda[   8] =  -0.44845517957811
lambda[   9] =  -0.36647874093047
lambda[  10] =  -0.36228376647915
lambda[  11] =  -0.36120786870578
lambda[  12] =  -0.34760085835234
lambda[  13] =  -0.22568929526410
lambda[  14] =  -0.22521369544056
lambda[  15] =  -0.05335758820748
lambda[  16] =  -0.04745887779782
lambda[  17] =  -0.01884398169692
lambda[  18] =   0.00269081336219
lambda[  19] =   0.02053369272170
lambda[  20] =   0.03722148630894
lambda[  21] =   0.04416818044697
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 7.766 ms
rank =  0, Distributing orbital back into band + domain format took 18.720 ms
rank = 0, Subspace_Rotation used 26.500 ms

Total time for subspace rotation: 26.506 ms
rank = 0, Efermi =  -0.082115263669 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 5.240 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.661 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.615 ms
rank = 0, Calculating density took 1599.047 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.840 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -53.459109458158
Eband   =   -14.487950753155
E1      =    30.530503980967
E2      =   -13.512592009220
E3      =   -17.936361170334
Exc     =   -16.053846167540
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.369e-03, dEband = 1.402e-01
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -53.459109458, dEtot = 5.369e-03, dEband = 1.402e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.5606981037696, which took 0.062 ms

iter_count = 102, r_2norm = 2.486e-04, tol*||rhs|| = 3.024e-04

Anderson update took 54.803 ms, out of which F'*F took 26.133 ms; b-Ax took 178.029 ms, out of which Lap took 159.159 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.120 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003143999, int_b + int_rho = -5.821e-14, checking this took 0.109 ms
2-norm of RHS = 727.1334280220847, which took 0.119 ms

iter_count = 276, r_2norm = 6.953e-04, tol*||rhs|| = 7.271e-04

Anderson update took 153.276 ms, out of which F'*F took 70.094 ms; b-Ax took 469.863 ms, out of which Lap took 421.678 ms
Solving Poisson took 1001.884 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.194985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.151746 
Total time for convolution: 	 convolve: 5.153082 
Total time for convolution: 	 convolve: 5.147215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.246 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.743 ms

This SCF took 27665.641 ms, scf error = 3.473e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.144168, lowerbound = -0.991258, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1436.483 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 72.861 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.605 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 75.484 ms
rank =  0, finding HY took 24.861 ms
rank =  0, distributing HY into block cyclic form took 18.203 ms
rank =  0, finding Y'*HY took 4.022 ms
Rank 0, Project_Hamiltonian used 122.596 ms
Total time for projection: 122.617 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.437 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.273 ms
rank = 0, Solve_Generalized_EigenProblem used 1.724 ms
    first calculated eigval = -0.984228760193318
    last  calculated eigval = 0.039362508241294
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55854965202839
lambda[   6] =  -0.51345402420508
lambda[   7] =  -0.43550420166729
lambda[   8] =  -0.43356837273041
lambda[   9] =  -0.35728386022897
lambda[  10] =  -0.35281426861105
lambda[  11] =  -0.35233172757146
lambda[  12] =  -0.33687107960993
lambda[  13] =  -0.21532063936315
lambda[  14] =  -0.21481762812631
lambda[  15] =  -0.04650557447358
lambda[  16] =  -0.03654540888005
lambda[  17] =  -0.01751773148395
lambda[  18] =   0.00200518769537
lambda[  19] =   0.01041806682537
lambda[  20] =   0.03347268556231
lambda[  21] =   0.03936250824129
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.739 ms
rank =  0, subspace rotation using ScaLAPACK took 7.572 ms
rank =  0, Distributing orbital back into band + domain format took 32.133 ms
rank = 0, Subspace_Rotation used 39.718 ms

Total time for subspace rotation: 39.723 ms
rank = 0, Efermi =  -0.075262502704 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.349 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.376 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.755 ms
rank = 0, Calculating density took 1618.939 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.969 ms
rank = 0, D2D took 2.078 ms
rank = 0, Transfering density took 2.085 ms
Etot    =   -53.454339726507
Eband   =   -14.165677157883
E1      =    30.335687360492
E2      =   -13.369969696461
E3      =   -18.020623153624
Exc     =   -16.118173081219
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.300e-04, dEband = 3.581e-02
rank = 0, Calculating/Estimating energy took 0.892 ms, Etot = -53.454339727, dEtot = 5.300e-04, dEband = 3.581e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.1885769037597, which took 0.073 ms

iter_count = 108, r_2norm = 8.391e-05, tol*||rhs|| = 1.275e-04

Anderson update took 58.041 ms, out of which F'*F took 27.016 ms; b-Ax took 183.207 ms, out of which Lap took 163.028 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.063 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003143996, int_b + int_rho = -8.731e-14, checking this took 0.127 ms
2-norm of RHS = 727.9637008356400, which took 0.132 ms

iter_count = 264, r_2norm = 6.024e-04, tol*||rhs|| = 7.280e-04

Anderson update took 142.209 ms, out of which F'*F took 66.007 ms; b-Ax took 460.493 ms, out of which Lap took 413.614 ms
Solving Poisson took 971.511 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.166482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.273 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.176366 
Total time for convolution: 	 convolve: 5.159802 
Total time for convolution: 	 convolve: 5.159504 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.458 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.530 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.023 ms

This SCF took 27686.392 ms, scf error = 1.339e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139363, lowerbound = -0.984229, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1429.504 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 74.323 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 78.551 ms
rank =  0, finding HY took 23.813 ms
rank =  0, distributing HY into block cyclic form took 18.029 ms
rank =  0, finding Y'*HY took 4.134 ms
Rank 0, Project_Hamiltonian used 124.553 ms
Total time for projection: 124.573 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.184 ms
rank = 0, Solve_Generalized_EigenProblem used 0.309 ms
    first calculated eigval = -0.979297534842671
    last  calculated eigval = 0.036293999121944
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55335655631903
lambda[   6] =  -0.50818762949133
lambda[   7] =  -0.42932311205583
lambda[   8] =  -0.42744830394879
lambda[   9] =  -0.35198121835256
lambda[  10] =  -0.34790673077945
lambda[  11] =  -0.34750780667696
lambda[  12] =  -0.33140493487150
lambda[  13] =  -0.21053899669595
lambda[  14] =  -0.21002810486027
lambda[  15] =  -0.04444101479466
lambda[  16] =  -0.03254618387913
lambda[  17] =  -0.01641109665818
lambda[  18] =   0.00186125031458
lambda[  19] =   0.00575944079163
lambda[  20] =   0.03087289147573
lambda[  21] =   0.03629399912194
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.320 ms
rank =  0, subspace rotation using ScaLAPACK took 7.620 ms
rank =  0, Distributing orbital back into band + domain format took 18.105 ms
rank = 0, Subspace_Rotation used 25.735 ms

Total time for subspace rotation: 25.738 ms
rank = 0, Efermi =  -0.073197940493 calculate fermi energy took 0.637 ms
rank = 0, --- Calculate rho: sum over local bands took 5.245 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.513 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1597.195 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.810 ms
rank = 0, D2D took 1.909 ms
rank = 0, Transfering density took 1.916 ms
Etot    =   -53.453240737370
Eband   =   -14.016843577738
E1      =    30.271827709105
E2      =   -13.276231491140
E3      =   -18.053954304009
Exc     =   -16.141640965904
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 1.221e-04, dEband = 1.654e-02
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -53.453240737, dEtot = 1.221e-04, dEband = 1.654e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8850281166725, which took 0.073 ms

iter_count = 114, r_2norm = 2.281e-05, tol*||rhs|| = 3.540e-05

Anderson update took 61.187 ms, out of which F'*F took 28.790 ms; b-Ax took 192.662 ms, out of which Lap took 172.290 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.448 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144007, int_b + int_rho = 2.547e-14, checking this took 0.101 ms
2-norm of RHS = 728.4027447407677, which took 0.139 ms

iter_count = 246, r_2norm = 6.251e-04, tol*||rhs|| = 7.284e-04

Anderson update took 131.950 ms, out of which F'*F took 62.674 ms; b-Ax took 419.453 ms, out of which Lap took 376.600 ms
Solving Poisson took 887.254 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.075 ms
Total time for convolution: 	 convolve: 5.160268 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.850 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.195757 
Total time for convolution: 	 convolve: 5.197602 
Total time for convolution: 	 convolve: 5.150646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.034 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.536 ms

This SCF took 27645.592 ms, scf error = 5.735e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136294, lowerbound = -0.979298, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1433.591 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 69.688 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.562 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 72.267 ms
rank =  0, finding HY took 24.778 ms
rank =  0, distributing HY into block cyclic form took 18.187 ms
rank =  0, finding Y'*HY took 4.014 ms
Rank 0, Project_Hamiltonian used 119.273 ms
Total time for projection: 119.290 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.976332259121161
    last  calculated eigval = 0.035083415278250
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55098905543054
lambda[   6] =  -0.50617616667898
lambda[   7] =  -0.42705337656679
lambda[   8] =  -0.42515944682330
lambda[   9] =  -0.34923001637322
lambda[  10] =  -0.34536765344568
lambda[  11] =  -0.34493668225997
lambda[  12] =  -0.32889673035131
lambda[  13] =  -0.20834563824736
lambda[  14] =  -0.20783662413251
lambda[  15] =  -0.04356100733745
lambda[  16] =  -0.03105387385376
lambda[  17] =  -0.01588392871742
lambda[  18] =   0.00187946301467
lambda[  19] =   0.00382993813457
lambda[  20] =   0.02854063958699
lambda[  21] =   0.03508341527825
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 7.604 ms
rank =  0, Distributing orbital back into band + domain format took 18.194 ms
rank = 0, Subspace_Rotation used 25.815 ms

Total time for subspace rotation: 25.820 ms
rank = 0, Efermi =  -0.072317932941 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.285 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 1595.520 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.813 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -53.452921807897
Eband   =   -13.950477597231
E1      =    30.253932040694
E2      =   -13.224534654775
E3      =   -18.062145345207
Exc     =   -16.146286553360
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 3.544e-05, dEband = 7.374e-03
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -53.452921808, dEtot = 3.544e-05, dEband = 7.374e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3937182151092, which took 0.121 ms

iter_count = 108, r_2norm = 1.572e-05, tol*||rhs|| = 1.575e-05

Anderson update took 57.440 ms, out of which F'*F took 26.948 ms; b-Ax took 183.417 ms, out of which Lap took 164.002 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.774 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144003, int_b + int_rho = -1.819e-14, checking this took 0.098 ms
2-norm of RHS = 728.5752641275286, which took 0.124 ms

iter_count = 252, r_2norm = 6.218e-04, tol*||rhs|| = 7.286e-04

Anderson update took 134.618 ms, out of which F'*F took 63.382 ms; b-Ax took 428.216 ms, out of which Lap took 383.659 ms
Solving Poisson took 905.687 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.154816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 56.263 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.197351 
Total time for convolution: 	 convolve: 5.154142 
Total time for convolution: 	 convolve: 5.155061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.729 ms
---Transfer Veff_loc: D2D took 4.407 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.438 ms

This SCF took 27612.118 ms, scf error = 2.836e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135083, lowerbound = -0.976332, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1434.747 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 70.738 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.615 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 73.367 ms
rank =  0, finding HY took 24.751 ms
rank =  0, distributing HY into block cyclic form took 18.250 ms
rank =  0, finding Y'*HY took 3.981 ms
Rank 0, Project_Hamiltonian used 120.371 ms
Total time for projection: 120.385 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.972073281001898
    last  calculated eigval = 0.036583478450446
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54673997874730
lambda[   6] =  -0.50167319838348
lambda[   7] =  -0.42269591179471
lambda[   8] =  -0.42075748843034
lambda[   9] =  -0.34487573428929
lambda[  10] =  -0.34103598961948
lambda[  11] =  -0.34059835649620
lambda[  12] =  -0.32448131805256
lambda[  13] =  -0.20391792591724
lambda[  14] =  -0.20341207962836
lambda[  15] =  -0.04133814775737
lambda[  16] =  -0.02740006212919
lambda[  17] =  -0.01330257381927
lambda[  18] =   0.00354830089508
lambda[  19] =   0.00455434421291
lambda[  20] =   0.02740706838651
lambda[  21] =   0.03658347845045
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 7.635 ms
rank =  0, Distributing orbital back into band + domain format took 18.131 ms
rank = 0, Subspace_Rotation used 25.777 ms

Total time for subspace rotation: 25.782 ms
rank = 0, Efermi =  -0.070095073307 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.284 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.631 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1597.811 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -53.452688377471
Eband   =   -13.826784437404
E1      =    30.193738858355
E2      =   -13.156877289917
E3      =   -18.076859664871
Exc     =   -16.156610055227
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 2.594e-05, dEband = 1.374e-02
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -53.452688377, dEtot = 2.594e-05, dEband = 1.374e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2671448930448, which took 0.072 ms

iter_count = 114, r_2norm = 7.270e-06, tol*||rhs|| = 1.069e-05

Anderson update took 60.271 ms, out of which F'*F took 28.279 ms; b-Ax took 194.500 ms, out of which Lap took 173.820 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.391 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144003, int_b + int_rho = -1.819e-14, checking this took 0.105 ms
2-norm of RHS = 728.5561135313337, which took 0.105 ms

iter_count = 210, r_2norm = 7.194e-04, tol*||rhs|| = 7.286e-04

Anderson update took 111.139 ms, out of which F'*F took 52.608 ms; b-Ax took 353.899 ms, out of which Lap took 316.781 ms
Solving Poisson took 752.425 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.171899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.908 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.167401 
Total time for convolution: 	 convolve: 5.163746 
Total time for convolution: 	 convolve: 5.167688 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.586 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.826 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
---Transfer Veff_loc: D2D took 3.532 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.026 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.591 ms

This SCF took 27463.692 ms, scf error = 1.283e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.136583, lowerbound = -0.972073, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1431.308 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 68.254 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.643 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 70.914 ms
rank =  0, finding HY took 24.704 ms
rank =  0, distributing HY into block cyclic form took 18.292 ms
rank =  0, finding Y'*HY took 4.367 ms
Rank 0, Project_Hamiltonian used 118.302 ms
Total time for projection: 118.318 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.971089808453999
    last  calculated eigval = 0.036346738121461
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54577335908373
lambda[   6] =  -0.50066670486244
lambda[   7] =  -0.42171348359357
lambda[   8] =  -0.41976616071304
lambda[   9] =  -0.34385839593955
lambda[  10] =  -0.34002554646211
lambda[  11] =  -0.33958807673038
lambda[  12] =  -0.32346372857384
lambda[  13] =  -0.20283991493493
lambda[  14] =  -0.20233118464036
lambda[  15] =  -0.04056686215959
lambda[  16] =  -0.02650349431705
lambda[  17] =  -0.01257210111790
lambda[  18] =   0.00470710248540
lambda[  19] =   0.00544475559957
lambda[  20] =   0.02676716091241
lambda[  21] =   0.03634673812146
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 7.639 ms
rank =  0, Distributing orbital back into band + domain format took 18.135 ms
rank = 0, Subspace_Rotation used 25.785 ms

Total time for subspace rotation: 25.789 ms
rank = 0, Efermi =  -0.069323787667 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.306 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.571 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1592.227 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.806 ms
rank = 0, D2D took 1.897 ms
rank = 0, Transfering density took 1.899 ms
Etot    =   -53.452738974776
Eband   =   -13.798274945613
E1      =    30.180082744862
E2      =   -13.141677897322
E3      =   -18.077917301818
Exc     =   -16.157372275181
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.622e-06, dEband = 3.168e-03
rank = 0, Calculating/Estimating energy took 1.767 ms, Etot = -53.452738975, dEtot = 5.622e-06, dEband = 3.168e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1408718089047, which took 0.055 ms

iter_count = 114, r_2norm = 3.685e-06, tol*||rhs|| = 5.635e-06

Anderson update took 60.658 ms, out of which F'*F took 28.404 ms; b-Ax took 192.803 ms, out of which Lap took 172.143 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003143997, int_b + int_rho = -7.276e-14, checking this took 0.098 ms
2-norm of RHS = 728.5501472930185, which took 0.143 ms

iter_count = 222, r_2norm = 6.675e-04, tol*||rhs|| = 7.286e-04

Anderson update took 119.184 ms, out of which F'*F took 55.895 ms; b-Ax took 373.140 ms, out of which Lap took 335.754 ms
Solving Poisson took 796.044 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.156083 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.187205 
Total time for convolution: 	 convolve: 5.159436 
Total time for convolution: 	 convolve: 5.219315 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.767 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.000 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.537 ms

This SCF took 27585.287 ms, scf error = 9.257e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.136347, lowerbound = -0.971090, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1427.379 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 71.495 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.590 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 74.101 ms
rank =  0, finding HY took 24.673 ms
rank =  0, distributing HY into block cyclic form took 18.159 ms
rank =  0, finding Y'*HY took 3.986 ms
Rank 0, Project_Hamiltonian used 120.944 ms
Total time for projection: 120.964 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.969619569703049
    last  calculated eigval = 0.037395788264690
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54426196631914
lambda[   6] =  -0.49913021205950
lambda[   7] =  -0.42006534440298
lambda[   8] =  -0.41812284743034
lambda[   9] =  -0.34232178971614
lambda[  10] =  -0.33849127058808
lambda[  11] =  -0.33806469504252
lambda[  12] =  -0.32190801640019
lambda[  13] =  -0.20127238229687
lambda[  14] =  -0.20075840021790
lambda[  15] =  -0.03826028495434
lambda[  16] =  -0.02460485246623
lambda[  17] =  -0.01099794034008
lambda[  18] =   0.00848950596644
lambda[  19] =   0.00969076563431
lambda[  20] =   0.02781647788364
lambda[  21] =   0.03739578826469
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.674 ms
rank =  0, Distributing orbital back into band + domain format took 18.126 ms
rank = 0, Subspace_Rotation used 25.811 ms

Total time for subspace rotation: 25.817 ms
rank = 0, Efermi =  -0.067017210485 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.256 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.530 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1590.909 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.703 ms
rank = 0, D2D took 2.799 ms
rank = 0, Transfering density took 2.801 ms
Etot    =   -53.452747913380
Eband   =   -13.754515645658
E1      =    30.159090443259
E2      =   -13.118366092170
E3      =   -18.080293166657
Exc     =   -16.159212271823
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 9.932e-07, dEband = 4.862e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -53.452747913, dEtot = 9.932e-07, dEband = 4.862e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1266799287021, which took 0.191 ms

iter_count = 108, r_2norm = 4.620e-06, tol*||rhs|| = 5.067e-06

Anderson update took 57.223 ms, out of which F'*F took 27.107 ms; b-Ax took 183.403 ms, out of which Lap took 164.563 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.893 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144013, int_b + int_rho = 8.004e-14, checking this took 0.107 ms
2-norm of RHS = 728.5401953964229, which took 0.128 ms

iter_count = 192, r_2norm = 6.005e-04, tol*||rhs|| = 7.285e-04

Anderson update took 102.510 ms, out of which F'*F took 48.122 ms; b-Ax took 322.984 ms, out of which Lap took 289.683 ms
Solving Poisson took 688.598 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.159125 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.311 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.169415 
Total time for convolution: 	 convolve: 5.158242 
Total time for convolution: 	 convolve: 5.154929 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.016 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.564 ms

This SCF took 27372.165 ms, scf error = 5.402e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137396, lowerbound = -0.969620, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1435.564 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 75.338 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.649 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 78.003 ms
rank =  0, finding HY took 24.673 ms
rank =  0, distributing HY into block cyclic form took 18.143 ms
rank =  0, finding Y'*HY took 3.970 ms
Rank 0, Project_Hamiltonian used 124.819 ms
Total time for projection: 124.838 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.968736366975693
    last  calculated eigval = 0.036749098222274
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54342792027168
lambda[   6] =  -0.49828560657981
lambda[   7] =  -0.41924802271327
lambda[   8] =  -0.41730278457544
lambda[   9] =  -0.34147970792001
lambda[  10] =  -0.33765398216592
lambda[  11] =  -0.33722560333424
lambda[  12] =  -0.32106720820629
lambda[  13] =  -0.20047106599472
lambda[  14] =  -0.19995689535820
lambda[  15] =  -0.03719306864884
lambda[  16] =  -0.02373750598281
lambda[  17] =  -0.01002159208288
lambda[  18] =   0.01002868952433
lambda[  19] =   0.01119303092919
lambda[  20] =   0.02848306461882
lambda[  21] =   0.03674909822227
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 7.624 ms
rank =  0, Distributing orbital back into band + domain format took 18.128 ms
rank = 0, Subspace_Rotation used 25.764 ms

Total time for subspace rotation: 25.769 ms
rank = 0, Efermi =  -0.065949994082 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.198 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.798 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1603.048 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.915 ms
rank = 0, Transfering density took 1.916 ms
Etot    =   -53.452812863677
Eband   =   -13.731136835658
E1      =    30.146288436265
E2      =   -13.107238191001
E3      =   -18.082631829934
Exc     =   -16.161064787236
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 7.217e-06, dEband = 2.598e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -53.452812864, dEtot = 7.217e-06, dEband = 2.598e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0891585201434, which took 0.059 ms

iter_count = 114, r_2norm = 2.350e-06, tol*||rhs|| = 3.566e-06

Anderson update took 60.713 ms, out of which F'*F took 28.692 ms; b-Ax took 194.112 ms, out of which Lap took 173.769 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.696 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144007, int_b + int_rho = 2.910e-14, checking this took 0.106 ms
2-norm of RHS = 728.5532010035556, which took 0.122 ms

iter_count = 168, r_2norm = 6.100e-04, tol*||rhs|| = 7.286e-04

Anderson update took 89.450 ms, out of which F'*F took 42.085 ms; b-Ax took 283.769 ms, out of which Lap took 254.417 ms
Solving Poisson took 603.818 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.155154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.158314 
Total time for convolution: 	 convolve: 5.200042 
Total time for convolution: 	 convolve: 5.163736 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.516 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.033 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.582 ms

This SCF took 27340.094 ms, scf error = 3.966e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136749, lowerbound = -0.968736, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1422.673 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 82.361 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.537 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 84.914 ms
rank =  0, finding HY took 24.759 ms
rank =  0, distributing HY into block cyclic form took 18.199 ms
rank =  0, finding Y'*HY took 4.025 ms
Rank 0, Project_Hamiltonian used 131.921 ms
Total time for projection: 131.937 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.968496343450135
    last  calculated eigval = 0.036587651136311
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54316345459515
lambda[   6] =  -0.49802163926087
lambda[   7] =  -0.41896874720307
lambda[   8] =  -0.41702682599115
lambda[   9] =  -0.34125305259836
lambda[  10] =  -0.33740913384535
lambda[  11] =  -0.33698497671384
lambda[  12] =  -0.32083328318741
lambda[  13] =  -0.20020167405170
lambda[  14] =  -0.19968665922327
lambda[  15] =  -0.03659030294913
lambda[  16] =  -0.02340746897456
lambda[  17] =  -0.00950838218670
lambda[  18] =   0.01079381970264
lambda[  19] =   0.01204093560990
lambda[  20] =   0.02887138140479
lambda[  21] =   0.03658765113631
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.612 ms
rank =  0, Distributing orbital back into band + domain format took 18.462 ms
rank = 0, Subspace_Rotation used 26.084 ms

Total time for subspace rotation: 26.089 ms
rank = 0, Efermi =  -0.065347228466 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.277 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.540 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1597.472 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.825 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.920 ms
Etot    =   -53.452851282448
Eband   =   -13.723893822922
E1      =    30.143086028082
E2      =   -13.103118118191
E3      =   -18.082867084055
Exc     =   -16.161258991870
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 4.269e-06, dEband = 8.048e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -53.452851282, dEtot = 4.269e-06, dEband = 8.048e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0494083973705, which took 0.058 ms

iter_count = 108, r_2norm = 1.876e-06, tol*||rhs|| = 1.976e-06

Anderson update took 57.933 ms, out of which F'*F took 27.096 ms; b-Ax took 185.441 ms, out of which Lap took 166.860 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.099 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144021, int_b + int_rho = 1.673e-13, checking this took 0.121 ms
2-norm of RHS = 728.5694967604244, which took 0.132 ms

iter_count = 192, r_2norm = 6.190e-04, tol*||rhs|| = 7.286e-04

Anderson update took 103.235 ms, out of which F'*F took 48.270 ms; b-Ax took 326.010 ms, out of which Lap took 292.515 ms
Solving Poisson took 692.867 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.165635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.466 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.155779 
Total time for convolution: 	 convolve: 5.170377 
Total time for convolution: 	 convolve: 5.161106 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.535 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.480 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.525 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.041 ms

This SCF took 27792.331 ms, scf error = 3.153e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136588, lowerbound = -0.968496, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1432.621 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 70.951 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.622 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 73.589 ms
rank =  0, finding HY took 24.705 ms
rank =  0, distributing HY into block cyclic form took 18.193 ms
rank =  0, finding Y'*HY took 3.973 ms
Rank 0, Project_Hamiltonian used 120.489 ms
Total time for projection: 120.504 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.967703848583775
    last  calculated eigval = 0.037854733100493
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54235939324995
lambda[   6] =  -0.49721391991466
lambda[   7] =  -0.41816756255758
lambda[   8] =  -0.41622770222194
lambda[   9] =  -0.34049928572803
lambda[  10] =  -0.33663231780894
lambda[  11] =  -0.33621174123762
lambda[  12] =  -0.32007270075974
lambda[  13] =  -0.19940132050398
lambda[  14] =  -0.19888569605694
lambda[  15] =  -0.03461749014964
lambda[  16] =  -0.02242751203251
lambda[  17] =  -0.00731829432919
lambda[  18] =   0.01379273235516
lambda[  19] =   0.01499417699270
lambda[  20] =   0.03118660604644
lambda[  21] =   0.03785473310049
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.600 ms
rank =  0, Distributing orbital back into band + domain format took 18.539 ms
rank = 0, Subspace_Rotation used 26.150 ms

Total time for subspace rotation: 26.154 ms
rank = 0, Efermi =  -0.063374415780 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.239 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.628 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1596.153 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.929 ms
rank = 0, Transfering density took 1.931 ms
Etot    =   -53.452926179273
Eband   =   -13.701684365394
E1      =    30.132084670962
E2      =   -13.091558637058
E3      =   -18.084298437124
Exc     =   -16.162413861040
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 8.322e-06, dEband = 2.468e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -53.452926179, dEtot = 8.322e-06, dEband = 2.468e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0488177435267, which took 0.063 ms

iter_count = 108, r_2norm = 1.911e-06, tol*||rhs|| = 1.953e-06

Anderson update took 57.806 ms, out of which F'*F took 27.280 ms; b-Ax took 183.586 ms, out of which Lap took 164.686 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.987 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144005, int_b + int_rho = 0.000e+00, checking this took 0.107 ms
2-norm of RHS = 728.5709731381141, which took 0.106 ms

iter_count = 156, r_2norm = 6.230e-04, tol*||rhs|| = 7.286e-04

Anderson update took 83.769 ms, out of which F'*F took 39.350 ms; b-Ax took 263.968 ms, out of which Lap took 237.324 ms
Solving Poisson took 562.806 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.169812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.360 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.153691 
Total time for convolution: 	 convolve: 5.165123 
Total time for convolution: 	 convolve: 5.157791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.459 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.012 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.503 ms

This SCF took 27259.895 ms, scf error = 1.937e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137855, lowerbound = -0.967704, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1428.128 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 79.627 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 82.201 ms
rank =  0, finding HY took 24.738 ms
rank =  0, distributing HY into block cyclic form took 18.245 ms
rank =  0, finding Y'*HY took 3.977 ms
Rank 0, Project_Hamiltonian used 129.191 ms
Total time for projection: 129.206 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.939 ms
rank = 0, Solve_Generalized_EigenProblem used 1.450 ms
    first calculated eigval = -0.967484887652562
    last  calculated eigval = 0.037408800546550
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54214027216339
lambda[   6] =  -0.49699372534091
lambda[   7] =  -0.41794421867488
lambda[   8] =  -0.41600386515780
lambda[   9] =  -0.34026673709281
lambda[  10] =  -0.33640909589546
lambda[  11] =  -0.33598860343807
lambda[  12] =  -0.31984225798712
lambda[  13] =  -0.19918116899659
lambda[  14] =  -0.19866550501336
lambda[  15] =  -0.03420552894025
lambda[  16] =  -0.02219617876556
lambda[  17] =  -0.00641520878697
lambda[  18] =   0.01410190101966
lambda[  19] =   0.01421166329069
lambda[  20] =   0.03204206062119
lambda[  21] =   0.03740880054655
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 1.472 ms
rank =  0, subspace rotation using ScaLAPACK took 7.660 ms
rank =  0, Distributing orbital back into band + domain format took 18.305 ms
rank = 0, Subspace_Rotation used 25.978 ms

Total time for subspace rotation: 25.984 ms
rank = 0, Efermi =  -0.062962454472 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.236 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.673 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1601.423 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.799 ms
rank = 0, D2D took 1.896 ms
rank = 0, Transfering density took 1.903 ms
Etot    =   -53.452978348889
Eband   =   -13.695434658134
E1      =    30.128989702351
E2      =   -13.088287149734
E3      =   -18.084630725319
Exc     =   -16.162681570176
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.797e-06, dEband = 6.944e-04
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -53.452978349, dEtot = 5.797e-06, dEband = 6.944e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0337703818289, which took 0.059 ms

iter_count = 108, r_2norm = 1.253e-06, tol*||rhs|| = 1.351e-06

Anderson update took 57.626 ms, out of which F'*F took 27.254 ms; b-Ax took 183.662 ms, out of which Lap took 164.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.083 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144018, int_b + int_rho = 1.382e-13, checking this took 0.110 ms
2-norm of RHS = 728.5782424140565, which took 0.181 ms

iter_count = 150, r_2norm = 6.524e-04, tol*||rhs|| = 7.286e-04

Anderson update took 80.563 ms, out of which F'*F took 37.721 ms; b-Ax took 254.715 ms, out of which Lap took 228.634 ms
Solving Poisson took 542.290 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.166949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.352 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.568 ms
Total time for convolution: 	 convolve: 5.174491 
Total time for convolution: 	 convolve: 5.213253 
Total time for convolution: 	 convolve: 5.149700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.480 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.227 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.741 ms

This SCF took 27635.617 ms, scf error = 1.388e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137409, lowerbound = -0.967485, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1424.784 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 74.277 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.586 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 77.737 ms
rank =  0, finding HY took 24.683 ms
rank =  0, distributing HY into block cyclic form took 18.099 ms
rank =  0, finding Y'*HY took 4.017 ms
Rank 0, Project_Hamiltonian used 124.569 ms
Total time for projection: 124.591 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -0.967372336027859
    last  calculated eigval = 0.038030768333130
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54201492538691
lambda[   6] =  -0.49687082867252
lambda[   7] =  -0.41780774813169
lambda[   8] =  -0.41586821971959
lambda[   9] =  -0.34013777017997
lambda[  10] =  -0.33628370669278
lambda[  11] =  -0.33586473495987
lambda[  12] =  -0.31971386312524
lambda[  13] =  -0.19905100579103
lambda[  14] =  -0.19853448818077
lambda[  15] =  -0.03414453905794
lambda[  16] =  -0.02219803715556
lambda[  17] =  -0.00517955210509
lambda[  18] =   0.01345235124454
lambda[  19] =   0.01370885902886
lambda[  20] =   0.03348852067098
lambda[  21] =   0.03803076833313
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.658 ms
rank =  0, Distributing orbital back into band + domain format took 18.345 ms
rank = 0, Subspace_Rotation used 26.014 ms

Total time for subspace rotation: 26.019 ms
rank = 0, Efermi =  -0.062901464671 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.306 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.628 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.633 ms
rank = 0, Calculating density took 1592.327 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.929 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -53.453028289342
Eband   =   -13.691863290881
E1      =    30.127629241016
E2      =   -13.086051020018
E3      =   -18.084524331920
Exc     =   -16.162599893433
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 5.549e-06, dEband = 3.968e-04
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -53.453028289, dEtot = 5.549e-06, dEband = 3.968e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0297715957400, which took 0.055 ms

iter_count = 108, r_2norm = 1.064e-06, tol*||rhs|| = 1.191e-06

Anderson update took 57.727 ms, out of which F'*F took 27.248 ms; b-Ax took 183.906 ms, out of which Lap took 164.734 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.286 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003143998, int_b + int_rho = -6.548e-14, checking this took 0.129 ms
2-norm of RHS = 728.5781364020066, which took 0.105 ms

iter_count = 126, r_2norm = 6.339e-04, tol*||rhs|| = 7.286e-04

Anderson update took 67.597 ms, out of which F'*F took 31.655 ms; b-Ax took 212.659 ms, out of which Lap took 191.272 ms
Solving Poisson took 454.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.105 ms
Total time for convolution: 	 convolve: 5.161138 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.785 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.170508 
Total time for convolution: 	 convolve: 5.155610 
Total time for convolution: 	 convolve: 5.155538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.210 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.764 ms

This SCF took 27140.586 ms, scf error = 1.195e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138031, lowerbound = -0.967372, upperbound = 267.583528

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1432.482 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 71.675 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.579 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 74.271 ms
rank =  0, finding HY took 24.778 ms
rank =  0, distributing HY into block cyclic form took 18.150 ms
rank =  0, finding Y'*HY took 3.984 ms
Rank 0, Project_Hamiltonian used 121.210 ms
Total time for projection: 121.227 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.967264882527072
    last  calculated eigval = 0.038364277376998
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54191602546389
lambda[   6] =  -0.49677071687744
lambda[   7] =  -0.41771420274121
lambda[   8] =  -0.41577385572957
lambda[   9] =  -0.34003871954618
lambda[  10] =  -0.33618362813448
lambda[  11] =  -0.33576404785611
lambda[  12] =  -0.31961528584664
lambda[  13] =  -0.19895790320524
lambda[  14] =  -0.19844081802514
lambda[  15] =  -0.03430457337434
lambda[  16] =  -0.02221058196105
lambda[  17] =  -0.00486131060645
lambda[  18] =   0.01323933427479
lambda[  19] =   0.01343736138981
lambda[  20] =   0.03360929398540
lambda[  21] =   0.03836427737700
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 7.649 ms
rank =  0, Distributing orbital back into band + domain format took 18.144 ms
rank = 0, Subspace_Rotation used 25.805 ms

Total time for subspace rotation: 25.810 ms
rank = 0, Efermi =  -0.063061499017 calculate fermi energy took 0.137 ms
rank = 0, --- Calculate rho: sum over local bands took 5.259 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.507 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1596.328 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.900 ms
rank = 0, Transfering density took 1.902 ms
Etot    =   -53.453043265711
Eband   =   -13.689107154915
E1      =    30.126236179891
E2      =   -13.084637314534
E3      =   -18.084680879581
Exc     =   -16.162720786819
Esc     =   -84.896769697051
Entropy =    -0.000000000932
dE = 1.664e-06, dEband = 3.062e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -53.453043266, dEtot = 1.664e-06, dEband = 3.062e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292028315550, which took 0.053 ms

iter_count = 108, r_2norm = 7.835e-07, tol*||rhs|| = 1.168e-06

Anderson update took 57.554 ms, out of which F'*F took 27.198 ms; b-Ax took 182.747 ms, out of which Lap took 163.993 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.265 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003144005, int_rho =  28.00000003144013, int_b + int_rho = 8.004e-14, checking this took 0.135 ms
2-norm of RHS = 728.5794209151828, which took 0.138 ms

iter_count = 132, r_2norm = 6.051e-04, tol*||rhs|| = 7.286e-04

Anderson update took 71.094 ms, out of which F'*F took 33.211 ms; b-Ax took 223.778 ms, out of which Lap took 201.054 ms
Solving Poisson took 478.025 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.163690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.616 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.158556 
Total time for convolution: 	 convolve: 5.190367 
Total time for convolution: 	 convolve: 5.164230 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.245 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 4.225 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.027 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.284 ms

This SCF took 27232.500 ms, scf error = 9.359e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.54191602546389, occ[   5] =   2.00000000000000
lambda[   6] =  -0.49677071687744, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41771420274121, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41577385572957, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34003871954618, occ[   9] =   2.00000000000000
lambda[  10] =  -0.33618362813448, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33576404785611, occ[  11] =   2.00000000000000
lambda[  12] =  -0.31961528584664, occ[  12] =   2.00000000000000
lambda[  13] =  -0.19895790320524, occ[  13] =   2.00000000000000
lambda[  14] =  -0.19844081802514, occ[  14] =   2.00000000000000
lambda[  15] =  -0.03430457337434, occ[  15] =   0.00000003144005
lambda[  16] =  -0.02221058196105, occ[  16] =   0.00000000000000
lambda[  17] =  -0.00486131060645, occ[  17] =   0.00000000000000
lambda[  18] =   0.01323933427479, occ[  18] =   0.00000000000000
lambda[  19] =   0.01343736138981, occ[  19] =   0.00000000000000
lambda[  20] =   0.03360929398540, occ[  20] =   0.00000000000000
lambda[  21] =   0.03836427737700, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.757 ms, time for Allreduce/Reduce: 10.361 ms 
Time for calculating local force components: 22.638 ms
Start Calculating nonlocal forces
force_nloc = 
  0.01399540311970  -1.08249335636996  -0.00964427560640
 -0.01399705945574   1.08249139292023  -0.00964508359097
  0.03199055285664  -0.02706860556323  -0.03250054421482
 -0.03199062727054   0.02706860043155  -0.03250057072986
 -0.04467123264179   0.04181108378435   0.04322285714772
  0.04467125426076  -0.04181114232164   0.04322290284578
 -0.00000121696250  -0.00000147289515  -0.00247522895883
  0.11881821125327   0.06345292464892  -0.12737881318682
 -0.11881741301396  -0.06345419849898  -0.12738118902558
force_loc = 
 -0.01477189228202   1.05449669919201   0.01060478980110
  0.01477076741244  -1.05449672817029   0.01060540815941
 -0.03455449909792   0.03080008269513   0.03500722889494
  0.03455507110283  -0.03080081964983   0.03500731880541
  0.04782463159771  -0.04338110782039  -0.04623299817380
 -0.04782415220287   0.04338085966658  -0.04623239867891
 -0.00000040094706  -0.00000029777405   0.00162581125818
 -0.11355244411590  -0.06267659676695   0.12198287644278
  0.11355368902820   0.06268128099122   0.12197972714999
Time for calculating nonlocal force components: 39.757 ms
[32mforces_xc: 
[0m[32m  0.00004301598951   0.03235201260663  -0.00012596151556
[0m[32m -0.00004314423294  -0.03235203654558  -0.00012596796794
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000000807421   0.00000009442788   0.00035751231472
[0m[32m -0.00508610251144  -0.00765023268959   0.00529864636564
[0m[32m  0.00508619202880   0.00765035246452   0.00529852766542
[0mTime for calculating XC forces components: 33.485 ms
 Cartesian force = 
 -0.00073331715514   0.00435549001052   0.00083782210118
  0.00073071974143  -0.00435723721379   0.00083762602254
 -0.00256379022361   0.00373161171375   0.00250995410216
  0.00256459984996  -0.00373208463643   0.00251001749760
  0.00315355497359  -0.00156988945419  -0.00300687160404
 -0.00315274192444   0.00156985192679  -0.00300622641109
 -0.00000146996611  -0.00000154165948  -0.00048863596388
  0.00017982064361  -0.00687377022578  -0.00009402095635
 -0.00017737593928   0.00687756953861  -0.00009966478813
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 385.343 ms
The program took 445.667 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:36:40
Job ID:        2267031
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:32:12,vmem=8308K,walltime=00:07:41,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-2-2
---------------------------------------
