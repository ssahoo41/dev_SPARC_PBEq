---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:10
Job ID:    2266591
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:17
Job ID:    2266591
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.012 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 18.632 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 8.515 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 165.380 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.038 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.108 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.222084	   12.331674	   10.000000	
   11.777916	    7.668326	   10.000000	
    9.199970	   10.353847	   10.000000	
    9.949275	    8.186320	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 2.339 ms

--set up kptcomm took 0.349 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.089 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.432 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.493 ms

Calculate_SplineDerivRadFun took 0.294 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.331 ms.
time spent on vectorized spline interp: 3.043 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.063 ms.
time spent on vectorized spline interp: 1.643 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.374 ms.
time spent on vectorized spline interp: 1.915 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.442 ms.
time spent on vectorized spline interp: 1.787 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.528 ms.

Calculating rb for all atom types took 21.139 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.901 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000128143, sum_int_rho = 15.8925509936627
PosCharge = 16.000000012814, NegCharge = -15.892550993663, scal_fac = 1.006760967399
After scaling, int_rho = 16.0000000128144, PosCharge + NegCharge - NetCharge = -1.421e-14
--Calculate Vref took 0.341 ms
--Calculate rho_guess took 1.856 ms

 integral of b = -16.0000000128143,
 int{b} + Nelectron + NetCharge = -1.281e-08,
 Esc = -52.3884730154012,
 MPI_Reduce took 3.839 ms

Calculating b & b_ref took 11.321 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.018 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.823 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281436, int_b + int_rho = -6.366e-14, checking this took 0.089 ms
2-norm of RHS = 512.6260917415694, which took 0.072 ms

iter_count = 426, r_2norm = 4.023e-04, tol*||rhs|| = 5.126e-04

Anderson update took 262.738 ms, out of which F'*F took 124.336 ms; b-Ax took 854.577 ms, out of which Lap took 756.902 ms
Solving Poisson took 1918.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.824 ms
Total time for convolution: 	 convolve: 5.100706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 109.248 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.120254 
Total time for convolution: 	 convolve: 5.143071 
Total time for convolution: 	 convolve: 5.094991 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.724 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.464 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
rank = 0, XC calculation took 24486.011 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 1.069 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.786 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.797 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.139 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.880 ms
    Lanczos iter 53, eigmin  = -1.093318919, eigmax = 264.922734400, err_eigmin = 1.137e-03, err_eigmax = 9.600e-03
rank =   0, Lanczos took 136.424 ms, eigmin = -1.093318918937, eigmax = 267.571961744093

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.189321, lowerbound = -1.193319, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1439.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 16.967 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.627 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.126 ms
rank =  0, Distribute data + matrix mult took 19.747 ms
rank =  0, finding HY took 21.661 ms
rank =  0, distributing HY into block cyclic form took 15.962 ms
rank =  0, finding Y'*HY took 2.292 ms
Rank 0, Project_Hamiltonian used 59.706 ms
Total time for projection: 59.741 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.374 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.436 ms
    first calculated eigval = 2.792708236688421
    last  calculated eigval = 3.179026934911698
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79270823668842
lambda[   2] =   2.80204963969283
lambda[   3] =   2.86517771459055
lambda[   4] =   2.91217506806477
lambda[   5] =   2.95214423576740
lambda[   6] =   2.98360354256625
lambda[   7] =   3.01813745756970
lambda[   8] =   3.03779993503257
lambda[   9] =   3.07290596795734
lambda[  10] =   3.07683553760327
lambda[  11] =   3.12476196664417
lambda[  12] =   3.13330199146382
lambda[  13] =   3.16180809568364
lambda[  14] =   3.17902693491170
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.452 ms
rank =  0, subspace rotation using ScaLAPACK took 4.047 ms
rank =  0, Distributing orbital back into band + domain format took 14.354 ms
rank = 0, Subspace_Rotation used 18.425 ms

Total time for subspace rotation: 18.428 ms
rank = 0, Efermi =   3.055319050595 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.279027, lowerbound = -1.193319, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1363.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 18.659 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.555 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 20.239 ms
rank =  0, finding HY took 20.730 ms
rank =  0, distributing HY into block cyclic form took 15.057 ms
rank =  0, finding Y'*HY took 2.297 ms
Rank 0, Project_Hamiltonian used 58.369 ms
Total time for projection: 58.401 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.828730764897715
    last  calculated eigval = 0.465882268863930
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.82873076489772
lambda[   2] =  -0.79148732439302
lambda[   3] =  -0.38056168833989
lambda[   4] =  -0.15855845415584
lambda[   5] =  -0.13170062914331
lambda[   6] =  -0.00150886668829
lambda[   7] =   0.07935688532989
lambda[   8] =   0.21558149088462
lambda[   9] =   0.26184438230500
lambda[  10] =   0.33003346539462
lambda[  11] =   0.35374934805005
lambda[  12] =   0.42199508971111
lambda[  13] =   0.42901167043572
lambda[  14] =   0.46588226886393
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 4.831 ms
rank =  0, Distributing orbital back into band + domain format took 13.341 ms
rank = 0, Subspace_Rotation used 18.197 ms

Total time for subspace rotation: 18.203 ms
rank = 0, Efermi =   0.238713772395 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.565882, lowerbound = -1.193319, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1356.395 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.215 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.614 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.857 ms
rank =  0, finding HY took 20.634 ms
rank =  0, distributing HY into block cyclic form took 15.003 ms
rank =  0, finding Y'*HY took 2.378 ms
Rank 0, Project_Hamiltonian used 54.911 ms
Total time for projection: 54.919 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -1.119813332091398
    last  calculated eigval = 0.148624356729810
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.11981333209140
lambda[   2] =  -1.00047847512090
lambda[   3] =  -0.66506423308697
lambda[   4] =  -0.55067040198016
lambda[   5] =  -0.49278973907231
lambda[   6] =  -0.48611759733871
lambda[   7] =  -0.38861073909496
lambda[   8] =  -0.34536744740228
lambda[   9] =  -0.04688143267954
lambda[  10] =   0.04289757457339
lambda[  11] =   0.09034820544168
lambda[  12] =   0.09708908128885
lambda[  13] =   0.10308683472511
lambda[  14] =   0.14862435672981
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 4.018 ms
rank =  0, Distributing orbital back into band + domain format took 14.493 ms
rank = 0, Subspace_Rotation used 18.528 ms

Total time for subspace rotation: 18.531 ms
rank = 0, Efermi =  -0.076445472830 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.248624, lowerbound = -1.193319, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1383.360 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 15.277 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.590 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.894 ms
rank =  0, finding HY took 20.670 ms
rank =  0, distributing HY into block cyclic form took 15.084 ms
rank =  0, finding Y'*HY took 2.281 ms
Rank 0, Project_Hamiltonian used 54.965 ms
Total time for projection: 54.992 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 1.050 ms
    first calculated eigval = -1.120064530174401
    last  calculated eigval = 0.086422133225155
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.12006453017440
lambda[   2] =  -1.00074533352126
lambda[   3] =  -0.66624118233903
lambda[   4] =  -0.55399955889612
lambda[   5] =  -0.49677007242399
lambda[   6] =  -0.49616202487935
lambda[   7] =  -0.40092398054574
lambda[   8] =  -0.37638444721966
lambda[   9] =  -0.09337022225230
lambda[  10] =  -0.03768640546312
lambda[  11] =  -0.00178080621717
lambda[  12] =   0.04339390129026
lambda[  13] =   0.05742528603839
lambda[  14] =   0.08642213322515
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.078 ms
rank =  0, subspace rotation using ScaLAPACK took 4.424 ms
rank =  0, Distributing orbital back into band + domain format took 14.210 ms
rank = 0, Subspace_Rotation used 18.661 ms

Total time for subspace rotation: 18.666 ms
rank = 0, Efermi =  -0.122934262361 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.534 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.878 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.099 ms
rank = 0, Calculating density took 5989.018 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.654 ms
rank = 0, D2D took 0.940 ms
rank = 0, Transfering density took 0.953 ms
Etot    =   -33.610342189078
Eband   =   -10.222582261196
E1      =    19.213471854458
E2      =    -8.803065870327
E3      =   -10.341675408940
Exc     =    -9.357500045816
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 8.403e+00, dEband = 2.556e+00
rank = 0, Calculating/Estimating energy took 1.246 ms, Etot = -33.610342189, dEtot = 8.403e+00, dEband = 2.556e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 47.6612016008153, which took 0.054 ms

iter_count = 96, r_2norm = 1.213e-03, tol*||rhs|| = 1.906e-03

Anderson update took 57.737 ms, out of which F'*F took 27.830 ms; b-Ax took 188.981 ms, out of which Lap took 165.853 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.393 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281439, int_b + int_rho = -3.638e-14, checking this took 0.135 ms
2-norm of RHS = 508.3757873492860, which took 0.266 ms

iter_count = 288, r_2norm = 4.146e-04, tol*||rhs|| = 5.084e-04

Anderson update took 179.198 ms, out of which F'*F took 82.170 ms; b-Ax took 579.211 ms, out of which Lap took 510.305 ms
Solving Poisson took 1278.418 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.735 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.106008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.097573 
Total time for convolution: 	 convolve: 5.085755 
Total time for convolution: 	 convolve: 5.083632 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.397 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.010 ms

This SCF took 32342.852 ms, scf error = 1.511e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186422, lowerbound = -1.120065, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1337.094 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 15.137 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.583 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 16.750 ms
rank =  0, finding HY took 20.782 ms
rank =  0, distributing HY into block cyclic form took 15.013 ms
rank =  0, finding Y'*HY took 2.317 ms
Rank 0, Project_Hamiltonian used 55.654 ms
Total time for projection: 55.671 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.626 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.714 ms
    first calculated eigval = -1.093259912673306
    last  calculated eigval = 0.065347546924597
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09325991267331
lambda[   2] =  -0.95212768451185
lambda[   3] =  -0.62243815506675
lambda[   4] =  -0.52187328213760
lambda[   5] =  -0.47298353274739
lambda[   6] =  -0.46975735394792
lambda[   7] =  -0.35666915362574
lambda[   8] =  -0.33254173310572
lambda[   9] =  -0.08301388449518
lambda[  10] =  -0.03437143329755
lambda[  11] =  -0.03206415075336
lambda[  12] =   0.02109601873984
lambda[  13] =   0.03445962375188
lambda[  14] =   0.06534754692460
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.729 ms
rank =  0, subspace rotation using ScaLAPACK took 4.000 ms
rank =  0, Distributing orbital back into band + domain format took 14.496 ms
rank = 0, Subspace_Rotation used 18.517 ms

Total time for subspace rotation: 18.521 ms
rank = 0, Efermi =  -0.112577924609 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.559 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.675 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.105 ms
rank = 0, Calculating density took 1415.530 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.611 ms
rank = 0, D2D took 0.905 ms
rank = 0, Transfering density took 0.917 ms
Etot    =   -33.553026638623
Eband   =    -9.643301616696
E1      =    18.747020234736
E2      =    -8.716088321660
E3      =   -10.489078993707
Exc     =    -9.473439556239
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 1.433e-02, dEband = 1.448e-01
rank = 0, Calculating/Estimating energy took 1.138 ms, Etot = -33.553026639, dEtot = 1.433e-02, dEband = 1.448e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 19.2610126806883, which took 0.068 ms

iter_count = 102, r_2norm = 4.801e-04, tol*||rhs|| = 7.704e-04

Anderson update took 60.060 ms, out of which F'*F took 27.711 ms; b-Ax took 191.061 ms, out of which Lap took 168.844 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.921 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281432, int_b + int_rho = -1.037e-13, checking this took 0.099 ms
2-norm of RHS = 506.1242928951426, which took 0.249 ms

iter_count = 288, r_2norm = 4.373e-04, tol*||rhs|| = 5.061e-04

Anderson update took 170.610 ms, out of which F'*F took 79.939 ms; b-Ax took 554.489 ms, out of which Lap took 490.291 ms
Solving Poisson took 1203.526 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.491 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.084252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.846 ms
Total time for convolution: 	 convolve: 5.079583 
Total time for convolution: 	 convolve: 5.095587 
Total time for convolution: 	 convolve: 5.079922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.003 ms

This SCF took 27434.291 ms, scf error = 8.338e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165348, lowerbound = -1.093260, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1397.957 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.182 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.612 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 17.814 ms
rank =  0, finding HY took 22.006 ms
rank =  0, distributing HY into block cyclic form took 15.077 ms
rank =  0, finding Y'*HY took 2.311 ms
Rank 0, Project_Hamiltonian used 57.242 ms
Total time for projection: 57.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.062217924835866
    last  calculated eigval = 0.051381749597199
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06221792483587
lambda[   2] =  -0.90597588950724
lambda[   3] =  -0.58462408310981
lambda[   4] =  -0.48954827706196
lambda[   5] =  -0.44732401308255
lambda[   6] =  -0.44330099438328
lambda[   7] =  -0.31989059844339
lambda[   8] =  -0.29624404195623
lambda[   9] =  -0.06197013876749
lambda[  10] =  -0.03915562142438
lambda[  11] =  -0.01253355826194
lambda[  12] =   0.01488784199171
lambda[  13] =   0.02630930367028
lambda[  14] =   0.05138174959720
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 4.038 ms
rank =  0, Distributing orbital back into band + domain format took 14.576 ms
rank = 0, Subspace_Rotation used 18.632 ms

Total time for subspace rotation: 18.635 ms
rank = 0, Efermi =  -0.091534178910 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.501 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.727 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.104 ms
rank = 0, Calculating density took 1477.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.671 ms
rank = 0, D2D took 0.928 ms
rank = 0, Transfering density took 0.936 ms
Etot    =   -33.532470856731
Eband   =    -9.098251645555
E1      =    18.320353899619
E2      =    -8.587856642229
E3      =   -10.628823207636
Exc     =    -9.582779944869
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 5.139e-03, dEband = 1.363e-01
rank = 0, Calculating/Estimating energy took 1.119 ms, Etot = -33.532470857, dEtot = 5.139e-03, dEband = 1.363e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 3.9874552996768, which took 0.059 ms

iter_count = 108, r_2norm = 1.046e-04, tol*||rhs|| = 1.595e-04

Anderson update took 64.594 ms, out of which F'*F took 29.798 ms; b-Ax took 208.879 ms, out of which Lap took 183.095 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.233 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281432, int_b + int_rho = -1.055e-13, checking this took 0.126 ms
2-norm of RHS = 507.2098681848512, which took 0.175 ms

iter_count = 288, r_2norm = 4.182e-04, tol*||rhs|| = 5.072e-04

Anderson update took 176.036 ms, out of which F'*F took 79.324 ms; b-Ax took 548.265 ms, out of which Lap took 480.568 ms
Solving Poisson took 1219.851 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.115 ms
Total time for convolution: 	 convolve: 5.103977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.076900 
Total time for convolution: 	 convolve: 5.086538 
Total time for convolution: 	 convolve: 5.076010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.013 ms

This SCF took 27607.446 ms, scf error = 4.141e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151382, lowerbound = -1.062218, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1385.658 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.992 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.558 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.576 ms
rank =  0, finding HY took 21.260 ms
rank =  0, distributing HY into block cyclic form took 14.879 ms
rank =  0, finding Y'*HY took 2.543 ms
Rank 0, Project_Hamiltonian used 55.305 ms
Total time for projection: 55.328 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -1.034876547812090
    last  calculated eigval = 0.040096908161668
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03487654781209
lambda[   2] =  -0.87714520169401
lambda[   3] =  -0.56233312961160
lambda[   4] =  -0.46493284859303
lambda[   5] =  -0.42500592903023
lambda[   6] =  -0.42173922942024
lambda[   7] =  -0.30217947289886
lambda[   8] =  -0.27800987889789
lambda[   9] =  -0.04268195189689
lambda[  10] =  -0.03873121482863
lambda[  11] =   0.00665991175606
lambda[  12] =   0.01395078746519
lambda[  13] =   0.02359785129036
lambda[  14] =   0.04009690816167
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.064 ms
rank =  0, Distributing orbital back into band + domain format took 14.436 ms
rank = 0, Subspace_Rotation used 18.518 ms

Total time for subspace rotation: 18.522 ms
rank = 0, Efermi =  -0.072253763118 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.526 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.048 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.110 ms
rank = 0, Calculating density took 1463.826 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.654 ms
rank = 0, D2D took 0.914 ms
rank = 0, Transfering density took 0.923 ms
Etot    =   -33.527411735633
Eband   =    -8.732444476462
E1      =    18.077417841510
E2      =    -8.449589318325
E3      =   -10.715061385282
Exc     =    -9.648562788495
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 1.265e-03, dEband = 9.145e-02
rank = 0, Calculating/Estimating energy took 1.142 ms, Etot = -33.527411736, dEtot = 1.265e-03, dEband = 9.145e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.6503501771855, which took 0.060 ms

iter_count = 102, r_2norm = 1.046e-04, tol*||rhs|| = 1.060e-04

Anderson update took 60.798 ms, out of which F'*F took 28.742 ms; b-Ax took 197.531 ms, out of which Lap took 175.004 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.822 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281431, int_b + int_rho = -1.128e-13, checking this took 0.144 ms
2-norm of RHS = 507.9873604609916, which took 0.169 ms

iter_count = 252, r_2norm = 4.493e-04, tol*||rhs|| = 5.080e-04

Anderson update took 773.878 ms, out of which F'*F took 363.960 ms; b-Ax took 1842.081 ms, out of which Lap took 1718.343 ms
Solving Poisson took 3504.164 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.175242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.075518 
Total time for convolution: 	 convolve: 5.093251 
Total time for convolution: 	 convolve: 5.074976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.469 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.531 ms

This SCF took 29990.194 ms, scf error = 1.105e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.140097, lowerbound = -1.034877, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1409.724 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.032 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.588 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.649 ms
rank =  0, finding HY took 21.158 ms
rank =  0, distributing HY into block cyclic form took 15.064 ms
rank =  0, finding Y'*HY took 2.365 ms
Rank 0, Project_Hamiltonian used 55.279 ms
Total time for projection: 55.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.032707830517264
    last  calculated eigval = 0.033443740575014
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03270783051726
lambda[   2] =  -0.87308204494567
lambda[   3] =  -0.55752876400087
lambda[   4] =  -0.46174539651677
lambda[   5] =  -0.42264238136965
lambda[   6] =  -0.41922266822635
lambda[   7] =  -0.29797807956758
lambda[   8] =  -0.27423917749502
lambda[   9] =  -0.04123796003099
lambda[  10] =  -0.03823611341279
lambda[  11] =   0.00862349599576
lambda[  12] =   0.01421973730250
lambda[  13] =   0.02308283108224
lambda[  14] =   0.03344374057501
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.196 ms
rank =  0, Distributing orbital back into band + domain format took 14.332 ms
rank = 0, Subspace_Rotation used 18.548 ms

Total time for subspace rotation: 18.551 ms
rank = 0, Efermi =  -0.070827200114 calculate fermi energy took 0.142 ms
rank = 0, --- Calculate rho: sum over local bands took 2.536 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.743 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1487.318 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.975 ms
Etot    =   -33.526825927661
Eband   =    -8.678292685806
E1      =    18.058870645446
E2      =    -8.410694771885
E3      =   -10.726819561736
Exc     =    -9.656445205130
Esc     =   -52.388473015401
Entropy =    -0.000000000391
dE = 1.465e-04, dEband = 1.354e-02
rank = 0, Calculating/Estimating energy took 1.124 ms, Etot = -33.526825928, dEtot = 1.465e-04, dEband = 1.354e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7328072936035, which took 0.059 ms

iter_count = 114, r_2norm = 1.905e-05, tol*||rhs|| = 2.931e-05

Anderson update took 69.094 ms, out of which F'*F took 31.710 ms; b-Ax took 215.557 ms, out of which Lap took 192.658 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.241 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281438, int_b + int_rho = -4.547e-14, checking this took 0.104 ms
2-norm of RHS = 508.6326717286361, which took 0.079 ms

iter_count = 246, r_2norm = 4.254e-04, tol*||rhs|| = 5.086e-04

Anderson update took 147.890 ms, out of which F'*F took 69.031 ms; b-Ax took 471.152 ms, out of which Lap took 419.169 ms
Solving Poisson took 1026.595 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.088679 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.077220 
Total time for convolution: 	 convolve: 5.080776 
Total time for convolution: 	 convolve: 5.091281 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.665 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.284 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.422 ms
---Transfer Veff_loc: D2D took 1.867 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.176 ms

This SCF took 27342.127 ms, scf error = 5.892e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.133444, lowerbound = -1.032708, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1393.280 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.982 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 16.581 ms
rank =  0, finding HY took 21.379 ms
rank =  0, distributing HY into block cyclic form took 15.146 ms
rank =  0, finding Y'*HY took 2.303 ms
Rank 0, Project_Hamiltonian used 55.447 ms
Total time for projection: 55.465 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.031757570148343
    last  calculated eigval = 0.029979502335797
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03175757014834
lambda[   2] =  -0.87245337134950
lambda[   3] =  -0.55601468048877
lambda[   4] =  -0.46002842508241
lambda[   5] =  -0.42157250549227
lambda[   6] =  -0.41809883848386
lambda[   7] =  -0.29641455741342
lambda[   8] =  -0.27289807068325
lambda[   9] =  -0.04107781102457
lambda[  10] =  -0.03757337694903
lambda[  11] =   0.00947286883085
lambda[  12] =   0.01474143324710
lambda[  13] =   0.02310397086971
lambda[  14] =   0.02997950233580
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.256 ms
rank =  0, Distributing orbital back into band + domain format took 14.337 ms
rank = 0, Subspace_Rotation used 18.612 ms

Total time for subspace rotation: 18.615 ms
rank = 0, Efermi =  -0.070655441171 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.477 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.796 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1471.039 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.657 ms
rank = 0, D2D took 0.906 ms
rank = 0, Transfering density took 0.911 ms
Etot    =   -33.526547954234
Eband   =    -8.658476038809
E1      =    18.063298735993
E2      =    -8.385201229865
E3      =   -10.728801523228
Exc     =    -9.656900388719
Esc     =   -52.388473015401
Entropy =    -0.000000000391
dE = 6.949e-05, dEband = 4.954e-03
rank = 0, Calculating/Estimating energy took 1.114 ms, Etot = -33.526547954, dEtot = 6.949e-05, dEband = 4.954e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5120930842348, which took 0.140 ms

iter_count = 108, r_2norm = 1.793e-05, tol*||rhs|| = 2.048e-05

Anderson update took 67.417 ms, out of which F'*F took 30.830 ms; b-Ax took 208.549 ms, out of which Lap took 185.972 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.045 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281438, int_b + int_rho = -4.002e-14, checking this took 0.117 ms
2-norm of RHS = 508.6692188246939, which took 0.214 ms

iter_count = 234, r_2norm = 4.276e-04, tol*||rhs|| = 5.087e-04

Anderson update took 141.327 ms, out of which F'*F took 64.846 ms; b-Ax took 444.929 ms, out of which Lap took 394.300 ms
Solving Poisson took 986.725 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.078394 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.664 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.079889 
Total time for convolution: 	 convolve: 5.076690 
Total time for convolution: 	 convolve: 5.100794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.644 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.218 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 27546.994 ms, scf error = 2.890e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129980, lowerbound = -1.031758, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1338.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.818 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.624 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.469 ms
rank =  0, finding HY took 21.369 ms
rank =  0, distributing HY into block cyclic form took 15.150 ms
rank =  0, finding Y'*HY took 2.276 ms
Rank 0, Project_Hamiltonian used 55.306 ms
Total time for projection: 55.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -1.029661175977455
    last  calculated eigval = 0.028157434921973
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02966117597746
lambda[   2] =  -0.87127411669309
lambda[   3] =  -0.55512880365170
lambda[   4] =  -0.45786383623455
lambda[   5] =  -0.41979818188140
lambda[   6] =  -0.41635840207123
lambda[   7] =  -0.29501090477724
lambda[   8] =  -0.27146093465272
lambda[   9] =  -0.04093129310505
lambda[  10] =  -0.03655524845352
lambda[  11] =   0.01058156640797
lambda[  12] =   0.01521241957363
lambda[  13] =   0.02350724604525
lambda[  14] =   0.02815743492197
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 4.198 ms
rank =  0, Distributing orbital back into band + domain format took 14.342 ms
rank = 0, Subspace_Rotation used 18.559 ms

Total time for subspace rotation: 18.562 ms
rank = 0, Efermi =  -0.070499857900 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.488 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.869 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1416.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.013 ms
Etot    =   -33.526547246725
Eband   =    -8.633112712403
E1      =    18.051594105885
E2      =    -8.370583540946
E3      =   -10.731900250657
Exc     =    -9.659039416018
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 1.769e-07, dEband = 6.341e-03
rank = 0, Calculating/Estimating energy took 1.090 ms, Etot = -33.526547247, dEtot = 1.769e-07, dEband = 6.341e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2088925030669, which took 0.060 ms

iter_count = 114, r_2norm = 5.214e-06, tol*||rhs|| = 8.356e-06

Anderson update took 67.698 ms, out of which F'*F took 35.820 ms; b-Ax took 223.139 ms, out of which Lap took 198.633 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.231 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281436, int_b + int_rho = -6.548e-14, checking this took 0.114 ms
2-norm of RHS = 508.7298184728098, which took 0.128 ms

iter_count = 240, r_2norm = 4.572e-04, tol*||rhs|| = 5.087e-04

Anderson update took 142.652 ms, out of which F'*F took 67.971 ms; b-Ax took 464.123 ms, out of which Lap took 408.210 ms
Solving Poisson took 1002.504 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.078354 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.589 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.083580 
Total time for convolution: 	 convolve: 5.074049 
Total time for convolution: 	 convolve: 5.085108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.680 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.991 ms

This SCF took 27268.016 ms, scf error = 1.863e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128157, lowerbound = -1.029661, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1342.794 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.722 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.597 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.347 ms
rank =  0, finding HY took 21.412 ms
rank =  0, distributing HY into block cyclic form took 15.078 ms
rank =  0, finding Y'*HY took 2.336 ms
Rank 0, Project_Hamiltonian used 55.212 ms
Total time for projection: 55.231 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -1.027119430217384
    last  calculated eigval = 0.028603534624560
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02711943021738
lambda[   2] =  -0.86859320537809
lambda[   3] =  -0.55287157217936
lambda[   4] =  -0.45522693834771
lambda[   5] =  -0.41731692756945
lambda[   6] =  -0.41389070372655
lambda[   7] =  -0.29242027480425
lambda[   8] =  -0.26893606898066
lambda[   9] =  -0.03959894971370
lambda[  10] =  -0.03436984558963
lambda[  11] =   0.01274695875506
lambda[  12] =   0.01804381418358
lambda[  13] =   0.02569939063211
lambda[  14] =   0.02860353462456
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 4.260 ms
rank =  0, Distributing orbital back into band + domain format took 14.235 ms
rank = 0, Subspace_Rotation used 18.515 ms

Total time for subspace rotation: 18.518 ms
rank = 0, Efermi =  -0.069164485434 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 2.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.773 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1420.228 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.738 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.023 ms
Etot    =   -33.526547547454
Eband   =    -8.592750242914
E1      =    18.031672023647
E2      =    -8.348629507659
E3      =   -10.737358361130
Exc     =    -9.662984181186
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 7.518e-08, dEband = 1.009e-02
rank = 0, Calculating/Estimating energy took 1.595 ms, Etot = -33.526547547, dEtot = 7.518e-08, dEband = 1.009e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1748412009543, which took 0.080 ms

iter_count = 108, r_2norm = 6.745e-06, tol*||rhs|| = 6.994e-06

Anderson update took 64.577 ms, out of which F'*F took 30.246 ms; b-Ax took 207.799 ms, out of which Lap took 184.278 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.671 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281436, int_b + int_rho = -6.730e-14, checking this took 0.118 ms
2-norm of RHS = 508.6951257233260, which took 0.110 ms

iter_count = 210, r_2norm = 4.874e-04, tol*||rhs|| = 5.087e-04

Anderson update took 124.637 ms, out of which F'*F took 59.080 ms; b-Ax took 403.683 ms, out of which Lap took 357.297 ms
Solving Poisson took 876.146 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.193 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.088102 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.081510 
Total time for convolution: 	 convolve: 5.079984 
Total time for convolution: 	 convolve: 5.072865 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.745 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.661 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.969 ms

This SCF took 27146.968 ms, scf error = 9.743e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128604, lowerbound = -1.027119, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1416.600 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.849 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.574 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.450 ms
rank =  0, finding HY took 21.331 ms
rank =  0, distributing HY into block cyclic form took 15.064 ms
rank =  0, finding Y'*HY took 2.294 ms
Rank 0, Project_Hamiltonian used 55.176 ms
Total time for projection: 55.193 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -1.025779181119048
    last  calculated eigval = 0.028675276409309
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02577918111905
lambda[   2] =  -0.86745702551963
lambda[   3] =  -0.55190423424333
lambda[   4] =  -0.45396055390179
lambda[   5] =  -0.41613299365029
lambda[   6] =  -0.41272649338095
lambda[   7] =  -0.29135540587940
lambda[   8] =  -0.26786688826565
lambda[   9] =  -0.03826956058447
lambda[  10] =  -0.03328526425079
lambda[  11] =   0.01362315565508
lambda[  12] =   0.01944946644141
lambda[  13] =   0.02709582588321
lambda[  14] =   0.02867527640931
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.296 ms
rank =  0, Distributing orbital back into band + domain format took 14.233 ms
rank = 0, Subspace_Rotation used 18.550 ms

Total time for subspace rotation: 18.554 ms
rank = 0, Efermi =  -0.067835661592 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.487 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.816 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1494.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.136 ms
rank = 0, D2D took 1.257 ms
rank = 0, Transfering density took 1.261 ms
Etot    =   -33.526603032101
Eband   =    -8.574365552410
E1      =    18.020955496299
E2      =    -8.340426960037
E3      =   -10.739684960734
Exc     =    -9.664831880969
Esc     =   -52.388473015401
Entropy =    -0.000000000390
dE = 1.387e-05, dEband = 4.596e-03
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -33.526603032, dEtot = 1.387e-05, dEband = 4.596e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1037871946760, which took 0.058 ms

iter_count = 108, r_2norm = 3.354e-06, tol*||rhs|| = 4.151e-06

Anderson update took 64.027 ms, out of which F'*F took 30.529 ms; b-Ax took 209.036 ms, out of which Lap took 185.754 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.069 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281437, int_b + int_rho = -5.639e-14, checking this took 0.122 ms
2-norm of RHS = 508.7171495874222, which took 0.101 ms

iter_count = 216, r_2norm = 4.332e-04, tol*||rhs|| = 5.087e-04

Anderson update took 128.058 ms, out of which F'*F took 60.537 ms; b-Ax took 413.307 ms, out of which Lap took 364.856 ms
Solving Poisson took 898.683 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.085658 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.075462 
Total time for convolution: 	 convolve: 5.091233 
Total time for convolution: 	 convolve: 5.096890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.146 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.365 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 27198.303 ms, scf error = 6.964e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128675, lowerbound = -1.025779, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1340.245 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.832 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.531 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.390 ms
rank =  0, finding HY took 21.423 ms
rank =  0, distributing HY into block cyclic form took 15.160 ms
rank =  0, finding Y'*HY took 2.264 ms
Rank 0, Project_Hamiltonian used 55.272 ms
Total time for projection: 55.288 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -1.025125981802991
    last  calculated eigval = 0.030555540319558
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02512598180299
lambda[   2] =  -0.86693338367657
lambda[   3] =  -0.55127511882448
lambda[   4] =  -0.45329609217256
lambda[   5] =  -0.41544370110211
lambda[   6] =  -0.41204699135777
lambda[   7] =  -0.29067144903507
lambda[   8] =  -0.26721084478184
lambda[   9] =  -0.03510474763633
lambda[  10] =  -0.03195293031191
lambda[  11] =   0.01462847190832
lambda[  12] =   0.02316041954888
lambda[  13] =   0.03021450819377
lambda[  14] =   0.03055554031956
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 4.236 ms
rank =  0, Distributing orbital back into band + domain format took 14.273 ms
rank = 0, Subspace_Rotation used 18.526 ms

Total time for subspace rotation: 18.530 ms
rank = 0, Efermi =  -0.064689777066 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.277 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.830 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.124 ms
rank = 0, Calculating density took 1418.628 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.428 ms
rank = 0, D2D took 0.544 ms
rank = 0, Transfering density took 0.549 ms
Etot    =   -33.526651836558
Eband   =    -8.564007125956
E1      =    18.017226269527
E2      =    -8.333804798502
E3      =   -10.739618327437
Exc     =    -9.664821090277
Esc     =   -52.388473015401
Entropy =    -0.000000000391
dE = 1.220e-05, dEband = 2.590e-03
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -33.526651837, dEtot = 1.220e-05, dEband = 2.590e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0737019131212, which took 0.055 ms

iter_count = 108, r_2norm = 2.846e-06, tol*||rhs|| = 2.948e-06

Anderson update took 64.163 ms, out of which F'*F took 30.008 ms; b-Ax took 207.647 ms, out of which Lap took 184.363 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.338 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281434, int_b + int_rho = -8.913e-14, checking this took 0.110 ms
2-norm of RHS = 508.7247152666395, which took 0.130 ms

iter_count = 198, r_2norm = 4.427e-04, tol*||rhs|| = 5.087e-04

Anderson update took 117.811 ms, out of which F'*F took 55.489 ms; b-Ax took 379.032 ms, out of which Lap took 335.395 ms
Solving Poisson took 824.605 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.098078 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.078193 
Total time for convolution: 	 convolve: 5.079503 
Total time for convolution: 	 convolve: 5.078941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.661 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.957 ms

This SCF took 27022.992 ms, scf error = 4.707e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130556, lowerbound = -1.025126, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1367.199 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.785 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.356 ms
rank =  0, finding HY took 21.239 ms
rank =  0, distributing HY into block cyclic form took 15.137 ms
rank =  0, finding Y'*HY took 2.329 ms
Rank 0, Project_Hamiltonian used 55.095 ms
Total time for projection: 55.122 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -1.024554485064436
    last  calculated eigval = 0.032636860641572
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02455448506444
lambda[   2] =  -0.86633792555510
lambda[   3] =  -0.55076880684744
lambda[   4] =  -0.45270547123344
lambda[   5] =  -0.41486992433785
lambda[   6] =  -0.41148206293338
lambda[   7] =  -0.29010989428457
lambda[   8] =  -0.26664886528516
lambda[   9] =  -0.03302196531885
lambda[  10] =  -0.03098339792944
lambda[  11] =   0.01545099534241
lambda[  12] =   0.02389606623151
lambda[  13] =   0.03188655633127
lambda[  14] =   0.03263686064157
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 4.825 ms
rank =  0, Distributing orbital back into band + domain format took 12.968 ms
rank = 0, Subspace_Rotation used 17.814 ms

Total time for subspace rotation: 17.823 ms
rank = 0, Efermi =  -0.062664680146 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.411 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.952 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1444.935 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.764 ms
rank = 0, D2D took 0.992 ms
rank = 0, Transfering density took 1.002 ms
Etot    =   -33.526725372055
Eband   =    -8.554954871504
E1      =    18.012705765227
E2      =    -8.329081455721
E3      =   -10.740291685375
Exc     =    -9.665376391080
Esc     =   -52.388473015401
Entropy =    -0.000000000393
dE = 1.838e-05, dEband = 2.263e-03
rank = 0, Calculating/Estimating energy took 1.066 ms, Etot = -33.526725372, dEtot = 1.838e-05, dEband = 2.263e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0706650944078, which took 0.057 ms

iter_count = 108, r_2norm = 2.813e-06, tol*||rhs|| = 2.827e-06

Anderson update took 64.311 ms, out of which F'*F took 30.704 ms; b-Ax took 208.251 ms, out of which Lap took 185.422 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.506 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281432, int_b + int_rho = -1.055e-13, checking this took 0.157 ms
2-norm of RHS = 508.7200898077770, which took 0.150 ms

iter_count = 156, r_2norm = 4.578e-04, tol*||rhs|| = 5.087e-04

Anderson update took 92.506 ms, out of which F'*F took 44.044 ms; b-Ax took 300.987 ms, out of which Lap took 265.520 ms
Solving Poisson took 651.285 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.101144 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.086422 
Total time for convolution: 	 convolve: 5.077275 
Total time for convolution: 	 convolve: 5.082289 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.980 ms

This SCF took 26919.216 ms, scf error = 3.481e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132637, lowerbound = -1.024554, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1338.634 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.739 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.525 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 16.314 ms
rank =  0, finding HY took 21.407 ms
rank =  0, distributing HY into block cyclic form took 15.300 ms
rank =  0, finding Y'*HY took 2.238 ms
Rank 0, Project_Hamiltonian used 55.299 ms
Total time for projection: 55.348 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.024293884634050
    last  calculated eigval = 0.032869363644617
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02429388463405
lambda[   2] =  -0.86610954699137
lambda[   3] =  -0.55057020438457
lambda[   4] =  -0.45246664804317
lambda[   5] =  -0.41463773768966
lambda[   6] =  -0.41125192856575
lambda[   7] =  -0.28989278728518
lambda[   8] =  -0.26642785549878
lambda[   9] =  -0.03248372160984
lambda[  10] =  -0.03054747652077
lambda[  11] =   0.01570578904483
lambda[  12] =   0.02397654766599
lambda[  13] =   0.03237461554959
lambda[  14] =   0.03286936364462
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.865 ms
rank =  0, Distributing orbital back into band + domain format took 12.991 ms
rank = 0, Subspace_Rotation used 17.876 ms

Total time for subspace rotation: 17.886 ms
rank = 0, Efermi =  -0.062136156622 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.866 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1416.621 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.696 ms
rank = 0, D2D took 1.017 ms
rank = 0, Transfering density took 1.027 ms
Etot    =   -33.526747863213
Eband   =    -8.551301186599
E1      =    18.010604106613
E2      =    -8.327426769065
E3      =   -10.740700909204
Exc     =    -9.665705445702
Esc     =   -52.388473015401
Entropy =    -0.000000000393
dE = 5.623e-06, dEband = 9.134e-04
rank = 0, Calculating/Estimating energy took 1.100 ms, Etot = -33.526747863, dEtot = 5.623e-06, dEband = 9.134e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0431021037389, which took 0.055 ms

iter_count = 114, r_2norm = 1.108e-06, tol*||rhs|| = 1.724e-06

Anderson update took 67.688 ms, out of which F'*F took 32.104 ms; b-Ax took 219.802 ms, out of which Lap took 194.668 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.321 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281432, int_b + int_rho = -1.019e-13, checking this took 0.124 ms
2-norm of RHS = 508.7299922017472, which took 0.128 ms

iter_count = 174, r_2norm = 4.769e-04, tol*||rhs|| = 5.087e-04

Anderson update took 103.371 ms, out of which F'*F took 48.746 ms; b-Ax took 332.881 ms, out of which Lap took 294.139 ms
Solving Poisson took 725.264 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.079894 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.097806 
Total time for convolution: 	 convolve: 5.081149 
Total time for convolution: 	 convolve: 5.075654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 2.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26989.654 ms, scf error = 2.823e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132869, lowerbound = -1.024294, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1348.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.812 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.077 ms
rank =  0, Distribute data + matrix mult took 16.464 ms
rank =  0, finding HY took 21.285 ms
rank =  0, distributing HY into block cyclic form took 15.265 ms
rank =  0, finding Y'*HY took 2.241 ms
Rank 0, Project_Hamiltonian used 55.291 ms
Total time for projection: 55.306 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -1.023885588317966
    last  calculated eigval = 0.033557606007547
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02388558831797
lambda[   2] =  -0.86572986231670
lambda[   3] =  -0.55019073630359
lambda[   4] =  -0.45210600840740
lambda[   5] =  -0.41425184950645
lambda[   6] =  -0.41086850756827
lambda[   7] =  -0.28951807301124
lambda[   8] =  -0.26605355946838
lambda[   9] =  -0.03201354581861
lambda[  10] =  -0.03004174509067
lambda[  11] =   0.01608585681235
lambda[  12] =   0.02357611647171
lambda[  13] =   0.03258594320836
lambda[  14] =   0.03355760600755
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.519 ms
rank =  0, subspace rotation using ScaLAPACK took 4.875 ms
rank =  0, Distributing orbital back into band + domain format took 13.828 ms
rank = 0, Subspace_Rotation used 18.725 ms

Total time for subspace rotation: 18.730 ms
rank = 0, Efermi =  -0.061662483850 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.481 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.805 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1426.849 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
rank = 0, D2D took 0.957 ms
rank = 0, Transfering density took 0.962 ms
Etot    =   -33.526792372015
Eband   =    -8.545208370208
E1      =    18.007622382311
E2      =    -8.324143510348
E3      =   -10.741229204939
Exc     =    -9.666106083610
Esc     =   -52.388473015401
Entropy =    -0.000000000393
dE = 1.113e-05, dEband = 1.523e-03
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -33.526792372, dEtot = 1.113e-05, dEband = 1.523e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0298635609379, which took 0.113 ms

iter_count = 114, r_2norm = 7.273e-07, tol*||rhs|| = 1.195e-06

Anderson update took 67.750 ms, out of which F'*F took 32.474 ms; b-Ax took 220.066 ms, out of which Lap took 195.782 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.993 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281437, int_b + int_rho = -5.275e-14, checking this took 0.145 ms
2-norm of RHS = 508.7385011541283, which took 0.134 ms

iter_count = 168, r_2norm = 4.253e-04, tol*||rhs|| = 5.087e-04

Anderson update took 99.666 ms, out of which F'*F took 47.200 ms; b-Ax took 321.450 ms, out of which Lap took 283.857 ms
Solving Poisson took 699.853 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.076392 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.110694 
Total time for convolution: 	 convolve: 5.092484 
Total time for convolution: 	 convolve: 5.085202 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.017 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.405 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 27007.291 ms, scf error = 1.950e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133558, lowerbound = -1.023886, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1346.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.798 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 16.465 ms
rank =  0, finding HY took 21.334 ms
rank =  0, distributing HY into block cyclic form took 15.095 ms
rank =  0, finding Y'*HY took 2.306 ms
Rank 0, Project_Hamiltonian used 55.237 ms
Total time for projection: 55.641 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.437 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.568 ms
rank = 0, Solve_Generalized_EigenProblem used 1.013 ms
    first calculated eigval = -1.023666685445095
    last  calculated eigval = 0.034979704607996
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02366668544509
lambda[   2] =  -0.86550410642107
lambda[   3] =  -0.54995993184532
lambda[   4] =  -0.45191532223122
lambda[   5] =  -0.41402884319801
lambda[   6] =  -0.41064887856442
lambda[   7] =  -0.28931514817660
lambda[   8] =  -0.26584852519866
lambda[   9] =  -0.03186195442528
lambda[  10] =  -0.02938965356717
lambda[  11] =   0.01631820515041
lambda[  12] =   0.02337604035364
lambda[  13] =   0.03316218967698
lambda[  14] =   0.03497970460800
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.034 ms
rank =  0, subspace rotation using ScaLAPACK took 4.106 ms
rank =  0, Distributing orbital back into band + domain format took 14.392 ms
rank = 0, Subspace_Rotation used 18.514 ms

Total time for subspace rotation: 18.524 ms
rank = 0, Efermi =  -0.061473517441 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.484 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.864 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.097 ms
rank = 0, Calculating density took 1424.968 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.788 ms
rank = 0, D2D took 1.035 ms
rank = 0, Transfering density took 1.042 ms
Etot    =   -33.526819308572
Eband   =    -8.541774882567
E1      =    18.006074286040
E2      =    -8.322194431452
E3      =   -10.741386277860
Exc     =    -9.666226405563
Esc     =   -52.388473015401
Entropy =    -0.000000000392
dE = 6.734e-06, dEband = 8.584e-04
rank = 0, Calculating/Estimating energy took 1.074 ms, Etot = -33.526819309, dEtot = 6.734e-06, dEband = 8.584e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0300038513086, which took 0.074 ms

iter_count = 108, r_2norm = 1.146e-06, tol*||rhs|| = 1.200e-06

Anderson update took 64.248 ms, out of which F'*F took 30.080 ms; b-Ax took 207.491 ms, out of which Lap took 183.960 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.569 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281433, int_b + int_rho = -1.000e-13, checking this took 0.107 ms
2-norm of RHS = 508.7369046789360, which took 0.130 ms

iter_count = 126, r_2norm = 4.835e-04, tol*||rhs|| = 5.087e-04

Anderson update took 75.216 ms, out of which F'*F took 35.377 ms; b-Ax took 244.430 ms, out of which Lap took 216.604 ms
Solving Poisson took 527.993 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.078702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.161 ms
Total time for convolution: 	 convolve: 5.089491 
Total time for convolution: 	 convolve: 5.093447 
Total time for convolution: 	 convolve: 5.077567 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.281 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 27038.824 ms, scf error = 1.904e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134980, lowerbound = -1.023667, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 2424.672 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.090 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.317 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 153.129 ms
rank =  0, Distribute data + matrix mult took 167.562 ms
rank =  0, finding HY took 17.376 ms
rank =  0, distributing HY into block cyclic form took 97.576 ms
rank =  0, finding Y'*HY took 13.725 ms
Rank 0, Project_Hamiltonian used 296.289 ms
Total time for projection: 296.306 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.023623118396653
    last  calculated eigval = 0.035711948199859
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02362311839665
lambda[   2] =  -0.86545549737404
lambda[   3] =  -0.54991384340818
lambda[   4] =  -0.45186924907633
lambda[   5] =  -0.41397928289522
lambda[   6] =  -0.41060004774757
lambda[   7] =  -0.28926921290268
lambda[   8] =  -0.26580158772390
lambda[   9] =  -0.03180281961347
lambda[  10] =  -0.02892279640787
lambda[  11] =   0.01639027186155
lambda[  12] =   0.02285330387324
lambda[  13] =   0.03328911692613
lambda[  14] =   0.03571194819986
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.607 ms
rank =  0, Distributing orbital back into band + domain format took 13.649 ms
rank = 0, Subspace_Rotation used 17.276 ms

Total time for subspace rotation: 17.280 ms
rank = 0, Efermi =  -0.061396066069 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.336 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.838 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 2741.783 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.736 ms
rank = 0, Transfering density took 0.744 ms
Etot    =   -33.526824332438
Eband   =    -8.541023679455
E1      =    18.005742176712
E2      =    -8.321782478000
E3      =   -10.741356690038
Exc     =    -9.666208981939
Esc     =   -52.388473015401
Entropy =    -0.000000000391
dE = 1.256e-06, dEband = 1.878e-04
rank = 0, Calculating/Estimating energy took 33.254 ms, Etot = -33.526824332, dEtot = 1.256e-06, dEband = 1.878e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0323131337622, which took 0.055 ms

iter_count = 108, r_2norm = 1.145e-06, tol*||rhs|| = 1.293e-06

Anderson update took 350.212 ms, out of which F'*F took 151.852 ms; b-Ax took 557.883 ms, out of which Lap took 539.871 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1202.959 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281439, int_b + int_rho = -3.456e-14, checking this took 0.137 ms
2-norm of RHS = 508.7362855420831, which took 0.098 ms

iter_count = 96, r_2norm = 4.988e-04, tol*||rhs|| = 5.087e-04

Anderson update took 56.868 ms, out of which F'*F took 27.127 ms; b-Ax took 185.069 ms, out of which Lap took 163.386 ms
Solving Poisson took 402.199 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.161 ms
Total time for convolution: 	 convolve: 5.085758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.080426 
Total time for convolution: 	 convolve: 5.098714 
Total time for convolution: 	 convolve: 5.076759 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.655 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.955 ms

This SCF took 28720.944 ms, scf error = 1.892e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135712, lowerbound = -1.023623, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1342.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.832 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.426 ms
rank =  0, finding HY took 21.399 ms
rank =  0, distributing HY into block cyclic form took 15.119 ms
rank =  0, finding Y'*HY took 2.301 ms
Rank 0, Project_Hamiltonian used 55.289 ms
Total time for projection: 55.304 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -1.023604685153718
    last  calculated eigval = 0.035919935393676
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02360468515372
lambda[   2] =  -0.86543826170434
lambda[   3] =  -0.54989618083386
lambda[   4] =  -0.45184662678271
lambda[   5] =  -0.41395861810907
lambda[   6] =  -0.41057939762110
lambda[   7] =  -0.28924884246223
lambda[   8] =  -0.26578154669442
lambda[   9] =  -0.03179647453704
lambda[  10] =  -0.02884823558051
lambda[  11] =   0.01640184816010
lambda[  12] =   0.02179366481379
lambda[  13] =   0.03301017980407
lambda[  14] =   0.03591993539368
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 4.217 ms
rank =  0, Distributing orbital back into band + domain format took 14.265 ms
rank = 0, Subspace_Rotation used 18.501 ms

Total time for subspace rotation: 18.504 ms
rank = 0, Efermi =  -0.061387407916 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.481 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.873 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1420.094 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 1.051 ms
rank = 0, Transfering density took 1.054 ms
Etot    =   -33.526823961138
Eband   =    -8.540708319129
E1      =    18.005621811003
E2      =    -8.321593892525
E3      =   -10.741338943592
Exc     =    -9.666197273335
Esc     =   -52.388473015401
Entropy =    -0.000000000391
dE = 9.283e-08, dEband = 7.884e-05
rank = 0, Calculating/Estimating energy took 1.063 ms, Etot = -33.526823961, dEtot = 9.283e-08, dEband = 7.884e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0359787962635, which took 0.054 ms

iter_count = 108, r_2norm = 1.171e-06, tol*||rhs|| = 1.439e-06

Anderson update took 64.538 ms, out of which F'*F took 30.416 ms; b-Ax took 207.649 ms, out of which Lap took 184.207 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.270 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281434, int_b + int_rho = -8.367e-14, checking this took 0.119 ms
2-norm of RHS = 508.7369768459881, which took 0.140 ms

iter_count = 102, r_2norm = 4.664e-04, tol*||rhs|| = 5.087e-04

Anderson update took 60.764 ms, out of which F'*F took 28.709 ms; b-Ax took 194.844 ms, out of which Lap took 172.775 ms
Solving Poisson took 426.723 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.084330 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.075079 
Total time for convolution: 	 convolve: 5.079986 
Total time for convolution: 	 convolve: 5.090706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.480 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.519 ms

This SCF took 26645.797 ms, scf error = 1.912e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135920, lowerbound = -1.023605, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1339.016 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.860 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.582 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.469 ms
rank =  0, finding HY took 21.347 ms
rank =  0, distributing HY into block cyclic form took 15.114 ms
rank =  0, finding Y'*HY took 2.295 ms
Rank 0, Project_Hamiltonian used 55.258 ms
Total time for projection: 55.276 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.023662750605348
    last  calculated eigval = 0.035154922904767
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02366275060535
lambda[   2] =  -0.86548720136228
lambda[   3] =  -0.54993588275494
lambda[   4] =  -0.45190008675547
lambda[   5] =  -0.41400943090708
lambda[   6] =  -0.41062933984831
lambda[   7] =  -0.28929372112285
lambda[   8] =  -0.26582729447250
lambda[   9] =  -0.03190271360850
lambda[  10] =  -0.02949304905931
lambda[  11] =   0.01627027540552
lambda[  12] =   0.02006127099230
lambda[  13] =   0.03220025269274
lambda[  14] =   0.03515492290477
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.233 ms
rank =  0, Distributing orbital back into band + domain format took 14.191 ms
rank = 0, Subspace_Rotation used 18.445 ms

Total time for subspace rotation: 18.448 ms
rank = 0, Efermi =  -0.061517913723 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.796 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1416.421 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.716 ms
rank = 0, D2D took 0.981 ms
rank = 0, Transfering density took 0.985 ms
Etot    =   -33.526832027069
Eband   =    -8.541491416065
E1      =    18.006075564823
E2      =    -8.321952145114
E3      =   -10.741184827475
Exc     =    -9.666080132623
Esc     =   -52.388473015401
Entropy =    -0.000000000392
dE = 2.016e-06, dEband = 1.958e-04
rank = 0, Calculating/Estimating energy took 1.105 ms, Etot = -33.526832027, dEtot = 2.016e-06, dEband = 1.958e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0335589629776, which took 0.067 ms

iter_count = 108, r_2norm = 1.189e-06, tol*||rhs|| = 1.342e-06

Anderson update took 64.405 ms, out of which F'*F took 30.686 ms; b-Ax took 208.668 ms, out of which Lap took 185.385 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.673 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281433, int_b + int_rho = -9.641e-14, checking this took 0.122 ms
2-norm of RHS = 508.7376961745229, which took 0.160 ms

iter_count = 72, r_2norm = 4.541e-04, tol*||rhs|| = 5.087e-04

Anderson update took 42.530 ms, out of which F'*F took 20.050 ms; b-Ax took 137.100 ms, out of which Lap took 120.499 ms
Solving Poisson took 302.173 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.079221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.094733 
Total time for convolution: 	 convolve: 5.074203 
Total time for convolution: 	 convolve: 5.099341 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.024 ms
---Transfer Veff_loc: D2D took 1.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.784 ms

This SCF took 26569.329 ms, scf error = 1.995e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135155, lowerbound = -1.023663, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1344.329 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.861 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.435 ms
rank =  0, finding HY took 21.243 ms
rank =  0, distributing HY into block cyclic form took 15.200 ms
rank =  0, finding Y'*HY took 2.275 ms
Rank 0, Project_Hamiltonian used 55.193 ms
Total time for projection: 55.208 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -1.023665422432781
    last  calculated eigval = 0.035429300798847
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02366542243278
lambda[   2] =  -0.86548503344690
lambda[   3] =  -0.54992916671535
lambda[   4] =  -0.45190057860823
lambda[   5] =  -0.41400656602267
lambda[   6] =  -0.41062655429038
lambda[   7] =  -0.28928920082055
lambda[   8] =  -0.26582372768572
lambda[   9] =  -0.03184593547714
lambda[  10] =  -0.02916048460027
lambda[  11] =   0.01631091180804
lambda[  12] =   0.01941904578008
lambda[  13] =   0.03202415329881
lambda[  14] =   0.03542930079885
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 4.205 ms
rank =  0, Distributing orbital back into band + domain format took 14.288 ms
rank = 0, Subspace_Rotation used 18.509 ms

Total time for subspace rotation: 18.514 ms
rank = 0, Efermi =  -0.061446871917 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 1421.720 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.749 ms
rank = 0, D2D took 1.007 ms
rank = 0, Transfering density took 1.018 ms
Etot    =   -33.526829833374
Eband   =    -8.541452500452
E1      =    18.006117257344
E2      =    -8.321882107440
E3      =   -10.741153885005
Exc     =    -9.666057566919
Esc     =   -52.388473015401
Entropy =    -0.000000000392
dE = 5.484e-07, dEband = 9.729e-06
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -33.526829833, dEtot = 5.484e-07, dEband = 9.729e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0315821448010, which took 0.057 ms

iter_count = 108, r_2norm = 1.119e-06, tol*||rhs|| = 1.263e-06

Anderson update took 64.417 ms, out of which F'*F took 30.126 ms; b-Ax took 207.513 ms, out of which Lap took 184.193 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.472 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281434, int_b + int_rho = -8.549e-14, checking this took 0.084 ms
2-norm of RHS = 508.7387726786637, which took 0.128 ms

iter_count = 72, r_2norm = 4.990e-04, tol*||rhs|| = 5.087e-04

Anderson update took 42.977 ms, out of which F'*F took 20.119 ms; b-Ax took 137.513 ms, out of which Lap took 121.501 ms
Solving Poisson took 302.000 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.081548 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.083060 
Total time for convolution: 	 convolve: 5.087940 
Total time for convolution: 	 convolve: 5.077847 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.973 ms

This SCF took 26521.513 ms, scf error = 2.174e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135429, lowerbound = -1.023665, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1354.793 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.896 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 16.467 ms
rank =  0, finding HY took 21.331 ms
rank =  0, distributing HY into block cyclic form took 15.194 ms
rank =  0, finding Y'*HY took 2.239 ms
Rank 0, Project_Hamiltonian used 55.269 ms
Total time for projection: 55.288 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -1.023603001381379
    last  calculated eigval = 0.035194127499321
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02360300138138
lambda[   2] =  -0.86542798286405
lambda[   3] =  -0.54988756857524
lambda[   4] =  -0.45184425951683
lambda[   5] =  -0.41395513672112
lambda[   6] =  -0.41057561685106
lambda[   7] =  -0.28924191053613
lambda[   8] =  -0.26577475118056
lambda[   9] =  -0.03183809274859
lambda[  10] =  -0.02933371364264
lambda[  11] =   0.01631660449585
lambda[  12] =   0.01827899286758
lambda[  13] =   0.03170599097011
lambda[  14] =   0.03519412749932
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 4.244 ms
rank =  0, Distributing orbital back into band + domain format took 14.262 ms
rank = 0, Subspace_Rotation used 18.525 ms

Total time for subspace rotation: 18.529 ms
rank = 0, Efermi =  -0.061447889245 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.436 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.901 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1432.288 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.790 ms
rank = 0, D2D took 1.002 ms
rank = 0, Transfering density took 1.005 ms
Etot    =   -33.526830837360
Eband   =    -8.540620455659
E1      =    18.005603475669
E2      =    -8.321510521132
E3      =   -10.741345181205
Exc     =    -9.666196543914
Esc     =   -52.388473015401
Entropy =    -0.000000000392
dE = 2.510e-07, dEband = 2.080e-04
rank = 0, Calculating/Estimating energy took 1.057 ms, Etot = -33.526830837, dEtot = 2.510e-07, dEband = 2.080e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354644469601, which took 0.126 ms

iter_count = 108, r_2norm = 1.109e-06, tol*||rhs|| = 1.419e-06

Anderson update took 63.651 ms, out of which F'*F took 30.214 ms; b-Ax took 207.659 ms, out of which Lap took 183.870 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.299 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281436, int_b + int_rho = -6.548e-14, checking this took 0.112 ms
2-norm of RHS = 508.7359129681943, which took 0.142 ms

iter_count = 114, r_2norm = 4.520e-04, tol*||rhs|| = 5.087e-04

Anderson update took 67.605 ms, out of which F'*F took 31.849 ms; b-Ax took 218.356 ms, out of which Lap took 192.362 ms
Solving Poisson took 475.553 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.094703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.076697 
Total time for convolution: 	 convolve: 5.121154 
Total time for convolution: 	 convolve: 5.086541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.828 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 26728.039 ms, scf error = 1.880e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.135194, lowerbound = -1.023603, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1326.053 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.539 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.059 ms
rank =  0, Distribute data + matrix mult took 16.375 ms
rank =  0, finding HY took 21.399 ms
rank =  0, distributing HY into block cyclic form took 15.046 ms
rank =  0, finding Y'*HY took 2.275 ms
Rank 0, Project_Hamiltonian used 55.133 ms
Total time for projection: 55.150 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -1.023499257661393
    last  calculated eigval = 0.035061927474763
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02349925766139
lambda[   2] =  -0.86534352856061
lambda[   3] =  -0.54982248575856
lambda[   4] =  -0.45175797732817
lambda[   5] =  -0.41387375531628
lambda[   6] =  -0.41049511019253
lambda[   7] =  -0.28917030769968
lambda[   8] =  -0.26569889481048
lambda[   9] =  -0.03180795196241
lambda[  10] =  -0.02944637551062
lambda[  11] =   0.01630814568898
lambda[  12] =   0.01746699329098
lambda[  13] =   0.03122553806002
lambda[  14] =   0.03506192747476
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 4.226 ms
rank =  0, Distributing orbital back into band + domain format took 14.169 ms
rank = 0, Subspace_Rotation used 18.418 ms

Total time for subspace rotation: 18.422 ms
rank = 0, Efermi =  -0.061426121152 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.477 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.842 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1403.292 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.703 ms
rank = 0, D2D took 0.950 ms
rank = 0, Transfering density took 0.954 ms
Etot    =   -33.526832922056
Eband   =    -8.539322635061
E1      =    18.004710945652
E2      =    -8.321032101608
E3      =   -10.741632771657
Exc     =    -9.666413090118
Esc     =   -52.388473015401
Entropy =    -0.000000000392
dE = 5.212e-07, dEband = 3.245e-04
rank = 0, Calculating/Estimating energy took 1.955 ms, Etot = -33.526832922, dEtot = 5.212e-07, dEband = 3.245e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0369998339181, which took 0.057 ms

iter_count = 108, r_2norm = 9.563e-07, tol*||rhs|| = 1.480e-06

Anderson update took 63.419 ms, out of which F'*F took 29.797 ms; b-Ax took 206.471 ms, out of which Lap took 182.515 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.837 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281435, int_b + int_rho = -7.640e-14, checking this took 0.098 ms
2-norm of RHS = 508.7353368209451, which took 0.140 ms

iter_count = 144, r_2norm = 4.349e-04, tol*||rhs|| = 5.087e-04

Anderson update took 85.274 ms, out of which F'*F took 39.939 ms; b-Ax took 274.562 ms, out of which Lap took 242.458 ms
Solving Poisson took 599.047 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.124816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.138598 
Total time for convolution: 	 convolve: 5.088377 
Total time for convolution: 	 convolve: 5.077752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.503 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.962 ms

This SCF took 26926.959 ms, scf error = 1.386e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.135062, lowerbound = -1.023499, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1362.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.796 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.592 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.078 ms
rank =  0, Distribute data + matrix mult took 16.485 ms
rank =  0, finding HY took 21.307 ms
rank =  0, distributing HY into block cyclic form took 15.037 ms
rank =  0, finding Y'*HY took 2.355 ms
Rank 0, Project_Hamiltonian used 55.218 ms
Total time for projection: 55.236 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -1.023378561779065
    last  calculated eigval = 0.035107786785946
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02337856177907
lambda[   2] =  -0.86524298763729
lambda[   3] =  -0.54971795771767
lambda[   4] =  -0.45165224086495
lambda[   5] =  -0.41376601431213
lambda[   6] =  -0.41038821017855
lambda[   7] =  -0.28907146614539
lambda[   8] =  -0.26559694598006
lambda[   9] =  -0.03182848096202
lambda[  10] =  -0.02969268406090
lambda[  11] =   0.01624209164509
lambda[  12] =   0.01690635022694
lambda[  13] =   0.03076643377482
lambda[  14] =   0.03510778678595
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 4.239 ms
rank =  0, Distributing orbital back into band + domain format took 14.140 ms
rank = 0, Subspace_Rotation used 18.398 ms

Total time for subspace rotation: 18.402 ms
rank = 0, Efermi =  -0.061462887346 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.473 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.901 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1439.482 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.017 ms
rank = 0, D2D took 2.137 ms
rank = 0, Transfering density took 2.142 ms
Etot    =   -33.526837211521
Eband   =    -8.537628769636
E1      =    18.003800717935
E2      =    -8.320202421836
E3      =   -10.741809240738
Exc     =    -9.666547806600
Esc     =   -52.388473015401
Entropy =    -0.000000000393
dE = 1.072e-06, dEband = 4.235e-04
rank = 0, Calculating/Estimating energy took 1.450 ms, Etot = -33.526837212, dEtot = 1.072e-06, dEband = 4.235e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0323163011809, which took 0.065 ms

iter_count = 102, r_2norm = 1.183e-06, tol*||rhs|| = 1.293e-06

Anderson update took 60.224 ms, out of which F'*F took 28.215 ms; b-Ax took 194.952 ms, out of which Lap took 172.824 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.848 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281437, int_b + int_rho = -5.639e-14, checking this took 0.106 ms
2-norm of RHS = 508.7373276380243, which took 0.132 ms

iter_count = 150, r_2norm = 5.044e-04, tol*||rhs|| = 5.087e-04

Anderson update took 88.859 ms, out of which F'*F took 41.765 ms; b-Ax took 286.553 ms, out of which Lap took 252.643 ms
Solving Poisson took 624.254 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.099594 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.084141 
Total time for convolution: 	 convolve: 5.076927 
Total time for convolution: 	 convolve: 5.086782 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.221 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.136 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 26857.578 ms, scf error = 1.076e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.135108, lowerbound = -1.023379, upperbound = 267.571962

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1357.983 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.780 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 16.386 ms
rank =  0, finding HY took 21.383 ms
rank =  0, distributing HY into block cyclic form took 15.050 ms
rank =  0, finding Y'*HY took 2.475 ms
Rank 0, Project_Hamiltonian used 55.338 ms
Total time for projection: 55.359 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -1.023179472072351
    last  calculated eigval = 0.035037138722880
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02317947207235
lambda[   2] =  -0.86505260964738
lambda[   3] =  -0.54953503054123
lambda[   4] =  -0.45148155928278
lambda[   5] =  -0.41358457025698
lambda[   6] =  -0.41020856241146
lambda[   7] =  -0.28890609587566
lambda[   8] =  -0.26542447672894
lambda[   9] =  -0.03183345222094
lambda[  10] =  -0.02990789190247
lambda[  11] =   0.01618199097913
lambda[  12] =   0.01669867763106
lambda[  13] =   0.03047920132807
lambda[  14] =   0.03503713872288
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 4.292 ms
rank =  0, Distributing orbital back into band + domain format took 13.978 ms
rank = 0, Subspace_Rotation used 18.294 ms

Total time for subspace rotation: 18.299 ms
rank = 0, Efermi =  -0.061486963864 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.272 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.809 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1436.180 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.456 ms
rank = 0, D2D took 0.578 ms
rank = 0, Transfering density took 0.583 ms
Etot    =   -33.526844958986
Eband   =    -8.534744754039
E1      =    18.002208016481
E2      =    -8.318815198992
E3      =   -10.742169724825
Exc     =    -9.666820129450
Esc     =   -52.388473015401
Entropy =    -0.000000000393
dE = 1.937e-06, dEband = 7.210e-04
rank = 0, Calculating/Estimating energy took 1.182 ms, Etot = -33.526844959, dEtot = 1.937e-06, dEband = 7.210e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0194313287272, which took 0.051 ms

iter_count = 108, r_2norm = 5.559e-07, tol*||rhs|| = 7.773e-07

Anderson update took 63.817 ms, out of which F'*F took 29.708 ms; b-Ax took 205.368 ms, out of which Lap took 181.809 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001281443, int_rho =  16.00000001281434, int_b + int_rho = -8.731e-14, checking this took 0.105 ms
2-norm of RHS = 508.7385628591246, which took 0.143 ms

iter_count = 132, r_2norm = 4.605e-04, tol*||rhs|| = 5.087e-04

Anderson update took 78.039 ms, out of which F'*F took 36.739 ms; b-Ax took 252.400 ms, out of which Lap took 222.512 ms
Solving Poisson took 549.464 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.077375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.095281 
Total time for convolution: 	 convolve: 5.085150 
Total time for convolution: 	 convolve: 5.079389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.966 ms

This SCF took 26801.739 ms, scf error = 6.854e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.02317947207235, occ[   1] =   2.00000000000000
lambda[   2] =  -0.86505260964738, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54953503054123, occ[   3] =   2.00000000000000
lambda[   4] =  -0.45148155928278, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41358457025698, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41020856241146, occ[   6] =   2.00000000000000
lambda[   7] =  -0.28890609587566, occ[   7] =   2.00000000000000
lambda[   8] =  -0.26542447672894, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03183345222094, occ[   9] =   0.00000001158403
lambda[  10] =  -0.02990789190247, occ[  10] =   0.00000000123032
lambda[  11] =   0.01618199097913, occ[  11] =   0.00000000000000
lambda[  12] =   0.01669867763106, occ[  12] =   0.00000000000000
lambda[  13] =   0.03047920132807, occ[  13] =   0.00000000000000
lambda[  14] =   0.03503713872288, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.442 ms, time for Allreduce/Reduce: 6.100 ms 
Time for calculating local force components: 14.604 ms
Start Calculating nonlocal forces
force_nloc = 
  0.60549008015163  -1.23165769639154  -0.00000013501966
 -0.06284664054067   0.01956424917833  -0.00000000010564
 -0.10194008327463   0.04394829712455   0.00000013801036
  0.28229801796920   0.65611988234846  -0.00000094284785
force_loc = 
 -0.59672477552196   1.21161455742678  -0.00000041991201
  0.06490619180456  -0.02136221614325   0.00000012064281
  0.10202666427348  -0.04254197109257   0.00000073038009
 -0.27182843442093  -0.65454984972621   0.00000174338488
Time for calculating nonlocal force components: 28.880 ms
[32mforces_xc: 
[0m[32m -0.01412810097212   0.02887315646268  -0.00000003111354
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00147834530319   0.00073582067820   0.00000004576122
[0m[32m -0.00866550292767  -0.01066593579633   0.00000004206040
[0mTime for calculating XC forces components: 17.108 ms
 Cartesian force = 
 -0.00537923680347   0.00881044398065  -0.00000090885548
  0.00204311080287  -0.00181754048220  -0.00000020227309
  0.00154848584102   0.00212257319291   0.00000059134140
  0.00178764015958  -0.00911547669135   0.00000051978717
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 384.389 ms
The program took 632.913 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:51
Job ID:        2266591
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:09:48,vmem=8460K,walltime=00:10:49,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-24-2
---------------------------------------
