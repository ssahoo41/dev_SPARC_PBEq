---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:43
Job ID:    2266469
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:49
Job ID:    2266469
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 8.692 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 15.012 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 83.766 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.015 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.270820	   11.168857	   10.000000	
    8.202360	   12.406905	   10.000000	
    9.035202	   14.038705	   10.000000	
    7.729180	    7.802293	   11.648996	
    7.729180	    7.802293	    8.351004	
   11.982338	    6.168834	   11.521237	
   11.982338	    6.168834	    8.478763	
   10.055169	   10.647304	   10.000000	
    8.972280	    7.977187	   10.000000	
   10.828339	    5.961295	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 1.196 ms
Set up communicators.

--set up spincomm took 1.276 ms

--set up kptcomm took 0.368 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.021 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.055 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.371 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.408 ms

Calculate_SplineDerivRadFun took 0.307 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.810 ms.
time spent on vectorized spline interp: 3.137 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.717 ms.
time spent on vectorized spline interp: 1.393 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.285 ms.
time spent on vectorized spline interp: 1.608 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.518 ms.
time spent on vectorized spline interp: 1.608 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.543 ms.

Calculating rb for all atom types took 20.531 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.832 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000315114, sum_int_rho = 29.4973177891820
PosCharge = 30.000000031511, NegCharge = -29.497317789182, scal_fac = 1.017041625477
After scaling, int_rho = 30.0000000315115, PosCharge + NegCharge - NetCharge = -1.350e-13
--Calculate Vref took 0.602 ms
--Calculate rho_guess took 3.261 ms

 integral of b = -30.0000000315114,
 int{b} + Nelectron + NetCharge = -3.151e-08,
 Esc = -92.5712503275837,
 MPI_Reduce took 11.199 ms

Calculating b & b_ref took 22.710 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.083 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.143 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.108 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.729 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.669 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151148, int_b + int_rho = 3.929e-13, checking this took 0.305 ms
2-norm of RHS = 783.5513908342549, which took 0.116 ms

iter_count = 420, r_2norm = 6.524e-04, tol*||rhs|| = 7.836e-04

Anderson update took 234.399 ms, out of which F'*F took 105.893 ms; b-Ax took 713.673 ms, out of which Lap took 639.935 ms
Solving Poisson took 1520.393 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.464 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.154647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
Total time for convolution: 	 convolve: 5.136148 
Total time for convolution: 	 convolve: 5.145304 
Total time for convolution: 	 convolve: 5.114491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.467 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, XC calculation took 24502.090 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.031 ms
---Transfer Veff_loc: D2D took 5.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.999 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.841 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.153 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.641 ms
    Lanczos iter 53, eigmin  = -1.047082907, eigmax = 264.930601388, err_eigmin = 1.132e-03, err_eigmax = 9.683e-03
rank =   0, Lanczos took 119.551 ms, eigmin = -1.047082907168, eigmax = 267.579907402229

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.216412, lowerbound = -1.147083, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1587.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.271 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.216 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.509 ms
rank =  0, finding HY took 26.352 ms
rank =  0, distributing HY into block cyclic form took 21.689 ms
rank =  0, finding Y'*HY took 6.072 ms
Rank 0, Project_Hamiltonian used 78.654 ms
Total time for projection: 78.665 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.776 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.120 ms
rank = 0, Solve_Generalized_EigenProblem used 0.900 ms
    first calculated eigval = 2.697283104794050
    last  calculated eigval = 3.286973971241398
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.84693466145086
lambda[   7] =   2.89465650135646
lambda[   8] =   2.89704447441528
lambda[   9] =   2.93736204975394
lambda[  10] =   2.96585491160491
lambda[  11] =   2.98054702047948
lambda[  12] =   3.00821502199249
lambda[  13] =   3.02078967029267
lambda[  14] =   3.03148931553465
lambda[  15] =   3.05561788844588
lambda[  16] =   3.07547054169101
lambda[  17] =   3.10365059809469
lambda[  18] =   3.14577625503307
lambda[  19] =   3.14950996452448
lambda[  20] =   3.16466761048422
lambda[  21] =   3.17919797780971
lambda[  22] =   3.21874828512831
lambda[  23] =   3.28697397124140
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.915 ms
rank =  0, subspace rotation using ScaLAPACK took 9.221 ms
rank =  0, Distributing orbital back into band + domain format took 19.715 ms
rank = 0, Subspace_Rotation used 28.950 ms

Total time for subspace rotation: 28.954 ms
rank = 0, Efermi =   3.065544215706 calculate fermi energy took 0.052 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.386974, lowerbound = -1.147083, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1519.083 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 68.174 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.212 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 71.405 ms
rank =  0, finding HY took 26.556 ms
rank =  0, distributing HY into block cyclic form took 19.716 ms
rank =  0, finding Y'*HY took 4.843 ms
Rank 0, Project_Hamiltonian used 122.549 ms
Total time for projection: 122.554 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.161 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.818 ms
    first calculated eigval = -0.859386298306424
    last  calculated eigval = 0.471160355820476
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.26679057625433
lambda[   7] =  -0.22231134458239
lambda[   8] =  -0.16706163595895
lambda[   9] =  -0.04826487526018
lambda[  10] =  -0.00671639931479
lambda[  11] =   0.04401238869016
lambda[  12] =   0.11440817434541
lambda[  13] =   0.21907302159192
lambda[  14] =   0.26244737040898
lambda[  15] =   0.30716623051991
lambda[  16] =   0.32974205003659
lambda[  17] =   0.33931574152932
lambda[  18] =   0.35088386864598
lambda[  19] =   0.37022187220413
lambda[  20] =   0.39294357746289
lambda[  21] =   0.41788782400128
lambda[  22] =   0.43805592826942
lambda[  23] =   0.47116035582048
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.828 ms
rank =  0, subspace rotation using ScaLAPACK took 19.535 ms
rank =  0, Distributing orbital back into band + domain format took 19.660 ms
rank = 0, Subspace_Rotation used 39.213 ms

Total time for subspace rotation: 39.217 ms
rank = 0, Efermi =   0.318452088821 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.571160, lowerbound = -1.147083, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1524.111 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.016 ms
rank =  0, Distribute orbital to block cyclic format took 64.543 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.134 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 67.700 ms
rank =  0, finding HY took 26.634 ms
rank =  0, distributing HY into block cyclic form took 19.721 ms
rank =  0, finding Y'*HY took 5.019 ms
Rank 0, Project_Hamiltonian used 119.121 ms
Total time for projection: 119.128 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -1.071419261440819
    last  calculated eigval = 0.180820489989242
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.57191388738419
lambda[   7] =  -0.52177606887081
lambda[   8] =  -0.51387057586268
lambda[   9] =  -0.48436219307610
lambda[  10] =  -0.46304546331916
lambda[  11] =  -0.40606592898602
lambda[  12] =  -0.39171026147269
lambda[  13] =  -0.32449994241871
lambda[  14] =  -0.29373596474900
lambda[  15] =  -0.26702596998079
lambda[  16] =   0.00946015174488
lambda[  17] =   0.03608066400698
lambda[  18] =   0.08818545030799
lambda[  19] =   0.10967590771518
lambda[  20] =   0.11680301658702
lambda[  21] =   0.11803843681371
lambda[  22] =   0.14138602781726
lambda[  23] =   0.18082048998924
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 9.167 ms
rank =  0, Distributing orbital back into band + domain format took 19.657 ms
rank = 0, Subspace_Rotation used 28.841 ms

Total time for subspace rotation: 28.845 ms
rank = 0, Efermi =  -0.019294704847 calculate fermi energy took 0.026 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.280820, lowerbound = -1.147083, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1517.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 59.312 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.925 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 63.257 ms
rank =  0, finding HY took 26.118 ms
rank =  0, distributing HY into block cyclic form took 19.439 ms
rank =  0, finding Y'*HY took 4.952 ms
Rank 0, Project_Hamiltonian used 113.797 ms
Total time for projection: 113.806 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.110 ms
rank = 0, Solve_Generalized_EigenProblem used 0.271 ms
    first calculated eigval = -1.071814727897569
    last  calculated eigval = 0.112638749147231
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.57426575503702
lambda[   7] =  -0.52618130417589
lambda[   8] =  -0.52107747350540
lambda[   9] =  -0.49081142122184
lambda[  10] =  -0.46951424049824
lambda[  11] =  -0.42455278722339
lambda[  12] =  -0.41496806988652
lambda[  13] =  -0.35314544465804
lambda[  14] =  -0.34062559367182
lambda[  15] =  -0.31433194713331
lambda[  16] =  -0.06543216692788
lambda[  17] =  -0.02056040918773
lambda[  18] =   0.03850624194819
lambda[  19] =   0.05782889836305
lambda[  20] =   0.06199411141603
lambda[  21] =   0.07637506440139
lambda[  22] =   0.07932944194804
lambda[  23] =   0.11263874914723
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 9.149 ms
rank =  0, Distributing orbital back into band + domain format took 19.670 ms
rank = 0, Subspace_Rotation used 28.835 ms

Total time for subspace rotation: 28.839 ms
rank = 0, Efermi =  -0.094187023415 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 5.486 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.905 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.626 ms
rank = 0, Calculating density took 6849.577 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.961 ms
Etot    =   -58.613314457720
Eband   =   -17.644218641158
E1      =    34.533245308396
E2      =   -15.035926980265
E3      =   -18.964082525375
Exc     =   -16.931100302081
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 5.861e+00, dEband = 1.764e+00
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -58.613314458, dEtot = 5.861e+00, dEband = 1.764e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 67.8680364318717, which took 0.506 ms

iter_count = 96, r_2norm = 1.797e-03, tol*||rhs|| = 2.715e-03

Anderson update took 51.238 ms, out of which F'*F took 23.715 ms; b-Ax took 162.683 ms, out of which Lap took 145.292 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.201 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151149, int_b + int_rho = 4.002e-13, checking this took 0.104 ms
2-norm of RHS = 778.6285746102395, which took 0.833 ms

iter_count = 288, r_2norm = 6.188e-04, tol*||rhs|| = 7.786e-04

Anderson update took 153.530 ms, out of which F'*F took 70.428 ms; b-Ax took 486.676 ms, out of which Lap took 431.531 ms
Solving Poisson took 1028.967 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.124 ms
Total time for convolution: 	 convolve: 5.217853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.305130 
Total time for convolution: 	 convolve: 5.294543 
Total time for convolution: 	 convolve: 5.176610 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.041 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.624 ms

This SCF took 33256.436 ms, scf error = 1.466e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.212639, lowerbound = -1.071815, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1579.664 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.541 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.086 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.650 ms
rank =  0, finding HY took 26.416 ms
rank =  0, distributing HY into block cyclic form took 20.389 ms
rank =  0, finding Y'*HY took 5.522 ms
Rank 0, Project_Hamiltonian used 75.016 ms
Total time for projection: 75.027 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.148 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.119 ms
rank = 0, Solve_Generalized_EigenProblem used 0.271 ms
    first calculated eigval = -1.051497028311879
    last  calculated eigval = 0.079152975233266
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.53740672851661
lambda[   7] =  -0.50417222299546
lambda[   8] =  -0.48419148112769
lambda[   9] =  -0.45754912012223
lambda[  10] =  -0.44503364929683
lambda[  11] =  -0.39640900194224
lambda[  12] =  -0.39248493747297
lambda[  13] =  -0.31481912935900
lambda[  14] =  -0.30601846228151
lambda[  15] =  -0.28083803186296
lambda[  16] =  -0.06434769003744
lambda[  17] =  -0.03240684174552
lambda[  18] =   0.00930173710499
lambda[  19] =   0.02778242763068
lambda[  20] =   0.03493443900433
lambda[  21] =   0.04632911481473
lambda[  22] =   0.06269125784891
lambda[  23] =   0.07915297523327
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 9.304 ms
rank =  0, Distributing orbital back into band + domain format took 19.651 ms
rank = 0, Subspace_Rotation used 28.972 ms

Total time for subspace rotation: 28.977 ms
rank = 0, Efermi =  -0.093102546666 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.551 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.775 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1701.028 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.820 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.916 ms
Etot    =   -58.537148656947
Eband   =   -16.737176287146
E1      =    33.781729656848
E2      =   -14.905435508940
E3      =   -19.209931374645
Exc     =   -17.125818581715
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 7.617e-03, dEband = 9.070e-02
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -58.537148657, dEtot = 7.617e-03, dEband = 9.070e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 30.9016607115111, which took 0.057 ms

iter_count = 102, r_2norm = 7.681e-04, tol*||rhs|| = 1.236e-03

Anderson update took 54.595 ms, out of which F'*F took 25.420 ms; b-Ax took 172.340 ms, out of which Lap took 154.253 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.353 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151152, int_b + int_rho = 4.293e-13, checking this took 0.120 ms
2-norm of RHS = 775.0113300485240, which took 0.078 ms

iter_count = 294, r_2norm = 6.295e-04, tol*||rhs|| = 7.750e-04

Anderson update took 156.604 ms, out of which F'*F took 72.906 ms; b-Ax took 498.608 ms, out of which Lap took 443.965 ms
Solving Poisson took 1055.210 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.202696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.499 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.188904 
Total time for convolution: 	 convolve: 5.198367 
Total time for convolution: 	 convolve: 5.203477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.006 ms
---Transfer Veff_loc: D2D took 4.291 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.025 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.358 ms

This SCF took 28142.006 ms, scf error = 9.293e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.179153, lowerbound = -1.051497, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1562.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.589 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 7.282 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.888 ms
rank =  0, finding HY took 26.627 ms
rank =  0, distributing HY into block cyclic form took 20.005 ms
rank =  0, finding Y'*HY took 4.806 ms
Rank 0, Project_Hamiltonian used 78.379 ms
Total time for projection: 78.391 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.241 ms
    first calculated eigval = -1.031623326043941
    last  calculated eigval = 0.067587973808041
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.49484797903463
lambda[   7] =  -0.47512189117730
lambda[   8] =  -0.44817709267014
lambda[   9] =  -0.41766836771927
lambda[  10] =  -0.41758452855317
lambda[  11] =  -0.36759832975811
lambda[  12] =  -0.36132395427122
lambda[  13] =  -0.29243788329589
lambda[  14] =  -0.25920610793278
lambda[  15] =  -0.24460360362501
lambda[  16] =  -0.05133978809770
lambda[  17] =  -0.03341331151608
lambda[  18] =   0.00107629112447
lambda[  19] =   0.01865352325414
lambda[  20] =   0.02643084090128
lambda[  21] =   0.03011778228306
lambda[  22] =   0.05546936573319
lambda[  23] =   0.06758797380804
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 9.284 ms
rank =  0, Distributing orbital back into band + domain format took 19.803 ms
rank = 0, Subspace_Rotation used 29.111 ms

Total time for subspace rotation: 29.116 ms
rank = 0, Efermi =  -0.080094644623 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.644 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1687.540 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.942 ms
Etot    =   -58.497471929832
Eband   =   -15.732652776081
E1      =    32.978739276648
E2      =   -14.683587059491
E3      =   -19.498757548203
Exc     =   -17.354652709576
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 3.968e-03, dEband = 1.005e-01
rank = 0, Calculating/Estimating energy took 0.949 ms, Etot = -58.497471930, dEtot = 3.968e-03, dEband = 1.005e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.3759522499457, which took 0.054 ms

iter_count = 102, r_2norm = 2.934e-04, tol*||rhs|| = 3.350e-04

Anderson update took 60.190 ms, out of which F'*F took 25.420 ms; b-Ax took 174.059 ms, out of which Lap took 156.106 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.551 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151144, int_b + int_rho = 3.565e-13, checking this took 0.102 ms
2-norm of RHS = 775.7453170106567, which took 0.107 ms

iter_count = 282, r_2norm = 7.202e-04, tol*||rhs|| = 7.757e-04

Anderson update took 150.843 ms, out of which F'*F took 70.145 ms; b-Ax took 479.981 ms, out of which Lap took 427.974 ms
Solving Poisson took 1012.080 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.212814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.210906 
Total time for convolution: 	 convolve: 5.199960 
Total time for convolution: 	 convolve: 5.184005 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.800 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.627 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.913 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.574 ms

This SCF took 27931.853 ms, scf error = 4.452e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.167588, lowerbound = -1.031623, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.898 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.953 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.067 ms
rank =  0, finding HY took 26.343 ms
rank =  0, distributing HY into block cyclic form took 20.037 ms
rank =  0, finding Y'*HY took 4.844 ms
Rank 0, Project_Hamiltonian used 74.323 ms
Total time for projection: 74.344 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.236 ms
    first calculated eigval = -1.025047856918146
    last  calculated eigval = 0.063014707411807
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47344668187304
lambda[   7] =  -0.45779132184532
lambda[   8] =  -0.43820486303125
lambda[   9] =  -0.40604307080728
lambda[  10] =  -0.39776305720682
lambda[  11] =  -0.35832481006758
lambda[  12] =  -0.34150946542699
lambda[  13] =  -0.29015953724498
lambda[  14] =  -0.24985796703445
lambda[  15] =  -0.22609570855990
lambda[  16] =  -0.04134973483843
lambda[  17] =  -0.03323886544289
lambda[  18] =  -0.00147989332371
lambda[  19] =   0.01521958392519
lambda[  20] =   0.02200625228856
lambda[  21] =   0.02402049737221
lambda[  22] =   0.04875608800248
lambda[  23] =   0.06301470741181
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 9.306 ms
rank =  0, Distributing orbital back into band + domain format took 19.685 ms
rank = 0, Subspace_Rotation used 29.009 ms

Total time for subspace rotation: 29.014 ms
rank = 0, Efermi =  -0.070104629191 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.611 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.712 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.651 ms
rank = 0, Calculating density took 1690.616 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.993 ms
rank = 0, D2D took 2.088 ms
rank = 0, Transfering density took 2.092 ms
Etot    =   -58.488903951016
Eband   =   -15.314796139849
E1      =    32.705948089256
E2      =   -14.518918410477
E3      =   -19.625758451207
Exc     =   -17.453482433589
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 8.568e-04, dEband = 4.179e-02
rank = 0, Calculating/Estimating energy took 1.831 ms, Etot = -58.488903951, dEtot = 8.568e-04, dEband = 4.179e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0317412756463, which took 0.069 ms

iter_count = 108, r_2norm = 9.135e-05, tol*||rhs|| = 1.213e-04

Anderson update took 57.392 ms, out of which F'*F took 26.836 ms; b-Ax took 182.869 ms, out of which Lap took 163.684 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.244 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151153, int_b + int_rho = 4.366e-13, checking this took 0.100 ms
2-norm of RHS = 776.1216801116867, which took 0.092 ms

iter_count = 264, r_2norm = 6.842e-04, tol*||rhs|| = 7.761e-04

Anderson update took 140.424 ms, out of which F'*F took 66.331 ms; b-Ax took 449.227 ms, out of which Lap took 401.928 ms
Solving Poisson took 946.355 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.202482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.191224 
Total time for convolution: 	 convolve: 5.189728 
Total time for convolution: 	 convolve: 5.194765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 0.743 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.553 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.604 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.193 ms

This SCF took 27923.994 ms, scf error = 1.356e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.163015, lowerbound = -1.025048, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 2080.223 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 163.636 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 209.030 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 372.695 ms
rank =  0, finding HY took 115.771 ms
rank =  0, distributing HY into block cyclic form took 39.815 ms
rank =  0, finding Y'*HY took 27.384 ms
Rank 0, Project_Hamiltonian used 555.706 ms
Total time for projection: 555.725 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.021870836368602
    last  calculated eigval = 0.059827589249697
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46659884517015
lambda[   7] =  -0.45224941779269
lambda[   8] =  -0.43273125753200
lambda[   9] =  -0.40177820393399
lambda[  10] =  -0.39147146468084
lambda[  11] =  -0.35356783006854
lambda[  12] =  -0.33483648933677
lambda[  13] =  -0.28647672381977
lambda[  14] =  -0.24321908642277
lambda[  15] =  -0.21930101255973
lambda[  16] =  -0.03756461628431
lambda[  17] =  -0.03369104435471
lambda[  18] =  -0.00294745493347
lambda[  19] =   0.01368268181392
lambda[  20] =   0.01802844916654
lambda[  21] =   0.02228796530712
lambda[  22] =   0.04324525767783
lambda[  23] =   0.05982758924970
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 9.243 ms
rank =  0, Distributing orbital back into band + domain format took 146.903 ms
rank = 0, Subspace_Rotation used 156.161 ms

Total time for subspace rotation: 156.166 ms
rank = 0, Efermi =  -0.066329312173 calculate fermi energy took 92.566 ms
rank = 0, --- Calculate rho: sum over local bands took 5.401 ms
rank = 0, --- Calculate rho: reduce over all band groups took 246.981 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.670 ms
rank = 0, Calculating density took 3138.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.505 ms
rank = 0, D2D took 23.070 ms
rank = 0, Transfering density took 23.080 ms
Etot    =   -58.487492917899
Eband   =   -15.151158139671
E1      =    32.614250860311
E2      =   -14.436391422586
E3      =   -19.673612166566
Exc     =   -17.489338899171
Esc     =   -92.571250327584
Entropy =    -0.000000000936
dE = 1.411e-04, dEband = 1.636e-02
rank = 0, Calculating/Estimating energy took 25.779 ms, Etot = -58.487492918, dEtot = 1.411e-04, dEband = 1.636e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7465568218654, which took 2.037 ms

iter_count = 108, r_2norm = 5.258e-05, tol*||rhs|| = 6.986e-05

Anderson update took 193.179 ms, out of which F'*F took 81.130 ms; b-Ax took 354.697 ms, out of which Lap took 336.294 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 767.726 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151146, int_b + int_rho = 3.747e-13, checking this took 0.106 ms
2-norm of RHS = 776.5255478805124, which took 0.102 ms

iter_count = 246, r_2norm = 6.354e-04, tol*||rhs|| = 7.765e-04

Anderson update took 132.485 ms, out of which F'*F took 61.533 ms; b-Ax took 415.557 ms, out of which Lap took 373.703 ms
Solving Poisson took 884.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.192730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.178506 
Total time for convolution: 	 convolve: 5.215627 
Total time for convolution: 	 convolve: 5.184061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 3.562 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.110 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.709 ms

This SCF took 29614.733 ms, scf error = 6.448e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.159828, lowerbound = -1.021871, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1561.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.504 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.044 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.564 ms
rank =  0, finding HY took 26.240 ms
rank =  0, distributing HY into block cyclic form took 19.826 ms
rank =  0, finding Y'*HY took 4.848 ms
Rank 0, Project_Hamiltonian used 73.508 ms
Total time for projection: 73.519 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -1.021181676729191
    last  calculated eigval = 0.056586344926669
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46498353364991
lambda[   7] =  -0.45122018258302
lambda[   8] =  -0.43201222821707
lambda[   9] =  -0.40070360773127
lambda[  10] =  -0.39027233121193
lambda[  11] =  -0.35295296822292
lambda[  12] =  -0.33361742862794
lambda[  13] =  -0.28591303655531
lambda[  14] =  -0.24249106177008
lambda[  15] =  -0.21768606934351
lambda[  16] =  -0.03665652743808
lambda[  17] =  -0.03387787156479
lambda[  18] =  -0.00379473154532
lambda[  19] =   0.01297510163390
lambda[  20] =   0.01580438794483
lambda[  21] =   0.02136709996762
lambda[  22] =   0.03950981037151
lambda[  23] =   0.05658634492667
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 9.286 ms
rank =  0, Distributing orbital back into band + domain format took 19.492 ms
rank = 0, Subspace_Rotation used 29.191 ms

Total time for subspace rotation: 29.197 ms
rank = 0, Efermi =  -0.065448050355 calculate fermi energy took 0.636 ms
rank = 0, --- Calculate rho: sum over local bands took 5.572 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.286 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1681.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.909 ms
rank = 0, Transfering density took 1.910 ms
Etot    =   -58.487229314453
Eband   =   -15.120626871902
E1      =    32.614729758847
E2      =   -14.404100757112
E3      =   -19.675204995161
Exc     =   -17.489387625149
Esc     =   -92.571250327584
Entropy =    -0.000000000939
dE = 2.636e-05, dEband = 3.053e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -58.487229314, dEtot = 2.636e-05, dEband = 3.053e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6618381211175, which took 0.100 ms

iter_count = 114, r_2norm = 1.616e-05, tol*||rhs|| = 2.647e-05

Anderson update took 60.432 ms, out of which F'*F took 28.555 ms; b-Ax took 193.630 ms, out of which Lap took 173.101 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.200 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151152, int_b + int_rho = 4.256e-13, checking this took 0.112 ms
2-norm of RHS = 776.6966423460008, which took 0.107 ms

iter_count = 246, r_2norm = 6.437e-04, tol*||rhs|| = 7.767e-04

Anderson update took 131.302 ms, out of which F'*F took 62.455 ms; b-Ax took 421.695 ms, out of which Lap took 377.348 ms
Solving Poisson took 885.091 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.180279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.570 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.269475 
Total time for convolution: 	 convolve: 5.209185 
Total time for convolution: 	 convolve: 5.207544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.021 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.156 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.080 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.591 ms

This SCF took 27883.842 ms, scf error = 3.597e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.156586, lowerbound = -1.021182, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.380 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.483 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.616 ms
rank =  0, finding HY took 26.192 ms
rank =  0, distributing HY into block cyclic form took 19.935 ms
rank =  0, finding Y'*HY took 4.846 ms
Rank 0, Project_Hamiltonian used 73.616 ms
Total time for projection: 73.627 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.019720523141310
    last  calculated eigval = 0.053198437073975
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46134499512963
lambda[   7] =  -0.44863054043317
lambda[   8] =  -0.42995521867361
lambda[   9] =  -0.39847491919532
lambda[  10] =  -0.38663208166509
lambda[  11] =  -0.35098432171121
lambda[  12] =  -0.33062871664757
lambda[  13] =  -0.28439371429868
lambda[  14] =  -0.24015525388589
lambda[  15] =  -0.21329328565577
lambda[  16] =  -0.03506172872100
lambda[  17] =  -0.03351150235141
lambda[  18] =  -0.00375378212962
lambda[  19] =   0.01317648439593
lambda[  20] =   0.01525345069569
lambda[  21] =   0.02112373129483
lambda[  22] =   0.03757216077262
lambda[  23] =   0.05319843707398
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.277 ms
rank =  0, subspace rotation using ScaLAPACK took 9.917 ms
rank =  0, Distributing orbital back into band + domain format took 19.711 ms
rank = 0, Subspace_Rotation used 29.650 ms

Total time for subspace rotation: 29.658 ms
rank = 0, Efermi =  -0.063961888258 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.674 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1687.921 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.947 ms
Etot    =   -58.486939604144
Eband   =   -15.040443147645
E1      =    32.575136122244
E2      =   -14.359761056043
E3      =   -19.689323455240
Exc     =   -17.499466761496
Esc     =   -92.571250327584
Entropy =    -0.000000000946
dE = 2.897e-05, dEband = 8.018e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -58.486939604, dEtot = 2.897e-05, dEband = 8.018e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3988528997332, which took 0.053 ms

iter_count = 114, r_2norm = 9.700e-06, tol*||rhs|| = 1.595e-05

Anderson update took 61.075 ms, out of which F'*F took 28.712 ms; b-Ax took 193.512 ms, out of which Lap took 173.582 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.205 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151150, int_b + int_rho = 4.147e-13, checking this took 0.099 ms
2-norm of RHS = 776.7980510112076, which took 0.117 ms

iter_count = 240, r_2norm = 6.640e-04, tol*||rhs|| = 7.768e-04

Anderson update took 130.318 ms, out of which F'*F took 60.627 ms; b-Ax took 406.801 ms, out of which Lap took 364.424 ms
Solving Poisson took 862.307 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.194667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.213550 
Total time for convolution: 	 convolve: 5.197474 
Total time for convolution: 	 convolve: 5.211577 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.686 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.102 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.629 ms

This SCF took 27787.622 ms, scf error = 2.108e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.153198, lowerbound = -1.019721, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.003 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.496 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.046 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.557 ms
rank =  0, finding HY took 26.243 ms
rank =  0, distributing HY into block cyclic form took 19.962 ms
rank =  0, finding Y'*HY took 4.793 ms
Rank 0, Project_Hamiltonian used 73.586 ms
Total time for projection: 73.597 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -1.018677166785169
    last  calculated eigval = 0.049877142137686
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45846051029949
lambda[   7] =  -0.44635327990961
lambda[   8] =  -0.42840491486490
lambda[   9] =  -0.39668689387784
lambda[  10] =  -0.38374660149510
lambda[  11] =  -0.34948869858254
lambda[  12] =  -0.32816714265965
lambda[  13] =  -0.28339360007715
lambda[  14] =  -0.23829854750097
lambda[  15] =  -0.20990018874631
lambda[  16] =  -0.03345038876583
lambda[  17] =  -0.03275945878528
lambda[  18] =  -0.00305360632215
lambda[  19] =   0.01433538428188
lambda[  20] =   0.01619763765098
lambda[  21] =   0.02165687862531
lambda[  22] =   0.03709599740318
lambda[  23] =   0.04987714213769
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.281 ms
rank =  0, subspace rotation using ScaLAPACK took 9.343 ms
rank =  0, Distributing orbital back into band + domain format took 20.152 ms
rank = 0, Subspace_Rotation used 29.516 ms

Total time for subspace rotation: 29.521 ms
rank = 0, Efermi =  -0.062548495308 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.739 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.415 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.623 ms
rank = 0, Calculating density took 1686.554 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.961 ms
rank = 0, Transfering density took 1.967 ms
Etot    =   -58.486940815124
Eband   =   -14.977441118429
E1      =    32.545635171005
E2      =   -14.324263380038
E3      =   -19.695709035791
Exc     =   -17.503856954993
Esc     =   -92.571250327584
Entropy =    -0.000000000951
dE = 1.211e-07, dEband = 6.300e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -58.486940815, dEtot = 1.211e-07, dEband = 6.300e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2221159556327, which took 0.054 ms

iter_count = 114, r_2norm = 6.027e-06, tol*||rhs|| = 8.885e-06

Anderson update took 60.350 ms, out of which F'*F took 28.261 ms; b-Ax took 193.982 ms, out of which Lap took 172.515 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.365 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151161, int_b + int_rho = 5.275e-13, checking this took 0.107 ms
2-norm of RHS = 776.7867438321914, which took 0.108 ms

iter_count = 222, r_2norm = 7.316e-04, tol*||rhs|| = 7.768e-04

Anderson update took 120.531 ms, out of which F'*F took 55.707 ms; b-Ax took 374.085 ms, out of which Lap took 335.314 ms
Solving Poisson took 796.750 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.187993 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.221853 
Total time for convolution: 	 convolve: 5.216112 
Total time for convolution: 	 convolve: 5.205411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.151 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.086 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.619 ms

This SCF took 27735.381 ms, scf error = 1.177e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.149877, lowerbound = -1.018677, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.236 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.581 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.118 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.717 ms
rank =  0, finding HY took 26.092 ms
rank =  0, distributing HY into block cyclic form took 19.984 ms
rank =  0, finding Y'*HY took 4.912 ms
Rank 0, Project_Hamiltonian used 74.603 ms
Total time for projection: 74.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.017644647966644
    last  calculated eigval = 0.046282295066597
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45671346118273
lambda[   7] =  -0.44481515986201
lambda[   8] =  -0.42715548073582
lambda[   9] =  -0.39540114544324
lambda[  10] =  -0.38203252814780
lambda[  11] =  -0.34823998375497
lambda[  12] =  -0.32648794025349
lambda[  13] =  -0.28239557825794
lambda[  14] =  -0.23692561491351
lambda[  15] =  -0.20804433755329
lambda[  16] =  -0.03218953059367
lambda[  17] =  -0.03156523375199
lambda[  18] =  -0.00161943175957
lambda[  19] =   0.01647316063501
lambda[  20] =   0.01770346870149
lambda[  21] =   0.02271448761586
lambda[  22] =   0.03726772834589
lambda[  23] =   0.04628229506660
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 9.273 ms
rank =  0, Distributing orbital back into band + domain format took 19.549 ms
rank = 0, Subspace_Rotation used 28.836 ms

Total time for subspace rotation: 28.841 ms
rank = 0, Efermi =  -0.061309501589 calculate fermi energy took 0.101 ms
rank = 0, --- Calculate rho: sum over local bands took 5.711 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.607 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1687.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.855 ms
rank = 0, D2D took 1.957 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -58.487018306058
Eband   =   -14.934207668942
E1      =    32.522995853762
E2      =   -14.302463911184
E3      =   -19.700224075059
Exc     =   -17.507244148585
Esc     =   -92.571250327584
Entropy =    -0.000000000952
dE = 7.749e-06, dEband = 4.323e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -58.487018306, dEtot = 7.749e-06, dEband = 4.323e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1729469029990, which took 0.053 ms

iter_count = 108, r_2norm = 6.090e-06, tol*||rhs|| = 6.918e-06

Anderson update took 57.253 ms, out of which F'*F took 27.863 ms; b-Ax took 184.587 ms, out of which Lap took 165.055 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.303 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151142, int_b + int_rho = 3.311e-13, checking this took 0.103 ms
2-norm of RHS = 776.7616022237110, which took 0.098 ms

iter_count = 210, r_2norm = 6.684e-04, tol*||rhs|| = 7.768e-04

Anderson update took 112.967 ms, out of which F'*F took 52.846 ms; b-Ax took 354.028 ms, out of which Lap took 317.469 ms
Solving Poisson took 752.352 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.216681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.687 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.199749 
Total time for convolution: 	 convolve: 5.213299 
Total time for convolution: 	 convolve: 5.228922 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.527 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.111 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.676 ms

This SCF took 27711.049 ms, scf error = 7.259e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.146282, lowerbound = -1.017645, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1563.952 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.388 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.190 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.595 ms
rank =  0, finding HY took 26.229 ms
rank =  0, distributing HY into block cyclic form took 19.826 ms
rank =  0, finding Y'*HY took 4.815 ms
Rank 0, Project_Hamiltonian used 73.993 ms
Total time for projection: 74.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -1.017047751228883
    last  calculated eigval = 0.042641106598540
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45581960228925
lambda[   7] =  -0.44409593086729
lambda[   8] =  -0.42653677599186
lambda[   9] =  -0.39467610105731
lambda[  10] =  -0.38116778133409
lambda[  11] =  -0.34762928269297
lambda[  12] =  -0.32567616866881
lambda[  13] =  -0.28181745052250
lambda[  14] =  -0.23626292730854
lambda[  15] =  -0.20707309528574
lambda[  16] =  -0.03149006629811
lambda[  17] =  -0.02983130099291
lambda[  18] =   0.00056960551539
lambda[  19] =   0.01930450310594
lambda[  20] =   0.01952980957657
lambda[  21] =   0.02435818931441
lambda[  22] =   0.03771430235740
lambda[  23] =   0.04264110659854
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.262 ms
rank =  0, subspace rotation using ScaLAPACK took 9.286 ms
rank =  0, Distributing orbital back into band + domain format took 19.632 ms
rank = 0, Subspace_Rotation used 28.934 ms

Total time for subspace rotation: 28.939 ms
rank = 0, Efermi =  -0.060374341209 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.637 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.728 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1684.609 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.858 ms
rank = 0, D2D took 1.961 ms
rank = 0, Transfering density took 1.963 ms
Etot    =   -58.487118178312
Eband   =   -14.912065272629
E1      =    32.512204714428
E2      =   -14.291045925397
E3      =   -19.700332809641
Exc     =   -17.507386026621
Esc     =   -92.571250327584
Entropy =    -0.000000000945
dE = 9.987e-06, dEband = 2.214e-03
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -58.487118178, dEtot = 9.987e-06, dEband = 2.214e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0892094236928, which took 0.051 ms

iter_count = 114, r_2norm = 2.436e-06, tol*||rhs|| = 3.568e-06

Anderson update took 60.653 ms, out of which F'*F took 28.463 ms; b-Ax took 192.841 ms, out of which Lap took 172.230 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.610 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151158, int_b + int_rho = 4.948e-13, checking this took 0.103 ms
2-norm of RHS = 776.7731242627873, which took 0.086 ms

iter_count = 198, r_2norm = 6.494e-04, tol*||rhs|| = 7.768e-04

Anderson update took 106.252 ms, out of which F'*F took 49.448 ms; b-Ax took 333.097 ms, out of which Lap took 298.328 ms
Solving Poisson took 709.687 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.196009 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.203918 
Total time for convolution: 	 convolve: 5.187266 
Total time for convolution: 	 convolve: 5.181670 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.482 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.820 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.689 ms

This SCF took 27580.975 ms, scf error = 4.717e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.142641, lowerbound = -1.017048, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.210 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.483 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.033 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.533 ms
rank =  0, finding HY took 26.218 ms
rank =  0, distributing HY into block cyclic form took 19.831 ms
rank =  0, finding Y'*HY took 4.887 ms
Rank 0, Project_Hamiltonian used 73.498 ms
Total time for projection: 73.509 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.016592587984824
    last  calculated eigval = 0.040362118745214
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45502566821257
lambda[   7] =  -0.44346042700400
lambda[   8] =  -0.42602978013626
lambda[   9] =  -0.39408848935386
lambda[  10] =  -0.38041538229243
lambda[  11] =  -0.34712535141039
lambda[  12] =  -0.32492144018907
lambda[  13] =  -0.28137800116572
lambda[  14] =  -0.23569358369449
lambda[  15] =  -0.20627786506378
lambda[  16] =  -0.03091641149819
lambda[  17] =  -0.02797035779145
lambda[  18] =   0.00285897168764
lambda[  19] =   0.02073019691678
lambda[  20] =   0.02210593639170
lambda[  21] =   0.02573311524104
lambda[  22] =   0.03733154209178
lambda[  23] =   0.04036211874521
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 9.384 ms
rank =  0, Distributing orbital back into band + domain format took 19.527 ms
rank = 0, Subspace_Rotation used 28.927 ms

Total time for subspace rotation: 28.932 ms
rank = 0, Efermi =  -0.059701384536 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.670 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.806 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1685.073 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.930 ms
Etot    =   -58.487185603092
Eband   =   -14.893309328672
E1      =    32.503062857562
E2      =   -14.281067285216
E3      =   -19.701747513413
Exc     =   -17.508503602089
Esc     =   -92.571250327584
Entropy =    -0.000000000938
dE = 6.742e-06, dEband = 1.876e-03
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -58.487185603, dEtot = 6.742e-06, dEband = 1.876e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0748829082889, which took 0.055 ms

iter_count = 114, r_2norm = 1.939e-06, tol*||rhs|| = 2.995e-06

Anderson update took 60.499 ms, out of which F'*F took 28.281 ms; b-Ax took 193.891 ms, out of which Lap took 173.192 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.076 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151145, int_b + int_rho = 3.638e-13, checking this took 0.076 ms
2-norm of RHS = 776.7759575233762, which took 0.104 ms

iter_count = 162, r_2norm = 6.524e-04, tol*||rhs|| = 7.768e-04

Anderson update took 101.065 ms, out of which F'*F took 41.296 ms; b-Ax took 285.004 ms, out of which Lap took 256.340 ms
Solving Poisson took 611.259 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.186433 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.952 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.211393 
Total time for convolution: 	 convolve: 5.213977 
Total time for convolution: 	 convolve: 5.192250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.108 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.045 ms

This SCF took 27519.882 ms, scf error = 3.027e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.140362, lowerbound = -1.016593, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1567.647 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.417 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.120 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.555 ms
rank =  0, finding HY took 26.108 ms
rank =  0, distributing HY into block cyclic form took 19.996 ms
rank =  0, finding Y'*HY took 4.793 ms
Rank 0, Project_Hamiltonian used 73.483 ms
Total time for projection: 73.494 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -1.016356876747773
    last  calculated eigval = 0.039455631887551
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45470856886717
lambda[   7] =  -0.44317728584789
lambda[   8] =  -0.42579635197115
lambda[   9] =  -0.39382944944265
lambda[  10] =  -0.38009854620780
lambda[  11] =  -0.34688845444233
lambda[  12] =  -0.32461584472146
lambda[  13] =  -0.28115357844835
lambda[  14] =  -0.23544399369489
lambda[  15] =  -0.20597290677499
lambda[  16] =  -0.03067428736478
lambda[  17] =  -0.02723830284792
lambda[  18] =   0.00377289381340
lambda[  19] =   0.02077800042212
lambda[  20] =   0.02293283455997
lambda[  21] =   0.02607686833926
lambda[  22] =   0.03546827302216
lambda[  23] =   0.03945563188755
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 9.264 ms
rank =  0, Distributing orbital back into band + domain format took 19.534 ms
rank = 0, Subspace_Rotation used 28.814 ms

Total time for subspace rotation: 28.818 ms
rank = 0, Efermi =  -0.059445915745 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.695 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.682 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1687.294 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.838 ms
rank = 0, D2D took 1.933 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -58.487227081362
Eband   =   -14.885089278850
E1      =    32.498799863119
E2      =   -14.276948762835
E3      =   -19.702374754010
Exc     =   -17.509010853956
Esc     =   -92.571250327584
Entropy =    -0.000000000936
dE = 4.148e-06, dEband = 8.220e-04
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -58.487227081, dEtot = 4.148e-06, dEband = 8.220e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0438677160475, which took 0.053 ms

iter_count = 108, r_2norm = 1.744e-06, tol*||rhs|| = 1.755e-06

Anderson update took 57.315 ms, out of which F'*F took 26.909 ms; b-Ax took 182.572 ms, out of which Lap took 162.983 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.933 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151154, int_b + int_rho = 4.475e-13, checking this took 0.122 ms
2-norm of RHS = 776.7897891716967, which took 0.117 ms

iter_count = 174, r_2norm = 7.278e-04, tol*||rhs|| = 7.768e-04

Anderson update took 93.715 ms, out of which F'*F took 43.461 ms; b-Ax took 294.202 ms, out of which Lap took 263.384 ms
Solving Poisson took 624.739 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.209942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.190155 
Total time for convolution: 	 convolve: 5.205654 
Total time for convolution: 	 convolve: 5.189505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.538 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.087 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.617 ms

This SCF took 27512.430 ms, scf error = 2.470e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.139456, lowerbound = -1.016357, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1563.557 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.397 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.236 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.651 ms
rank =  0, finding HY took 26.213 ms
rank =  0, distributing HY into block cyclic form took 19.861 ms
rank =  0, finding Y'*HY took 4.903 ms
Rank 0, Project_Hamiltonian used 73.658 ms
Total time for projection: 73.670 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.015899338815385
    last  calculated eigval = 0.039651983800659
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45419740997182
lambda[   7] =  -0.44268397280122
lambda[   8] =  -0.42536499855685
lambda[   9] =  -0.39336516091653
lambda[  10] =  -0.37959484694515
lambda[  11] =  -0.34645423398603
lambda[  12] =  -0.32411082055066
lambda[  13] =  -0.28071663136026
lambda[  14] =  -0.23499447526187
lambda[  15] =  -0.20551218784600
lambda[  16] =  -0.03020914718824
lambda[  17] =  -0.02524987031190
lambda[  18] =   0.00580137146638
lambda[  19] =   0.02173140911057
lambda[  20] =   0.02476960483995
lambda[  21] =   0.02687916947832
lambda[  22] =   0.03560682331723
lambda[  23] =   0.03965198380066
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 9.277 ms
rank =  0, Distributing orbital back into band + domain format took 19.649 ms
rank = 0, Subspace_Rotation used 28.942 ms

Total time for subspace rotation: 28.948 ms
rank = 0, Efermi =  -0.058966530208 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.691 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1683.597 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.827 ms
rank = 0, D2D took 2.931 ms
rank = 0, Transfering density took 2.934 ms
Etot    =   -58.487293570276
Eband   =   -14.870893933453
E1      =    32.491921844197
E2      =   -14.269425341349
E3      =   -19.703117971545
Exc     =   -17.509614465395
Esc     =   -92.571250327584
Entropy =    -0.000000000935
dE = 6.649e-06, dEband = 1.420e-03
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -58.487293570, dEtot = 6.649e-06, dEband = 1.420e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0387978848062, which took 0.093 ms

iter_count = 114, r_2norm = 1.000e-06, tol*||rhs|| = 1.552e-06

Anderson update took 60.362 ms, out of which F'*F took 28.231 ms; b-Ax took 192.482 ms, out of which Lap took 171.780 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.229 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151153, int_b + int_rho = 4.366e-13, checking this took 0.110 ms
2-norm of RHS = 776.7913744351696, which took 0.103 ms

iter_count = 132, r_2norm = 7.430e-04, tol*||rhs|| = 7.768e-04

Anderson update took 70.987 ms, out of which F'*F took 32.934 ms; b-Ax took 222.519 ms, out of which Lap took 199.144 ms
Solving Poisson took 473.643 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.206876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.195159 
Total time for convolution: 	 convolve: 5.190213 
Total time for convolution: 	 convolve: 5.203737 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
---Transfer Veff_loc: D2D took 3.589 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.176 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.802 ms

This SCF took 27365.731 ms, scf error = 1.548e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.139652, lowerbound = -1.015899, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.653 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.572 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.982 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.591 ms
rank =  0, finding HY took 26.199 ms
rank =  0, distributing HY into block cyclic form took 19.802 ms
rank =  0, finding Y'*HY took 5.004 ms
Rank 0, Project_Hamiltonian used 73.622 ms
Total time for projection: 73.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -1.015755876183219
    last  calculated eigval = 0.039700487210094
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45404928841909
lambda[   7] =  -0.44253603322531
lambda[   8] =  -0.42522284026272
lambda[   9] =  -0.39322147534654
lambda[  10] =  -0.37944609728487
lambda[  11] =  -0.34631392340414
lambda[  12] =  -0.32396740248750
lambda[  13] =  -0.28057663180451
lambda[  14] =  -0.23484679971373
lambda[  15] =  -0.20536013646480
lambda[  16] =  -0.03007067757928
lambda[  17] =  -0.02485021880487
lambda[  18] =   0.00607421724024
lambda[  19] =   0.02177229401357
lambda[  20] =   0.02504678964225
lambda[  21] =   0.02688229668948
lambda[  22] =   0.03527998677993
lambda[  23] =   0.03970048721009
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 9.289 ms
rank =  0, Distributing orbital back into band + domain format took 19.618 ms
rank = 0, Subspace_Rotation used 28.921 ms

Total time for subspace rotation: 28.925 ms
rank = 0, Efermi =  -0.058827342912 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.657 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.289 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1685.601 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.926 ms
Etot    =   -58.487314272718
Eband   =   -14.866512480055
E1      =    32.489675501143
E2      =   -14.267198580713
E3      =   -19.703444034981
Exc     =   -17.509869580982
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 2.070e-06, dEband = 4.381e-04
rank = 0, Calculating/Estimating energy took 0.936 ms, Etot = -58.487314273, dEtot = 2.070e-06, dEband = 4.381e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0287107294586, which took 0.104 ms

iter_count = 108, r_2norm = 1.035e-06, tol*||rhs|| = 1.148e-06

Anderson update took 57.374 ms, out of which F'*F took 26.911 ms; b-Ax took 182.724 ms, out of which Lap took 163.208 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.968 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151149, int_b + int_rho = 4.002e-13, checking this took 0.108 ms
2-norm of RHS = 776.7964921428198, which took 0.097 ms

iter_count = 150, r_2norm = 7.474e-04, tol*||rhs|| = 7.768e-04

Anderson update took 81.029 ms, out of which F'*F took 37.385 ms; b-Ax took 252.706 ms, out of which Lap took 226.321 ms
Solving Poisson took 538.744 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.201251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.201607 
Total time for convolution: 	 convolve: 5.181648 
Total time for convolution: 	 convolve: 5.211764 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.730 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.095 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.635 ms

This SCF took 27425.245 ms, scf error = 1.254e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139700, lowerbound = -1.015756, upperbound = 267.579907

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.066 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.505 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.032 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.559 ms
rank =  0, finding HY took 26.235 ms
rank =  0, distributing HY into block cyclic form took 19.910 ms
rank =  0, finding Y'*HY took 4.887 ms
Rank 0, Project_Hamiltonian used 73.617 ms
Total time for projection: 73.629 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.015503313648857
    last  calculated eigval = 0.040059772010384
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45380625638706
lambda[   7] =  -0.44228627415538
lambda[   8] =  -0.42497194019391
lambda[   9] =  -0.39297263274869
lambda[  10] =  -0.37920808773756
lambda[  11] =  -0.34606813243343
lambda[  12] =  -0.32372627431408
lambda[  13] =  -0.28033106032998
lambda[  14] =  -0.23459408203613
lambda[  15] =  -0.20511675932355
lambda[  16] =  -0.02983415522054
lambda[  17] =  -0.02448182790491
lambda[  18] =   0.00598458051881
lambda[  19] =   0.02169680457350
lambda[  20] =   0.02505873679654
lambda[  21] =   0.02730899799661
lambda[  22] =   0.03589601055173
lambda[  23] =   0.04005977201038
==subpsace eigenproblem: bcast eigvals took 0.090 ms
Total time for solving subspace eigenvalue problem: 0.318 ms
rank =  0, subspace rotation using ScaLAPACK took 9.231 ms
rank =  0, Distributing orbital back into band + domain format took 19.700 ms
rank = 0, Subspace_Rotation used 28.948 ms

Total time for subspace rotation: 28.953 ms
rank = 0, Efermi =  -0.058590538217 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.597 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.034 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1691.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.921 ms
Etot    =   -58.487358275609
Eband   =   -14.859108741887
E1      =    32.486081825950
E2      =   -14.263247568931
E3      =   -19.703862487858
Exc     =   -17.510191087943
Esc     =   -92.571250327584
Entropy =    -0.000000000934
dE = 4.400e-06, dEband = 7.404e-04
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -58.487358276, dEtot = 4.400e-06, dEband = 7.404e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0192696093670, which took 0.063 ms

iter_count = 108, r_2norm = 7.467e-07, tol*||rhs|| = 7.708e-07

Anderson update took 61.879 ms, out of which F'*F took 33.602 ms; b-Ax took 209.512 ms, out of which Lap took 190.902 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 424.067 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003151109, int_rho =  30.00000003151163, int_b + int_rho = 5.384e-13, checking this took 0.132 ms
2-norm of RHS = 776.7973264184786, which took 0.303 ms

iter_count = 126, r_2norm = 7.728e-04, tol*||rhs|| = 7.768e-04

Anderson update took 70.605 ms, out of which F'*F took 32.007 ms; b-Ax took 212.249 ms, out of which Lap took 191.386 ms
Solving Poisson took 456.016 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.201376 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.189802 
Total time for convolution: 	 convolve: 5.214053 
Total time for convolution: 	 convolve: 6.448502 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.310 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.111 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.636 ms

This SCF took 28663.558 ms, scf error = 8.181e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.45380625638706, occ[   6] =   2.00000000000000
lambda[   7] =  -0.44228627415538, occ[   7] =   2.00000000000000
lambda[   8] =  -0.42497194019391, occ[   8] =   2.00000000000000
lambda[   9] =  -0.39297263274869, occ[   9] =   2.00000000000000
lambda[  10] =  -0.37920808773756, occ[  10] =   2.00000000000000
lambda[  11] =  -0.34606813243343, occ[  11] =   2.00000000000000
lambda[  12] =  -0.32372627431408, occ[  12] =   2.00000000000000
lambda[  13] =  -0.28033106032998, occ[  13] =   2.00000000000000
lambda[  14] =  -0.23459408203613, occ[  14] =   2.00000000000000
lambda[  15] =  -0.20511675932355, occ[  15] =   2.00000000000000
lambda[  16] =  -0.02983415522054, occ[  16] =   0.00000003145878
lambda[  17] =  -0.02448182790491, occ[  17] =   0.00000000005274
lambda[  18] =   0.00598458051881, occ[  18] =   0.00000000000000
lambda[  19] =   0.02169680457350, occ[  19] =   0.00000000000000
lambda[  20] =   0.02505873679654, occ[  20] =   0.00000000000000
lambda[  21] =   0.02730899799661, occ[  21] =   0.00000000000000
lambda[  22] =   0.03589601055173, occ[  22] =   0.00000000000000
lambda[  23] =   0.04005977201038, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.477 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.716 ms, time for Allreduce/Reduce: 12.510 ms 
Time for calculating local force components: 24.407 ms
Start Calculating nonlocal forces
force_nloc = 
 -1.18905791981707  -0.24608415530789  -0.00000010792016
  1.02688594431720   0.16897192491799   0.00000036070062
 -0.03177648299217  -0.06615921582370  -0.00000001045805
  0.03051075203628   0.00473216502266  -0.03933097723796
  0.03051077785716   0.00473215800892   0.03933100475227
 -0.03860070621447  -0.00500057970254  -0.05086301602171
 -0.03860065168550  -0.00500056563867   0.05086297679757
 -0.01261053516784   0.19207071634435  -0.00000016333076
  0.07181713578073  -0.02102419975637   0.00000023339035
  0.29106512758781   0.64796683201156   0.00000277345796
force_loc = 
  1.17330977794982   0.24425364278613   0.00000050356680
 -1.00525148635462  -0.15926491898199   0.00000192587132
  0.03255623292334   0.06947094122983   0.00000001380225
 -0.03144724699302  -0.00509897124372   0.04028075203685
 -0.03144711262083  -0.00509899555990  -0.04028144683285
  0.03929945206926   0.00356254985099   0.05259906608577
  0.03929836669488   0.00356225984187  -0.05259801045366
 -0.00319481884003  -0.19300108575324   0.00000001492973
 -0.06913445383073   0.01921343649519  -0.00000031616693
 -0.28359795230656  -0.63056613207776  -0.00000289994454
Time for calculating nonlocal force components: 42.040 ms
[32mforces_xc: 
[0m[32m  0.02782711008565   0.00528209060353   0.00000001075309
[0m[32m -0.02861242500721  -0.00592743394630   0.00000008795274
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01095388575472  -0.00522084963539   0.00000002430583
[0m[32m -0.00435135233673   0.00138429162646  -0.00000001048458
[0m[32m -0.00612272196470  -0.01816672443068  -0.00000008426749
[0mTime for calculating XC forces components: 34.866 ms
 Cartesian force = 
  0.01205609852587   0.00349265999364   0.00000013587128
 -0.00700083673716   0.00382065390157   0.00000210399624
  0.00075688023863   0.00335280731799  -0.00000026718424
 -0.00095936464927  -0.00032572430919   0.00094950427045
 -0.00095920445621  -0.00032575563911  -0.00095071260902
  0.00067587616225  -0.00139694793969   0.00173577953561
  0.00067484531684  -0.00139722388493  -0.00173530418454
 -0.00487433794568  -0.00611013713241  -0.00000039462365
 -0.00169154007927  -0.00038538972285  -0.00000036378960
  0.00132158362401  -0.00072494258502  -0.00000048128251
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 387.231 ms
The program took 451.951 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:22
Job ID:        2266469
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:00,vmem=8260K,walltime=00:07:45,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-14-2
---------------------------------------
