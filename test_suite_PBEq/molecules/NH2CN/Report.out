---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:38
Job ID:    2266443
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:44
Job ID:    2266443
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.058 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 7.093 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 15.588 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 91.523 ms

Freeing SPARC_INPUT_MPI datatype took 0.007 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.957 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.095 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.636304	    7.161212	
   10.000000	    8.363696	    7.161212	
   10.000000	   10.000000	   10.632712	
   10.000000	   10.000000	   12.838788	
   10.000000	   10.000000	    8.109715	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.161 ms
Set up communicators.

--set up spincomm took 2.288 ms

--set up kptcomm took 0.353 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.089 ms

Calculate_SplineDerivRadFun took 0.215 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.264 ms.
time spent on vectorized spline interp: 2.232 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.983 ms.
time spent on vectorized spline interp: 1.695 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.507 ms.
time spent on vectorized spline interp: 1.639 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.513 ms.

Calculating rb for all atom types took 14.841 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.891 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000073970, sum_int_rho = 15.7937280431340
PosCharge = 16.000000007397, NegCharge = -15.793728043134, scal_fac = 1.013060372048
After scaling, int_rho = 16.0000000073968, PosCharge + NegCharge - NetCharge = 1.705e-13
--Calculate Vref took 0.377 ms
--Calculate rho_guess took 2.024 ms

 integral of b = -16.0000000073970,
 int{b} + Nelectron + NetCharge = -7.397e-09,
 Esc = -46.3968625717311,
 MPI_Reduce took 3.507 ms

Calculating b & b_ref took 11.252 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.014 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.098 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.036 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.042 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739693, int_b + int_rho = -4.275e-13, checking this took 0.088 ms
2-norm of RHS = 554.5693900482233, which took 0.469 ms

iter_count = 420, r_2norm = 5.222e-04, tol*||rhs|| = 5.546e-04

Anderson update took 232.136 ms, out of which F'*F took 105.721 ms; b-Ax took 712.838 ms, out of which Lap took 640.577 ms
Solving Poisson took 1516.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.389 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
Total time for convolution: 	 convolve: 5.105708 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.120697 
Total time for convolution: 	 convolve: 5.106415 
Total time for convolution: 	 convolve: 5.094792 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.761 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, XC calculation took 24284.451 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.091 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.767 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.967 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.134 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.657 ms
    Lanczos iter 54, eigmin  = -0.990301111, eigmax = 264.926026075, err_eigmin = 1.634e-04, err_eigmax = 9.739e-03
rank =   0, Lanczos took 121.245 ms, eigmin = -0.990301110682, eigmax = 267.575286336098

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.242493, lowerbound = -1.090301, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.015 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.426 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.465 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.001 ms
rank =  0, Distribute data + matrix mult took 16.919 ms
rank =  0, finding HY took 18.800 ms
rank =  0, distributing HY into block cyclic form took 13.627 ms
rank =  0, finding Y'*HY took 2.099 ms
Rank 0, Project_Hamiltonian used 51.501 ms
Total time for projection: 51.512 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.512 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.596 ms
    first calculated eigval = 2.794361223760837
    last  calculated eigval = 3.189817411350905
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79436122376084
lambda[   2] =   2.83136239609099
lambda[   3] =   2.84754338450546
lambda[   4] =   2.90284126097000
lambda[   5] =   2.94967692525108
lambda[   6] =   2.97701429041213
lambda[   7] =   3.02094244279795
lambda[   8] =   3.05443034202102
lambda[   9] =   3.07167060552579
lambda[  10] =   3.08932358346812
lambda[  11] =   3.10862757619035
lambda[  12] =   3.13288337047450
lambda[  13] =   3.16106308171874
lambda[  14] =   3.18981741135091
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.609 ms
rank =  0, subspace rotation using ScaLAPACK took 3.216 ms
rank =  0, Distributing orbital back into band + domain format took 12.452 ms
rank = 0, Subspace_Rotation used 15.693 ms

Total time for subspace rotation: 15.696 ms
rank = 0, Efermi =   3.063050468331 calculate fermi energy took 0.072 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.289817, lowerbound = -1.090301, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1157.319 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.671 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.426 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.121 ms
rank =  0, finding HY took 17.951 ms
rank =  0, distributing HY into block cyclic form took 12.727 ms
rank =  0, finding Y'*HY took 2.125 ms
Rank 0, Project_Hamiltonian used 46.966 ms
Total time for projection: 46.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.811506753455482
    last  calculated eigval = 0.418016329997699
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.81150675345548
lambda[   2] =  -0.78602904693377
lambda[   3] =  -0.25421007085802
lambda[   4] =  -0.16143793891725
lambda[   5] =  -0.03224049408577
lambda[   6] =   0.13957559998825
lambda[   7] =   0.19583981429939
lambda[   8] =   0.24286891163906
lambda[   9] =   0.30146453355896
lambda[  10] =   0.33063015851604
lambda[  11] =   0.34533560352228
lambda[  12] =   0.38236041709747
lambda[  13] =   0.39117689017520
lambda[  14] =   0.41801632999770
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.250 ms
rank =  0, Distributing orbital back into band + domain format took 12.149 ms
rank = 0, Subspace_Rotation used 15.415 ms

Total time for subspace rotation: 15.419 ms
rank = 0, Efermi =   0.272357093043 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.518016, lowerbound = -1.090301, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1135.878 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.397 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.067 ms
rank =  0, finding HY took 17.976 ms
rank =  0, distributing HY into block cyclic form took 12.795 ms
rank =  0, finding Y'*HY took 2.156 ms
Rank 0, Project_Hamiltonian used 47.026 ms
Total time for projection: 47.939 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -0.991547651221785
    last  calculated eigval = 0.111126084830459
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.99154765122178
lambda[   2] =  -0.95134235566515
lambda[   3] =  -0.64624776874845
lambda[   4] =  -0.60621089619946
lambda[   5] =  -0.44077918459100
lambda[   6] =  -0.42046461678604
lambda[   7] =  -0.39100569890920
lambda[   8] =  -0.32174619756995
lambda[   9] =  -0.02857725414183
lambda[  10] =   0.03211976958487
lambda[  11] =   0.06396802389868
lambda[  12] =   0.09344050566579
lambda[  13] =   0.10160105068571
lambda[  14] =   0.11112608483046
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.273 ms
rank =  0, Distributing orbital back into band + domain format took 12.131 ms
rank = 0, Subspace_Rotation used 15.424 ms

Total time for subspace rotation: 15.428 ms
rank = 0, Efermi =  -0.058625333023 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.211126, lowerbound = -1.090301, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1157.225 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.406 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 14.197 ms
rank =  0, finding HY took 17.865 ms
rank =  0, distributing HY into block cyclic form took 12.787 ms
rank =  0, finding Y'*HY took 2.124 ms
Rank 0, Project_Hamiltonian used 47.012 ms
Total time for projection: 47.018 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.991855177633127
    last  calculated eigval = 0.069974023431161
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.99185517763313
lambda[   2] =  -0.95164031723688
lambda[   3] =  -0.65402564818791
lambda[   4] =  -0.60949195974246
lambda[   5] =  -0.45075445512371
lambda[   6] =  -0.44101301350400
lambda[   7] =  -0.40068659053831
lambda[   8] =  -0.34430087631346
lambda[   9] =  -0.08418458475353
lambda[  10] =  -0.03686271849707
lambda[  11] =   0.01862746101788
lambda[  12] =   0.03248068494171
lambda[  13] =   0.05337492457322
lambda[  14] =   0.06997402343116
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.223 ms
rank =  0, Distributing orbital back into band + domain format took 12.151 ms
rank = 0, Subspace_Rotation used 15.394 ms

Total time for subspace rotation: 15.398 ms
rank = 0, Efermi =  -0.114232663600 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 4.297 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.821 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 4954.887 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.840 ms
rank = 0, D2D took 0.945 ms
rank = 0, Transfering density took 0.953 ms
Etot    =   -28.028015568280
Eband   =    -9.687536077182
E1      =    19.182872105457
E2      =    -7.945460885473
E3      =    -9.467852668814
Exc     =    -8.539802578881
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 5.606e+00, dEband = 1.938e+00
rank = 0, Calculating/Estimating energy took 15.370 ms, Etot = -28.028015568, dEtot = 5.606e+00, dEband = 1.938e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 47.6277082824177, which took 6.522 ms

iter_count = 96, r_2norm = 1.476e-03, tol*||rhs|| = 1.905e-03

Anderson update took 51.281 ms, out of which F'*F took 23.945 ms; b-Ax took 163.475 ms, out of which Lap took 147.014 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.143 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739677, int_b + int_rho = -5.912e-13, checking this took 0.143 ms
2-norm of RHS = 550.4408943234918, which took 0.131 ms

iter_count = 288, r_2norm = 5.183e-04, tol*||rhs|| = 5.504e-04

Anderson update took 155.272 ms, out of which F'*F took 72.475 ms; b-Ax took 485.168 ms, out of which Lap took 437.632 ms
Solving Poisson took 1033.948 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.126765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.099342 
Total time for convolution: 	 convolve: 5.094636 
Total time for convolution: 	 convolve: 5.085277 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.292 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 30750.846 ms, scf error = 1.794e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.169974, lowerbound = -0.991855, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1093.936 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.698 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.137 ms
rank =  0, finding HY took 18.061 ms
rank =  0, distributing HY into block cyclic form took 12.846 ms
rank =  0, finding Y'*HY took 2.092 ms
Rank 0, Project_Hamiltonian used 47.165 ms
Total time for projection: 47.177 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.954903021089031
    last  calculated eigval = 0.044172211921754
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95490302108903
lambda[   2] =  -0.90371947745607
lambda[   3] =  -0.62388693374217
lambda[   4] =  -0.57913648283100
lambda[   5] =  -0.42156574084931
lambda[   6] =  -0.39283618755974
lambda[   7] =  -0.36761824946914
lambda[   8] =  -0.30282014991000
lambda[   9] =  -0.06805112961938
lambda[  10] =  -0.03764754930252
lambda[  11] =   0.00218617282628
lambda[  12] =   0.01677316749714
lambda[  13] =   0.03539111558081
lambda[  14] =   0.04417221192175
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.265 ms
rank =  0, Distributing orbital back into band + domain format took 12.094 ms
rank = 0, Subspace_Rotation used 15.371 ms

Total time for subspace rotation: 15.375 ms
rank = 0, Efermi =  -0.098099208307 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.637 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1159.639 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
rank = 0, D2D took 0.637 ms
rank = 0, Transfering density took 0.639 ms
Etot    =   -27.967363962745
Eband   =    -9.092972486316
E1      =    18.689387029162
E2      =    -7.874446658419
E3      =    -9.616803765802
Exc     =    -8.658166357853
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 1.213e-02, dEband = 1.189e-01
rank = 0, Calculating/Estimating energy took 1.574 ms, Etot = -27.967363963, dEtot = 1.213e-02, dEband = 1.189e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 22.0056931057008, which took 0.063 ms

iter_count = 102, r_2norm = 6.361e-04, tol*||rhs|| = 8.802e-04

Anderson update took 54.091 ms, out of which F'*F took 25.383 ms; b-Ax took 172.182 ms, out of which Lap took 153.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.418 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739684, int_b + int_rho = -5.257e-13, checking this took 0.107 ms
2-norm of RHS = 547.5254478102800, which took 0.139 ms

iter_count = 294, r_2norm = 4.958e-04, tol*||rhs|| = 5.475e-04

Anderson update took 154.749 ms, out of which F'*F took 73.258 ms; b-Ax took 500.624 ms, out of which Lap took 448.923 ms
Solving Poisson took 1052.433 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.081005 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.258 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.097156 
Total time for convolution: 	 convolve: 5.075063 
Total time for convolution: 	 convolve: 5.080136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 129.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.025 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.507 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 27127.831 ms, scf error = 1.110e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.144172, lowerbound = -0.954903, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1151.864 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.606 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.310 ms
rank =  0, finding HY took 19.247 ms
rank =  0, distributing HY into block cyclic form took 12.757 ms
rank =  0, finding Y'*HY took 2.132 ms
Rank 0, Project_Hamiltonian used 48.476 ms
Total time for projection: 48.489 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.914408147052313
    last  calculated eigval = 0.030870529964312
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.91440814705231
lambda[   2] =  -0.84968493072689
lambda[   3] =  -0.58722291979094
lambda[   4] =  -0.54593734293864
lambda[   5] =  -0.38739980260736
lambda[   6] =  -0.34903075548335
lambda[   7] =  -0.33273462298358
lambda[   8] =  -0.26289074050942
lambda[   9] =  -0.04265127898980
lambda[  10] =  -0.04195380405073
lambda[  11] =   0.01137557179036
lambda[  12] =   0.01310147385592
lambda[  13] =   0.02870237068732
lambda[  14] =   0.03087052996431
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.284 ms
rank =  0, Distributing orbital back into band + domain format took 12.237 ms
rank = 0, Subspace_Rotation used 15.874 ms

Total time for subspace rotation: 15.880 ms
rank = 0, Efermi =  -0.073018173491 calculate fermi energy took 0.593 ms
rank = 0, --- Calculate rho: sum over local bands took 1.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.451 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.191 ms
rank = 0, Calculating density took 1219.519 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.539 ms
rank = 0, D2D took 0.720 ms
rank = 0, Transfering density took 0.726 ms
Etot    =   -27.937747866281
Eband   =    -8.458618524499
E1      =    18.179671444735
E2      =    -7.745206807233
E3      =    -9.782347729544
Exc     =    -8.789492751330
Esc     =   -46.396862571731
Entropy =    -0.000000000232
dE = 5.923e-03, dEband = 1.269e-01
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -27.937747866, dEtot = 5.923e-03, dEband = 1.269e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.1480392384798, which took 0.053 ms

iter_count = 108, r_2norm = 1.710e-04, tol*||rhs|| = 2.459e-04

Anderson update took 57.902 ms, out of which F'*F took 27.180 ms; b-Ax took 182.487 ms, out of which Lap took 164.839 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739675, int_b + int_rho = -6.094e-13, checking this took 0.133 ms
2-norm of RHS = 547.7011815175928, which took 0.123 ms

iter_count = 288, r_2norm = 4.719e-04, tol*||rhs|| = 5.477e-04

Anderson update took 153.771 ms, out of which F'*F took 72.740 ms; b-Ax took 489.302 ms, out of which Lap took 439.478 ms
Solving Poisson took 1032.479 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Total time for convolution: 	 convolve: 5.081070 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.080709 
Total time for convolution: 	 convolve: 5.089029 
Total time for convolution: 	 convolve: 5.078255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.188 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 26971.343 ms, scf error = 5.269e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.130871, lowerbound = -0.914408, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1156.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.527 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 13.970 ms
rank =  0, finding HY took 17.988 ms
rank =  0, distributing HY into block cyclic form took 12.357 ms
rank =  0, finding Y'*HY took 2.475 ms
Rank 0, Project_Hamiltonian used 46.818 ms
Total time for projection: 46.835 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.895080664313825
    last  calculated eigval = 0.033903382613700
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89508066431382
lambda[   2] =  -0.82044762842828
lambda[   3] =  -0.56878924544604
lambda[   4] =  -0.53097641836829
lambda[   5] =  -0.36860755575545
lambda[   6] =  -0.32722543097775
lambda[   7] =  -0.31260730841981
lambda[   8] =  -0.24620962487328
lambda[   9] =  -0.04687091551878
lambda[  10] =  -0.02742596956479
lambda[  11] =   0.01189343492044
lambda[  12] =   0.01449292556827
lambda[  13] =   0.02173411780691
lambda[  14] =   0.03390338261370
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.979 ms
rank =  0, Distributing orbital back into band + domain format took 10.870 ms
rank = 0, Subspace_Rotation used 14.867 ms

Total time for subspace rotation: 14.875 ms
rank = 0, Efermi =  -0.076918994506 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.056 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.822 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 1223.039 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.405 ms
rank = 0, D2D took 0.732 ms
rank = 0, Transfering density took 0.741 ms
Etot    =   -27.930945170559
Eband   =    -8.139887753512
E1      =    17.959637073093
E2      =    -7.634488424968
E3      =    -9.866870432741
Exc     =    -8.855190775889
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 1.361e-03, dEband = 6.375e-02
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -27.930945171, dEtot = 1.361e-03, dEband = 6.375e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1632310081563, which took 0.310 ms

iter_count = 108, r_2norm = 8.362e-05, tol*||rhs|| = 8.653e-05

Anderson update took 57.518 ms, out of which F'*F took 27.200 ms; b-Ax took 183.444 ms, out of which Lap took 163.861 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.460 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739677, int_b + int_rho = -5.966e-13, checking this took 0.103 ms
2-norm of RHS = 548.5427008555442, which took 0.110 ms

iter_count = 270, r_2norm = 5.279e-04, tol*||rhs|| = 5.485e-04

Anderson update took 143.247 ms, out of which F'*F took 67.273 ms; b-Ax took 455.990 ms, out of which Lap took 409.901 ms
Solving Poisson took 970.328 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.091176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.084789 
Total time for convolution: 	 convolve: 5.115533 
Total time for convolution: 	 convolve: 5.107428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 26966.720 ms, scf error = 1.857e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.133903, lowerbound = -0.895081, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1152.426 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.684 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.122 ms
rank =  0, finding HY took 18.351 ms
rank =  0, distributing HY into block cyclic form took 12.734 ms
rank =  0, finding Y'*HY took 2.222 ms
Rank 0, Project_Hamiltonian used 47.462 ms
Total time for projection: 47.476 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.041 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.892322770622917
    last  calculated eigval = 0.035537599893627
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89232277062292
lambda[   2] =  -0.81198472372498
lambda[   3] =  -0.56618600614791
lambda[   4] =  -0.52882950321582
lambda[   5] =  -0.36445273447656
lambda[   6] =  -0.31707139612043
lambda[   7] =  -0.30571148843630
lambda[   8] =  -0.24153213393805
lambda[   9] =  -0.04935197403804
lambda[  10] =  -0.02272064272030
lambda[  11] =   0.01068141160903
lambda[  12] =   0.01257768354726
lambda[  13] =   0.01879173934967
lambda[  14] =   0.03553759989363
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.747 ms
rank =  0, Distributing orbital back into band + domain format took 11.106 ms
rank = 0, Subspace_Rotation used 14.872 ms

Total time for subspace rotation: 14.881 ms
rank = 0, Efermi =  -0.079400053039 calculate fermi energy took 0.242 ms
rank = 0, --- Calculate rho: sum over local bands took 2.054 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.904 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1219.111 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
rank = 0, D2D took 0.760 ms
rank = 0, Transfering density took 0.767 ms
Etot    =   -27.929348083304
Eband   =    -8.056181513731
E1      =    17.926246663558
E2      =    -7.579209918562
E3      =    -9.889245469648
Exc     =    -8.871006049381
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 3.194e-04, dEband = 1.674e-02
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -27.929348083, dEtot = 3.194e-04, dEband = 1.674e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4329994897178, which took 0.070 ms

iter_count = 108, r_2norm = 4.467e-05, tol*||rhs|| = 5.732e-05

Anderson update took 58.077 ms, out of which F'*F took 27.430 ms; b-Ax took 182.787 ms, out of which Lap took 164.467 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.629 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739680, int_b + int_rho = -5.621e-13, checking this took 0.111 ms
2-norm of RHS = 548.9823319739692, which took 0.120 ms

iter_count = 252, r_2norm = 5.211e-04, tol*||rhs|| = 5.490e-04

Anderson update took 134.193 ms, out of which F'*F took 62.668 ms; b-Ax took 427.087 ms, out of which Lap took 383.364 ms
Solving Poisson took 901.155 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.076440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.512 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.089366 
Total time for convolution: 	 convolve: 5.111286 
Total time for convolution: 	 convolve: 5.088154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.608 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.967 ms

This SCF took 26881.940 ms, scf error = 8.326e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.135538, lowerbound = -0.892323, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.971 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.665 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.413 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.098 ms
rank =  0, finding HY took 17.974 ms
rank =  0, distributing HY into block cyclic form took 12.810 ms
rank =  0, finding Y'*HY took 1.992 ms
Rank 0, Project_Hamiltonian used 46.912 ms
Total time for projection: 46.925 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.748 ms
    first calculated eigval = -0.891069411393209
    last  calculated eigval = 0.035266885810157
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.89106941139321
lambda[   2] =  -0.81105617400451
lambda[   3] =  -0.56519176194641
lambda[   4] =  -0.52796275993651
lambda[   5] =  -0.36297445006659
lambda[   6] =  -0.31434852093137
lambda[   7] =  -0.30409147457636
lambda[   8] =  -0.23994184080003
lambda[   9] =  -0.05059147158592
lambda[  10] =  -0.02191184178394
lambda[  11] =   0.00888413235743
lambda[  12] =   0.01148696144283
lambda[  13] =   0.01724050871613
lambda[  14] =   0.03526688581016
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.807 ms
rank =  0, subspace rotation using ScaLAPACK took 3.769 ms
rank =  0, Distributing orbital back into band + domain format took 11.866 ms
rank = 0, Subspace_Rotation used 15.653 ms

Total time for subspace rotation: 15.659 ms
rank = 0, Efermi =  -0.080639550628 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1226.413 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.472 ms
rank = 0, D2D took 0.857 ms
rank = 0, Transfering density took 0.868 ms
Etot    =   -27.928907672767
Eband   =    -8.033272787684
E1      =    17.927880207166
E2      =    -7.553314271522
E3      =    -9.892240881583
Exc     =    -8.872207673394
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 8.808e-05, dEband = 4.582e-03
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -27.928907673, dEtot = 8.808e-05, dEband = 4.582e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5613972464179, which took 0.056 ms

iter_count = 114, r_2norm = 1.546e-05, tol*||rhs|| = 2.246e-05

Anderson update took 61.310 ms, out of which F'*F took 28.653 ms; b-Ax took 193.380 ms, out of which Lap took 173.896 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.859 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739681, int_b + int_rho = -5.475e-13, checking this took 0.113 ms
2-norm of RHS = 549.1232092409510, which took 0.099 ms

iter_count = 246, r_2norm = 5.269e-04, tol*||rhs|| = 5.491e-04

Anderson update took 135.925 ms, out of which F'*F took 60.718 ms; b-Ax took 413.395 ms, out of which Lap took 371.775 ms
Solving Poisson took 885.914 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.081654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.083145 
Total time for convolution: 	 convolve: 5.080947 
Total time for convolution: 	 convolve: 5.082537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.005 ms

This SCF took 27200.623 ms, scf error = 4.654e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135267, lowerbound = -0.891069, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.660 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.402 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.083 ms
rank =  0, finding HY took 18.210 ms
rank =  0, distributing HY into block cyclic form took 12.762 ms
rank =  0, finding Y'*HY took 2.215 ms
Rank 0, Project_Hamiltonian used 48.074 ms
Total time for projection: 48.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.888796287211344
    last  calculated eigval = 0.035832312345673
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88879628721134
lambda[   2] =  -0.80798664162633
lambda[   3] =  -0.56320873445223
lambda[   4] =  -0.52642786113471
lambda[   5] =  -0.36047737671959
lambda[   6] =  -0.31048376726076
lambda[   7] =  -0.30121454226879
lambda[   8] =  -0.23725366715386
lambda[   9] =  -0.05119515650595
lambda[  10] =  -0.02037828856320
lambda[  11] =   0.00766511536160
lambda[  12] =   0.01108181406308
lambda[  13] =   0.01674123474984
lambda[  14] =   0.03583231234567
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.181 ms
rank =  0, Distributing orbital back into band + domain format took 12.188 ms
rank = 0, Subspace_Rotation used 15.383 ms

Total time for subspace rotation: 15.387 ms
rank = 0, Efermi =  -0.081243235562 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.767 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1222.065 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
rank = 0, D2D took 0.894 ms
rank = 0, Transfering density took 0.907 ms
Etot    =   -27.928602003919
Eband   =    -7.991697756034
E1      =    17.908671963615
E2      =    -7.528795293452
E3      =    -9.900240933943
Exc     =    -8.877749866935
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 6.113e-05, dEband = 8.315e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -27.928602004, dEtot = 6.113e-05, dEband = 8.315e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2773131960772, which took 0.095 ms

iter_count = 114, r_2norm = 7.329e-06, tol*||rhs|| = 1.109e-05

Anderson update took 60.765 ms, out of which F'*F took 28.593 ms; b-Ax took 193.679 ms, out of which Lap took 172.715 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.472 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739677, int_b + int_rho = -5.912e-13, checking this took 0.122 ms
2-norm of RHS = 549.1047072219102, which took 0.105 ms

iter_count = 258, r_2norm = 4.802e-04, tol*||rhs|| = 5.491e-04

Anderson update took 138.737 ms, out of which F'*F took 64.386 ms; b-Ax took 431.959 ms, out of which Lap took 387.859 ms
Solving Poisson took 923.380 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.085176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.871 ms
Total time for convolution: 	 convolve: 5.075761 
Total time for convolution: 	 convolve: 5.085638 
Total time for convolution: 	 convolve: 5.083835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26899.717 ms, scf error = 3.116e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.135832, lowerbound = -0.888796, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1169.131 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.587 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.910 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.899 ms
rank =  0, finding HY took 18.768 ms
rank =  0, distributing HY into block cyclic form took 12.783 ms
rank =  0, finding Y'*HY took 1.978 ms
Rank 0, Project_Hamiltonian used 48.461 ms
Total time for projection: 48.474 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.886365010436562
    last  calculated eigval = 0.037169427179004
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88636501043656
lambda[   2] =  -0.80334933676883
lambda[   3] =  -0.56111048994849
lambda[   4] =  -0.52530065661014
lambda[   5] =  -0.35714239102417
lambda[   6] =  -0.30535531988296
lambda[   7] =  -0.29676239060046
lambda[   8] =  -0.23390850568854
lambda[   9] =  -0.05036073757678
lambda[  10] =  -0.01777900863482
lambda[  11] =   0.00696396899897
lambda[  12] =   0.01240914182666
lambda[  13] =   0.01761349819867
lambda[  14] =   0.03716942717900
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.190 ms
rank =  0, Distributing orbital back into band + domain format took 12.215 ms
rank = 0, Subspace_Rotation used 15.422 ms

Total time for subspace rotation: 15.425 ms
rank = 0, Efermi =  -0.080408816377 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.777 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1236.298 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.531 ms
rank = 0, D2D took 0.727 ms
rank = 0, Transfering density took 0.730 ms
Etot    =   -27.928535533853
Eband   =    -7.938588202293
E1      =    17.881901283279
E2      =    -7.500554670662
E3      =    -9.907103111026
Exc     =    -8.882643824568
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 1.329e-05, dEband = 1.062e-02
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -27.928535534, dEtot = 1.329e-05, dEband = 1.062e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2386456156554, which took 0.051 ms

iter_count = 108, r_2norm = 9.278e-06, tol*||rhs|| = 9.546e-06

Anderson update took 58.885 ms, out of which F'*F took 27.269 ms; b-Ax took 204.161 ms, out of which Lap took 183.732 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.831 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739685, int_b + int_rho = -5.130e-13, checking this took 0.140 ms
2-norm of RHS = 549.0991218468403, which took 0.118 ms

iter_count = 228, r_2norm = 4.721e-04, tol*||rhs|| = 5.491e-04

Anderson update took 124.125 ms, out of which F'*F took 56.425 ms; b-Ax took 381.155 ms, out of which Lap took 342.458 ms
Solving Poisson took 818.064 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.099 ms
Total time for convolution: 	 convolve: 5.099279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.081250 
Total time for convolution: 	 convolve: 5.116772 
Total time for convolution: 	 convolve: 5.084225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.960 ms

This SCF took 26827.708 ms, scf error = 1.523e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.137169, lowerbound = -0.886365, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1113.258 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.633 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.070 ms
rank =  0, finding HY took 18.227 ms
rank =  0, distributing HY into block cyclic form took 12.778 ms
rank =  0, finding Y'*HY took 2.040 ms
Rank 0, Project_Hamiltonian used 47.146 ms
Total time for projection: 47.158 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.885031143398099
    last  calculated eigval = 0.035992960650622
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88503114339810
lambda[   2] =  -0.80170434418360
lambda[   3] =  -0.55987434732854
lambda[   4] =  -0.52418441471644
lambda[   5] =  -0.35571493895087
lambda[   6] =  -0.30379319836411
lambda[   7] =  -0.29520638094823
lambda[   8] =  -0.23253197376797
lambda[   9] =  -0.04779614440017
lambda[  10] =  -0.01618513321651
lambda[  11] =   0.00711043484433
lambda[  12] =   0.01476814352448
lambda[  13] =   0.01856757443668
lambda[  14] =   0.03599296065062
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.283 ms
rank =  0, Distributing orbital back into band + domain format took 12.065 ms
rank = 0, Subspace_Rotation used 15.364 ms

Total time for subspace rotation: 15.368 ms
rank = 0, Efermi =  -0.077844223235 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.142 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.817 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1179.095 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.558 ms
rank = 0, D2D took 0.751 ms
rank = 0, Transfering density took 0.753 ms
Etot    =   -27.928678893419
Eband   =    -7.916081483669
E1      =    17.870378140509
E2      =    -7.488947015471
E3      =    -9.909374476601
Exc     =    -8.884434470371
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.867e-05, dEband = 4.501e-03
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -27.928678893, dEtot = 2.867e-05, dEband = 4.501e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1846873585911, which took 0.051 ms

iter_count = 108, r_2norm = 5.120e-06, tol*||rhs|| = 7.387e-06

Anderson update took 57.460 ms, out of which F'*F took 26.894 ms; b-Ax took 183.767 ms, out of which Lap took 163.848 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.976 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739679, int_b + int_rho = -5.730e-13, checking this took 0.127 ms
2-norm of RHS = 549.0902839866070, which took 0.092 ms

iter_count = 216, r_2norm = 5.044e-04, tol*||rhs|| = 5.491e-04

Anderson update took 117.639 ms, out of which F'*F took 53.671 ms; b-Ax took 361.855 ms, out of which Lap took 325.051 ms
Solving Poisson took 775.733 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.639 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.123285 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.100130 
Total time for convolution: 	 convolve: 5.077351 
Total time for convolution: 	 convolve: 5.082675 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.468 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.477 ms

This SCF took 26708.755 ms, scf error = 1.067e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.135993, lowerbound = -0.885031, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.674 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.667 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.459 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.152 ms
rank =  0, finding HY took 18.120 ms
rank =  0, distributing HY into block cyclic form took 12.903 ms
rank =  0, finding Y'*HY took 1.921 ms
Rank 0, Project_Hamiltonian used 47.126 ms
Total time for projection: 47.138 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.884285930359895
    last  calculated eigval = 0.034798667677731
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88428593035990
lambda[   2] =  -0.80092814418046
lambda[   3] =  -0.55917394555034
lambda[   4] =  -0.52340887455400
lambda[   5] =  -0.35494285556573
lambda[   6] =  -0.30300281396344
lambda[   7] =  -0.29435818389135
lambda[   8] =  -0.23173099325066
lambda[   9] =  -0.04378018353249
lambda[  10] =  -0.01450337785624
lambda[  11] =   0.00741744069071
lambda[  12] =   0.01914089691246
lambda[  13] =   0.02080881362404
lambda[  14] =   0.03479866767773
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.199 ms
rank =  0, Distributing orbital back into band + domain format took 12.193 ms
rank = 0, Subspace_Rotation used 15.405 ms

Total time for subspace rotation: 15.409 ms
rank = 0, Efermi =  -0.073828262318 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.112 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1226.501 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
rank = 0, D2D took 0.713 ms
rank = 0, Transfering density took 0.716 ms
Etot    =   -27.928795606091
Eband   =    -7.903663482956
E1      =    17.864696904249
E2      =    -7.482170100106
E3      =    -9.909563575553
Exc     =    -8.884700131083
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.334e-05, dEband = 2.484e-03
rank = 0, Calculating/Estimating energy took 0.959 ms, Etot = -27.928795606, dEtot = 2.334e-05, dEband = 2.484e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1567070002947, which took 0.118 ms

iter_count = 102, r_2norm = 5.206e-06, tol*||rhs|| = 6.268e-06

Anderson update took 54.555 ms, out of which F'*F took 25.557 ms; b-Ax took 173.368 ms, out of which Lap took 154.943 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.810 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739678, int_b + int_rho = -5.803e-13, checking this took 0.141 ms
2-norm of RHS = 549.1257711352430, which took 0.062 ms

iter_count = 210, r_2norm = 5.333e-04, tol*||rhs|| = 5.491e-04

Anderson update took 112.686 ms, out of which F'*F took 52.451 ms; b-Ax took 351.955 ms, out of which Lap took 316.554 ms
Solving Poisson took 755.378 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.097163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.110021 
Total time for convolution: 	 convolve: 5.086385 
Total time for convolution: 	 convolve: 5.077532 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.201 ms
---Transfer Veff_loc: D2D took 1.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.779 ms

This SCF took 26826.153 ms, scf error = 7.033e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134799, lowerbound = -0.884286, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.722 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.620 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 14.090 ms
rank =  0, finding HY took 18.401 ms
rank =  0, distributing HY into block cyclic form took 12.741 ms
rank =  0, finding Y'*HY took 2.062 ms
Rank 0, Project_Hamiltonian used 47.328 ms
Total time for projection: 47.339 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.883130859095511
    last  calculated eigval = 0.035090979745017
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88313085909551
lambda[   2] =  -0.79983539431676
lambda[   3] =  -0.55805603715252
lambda[   4] =  -0.52231944218322
lambda[   5] =  -0.35381240027897
lambda[   6] =  -0.30190248961533
lambda[   7] =  -0.29322286824578
lambda[   8] =  -0.23063268768594
lambda[   9] =  -0.03947865196359
lambda[  10] =  -0.01245087195970
lambda[  11] =   0.00763923892034
lambda[  12] =   0.02398968534367
lambda[  13] =   0.02494079881272
lambda[  14] =   0.03509097974502
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 3.197 ms
rank =  0, Distributing orbital back into band + domain format took 12.176 ms
rank = 0, Subspace_Rotation used 15.388 ms

Total time for subspace rotation: 15.392 ms
rank = 0, Efermi =  -0.069526730933 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.817 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1187.780 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
rank = 0, D2D took 0.740 ms
rank = 0, Transfering density took 0.743 ms
Etot    =   -27.928926482791
Eband   =    -7.885824357440
E1      =    17.856376567497
E2      =    -7.472199671442
E3      =    -9.911077037041
Exc     =    -8.885892829371
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.618e-05, dEband = 3.568e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -27.928926483, dEtot = 2.618e-05, dEband = 3.568e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1652052605331, which took 0.125 ms

iter_count = 102, r_2norm = 4.902e-06, tol*||rhs|| = 6.608e-06

Anderson update took 54.441 ms, out of which F'*F took 25.483 ms; b-Ax took 173.241 ms, out of which Lap took 154.543 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.072 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739683, int_b + int_rho = -5.348e-13, checking this took 0.115 ms
2-norm of RHS = 549.1224258146341, which took 0.107 ms

iter_count = 168, r_2norm = 4.702e-04, tol*||rhs|| = 5.491e-04

Anderson update took 90.283 ms, out of which F'*F took 41.743 ms; b-Ax took 280.933 ms, out of which Lap took 252.360 ms
Solving Poisson took 602.576 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.072585 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.098215 
Total time for convolution: 	 convolve: 5.086241 
Total time for convolution: 	 convolve: 5.072459 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.136 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.973 ms

This SCF took 26464.297 ms, scf error = 4.930e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135091, lowerbound = -0.883131, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1144.944 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.650 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.077 ms
rank =  0, finding HY took 18.233 ms
rank =  0, distributing HY into block cyclic form took 12.769 ms
rank =  0, finding Y'*HY took 2.028 ms
Rank 0, Project_Hamiltonian used 47.143 ms
Total time for projection: 47.156 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.882830272394633
    last  calculated eigval = 0.034413157029445
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88283027239463
lambda[   2] =  -0.79957807396176
lambda[   3] =  -0.55776572714583
lambda[   4] =  -0.52203729299251
lambda[   5] =  -0.35353402100949
lambda[   6] =  -0.30168100059798
lambda[   7] =  -0.29298030621202
lambda[   8] =  -0.23036552899574
lambda[   9] =  -0.03851827623645
lambda[  10] =  -0.01206614956906
lambda[  11] =   0.00770751894783
lambda[  12] =   0.02513616172419
lambda[  13] =   0.02641018370539
lambda[  14] =   0.03441315702944
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.201 ms
rank =  0, Distributing orbital back into band + domain format took 12.182 ms
rank = 0, Subspace_Rotation used 15.398 ms

Total time for subspace rotation: 15.409 ms
rank = 0, Efermi =  -0.068566355278 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.181 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.690 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1210.751 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
rank = 0, D2D took 0.778 ms
rank = 0, Transfering density took 0.784 ms
Etot    =   -27.928958130809
Eband   =    -7.881544446905
E1      =    17.854083557000
E2      =    -7.470129611009
E3      =    -9.911409587049
Exc     =    -8.886173867002
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 6.330e-06, dEband = 8.560e-04
rank = 0, Calculating/Estimating energy took 1.313 ms, Etot = -27.928958131, dEtot = 6.330e-06, dEband = 8.560e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1424495273795, which took 0.130 ms

iter_count = 102, r_2norm = 4.402e-06, tol*||rhs|| = 5.698e-06

Anderson update took 54.328 ms, out of which F'*F took 25.470 ms; b-Ax took 173.112 ms, out of which Lap took 154.550 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.604 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739681, int_b + int_rho = -5.475e-13, checking this took 0.144 ms
2-norm of RHS = 549.1214476012528, which took 0.117 ms

iter_count = 162, r_2norm = 4.755e-04, tol*||rhs|| = 5.491e-04

Anderson update took 87.220 ms, out of which F'*F took 40.113 ms; b-Ax took 272.427 ms, out of which Lap took 245.265 ms
Solving Poisson took 582.479 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.076540 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.086446 
Total time for convolution: 	 convolve: 5.096437 
Total time for convolution: 	 convolve: 5.079893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.697 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 26478.454 ms, scf error = 3.966e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134413, lowerbound = -0.882830, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1159.821 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.673 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.544 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.243 ms
rank =  0, finding HY took 18.128 ms
rank =  0, distributing HY into block cyclic form took 12.796 ms
rank =  0, finding Y'*HY took 2.042 ms
Rank 0, Project_Hamiltonian used 47.245 ms
Total time for projection: 47.258 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.882569630760371
    last  calculated eigval = 0.033796917478726
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88256963076037
lambda[   2] =  -0.79931894873629
lambda[   3] =  -0.55751540473058
lambda[   4] =  -0.52179291633356
lambda[   5] =  -0.35328251721053
lambda[   6] =  -0.30144378294068
lambda[   7] =  -0.29274067403519
lambda[   8] =  -0.23011451820188
lambda[   9] =  -0.03813262711255
lambda[  10] =  -0.01188862169170
lambda[  11] =   0.00795407440026
lambda[  12] =   0.02565067899443
lambda[  13] =   0.02761339023868
lambda[  14] =   0.03379691747873
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.265 ms
rank =  0, Distributing orbital back into band + domain format took 12.163 ms
rank = 0, Subspace_Rotation used 15.444 ms

Total time for subspace rotation: 15.448 ms
rank = 0, Efermi =  -0.068180706085 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.092 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1225.776 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.532 ms
rank = 0, D2D took 1.978 ms
rank = 0, Transfering density took 1.984 ms
Etot    =   -27.928999418563
Eband   =    -7.877556786180
E1      =    17.852023945759
E2      =    -7.468100577661
E3      =    -9.911715371676
Exc     =    -8.886419955519
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 8.258e-06, dEband = 7.975e-04
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -27.928999419, dEtot = 8.258e-06, dEband = 7.975e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0536898419704, which took 0.056 ms

iter_count = 108, r_2norm = 1.904e-06, tol*||rhs|| = 2.148e-06

Anderson update took 58.243 ms, out of which F'*F took 26.945 ms; b-Ax took 183.530 ms, out of which Lap took 163.808 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.761 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739682, int_b + int_rho = -5.421e-13, checking this took 0.103 ms
2-norm of RHS = 549.1325167105056, which took 0.096 ms

iter_count = 186, r_2norm = 4.704e-04, tol*||rhs|| = 5.491e-04

Anderson update took 100.931 ms, out of which F'*F took 46.245 ms; b-Ax took 324.450 ms, out of which Lap took 293.163 ms
Solving Poisson took 682.812 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.084627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.078098 
Total time for convolution: 	 convolve: 5.096934 
Total time for convolution: 	 convolve: 5.071103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.753 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
---Transfer Veff_loc: D2D took 0.651 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.959 ms

This SCF took 26627.278 ms, scf error = 3.339e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133797, lowerbound = -0.882570, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.577 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.394 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.993 ms
rank =  0, finding HY took 18.107 ms
rank =  0, distributing HY into block cyclic form took 12.794 ms
rank =  0, finding Y'*HY took 2.059 ms
Rank 0, Project_Hamiltonian used 46.988 ms
Total time for projection: 47.005 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.882504640075017
    last  calculated eigval = 0.034604526761053
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88250464007502
lambda[   2] =  -0.79922828979416
lambda[   3] =  -0.55744425272165
lambda[   4] =  -0.52168572018780
lambda[   5] =  -0.35318795821310
lambda[   6] =  -0.30133516442643
lambda[   7] =  -0.29263113008888
lambda[   8] =  -0.23001954163510
lambda[   9] =  -0.03866533621359
lambda[  10] =  -0.01215159275077
lambda[  11] =   0.00987707275251
lambda[  12] =   0.02512413388052
lambda[  13] =   0.02860983878349
lambda[  14] =   0.03460452676105
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.283 ms
rank =  0, Distributing orbital back into band + domain format took 12.055 ms
rank = 0, Subspace_Rotation used 15.354 ms

Total time for subspace rotation: 15.358 ms
rank = 0, Efermi =  -0.068713415313 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.137 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.743 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1220.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.426 ms
rank = 0, D2D took 0.541 ms
rank = 0, Transfering density took 0.543 ms
Etot    =   -27.929058388918
Eband   =    -7.876073394570
E1      =    17.852049144519
E2      =    -7.466647492636
E3      =    -9.911192336848
Exc     =    -8.886011396391
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 1.179e-05, dEband = 2.967e-04
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -27.929058389, dEtot = 1.179e-05, dEband = 2.967e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0516289415468, which took 0.053 ms

iter_count = 108, r_2norm = 1.907e-06, tol*||rhs|| = 2.065e-06

Anderson update took 57.030 ms, out of which F'*F took 29.221 ms; b-Ax took 185.678 ms, out of which Lap took 165.891 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.302 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739683, int_b + int_rho = -5.330e-13, checking this took 0.101 ms
2-norm of RHS = 549.1319427176722, which took 0.103 ms

iter_count = 126, r_2norm = 5.179e-04, tol*||rhs|| = 5.491e-04

Anderson update took 68.012 ms, out of which F'*F took 31.264 ms; b-Ax took 210.248 ms, out of which Lap took 189.168 ms
Solving Poisson took 452.950 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.075253 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.082984 
Total time for convolution: 	 convolve: 5.078265 
Total time for convolution: 	 convolve: 5.088082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.102 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.290 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 26538.340 ms, scf error = 4.095e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134605, lowerbound = -0.882505, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.473 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.605 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.399 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 14.023 ms
rank =  0, finding HY took 18.102 ms
rank =  0, distributing HY into block cyclic form took 12.811 ms
rank =  0, finding Y'*HY took 1.954 ms
Rank 0, Project_Hamiltonian used 46.918 ms
Total time for projection: 46.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.882375127241245
    last  calculated eigval = 0.032851001073260
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88237512724125
lambda[   2] =  -0.79908605731108
lambda[   3] =  -0.55732444751882
lambda[   4] =  -0.52158776165690
lambda[   5] =  -0.35307045169416
lambda[   6] =  -0.30120241889392
lambda[   7] =  -0.29251026338329
lambda[   8] =  -0.22989857035236
lambda[   9] =  -0.03856120985505
lambda[  10] =  -0.01198809049634
lambda[  11] =   0.00912704559695
lambda[  12] =   0.02502533209799
lambda[  13] =   0.02799773886467
lambda[  14] =   0.03285100107326
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.182 ms
rank =  0, Distributing orbital back into band + domain format took 12.229 ms
rank = 0, Subspace_Rotation used 15.426 ms

Total time for subspace rotation: 15.430 ms
rank = 0, Efermi =  -0.068609288852 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.531 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 1226.809 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.520 ms
rank = 0, D2D took 0.762 ms
rank = 0, Transfering density took 0.770 ms
Etot    =   -27.929051474201
Eband   =    -7.874110196389
E1      =    17.850764452014
E2      =    -7.465850582972
E3      =    -9.911696451870
Exc     =    -8.886390192708
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 1.383e-06, dEband = 3.926e-04
rank = 0, Calculating/Estimating energy took 0.950 ms, Etot = -27.929051474, dEtot = 1.383e-06, dEband = 3.926e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0480167399521, which took 0.097 ms

iter_count = 108, r_2norm = 1.700e-06, tol*||rhs|| = 1.921e-06

Anderson update took 57.733 ms, out of which F'*F took 30.631 ms; b-Ax took 186.923 ms, out of which Lap took 167.219 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.958 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739679, int_b + int_rho = -5.766e-13, checking this took 0.118 ms
2-norm of RHS = 549.1406613977375, which took 0.109 ms

iter_count = 132, r_2norm = 5.415e-04, tol*||rhs|| = 5.491e-04

Anderson update took 72.428 ms, out of which F'*F took 32.740 ms; b-Ax took 220.426 ms, out of which Lap took 198.014 ms
Solving Poisson took 475.295 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.072455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.083408 
Total time for convolution: 	 convolve: 5.083333 
Total time for convolution: 	 convolve: 5.077293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.013 ms

This SCF took 26416.076 ms, scf error = 3.203e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.132851, lowerbound = -0.882375, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.489 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.650 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.402 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.093 ms
rank =  0, finding HY took 18.083 ms
rank =  0, distributing HY into block cyclic form took 12.895 ms
rank =  0, finding Y'*HY took 1.942 ms
Rank 0, Project_Hamiltonian used 47.043 ms
Total time for projection: 47.059 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.882303120284589
    last  calculated eigval = 0.032302096817156
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88230312028459
lambda[   2] =  -0.79910077214689
lambda[   3] =  -0.55725054267650
lambda[   4] =  -0.52149531303976
lambda[   5] =  -0.35302421874154
lambda[   6] =  -0.30122744575461
lambda[   7] =  -0.29250405566522
lambda[   8] =  -0.22987011459922
lambda[   9] =  -0.03917756501648
lambda[  10] =  -0.01220335131846
lambda[  11] =   0.00950064381087
lambda[  12] =   0.02425763158063
lambda[  13] =   0.02808082913756
lambda[  14] =   0.03230209681716
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.839 ms
rank =  0, Distributing orbital back into band + domain format took 10.976 ms
rank = 0, Subspace_Rotation used 14.835 ms

Total time for subspace rotation: 14.844 ms
rank = 0, Efermi =  -0.069225643974 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.927 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.125 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.098 ms
rank = 0, Calculating density took 1226.676 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.705 ms
rank = 0, Transfering density took 0.712 ms
Etot    =   -27.929065634379
Eband   =    -7.873551166106
E1      =    17.850769858511
E2      =    -7.465273227936
E3      =    -9.911647566053
Exc     =    -8.886342548814
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.832e-06, dEband = 1.118e-04
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -27.929065634, dEtot = 2.832e-06, dEband = 1.118e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0446495931352, which took 0.087 ms

iter_count = 108, r_2norm = 1.692e-06, tol*||rhs|| = 1.786e-06

Anderson update took 57.563 ms, out of which F'*F took 26.966 ms; b-Ax took 183.486 ms, out of which Lap took 163.594 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.760 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739684, int_b + int_rho = -5.257e-13, checking this took 0.101 ms
2-norm of RHS = 549.1384973145031, which took 0.082 ms

iter_count = 132, r_2norm = 5.290e-04, tol*||rhs|| = 5.491e-04

Anderson update took 71.001 ms, out of which F'*F took 32.711 ms; b-Ax took 220.639 ms, out of which Lap took 198.418 ms
Solving Poisson took 474.206 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.078262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.073287 
Total time for convolution: 	 convolve: 5.089068 
Total time for convolution: 	 convolve: 5.078159 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.870 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.526 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 26414.983 ms, scf error = 3.694e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.132302, lowerbound = -0.882303, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.609 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.431 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.073 ms
rank =  0, finding HY took 18.149 ms
rank =  0, distributing HY into block cyclic form took 12.971 ms
rank =  0, finding Y'*HY took 17.853 ms
Rank 0, Project_Hamiltonian used 63.082 ms
Total time for projection: 63.095 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.882277499412763
    last  calculated eigval = 0.032228548187148
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88227749941276
lambda[   2] =  -0.79901447233611
lambda[   3] =  -0.55722989256993
lambda[   4] =  -0.52149022218678
lambda[   5] =  -0.35297670485665
lambda[   6] =  -0.30112938180312
lambda[   7] =  -0.29242658895552
lambda[   8] =  -0.22981525472382
lambda[   9] =  -0.03777484453549
lambda[  10] =  -0.01177491662365
lambda[  11] =   0.00950215264514
lambda[  12] =   0.02596691104746
lambda[  13] =   0.02882905484032
lambda[  14] =   0.03222854818715
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.792 ms
rank =  0, Distributing orbital back into band + domain format took 11.130 ms
rank = 0, Subspace_Rotation used 14.940 ms

Total time for subspace rotation: 14.949 ms
rank = 0, Efermi =  -0.067822923216 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.775 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1242.666 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
rank = 0, D2D took 0.745 ms
rank = 0, Transfering density took 0.752 ms
Etot    =   -27.929049313874
Eband   =    -7.872720033969
E1      =    17.850298952001
E2      =    -7.464897111773
E3      =    -9.911797979748
Exc     =    -8.886460751469
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 3.264e-06, dEband = 1.662e-04
rank = 0, Calculating/Estimating energy took 0.955 ms, Etot = -27.929049314, dEtot = 3.264e-06, dEband = 1.662e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0514428331195, which took 0.052 ms

iter_count = 108, r_2norm = 1.754e-06, tol*||rhs|| = 2.058e-06

Anderson update took 57.487 ms, out of which F'*F took 27.038 ms; b-Ax took 183.770 ms, out of which Lap took 163.913 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.031 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739682, int_b + int_rho = -5.421e-13, checking this took 0.152 ms
2-norm of RHS = 549.1376358391011, which took 0.108 ms

iter_count = 156, r_2norm = 5.030e-04, tol*||rhs|| = 5.491e-04

Anderson update took 85.485 ms, out of which F'*F took 38.947 ms; b-Ax took 261.233 ms, out of which Lap took 235.160 ms
Solving Poisson took 562.204 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.226306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.081885 
Total time for convolution: 	 convolve: 5.171542 
Total time for convolution: 	 convolve: 5.078906 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.082 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.979 ms

This SCF took 26743.840 ms, scf error = 3.674e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.132229, lowerbound = -0.882277, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1133.088 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.297 ms
rank =  0, Distribute orbital to block cyclic format took 12.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 13.929 ms
rank =  0, finding HY took 18.027 ms
rank =  0, distributing HY into block cyclic form took 12.684 ms
rank =  0, finding Y'*HY took 2.095 ms
Rank 0, Project_Hamiltonian used 47.055 ms
Total time for projection: 47.070 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.506 ms
    first calculated eigval = -0.882283473986201
    last  calculated eigval = 0.030298566706020
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88228347398620
lambda[   2] =  -0.79906865954634
lambda[   3] =  -0.55723107782457
lambda[   4] =  -0.52148770541708
lambda[   5] =  -0.35301213176928
lambda[   6] =  -0.30121881544995
lambda[   7] =  -0.29249412495443
lambda[   8] =  -0.22985916566067
lambda[   9] =  -0.04011722725885
lambda[  10] =  -0.01243201186149
lambda[  11] =   0.00929428677192
lambda[  12] =   0.02275137166467
lambda[  13] =   0.02695949418303
lambda[  14] =   0.03029856670602
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.526 ms
rank =  0, subspace rotation using ScaLAPACK took 3.858 ms
rank =  0, Distributing orbital back into band + domain format took 11.651 ms
rank = 0, Subspace_Rotation used 15.526 ms

Total time for subspace rotation: 15.531 ms
rank = 0, Efermi =  -0.070165306026 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.771 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1199.349 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 0.715 ms
rank = 0, Transfering density took 0.724 ms
Etot    =   -27.929070249445
Eband   =    -7.873310309514
E1      =    17.850388594312
E2      =    -7.465370781207
E3      =    -9.911797761351
Exc     =    -8.886454504842
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 4.187e-06, dEband = 1.181e-04
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -27.929070249, dEtot = 4.187e-06, dEband = 1.181e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0490660414280, which took 0.050 ms

iter_count = 108, r_2norm = 1.755e-06, tol*||rhs|| = 1.963e-06

Anderson update took 57.587 ms, out of which F'*F took 26.953 ms; b-Ax took 183.476 ms, out of which Lap took 163.705 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.898 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739683, int_b + int_rho = -5.330e-13, checking this took 0.133 ms
2-norm of RHS = 549.1356655540449, which took 0.108 ms

iter_count = 108, r_2norm = 5.210e-04, tol*||rhs|| = 5.491e-04

Anderson update took 58.127 ms, out of which F'*F took 26.729 ms; b-Ax took 184.024 ms, out of which Lap took 165.712 ms
Solving Poisson took 392.283 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.100500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.672 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.116568 
Total time for convolution: 	 convolve: 5.078399 
Total time for convolution: 	 convolve: 5.082872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.867 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.991 ms

This SCF took 26453.449 ms, scf error = 3.084e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.130299, lowerbound = -0.882283, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1126.781 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.758 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.397 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.178 ms
rank =  0, finding HY took 18.114 ms
rank =  0, distributing HY into block cyclic form took 12.815 ms
rank =  0, finding Y'*HY took 1.972 ms
Rank 0, Project_Hamiltonian used 47.860 ms
Total time for projection: 47.878 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.551 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.642 ms
    first calculated eigval = -0.882217441835458
    last  calculated eigval = 0.029751500234512
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88221744183546
lambda[   2] =  -0.79898107044665
lambda[   3] =  -0.55716725882253
lambda[   4] =  -0.52143697049033
lambda[   5] =  -0.35295014312299
lambda[   6] =  -0.30115441076821
lambda[   7] =  -0.29242634901710
lambda[   8] =  -0.22979745298476
lambda[   9] =  -0.04035655877232
lambda[  10] =  -0.01245236065520
lambda[  11] =   0.00936960671430
lambda[  12] =   0.02233140364720
lambda[  13] =   0.02681587568411
lambda[  14] =   0.02975150023451
==subpsace eigenproblem: bcast eigvals took 0.106 ms
Total time for solving subspace eigenvalue problem: 0.753 ms
rank =  0, subspace rotation using ScaLAPACK took 3.196 ms
rank =  0, Distributing orbital back into band + domain format took 12.356 ms
rank = 0, Subspace_Rotation used 15.572 ms

Total time for subspace rotation: 15.575 ms
rank = 0, Efermi =  -0.070404638001 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.822 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1194.098 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.536 ms
rank = 0, D2D took 0.732 ms
rank = 0, Transfering density took 0.740 ms
Etot    =   -27.929072569966
Eband   =    -7.872262195275
E1      =    17.849645852226
E2      =    -7.465003620225
E3      =    -9.912036258372
Exc     =    -8.886633533555
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 4.641e-07, dEband = 2.096e-04
rank = 0, Calculating/Estimating energy took 0.960 ms, Etot = -27.929072570, dEtot = 4.641e-07, dEband = 2.096e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0702722216388, which took 0.078 ms

iter_count = 102, r_2norm = 1.966e-06, tol*||rhs|| = 2.811e-06

Anderson update took 54.265 ms, out of which F'*F took 25.581 ms; b-Ax took 173.208 ms, out of which Lap took 154.723 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.526 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739680, int_b + int_rho = -5.621e-13, checking this took 0.116 ms
2-norm of RHS = 549.1398039857627, which took 0.103 ms

iter_count = 168, r_2norm = 4.383e-04, tol*||rhs|| = 5.491e-04

Anderson update took 90.734 ms, out of which F'*F took 41.891 ms; b-Ax took 280.097 ms, out of which Lap took 252.266 ms
Solving Poisson took 602.397 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.117455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.090672 
Total time for convolution: 	 convolve: 5.110208 
Total time for convolution: 	 convolve: 5.076084 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 26820.157 ms, scf error = 2.566e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.129752, lowerbound = -0.882217, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1104.525 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.630 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.616 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.275 ms
rank =  0, finding HY took 21.698 ms
rank =  0, distributing HY into block cyclic form took 12.899 ms
rank =  0, finding Y'*HY took 1.953 ms
Rank 0, Project_Hamiltonian used 51.858 ms
Total time for projection: 51.878 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.881916698516634
    last  calculated eigval = 0.031630543778115
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88191669851663
lambda[   2] =  -0.79865732382217
lambda[   3] =  -0.55686782037464
lambda[   4] =  -0.52114211539565
lambda[   5] =  -0.35264751626396
lambda[   6] =  -0.30086738750010
lambda[   7] =  -0.29210211855640
lambda[   8] =  -0.22950017286175
lambda[   9] =  -0.03896667589083
lambda[  10] =  -0.01186838054116
lambda[  11] =   0.01090063841364
lambda[  12] =   0.02424153243084
lambda[  13] =   0.02857484133658
lambda[  14] =   0.03163054377811
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.262 ms
rank =  0, Distributing orbital back into band + domain format took 12.181 ms
rank = 0, Subspace_Rotation used 15.459 ms

Total time for subspace rotation: 15.462 ms
rank = 0, Efermi =  -0.069014754614 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.125 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.821 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1175.135 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
rank = 0, D2D took 0.767 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -27.929083416867
Eband   =    -7.867402306871
E1      =    17.847311232067
E2      =    -7.462378699418
E3      =    -9.912399613960
Exc     =    -8.886908083482
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.169e-06, dEband = 9.720e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -27.929083417, dEtot = 2.169e-06, dEband = 9.720e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0479130035861, which took 0.052 ms

iter_count = 102, r_2norm = 1.683e-06, tol*||rhs|| = 1.917e-06

Anderson update took 54.059 ms, out of which F'*F took 25.589 ms; b-Ax took 173.192 ms, out of which Lap took 154.433 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.360 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739681, int_b + int_rho = -5.548e-13, checking this took 0.151 ms
2-norm of RHS = 549.1371210817085, which took 0.105 ms

iter_count = 138, r_2norm = 5.052e-04, tol*||rhs|| = 5.491e-04

Anderson update took 85.484 ms, out of which F'*F took 34.270 ms; b-Ax took 230.076 ms, out of which Lap took 207.300 ms
Solving Poisson took 505.834 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
Total time for convolution: 	 convolve: 5.072507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.095374 
Total time for convolution: 	 convolve: 5.074047 
Total time for convolution: 	 convolve: 5.073131 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 26350.492 ms, scf error = 2.463e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.131631, lowerbound = -0.881917, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1125.386 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.550 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.409 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.123 ms
rank =  0, Distribute data + matrix mult took 14.096 ms
rank =  0, finding HY took 18.155 ms
rank =  0, distributing HY into block cyclic form took 12.897 ms
rank =  0, finding Y'*HY took 1.955 ms
Rank 0, Project_Hamiltonian used 47.132 ms
Total time for projection: 47.147 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.881726384704527
    last  calculated eigval = 0.029450574635120
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88172638470453
lambda[   2] =  -0.79847621813443
lambda[   3] =  -0.55668529940991
lambda[   4] =  -0.52098485258055
lambda[   5] =  -0.35248723855408
lambda[   6] =  -0.30074067091567
lambda[   7] =  -0.29195838987989
lambda[   8] =  -0.22934982523550
lambda[   9] =  -0.04008263591540
lambda[  10] =  -0.01196573102733
lambda[  11] =   0.00984371260739
lambda[  12] =   0.02260986714488
lambda[  13] =   0.02681258981842
lambda[  14] =   0.02945057463512
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.182 ms
rank =  0, Distributing orbital back into band + domain format took 12.213 ms
rank = 0, Subspace_Rotation used 15.409 ms

Total time for subspace rotation: 15.412 ms
rank = 0, Efermi =  -0.070130714965 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1191.525 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.508 ms
rank = 0, D2D took 0.749 ms
rank = 0, Transfering density took 0.752 ms
Etot    =   -27.929086001967
Eband   =    -7.864817759126
E1      =    17.845523391839
E2      =    -7.461425667729
E3      =    -9.913027012939
Exc     =    -8.887381743388
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 5.170e-07, dEband = 5.169e-04
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -27.929086002, dEtot = 5.170e-07, dEband = 5.169e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0360443964669, which took 0.057 ms

iter_count = 102, r_2norm = 1.296e-06, tol*||rhs|| = 1.442e-06

Anderson update took 54.451 ms, out of which F'*F took 25.543 ms; b-Ax took 172.866 ms, out of which Lap took 154.474 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.222 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739683, int_b + int_rho = -5.311e-13, checking this took 0.102 ms
2-norm of RHS = 549.1323068861963, which took 0.125 ms

iter_count = 150, r_2norm = 4.615e-04, tol*||rhs|| = 5.491e-04

Anderson update took 80.853 ms, out of which F'*F took 37.143 ms; b-Ax took 249.211 ms, out of which Lap took 224.470 ms
Solving Poisson took 539.953 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.069852 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.080142 
Total time for convolution: 	 convolve: 5.090903 
Total time for convolution: 	 convolve: 5.082586 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.467 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.495 ms

This SCF took 26413.934 ms, scf error = 1.416e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.129451, lowerbound = -0.881726, upperbound = 267.575286

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1160.702 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.589 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.498 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.108 ms
rank =  0, finding HY took 18.102 ms
rank =  0, distributing HY into block cyclic form took 12.916 ms
rank =  0, finding Y'*HY took 1.936 ms
Rank 0, Project_Hamiltonian used 47.092 ms
Total time for projection: 47.108 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.881658832331039
    last  calculated eigval = 0.028793256617964
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88165883233104
lambda[   2] =  -0.79844170584309
lambda[   3] =  -0.55661211666629
lambda[   4] =  -0.52089758630584
lambda[   5] =  -0.35244119826045
lambda[   6] =  -0.30075569788014
lambda[   7] =  -0.29193312698765
lambda[   8] =  -0.22931211724254
lambda[   9] =  -0.04039298305769
lambda[  10] =  -0.01199912776783
lambda[  11] =   0.01023505698903
lambda[  12] =   0.02222317457483
lambda[  13] =   0.02623685756085
lambda[  14] =   0.02879325661796
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.334 ms
rank =  0, Distributing orbital back into band + domain format took 12.046 ms
rank = 0, Subspace_Rotation used 15.397 ms

Total time for subspace rotation: 15.400 ms
rank = 0, Efermi =  -0.070441061974 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.122 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1226.413 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.454 ms
rank = 0, D2D took 0.821 ms
rank = 0, Transfering density took 0.825 ms
Etot    =   -27.929084516354
Eband   =    -7.864104763333
E1      =    17.844986203089
E2      =    -7.461252078496
E3      =    -9.913079489046
Exc     =    -8.887434951694
Esc     =   -46.396862571731
Entropy =    -0.000000000229
dE = 2.971e-07, dEband = 1.426e-04
rank = 0, Calculating/Estimating energy took 0.970 ms, Etot = -27.929084516, dEtot = 2.971e-07, dEband = 1.426e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0236208724131, which took 0.114 ms

iter_count = 108, r_2norm = 6.484e-07, tol*||rhs|| = 9.448e-07

Anderson update took 57.753 ms, out of which F'*F took 27.038 ms; b-Ax took 183.135 ms, out of which Lap took 163.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.712 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000739736, int_rho =  16.00000000739680, int_b + int_rho = -5.621e-13, checking this took 0.139 ms
2-norm of RHS = 549.1321669600064, which took 0.060 ms

iter_count = 120, r_2norm = 4.939e-04, tol*||rhs|| = 5.491e-04

Anderson update took 65.038 ms, out of which F'*F took 29.771 ms; b-Ax took 200.245 ms, out of which Lap took 180.429 ms
Solving Poisson took 431.518 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.080503 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.070978 
Total time for convolution: 	 convolve: 5.081316 
Total time for convolution: 	 convolve: 5.084543 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.030 ms
---Transfer Veff_loc: D2D took 1.462 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.788 ms

This SCF took 26371.662 ms, scf error = 9.552e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.88165883233104, occ[   1] =   2.00000000000000
lambda[   2] =  -0.79844170584309, occ[   2] =   2.00000000000000
lambda[   3] =  -0.55661211666629, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52089758630584, occ[   4] =   2.00000000000000
lambda[   5] =  -0.35244119826045, occ[   5] =   2.00000000000000
lambda[   6] =  -0.30075569788014, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29193312698765, occ[   7] =   2.00000000000000
lambda[   8] =  -0.22931211724254, occ[   8] =   2.00000000000000
lambda[   9] =  -0.04039298305769, occ[   9] =   0.00000000739681
lambda[  10] =  -0.01199912776783, occ[  10] =   0.00000000000000
lambda[  11] =   0.01023505698903, occ[  11] =   0.00000000000000
lambda[  12] =   0.02222317457483, occ[  12] =   0.00000000000000
lambda[  13] =   0.02623685756085, occ[  13] =   0.00000000000000
lambda[  14] =   0.02879325661796, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.468 ms, time for Allreduce/Reduce: 5.853 ms 
Time for calculating local force components: 13.907 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000001140791  -0.05875948104314   0.03420878920140
 -0.00000001496776   0.05875947639740   0.03420882816018
  0.00000086767437   0.00000003226628  -0.18650581815505
 -0.00000066210661  -0.00000187012276  -0.95888661032434
  0.00000178353506  -0.00000098071060   0.17917230165682
force_loc = 
  0.00000012939062   0.06319796694196  -0.03831673641709
  0.00000009261057  -0.06319799787631  -0.03831669652655
  0.00000320311309  -0.00000074877344   0.15681618542667
 -0.00000042197067  -0.00000045789912   0.94776281887718
  0.00000258233755   0.00000057395779  -0.16192628860743
Time for calculating nonlocal force components: 24.046 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000017037422  -0.00000001902653   0.02130605572188
[0m[32m -0.00000007892635  -0.00000001110628   0.01559360343614
[0m[32m  0.00000003813170   0.00000000975580  -0.00523931016598
[0mTime for calculating XC forces components: 17.903 ms
 Cartesian force = 
 -0.00000139932221   0.00443918734661  -0.00408337167246
 -0.00000146247793  -0.00443782003112  -0.00408329282314
  0.00000270104093  -0.00000003408590  -0.00835900146326
 -0.00000270312437  -0.00000163768037   0.00449438753221
  0.00000286388357   0.00000030445078   0.01203127842664
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Time for printing density: 395.183 ms
The program took 618.861 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:04
Job ID:        2266443
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:06:24,vmem=8372K,walltime=00:10:32,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-4-2
---------------------------------------
