---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:32
Job ID:    2266429
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:38
Job ID:    2266429
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.073 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 20.194 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 12.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 22.635 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 95.263 ms

Freeing SPARC_INPUT_MPI datatype took 0.007 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.990 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.081 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.401868	   12.559333	   11.662895	
   10.401868	   12.559333	    8.337105	
   10.649286	    7.821880	   11.658322	
   10.649286	    7.821880	    8.341678	
   15.072823	    7.440667	   10.000000	
   14.715329	   10.308690	   11.669664	
   14.715329	   10.308690	    8.330336	
    7.106694	   11.163804	   10.000000	
    9.868151	   11.456959	   10.000000	
   11.239015	    8.901120	   10.000000	
   14.101757	    9.259247	   10.000000	
    4.927177	   10.883285	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.171 ms
Set up communicators.

--set up spincomm took 3.159 ms

--set up kptcomm took 0.341 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.142 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.319 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.421 ms

Calculate_SplineDerivRadFun took 0.196 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.812 ms.
time spent on vectorized spline interp: 2.886 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.595 ms.
time spent on vectorized spline interp: 1.763 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.475 ms.
time spent on vectorized spline interp: 1.697 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.351 ms.

Calculating rb for all atom types took 16.590 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.062 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000351399, sum_int_rho = 27.2918577013655
PosCharge = 28.000000035140, NegCharge = -27.291857701365, scal_fac = 1.025947018394
After scaling, int_rho = 28.0000000351398, PosCharge + NegCharge - NetCharge = 1.243e-13
--Calculate Vref took 0.543 ms
--Calculate rho_guess took 3.005 ms

 integral of b = -28.0000000351399,
 int{b} + Nelectron + NetCharge = -3.514e-08,
 Esc = -68.1483010176427,
 MPI_Reduce took 12.419 ms

Calculating b & b_ref took 23.180 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.123 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.133 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.075 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.621 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.821 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003514005, int_b + int_rho = 3.347e-13, checking this took 0.190 ms
2-norm of RHS = 814.7858647496917, which took 0.481 ms

iter_count = 420, r_2norm = 7.127e-04, tol*||rhs|| = 8.148e-04

Anderson update took 210.568 ms, out of which F'*F took 104.017 ms; b-Ax took 698.417 ms, out of which Lap took 629.858 ms
Solving Poisson took 1431.045 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.427 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.775 ms
Total time for convolution: 	 convolve: 5.139298 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.518 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.827 ms
Total time for convolution: 	 convolve: 5.141940 
Total time for convolution: 	 convolve: 5.135762 
Total time for convolution: 	 convolve: 5.116279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.982 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.461 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, XC calculation took 24369.670 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 5.151 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.349 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.680 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.176 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.652 ms
    Lanczos iter 52, eigmin  = -0.882387257, eigmax = 264.919773067, err_eigmin = 5.508e-04, err_eigmax = 9.984e-03
rank =   0, Lanczos took 109.812 ms, eigmin = -0.882387256577, eigmax = 267.568970797378

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.293292, lowerbound = -0.982387, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1598.543 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.254 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.997 ms
rank =  0, finding HY took 25.840 ms
rank =  0, distributing HY into block cyclic form took 20.484 ms
rank =  0, finding Y'*HY took 4.537 ms
Rank 0, Project_Hamiltonian used 74.318 ms
Total time for projection: 74.328 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.764 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.862 ms
    first calculated eigval = 2.703782054105799
    last  calculated eigval = 3.268061329698273
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.83626474567972
lambda[   6] =   2.86628498101606
lambda[   7] =   2.90095519704100
lambda[   8] =   2.93767242025583
lambda[   9] =   2.93891487938431
lambda[  10] =   2.97513323524863
lambda[  11] =   2.98933821946392
lambda[  12] =   3.00704613792450
lambda[  13] =   3.02869591181262
lambda[  14] =   3.03808230062024
lambda[  15] =   3.08298949532254
lambda[  16] =   3.10197361766335
lambda[  17] =   3.13770624889998
lambda[  18] =   3.15500009051019
lambda[  19] =   3.18302764061651
lambda[  20] =   3.22147726832169
lambda[  21] =   3.26806132969827
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.876 ms
rank =  0, subspace rotation using ScaLAPACK took 8.529 ms
rank =  0, Distributing orbital back into band + domain format took 18.893 ms
rank = 0, Subspace_Rotation used 27.433 ms

Total time for subspace rotation: 27.436 ms
rank = 0, Efermi =   3.060537224565 calculate fermi energy took 0.048 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.368061, lowerbound = -0.982387, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1531.069 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 68.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.541 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 71.195 ms
rank =  0, finding HY took 25.424 ms
rank =  0, distributing HY into block cyclic form took 18.853 ms
rank =  0, finding Y'*HY took 4.045 ms
Rank 0, Project_Hamiltonian used 119.539 ms
Total time for projection: 119.544 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.110 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.739095372834096
    last  calculated eigval = 0.428156115934108
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.24985645159577
lambda[   6] =  -0.23698110919347
lambda[   7] =  -0.12803697356734
lambda[   8] =  -0.08618163517640
lambda[   9] =  -0.07885150053815
lambda[  10] =   0.00411369113391
lambda[  11] =   0.14620342382949
lambda[  12] =   0.20667452397620
lambda[  13] =   0.25983130612802
lambda[  14] =   0.27996964287024
lambda[  15] =   0.30721936325203
lambda[  16] =   0.33187763826343
lambda[  17] =   0.33487754742608
lambda[  18] =   0.34028151087599
lambda[  19] =   0.35974590240873
lambda[  20] =   0.40344741004394
lambda[  21] =   0.42815611593411
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 8.447 ms
rank =  0, Distributing orbital back into band + domain format took 18.348 ms
rank = 0, Subspace_Rotation used 26.804 ms

Total time for subspace rotation: 26.807 ms
rank = 0, Efermi =   0.293594506626 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.528156, lowerbound = -0.982387, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1536.049 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 63.991 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.450 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.458 ms
rank =  0, finding HY took 25.496 ms
rank =  0, distributing HY into block cyclic form took 18.870 ms
rank =  0, finding Y'*HY took 4.042 ms
Rank 0, Project_Hamiltonian used 115.364 ms
Total time for projection: 115.369 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.913390455159479
    last  calculated eigval = 0.121827710620625
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55028065601344
lambda[   6] =  -0.54400932684581
lambda[   7] =  -0.49844121287394
lambda[   8] =  -0.47130780258017
lambda[   9] =  -0.46008816909981
lambda[  10] =  -0.42507982491989
lambda[  11] =  -0.40387259392822
lambda[  12] =  -0.35737328764225
lambda[  13] =  -0.32031408498582
lambda[  14] =  -0.29784565084303
lambda[  15] =   0.02160088135989
lambda[  16] =   0.04222932533737
lambda[  17] =   0.04728304474691
lambda[  18] =   0.09619594072194
lambda[  19] =   0.11016145813893
lambda[  20] =   0.11754629255886
lambda[  21] =   0.12182771062062
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 8.474 ms
rank =  0, Distributing orbital back into band + domain format took 18.355 ms
rank = 0, Subspace_Rotation used 26.845 ms

Total time for subspace rotation: 26.850 ms
rank = 0, Efermi =  -0.007054504305 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.221828, lowerbound = -0.982387, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1536.841 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 64.264 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.463 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.747 ms
rank =  0, finding HY took 25.443 ms
rank =  0, distributing HY into block cyclic form took 18.889 ms
rank =  0, finding Y'*HY took 4.067 ms
Rank 0, Project_Hamiltonian used 115.168 ms
Total time for projection: 115.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.913672417361872
    last  calculated eigval = 0.083994981513684
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55361439423092
lambda[   6] =  -0.54671436729699
lambda[   7] =  -0.50684421873798
lambda[   8] =  -0.48038927972574
lambda[   9] =  -0.46783755288676
lambda[  10] =  -0.44237403836402
lambda[  11] =  -0.42218686552251
lambda[  12] =  -0.38255567547890
lambda[  13] =  -0.34725552449271
lambda[  14] =  -0.34415912269033
lambda[  15] =  -0.02703495030603
lambda[  16] =  -0.02256705456674
lambda[  17] =  -0.00793133150421
lambda[  18] =   0.03794130152006
lambda[  19] =   0.05204552934105
lambda[  20] =   0.06747780730440
lambda[  21] =   0.08399498151368
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 8.442 ms
rank =  0, Distributing orbital back into band + domain format took 18.420 ms
rank = 0, Subspace_Rotation used 27.749 ms

Total time for subspace rotation: 27.754 ms
rank = 0, Efermi =  -0.055695130330 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 8.308 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.831 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 6871.397 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.873 ms
rank = 0, D2D took 1.977 ms
rank = 0, Transfering density took 1.981 ms
Etot    =   -38.794912953973
Eband   =   -15.439569671511
E1      =    31.747706592834
E2      =   -11.433168587886
E3      =   -14.988670052233
Exc     =   -13.376587496733
Esc     =   -68.148301017643
Entropy =    -0.000000001039
dE = 3.233e+00, dEband = 1.287e+00
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -38.794912954, dEtot = 3.233e+00, dEband = 1.287e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.5868715656651, which took 1.423 ms

iter_count = 96, r_2norm = 1.914e-03, tol*||rhs|| = 2.063e-03

Anderson update took 46.064 ms, out of which F'*F took 23.678 ms; b-Ax took 160.338 ms, out of which Lap took 143.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 332.088 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513975, int_b + int_rho = 4.366e-14, checking this took 0.091 ms
2-norm of RHS = 809.9037993096663, which took 0.108 ms

iter_count = 288, r_2norm = 6.892e-04, tol*||rhs|| = 8.099e-04

Anderson update took 151.709 ms, out of which F'*F took 81.606 ms; b-Ax took 484.293 ms, out of which Lap took 436.685 ms
Solving Poisson took 999.503 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.412 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.193215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.907 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.210268 
Total time for convolution: 	 convolve: 5.202341 
Total time for convolution: 	 convolve: 5.170539 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.171 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.573 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.208 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.811 ms

This SCF took 33066.155 ms, scf error = 2.040e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.183995, lowerbound = -0.913672, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1562.942 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.694 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.501 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.210 ms
rank =  0, finding HY took 25.921 ms
rank =  0, distributing HY into block cyclic form took 19.338 ms
rank =  0, finding Y'*HY took 4.016 ms
Rank 0, Project_Hamiltonian used 70.509 ms
Total time for projection: 70.519 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.880837088779161
    last  calculated eigval = 0.069027903582243
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52826605654043
lambda[   6] =  -0.51609596832200
lambda[   7] =  -0.47353468091530
lambda[   8] =  -0.45076488040050
lambda[   9] =  -0.43143209230169
lambda[  10] =  -0.40994681411005
lambda[  11] =  -0.39322205212123
lambda[  12] =  -0.35290096524665
lambda[  13] =  -0.32654110148192
lambda[  14] =  -0.32435557089366
lambda[  15] =  -0.03806075990152
lambda[  16] =  -0.02699319097476
lambda[  17] =  -0.02119122399992
lambda[  18] =   0.01315753180947
lambda[  19] =   0.02763638551073
lambda[  20] =   0.04334671304408
lambda[  21] =   0.06902790358224
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 8.895 ms
rank =  0, Distributing orbital back into band + domain format took 18.370 ms
rank = 0, Subspace_Rotation used 27.281 ms

Total time for subspace rotation: 27.303 ms
rank = 0, Efermi =  -0.066716146092 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.998 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.372 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1678.465 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.937 ms
rank = 0, D2D took 2.063 ms
rank = 0, Transfering density took 2.070 ms
Etot    =   -38.709874234802
Eband   =   -14.595123918497
E1      =    30.993545235802
E2      =   -11.386960106472
E3      =   -15.212483102781
Exc     =   -13.559437742679
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 7.087e-03, dEband = 7.037e-02
rank = 0, Calculating/Estimating energy took 0.885 ms, Etot = -38.709874235, dEtot = 7.087e-03, dEband = 7.037e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.6676893381001, which took 0.051 ms

iter_count = 102, r_2norm = 6.814e-04, tol*||rhs|| = 7.867e-04

Anderson update took 49.275 ms, out of which F'*F took 25.569 ms; b-Ax took 170.120 ms, out of which Lap took 153.256 ms
rank = 0, Mixing (+ precond) took 354.175 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513982, int_b + int_rho = 1.055e-13, checking this took 0.087 ms
2-norm of RHS = 803.0413118809533, which took 0.101 ms

iter_count = 306, r_2norm = 6.606e-04, tol*||rhs|| = 8.030e-04

Anderson update took 143.563 ms, out of which F'*F took 75.378 ms; b-Ax took 508.294 ms, out of which Lap took 453.718 ms
Solving Poisson took 1031.716 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.162102 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.607 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.173268 
Total time for convolution: 	 convolve: 5.146828 
Total time for convolution: 	 convolve: 5.185993 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.412 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.599 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.187 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.821 ms

This SCF took 27899.141 ms, scf error = 1.404e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169028, lowerbound = -0.880837, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1555.349 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.791 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.169 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.972 ms
rank =  0, finding HY took 26.283 ms
rank =  0, distributing HY into block cyclic form took 18.761 ms
rank =  0, finding Y'*HY took 4.060 ms
Rank 0, Project_Hamiltonian used 71.100 ms
Total time for projection: 71.109 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.831025109862527
    last  calculated eigval = 0.061451829409504
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48461664934874
lambda[   6] =  -0.46553806424957
lambda[   7] =  -0.41768270119978
lambda[   8] =  -0.39896880171075
lambda[   9] =  -0.37004253680973
lambda[  10] =  -0.35252154023407
lambda[  11] =  -0.33964931575810
lambda[  12] =  -0.31312827532865
lambda[  13] =  -0.29382162120652
lambda[  14] =  -0.29364504347455
lambda[  15] =  -0.03450246451572
lambda[  16] =  -0.01049915990512
lambda[  17] =  -0.00831849105627
lambda[  18] =   0.00878643725549
lambda[  19] =   0.02104614251073
lambda[  20] =   0.03245365817334
lambda[  21] =   0.06145182940950
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 8.982 ms
rank =  0, Distributing orbital back into band + domain format took 18.429 ms
rank = 0, Subspace_Rotation used 27.428 ms

Total time for subspace rotation: 27.433 ms
rank = 0, Efermi =  -0.063157850137 calculate fermi energy took 0.136 ms
rank = 0, --- Calculate rho: sum over local bands took 5.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.738 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1671.552 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.931 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.071 ms
Etot    =   -38.641703975284
Eband   =   -13.190585864880
E1      =    29.776452005416
E2      =   -11.187100634827
E3      =   -15.644812602298
Exc     =   -13.911182334264
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 5.681e-03, dEband = 1.170e-01
rank = 0, Calculating/Estimating energy took 0.884 ms, Etot = -38.641703975, dEtot = 5.681e-03, dEband = 1.170e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.9075051296330, which took 0.054 ms

iter_count = 108, r_2norm = 1.697e-04, tol*||rhs|| = 2.363e-04

Anderson update took 51.577 ms, out of which F'*F took 27.009 ms; b-Ax took 181.740 ms, out of which Lap took 163.288 ms
rank = 0, Mixing (+ precond) took 375.467 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513979, int_b + int_rho = 8.004e-14, checking this took 0.089 ms
2-norm of RHS = 802.3878546402096, which took 0.102 ms

iter_count = 276, r_2norm = 7.231e-04, tol*||rhs|| = 8.024e-04

Anderson update took 133.783 ms, out of which F'*F took 68.187 ms; b-Ax took 458.887 ms, out of which Lap took 409.773 ms
Solving Poisson took 934.438 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.249928 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.566 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.174285 
Total time for convolution: 	 convolve: 5.158954 
Total time for convolution: 	 convolve: 5.168373 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.897 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.571 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.173 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.771 ms

This SCF took 27777.767 ms, scf error = 4.867e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.161452, lowerbound = -0.831025, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1562.125 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.725 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.271 ms
rank =  0, finding HY took 25.560 ms
rank =  0, distributing HY into block cyclic form took 18.821 ms
rank =  0, finding Y'*HY took 4.119 ms
Rank 0, Project_Hamiltonian used 69.793 ms
Total time for projection: 69.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.659 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.314 ms
rank = 0, Solve_Generalized_EigenProblem used 0.980 ms
    first calculated eigval = -0.821773352096207
    last  calculated eigval = 0.054283074779416
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47115399164950
lambda[   6] =  -0.45081351697586
lambda[   7] =  -0.40251333507846
lambda[   8] =  -0.38374639407066
lambda[   9] =  -0.35532000405833
lambda[  10] =  -0.33627386541876
lambda[  11] =  -0.32255764218085
lambda[  12] =  -0.30770635924053
lambda[  13] =  -0.28727928134679
lambda[  14] =  -0.28703755179991
lambda[  15] =  -0.03401997176836
lambda[  16] =  -0.00653109837752
lambda[  17] =  -0.00457039321511
lambda[  18] =   0.00897158054001
lambda[  19] =   0.01566297062165
lambda[  20] =   0.02736296494432
lambda[  21] =   0.05428307477942
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.558 ms
rank =  0, subspace rotation using ScaLAPACK took 8.363 ms
rank =  0, Distributing orbital back into band + domain format took 18.379 ms
rank = 0, Subspace_Rotation used 26.753 ms

Total time for subspace rotation: 26.757 ms
rank = 0, Efermi =  -0.062675357384 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.925 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.484 ms
rank = 0, Calculating density took 1678.263 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.099 ms
rank = 0, D2D took 2.216 ms
rank = 0, Transfering density took 2.223 ms
Etot    =   -38.634563145069
Eband   =   -12.827761929812
E1      =    29.518602841199
E2      =   -11.060459156935
E3      =   -15.776772261865
Exc     =   -14.014334456575
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 5.951e-04, dEband = 3.024e-02
rank = 0, Calculating/Estimating energy took 0.850 ms, Etot = -38.634563145, dEtot = 5.951e-04, dEband = 3.024e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7372727149851, which took 0.054 ms

iter_count = 108, r_2norm = 9.003e-05, tol*||rhs|| = 1.095e-04

Anderson update took 51.414 ms, out of which F'*F took 26.860 ms; b-Ax took 179.633 ms, out of which Lap took 161.496 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.779 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513978, int_b + int_rho = 7.276e-14, checking this took 0.092 ms
2-norm of RHS = 802.8358926755493, which took 0.128 ms

iter_count = 258, r_2norm = 7.965e-04, tol*||rhs|| = 8.028e-04

Anderson update took 121.437 ms, out of which F'*F took 63.129 ms; b-Ax took 425.549 ms, out of which Lap took 380.761 ms
Solving Poisson took 869.524 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.204121 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.114 ms
Total time for convolution: 	 convolve: 5.160268 
Total time for convolution: 	 convolve: 5.165298 
Total time for convolution: 	 convolve: 5.153310 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.570 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.891 ms

This SCF took 27581.178 ms, scf error = 1.902e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.154283, lowerbound = -0.821773, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.800 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.166 ms
rank =  0, finding HY took 25.654 ms
rank =  0, distributing HY into block cyclic form took 18.758 ms
rank =  0, finding Y'*HY took 4.176 ms
Rank 0, Project_Hamiltonian used 70.782 ms
Total time for projection: 70.795 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.239 ms
rank = 0, Solve_Generalized_EigenProblem used 0.373 ms
    first calculated eigval = -0.817610894491201
    last  calculated eigval = 0.047588082655863
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46707373492720
lambda[   6] =  -0.44510482007995
lambda[   7] =  -0.39665107445844
lambda[   8] =  -0.37734176719838
lambda[   9] =  -0.34917558475091
lambda[  10] =  -0.32925787062094
lambda[  11] =  -0.31473774078837
lambda[  12] =  -0.30057030588345
lambda[  13] =  -0.28300458682165
lambda[  14] =  -0.28265636738470
lambda[  15] =  -0.03349608549367
lambda[  16] =  -0.00343518849086
lambda[  17] =  -0.00222969126709
lambda[  18] =   0.01011843467881
lambda[  19] =   0.01315601617821
lambda[  20] =   0.02575092135538
lambda[  21] =   0.04758808265586
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.383 ms
rank =  0, subspace rotation using ScaLAPACK took 8.414 ms
rank =  0, Distributing orbital back into band + domain format took 18.331 ms
rank = 0, Subspace_Rotation used 26.756 ms

Total time for subspace rotation: 26.760 ms
rank = 0, Efermi =  -0.062151471130 calculate fermi energy took 0.723 ms
rank = 0, --- Calculate rho: sum over local bands took 5.383 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.861 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 1684.407 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.916 ms
rank = 0, D2D took 2.028 ms
rank = 0, Transfering density took 2.033 ms
Etot    =   -38.632407332593
Eband   =   -12.666459225225
E1      =    29.441633184020
E2      =   -10.962553455150
E3      =   -15.833552603665
Exc     =   -14.055386331521
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 1.797e-04, dEband = 1.344e-02
rank = 0, Calculating/Estimating energy took 0.884 ms, Etot = -38.632407333, dEtot = 1.797e-04, dEband = 1.344e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1421760419241, which took 0.153 ms

iter_count = 114, r_2norm = 3.044e-05, tol*||rhs|| = 4.569e-05

Anderson update took 53.813 ms, out of which F'*F took 27.967 ms; b-Ax took 188.188 ms, out of which Lap took 168.778 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 392.176 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513978, int_b + int_rho = 7.640e-14, checking this took 0.105 ms
2-norm of RHS = 802.9904035153913, which took 0.111 ms

iter_count = 210, r_2norm = 8.006e-04, tol*||rhs|| = 8.030e-04

Anderson update took 100.399 ms, out of which F'*F took 51.864 ms; b-Ax took 351.160 ms, out of which Lap took 316.706 ms
Solving Poisson took 712.068 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.125 ms
Total time for convolution: 	 convolve: 5.149251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.293758 
Total time for convolution: 	 convolve: 5.176400 
Total time for convolution: 	 convolve: 5.152763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
---Transfer Veff_loc: D2D took 3.578 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.631 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.243 ms

This SCF took 27599.909 ms, scf error = 6.756e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147588, lowerbound = -0.817611, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.356 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.761 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.558 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.334 ms
rank =  0, finding HY took 25.620 ms
rank =  0, distributing HY into block cyclic form took 18.673 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 69.678 ms
Total time for projection: 69.689 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.817579731163231
    last  calculated eigval = 0.039445407600001
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46603432581684
lambda[   6] =  -0.44410656422800
lambda[   7] =  -0.39541013800876
lambda[   8] =  -0.37614059260223
lambda[   9] =  -0.34774246970886
lambda[  10] =  -0.32790310922364
lambda[  11] =  -0.31351385819913
lambda[  12] =  -0.30063541070071
lambda[  13] =  -0.28281340311698
lambda[  14] =  -0.28231725058429
lambda[  15] =  -0.03375123334782
lambda[  16] =  -0.00335901087986
lambda[  17] =  -0.00225110733247
lambda[  18] =   0.01014026496215
lambda[  19] =   0.01131174413741
lambda[  20] =   0.02319946358981
lambda[  21] =   0.03944540760000
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 8.364 ms
rank =  0, Distributing orbital back into band + domain format took 18.471 ms
rank = 0, Subspace_Rotation used 26.846 ms

Total time for subspace rotation: 26.850 ms
rank = 0, Efermi =  -0.062406618921 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.236 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1680.218 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.897 ms
rank = 0, D2D took 2.007 ms
rank = 0, Transfering density took 2.009 ms
Etot    =   -38.632190021952
Eband   =   -12.640696877395
E1      =    29.432029339654
E2      =   -10.945454091228
E3      =   -15.836597590705
Exc     =   -14.057273147464
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 1.811e-05, dEband = 2.147e-03
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -38.632190022, dEtot = 1.811e-05, dEband = 2.147e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4673606201499, which took 0.084 ms

iter_count = 114, r_2norm = 1.359e-05, tol*||rhs|| = 1.869e-05

Anderson update took 54.777 ms, out of which F'*F took 28.251 ms; b-Ax took 190.195 ms, out of which Lap took 170.643 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.051 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513981, int_b + int_rho = 9.823e-14, checking this took 0.092 ms
2-norm of RHS = 803.4164151919973, which took 0.103 ms

iter_count = 246, r_2norm = 7.597e-04, tol*||rhs|| = 8.034e-04

Anderson update took 117.789 ms, out of which F'*F took 61.606 ms; b-Ax took 412.822 ms, out of which Lap took 372.393 ms
Solving Poisson took 836.317 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.166833 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.619 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.157950 
Total time for convolution: 	 convolve: 5.159194 
Total time for convolution: 	 convolve: 5.167861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 4.342 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.807 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.186 ms

This SCF took 27552.802 ms, scf error = 5.126e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.139445, lowerbound = -0.817580, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1563.846 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.872 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.463 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.348 ms
rank =  0, finding HY took 25.777 ms
rank =  0, distributing HY into block cyclic form took 18.746 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 69.924 ms
Total time for projection: 69.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.246 ms
    first calculated eigval = -0.815202416036786
    last  calculated eigval = 0.032691502505888
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46214854171347
lambda[   6] =  -0.43985266662363
lambda[   7] =  -0.39013125119133
lambda[   8] =  -0.37087988170993
lambda[   9] =  -0.34147068513588
lambda[  10] =  -0.32182553877904
lambda[  11] =  -0.30781368794939
lambda[  12] =  -0.29720775308033
lambda[  13] =  -0.28032629339603
lambda[  14] =  -0.27924057994037
lambda[  15] =  -0.03239448290234
lambda[  16] =  -0.00052633781414
lambda[  17] =  -0.00028461144255
lambda[  18] =   0.01178795892097
lambda[  19] =   0.01237453141685
lambda[  20] =   0.02253320585812
lambda[  21] =   0.03269150250589
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 8.368 ms
rank =  0, Distributing orbital back into band + domain format took 18.372 ms
rank = 0, Subspace_Rotation used 26.750 ms

Total time for subspace rotation: 26.755 ms
rank = 0, Efermi =  -0.061049868544 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.436 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.780 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1677.811 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.900 ms
rank = 0, D2D took 2.013 ms
rank = 0, Transfering density took 2.016 ms
Etot    =   -38.631447974444
Eband   =   -12.511314056723
E1      =    29.370404805370
E2      =   -10.871168552867
E3      =   -15.860696695975
Exc     =   -14.074102953252
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 6.184e-05, dEband = 1.078e-02
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -38.631447974, dEtot = 6.184e-05, dEband = 1.078e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2510004517455, which took 0.113 ms

iter_count = 114, r_2norm = 7.203e-06, tol*||rhs|| = 1.004e-05

Anderson update took 54.731 ms, out of which F'*F took 28.260 ms; b-Ax took 191.149 ms, out of which Lap took 172.055 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.504 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513998, int_b + int_rho = 2.656e-13, checking this took 0.074 ms
2-norm of RHS = 803.4493557461033, which took 0.123 ms

iter_count = 228, r_2norm = 7.589e-04, tol*||rhs|| = 8.034e-04

Anderson update took 109.035 ms, out of which F'*F took 56.491 ms; b-Ax took 386.578 ms, out of which Lap took 349.157 ms
Solving Poisson took 775.464 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.437791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.184920 
Total time for convolution: 	 convolve: 5.217324 
Total time for convolution: 	 convolve: 5.243677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.596 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
---Transfer Veff_loc: D2D took 3.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.646 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.258 ms

This SCF took 27928.287 ms, scf error = 2.370e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.132692, lowerbound = -0.815202, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1561.658 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.864 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.447 ms
rank =  0, finding HY took 25.739 ms
rank =  0, distributing HY into block cyclic form took 18.785 ms
rank =  0, finding Y'*HY took 4.031 ms
Rank 0, Project_Hamiltonian used 70.025 ms
Total time for projection: 70.037 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.121 ms
rank = 0, Solve_Generalized_EigenProblem used 0.255 ms
    first calculated eigval = -0.813112108611663
    last  calculated eigval = 0.026838356634280
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46013490474009
lambda[   6] =  -0.43783726109136
lambda[   7] =  -0.38757065534461
lambda[   8] =  -0.36836463266360
lambda[   9] =  -0.33847586677330
lambda[  10] =  -0.31887154629378
lambda[  11] =  -0.30500734613187
lambda[  12] =  -0.29507187840221
lambda[  13] =  -0.27862841942640
lambda[  14] =  -0.27723229437617
lambda[  15] =  -0.03092464781058
lambda[  16] =   0.00103375965393
lambda[  17] =   0.00120072873196
lambda[  18] =   0.01381396087866
lambda[  19] =   0.01428014123780
lambda[  20] =   0.02288672751396
lambda[  21] =   0.02683835663428
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 8.351 ms
rank =  0, Distributing orbital back into band + domain format took 18.345 ms
rank = 0, Subspace_Rotation used 26.706 ms

Total time for subspace rotation: 26.711 ms
rank = 0, Efermi =  -0.059580033428 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.199 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.070 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 1675.646 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.868 ms
rank = 0, D2D took 2.000 ms
rank = 0, Transfering density took 2.002 ms
Etot    =   -38.631288124173
Eband   =   -12.443788341925
E1      =    29.335189454973
E2      =   -10.836828963002
E3      =   -15.868565361089
Exc     =   -14.079782542632
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 1.332e-05, dEband = 5.627e-03
rank = 0, Calculating/Estimating energy took 1.758 ms, Etot = -38.631288124, dEtot = 1.332e-05, dEband = 5.627e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1863455796464, which took 0.097 ms

iter_count = 114, r_2norm = 6.112e-06, tol*||rhs|| = 7.454e-06

Anderson update took 54.343 ms, out of which F'*F took 28.297 ms; b-Ax took 189.892 ms, out of which Lap took 170.267 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 391.482 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513973, int_b + int_rho = 2.547e-14, checking this took 0.094 ms
2-norm of RHS = 803.4458310385279, which took 0.137 ms

iter_count = 198, r_2norm = 7.038e-04, tol*||rhs|| = 8.034e-04

Anderson update took 94.661 ms, out of which F'*F took 49.606 ms; b-Ax took 332.605 ms, out of which Lap took 299.565 ms
Solving Poisson took 671.776 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.151556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.238528 
Total time for convolution: 	 convolve: 5.185429 
Total time for convolution: 	 convolve: 5.235255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.588 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.621 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.244 ms

This SCF took 27569.867 ms, scf error = 1.302e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126838, lowerbound = -0.813112, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.642 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.789 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.598 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.402 ms
rank =  0, finding HY took 25.680 ms
rank =  0, distributing HY into block cyclic form took 19.030 ms
rank =  0, finding Y'*HY took 3.996 ms
Rank 0, Project_Hamiltonian used 70.135 ms
Total time for projection: 70.145 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.812513921837143
    last  calculated eigval = 0.023715731150539
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45946961263581
lambda[   6] =  -0.43714379385163
lambda[   7] =  -0.38677327898366
lambda[   8] =  -0.36751595837295
lambda[   9] =  -0.33758964023244
lambda[  10] =  -0.31794887906863
lambda[  11] =  -0.30408838013780
lambda[  12] =  -0.29444148957369
lambda[  13] =  -0.27806411040605
lambda[  14] =  -0.27661431716588
lambda[  15] =  -0.03018583492156
lambda[  16] =   0.00162910973687
lambda[  17] =   0.00174664579213
lambda[  18] =   0.01456240491116
lambda[  19] =   0.01507038279026
lambda[  20] =   0.02243723936643
lambda[  21] =   0.02371573115054
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 8.353 ms
rank =  0, Distributing orbital back into band + domain format took 18.363 ms
rank = 0, Subspace_Rotation used 26.725 ms

Total time for subspace rotation: 26.729 ms
rank = 0, Efermi =  -0.058841220518 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.203 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.079 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1680.756 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 3.045 ms
rank = 0, D2D took 3.149 ms
rank = 0, Transfering density took 3.153 ms
Etot    =   -38.631330259075
Eband   =   -12.422615288328
E1      =    29.324855741546
E2      =   -10.825383103684
E3      =   -15.870767353093
Exc     =   -14.081420150389
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 3.511e-06, dEband = 1.764e-03
rank = 0, Calculating/Estimating energy took 0.966 ms, Etot = -38.631330259, dEtot = 3.511e-06, dEband = 1.764e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1021421093114, which took 0.121 ms

iter_count = 114, r_2norm = 3.116e-06, tol*||rhs|| = 4.086e-06

Anderson update took 54.732 ms, out of which F'*F took 28.188 ms; b-Ax took 189.883 ms, out of which Lap took 170.783 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.118 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513979, int_b + int_rho = 8.004e-14, checking this took 0.110 ms
2-norm of RHS = 803.4248574578253, which took 0.108 ms

iter_count = 210, r_2norm = 6.803e-04, tol*||rhs|| = 8.034e-04

Anderson update took 101.189 ms, out of which F'*F took 52.257 ms; b-Ax took 349.984 ms, out of which Lap took 315.520 ms
Solving Poisson took 709.006 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.235312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.166895 
Total time for convolution: 	 convolve: 5.167884 
Total time for convolution: 	 convolve: 5.200256 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.565 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.567 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.625 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.227 ms

This SCF took 27524.655 ms, scf error = 9.900e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.123716, lowerbound = -0.812514, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1566.332 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.770 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.558 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.343 ms
rank =  0, finding HY took 25.785 ms
rank =  0, distributing HY into block cyclic form took 18.576 ms
rank =  0, finding Y'*HY took 4.060 ms
Rank 0, Project_Hamiltonian used 69.791 ms
Total time for projection: 69.801 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.124 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.811704155543722
    last  calculated eigval = 0.025250195607884
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45845793662412
lambda[   6] =  -0.43606595360142
lambda[   7] =  -0.38551268843371
lambda[   8] =  -0.36617974066803
lambda[   9] =  -0.33615237454646
lambda[  10] =  -0.31647913909389
lambda[  11] =  -0.30266611393401
lambda[  12] =  -0.29354002349923
lambda[  13] =  -0.27723865457522
lambda[  14] =  -0.27568944585115
lambda[  15] =  -0.02706428266990
lambda[  16] =   0.00270741299901
lambda[  17] =   0.00339637282940
lambda[  18] =   0.01782910206126
lambda[  19] =   0.01860817844744
lambda[  20] =   0.02318484855912
lambda[  21] =   0.02525019560788
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 8.369 ms
rank =  0, Distributing orbital back into band + domain format took 18.338 ms
rank = 0, Subspace_Rotation used 26.718 ms

Total time for subspace rotation: 26.722 ms
rank = 0, Efermi =  -0.055719668299 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.450 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1680.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.896 ms
rank = 0, D2D took 2.017 ms
rank = 0, Transfering density took 2.023 ms
Etot    =   -38.631377646591
Eband   =   -12.389933370731
E1      =    29.308918185790
E2      =   -10.808265949611
E3      =   -15.872518412920
Exc     =   -14.082845805501
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 3.949e-06, dEband = 2.723e-03
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -38.631377647, dEtot = 3.949e-06, dEband = 2.723e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0790935702204, which took 0.056 ms

iter_count = 114, r_2norm = 2.585e-06, tol*||rhs|| = 3.164e-06

Anderson update took 54.325 ms, out of which F'*F took 28.432 ms; b-Ax took 190.652 ms, out of which Lap took 171.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.233 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513980, int_b + int_rho = 8.731e-14, checking this took 0.106 ms
2-norm of RHS = 803.4256459285833, which took 0.137 ms

iter_count = 174, r_2norm = 6.783e-04, tol*||rhs|| = 8.034e-04

Anderson update took 83.784 ms, out of which F'*F took 43.420 ms; b-Ax took 292.129 ms, out of which Lap took 263.166 ms
Solving Poisson took 589.865 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.144996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.944 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.153092 
Total time for convolution: 	 convolve: 5.196781 
Total time for convolution: 	 convolve: 5.240370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.565 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.599 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.615 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.255 ms

This SCF took 27460.861 ms, scf error = 6.132e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.125250, lowerbound = -0.811704, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1564.509 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.995 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.533 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.543 ms
rank =  0, finding HY took 25.885 ms
rank =  0, distributing HY into block cyclic form took 18.861 ms
rank =  0, finding Y'*HY took 4.056 ms
Rank 0, Project_Hamiltonian used 70.370 ms
Total time for projection: 70.380 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.124 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.811340853069023
    last  calculated eigval = 0.024588532055448
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45801320252837
lambda[   6] =  -0.43558563184802
lambda[   7] =  -0.38496908843345
lambda[   8] =  -0.36565000278654
lambda[   9] =  -0.33555620082032
lambda[  10] =  -0.31587819929638
lambda[  11] =  -0.30208484156497
lambda[  12] =  -0.29313211465199
lambda[  13] =  -0.27688392133540
lambda[  14] =  -0.27528293189155
lambda[  15] =  -0.02646719361793
lambda[  16] =   0.00275845920124
lambda[  17] =   0.00380570975317
lambda[  18] =   0.01762410572192
lambda[  19] =   0.01924796953020
lambda[  20] =   0.02311898806025
lambda[  21] =   0.02458853205545
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.293 ms
rank =  0, subspace rotation using ScaLAPACK took 8.526 ms
rank =  0, Distributing orbital back into band + domain format took 19.024 ms
rank = 0, Subspace_Rotation used 27.565 ms

Total time for subspace rotation: 27.570 ms
rank = 0, Efermi =  -0.055122579244 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.426 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1680.014 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.885 ms
rank = 0, D2D took 1.994 ms
rank = 0, Transfering density took 2.000 ms
Etot    =   -38.631476484174
Eband   =   -12.375918207716
E1      =    29.301277013714
E2      =   -10.801503889865
E3      =   -15.873968006265
Exc     =   -14.084006167619
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 8.236e-06, dEband = 1.168e-03
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -38.631476484, dEtot = 8.236e-06, dEband = 1.168e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0742314144441, which took 0.055 ms

iter_count = 114, r_2norm = 1.927e-06, tol*||rhs|| = 2.969e-06

Anderson update took 54.467 ms, out of which F'*F took 28.384 ms; b-Ax took 190.876 ms, out of which Lap took 171.561 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513979, int_b + int_rho = 8.004e-14, checking this took 0.104 ms
2-norm of RHS = 803.4293480533336, which took 0.111 ms

iter_count = 174, r_2norm = 6.854e-04, tol*||rhs|| = 8.034e-04

Anderson update took 83.514 ms, out of which F'*F took 43.584 ms; b-Ax took 290.675 ms, out of which Lap took 261.789 ms
Solving Poisson took 588.253 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.161322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.706 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.152149 
Total time for convolution: 	 convolve: 5.157862 
Total time for convolution: 	 convolve: 5.199792 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.166 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.587 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.613 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.234 ms

This SCF took 27345.110 ms, scf error = 4.715e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.124589, lowerbound = -0.811341, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1555.471 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.604 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.448 ms
rank =  0, finding HY took 25.841 ms
rank =  0, distributing HY into block cyclic form took 18.769 ms
rank =  0, finding Y'*HY took 4.021 ms
Rank 0, Project_Hamiltonian used 70.105 ms
Total time for projection: 70.114 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.119 ms
rank = 0, Solve_Generalized_EigenProblem used 0.254 ms
    first calculated eigval = -0.810906701280219
    last  calculated eigval = 0.025292194004137
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45748097607988
lambda[   6] =  -0.43505453499799
lambda[   7] =  -0.38442766873913
lambda[   8] =  -0.36512413451653
lambda[   9] =  -0.33501258947451
lambda[  10] =  -0.31533285859442
lambda[  11] =  -0.30154649156763
lambda[  12] =  -0.29272883940624
lambda[  13] =  -0.27645187884953
lambda[  14] =  -0.27482706091715
lambda[  15] =  -0.02528571700173
lambda[  16] =   0.00311470433584
lambda[  17] =   0.00439029439119
lambda[  18] =   0.01783301056066
lambda[  19] =   0.02025663559894
lambda[  20] =   0.02359300721002
lambda[  21] =   0.02529219400414
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.292 ms
rank =  0, subspace rotation using ScaLAPACK took 8.905 ms
rank =  0, Distributing orbital back into band + domain format took 18.353 ms
rank = 0, Subspace_Rotation used 27.273 ms

Total time for subspace rotation: 27.281 ms
rank = 0, Efermi =  -0.053941102629 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.214 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.065 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1670.742 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.883 ms
rank = 0, D2D took 2.001 ms
rank = 0, Transfering density took 2.007 ms
Etot    =   -38.631558367864
Eband   =   -12.361602160259
E1      =    29.293787071975
E2      =   -10.794355345088
E3      =   -15.875206866593
Exc     =   -14.085004472581
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 6.824e-06, dEband = 1.193e-03
rank = 0, Calculating/Estimating energy took 0.883 ms, Etot = -38.631558368, dEtot = 6.824e-06, dEband = 1.193e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0417984286745, which took 0.058 ms

iter_count = 114, r_2norm = 1.256e-06, tol*||rhs|| = 1.672e-06

Anderson update took 54.384 ms, out of which F'*F took 28.589 ms; b-Ax took 190.634 ms, out of which Lap took 171.569 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.408 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513979, int_b + int_rho = 8.004e-14, checking this took 0.104 ms
2-norm of RHS = 803.4390824052723, which took 0.115 ms

iter_count = 174, r_2norm = 7.237e-04, tol*||rhs|| = 8.034e-04

Anderson update took 83.536 ms, out of which F'*F took 43.444 ms; b-Ax took 292.749 ms, out of which Lap took 263.697 ms
Solving Poisson took 589.889 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.151202 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.212838 
Total time for convolution: 	 convolve: 5.201509 
Total time for convolution: 	 convolve: 5.200186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.576 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.614 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.225 ms

This SCF took 27432.583 ms, scf error = 3.556e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.125292, lowerbound = -0.810907, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1568.063 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.825 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.511 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.349 ms
rank =  0, finding HY took 25.672 ms
rank =  0, distributing HY into block cyclic form took 18.687 ms
rank =  0, finding Y'*HY took 4.023 ms
Rank 0, Project_Hamiltonian used 69.757 ms
Total time for projection: 69.766 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.121 ms
rank = 0, Solve_Generalized_EigenProblem used 0.839 ms
    first calculated eigval = -0.810316363503197
    last  calculated eigval = 0.027048033731508
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45691138582308
lambda[   6] =  -0.43452343266228
lambda[   7] =  -0.38392774969324
lambda[   8] =  -0.36464342626135
lambda[   9] =  -0.33454568958146
lambda[  10] =  -0.31487691249374
lambda[  11] =  -0.30108581441463
lambda[  12] =  -0.29222533330810
lambda[  13] =  -0.27589996035389
lambda[  14] =  -0.27428094438896
lambda[  15] =  -0.02383435336896
lambda[  16] =   0.00378293609757
lambda[  17] =   0.00500441323818
lambda[  18] =   0.01833074626504
lambda[  19] =   0.02135197874570
lambda[  20] =   0.02420955772593
lambda[  21] =   0.02704803373151
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.861 ms
rank =  0, subspace rotation using ScaLAPACK took 8.396 ms
rank =  0, Distributing orbital back into band + domain format took 18.330 ms
rank = 0, Subspace_Rotation used 27.311 ms

Total time for subspace rotation: 27.319 ms
rank = 0, Efermi =  -0.052489739002 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.469 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1682.951 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.894 ms
rank = 0, D2D took 1.994 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -38.631620813146
Eband   =   -12.347230003611
E1      =    29.286637105855
E2      =   -10.786826495826
E3      =   -15.876270486011
Exc     =   -14.085823878546
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 5.204e-06, dEband = 1.198e-03
rank = 0, Calculating/Estimating energy took 0.874 ms, Etot = -38.631620813, dEtot = 5.204e-06, dEband = 1.198e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0380348531366, which took 0.113 ms

iter_count = 114, r_2norm = 1.046e-06, tol*||rhs|| = 1.521e-06

Anderson update took 54.396 ms, out of which F'*F took 28.399 ms; b-Ax took 190.266 ms, out of which Lap took 170.829 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.240 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513978, int_b + int_rho = 7.276e-14, checking this took 0.092 ms
2-norm of RHS = 803.4445084079445, which took 0.083 ms

iter_count = 150, r_2norm = 7.085e-04, tol*||rhs|| = 8.034e-04

Anderson update took 72.225 ms, out of which F'*F took 37.425 ms; b-Ax took 250.597 ms, out of which Lap took 225.710 ms
Solving Poisson took 508.128 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.147217 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.742 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.175 ms
Total time for convolution: 	 convolve: 5.169302 
Total time for convolution: 	 convolve: 5.184458 
Total time for convolution: 	 convolve: 5.208267 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.507 ms

This SCF took 27329.657 ms, scf error = 2.252e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.127048, lowerbound = -0.810316, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.212 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.735 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.524 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.273 ms
rank =  0, finding HY took 25.882 ms
rank =  0, distributing HY into block cyclic form took 18.868 ms
rank =  0, finding Y'*HY took 4.036 ms
Rank 0, Project_Hamiltonian used 70.639 ms
Total time for projection: 70.651 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.129 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.810080286134391
    last  calculated eigval = 0.028205507207434
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45668889395407
lambda[   6] =  -0.43431009971992
lambda[   7] =  -0.38373004535726
lambda[   8] =  -0.36445207540129
lambda[   9] =  -0.33436203280604
lambda[  10] =  -0.31469620493769
lambda[  11] =  -0.30090121065894
lambda[  12] =  -0.29201872503349
lambda[  13] =  -0.27567330996949
lambda[  14] =  -0.27405954183030
lambda[  15] =  -0.02299039514131
lambda[  16] =   0.00407369778796
lambda[  17] =   0.00526643432042
lambda[  18] =   0.01850981291382
lambda[  19] =   0.02185039618549
lambda[  20] =   0.02449135402303
lambda[  21] =   0.02820550720743
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.283 ms
rank =  0, subspace rotation using ScaLAPACK took 8.382 ms
rank =  0, Distributing orbital back into band + domain format took 18.402 ms
rank = 0, Subspace_Rotation used 26.794 ms

Total time for subspace rotation: 26.799 ms
rank = 0, Efermi =  -0.051645780775 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.341 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.868 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1679.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.895 ms
rank = 0, D2D took 2.026 ms
rank = 0, Transfering density took 2.031 ms
Etot    =   -38.631651575470
Eband   =   -12.341502760644
E1      =    29.283975309388
E2      =   -10.783673700632
E3      =   -15.876508492594
Exc     =   -14.086005298760
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 2.564e-06, dEband = 4.773e-04
rank = 0, Calculating/Estimating energy took 0.875 ms, Etot = -38.631651575, dEtot = 2.564e-06, dEband = 4.773e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0230524277159, which took 0.114 ms

iter_count = 114, r_2norm = 5.858e-07, tol*||rhs|| = 9.221e-07

Anderson update took 54.497 ms, out of which F'*F took 28.537 ms; b-Ax took 191.436 ms, out of which Lap took 172.487 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.326 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513982, int_b + int_rho = 1.055e-13, checking this took 0.109 ms
2-norm of RHS = 803.4523914153185, which took 0.108 ms

iter_count = 156, r_2norm = 6.957e-04, tol*||rhs|| = 8.035e-04

Anderson update took 75.042 ms, out of which F'*F took 38.973 ms; b-Ax took 261.792 ms, out of which Lap took 235.428 ms
Solving Poisson took 528.550 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.141 ms
Total time for convolution: 	 convolve: 5.205257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.161444 
Total time for convolution: 	 convolve: 5.155516 
Total time for convolution: 	 convolve: 5.177313 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.629 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.833 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.500 ms

This SCF took 27268.966 ms, scf error = 1.727e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.128206, lowerbound = -0.810080, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1565.503 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.832 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.542 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.388 ms
rank =  0, finding HY took 25.753 ms
rank =  0, distributing HY into block cyclic form took 18.696 ms
rank =  0, finding Y'*HY took 4.017 ms
Rank 0, Project_Hamiltonian used 69.891 ms
Total time for projection: 69.902 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.256 ms
    first calculated eigval = -0.809914101533391
    last  calculated eigval = 0.030352402260981
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45652269116690
lambda[   6] =  -0.43413280564280
lambda[   7] =  -0.38356911627323
lambda[   8] =  -0.36428917078511
lambda[   9] =  -0.33421324205207
lambda[  10] =  -0.31454164831281
lambda[  11] =  -0.30073770249441
lambda[  12] =  -0.29184815258818
lambda[  13] =  -0.27549229899235
lambda[  14] =  -0.27388773713069
lambda[  15] =  -0.02194264523390
lambda[  16] =   0.00424782106288
lambda[  17] =   0.00546600408274
lambda[  18] =   0.01862030850016
lambda[  19] =   0.02203790145141
lambda[  20] =   0.02490278258855
lambda[  21] =   0.03035240226098
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.292 ms
rank =  0, subspace rotation using ScaLAPACK took 8.360 ms
rank =  0, Distributing orbital back into band + domain format took 18.360 ms
rank = 0, Subspace_Rotation used 26.730 ms

Total time for subspace rotation: 26.734 ms
rank = 0, Efermi =  -0.050598030848 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.910 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 1679.823 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.884 ms
rank = 0, D2D took 1.999 ms
rank = 0, Transfering density took 2.001 ms
Etot    =   -38.631695737348
Eband   =   -12.336907247173
E1      =    29.282244084135
E2      =   -10.780797067160
E3      =   -15.876362395129
Exc     =   -14.085891017919
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 3.680e-06, dEband = 3.830e-04
rank = 0, Calculating/Estimating energy took 0.889 ms, Etot = -38.631695737, dEtot = 3.680e-06, dEband = 3.830e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0198712742839, which took 0.058 ms

iter_count = 114, r_2norm = 5.445e-07, tol*||rhs|| = 7.949e-07

Anderson update took 54.056 ms, out of which F'*F took 30.029 ms; b-Ax took 192.196 ms, out of which Lap took 172.549 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.405 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513968, int_b + int_rho = -2.547e-14, checking this took 0.093 ms
2-norm of RHS = 803.4522769654781, which took 0.101 ms

iter_count = 96, r_2norm = 6.673e-04, tol*||rhs|| = 8.035e-04

Anderson update took 46.263 ms, out of which F'*F took 23.947 ms; b-Ax took 159.847 ms, out of which Lap took 143.901 ms
Solving Poisson took 326.024 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.222821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.144802 
Total time for convolution: 	 convolve: 5.162206 
Total time for convolution: 	 convolve: 5.163895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.553 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.182 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.302 ms

This SCF took 27063.703 ms, scf error = 1.154e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.130352, lowerbound = -0.809914, upperbound = 267.568971

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1569.219 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.896 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.533 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.441 ms
rank =  0, finding HY took 25.692 ms
rank =  0, distributing HY into block cyclic form took 18.658 ms
rank =  0, finding Y'*HY took 4.028 ms
Rank 0, Project_Hamiltonian used 69.844 ms
Total time for projection: 69.854 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.119 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.809886842745939
    last  calculated eigval = 0.030706165587538
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.45648905214015
lambda[   6] =  -0.43409905739022
lambda[   7] =  -0.38353263589201
lambda[   8] =  -0.36425332541380
lambda[   9] =  -0.33417526503849
lambda[  10] =  -0.31450420561098
lambda[  11] =  -0.30070194344213
lambda[  12] =  -0.29181508502973
lambda[  13] =  -0.27546452675612
lambda[  14] =  -0.27385821736865
lambda[  15] =  -0.02161327912729
lambda[  16] =   0.00429000090060
lambda[  17] =   0.00552354650877
lambda[  18] =   0.01860248364877
lambda[  19] =   0.02223699978134
lambda[  20] =   0.02475445919998
lambda[  21] =   0.03070616558754
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.289 ms
rank =  0, subspace rotation using ScaLAPACK took 8.385 ms
rank =  0, Distributing orbital back into band + domain format took 18.440 ms
rank = 0, Subspace_Rotation used 26.834 ms

Total time for subspace rotation: 26.839 ms
rank = 0, Efermi =  -0.050268664776 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.476 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.241 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.463 ms
rank = 0, Calculating density took 1683.568 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.088 ms
rank = 0, D2D took 2.232 ms
rank = 0, Transfering density took 2.235 ms
Etot    =   -38.631690895383
Eband   =   -12.335946449993
E1      =    29.281687503661
E2      =   -10.780378497906
E3      =   -15.876481086202
Exc     =   -14.085990514478
Esc     =   -68.148301017643
Entropy =    -0.000000001038
dE = 4.035e-07, dEband = 8.007e-05
rank = 0, Calculating/Estimating energy took 0.864 ms, Etot = -38.631690895, dEtot = 4.035e-07, dEband = 8.007e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0154297347492, which took 0.130 ms

iter_count = 114, r_2norm = 3.804e-07, tol*||rhs|| = 6.172e-07

Anderson update took 54.342 ms, out of which F'*F took 28.606 ms; b-Ax took 191.291 ms, out of which Lap took 172.088 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.578 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003513971, int_rho =  28.00000003513979, int_b + int_rho = 8.367e-14, checking this took 0.076 ms
2-norm of RHS = 803.4525164573593, which took 0.140 ms

iter_count = 126, r_2norm = 7.676e-04, tol*||rhs|| = 8.035e-04

Anderson update took 60.389 ms, out of which F'*F took 31.512 ms; b-Ax took 212.338 ms, out of which Lap took 190.481 ms
Solving Poisson took 427.866 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.150642 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 96.823 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.358928 
Total time for convolution: 	 convolve: 5.158863 
Total time for convolution: 	 convolve: 5.149258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.702 ms
---Transfer Veff_loc: D2D took 4.022 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.829 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.575 ms

This SCF took 27391.045 ms, scf error = 9.767e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.45648905214015, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43409905739022, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38353263589201, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36425332541380, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33417526503849, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31450420561098, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30070194344213, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29181508502973, occ[  12] =   2.00000000000000
lambda[  13] =  -0.27546452675612, occ[  13] =   2.00000000000000
lambda[  14] =  -0.27385821736865, occ[  14] =   2.00000000000000
lambda[  15] =  -0.02161327912729, occ[  15] =   0.00000003513979
lambda[  16] =   0.00429000090060, occ[  16] =   0.00000000000000
lambda[  17] =   0.00552354650877, occ[  17] =   0.00000000000000
lambda[  18] =   0.01860248364877, occ[  18] =   0.00000000000000
lambda[  19] =   0.02223699978134, occ[  19] =   0.00000000000000
lambda[  20] =   0.02475445919998, occ[  20] =   0.00000000000000
lambda[  21] =   0.03070616558754, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.625 ms, time for Allreduce/Reduce: 14.374 ms 
Time for calculating local force components: 25.777 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.01322034589277  -0.02681334657851  -0.04033143387424
 -0.01322034564516  -0.02681334094247   0.04033143171996
  0.01413601817300   0.02659874627109  -0.03993913363130
  0.01413602006424   0.02659873274088   0.03993914193332
 -0.02407949807290   0.04357403930932   0.00000000883065
 -0.01545519172579  -0.02492764020203  -0.03987992839586
 -0.01545519711779  -0.02492762478163   0.03987994119818
  0.00935004793936   0.00129829614549   0.00000034201441
 -0.14358706396183  -0.00373557157114   0.00000009576161
 -0.01415936023747   0.05312186233197   0.00000002343001
 -0.02221290513745   0.00046379549459   0.00000024194538
  0.91624499377725   0.11835630252541   0.00000028249965
force_loc = 
  0.01416025610237   0.02923705903204   0.04284120376792
  0.01416030956055   0.02923740102572  -0.04284167771918
 -0.01509927777280  -0.02842858620081   0.04193876387416
 -0.01509911879792  -0.02842854434642  -0.04193831843928
  0.02578931312531  -0.04558481476264  -0.00000051620123
  0.01713122444095   0.02588374484738   0.04150182695688
  0.01713140366153   0.02588408777409  -0.04150252163430
  0.01191760518270   0.00324795659215  -0.00000037404656
  0.12746122269716  -0.00056325005453   0.00000031989342
  0.01800671799897  -0.04949918109089  -0.00000072674276
  0.01867699900089  -0.00111809529866  -0.00000028607238
 -0.90254813031373  -0.11671551969777   0.00000096207162
Time for calculating nonlocal force components: 42.372 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01794431625799  -0.00248536819393   0.00000005885090
[0m[32m  0.00530814534234   0.00174783298366   0.00000000768418
[0m[32m -0.00039027283740  -0.00363639972031  -0.00000003557745
[0m[32m  0.00223786718700   0.00020123662349   0.00000002623272
[0m[32m -0.01332402850406  -0.00174316205303   0.00000001991812
[0mTime for calculating XC forces components: 37.536 ms
 Cartesian force = 
  0.00093548587805   0.00242115843666   0.00250979103963
  0.00093553958385   0.00242150606638  -0.00251022485327
 -0.00096768393135  -0.00183239394660   0.00199965138881
 -0.00096752306523  -0.00183236562242  -0.00199915536001
  0.00170539072087  -0.00201332947020  -0.00000048622463
  0.00167160838362   0.00095355062848   0.00162191970697
  0.00167178221220   0.00095390897558  -0.00162255929017
  0.00331891253253   0.00205833052685   0.00000004796470
 -0.01082212025388  -0.00255354265889   0.00000044448516
  0.00345266059255  -0.00001627249610  -0.00000071774424
 -0.00130246328112  -0.00045561719746   0.00000000325168
  0.00036841062791  -0.00010493324228   0.00000128563535
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 386.930 ms
The program took 473.497 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:34
Job ID:        2266429
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:36,vmem=8444K,walltime=00:08:08,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-019-15-1
---------------------------------------
