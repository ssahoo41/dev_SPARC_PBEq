---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:35
Job ID:    2266745
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:39
Job ID:    2266745
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 46.506 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 19.012 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 33.280 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.978 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.083 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.764269	   10.000000	   11.786584	
    8.235731	   10.000000	   11.786584	
   10.000000	   10.000000	   10.763477	
   10.000000	   11.165700	    8.213416	
   10.000000	    8.834300	    8.213416	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.007 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.160 ms
Set up communicators.

--set up spincomm took 4.018 ms

--set up kptcomm took 0.356 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.062 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.346 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 9.117 ms

Calculate_SplineDerivRadFun took 0.195 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.321 ms.
time spent on vectorized spline interp: 2.396 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.184 ms.
time spent on vectorized spline interp: 1.924 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.522 ms.
time spent on vectorized spline interp: 1.808 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.552 ms.

Calculating rb for all atom types took 15.718 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.039 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000126386, sum_int_rho = 15.7935313255270
PosCharge = 16.000000012639, NegCharge = -15.793531325527, scal_fac = 1.013072990635
After scaling, int_rho = 16.0000000126386, PosCharge + NegCharge - NetCharge = 0.000e+00
--Calculate Vref took 0.352 ms
--Calculate rho_guess took 2.188 ms

 integral of b = -16.0000000126386,
 int{b} + Nelectron + NetCharge = -1.264e-08,
 Esc = -46.3968043676426,
 MPI_Reduce took 1.616 ms

Calculating b & b_ref took 9.811 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.065 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.969 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263853, int_b + int_rho = -2.001e-13, checking this took 0.087 ms
2-norm of RHS = 557.0799586697501, which took 0.510 ms

iter_count = 420, r_2norm = 5.374e-04, tol*||rhs|| = 5.571e-04

Anderson update took 266.519 ms, out of which F'*F took 117.302 ms; b-Ax took 831.883 ms, out of which Lap took 746.690 ms
Solving Poisson took 1802.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.116242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
Total time for convolution: 	 convolve: 5.104051 
Total time for convolution: 	 convolve: 5.102604 
Total time for convolution: 	 convolve: 5.131802 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.720 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.355 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
rank = 0, XC calculation took 24441.983 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.098 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.793 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.970 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.138 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.864 ms
    Lanczos iter 54, eigmin  = -1.098420456, eigmax = 264.930408519, err_eigmin = 5.531e-04, err_eigmax = 9.700e-03
rank =   0, Lanczos took 135.102 ms, eigmin = -1.098420456394, eigmax = 267.579712604355

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.190646, lowerbound = -1.198420, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1376.855 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.616 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.567 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.053 ms
rank =  0, Distribute data + matrix mult took 19.272 ms
rank =  0, finding HY took 21.217 ms
rank =  0, distributing HY into block cyclic form took 15.775 ms
rank =  0, finding Y'*HY took 2.219 ms
Rank 0, Project_Hamiltonian used 58.524 ms
Total time for projection: 58.538 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.415 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.502 ms
    first calculated eigval = 2.802614192678313
    last  calculated eigval = 3.183428752242233
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.80261419267831
lambda[   2] =   2.83539601898124
lambda[   3] =   2.84453811178185
lambda[   4] =   2.92258019510268
lambda[   5] =   2.94725156064368
lambda[   6] =   2.98584045232655
lambda[   7] =   3.01538949221597
lambda[   8] =   3.05230206297079
lambda[   9] =   3.07664849649244
lambda[  10] =   3.08102280217375
lambda[  11] =   3.10917296621785
lambda[  12] =   3.13093937781765
lambda[  13] =   3.16002541378230
lambda[  14] =   3.18342875224223
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.517 ms
rank =  0, subspace rotation using ScaLAPACK took 3.464 ms
rank =  0, Distributing orbital back into band + domain format took 14.044 ms
rank = 0, Subspace_Rotation used 17.540 ms

Total time for subspace rotation: 17.545 ms
rank = 0, Efermi =   3.064405139458 calculate fermi energy took 0.062 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.283429, lowerbound = -1.198420, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1379.803 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 18.292 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.586 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.912 ms
rank =  0, finding HY took 20.433 ms
rank =  0, distributing HY into block cyclic form took 14.800 ms
rank =  0, finding Y'*HY took 2.319 ms
Rank 0, Project_Hamiltonian used 57.509 ms
Total time for projection: 57.536 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.986703028910777
    last  calculated eigval = 0.425835187965724
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.98670302891078
lambda[   2] =  -0.41985110335181
lambda[   3] =  -0.12317847484806
lambda[   4] =  -0.04301263382656
lambda[   5] =  -0.00670211859025
lambda[   6] =   0.08708989568230
lambda[   7] =   0.15651019782843
lambda[   8] =   0.28045494684368
lambda[   9] =   0.31111724983749
lambda[  10] =   0.34025328452037
lambda[  11] =   0.36365313198439
lambda[  12] =   0.38297803774641
lambda[  13] =   0.42122367499660
lambda[  14] =   0.42583518796572
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.927 ms
rank =  0, Distributing orbital back into band + domain format took 14.100 ms
rank = 0, Subspace_Rotation used 18.052 ms

Total time for subspace rotation: 18.057 ms
rank = 0, Efermi =   0.295786101533 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.525835, lowerbound = -1.198420, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1388.127 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.842 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.575 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.451 ms
rank =  0, finding HY took 20.435 ms
rank =  0, distributing HY into block cyclic form took 14.831 ms
rank =  0, finding Y'*HY took 2.331 ms
Rank 0, Project_Hamiltonian used 54.096 ms
Total time for projection: 55.135 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.102677786853929
    last  calculated eigval = 0.146036849654004
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.10267778685393
lambda[   2] =  -0.71298627749302
lambda[   3] =  -0.59649513260405
lambda[   4] =  -0.54472950681800
lambda[   5] =  -0.49768784425816
lambda[   6] =  -0.39604246803695
lambda[   7] =  -0.37117009737075
lambda[   8] =  -0.30429169746930
lambda[   9] =  -0.01894013397601
lambda[  10] =   0.02798653414906
lambda[  11] =   0.08072246604704
lambda[  12] =   0.09923910662470
lambda[  13] =   0.10811763942590
lambda[  14] =   0.14603684965400
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.959 ms
rank =  0, Distributing orbital back into band + domain format took 14.042 ms
rank = 0, Subspace_Rotation used 18.021 ms

Total time for subspace rotation: 18.025 ms
rank = 0, Efermi =  -0.048516433771 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.246037, lowerbound = -1.198420, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1321.265 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.650 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.567 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.084 ms
rank =  0, Distribute data + matrix mult took 16.323 ms
rank =  0, finding HY took 20.492 ms
rank =  0, distributing HY into block cyclic form took 14.703 ms
rank =  0, finding Y'*HY took 2.340 ms
Rank 0, Project_Hamiltonian used 53.900 ms
Total time for projection: 53.907 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.102717446399756
    last  calculated eigval = 0.090203620874530
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.10271744639976
lambda[   2] =  -0.71424764406127
lambda[   3] =  -0.60434379445686
lambda[   4] =  -0.54857591115695
lambda[   5] =  -0.51946386594731
lambda[   6] =  -0.40860888415744
lambda[   7] =  -0.38140987898217
lambda[   8] =  -0.31679531562479
lambda[   9] =  -0.12482085687082
lambda[  10] =  -0.02158361998009
lambda[  11] =   0.02611150115271
lambda[  12] =   0.05214715050481
lambda[  13] =   0.06025369551991
lambda[  14] =   0.09020362087453
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.931 ms
rank =  0, Distributing orbital back into band + domain format took 13.983 ms
rank = 0, Subspace_Rotation used 17.932 ms

Total time for subspace rotation: 17.936 ms
rank = 0, Efermi =  -0.154397156625 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 2.720 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.791 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.115 ms
rank = 0, Calculating density took 5904.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.410 ms
rank = 0, D2D took 1.503 ms
rank = 0, Transfering density took 1.533 ms
Etot    =   -27.917038780001
Eband   =    -9.192325483151
E1      =    18.954456430535
E2      =    -7.785815958730
E3      =    -9.464969283094
Exc     =    -8.533150601182
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 5.583e+00, dEband = 1.838e+00
rank = 0, Calculating/Estimating energy took 0.961 ms, Etot = -27.917038780, dEtot = 5.583e+00, dEband = 1.838e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 40.9495641593640, which took 0.090 ms

iter_count = 96, r_2norm = 1.074e-03, tol*||rhs|| = 1.638e-03

Anderson update took 56.514 ms, out of which F'*F took 26.849 ms; b-Ax took 180.068 ms, out of which Lap took 161.315 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.992 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263858, int_b + int_rho = -1.492e-13, checking this took 0.114 ms
2-norm of RHS = 554.8347783624848, which took 0.164 ms

iter_count = 282, r_2norm = 4.451e-04, tol*||rhs|| = 5.548e-04

Anderson update took 165.122 ms, out of which F'*F took 79.245 ms; b-Ax took 531.792 ms, out of which Lap took 473.274 ms
Solving Poisson took 1168.499 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.219 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.122125 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.081168 
Total time for convolution: 	 convolve: 5.132437 
Total time for convolution: 	 convolve: 5.115599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.392 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.776 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.024 ms

This SCF took 31936.213 ms, scf error = 1.604e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190204, lowerbound = -1.102717, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1350.327 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.065 ms
rank =  0, Distribute data + matrix mult took 18.874 ms
rank =  0, finding HY took 20.822 ms
rank =  0, distributing HY into block cyclic form took 13.883 ms
rank =  0, finding Y'*HY took 3.866 ms
Rank 0, Project_Hamiltonian used 57.495 ms
Total time for projection: 57.518 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -1.093624227445051
    last  calculated eigval = 0.060329100503005
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09362422744505
lambda[   2] =  -0.68453645221739
lambda[   3] =  -0.59270862102502
lambda[   4] =  -0.52447857420321
lambda[   5] =  -0.49972246259350
lambda[   6] =  -0.39694463459240
lambda[   7] =  -0.36958051651122
lambda[   8] =  -0.29633989719727
lambda[   9] =  -0.14183540408016
lambda[  10] =  -0.01711386518684
lambda[  11] =  -0.00002552496304
lambda[  12] =   0.03497721303470
lambda[  13] =   0.04181019050613
lambda[  14] =   0.06032910050301
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 4.026 ms
rank =  0, Distributing orbital back into band + domain format took 14.126 ms
rank = 0, Subspace_Rotation used 18.179 ms

Total time for subspace rotation: 18.184 ms
rank = 0, Efermi =  -0.171411703929 calculate fermi energy took 0.118 ms
rank = 0, --- Calculate rho: sum over local bands took 2.454 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.557 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.121 ms
rank = 0, Calculating density took 1430.665 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.448 ms
rank = 0, D2D took 0.559 ms
rank = 0, Transfering density took 0.566 ms
Etot    =   -27.888678226516
Eband   =    -8.915870773363
E1      =    18.701596867974
E2      =    -7.774518019448
E3      =    -9.548568844539
Exc     =    -8.600686817086
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 5.672e-03, dEband = 5.529e-02
rank = 0, Calculating/Estimating energy took 0.964 ms, Etot = -27.888678227, dEtot = 5.672e-03, dEband = 5.529e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.9525734673758, which took 0.940 ms

iter_count = 102, r_2norm = 3.737e-04, tol*||rhs|| = 5.981e-04

Anderson update took 59.653 ms, out of which F'*F took 28.464 ms; b-Ax took 192.681 ms, out of which Lap took 171.615 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.915 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263853, int_b + int_rho = -2.019e-13, checking this took 0.106 ms
2-norm of RHS = 551.3560310306018, which took 0.145 ms

iter_count = 294, r_2norm = 4.710e-04, tol*||rhs|| = 5.514e-04

Anderson update took 173.600 ms, out of which F'*F took 81.978 ms; b-Ax took 555.024 ms, out of which Lap took 494.374 ms
Solving Poisson took 1232.143 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.532 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.105498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.091043 
Total time for convolution: 	 convolve: 5.089216 
Total time for convolution: 	 convolve: 5.102104 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.387 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.434 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.021 ms

This SCF took 27496.282 ms, scf error = 1.097e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.160329, lowerbound = -1.093624, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1368.314 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.678 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.695 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.404 ms
rank =  0, finding HY took 22.008 ms
rank =  0, distributing HY into block cyclic form took 14.803 ms
rank =  0, finding Y'*HY took 2.364 ms
Rank 0, Project_Hamiltonian used 55.629 ms
Total time for projection: 55.648 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -1.069851749200775
    last  calculated eigval = 0.039215942687529
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06985174920078
lambda[   2] =  -0.63525030328964
lambda[   3] =  -0.56576731212025
lambda[   4] =  -0.48616011330030
lambda[   5] =  -0.45936729984457
lambda[   6] =  -0.36660348339033
lambda[   7] =  -0.33835376468005
lambda[   8] =  -0.25901825310095
lambda[   9] =  -0.12900135632598
lambda[  10] =  -0.01696770119534
lambda[  11] =   0.00137433241902
lambda[  12] =   0.02701497591042
lambda[  13] =   0.03485004347237
lambda[  14] =   0.03921594268753
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 4.029 ms
rank =  0, Distributing orbital back into band + domain format took 13.938 ms
rank = 0, Subspace_Rotation used 19.038 ms

Total time for subspace rotation: 19.070 ms
rank = 0, Efermi =  -0.158577656182 calculate fermi energy took 0.649 ms
rank = 0, --- Calculate rho: sum over local bands took 2.335 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.876 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.112 ms
rank = 0, Calculating density took 1447.221 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.586 ms
rank = 0, D2D took 0.822 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -27.864267699548
Eband   =    -8.360744559484
E1      =    18.218143606836
E2      =    -7.689009135151
E3      =    -9.738774912007
Exc     =    -8.752646426030
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 4.882e-03, dEband = 1.110e-01
rank = 0, Calculating/Estimating energy took 1.140 ms, Etot = -27.864267700, dEtot = 4.882e-03, dEband = 1.110e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.0982281482987, which took 1.394 ms

iter_count = 102, r_2norm = 1.422e-04, tol*||rhs|| = 1.639e-04

Anderson update took 61.127 ms, out of which F'*F took 28.291 ms; b-Ax took 189.945 ms, out of which Lap took 170.064 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.994 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263852, int_b + int_rho = -2.110e-13, checking this took 0.110 ms
2-norm of RHS = 551.3375215563283, which took 0.132 ms

iter_count = 264, r_2norm = 5.086e-04, tol*||rhs|| = 5.513e-04

Anderson update took 155.626 ms, out of which F'*F took 72.730 ms; b-Ax took 494.587 ms, out of which Lap took 439.616 ms
Solving Poisson took 1097.877 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Total time for convolution: 	 convolve: 5.080036 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.790 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.111072 
Total time for convolution: 	 convolve: 5.082183 
Total time for convolution: 	 convolve: 5.076813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 27599.188 ms, scf error = 3.176e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.139216, lowerbound = -1.069852, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1363.092 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.843 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 16.496 ms
rank =  0, finding HY took 20.718 ms
rank =  0, distributing HY into block cyclic form took 14.729 ms
rank =  0, finding Y'*HY took 2.620 ms
Rank 0, Project_Hamiltonian used 54.612 ms
Total time for projection: 54.641 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.060250563646186
    last  calculated eigval = 0.028247162387746
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06025056364619
lambda[   2] =  -0.62609013822187
lambda[   3] =  -0.55654907118735
lambda[   4] =  -0.47796738949950
lambda[   5] =  -0.44952371890435
lambda[   6] =  -0.35553976943813
lambda[   7] =  -0.32908486885245
lambda[   8] =  -0.25073348602530
lambda[   9] =  -0.12158468018372
lambda[  10] =  -0.02467973470856
lambda[  11] =   0.00294886745318
lambda[  12] =   0.01866038875894
lambda[  13] =   0.02811496297990
lambda[  14] =   0.02824716238775
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.946 ms
rank =  0, Distributing orbital back into band + domain format took 13.956 ms
rank = 0, Subspace_Rotation used 17.926 ms

Total time for subspace rotation: 17.932 ms
rank = 0, Efermi =  -0.151160979993 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.391 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.117 ms
rank = 0, Calculating density took 1439.687 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.603 ms
rank = 0, D2D took 0.839 ms
rank = 0, Transfering density took 0.846 ms
Etot    =   -27.862086399971
Eband   =    -8.211478013087
E1      =    18.115901372547
E2      =    -7.631772660182
E3      =    -9.790289763853
Exc     =    -8.791767815439
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 4.363e-04, dEband = 2.985e-02
rank = 0, Calculating/Estimating energy took 1.115 ms, Etot = -27.862086400, dEtot = 4.363e-04, dEband = 2.985e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5411524319038, which took 0.059 ms

iter_count = 108, r_2norm = 4.496e-05, tol*||rhs|| = 6.165e-05

Anderson update took 64.671 ms, out of which F'*F took 29.660 ms; b-Ax took 201.008 ms, out of which Lap took 178.901 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.111 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263858, int_b + int_rho = -1.492e-13, checking this took 0.103 ms
2-norm of RHS = 552.0102113832104, which took 0.135 ms

iter_count = 258, r_2norm = 4.492e-04, tol*||rhs|| = 5.520e-04

Anderson update took 151.758 ms, out of which F'*F took 70.861 ms; b-Ax took 485.151 ms, out of which Lap took 431.109 ms
Solving Poisson took 1068.415 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.456 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.091146 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.108693 
Total time for convolution: 	 convolve: 5.131256 
Total time for convolution: 	 convolve: 5.078340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.417 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 0.708 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.044 ms

This SCF took 27360.925 ms, scf error = 1.241e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.128247, lowerbound = -1.060251, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1358.988 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.680 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.595 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 16.306 ms
rank =  0, finding HY took 20.718 ms
rank =  0, distributing HY into block cyclic form took 15.003 ms
rank =  0, finding Y'*HY took 2.386 ms
Rank 0, Project_Hamiltonian used 54.463 ms
Total time for projection: 54.480 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -1.055365514994025
    last  calculated eigval = 0.025028995671538
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05536551499402
lambda[   2] =  -0.62143779863725
lambda[   3] =  -0.55207519233126
lambda[   4] =  -0.47357508958515
lambda[   5] =  -0.44471882027691
lambda[   6] =  -0.35067991260325
lambda[   7] =  -0.32437946577374
lambda[   8] =  -0.24679680579518
lambda[   9] =  -0.11792090735526
lambda[  10] =  -0.02746566267963
lambda[  11] =   0.00400092103908
lambda[  12] =   0.01394707940246
lambda[  13] =   0.02167432483954
lambda[  14] =   0.02502899567154
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.568 ms
rank =  0, Distributing orbital back into band + domain format took 14.301 ms
rank = 0, Subspace_Rotation used 17.893 ms

Total time for subspace rotation: 17.898 ms
rank = 0, Efermi =  -0.147497207280 calculate fermi energy took 0.340 ms
rank = 0, --- Calculate rho: sum over local bands took 2.512 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.742 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1435.333 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.578 ms
rank = 0, D2D took 0.819 ms
rank = 0, Transfering density took 0.828 ms
Etot    =   -27.861546112921
Eband   =    -8.138057201484
E1      =    18.084642844085
E2      =    -7.583834113923
E3      =    -9.811218063736
Exc     =    -8.806379565154
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 1.081e-04, dEband = 1.468e-02
rank = 0, Calculating/Estimating energy took 1.158 ms, Etot = -27.861546113, dEtot = 1.081e-04, dEband = 1.468e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5040745837515, which took 0.084 ms

iter_count = 114, r_2norm = 1.244e-05, tol*||rhs|| = 2.016e-05

Anderson update took 68.322 ms, out of which F'*F took 31.727 ms; b-Ax took 216.498 ms, out of which Lap took 192.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.955 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263858, int_b + int_rho = -1.528e-13, checking this took 0.127 ms
2-norm of RHS = 552.4304076047009, which took 0.149 ms

iter_count = 234, r_2norm = 5.067e-04, tol*||rhs|| = 5.524e-04

Anderson update took 136.548 ms, out of which F'*F took 64.969 ms; b-Ax took 439.775 ms, out of which Lap took 391.715 ms
Solving Poisson took 972.838 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.078385 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.078795 
Total time for convolution: 	 convolve: 5.076116 
Total time for convolution: 	 convolve: 5.078245 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.607 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 27181.503 ms, scf error = 5.374e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.125029, lowerbound = -1.055366, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1376.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.726 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.580 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 16.391 ms
rank =  0, finding HY took 20.908 ms
rank =  0, distributing HY into block cyclic form took 15.136 ms
rank =  0, finding Y'*HY took 2.232 ms
Rank 0, Project_Hamiltonian used 54.718 ms
Total time for projection: 54.738 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.561 ms
    first calculated eigval = -1.053997060166603
    last  calculated eigval = 0.023679821162182
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05399706016660
lambda[   2] =  -0.61909910133271
lambda[   3] =  -0.55071923323520
lambda[   4] =  -0.47160343041026
lambda[   5] =  -0.44284292117986
lambda[   6] =  -0.34974601674086
lambda[   7] =  -0.32271573380634
lambda[   8] =  -0.24501536588967
lambda[   9] =  -0.11709990987885
lambda[  10] =  -0.02780848489586
lambda[  11] =   0.00478018310653
lambda[  12] =   0.01232026021683
lambda[  13] =   0.01799076887995
lambda[  14] =   0.02367982116218
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.604 ms
rank =  0, subspace rotation using ScaLAPACK took 3.938 ms
rank =  0, Distributing orbital back into band + domain format took 13.683 ms
rank = 0, Subspace_Rotation used 17.645 ms

Total time for subspace rotation: 17.656 ms
rank = 0, Efermi =  -0.146676209690 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.423 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.845 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1453.858 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.706 ms
rank = 0, D2D took 0.924 ms
rank = 0, Transfering density took 0.930 ms
Etot    =   -27.861428049067
Eband   =    -8.111477727003
E1      =    18.079207593766
E2      =    -7.561306487335
E3      =    -9.814496133994
Exc     =    -8.808156169132
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 2.361e-05, dEband = 5.316e-03
rank = 0, Calculating/Estimating energy took 1.073 ms, Etot = -27.861428049, dEtot = 2.361e-05, dEband = 5.316e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3127859806299, which took 0.055 ms

iter_count = 108, r_2norm = 1.188e-05, tol*||rhs|| = 1.251e-05

Anderson update took 63.520 ms, out of which F'*F took 29.897 ms; b-Ax took 203.025 ms, out of which Lap took 181.345 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.202 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263853, int_b + int_rho = -2.019e-13, checking this took 0.126 ms
2-norm of RHS = 552.5494280301789, which took 0.124 ms

iter_count = 234, r_2norm = 4.848e-04, tol*||rhs|| = 5.525e-04

Anderson update took 138.480 ms, out of which F'*F took 63.812 ms; b-Ax took 438.133 ms, out of which Lap took 391.841 ms
Solving Poisson took 966.005 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.099857 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.122175 
Total time for convolution: 	 convolve: 5.076580 
Total time for convolution: 	 convolve: 5.080590 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.615 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 27238.446 ms, scf error = 2.401e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.123680, lowerbound = -1.053997, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1362.048 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.729 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.093 ms
rank =  0, Distribute data + matrix mult took 16.415 ms
rank =  0, finding HY took 20.902 ms
rank =  0, distributing HY into block cyclic form took 14.962 ms
rank =  0, finding Y'*HY took 2.342 ms
Rank 0, Project_Hamiltonian used 55.223 ms
Total time for projection: 55.243 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.051627440359211
    last  calculated eigval = 0.023505273293623
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05162744035921
lambda[   2] =  -0.61691711977566
lambda[   3] =  -0.54832641402403
lambda[   4] =  -0.46957252795214
lambda[   5] =  -0.44063644016755
lambda[   6] =  -0.34739230916465
lambda[   7] =  -0.32072333582983
lambda[   8] =  -0.24268595182559
lambda[   9] =  -0.11493536326019
lambda[  10] =  -0.02682646462249
lambda[  11] =   0.00651604297669
lambda[  12] =   0.01262151621274
lambda[  13] =   0.01671763226771
lambda[  14] =   0.02350527329362
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.885 ms
rank =  0, Distributing orbital back into band + domain format took 14.154 ms
rank = 0, Subspace_Rotation used 18.059 ms

Total time for subspace rotation: 18.064 ms
rank = 0, Efermi =  -0.144511663287 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.405 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.818 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1438.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.986 ms
rank = 0, Transfering density took 0.998 ms
Etot    =   -27.861423992124
Eband   =    -8.075763079650
E1      =    18.062084733810
E2      =    -7.541163734881
E3      =    -9.819786886971
Exc     =    -8.811891900108
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 8.114e-07, dEband = 7.143e-03
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -27.861423992, dEtot = 8.114e-07, dEband = 7.143e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1754365275789, which took 0.074 ms

iter_count = 108, r_2norm = 6.975e-06, tol*||rhs|| = 7.017e-06

Anderson update took 64.032 ms, out of which F'*F took 29.528 ms; b-Ax took 200.191 ms, out of which Lap took 177.949 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.676 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263852, int_b + int_rho = -2.110e-13, checking this took 0.160 ms
2-norm of RHS = 552.5502654116822, which took 0.091 ms

iter_count = 222, r_2norm = 4.657e-04, tol*||rhs|| = 5.526e-04

Anderson update took 130.958 ms, out of which F'*F took 62.672 ms; b-Ax took 420.103 ms, out of which Lap took 374.332 ms
Solving Poisson took 920.304 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.099887 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.092402 
Total time for convolution: 	 convolve: 5.080308 
Total time for convolution: 	 convolve: 5.211777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 205.488 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.019 ms

This SCF took 27491.125 ms, scf error = 1.352e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.123505, lowerbound = -1.051627, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1365.077 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.714 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.072 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.072 ms
rank =  0, finding HY took 20.598 ms
rank =  0, distributing HY into block cyclic form took 15.063 ms
rank =  0, finding Y'*HY took 2.228 ms
Rank 0, Project_Hamiltonian used 56.006 ms
Total time for projection: 56.032 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.049851554072306
    last  calculated eigval = 0.023846996931197
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04985155407231
lambda[   2] =  -0.61526725779756
lambda[   3] =  -0.54650258753578
lambda[   4] =  -0.46803853995784
lambda[   5] =  -0.43893412741730
lambda[   6] =  -0.34550034891431
lambda[   7] =  -0.31915980995908
lambda[   8] =  -0.24092061153999
lambda[   9] =  -0.11321931814073
lambda[  10] =  -0.02531565456779
lambda[  11] =   0.00840900806203
lambda[  12] =   0.01398440818346
lambda[  13] =   0.01692539918192
lambda[  14] =   0.02384699693120
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.857 ms
rank =  0, Distributing orbital back into band + domain format took 14.120 ms
rank = 0, Subspace_Rotation used 17.998 ms

Total time for subspace rotation: 18.004 ms
rank = 0, Efermi =  -0.142795618004 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.377 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.860 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1442.706 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.656 ms
rank = 0, D2D took 0.944 ms
rank = 0, Transfering density took 0.955 ms
Etot    =   -27.861455709143
Eband   =    -8.048349675819
E1      =    18.046914554514
E2      =    -7.527786122661
E3      =    -9.824285111105
Exc     =    -8.815287453576
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 6.343e-06, dEband = 5.483e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -27.861455709, dEtot = 6.343e-06, dEband = 5.483e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0927500913654, which took 0.055 ms

iter_count = 108, r_2norm = 3.424e-06, tol*||rhs|| = 3.710e-06

Anderson update took 65.005 ms, out of which F'*F took 29.364 ms; b-Ax took 200.011 ms, out of which Lap took 178.659 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263860, int_b + int_rho = -1.310e-13, checking this took 0.106 ms
2-norm of RHS = 552.5549534286079, which took 0.116 ms

iter_count = 222, r_2norm = 4.653e-04, tol*||rhs|| = 5.526e-04

Anderson update took 133.566 ms, out of which F'*F took 61.838 ms; b-Ax took 417.189 ms, out of which Lap took 372.282 ms
Solving Poisson took 917.568 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.233 ms
Total time for convolution: 	 convolve: 5.079132 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.583 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.093888 
Total time for convolution: 	 convolve: 5.085857 
Total time for convolution: 	 convolve: 5.078599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 27126.699 ms, scf error = 8.858e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.123847, lowerbound = -1.049852, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1310.173 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.810 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 16.464 ms
rank =  0, finding HY took 20.940 ms
rank =  0, distributing HY into block cyclic form took 15.000 ms
rank =  0, finding Y'*HY took 2.217 ms
Rank 0, Project_Hamiltonian used 54.662 ms
Total time for projection: 54.678 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -1.048681239039811
    last  calculated eigval = 0.025872568534888
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04868123903981
lambda[   2] =  -0.61414560843350
lambda[   3] =  -0.54528273825538
lambda[   4] =  -0.46690040424982
lambda[   5] =  -0.43779597611100
lambda[   6] =  -0.34427474977345
lambda[   7] =  -0.31800135868221
lambda[   8] =  -0.23974762359343
lambda[   9] =  -0.11193872233692
lambda[  10] =  -0.02159404155783
lambda[  11] =   0.01168398940044
lambda[  12] =   0.01924955309787
lambda[  13] =   0.01942952332777
lambda[  14] =   0.02587256853489
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.893 ms
rank =  0, Distributing orbital back into band + domain format took 14.163 ms
rank = 0, Subspace_Rotation used 18.075 ms

Total time for subspace rotation: 18.079 ms
rank = 0, Efermi =  -0.141515022281 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.429 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1386.518 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.665 ms
rank = 0, D2D took 0.908 ms
rank = 0, Transfering density took 0.919 ms
Etot    =   -27.861497683918
Eband   =    -8.029659397692
E1      =    18.038932552782
E2      =    -7.516872641339
E3      =    -9.825170211280
Exc     =    -8.816009323599
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 8.395e-06, dEband = 3.738e-03
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -27.861497684, dEtot = 8.395e-06, dEband = 3.738e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0674335209344, which took 0.073 ms

iter_count = 114, r_2norm = 1.891e-06, tol*||rhs|| = 2.697e-06

Anderson update took 68.390 ms, out of which F'*F took 31.141 ms; b-Ax took 211.021 ms, out of which Lap took 188.027 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.574 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263860, int_b + int_rho = -1.310e-13, checking this took 0.131 ms
2-norm of RHS = 552.5479737709974, which took 0.154 ms

iter_count = 156, r_2norm = 5.050e-04, tol*||rhs|| = 5.525e-04

Anderson update took 93.826 ms, out of which F'*F took 43.135 ms; b-Ax took 293.150 ms, out of which Lap took 260.976 ms
Solving Poisson took 645.874 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.088425 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.092743 
Total time for convolution: 	 convolve: 5.083158 
Total time for convolution: 	 convolve: 5.083574 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.461 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.787 ms

This SCF took 26831.784 ms, scf error = 5.060e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.125873, lowerbound = -1.048681, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1321.526 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.107 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.400 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 17.543 ms
rank =  0, finding HY took 21.190 ms
rank =  0, distributing HY into block cyclic form took 15.014 ms
rank =  0, finding Y'*HY took 2.389 ms
Rank 0, Project_Hamiltonian used 56.186 ms
Total time for projection: 56.195 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -1.048392305557237
    last  calculated eigval = 0.025912458207975
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04839230555724
lambda[   2] =  -0.61386302429889
lambda[   3] =  -0.54500646382930
lambda[   4] =  -0.46663726653888
lambda[   5] =  -0.43751872607337
lambda[   6] =  -0.34399982396211
lambda[   7] =  -0.31774406025060
lambda[   8] =  -0.23947010514991
lambda[   9] =  -0.11168234764332
lambda[  10] =  -0.02108216579039
lambda[  11] =   0.01201269973500
lambda[  12] =   0.01916017267907
lambda[  13] =   0.02005221880165
lambda[  14] =   0.02591245820798
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.914 ms
rank =  0, Distributing orbital back into band + domain format took 14.217 ms
rank = 0, Subspace_Rotation used 18.157 ms

Total time for subspace rotation: 18.161 ms
rank = 0, Efermi =  -0.141258647473 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.457 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.730 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1399.492 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.652 ms
rank = 0, D2D took 0.976 ms
rank = 0, Transfering density took 0.987 ms
Etot    =   -27.861509640949
Eband   =    -8.025263552732
E1      =    18.036247103562
E2      =    -7.515004192015
E3      =    -9.825885206237
Exc     =    -8.816578222004
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 2.391e-06, dEband = 8.792e-04
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -27.861509641, dEtot = 2.391e-06, dEband = 8.792e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0433530682722, which took 0.057 ms

iter_count = 108, r_2norm = 1.551e-06, tol*||rhs|| = 1.734e-06

Anderson update took 64.545 ms, out of which F'*F took 29.366 ms; b-Ax took 199.878 ms, out of which Lap took 178.282 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.671 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263855, int_b + int_rho = -1.783e-13, checking this took 0.164 ms
2-norm of RHS = 552.5550950242574, which took 0.070 ms

iter_count = 192, r_2norm = 5.431e-04, tol*||rhs|| = 5.526e-04

Anderson update took 115.141 ms, out of which F'*F took 53.617 ms; b-Ax took 360.439 ms, out of which Lap took 321.523 ms
Solving Poisson took 793.766 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.090752 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.091929 
Total time for convolution: 	 convolve: 5.106231 
Total time for convolution: 	 convolve: 5.086491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.473 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
---Transfer Veff_loc: D2D took 1.058 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.393 ms

This SCF took 26999.911 ms, scf error = 4.086e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.125912, lowerbound = -1.048392, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1324.880 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.724 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.340 ms
rank =  0, finding HY took 20.958 ms
rank =  0, distributing HY into block cyclic form took 14.961 ms
rank =  0, finding Y'*HY took 2.195 ms
Rank 0, Project_Hamiltonian used 54.482 ms
Total time for projection: 54.501 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -1.047515244547859
    last  calculated eigval = 0.030482328052961
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04751524454786
lambda[   2] =  -0.61301640022292
lambda[   3] =  -0.54418939128356
lambda[   4] =  -0.46580084527014
lambda[   5] =  -0.43670616239901
lambda[   6] =  -0.34324271961315
lambda[   7] =  -0.31695000002599
lambda[   8] =  -0.23866314195850
lambda[   9] =  -0.11090255218936
lambda[  10] =  -0.01708652817286
lambda[  11] =   0.01383634577355
lambda[  12] =   0.02051662901035
lambda[  13] =   0.02514662139889
lambda[  14] =   0.03048232805296
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.879 ms
rank =  0, Distributing orbital back into band + domain format took 14.183 ms
rank = 0, Subspace_Rotation used 18.075 ms

Total time for subspace rotation: 18.079 ms
rank = 0, Efermi =  -0.140478852111 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.427 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.763 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1401.012 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.624 ms
rank = 0, D2D took 0.867 ms
rank = 0, Transfering density took 0.875 ms
Etot    =   -27.861567762843
Eband   =    -8.012167812044
E1      =    18.029492269037
E2      =    -7.508382201690
E3      =    -9.827089708469
Exc     =    -8.817559761968
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 1.162e-05, dEband = 2.619e-03
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -27.861567763, dEtot = 1.162e-05, dEband = 2.619e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0312906624360, which took 0.106 ms

iter_count = 108, r_2norm = 1.250e-06, tol*||rhs|| = 1.252e-06

Anderson update took 64.607 ms, out of which F'*F took 29.410 ms; b-Ax took 200.219 ms, out of which Lap took 178.355 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.146 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263855, int_b + int_rho = -1.783e-13, checking this took 0.194 ms
2-norm of RHS = 552.5560839903303, which took 0.183 ms

iter_count = 156, r_2norm = 4.603e-04, tol*||rhs|| = 5.526e-04

Anderson update took 105.629 ms, out of which F'*F took 52.914 ms; b-Ax took 317.715 ms, out of which Lap took 287.247 ms
Solving Poisson took 680.039 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.084657 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.078847 
Total time for convolution: 	 convolve: 5.096711 
Total time for convolution: 	 convolve: 5.074860 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.059 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 26845.480 ms, scf error = 2.662e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130482, lowerbound = -1.047515, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1331.337 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.678 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.081 ms
rank =  0, Distribute data + matrix mult took 16.340 ms
rank =  0, finding HY took 20.829 ms
rank =  0, distributing HY into block cyclic form took 14.941 ms
rank =  0, finding Y'*HY took 2.199 ms
Rank 0, Project_Hamiltonian used 54.335 ms
Total time for projection: 54.350 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.047342604262631
    last  calculated eigval = 0.031962125184698
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04734260426263
lambda[   2] =  -0.61288845853255
lambda[   3] =  -0.54401091303137
lambda[   4] =  -0.46565949598454
lambda[   5] =  -0.43655894966059
lambda[   6] =  -0.34305469874155
lambda[   7] =  -0.31679719641170
lambda[   8] =  -0.23851407470252
lambda[   9] =  -0.11072646469206
lambda[  10] =  -0.01582778110178
lambda[  11] =   0.01406237658242
lambda[  12] =   0.02064172368213
lambda[  13] =   0.02640190761277
lambda[  14] =   0.03196212518470
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.888 ms
rank =  0, Distributing orbital back into band + domain format took 14.185 ms
rank = 0, Subspace_Rotation used 18.083 ms

Total time for subspace rotation: 18.088 ms
rank = 0, Efermi =  -0.140302764674 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.432 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1407.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 0.922 ms
rank = 0, Transfering density took 0.925 ms
Etot    =   -27.861591441522
Eband   =    -8.009652784054
E1      =    18.028273263399
E2      =    -7.507026911999
E3      =    -9.827274419549
Exc     =    -8.817708884388
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 4.736e-06, dEband = 5.030e-04
rank = 0, Calculating/Estimating energy took 1.914 ms, Etot = -27.861591442, dEtot = 4.736e-06, dEband = 5.030e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0316213853493, which took 0.056 ms

iter_count = 108, r_2norm = 1.205e-06, tol*||rhs|| = 1.265e-06

Anderson update took 64.663 ms, out of which F'*F took 29.430 ms; b-Ax took 199.971 ms, out of which Lap took 178.460 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.576 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263850, int_b + int_rho = -2.256e-13, checking this took 0.116 ms
2-norm of RHS = 552.5597358491680, which took 0.096 ms

iter_count = 138, r_2norm = 5.042e-04, tol*||rhs|| = 5.526e-04

Anderson update took 82.135 ms, out of which F'*F took 38.297 ms; b-Ax took 262.835 ms, out of which Lap took 234.956 ms
Solving Poisson took 573.053 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.084613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.083331 
Total time for convolution: 	 convolve: 5.089998 
Total time for convolution: 	 convolve: 5.100076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26763.273 ms, scf error = 1.736e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131962, lowerbound = -1.047343, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1328.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.666 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.054 ms
rank =  0, Distribute data + matrix mult took 16.296 ms
rank =  0, finding HY took 20.822 ms
rank =  0, distributing HY into block cyclic form took 14.936 ms
rank =  0, finding Y'*HY took 2.198 ms
Rank 0, Project_Hamiltonian used 54.276 ms
Total time for projection: 54.293 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.047275534232692
    last  calculated eigval = 0.033035911283947
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04727553423269
lambda[   2] =  -0.61279928697964
lambda[   3] =  -0.54393265230048
lambda[   4] =  -0.46557475399081
lambda[   5] =  -0.43647491034117
lambda[   6] =  -0.34297923790839
lambda[   7] =  -0.31671312156538
lambda[   8] =  -0.23843172485599
lambda[   9] =  -0.11066017688535
lambda[  10] =  -0.01485788192133
lambda[  11] =   0.01419212223644
lambda[  12] =   0.02072493732306
lambda[  13] =   0.02730242679724
lambda[  14] =   0.03303591128395
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.856 ms
rank =  0, Distributing orbital back into band + domain format took 14.200 ms
rank = 0, Subspace_Rotation used 18.068 ms

Total time for subspace rotation: 18.071 ms
rank = 0, Efermi =  -0.140236476811 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.434 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.731 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1404.854 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.596 ms
rank = 0, D2D took 1.754 ms
rank = 0, Transfering density took 1.765 ms
Etot    =   -27.861606704271
Eband   =    -8.008362445748
E1      =    18.027737740621
E2      =    -7.506250893843
E3      =    -9.827314686927
Exc     =    -8.817743211886
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 3.053e-06, dEband = 2.581e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -27.861606704, dEtot = 3.053e-06, dEband = 2.581e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0282713453093, which took 0.087 ms

iter_count = 114, r_2norm = 6.716e-07, tol*||rhs|| = 1.131e-06

Anderson update took 68.001 ms, out of which F'*F took 31.056 ms; b-Ax took 211.950 ms, out of which Lap took 188.011 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 478.879 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263855, int_b + int_rho = -1.801e-13, checking this took 0.144 ms
2-norm of RHS = 552.5613663274689, which took 0.117 ms

iter_count = 132, r_2norm = 5.512e-04, tol*||rhs|| = 5.526e-04

Anderson update took 79.358 ms, out of which F'*F took 36.731 ms; b-Ax took 248.284 ms, out of which Lap took 221.090 ms
Solving Poisson took 551.173 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.085936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.081549 
Total time for convolution: 	 convolve: 5.082772 
Total time for convolution: 	 convolve: 5.083463 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.021 ms

This SCF took 26758.496 ms, scf error = 1.581e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133036, lowerbound = -1.047276, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1334.657 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.718 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.578 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.081 ms
rank =  0, Distribute data + matrix mult took 16.389 ms
rank =  0, finding HY took 20.855 ms
rank =  0, distributing HY into block cyclic form took 14.943 ms
rank =  0, finding Y'*HY took 2.306 ms
Rank 0, Project_Hamiltonian used 54.519 ms
Total time for projection: 54.533 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -1.047187209177195
    last  calculated eigval = 0.033977303201638
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04718720917720
lambda[   2] =  -0.61269768976507
lambda[   3] =  -0.54383787195221
lambda[   4] =  -0.46547947752383
lambda[   5] =  -0.43637652971181
lambda[   6] =  -0.34288477094127
lambda[   7] =  -0.31661792474889
lambda[   8] =  -0.23833457023778
lambda[   9] =  -0.11058159877264
lambda[  10] =  -0.01406982341850
lambda[  11] =   0.01411327857607
lambda[  12] =   0.02063087533584
lambda[  13] =   0.02778073760462
lambda[  14] =   0.03397730320164
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.886 ms
rank =  0, Distributing orbital back into band + domain format took 14.201 ms
rank = 0, Subspace_Rotation used 18.099 ms

Total time for subspace rotation: 18.103 ms
rank = 0, Efermi =  -0.140157898670 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.432 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.803 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 1410.864 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.030 ms
rank = 0, D2D took 1.143 ms
rank = 0, Transfering density took 1.149 ms
Etot    =   -27.861623121743
Eband   =    -8.006832089514
E1      =    18.026986492685
E2      =    -7.505431610081
E3      =    -9.827427173579
Exc     =    -8.817831940547
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 3.283e-06, dEband = 3.061e-04
rank = 0, Calculating/Estimating energy took 0.952 ms, Etot = -27.861623122, dEtot = 3.283e-06, dEband = 3.061e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0256629528507, which took 0.056 ms

iter_count = 108, r_2norm = 6.801e-07, tol*||rhs|| = 1.027e-06

Anderson update took 64.972 ms, out of which F'*F took 29.620 ms; b-Ax took 200.268 ms, out of which Lap took 178.779 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.756 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263858, int_b + int_rho = -1.455e-13, checking this took 0.156 ms
2-norm of RHS = 552.5619704056473, which took 0.128 ms

iter_count = 144, r_2norm = 5.507e-04, tol*||rhs|| = 5.526e-04

Anderson update took 86.107 ms, out of which F'*F took 40.170 ms; b-Ax took 270.555 ms, out of which Lap took 241.303 ms
Solving Poisson took 595.896 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.092893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.093460 
Total time for convolution: 	 convolve: 5.092037 
Total time for convolution: 	 convolve: 5.083740 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 226.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.132 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.021 ms

This SCF took 27044.712 ms, scf error = 1.362e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133977, lowerbound = -1.047187, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1360.042 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.621 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.544 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 16.203 ms
rank =  0, finding HY took 20.886 ms
rank =  0, distributing HY into block cyclic form took 14.673 ms
rank =  0, finding Y'*HY took 2.457 ms
Rank 0, Project_Hamiltonian used 54.246 ms
Total time for projection: 54.263 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -1.047211675391236
    last  calculated eigval = 0.035257142202230
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04721167539124
lambda[   2] =  -0.61270498932972
lambda[   3] =  -0.54384693886940
lambda[   4] =  -0.46548117442494
lambda[   5] =  -0.43638339810710
lambda[   6] =  -0.34289052039124
lambda[   7] =  -0.31661492750780
lambda[   8] =  -0.23834342363927
lambda[   9] =  -0.11060105851828
lambda[  10] =  -0.01338687755241
lambda[  11] =   0.01351062228177
lambda[  12] =   0.02017386573228
lambda[  13] =   0.02687864047211
lambda[  14] =   0.03525714220223
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.889 ms
rank =  0, Distributing orbital back into band + domain format took 14.150 ms
rank = 0, Subspace_Rotation used 18.051 ms

Total time for subspace rotation: 18.055 ms
rank = 0, Efermi =  -0.140177358257 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.673 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.530 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 1436.355 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.677 ms
rank = 0, D2D took 0.915 ms
rank = 0, Transfering density took 0.922 ms
Etot    =   -27.861646331947
Eband   =    -8.006954096719
E1      =    18.027341238790
E2      =    -7.505262490333
E3      =    -9.827055571157
Exc     =    -8.817547167481
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 4.642e-06, dEband = 2.440e-05
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -27.861646332, dEtot = 4.642e-06, dEband = 2.440e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0278927569744, which took 0.056 ms

iter_count = 108, r_2norm = 7.059e-07, tol*||rhs|| = 1.116e-06

Anderson update took 64.764 ms, out of which F'*F took 29.468 ms; b-Ax took 199.968 ms, out of which Lap took 178.128 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.450 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263857, int_b + int_rho = -1.564e-13, checking this took 0.173 ms
2-norm of RHS = 552.5617890261213, which took 0.108 ms

iter_count = 84, r_2norm = 5.322e-04, tol*||rhs|| = 5.526e-04

Anderson update took 50.125 ms, out of which F'*F took 23.479 ms; b-Ax took 158.017 ms, out of which Lap took 140.810 ms
Solving Poisson took 349.058 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.081404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.085505 
Total time for convolution: 	 convolve: 5.085952 
Total time for convolution: 	 convolve: 5.091185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.112 ms
======D2D: initiated sending and receiving took 2.165 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.016 ms

This SCF took 26566.095 ms, scf error = 1.514e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135257, lowerbound = -1.047212, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1325.478 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.671 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.261 ms
rank =  0, finding HY took 21.553 ms
rank =  0, distributing HY into block cyclic form took 15.052 ms
rank =  0, finding Y'*HY took 2.187 ms
Rank 0, Project_Hamiltonian used 55.084 ms
Total time for projection: 55.099 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.047165256727955
    last  calculated eigval = 0.035171393665484
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04716525672796
lambda[   2] =  -0.61266533040677
lambda[   3] =  -0.54380362948036
lambda[   4] =  -0.46544318582993
lambda[   5] =  -0.43634347575918
lambda[   6] =  -0.34284837702517
lambda[   7] =  -0.31657858386550
lambda[   8] =  -0.23830190712368
lambda[   9] =  -0.11056147442037
lambda[  10] =  -0.01326550214021
lambda[  11] =   0.01353949441145
lambda[  12] =   0.02017226940365
lambda[  13] =   0.02697052222513
lambda[  14] =   0.03517139366548
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.572 ms
rank =  0, Distributing orbital back into band + domain format took 13.254 ms
rank = 0, Subspace_Rotation used 17.841 ms

Total time for subspace rotation: 17.849 ms
rank = 0, Efermi =  -0.140137774345 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.429 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.708 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1402.407 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 1.016 ms
rank = 0, Transfering density took 1.025 ms
Etot    =   -27.861647694435
Eband   =    -8.006299493834
E1      =    18.026963228525
E2      =    -7.504962040890
E3      =    -9.827154215259
Exc     =    -8.817623317248
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 2.725e-07, dEband = 1.309e-04
rank = 0, Calculating/Estimating energy took 1.028 ms, Etot = -27.861647694, dEtot = 2.725e-07, dEband = 1.309e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0279820615369, which took 0.051 ms

iter_count = 108, r_2norm = 7.121e-07, tol*||rhs|| = 1.119e-06

Anderson update took 64.608 ms, out of which F'*F took 29.496 ms; b-Ax took 199.814 ms, out of which Lap took 178.358 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263854, int_b + int_rho = -1.910e-13, checking this took 0.119 ms
2-norm of RHS = 552.5616618360503, which took 0.111 ms

iter_count = 12, r_2norm = 5.264e-04, tol*||rhs|| = 5.526e-04

Anderson update took 7.168 ms, out of which F'*F took 3.358 ms; b-Ax took 22.510 ms, out of which Lap took 20.055 ms
Solving Poisson took 52.955 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.095366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.084863 
Total time for convolution: 	 convolve: 5.084532 
Total time for convolution: 	 convolve: 5.100364 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 27952.558 ms, scf error = 1.335e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135171, lowerbound = -1.047165, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1354.817 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.669 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.589 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 16.319 ms
rank =  0, finding HY took 20.846 ms
rank =  0, distributing HY into block cyclic form took 14.893 ms
rank =  0, finding Y'*HY took 2.172 ms
Rank 0, Project_Hamiltonian used 54.271 ms
Total time for projection: 54.288 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -1.047164367637916
    last  calculated eigval = 0.034973516557063
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04716436763792
lambda[   2] =  -0.61266469861721
lambda[   3] =  -0.54380286521156
lambda[   4] =  -0.46544270433150
lambda[   5] =  -0.43634274229864
lambda[   6] =  -0.34284751658049
lambda[   7] =  -0.31657808939042
lambda[   8] =  -0.23830116584363
lambda[   9] =  -0.11056107698015
lambda[  10] =  -0.01330927758734
lambda[  11] =   0.01352099210559
lambda[  12] =   0.02012500048949
lambda[  13] =   0.02692922438733
lambda[  14] =   0.03497351655706
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 4.515 ms
rank =  0, Distributing orbital back into band + domain format took 13.259 ms
rank = 0, Subspace_Rotation used 17.802 ms

Total time for subspace rotation: 17.809 ms
rank = 0, Efermi =  -0.140137376802 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.431 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1431.044 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.653 ms
rank = 0, D2D took 0.917 ms
rank = 0, Transfering density took 0.927 ms
Etot    =   -27.861647715883
Eband   =    -8.006288301220
E1      =    18.026950537623
E2      =    -7.504963443206
E3      =    -9.827155030534
Exc     =    -8.817624057999
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 4.290e-09, dEband = 2.239e-06
rank = 0, Calculating/Estimating energy took 1.059 ms, Etot = -27.861647716, dEtot = 4.290e-09, dEband = 2.239e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281934142929, which took 0.056 ms

iter_count = 108, r_2norm = 6.880e-07, tol*||rhs|| = 1.128e-06

Anderson update took 64.761 ms, out of which F'*F took 29.517 ms; b-Ax took 199.937 ms, out of which Lap took 178.153 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.635 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263850, int_b + int_rho = -2.256e-13, checking this took 0.114 ms
2-norm of RHS = 552.5598063420781, which took 0.127 ms

iter_count = 96, r_2norm = 5.411e-04, tol*||rhs|| = 5.526e-04

Anderson update took 57.000 ms, out of which F'*F took 26.446 ms; b-Ax took 180.133 ms, out of which Lap took 160.479 ms
Solving Poisson took 398.551 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.100279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.081607 
Total time for convolution: 	 convolve: 5.087920 
Total time for convolution: 	 convolve: 5.080760 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.052 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26621.234 ms, scf error = 1.316e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134974, lowerbound = -1.047164, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1334.478 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.707 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.552 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 16.319 ms
rank =  0, finding HY took 21.076 ms
rank =  0, distributing HY into block cyclic form took 15.028 ms
rank =  0, finding Y'*HY took 2.216 ms
Rank 0, Project_Hamiltonian used 54.696 ms
Total time for projection: 54.715 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -1.047112872218245
    last  calculated eigval = 0.034927215386865
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04711287221824
lambda[   2] =  -0.61262814280264
lambda[   3] =  -0.54376734778130
lambda[   4] =  -0.46540506605311
lambda[   5] =  -0.43630780841249
lambda[   6] =  -0.34281710853495
lambda[   7] =  -0.31654485971938
lambda[   8] =  -0.23826822860636
lambda[   9] =  -0.11053003366680
lambda[  10] =  -0.01319249466242
lambda[  11] =   0.01346436335604
lambda[  12] =   0.02010205859563
lambda[  13] =   0.02683736832805
lambda[  14] =   0.03492721538687
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.612 ms
rank =  0, subspace rotation using ScaLAPACK took 4.525 ms
rank =  0, Distributing orbital back into band + domain format took 13.693 ms
rank = 0, Subspace_Rotation used 18.242 ms

Total time for subspace rotation: 18.247 ms
rank = 0, Efermi =  -0.140106333370 calculate fermi energy took 0.101 ms
rank = 0, --- Calculate rho: sum over local bands took 2.418 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.756 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1411.491 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.638 ms
rank = 0, D2D took 0.877 ms
rank = 0, Transfering density took 0.888 ms
Etot    =   -27.861646292839
Eband   =    -8.005702869654
E1      =    18.026548413894
E2      =    -7.504766460135
E3      =    -9.827236367803
Exc     =    -8.817690296991
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 2.846e-07, dEband = 1.171e-04
rank = 0, Calculating/Estimating energy took 1.096 ms, Etot = -27.861646293, dEtot = 2.846e-07, dEband = 1.171e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0212867053214, which took 0.056 ms

iter_count = 108, r_2norm = 6.336e-07, tol*||rhs|| = 8.515e-07

Anderson update took 64.464 ms, out of which F'*F took 29.407 ms; b-Ax took 201.427 ms, out of which Lap took 178.180 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.235 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263853, int_b + int_rho = -1.965e-13, checking this took 0.118 ms
2-norm of RHS = 552.5580093438240, which took 0.133 ms

iter_count = 108, r_2norm = 5.167e-04, tol*||rhs|| = 5.526e-04

Anderson update took 65.385 ms, out of which F'*F took 30.029 ms; b-Ax took 203.390 ms, out of which Lap took 181.027 ms
Solving Poisson took 448.839 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.083722 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.685 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.096958 
Total time for convolution: 	 convolve: 5.080422 
Total time for convolution: 	 convolve: 5.085788 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26667.645 ms, scf error = 1.072e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.134927, lowerbound = -1.047113, upperbound = 267.579713

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1341.299 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.749 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 16.335 ms
rank =  0, finding HY took 20.929 ms
rank =  0, distributing HY into block cyclic form took 14.997 ms
rank =  0, finding Y'*HY took 2.230 ms
Rank 0, Project_Hamiltonian used 55.039 ms
Total time for projection: 55.060 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -1.046988427148228
    last  calculated eigval = 0.034533175851749
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04698842714823
lambda[   2] =  -0.61252540427385
lambda[   3] =  -0.54365746693807
lambda[   4] =  -0.46530427000857
lambda[   5] =  -0.43620321311300
lambda[   6] =  -0.34270766760603
lambda[   7] =  -0.31644532770217
lambda[   8] =  -0.23816473728132
lambda[   9] =  -0.11043038591214
lambda[  10] =  -0.01334350089588
lambda[  11] =   0.01322282200843
lambda[  12] =   0.01998470593790
lambda[  13] =   0.02632650886404
lambda[  14] =   0.03453317585175
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.699 ms
rank =  0, subspace rotation using ScaLAPACK took 3.943 ms
rank =  0, Distributing orbital back into band + domain format took 14.148 ms
rank = 0, Subspace_Rotation used 18.110 ms

Total time for subspace rotation: 18.114 ms
rank = 0, Efermi =  -0.140006685723 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.444 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1418.621 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.729 ms
rank = 0, D2D took 0.979 ms
rank = 0, Transfering density took 0.985 ms
Etot    =   -27.861657835125
Eband   =    -8.003993029538
E1      =    18.025522081042
E2      =    -7.504015649649
E3      =    -9.827482920863
Exc     =    -8.817881089113
Esc     =   -46.396804367643
Entropy =    -0.000000000385
dE = 2.308e-06, dEband = 3.420e-04
rank = 0, Calculating/Estimating energy took 1.088 ms, Etot = -27.861657835, dEtot = 2.308e-06, dEband = 3.420e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0158406213036, which took 0.052 ms

iter_count = 108, r_2norm = 4.841e-07, tol*||rhs|| = 6.336e-07

Anderson update took 64.329 ms, out of which F'*F took 29.405 ms; b-Ax took 200.316 ms, out of which Lap took 178.416 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.808 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001263873, int_rho =  16.00000001263859, int_b + int_rho = -1.364e-13, checking this took 0.141 ms
2-norm of RHS = 552.5611405654644, which took 0.127 ms

iter_count = 114, r_2norm = 4.527e-04, tol*||rhs|| = 5.526e-04

Anderson update took 68.077 ms, out of which F'*F took 31.583 ms; b-Ax took 214.570 ms, out of which Lap took 191.255 ms
Solving Poisson took 473.782 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.092309 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 2.336 ms
Total time for convolution: 	 convolve: 5.098295 
Total time for convolution: 	 convolve: 5.082098 
Total time for convolution: 	 convolve: 5.085085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26681.225 ms, scf error = 7.374e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.04698842714823, occ[   1] =   2.00000000000000
lambda[   2] =  -0.61252540427385, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54365746693807, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46530427000857, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43620321311300, occ[   5] =   2.00000000000000
lambda[   6] =  -0.34270766760603, occ[   6] =   2.00000000000000
lambda[   7] =  -0.31644532770217, occ[   7] =   2.00000000000000
lambda[   8] =  -0.23816473728132, occ[   8] =   2.00000000000000
lambda[   9] =  -0.11043038591214, occ[   9] =   0.00000001263855
lambda[  10] =  -0.01334350089588, occ[  10] =   0.00000000000000
lambda[  11] =   0.01322282200843, occ[  11] =   0.00000000000000
lambda[  12] =   0.01998470593790, occ[  12] =   0.00000000000000
lambda[  13] =   0.02632650886404, occ[  13] =   0.00000000000000
lambda[  14] =   0.03453317585175, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.559 ms, time for Allreduce/Reduce: 5.468 ms 
Time for calculating local force components: 14.778 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.04562707878272  -0.00000000465806  -0.02734990456921
  0.04562707283420  -0.00000000362104  -0.02734990287333
 -0.00000012777881   0.00000075573082  -0.31177295446398
 -0.00000055249360  -0.97241690622438   0.51058466794939
 -0.00000076473707   0.97241743516492   0.51058520870007
force_loc = 
  0.04917230788370   0.00000008990278   0.02984446810219
 -0.04917217059970  -0.00000002254455   0.02984432299719
 -0.00000009049369   0.00000329142620   0.30279133532427
 -0.00000113643848   0.95615139979327  -0.49890647795267
 -0.00000166492920  -0.95615141671666  -0.49890490087685
Time for calculating nonlocal force components: 28.362 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000000933959   0.00000017725335   0.01097042877886
[0m[32m -0.00000005295169   0.02009855776522  -0.01517343674789
[0m[32m -0.00000006069527  -0.02009854391081  -0.01517328847489
[0mTime for calculating XC forces components: 18.343 ms
 Cartesian force = 
  0.00354609480536  -0.00000087662749   0.00249665035435
 -0.00354423206112  -0.00000098803780   0.00249650694523
  0.00000063809230   0.00000326253815   0.00199089646053
 -0.00000087617939   0.00383208946190  -0.00349315992980
 -0.00000162465716  -0.00383348733476  -0.00349089383031
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.994 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Time for printing density: 373.188 ms
The program took 547.162 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:47
Job ID:        2266745
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:51:48,vmem=8312K,walltime=00:09:19,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-35-1
---------------------------------------
