---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:29
Job ID:    2266729
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:36
Job ID:    2266729
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.065 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 22.269 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 15.718 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 61.833 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.993 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.086 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.916164	   12.632900	   10.000000	
   11.803876	    7.367100	   11.741878	
   11.803876	    7.367100	    8.258122	
    9.838791	   10.592912	   10.000000	
   11.087313	    8.167613	   10.000000	
    8.196124	    8.860424	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.169 ms
Set up communicators.

--set up spincomm took 2.268 ms

--set up kptcomm took 0.352 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.096 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.999 ms

Calculate_SplineDerivRadFun took 0.197 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.314 ms.
time spent on vectorized spline interp: 2.401 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.032 ms.
time spent on vectorized spline interp: 1.888 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.525 ms.
time spent on vectorized spline interp: 1.868 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.530 ms.

Calculating rb for all atom types took 16.371 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.041 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000177110, sum_int_rho = 15.6927040909643
PosCharge = 16.000000017711, NegCharge = -15.692704090964, scal_fac = 1.019582088910
After scaling, int_rho = 16.0000000177110, PosCharge + NegCharge - NetCharge = -3.553e-14
--Calculate Vref took 0.370 ms
--Calculate rho_guess took 2.166 ms

 integral of b = -16.0000000177110,
 int{b} + Nelectron + NetCharge = -1.771e-08,
 Esc = -41.6317767853339,
 MPI_Reduce took 5.892 ms

Calculating b & b_ref took 14.246 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.079 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.044 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771097, int_b + int_rho = -2.728e-14, checking this took 0.088 ms
2-norm of RHS = 585.6155289907030, which took 0.139 ms

iter_count = 420, r_2norm = 5.568e-04, tol*||rhs|| = 5.856e-04

Anderson update took 254.312 ms, out of which F'*F took 117.202 ms; b-Ax took 802.363 ms, out of which Lap took 712.813 ms
Solving Poisson took 1759.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.828 ms
Total time for convolution: 	 convolve: 5.113007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
Total time for convolution: 	 convolve: 5.105404 
Total time for convolution: 	 convolve: 5.113077 
Total time for convolution: 	 convolve: 5.114140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
rank = 0, XC calculation took 24296.140 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 1.068 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.758 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.938 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.135 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.856 ms
    Lanczos iter 53, eigmin  = -1.011871217, eigmax = 264.925110311, err_eigmin = 8.235e-04, err_eigmax = 9.625e-03
rank =   0, Lanczos took 132.781 ms, eigmin = -1.011871217306, eigmax = 267.574361414497

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.231245, lowerbound = -1.111871, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1374.221 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 16.142 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.638 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.417 ms
rank =  0, Distribute data + matrix mult took 19.221 ms
rank =  0, finding HY took 21.564 ms
rank =  0, distributing HY into block cyclic form took 15.534 ms
rank =  0, finding Y'*HY took 2.368 ms
Rank 0, Project_Hamiltonian used 58.720 ms
Total time for projection: 58.732 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.338 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.957 ms
rank = 0, Solve_Generalized_EigenProblem used 2.467 ms
    first calculated eigval = 2.793237116412339
    last  calculated eigval = 3.179600449341966
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79323711641234
lambda[   2] =   2.84458314263388
lambda[   3] =   2.85607528580588
lambda[   4] =   2.91827675567728
lambda[   5] =   2.94504290063936
lambda[   6] =   2.99387828919308
lambda[   7] =   3.01308652641072
lambda[   8] =   3.04851567372128
lambda[   9] =   3.06339995527106
lambda[  10] =   3.07809530242956
lambda[  11] =   3.11661590412953
lambda[  12] =   3.13097650767630
lambda[  13] =   3.15516146613103
lambda[  14] =   3.17960044934197
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 2.485 ms
rank =  0, subspace rotation using ScaLAPACK took 3.955 ms
rank =  0, Distributing orbital back into band + domain format took 14.063 ms
rank = 0, Subspace_Rotation used 18.032 ms

Total time for subspace rotation: 18.036 ms
rank = 0, Efermi =   3.055957628705 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.279600, lowerbound = -1.111871, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1371.535 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.718 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.640 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.098 ms
rank =  0, Distribute data + matrix mult took 16.472 ms
rank =  0, finding HY took 21.466 ms
rank =  0, distributing HY into block cyclic form took 14.710 ms
rank =  0, finding Y'*HY took 2.413 ms
Rank 0, Project_Hamiltonian used 55.108 ms
Total time for projection: 55.124 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.851258609003603
    last  calculated eigval = 0.444087790045633
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85125860900360
lambda[   2] =  -0.37084445540662
lambda[   3] =  -0.24949956954733
lambda[   4] =  -0.08653308603253
lambda[   5] =   0.02160668607501
lambda[   6] =   0.11414587191480
lambda[   7] =   0.14547610703932
lambda[   8] =   0.19080213588718
lambda[   9] =   0.31118793478224
lambda[  10] =   0.33496762620037
lambda[  11] =   0.34710946830880
lambda[  12] =   0.38943669025302
lambda[  13] =   0.41983006276965
lambda[  14] =   0.44408779004563
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.948 ms
rank =  0, Distributing orbital back into band + domain format took 14.056 ms
rank = 0, Subspace_Rotation used 18.016 ms

Total time for subspace rotation: 18.020 ms
rank = 0, Efermi =   0.281912494611 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.544088, lowerbound = -1.111871, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1309.005 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.584 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.534 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.235 ms
rank =  0, Distribute data + matrix mult took 16.368 ms
rank =  0, finding HY took 20.804 ms
rank =  0, distributing HY into block cyclic form took 14.727 ms
rank =  0, finding Y'*HY took 2.445 ms
Rank 0, Project_Hamiltonian used 54.397 ms
Total time for projection: 54.411 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -1.017650971340590
    last  calculated eigval = 0.135494251443866
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01765097134059
lambda[   2] =  -0.70000748136785
lambda[   3] =  -0.60656117160815
lambda[   4] =  -0.52228176551785
lambda[   5] =  -0.52029580811386
lambda[   6] =  -0.40729118086260
lambda[   7] =  -0.34064086846258
lambda[   8] =  -0.32291512225203
lambda[   9] =  -0.00788365950507
lambda[  10] =   0.02921092384493
lambda[  11] =   0.07790628445456
lambda[  12] =   0.09696494710447
lambda[  13] =   0.12997512465527
lambda[  14] =   0.13549425144387
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 3.712 ms
rank =  0, Distributing orbital back into band + domain format took 14.088 ms
rank = 0, Subspace_Rotation used 17.818 ms

Total time for subspace rotation: 17.822 ms
rank = 0, Efermi =  -0.037159099814 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.235494, lowerbound = -1.111871, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1368.342 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.715 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 16.316 ms
rank =  0, finding HY took 21.085 ms
rank =  0, distributing HY into block cyclic form took 14.740 ms
rank =  0, finding Y'*HY took 2.379 ms
Rank 0, Project_Hamiltonian used 54.550 ms
Total time for projection: 54.555 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -1.017829768176211
    last  calculated eigval = 0.078109456558420
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01782976817621
lambda[   2] =  -0.70103750517800
lambda[   3] =  -0.60966902918558
lambda[   4] =  -0.52880609281478
lambda[   5] =  -0.52873032908648
lambda[   6] =  -0.42238532004559
lambda[   7] =  -0.35519134799595
lambda[   8] =  -0.34097710852644
lambda[   9] =  -0.11239172200861
lambda[  10] =  -0.03007912131985
lambda[  11] =   0.01693872322184
lambda[  12] =   0.06243312249915
lambda[  13] =   0.07472076875290
lambda[  14] =   0.07810945655842
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.978 ms
rank =  0, Distributing orbital back into band + domain format took 13.903 ms
rank = 0, Subspace_Rotation used 17.894 ms

Total time for subspace rotation: 17.898 ms
rank = 0, Efermi =  -0.141667162189 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.511 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.773 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.098 ms
rank = 0, Calculating density took 5859.265 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.521 ms
rank = 0, D2D took 1.619 ms
rank = 0, Transfering density took 1.625 ms
Etot    =   -24.190563863254
Eband   =    -9.009253004009
E1      =    18.500095275455
E2      =    -7.055298876435
E3      =    -8.862369499041
Exc     =    -7.967297724308
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 4.032e+00, dEband = 1.502e+00
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -24.190563863, dEtot = 4.032e+00, dEband = 1.502e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 38.8382228555572, which took 0.101 ms

iter_count = 96, r_2norm = 1.299e-03, tol*||rhs|| = 1.554e-03

Anderson update took 60.091 ms, out of which F'*F took 26.699 ms; b-Ax took 179.637 ms, out of which Lap took 159.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 412.352 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771092, int_b + int_rho = -7.640e-14, checking this took 0.116 ms
2-norm of RHS = 582.4785124435097, which took 0.095 ms

iter_count = 288, r_2norm = 4.619e-04, tol*||rhs|| = 5.825e-04

Anderson update took 172.289 ms, out of which F'*F took 79.652 ms; b-Ax took 540.004 ms, out of which Lap took 477.961 ms
Solving Poisson took 1199.257 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.291 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.097378 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.089750 
Total time for convolution: 	 convolve: 5.107743 
Total time for convolution: 	 convolve: 5.094789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.374 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.011 ms

This SCF took 31846.308 ms, scf error = 1.820e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.178109, lowerbound = -1.017830, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1287.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.528 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.569 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.145 ms
rank =  0, Distribute data + matrix mult took 16.257 ms
rank =  0, finding HY took 20.675 ms
rank =  0, distributing HY into block cyclic form took 14.822 ms
rank =  0, finding Y'*HY took 2.336 ms
Rank 0, Project_Hamiltonian used 54.122 ms
Total time for projection: 54.136 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.986709559536882
    last  calculated eigval = 0.047962955363664
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.98670955953688
lambda[   2] =  -0.66776959713568
lambda[   3] =  -0.59164423396823
lambda[   4] =  -0.49994224571285
lambda[   5] =  -0.49851098482558
lambda[   6] =  -0.39720408764728
lambda[   7] =  -0.33360547391792
lambda[   8] =  -0.31370412823687
lambda[   9] =  -0.11126864786115
lambda[  10] =  -0.02811761147804
lambda[  11] =  -0.00031509463700
lambda[  12] =   0.03789211091115
lambda[  13] =   0.04444732020267
lambda[  14] =   0.04796295536366
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.065 ms
rank =  0, Distributing orbital back into band + domain format took 13.965 ms
rank = 0, Subspace_Rotation used 18.046 ms

Total time for subspace rotation: 18.050 ms
rank = 0, Efermi =  -0.140544087940 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.536 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.729 ms
rank = 0, Calculating density took 1365.193 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.420 ms
rank = 0, D2D took 0.514 ms
rank = 0, Transfering density took 0.522 ms
Etot    =   -24.155281078766
Eband   =    -8.578180623933
E1      =    18.121623083556
E2      =    -7.017303968990
E3      =    -8.973364324104
Exc     =    -8.057615045615
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 5.880e-03, dEband = 7.185e-02
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -24.155281079, dEtot = 5.880e-03, dEband = 7.185e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 9.9380152696351, which took 0.108 ms

iter_count = 108, r_2norm = 2.457e-04, tol*||rhs|| = 3.975e-04

Anderson update took 63.143 ms, out of which F'*F took 30.223 ms; b-Ax took 205.514 ms, out of which Lap took 183.032 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771101, int_b + int_rho = 1.455e-14, checking this took 0.104 ms
2-norm of RHS = 577.5714466956064, which took 0.152 ms

iter_count = 306, r_2norm = 4.824e-04, tol*||rhs|| = 5.776e-04

Anderson update took 178.009 ms, out of which F'*F took 84.200 ms; b-Ax took 573.328 ms, out of which Lap took 508.847 ms
Solving Poisson took 1257.487 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.476 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.088248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.874 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.078769 
Total time for convolution: 	 convolve: 5.082556 
Total time for convolution: 	 convolve: 5.093312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.107 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.373 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.980 ms

This SCF took 27768.461 ms, scf error = 1.263e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147963, lowerbound = -0.986710, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1354.516 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.162 ms
rank =  0, Distribute data + matrix mult took 16.453 ms
rank =  0, finding HY took 21.785 ms
rank =  0, distributing HY into block cyclic form took 14.708 ms
rank =  0, finding Y'*HY took 2.431 ms
Rank 0, Project_Hamiltonian used 55.408 ms
Total time for projection: 55.426 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.926314410464832
    last  calculated eigval = 0.038164771432276
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.92631441046483
lambda[   2] =  -0.60244377333943
lambda[   3] =  -0.55103006190534
lambda[   4] =  -0.44303527226980
lambda[   5] =  -0.43871505713814
lambda[   6] =  -0.34608484689440
lambda[   7] =  -0.28846070380043
lambda[   8] =  -0.26099837010278
lambda[   9] =  -0.07989881491857
lambda[  10] =  -0.02124082739207
lambda[  11] =   0.00784711876628
lambda[  12] =   0.01421400541936
lambda[  13] =   0.02968510438691
lambda[  14] =   0.03816477143228
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 4.097 ms
rank =  0, Distributing orbital back into band + domain format took 13.980 ms
rank = 0, Subspace_Rotation used 18.853 ms

Total time for subspace rotation: 18.860 ms
rank = 0, Efermi =  -0.109174255185 calculate fermi energy took 0.626 ms
rank = 0, --- Calculate rho: sum over local bands took 2.389 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.100 ms
rank = 0, Calculating density took 1432.940 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.592 ms
rank = 0, D2D took 0.908 ms
rank = 0, Transfering density took 0.919 ms
Etot    =   -24.121270417749
Eband   =    -7.714164993245
E1      =    17.395992620812
E2      =    -6.863381138671
E3      =    -9.230398205847
Exc     =    -8.265100603965
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 5.668e-03, dEband = 1.440e-01
rank = 0, Calculating/Estimating energy took 1.086 ms, Etot = -24.121270418, dEtot = 5.668e-03, dEband = 1.440e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.3437769381931, which took 0.062 ms

iter_count = 108, r_2norm = 1.074e-04, tol*||rhs|| = 1.738e-04

Anderson update took 64.677 ms, out of which F'*F took 29.239 ms; b-Ax took 200.752 ms, out of which Lap took 179.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.009 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771098, int_b + int_rho = -1.637e-14, checking this took 0.118 ms
2-norm of RHS = 578.1636981606737, which took 0.149 ms

iter_count = 270, r_2norm = 5.096e-04, tol*||rhs|| = 5.782e-04

Anderson update took 159.221 ms, out of which F'*F took 75.125 ms; b-Ax took 514.570 ms, out of which Lap took 455.557 ms
Solving Poisson took 1122.300 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.088955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 6.802681 
Total time for convolution: 	 convolve: 5.085652 
Total time for convolution: 	 convolve: 5.095153 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.007 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 1.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 0.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.031 ms

This SCF took 29086.300 ms, scf error = 3.359e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.138165, lowerbound = -0.926314, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1368.423 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.087 ms
rank =  0, Distribute data + matrix mult took 16.353 ms
rank =  0, finding HY took 20.579 ms
rank =  0, distributing HY into block cyclic form took 14.445 ms
rank =  0, finding Y'*HY took 2.579 ms
Rank 0, Project_Hamiltonian used 53.987 ms
Total time for projection: 54.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.920008203892828
    last  calculated eigval = 0.030980202476746
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.92000820389283
lambda[   2] =  -0.59621192028232
lambda[   3] =  -0.54291032495962
lambda[   4] =  -0.43660893730743
lambda[   5] =  -0.43201262297312
lambda[   6] =  -0.33840347381856
lambda[   7] =  -0.28147134023044
lambda[   8] =  -0.25548932428598
lambda[   9] =  -0.07468212894681
lambda[  10] =  -0.02597701153201
lambda[  11] =   0.00473222954731
lambda[  12] =   0.00634509425272
lambda[  13] =   0.02242644527914
lambda[  14] =   0.03098020247675
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 4.116 ms
rank =  0, Distributing orbital back into band + domain format took 12.670 ms
rank = 0, Subspace_Rotation used 16.801 ms

Total time for subspace rotation: 16.813 ms
rank = 0, Efermi =  -0.103957569131 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.314 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.983 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.110 ms
rank = 0, Calculating density took 1444.791 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 0.848 ms
rank = 0, Transfering density took 0.857 ms
Etot    =   -24.118924401567
Eband   =    -7.606232296823
E1      =    17.347041530363
E2      =    -6.796688584583
E3      =    -9.266426149853
Exc     =    -8.291071583674
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 3.910e-04, dEband = 1.799e-02
rank = 0, Calculating/Estimating energy took 1.117 ms, Etot = -24.118924402, dEtot = 3.910e-04, dEband = 1.799e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4388772331835, which took 0.188 ms

iter_count = 114, r_2norm = 3.732e-05, tol*||rhs|| = 5.756e-05

Anderson update took 68.547 ms, out of which F'*F took 31.500 ms; b-Ax took 211.684 ms, out of which Lap took 190.153 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.150 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771105, int_b + int_rho = 5.275e-14, checking this took 0.124 ms
2-norm of RHS = 578.5558651018521, which took 0.171 ms

iter_count = 252, r_2norm = 5.406e-04, tol*||rhs|| = 5.786e-04

Anderson update took 150.578 ms, out of which F'*F took 72.467 ms; b-Ax took 488.626 ms, out of which Lap took 434.945 ms
Solving Poisson took 1064.409 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.088966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.189 ms
Total time for convolution: 	 convolve: 5.081241 
Total time for convolution: 	 convolve: 5.088629 
Total time for convolution: 	 convolve: 5.100713 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.026 ms

This SCF took 27457.820 ms, scf error = 1.276e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.130980, lowerbound = -0.920008, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1310.683 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.647 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.183 ms
rank =  0, Distribute data + matrix mult took 16.418 ms
rank =  0, finding HY took 20.957 ms
rank =  0, distributing HY into block cyclic form took 14.727 ms
rank =  0, finding Y'*HY took 2.610 ms
Rank 0, Project_Hamiltonian used 54.742 ms
Total time for projection: 54.757 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.044 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.916631471660097
    last  calculated eigval = 0.026859491137778
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.91663147166010
lambda[   2] =  -0.59203521682680
lambda[   3] =  -0.53933088833817
lambda[   4] =  -0.43249724965097
lambda[   5] =  -0.42808396940983
lambda[   6] =  -0.33457487703140
lambda[   7] =  -0.27785508390662
lambda[   8] =  -0.25202865506439
lambda[   9] =  -0.07218385554041
lambda[  10] =  -0.02833532662684
lambda[  11] =   0.00202514638744
lambda[  12] =   0.00526887854754
lambda[  13] =   0.01874917934938
lambda[  14] =   0.02685949113778
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 4.409 ms
rank =  0, Distributing orbital back into band + domain format took 13.416 ms
rank = 0, Subspace_Rotation used 17.846 ms

Total time for subspace rotation: 17.853 ms
rank = 0, Efermi =  -0.101459295694 calculate fermi energy took 0.144 ms
rank = 0, --- Calculate rho: sum over local bands took 2.441 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1387.533 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.587 ms
rank = 0, D2D took 0.924 ms
rank = 0, Transfering density took 0.928 ms
Etot    =   -24.118210718500
Eband   =    -7.546074825055
E1      =    17.321329248679
E2      =    -6.757913170346
E3      =    -9.283435085372
Exc     =    -8.303036611975
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.189e-04, dEband = 1.003e-02
rank = 0, Calculating/Estimating energy took 1.120 ms, Etot = -24.118210719, dEtot = 1.189e-04, dEband = 1.003e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5863501653651, which took 0.098 ms

iter_count = 114, r_2norm = 1.486e-05, tol*||rhs|| = 2.345e-05

Anderson update took 68.877 ms, out of which F'*F took 31.477 ms; b-Ax took 216.738 ms, out of which Lap took 191.777 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.779 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771099, int_b + int_rho = -1.091e-14, checking this took 0.122 ms
2-norm of RHS = 578.9748758658227, which took 0.141 ms

iter_count = 252, r_2norm = 5.443e-04, tol*||rhs|| = 5.790e-04

Anderson update took 152.912 ms, out of which F'*F took 69.902 ms; b-Ax took 471.019 ms, out of which Lap took 423.223 ms
Solving Poisson took 1044.802 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.084542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.089776 
Total time for convolution: 	 convolve: 5.092486 
Total time for convolution: 	 convolve: 5.090677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.150 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.319 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 27275.513 ms, scf error = 6.913e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.126859, lowerbound = -0.916631, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1351.426 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.665 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.244 ms
rank =  0, Distribute data + matrix mult took 16.475 ms
rank =  0, finding HY took 21.034 ms
rank =  0, distributing HY into block cyclic form took 15.278 ms
rank =  0, finding Y'*HY took 2.051 ms
Rank 0, Project_Hamiltonian used 54.871 ms
Total time for projection: 54.886 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.571 ms
rank = 0, Solve_Generalized_EigenProblem used 1.356 ms
    first calculated eigval = -0.912795565348939
    last  calculated eigval = 0.025226967401853
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.91279556534894
lambda[   2] =  -0.58702102151677
lambda[   3] =  -0.53664176678397
lambda[   4] =  -0.42774379306000
lambda[   5] =  -0.42366802709367
lambda[   6] =  -0.33068745517987
lambda[   7] =  -0.27413666202989
lambda[   8] =  -0.24773068236812
lambda[   9] =  -0.06966369274428
lambda[  10] =  -0.02884225694798
lambda[  11] =   0.00131363400880
lambda[  12] =   0.00623799264996
lambda[  13] =   0.01719691439475
lambda[  14] =   0.02522696740185
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.371 ms
rank =  0, subspace rotation using ScaLAPACK took 3.709 ms
rank =  0, Distributing orbital back into band + domain format took 14.473 ms
rank = 0, Subspace_Rotation used 18.204 ms

Total time for subspace rotation: 18.208 ms
rank = 0, Efermi =  -0.098939132926 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1429.371 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.660 ms
rank = 0, D2D took 0.889 ms
rank = 0, Transfering density took 0.900 ms
Etot    =   -24.117795791676
Eband   =    -7.480849947996
E1      =    17.294423169810
E2      =    -6.716052629174
E3      =    -9.295501048785
Exc     =    -8.311145905580
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 6.915e-05, dEband = 1.087e-02
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -24.117795792, dEtot = 6.915e-05, dEband = 1.087e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4323436030019, which took 0.062 ms

iter_count = 108, r_2norm = 1.703e-05, tol*||rhs|| = 1.729e-05

Anderson update took 65.117 ms, out of which F'*F took 30.648 ms; b-Ax took 206.107 ms, out of which Lap took 183.732 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.420 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771099, int_b + int_rho = -7.276e-15, checking this took 0.112 ms
2-norm of RHS = 579.1059472813232, which took 0.135 ms

iter_count = 246, r_2norm = 4.669e-04, tol*||rhs|| = 5.791e-04

Anderson update took 150.575 ms, out of which F'*F took 67.974 ms; b-Ax took 459.622 ms, out of which Lap took 410.683 ms
Solving Poisson took 1019.659 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.104295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.566 ms
Total time for convolution: 	 convolve: 5.089393 
Total time for convolution: 	 convolve: 5.085759 
Total time for convolution: 	 convolve: 5.090514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.702 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.017 ms

This SCF took 27264.798 ms, scf error = 3.455e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.125227, lowerbound = -0.912796, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1317.787 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.584 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.176 ms
rank =  0, Distribute data + matrix mult took 16.404 ms
rank =  0, finding HY took 20.912 ms
rank =  0, distributing HY into block cyclic form took 14.499 ms
rank =  0, finding Y'*HY took 1.900 ms
Rank 0, Project_Hamiltonian used 54.662 ms
Total time for projection: 54.729 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.909204847982211
    last  calculated eigval = 0.025773045364836
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90920484798221
lambda[   2] =  -0.58390821783595
lambda[   3] =  -0.53408452081013
lambda[   4] =  -0.42476612800510
lambda[   5] =  -0.42039654872651
lambda[   6] =  -0.32717607536183
lambda[   7] =  -0.27097848877069
lambda[   8] =  -0.24438026648004
lambda[   9] =  -0.06682357187112
lambda[  10] =  -0.02803307725345
lambda[  11] =   0.00217333679250
lambda[  12] =   0.00794874716923
lambda[  13] =   0.01727690703061
lambda[  14] =   0.02577304536484
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.850 ms
rank =  0, Distributing orbital back into band + domain format took 14.237 ms
rank = 0, Subspace_Rotation used 18.102 ms

Total time for subspace rotation: 18.106 ms
rank = 0, Efermi =  -0.096099012081 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.449 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.783 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1394.245 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.702 ms
rank = 0, D2D took 0.907 ms
rank = 0, Transfering density took 0.914 ms
Etot    =   -24.117677551245
Eband   =    -7.429790189128
E1      =    17.270081207436
E2      =    -6.687259528604
E3      =    -9.302720376594
Exc     =    -8.316171688883
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.971e-05, dEband = 8.510e-03
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -24.117677551, dEtot = 1.971e-05, dEband = 8.510e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2349514976741, which took 0.113 ms

iter_count = 114, r_2norm = 6.334e-06, tol*||rhs|| = 9.398e-06

Anderson update took 67.469 ms, out of which F'*F took 31.791 ms; b-Ax took 214.995 ms, out of which Lap took 191.619 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.782 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771095, int_b + int_rho = -4.911e-14, checking this took 0.102 ms
2-norm of RHS = 579.1116802365531, which took 0.120 ms

iter_count = 228, r_2norm = 4.855e-04, tol*||rhs|| = 5.791e-04

Anderson update took 135.325 ms, out of which F'*F took 63.484 ms; b-Ax took 439.052 ms, out of which Lap took 393.698 ms
Solving Poisson took 947.780 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.090705 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.134020 
Total time for convolution: 	 convolve: 5.098733 
Total time for convolution: 	 convolve: 5.085251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 27229.285 ms, scf error = 2.013e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125773, lowerbound = -0.909205, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1307.246 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.233 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.396 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 15.671 ms
rank =  0, finding HY took 21.226 ms
rank =  0, distributing HY into block cyclic form took 14.791 ms
rank =  0, finding Y'*HY took 2.227 ms
Rank 0, Project_Hamiltonian used 54.966 ms
Total time for projection: 55.003 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.906987546411589
    last  calculated eigval = 0.026879033309867
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90698754641159
lambda[   2] =  -0.58166379847813
lambda[   3] =  -0.53247532466312
lambda[   4] =  -0.42265713273702
lambda[   5] =  -0.41820745726146
lambda[   6] =  -0.32513919017712
lambda[   7] =  -0.26902326386046
lambda[   8] =  -0.24225323979157
lambda[   9] =  -0.06506741398177
lambda[  10] =  -0.02680025188309
lambda[  11] =   0.00376729379148
lambda[  12] =   0.00960335506598
lambda[  13] =   0.01823110255637
lambda[  14] =   0.02687903330987
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.129 ms
rank =  0, subspace rotation using ScaLAPACK took 3.951 ms
rank =  0, Distributing orbital back into band + domain format took 14.131 ms
rank = 0, Subspace_Rotation used 18.100 ms

Total time for subspace rotation: 18.104 ms
rank = 0, Efermi =  -0.094342854240 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.760 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1383.935 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.674 ms
rank = 0, D2D took 0.937 ms
rank = 0, Transfering density took 0.944 ms
Etot    =   -24.117683620755
Eband   =    -7.396813907913
E1      =    17.252219163340
E2      =    -6.671051683829
E3      =    -9.307134187721
Exc     =    -8.319497961863
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.012e-06, dEband = 5.496e-03
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -24.117683621, dEtot = 1.012e-06, dEband = 5.496e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1680993145355, which took 0.054 ms

iter_count = 114, r_2norm = 4.310e-06, tol*||rhs|| = 6.724e-06

Anderson update took 67.670 ms, out of which F'*F took 31.556 ms; b-Ax took 215.593 ms, out of which Lap took 192.114 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.859 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771101, int_b + int_rho = 7.276e-15, checking this took 0.088 ms
2-norm of RHS = 579.1026932597206, which took 0.120 ms

iter_count = 216, r_2norm = 4.957e-04, tol*||rhs|| = 5.791e-04

Anderson update took 128.182 ms, out of which F'*F took 59.829 ms; b-Ax took 404.947 ms, out of which Lap took 361.283 ms
Solving Poisson took 887.531 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.208 ms
Total time for convolution: 	 convolve: 5.100769 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.084265 
Total time for convolution: 	 convolve: 5.092210 
Total time for convolution: 	 convolve: 5.091061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.015 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.004 ms

This SCF took 27104.326 ms, scf error = 1.351e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126879, lowerbound = -0.906988, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1309.875 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.588 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.658 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.142 ms
rank =  0, Distribute data + matrix mult took 16.410 ms
rank =  0, finding HY took 20.855 ms
rank =  0, distributing HY into block cyclic form took 14.905 ms
rank =  0, finding Y'*HY took 13.936 ms
Rank 0, Project_Hamiltonian used 66.150 ms
Total time for projection: 66.170 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.443 ms
rank = 0, Solve_Generalized_EigenProblem used 0.517 ms
    first calculated eigval = -0.905988516149025
    last  calculated eigval = 0.027980193659740
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90598851614902
lambda[   2] =  -0.58071718612265
lambda[   3] =  -0.53151211218709
lambda[   4] =  -0.42167389739239
lambda[   5] =  -0.41722631509528
lambda[   6] =  -0.32409676047952
lambda[   7] =  -0.26796878315398
lambda[   8] =  -0.24129204603258
lambda[   9] =  -0.06394451877825
lambda[  10] =  -0.02490097570749
lambda[  11] =   0.00598411900580
lambda[  12] =   0.01132877030033
lambda[  13] =   0.02025821740742
lambda[  14] =   0.02798019365974
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.550 ms
rank =  0, subspace rotation using ScaLAPACK took 3.958 ms
rank =  0, Distributing orbital back into band + domain format took 14.196 ms
rank = 0, Subspace_Rotation used 18.171 ms

Total time for subspace rotation: 18.175 ms
rank = 0, Efermi =  -0.093219958914 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.460 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.789 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1398.238 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.838 ms
rank = 0, D2D took 1.032 ms
rank = 0, Transfering density took 1.040 ms
Etot    =   -24.117721731395
Eband   =    -7.380951234358
E1      =    17.245121857095
E2      =    -6.662034886845
E3      =    -9.308136788670
Exc     =    -8.320287243780
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 6.352e-06, dEband = 2.644e-03
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -24.117721731, dEtot = 6.352e-06, dEband = 2.644e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0834546246327, which took 0.066 ms

iter_count = 114, r_2norm = 2.432e-06, tol*||rhs|| = 3.338e-06

Anderson update took 67.763 ms, out of which F'*F took 31.949 ms; b-Ax took 215.409 ms, out of which Lap took 191.933 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.400 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771098, int_b + int_rho = -2.183e-14, checking this took 0.108 ms
2-norm of RHS = 579.0821541325529, which took 0.136 ms

iter_count = 210, r_2norm = 5.548e-04, tol*||rhs|| = 5.791e-04

Anderson update took 124.815 ms, out of which F'*F took 58.746 ms; b-Ax took 392.306 ms, out of which Lap took 348.824 ms
Solving Poisson took 863.967 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.081827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.093415 
Total time for convolution: 	 convolve: 5.088485 
Total time for convolution: 	 convolve: 5.096695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.491 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.554 ms

This SCF took 27091.238 ms, scf error = 9.257e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127980, lowerbound = -0.905989, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1320.085 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.702 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.145 ms
rank =  0, Distribute data + matrix mult took 16.405 ms
rank =  0, finding HY took 20.868 ms
rank =  0, distributing HY into block cyclic form took 14.761 ms
rank =  0, finding Y'*HY took 2.258 ms
Rank 0, Project_Hamiltonian used 54.320 ms
Total time for projection: 54.336 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.904780972697633
    last  calculated eigval = 0.030095941531215
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90478097269763
lambda[   2] =  -0.57940163259651
lambda[   3] =  -0.53053376097757
lambda[   4] =  -0.42038254140120
lambda[   5] =  -0.41597614777216
lambda[   6] =  -0.32290055644401
lambda[   7] =  -0.26676184313073
lambda[   8] =  -0.24006383697813
lambda[   9] =  -0.06267499363109
lambda[  10] =  -0.02137509488296
lambda[  11] =   0.01014937959392
lambda[  12] =   0.01408896669784
lambda[  13] =   0.02418007185143
lambda[  14] =   0.03009594153121
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.866 ms
rank =  0, Distributing orbital back into band + domain format took 14.247 ms
rank = 0, Subspace_Rotation used 18.129 ms

Total time for subspace rotation: 18.133 ms
rank = 0, Efermi =  -0.091950433881 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.445 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.796 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1396.116 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.657 ms
rank = 0, D2D took 0.881 ms
rank = 0, Transfering density took 0.885 ms
Etot    =   -24.117742928226
Eband   =    -7.361602585106
E1      =    17.235131834963
E2      =    -6.652332295888
E3      =    -9.309945512459
Exc     =    -8.321773200561
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 3.533e-06, dEband = 3.225e-03
rank = 0, Calculating/Estimating energy took 1.077 ms, Etot = -24.117742928, dEtot = 3.533e-06, dEband = 3.225e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0679113962710, which took 0.052 ms

iter_count = 114, r_2norm = 2.092e-06, tol*||rhs|| = 2.716e-06

Anderson update took 67.514 ms, out of which F'*F took 31.428 ms; b-Ax took 215.207 ms, out of which Lap took 191.851 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.953 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771098, int_b + int_rho = -1.273e-14, checking this took 0.106 ms
2-norm of RHS = 579.0830115055709, which took 0.068 ms

iter_count = 174, r_2norm = 5.101e-04, tol*||rhs|| = 5.791e-04

Anderson update took 102.924 ms, out of which F'*F took 48.570 ms; b-Ax took 326.170 ms, out of which Lap took 290.867 ms
Solving Poisson took 715.095 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.087218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.889 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.102063 
Total time for convolution: 	 convolve: 5.093819 
Total time for convolution: 	 convolve: 5.093387 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.385 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.459 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.754 ms

This SCF took 26960.551 ms, scf error = 5.815e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130096, lowerbound = -0.904781, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1312.997 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.885 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.532 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 16.485 ms
rank =  0, finding HY took 20.878 ms
rank =  0, distributing HY into block cyclic form took 14.802 ms
rank =  0, finding Y'*HY took 2.242 ms
Rank 0, Project_Hamiltonian used 54.437 ms
Total time for projection: 54.452 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.904264965485483
    last  calculated eigval = 0.029964351290236
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90426496548548
lambda[   2] =  -0.57891278598775
lambda[   3] =  -0.53012429082672
lambda[   4] =  -0.41990684307341
lambda[   5] =  -0.41549562602010
lambda[   6] =  -0.32242008887588
lambda[   7] =  -0.26629756278412
lambda[   8] =  -0.23958946652300
lambda[   9] =  -0.06221487714475
lambda[  10] =  -0.02048515068955
lambda[  11] =   0.01102680492190
lambda[  12] =   0.01405068502619
lambda[  13] =   0.02488545135449
lambda[  14] =   0.02996435129024
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.997 ms
rank =  0, Distributing orbital back into band + domain format took 14.134 ms
rank = 0, Subspace_Rotation used 18.145 ms

Total time for subspace rotation: 18.149 ms
rank = 0, Efermi =  -0.091490317219 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 2.431 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.794 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1389.206 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.647 ms
rank = 0, D2D took 0.865 ms
rank = 0, Transfering density took 0.869 ms
Etot    =   -24.117799796372
Eband   =    -7.354023260255
E1      =    17.230976130338
E2      =    -6.648668646300
E3      =    -9.310853962276
Exc     =    -8.322498489163
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 9.478e-06, dEband = 1.263e-03
rank = 0, Calculating/Estimating energy took 1.096 ms, Etot = -24.117799796, dEtot = 9.478e-06, dEband = 1.263e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0458104325759, which took 0.083 ms

iter_count = 108, r_2norm = 1.442e-06, tol*||rhs|| = 1.832e-06

Anderson update took 63.905 ms, out of which F'*F took 29.913 ms; b-Ax took 203.327 ms, out of which Lap took 180.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.223 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771105, int_b + int_rho = 4.729e-14, checking this took 0.105 ms
2-norm of RHS = 579.1071859264246, which took 0.133 ms

iter_count = 192, r_2norm = 5.680e-04, tol*||rhs|| = 5.791e-04

Anderson update took 113.419 ms, out of which F'*F took 59.409 ms; b-Ax took 364.862 ms, out of which Lap took 325.692 ms
Solving Poisson took 794.128 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.092762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.134589 
Total time for convolution: 	 convolve: 5.113250 
Total time for convolution: 	 convolve: 5.089067 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.590 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.281 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 27047.479 ms, scf error = 4.658e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.129964, lowerbound = -0.904265, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1314.594 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.610 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.545 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.228 ms
rank =  0, Distribute data + matrix mult took 16.398 ms
rank =  0, finding HY took 20.821 ms
rank =  0, distributing HY into block cyclic form took 14.774 ms
rank =  0, finding Y'*HY took 2.258 ms
Rank 0, Project_Hamiltonian used 54.277 ms
Total time for projection: 54.341 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.903749801092536
    last  calculated eigval = 0.032723715510271
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90374980109254
lambda[   2] =  -0.57838472436199
lambda[   3] =  -0.52953721456837
lambda[   4] =  -0.41934509163610
lambda[   5] =  -0.41497890908593
lambda[   6] =  -0.32191496840462
lambda[   7] =  -0.26574759265412
lambda[   8] =  -0.23909186532762
lambda[   9] =  -0.06159008394408
lambda[  10] =  -0.01630682908315
lambda[  11] =   0.01418813802907
lambda[  12] =   0.01560927364295
lambda[  13] =   0.02833023773387
lambda[  14] =   0.03272371551027
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 3.888 ms
rank =  0, Distributing orbital back into band + domain format took 15.845 ms
rank = 0, Subspace_Rotation used 19.751 ms

Total time for subspace rotation: 19.754 ms
rank = 0, Efermi =  -0.090865524231 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.433 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1392.264 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.694 ms
rank = 0, D2D took 0.888 ms
rank = 0, Transfering density took 0.891 ms
Etot    =   -24.117896408217
Eband   =    -7.345500335353
E1      =    17.227531312591
E2      =    -6.643497631536
E3      =    -9.311011991793
Exc     =    -8.322660222915
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.610e-05, dEband = 1.420e-03
rank = 0, Calculating/Estimating energy took 1.944 ms, Etot = -24.117896408, dEtot = 1.610e-05, dEband = 1.420e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0439030178320, which took 0.053 ms

iter_count = 108, r_2norm = 1.607e-06, tol*||rhs|| = 1.756e-06

Anderson update took 63.883 ms, out of which F'*F took 29.436 ms; b-Ax took 203.156 ms, out of which Lap took 180.887 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.878 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771102, int_b + int_rho = 1.819e-14, checking this took 0.107 ms
2-norm of RHS = 579.1069330395410, which took 0.129 ms

iter_count = 138, r_2norm = 5.341e-04, tol*||rhs|| = 5.791e-04

Anderson update took 81.523 ms, out of which F'*F took 38.452 ms; b-Ax took 258.664 ms, out of which Lap took 230.385 ms
Solving Poisson took 568.195 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.090480 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.085843 
Total time for convolution: 	 convolve: 5.102022 
Total time for convolution: 	 convolve: 5.098327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.125 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26768.223 ms, scf error = 3.504e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132724, lowerbound = -0.903750, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1356.578 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.776 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.605 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.416 ms
rank =  0, finding HY took 20.812 ms
rank =  0, distributing HY into block cyclic form took 14.795 ms
rank =  0, finding Y'*HY took 2.248 ms
Rank 0, Project_Hamiltonian used 54.301 ms
Total time for projection: 54.318 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.903604004197898
    last  calculated eigval = 0.033753988028355
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90360400419790
lambda[   2] =  -0.57823894894645
lambda[   3] =  -0.52942670058737
lambda[   4] =  -0.41921105845095
lambda[   5] =  -0.41483455989639
lambda[   6] =  -0.32176859602493
lambda[   7] =  -0.26561328833347
lambda[   8] =  -0.23894621047146
lambda[   9] =  -0.06146702137478
lambda[  10] =  -0.01565684452244
lambda[  11] =   0.01456248960445
lambda[  12] =   0.01567647248033
lambda[  13] =   0.02855349322614
lambda[  14] =   0.03375398802836
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.971 ms
rank =  0, Distributing orbital back into band + domain format took 14.083 ms
rank = 0, Subspace_Rotation used 18.068 ms

Total time for subspace rotation: 18.071 ms
rank = 0, Efermi =  -0.090742461620 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.434 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.853 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.083 ms
rank = 0, Calculating density took 1432.600 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.702 ms
rank = 0, D2D took 1.904 ms
rank = 0, Transfering density took 1.908 ms
Etot    =   -24.117910379865
Eband   =    -7.343286734906
E1      =    17.226274774251
E2      =    -6.642466571462
E3      =    -9.311303714225
Exc     =    -8.322891919029
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 2.329e-06, dEband = 3.689e-04
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -24.117910380, dEtot = 2.329e-06, dEband = 3.689e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0427067684825, which took 0.055 ms

iter_count = 108, r_2norm = 1.596e-06, tol*||rhs|| = 1.708e-06

Anderson update took 63.937 ms, out of which F'*F took 29.991 ms; b-Ax took 203.918 ms, out of which Lap took 181.583 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771099, int_b + int_rho = -7.276e-15, checking this took 0.111 ms
2-norm of RHS = 579.1066303413322, which took 0.144 ms

iter_count = 132, r_2norm = 5.000e-04, tol*||rhs|| = 5.791e-04

Anderson update took 78.671 ms, out of which F'*F took 36.931 ms; b-Ax took 247.421 ms, out of which Lap took 220.361 ms
Solving Poisson took 544.561 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.088182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.086497 
Total time for convolution: 	 convolve: 5.084271 
Total time for convolution: 	 convolve: 5.107084 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26783.986 ms, scf error = 2.773e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133754, lowerbound = -0.903604, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1319.043 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.181 ms
rank =  0, Distribute data + matrix mult took 16.459 ms
rank =  0, finding HY took 20.725 ms
rank =  0, distributing HY into block cyclic form took 14.757 ms
rank =  0, finding Y'*HY took 2.234 ms
Rank 0, Project_Hamiltonian used 54.201 ms
Total time for projection: 54.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.903482268897747
    last  calculated eigval = 0.034616713225204
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90348226889775
lambda[   2] =  -0.57812195732535
lambda[   3] =  -0.52932849498373
lambda[   4] =  -0.41910142364087
lambda[   5] =  -0.41471874573620
lambda[   6] =  -0.32165109071883
lambda[   7] =  -0.26550361542076
lambda[   8] =  -0.23883181749002
lambda[   9] =  -0.06138684383895
lambda[  10] =  -0.01514743727298
lambda[  11] =   0.01456436338414
lambda[  12] =   0.01575107756947
lambda[  13] =   0.02862921384841
lambda[  14] =   0.03461671322520
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 3.868 ms
rank =  0, Distributing orbital back into band + domain format took 14.242 ms
rank = 0, Subspace_Rotation used 18.123 ms

Total time for subspace rotation: 18.127 ms
rank = 0, Efermi =  -0.090662283952 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.460 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.780 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1394.995 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.098 ms
rank = 0, D2D took 1.204 ms
rank = 0, Transfering density took 1.207 ms
Etot    =   -24.117927220677
Eband   =    -7.341478829514
E1      =    17.225285702187
E2      =    -6.641592367343
E3      =    -9.311490887015
Exc     =    -8.323040561840
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 2.807e-06, dEband = 3.013e-04
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -24.117927221, dEtot = 2.807e-06, dEband = 3.013e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0475429440259, which took 0.057 ms

iter_count = 102, r_2norm = 1.744e-06, tol*||rhs|| = 1.902e-06

Anderson update took 60.412 ms, out of which F'*F took 28.105 ms; b-Ax took 192.566 ms, out of which Lap took 171.513 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.841 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771100, int_b + int_rho = -3.638e-15, checking this took 0.153 ms
2-norm of RHS = 579.1055418186796, which took 0.140 ms

iter_count = 162, r_2norm = 5.391e-04, tol*||rhs|| = 5.791e-04

Anderson update took 96.064 ms, out of which F'*F took 44.760 ms; b-Ax took 302.438 ms, out of which Lap took 269.426 ms
Solving Poisson took 666.273 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.090342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 6.447808 
Total time for convolution: 	 convolve: 5.091517 
Total time for convolution: 	 convolve: 5.101487 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 28217.320 ms, scf error = 2.373e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134617, lowerbound = -0.903482, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1309.451 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.377 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.404 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.674 ms
rank =  0, Distribute data + matrix mult took 16.474 ms
rank =  0, finding HY took 21.065 ms
rank =  0, distributing HY into block cyclic form took 15.092 ms
rank =  0, finding Y'*HY took 2.547 ms
Rank 0, Project_Hamiltonian used 55.221 ms
Total time for projection: 55.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.903377089489856
    last  calculated eigval = 0.035357978550612
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90337708948986
lambda[   2] =  -0.57802131362482
lambda[   3] =  -0.52920433106859
lambda[   4] =  -0.41899868978138
lambda[   5] =  -0.41462220100459
lambda[   6] =  -0.32155414492542
lambda[   7] =  -0.26540263418233
lambda[   8] =  -0.23874518003758
lambda[   9] =  -0.06137285660990
lambda[  10] =  -0.01434357076025
lambda[  11] =   0.01381418357437
lambda[  12] =   0.01543967997895
lambda[  13] =   0.02851988044935
lambda[  14] =   0.03535797855061
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.850 ms
rank =  0, Distributing orbital back into band + domain format took 14.144 ms
rank = 0, Subspace_Rotation used 18.011 ms

Total time for subspace rotation: 18.389 ms
rank = 0, Efermi =  -0.090648296760 calculate fermi energy took 0.635 ms
rank = 0, --- Calculate rho: sum over local bands took 2.105 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.524 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 1386.610 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.652 ms
rank = 0, D2D took 0.921 ms
rank = 0, Transfering density took 0.932 ms
Etot    =   -24.117965818018
Eband   =    -7.339851169316
E1      =    17.224622529317
E2      =    -6.640625623128
E3      =    -9.311334655282
Exc     =    -8.322920670561
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 6.433e-06, dEband = 2.713e-04
rank = 0, Calculating/Estimating energy took 1.101 ms, Etot = -24.117965818, dEtot = 6.433e-06, dEband = 2.713e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0572413593273, which took 0.144 ms

iter_count = 102, r_2norm = 1.745e-06, tol*||rhs|| = 2.290e-06

Anderson update took 61.240 ms, out of which F'*F took 28.016 ms; b-Ax took 191.771 ms, out of which Lap took 170.677 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.064 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771097, int_b + int_rho = -2.547e-14, checking this took 0.103 ms
2-norm of RHS = 579.1077971528597, which took 0.105 ms

iter_count = 126, r_2norm = 5.424e-04, tol*||rhs|| = 5.791e-04

Anderson update took 74.273 ms, out of which F'*F took 35.800 ms; b-Ax took 236.766 ms, out of which Lap took 210.831 ms
Solving Poisson took 519.584 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.084700 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.087502 
Total time for convolution: 	 convolve: 5.088248 
Total time for convolution: 	 convolve: 5.086727 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.771 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26678.727 ms, scf error = 2.094e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135358, lowerbound = -0.903377, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1357.719 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.623 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.546 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.073 ms
rank =  0, Distribute data + matrix mult took 16.256 ms
rank =  0, finding HY took 21.526 ms
rank =  0, distributing HY into block cyclic form took 14.917 ms
rank =  0, finding Y'*HY took 2.209 ms
Rank 0, Project_Hamiltonian used 54.946 ms
Total time for projection: 54.963 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.903389115662445
    last  calculated eigval = 0.034956166835922
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90338911566244
lambda[   2] =  -0.57802051863183
lambda[   3] =  -0.52918923737121
lambda[   4] =  -0.41899254537753
lambda[   5] =  -0.41462228220175
lambda[   6] =  -0.32155618898557
lambda[   7] =  -0.26539736453156
lambda[   8] =  -0.23874689059970
lambda[   9] =  -0.06137432846116
lambda[  10] =  -0.01449864048701
lambda[  11] =   0.01344073330911
lambda[  12] =   0.01529057349575
lambda[  13] =   0.02824096436652
lambda[  14] =   0.03495616683592
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.493 ms
rank =  0, Distributing orbital back into band + domain format took 13.295 ms
rank = 0, Subspace_Rotation used 17.806 ms

Total time for subspace rotation: 17.835 ms
rank = 0, Efermi =  -0.090649768584 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.418 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.848 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1434.686 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.725 ms
rank = 0, D2D took 0.946 ms
rank = 0, Transfering density took 0.954 ms
Etot    =   -24.117968722873
Eband   =    -7.339828287810
E1      =    17.224791150174
E2      =    -6.640461660424
E3      =    -9.311193591724
Exc     =    -8.322810051518
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 4.841e-07, dEband = 3.814e-06
rank = 0, Calculating/Estimating energy took 1.042 ms, Etot = -24.117968723, dEtot = 4.841e-07, dEband = 3.814e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0631577230371, which took 0.121 ms

iter_count = 102, r_2norm = 1.734e-06, tol*||rhs|| = 2.526e-06

Anderson update took 60.442 ms, out of which F'*F took 28.373 ms; b-Ax took 192.450 ms, out of which Lap took 171.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.836 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771103, int_b + int_rho = 3.638e-14, checking this took 0.116 ms
2-norm of RHS = 579.1082472445354, which took 0.139 ms

iter_count = 114, r_2norm = 5.032e-04, tol*||rhs|| = 5.791e-04

Anderson update took 67.643 ms, out of which F'*F took 31.423 ms; b-Ax took 212.869 ms, out of which Lap took 189.611 ms
Solving Poisson took 469.950 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.092197 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.086048 
Total time for convolution: 	 convolve: 5.086894 
Total time for convolution: 	 convolve: 5.093098 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.509 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.027 ms

This SCF took 27745.161 ms, scf error = 2.436e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134956, lowerbound = -0.903389, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1344.535 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.709 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.547 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.169 ms
rank =  0, Distribute data + matrix mult took 16.445 ms
rank =  0, finding HY took 20.857 ms
rank =  0, distributing HY into block cyclic form took 14.939 ms
rank =  0, finding Y'*HY took 2.204 ms
Rank 0, Project_Hamiltonian used 54.477 ms
Total time for projection: 54.541 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.903304373281424
    last  calculated eigval = 0.035501201337502
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90330437328142
lambda[   2] =  -0.57793598910485
lambda[   3] =  -0.52912513120678
lambda[   4] =  -0.41891245313680
lambda[   5] =  -0.41454009025007
lambda[   6] =  -0.32147578384572
lambda[   7] =  -0.26532177740326
lambda[   8] =  -0.23866493661695
lambda[   9] =  -0.06131277628190
lambda[  10] =  -0.01398975102492
lambda[  11] =   0.01334642566189
lambda[  12] =   0.01544359650358
lambda[  13] =   0.02840241217579
lambda[  14] =   0.03550120133750
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 4.437 ms
rank =  0, Distributing orbital back into band + domain format took 12.885 ms
rank = 0, Subspace_Rotation used 17.343 ms

Total time for subspace rotation: 17.353 ms
rank = 0, Efermi =  -0.090588216476 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.412 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.788 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1421.025 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.637 ms
rank = 0, D2D took 0.867 ms
rank = 0, Transfering density took 0.878 ms
Etot    =   -24.117969202867
Eband   =    -7.338561070778
E1      =    17.224087877118
E2      =    -6.639863817593
E3      =    -9.311337445055
Exc     =    -8.322920485988
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 8.000e-08, dEband = 2.112e-04
rank = 0, Calculating/Estimating energy took 1.091 ms, Etot = -24.117969203, dEtot = 8.000e-08, dEband = 2.112e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0544436513157, which took 0.087 ms

iter_count = 102, r_2norm = 1.785e-06, tol*||rhs|| = 2.178e-06

Anderson update took 60.599 ms, out of which F'*F took 28.115 ms; b-Ax took 220.255 ms, out of which Lap took 199.599 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.676 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771100, int_b + int_rho = -3.638e-15, checking this took 0.114 ms
2-norm of RHS = 579.1071395236792, which took 0.150 ms

iter_count = 126, r_2norm = 5.409e-04, tol*||rhs|| = 5.791e-04

Anderson update took 74.567 ms, out of which F'*F took 35.156 ms; b-Ax took 235.982 ms, out of which Lap took 210.312 ms
Solving Poisson took 519.216 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.084055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.751 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.078444 
Total time for convolution: 	 convolve: 5.089297 
Total time for convolution: 	 convolve: 5.088327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 2.123 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 26856.896 ms, scf error = 2.101e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.135501, lowerbound = -0.903304, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1303.134 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.631 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.093 ms
rank =  0, Distribute data + matrix mult took 16.290 ms
rank =  0, finding HY took 20.709 ms
rank =  0, distributing HY into block cyclic form took 14.771 ms
rank =  0, finding Y'*HY took 2.296 ms
Rank 0, Project_Hamiltonian used 54.093 ms
Total time for projection: 54.110 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.892 ms
    first calculated eigval = -0.903194449890069
    last  calculated eigval = 0.036417696513648
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90319444989007
lambda[   2] =  -0.57782535762303
lambda[   3] =  -0.52904357109180
lambda[   4] =  -0.41880689645233
lambda[   5] =  -0.41443223467852
lambda[   6] =  -0.32136910536468
lambda[   7] =  -0.26521960623351
lambda[   8] =  -0.23855696568921
lambda[   9] =  -0.06120767995262
lambda[  10] =  -0.01307695560184
lambda[  11] =   0.01375657106645
lambda[  12] =   0.01595195744811
lambda[  13] =   0.02901707691326
lambda[  14] =   0.03641769651365
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.920 ms
rank =  0, subspace rotation using ScaLAPACK took 3.910 ms
rank =  0, Distributing orbital back into band + domain format took 13.836 ms
rank = 0, Subspace_Rotation used 17.767 ms

Total time for subspace rotation: 18.283 ms
rank = 0, Efermi =  -0.090483120110 calculate fermi energy took 0.102 ms
rank = 0, --- Calculate rho: sum over local bands took 2.451 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.777 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1379.923 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.714 ms
rank = 0, D2D took 0.955 ms
rank = 0, Transfering density took 0.964 ms
Etot    =   -24.117973799201
Eband   =    -7.336896375130
E1      =    17.223180762533
E2      =    -6.639059611872
E3      =    -9.311542357691
Exc     =    -8.323083370298
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 7.661e-07, dEband = 2.774e-04
rank = 0, Calculating/Estimating energy took 1.047 ms, Etot = -24.117973799, dEtot = 7.661e-07, dEband = 2.774e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0459164026429, which took 0.054 ms

iter_count = 108, r_2norm = 1.108e-06, tol*||rhs|| = 1.837e-06

Anderson update took 63.838 ms, out of which F'*F took 29.426 ms; b-Ax took 203.428 ms, out of which Lap took 181.189 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771096, int_b + int_rho = -4.002e-14, checking this took 0.121 ms
2-norm of RHS = 579.1063189753378, which took 0.132 ms

iter_count = 84, r_2norm = 5.657e-04, tol*||rhs|| = 5.791e-04

Anderson update took 49.736 ms, out of which F'*F took 23.327 ms; b-Ax took 157.162 ms, out of which Lap took 140.003 ms
Solving Poisson took 347.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.107473 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.090046 
Total time for convolution: 	 convolve: 5.136353 
Total time for convolution: 	 convolve: 5.085646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 26608.306 ms, scf error = 1.892e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136418, lowerbound = -0.903194, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1326.017 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.722 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.152 ms
rank =  0, Distribute data + matrix mult took 16.439 ms
rank =  0, finding HY took 20.805 ms
rank =  0, distributing HY into block cyclic form took 14.791 ms
rank =  0, finding Y'*HY took 2.320 ms
Rank 0, Project_Hamiltonian used 55.279 ms
Total time for projection: 55.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.903138961117523
    last  calculated eigval = 0.035422923410549
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90313896111752
lambda[   2] =  -0.57779757650733
lambda[   3] =  -0.52902409269481
lambda[   4] =  -0.41878423603549
lambda[   5] =  -0.41440114101365
lambda[   6] =  -0.32133131241392
lambda[   7] =  -0.26519389652136
lambda[   8] =  -0.23852519774651
lambda[   9] =  -0.06124569342416
lambda[  10] =  -0.01470189109562
lambda[  11] =   0.01289986443317
lambda[  12] =   0.01475531161872
lambda[  13] =   0.02714739486199
lambda[  14] =   0.03542292341055
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.893 ms
rank =  0, Distributing orbital back into band + domain format took 14.142 ms
rank = 0, Subspace_Rotation used 18.050 ms

Total time for subspace rotation: 18.053 ms
rank = 0, Efermi =  -0.090521133634 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 1402.973 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.709 ms
rank = 0, D2D took 0.947 ms
rank = 0, Transfering density took 0.953 ms
Etot    =   -24.117989706583
Eband   =    -7.336392829186
E1      =    17.222736230715
E2      =    -6.638947015077
E3      =    -9.311691264306
Exc     =    -8.323194601628
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 2.651e-06, dEband = 8.392e-05
rank = 0, Calculating/Estimating energy took 1.036 ms, Etot = -24.117989707, dEtot = 2.651e-06, dEband = 8.392e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0225463371838, which took 0.055 ms

iter_count = 108, r_2norm = 6.188e-07, tol*||rhs|| = 9.019e-07

Anderson update took 64.245 ms, out of which F'*F took 29.952 ms; b-Ax took 203.426 ms, out of which Lap took 181.316 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.354 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771101, int_b + int_rho = 7.276e-15, checking this took 0.090 ms
2-norm of RHS = 579.1096940734824, which took 0.151 ms

iter_count = 138, r_2norm = 5.444e-04, tol*||rhs|| = 5.791e-04

Anderson update took 81.514 ms, out of which F'*F took 38.415 ms; b-Ax took 257.966 ms, out of which Lap took 229.634 ms
Solving Poisson took 568.738 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.101996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.089997 
Total time for convolution: 	 convolve: 5.090107 
Total time for convolution: 	 convolve: 5.089465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 26791.245 ms, scf error = 1.389e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.135423, lowerbound = -0.903139, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1320.600 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.590 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.969 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 17.397 ms
rank =  0, finding HY took 21.267 ms
rank =  0, distributing HY into block cyclic form took 14.791 ms
rank =  0, finding Y'*HY took 2.236 ms
Rank 0, Project_Hamiltonian used 55.718 ms
Total time for projection: 55.737 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.903171499524369
    last  calculated eigval = 0.036458439535541
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90317149952437
lambda[   2] =  -0.57782296345929
lambda[   3] =  -0.52900345145777
lambda[   4] =  -0.41879938883858
lambda[   5] =  -0.41442741202167
lambda[   6] =  -0.32136127242434
lambda[   7] =  -0.26520719041363
lambda[   8] =  -0.23855486642413
lambda[   9] =  -0.06129103425763
lambda[  10] =  -0.01495529019930
lambda[  11] =   0.01234116762686
lambda[  12] =   0.01447810156946
lambda[  13] =   0.02622295546961
lambda[  14] =   0.03645843953554
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 4.885 ms
rank =  0, Distributing orbital back into band + domain format took 13.405 ms
rank = 0, Subspace_Rotation used 18.313 ms

Total time for subspace rotation: 18.316 ms
rank = 0, Efermi =  -0.090566474512 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.440 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1398.262 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.727 ms
rank = 0, D2D took 0.954 ms
rank = 0, Transfering density took 0.962 ms
Etot    =   -24.117993094319
Eband   =    -7.336696090213
E1      =    17.223189905716
E2      =    -6.638829819791
E3      =    -9.311485308508
Exc     =    -8.323025252253
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 5.646e-07, dEband = 5.054e-05
rank = 0, Calculating/Estimating energy took 1.032 ms, Etot = -24.117993094, dEtot = 5.646e-07, dEband = 5.054e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0327882645192, which took 0.098 ms

iter_count = 102, r_2norm = 1.011e-06, tol*||rhs|| = 1.312e-06

Anderson update took 60.874 ms, out of which F'*F took 27.947 ms; b-Ax took 192.115 ms, out of which Lap took 171.148 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.914 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771102, int_b + int_rho = 2.183e-14, checking this took 0.107 ms
2-norm of RHS = 579.1105744350299, which took 0.120 ms

iter_count = 78, r_2norm = 5.702e-04, tol*||rhs|| = 5.791e-04

Anderson update took 46.253 ms, out of which F'*F took 21.610 ms; b-Ax took 146.098 ms, out of which Lap took 129.876 ms
Solving Poisson took 322.699 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.188 ms
Total time for convolution: 	 convolve: 5.091667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.097867 
Total time for convolution: 	 convolve: 5.115085 
Total time for convolution: 	 convolve: 5.094195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.007 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 26545.665 ms, scf error = 1.941e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136458, lowerbound = -0.903171, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1336.329 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.626 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.589 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.197 ms
rank =  0, Distribute data + matrix mult took 16.450 ms
rank =  0, finding HY took 20.849 ms
rank =  0, distributing HY into block cyclic form took 14.855 ms
rank =  0, finding Y'*HY took 2.215 ms
Rank 0, Project_Hamiltonian used 54.397 ms
Total time for projection: 54.411 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.903182114211017
    last  calculated eigval = 0.036786215449414
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90318211421102
lambda[   2] =  -0.57782930150965
lambda[   3] =  -0.52901059424601
lambda[   4] =  -0.41880634971561
lambda[   5] =  -0.41443496201867
lambda[   6] =  -0.32136909319484
lambda[   7] =  -0.26521482464147
lambda[   8] =  -0.23856189862903
lambda[   9] =  -0.06131107774516
lambda[  10] =  -0.01510156793797
lambda[  11] =   0.01225829503722
lambda[  12] =   0.01440718652132
lambda[  13] =   0.02591034156185
lambda[  14] =   0.03678621544941
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.954 ms
rank =  0, Distributing orbital back into band + domain format took 14.144 ms
rank = 0, Subspace_Rotation used 18.116 ms

Total time for subspace rotation: 18.119 ms
rank = 0, Efermi =  -0.090586517958 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.469 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.757 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1412.823 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.737 ms
rank = 0, D2D took 0.947 ms
rank = 0, Transfering density took 0.950 ms
Etot    =   -24.117994400793
Eband   =    -7.336818277418
E1      =    17.223274391334
E2      =    -6.638868756643
E3      =    -9.311459012702
Exc     =    -8.323001498185
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 2.177e-07, dEband = 2.036e-05
rank = 0, Calculating/Estimating energy took 1.039 ms, Etot = -24.117994401, dEtot = 2.177e-07, dEband = 2.036e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0364045399578, which took 0.059 ms

iter_count = 102, r_2norm = 1.066e-06, tol*||rhs|| = 1.456e-06

Anderson update took 60.238 ms, out of which F'*F took 28.040 ms; b-Ax took 193.252 ms, out of which Lap took 171.955 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.310 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771108, int_b + int_rho = 8.004e-14, checking this took 0.100 ms
2-norm of RHS = 579.1110657633791, which took 0.103 ms

iter_count = 36, r_2norm = 5.019e-04, tol*||rhs|| = 5.791e-04

Anderson update took 21.495 ms, out of which F'*F took 10.003 ms; b-Ax took 67.290 ms, out of which Lap took 59.948 ms
Solving Poisson took 151.229 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.088012 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.085633 
Total time for convolution: 	 convolve: 5.107151 
Total time for convolution: 	 convolve: 5.094574 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.340 ms

This SCF took 26379.800 ms, scf error = 1.949e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.136786, lowerbound = -0.903182, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1322.759 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.811 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 16.413 ms
rank =  0, finding HY took 20.727 ms
rank =  0, distributing HY into block cyclic form took 14.841 ms
rank =  0, finding Y'*HY took 2.235 ms
Rank 0, Project_Hamiltonian used 54.244 ms
Total time for projection: 54.258 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.903183161989564
    last  calculated eigval = 0.036790690910578
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90318316198956
lambda[   2] =  -0.57782876068927
lambda[   3] =  -0.52900821646022
lambda[   4] =  -0.41880665871602
lambda[   5] =  -0.41443464852231
lambda[   6] =  -0.32136976773730
lambda[   7] =  -0.26521529074435
lambda[   8] =  -0.23856165068093
lambda[   9] =  -0.06130621076143
lambda[  10] =  -0.01491548220882
lambda[  11] =   0.01235918492955
lambda[  12] =   0.01447949042622
lambda[  13] =   0.02606173095843
lambda[  14] =   0.03679069091058
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 3.865 ms
rank =  0, Distributing orbital back into band + domain format took 14.237 ms
rank = 0, Subspace_Rotation used 18.117 ms

Total time for subspace rotation: 18.121 ms
rank = 0, Efermi =  -0.090581651061 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.436 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 1398.718 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.679 ms
rank = 0, D2D took 0.901 ms
rank = 0, Transfering density took 0.906 ms
Etot    =   -24.117996816744
Eband   =    -7.336816312166
E1      =    17.223275629086
E2      =    -6.638861168943
E3      =    -9.311469332788
Exc     =    -8.323009849528
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 4.027e-07, dEband = 3.275e-07
rank = 0, Calculating/Estimating energy took 1.081 ms, Etot = -24.117996817, dEtot = 4.027e-07, dEband = 3.275e-07
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0314413825191, which took 0.073 ms

iter_count = 102, r_2norm = 1.031e-06, tol*||rhs|| = 1.258e-06

Anderson update took 60.236 ms, out of which F'*F took 29.072 ms; b-Ax took 193.709 ms, out of which Lap took 172.284 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.839 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771102, int_b + int_rho = 2.001e-14, checking this took 0.101 ms
2-norm of RHS = 579.1095467985933, which took 0.068 ms

iter_count = 66, r_2norm = 5.278e-04, tol*||rhs|| = 5.791e-04

Anderson update took 39.117 ms, out of which F'*F took 18.289 ms; b-Ax took 123.860 ms, out of which Lap took 110.080 ms
Solving Poisson took 273.511 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.107603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.090082 
Total time for convolution: 	 convolve: 5.104059 
Total time for convolution: 	 convolve: 5.093441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.026 ms
---Transfer Veff_loc: D2D took 1.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.805 ms

This SCF took 26505.362 ms, scf error = 1.959e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.136791, lowerbound = -0.903183, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1332.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.609 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.109 ms
rank =  0, Distribute data + matrix mult took 16.294 ms
rank =  0, finding HY took 20.854 ms
rank =  0, distributing HY into block cyclic form took 14.780 ms
rank =  0, finding Y'*HY took 2.197 ms
Rank 0, Project_Hamiltonian used 54.159 ms
Total time for projection: 54.175 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.903179764731070
    last  calculated eigval = 0.036472247779684
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90317976473107
lambda[   2] =  -0.57782990298475
lambda[   3] =  -0.52901015150587
lambda[   4] =  -0.41880735552204
lambda[   5] =  -0.41443572008305
lambda[   6] =  -0.32137070215521
lambda[   7] =  -0.26521626810921
lambda[   8] =  -0.23856358407422
lambda[   9] =  -0.06131722746776
lambda[  10] =  -0.01518200640698
lambda[  11] =   0.01214794855179
lambda[  12] =   0.01436614111478
lambda[  13] =   0.02577273403991
lambda[  14] =   0.03647224777968
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.872 ms
rank =  0, Distributing orbital back into band + domain format took 14.184 ms
rank = 0, Subspace_Rotation used 18.071 ms

Total time for subspace rotation: 18.074 ms
rank = 0, Efermi =  -0.090592667600 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1408.039 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.713 ms
rank = 0, D2D took 0.951 ms
rank = 0, Transfering density took 0.954 ms
Etot    =   -24.117997421574
Eband   =    -7.336826899417
E1      =    17.223244188244
E2      =    -6.638906576992
E3      =    -9.311453152072
Exc     =    -8.322997653598
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.008e-07, dEband = 1.765e-06
rank = 0, Calculating/Estimating energy took 1.050 ms, Etot = -24.117997422, dEtot = 1.008e-07, dEband = 1.765e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0337708293186, which took 0.083 ms

iter_count = 102, r_2norm = 1.027e-06, tol*||rhs|| = 1.351e-06

Anderson update took 60.275 ms, out of which F'*F took 28.527 ms; b-Ax took 193.426 ms, out of which Lap took 171.994 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.316 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771101, int_b + int_rho = 1.273e-14, checking this took 0.100 ms
2-norm of RHS = 579.1086645258803, which took 0.159 ms

iter_count = 54, r_2norm = 5.769e-04, tol*||rhs|| = 5.791e-04

Anderson update took 32.092 ms, out of which F'*F took 15.040 ms; b-Ax took 101.735 ms, out of which Lap took 90.474 ms
Solving Poisson took 225.685 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.087219 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.084043 
Total time for convolution: 	 convolve: 5.089861 
Total time for convolution: 	 convolve: 5.110170 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.019 ms
======D2D: initiated sending and receiving took 1.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.971 ms

This SCF took 26425.154 ms, scf error = 1.895e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.136472, lowerbound = -0.903180, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1369.275 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.755 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.038 ms
rank =  0, Distribute data + matrix mult took 16.350 ms
rank =  0, finding HY took 20.696 ms
rank =  0, distributing HY into block cyclic form took 14.779 ms
rank =  0, finding Y'*HY took 2.241 ms
Rank 0, Project_Hamiltonian used 54.097 ms
Total time for projection: 54.113 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.903130158271278
    last  calculated eigval = 0.035954261422083
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90313015827128
lambda[   2] =  -0.57779533843157
lambda[   3] =  -0.52898032184002
lambda[   4] =  -0.41877468956318
lambda[   5] =  -0.41439961610189
lambda[   6] =  -0.32133210354029
lambda[   7] =  -0.26518246487410
lambda[   8] =  -0.23852736367501
lambda[   9] =  -0.06128173257688
lambda[  10] =  -0.01547977699318
lambda[  11] =   0.01212945885612
lambda[  12] =   0.01425134332579
lambda[  13] =   0.02559628279042
lambda[  14] =   0.03595426142208
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 3.847 ms
rank =  0, Distributing orbital back into band + domain format took 14.165 ms
rank = 0, Subspace_Rotation used 18.026 ms

Total time for subspace rotation: 18.031 ms
rank = 0, Efermi =  -0.090557172645 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.412 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.786 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1444.995 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.763 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.990 ms
Etot    =   -24.117993272471
Eband   =    -7.336244113680
E1      =    17.222843258120
E2      =    -6.638695781741
E3      =    -9.311596605160
Exc     =    -8.323108017944
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 6.915e-07, dEband = 9.713e-05
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -24.117993272, dEtot = 6.915e-07, dEband = 9.713e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0303375385151, which took 0.082 ms

iter_count = 102, r_2norm = 9.764e-07, tol*||rhs|| = 1.214e-06

Anderson update took 60.143 ms, out of which F'*F took 28.110 ms; b-Ax took 192.798 ms, out of which Lap took 171.576 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 433.334 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771099, int_b + int_rho = -9.095e-15, checking this took 0.098 ms
2-norm of RHS = 579.1069398486917, which took 0.127 ms

iter_count = 90, r_2norm = 5.718e-04, tol*||rhs|| = 5.791e-04

Anderson update took 53.710 ms, out of which F'*F took 25.079 ms; b-Ax took 169.115 ms, out of which Lap took 150.093 ms
Solving Poisson took 372.478 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.080504 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.074913 
Total time for convolution: 	 convolve: 5.080222 
Total time for convolution: 	 convolve: 5.074138 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.982 ms

This SCF took 26591.925 ms, scf error = 1.568e-04
-------------
SCF iter 25  
-------------

 Chebfilt 28, in Chebyshev filtering, lambda_cutoff = 0.135954, lowerbound = -0.903130, upperbound = 267.574361

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1297.838 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.076 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.420 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.038 ms
rank =  0, Distribute data + matrix mult took 18.550 ms
rank =  0, finding HY took 20.048 ms
rank =  0, distributing HY into block cyclic form took 14.950 ms
rank =  0, finding Y'*HY took 2.227 ms
Rank 0, Project_Hamiltonian used 55.809 ms
Total time for projection: 55.824 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.902977237622652
    last  calculated eigval = 0.035516306774601
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90297723762265
lambda[   2] =  -0.57768122563043
lambda[   3] =  -0.52888263738914
lambda[   4] =  -0.41866449300688
lambda[   5] =  -0.41428203965151
lambda[   6] =  -0.32120480241308
lambda[   7] =  -0.26506831417973
lambda[   8] =  -0.23840847655892
lambda[   9] =  -0.06116219078191
lambda[  10] =  -0.01569636094717
lambda[  11] =   0.01229080902498
lambda[  12] =   0.01424891113545
lambda[  13] =   0.02556308402057
lambda[  14] =   0.03551630677460
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 3.896 ms
rank =  0, Distributing orbital back into band + domain format took 14.147 ms
rank = 0, Subspace_Rotation used 18.057 ms

Total time for subspace rotation: 18.060 ms
rank = 0, Efermi =  -0.090437630927 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.394 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.784 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1375.280 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.653 ms
rank = 0, D2D took 0.881 ms
rank = 0, Transfering density took 1.302 ms
Etot    =   -24.117992511824
Eband   =    -7.334338453988
E1      =    17.221628168759
E2      =    -6.637916065357
E3      =    -9.311985561261
Exc     =    -8.323407067346
Esc     =   -41.631776785334
Entropy =    -0.000000000534
dE = 1.268e-07, dEband = 3.176e-04
rank = 0, Calculating/Estimating energy took 1.517 ms, Etot = -24.117992512, dEtot = 1.268e-07, dEband = 3.176e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0170695516756, which took 0.079 ms

iter_count = 102, r_2norm = 5.350e-07, tol*||rhs|| = 6.828e-07

Anderson update took 60.655 ms, out of which F'*F took 28.307 ms; b-Ax took 193.165 ms, out of which Lap took 171.800 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.634 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001771100, int_rho =  16.00000001771106, int_b + int_rho = 6.366e-14, checking this took 0.098 ms
2-norm of RHS = 579.1094502809490, which took 0.124 ms

iter_count = 138, r_2norm = 5.542e-04, tol*||rhs|| = 5.791e-04

Anderson update took 82.374 ms, out of which F'*F took 38.736 ms; b-Ax took 260.341 ms, out of which Lap took 231.953 ms
Solving Poisson took 571.983 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.075953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.556 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.084233 
Total time for convolution: 	 convolve: 5.077008 
Total time for convolution: 	 convolve: 5.082975 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.765 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 26672.493 ms, scf error = 8.372e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.90297723762265, occ[   1] =   2.00000000000000
lambda[   2] =  -0.57768122563043, occ[   2] =   2.00000000000000
lambda[   3] =  -0.52888263738914, occ[   3] =   2.00000000000000
lambda[   4] =  -0.41866449300688, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41428203965151, occ[   5] =   2.00000000000000
lambda[   6] =  -0.32120480241308, occ[   6] =   2.00000000000000
lambda[   7] =  -0.26506831417973, occ[   7] =   2.00000000000000
lambda[   8] =  -0.23840847655892, occ[   8] =   2.00000000000000
lambda[   9] =  -0.06116219078191, occ[   9] =   0.00000001771101
lambda[  10] =  -0.01569636094717, occ[  10] =   0.00000000000000
lambda[  11] =   0.01229080902498, occ[  11] =   0.00000000000000
lambda[  12] =   0.01424891113545, occ[  12] =   0.00000000000000
lambda[  13] =   0.02556308402057, occ[  13] =   0.00000000000000
lambda[  14] =   0.03551630677460, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.489 ms, time for Allreduce/Reduce: 7.805 ms 
Time for calculating local force components: 17.078 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00189268830284  -0.05264823631315  -0.00000000436105
 -0.01837003028332   0.02080776818333  -0.04395103098130
 -0.01837003264310   0.02080779074638   0.04395102746949
 -0.03406274027022  -0.15405557171169  -0.00000011012051
 -0.20669931431383   0.11691223540578   0.00000008903174
  0.91480544088625   0.39394079191796   0.00000002944667
force_loc = 
  0.00185146652067   0.05740360683244  -0.00000005640730
  0.02029531392434  -0.02251889874542   0.04737060738687
  0.02029552924926  -0.02251903091140  -0.04737087590367
  0.03412264478845   0.15740821376217  -0.00000084136565
  0.19640750095115  -0.11649383926906   0.00000156758281
 -0.88787667458315  -0.38632351459653  -0.00000115401436
Time for calculating nonlocal force components: 30.470 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00554064532591  -0.00431006227631  -0.00000003922686
[0m[32m  0.00760810258392  -0.00303979426234   0.00000010334784
[0m[32m -0.02257317779701  -0.00530477266347  -0.00000004158016
[0mTime for calculating XC forces components: 21.221 ms
 Cartesian force = 
 -0.00004133767962   0.00474425616951   0.00000006084756
  0.00192516774358  -0.00172224491187   0.00341969802147
  0.00192538070872  -0.00172235451480  -0.00341972681827
 -0.00548085670513  -0.00096853457561  -0.00000086909711
 -0.00268382667620  -0.00263251247540   0.00000188157829
  0.00435547260865   0.00230139030818  -0.00000104453194
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 377.295 ms
The program took 709.636 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:32:26
Job ID:        2266729
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:24:48,vmem=8276K,walltime=00:12:04,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-25-2
---------------------------------------
