---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:13
Job ID:    2266630
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:19
Job ID:    2266630
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 161.377 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 101.849 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 69.064 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.963 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.428507	    8.983133	   10.000000	
   13.602439	    8.071551	   10.000000	
   11.272590	    6.315261	   11.665329	
   11.272590	    6.315261	    8.334671	
   12.653551	   12.595613	   10.000000	
    9.318037	   13.684739	   10.000000	
    6.397561	   10.482547	   10.000000	
   11.632377	    7.479890	   10.000000	
    9.912597	    9.723994	   10.000000	
   10.664742	   12.141708	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.167 ms
Set up communicators.

--set up spincomm took 2.240 ms

--set up kptcomm took 0.362 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.063 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.384 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.300 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.821 ms.
time spent on vectorized spline interp: 3.396 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.708 ms.
time spent on vectorized spline interp: 1.642 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.314 ms.
time spent on vectorized spline interp: 1.903 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.321 ms.

Calculating rb for all atom types took 17.116 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.820 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.018 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000256841, sum_int_rho = 23.3971474038259
PosCharge = 24.000000025684, NegCharge = -23.397147403826, scal_fac = 1.025766073592
After scaling, int_rho = 24.0000000256840, PosCharge + NegCharge - NetCharge = 1.101e-13
--Calculate Vref took 0.539 ms
--Calculate rho_guess took 2.786 ms

 integral of b = -24.0000000256841,
 int{b} + Nelectron + NetCharge = -2.568e-08,
 Esc = -63.7908343256074,
 MPI_Reduce took 10.232 ms

Calculating b & b_ref took 20.261 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.077 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.086 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.112 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.613 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.482 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568408, int_b + int_rho = -5.457e-14, checking this took 0.515 ms
2-norm of RHS = 751.3973000805840, which took 0.417 ms

iter_count = 420, r_2norm = 6.174e-04, tol*||rhs|| = 7.514e-04

Anderson update took 281.677 ms, out of which F'*F took 133.853 ms; b-Ax took 836.202 ms, out of which Lap took 746.036 ms
Solving Poisson took 1866.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.149213 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.119331 
Total time for convolution: 	 convolve: 5.122918 
Total time for convolution: 	 convolve: 5.121350 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.961 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.434 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
rank = 0, XC calculation took 24480.521 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 4.789 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.253 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.155 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.148 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.898 ms
    Lanczos iter 53, eigmin  = -0.976355627, eigmax = 264.933618013, err_eigmin = 2.611e-03, err_eigmax = 9.609e-03
rank =   0, Lanczos took 135.127 ms, eigmin = -0.976355627140, eigmax = 267.582954193592

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.253299, lowerbound = -1.076356, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1599.571 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 44.123 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.789 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.930 ms
rank =  0, finding HY took 25.813 ms
rank =  0, distributing HY into block cyclic form took 23.895 ms
rank =  0, finding Y'*HY took 4.050 ms
Rank 0, Project_Hamiltonian used 101.150 ms
Total time for projection: 101.164 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.733 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.828 ms
    first calculated eigval = 2.740127692998546
    last  calculated eigval = 3.244395803855777
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.78743218296540
lambda[   4] =   2.83854764439362
lambda[   5] =   2.87327753985348
lambda[   6] =   2.91830559580267
lambda[   7] =   2.93089347616398
lambda[   8] =   2.96367256705640
lambda[   9] =   2.98656736526398
lambda[  10] =   2.99951045482672
lambda[  11] =   3.02084350714891
lambda[  12] =   3.02342069068282
lambda[  13] =   3.09305831728385
lambda[  14] =   3.11799985502697
lambda[  15] =   3.12922511415533
lambda[  16] =   3.15041841840072
lambda[  17] =   3.17580268118756
lambda[  18] =   3.22059644851632
lambda[  19] =   3.24439580385578
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.845 ms
rank =  0, subspace rotation using ScaLAPACK took 8.663 ms
rank =  0, Distributing orbital back into band + domain format took 19.270 ms
rank = 0, Subspace_Rotation used 27.946 ms

Total time for subspace rotation: 27.949 ms
rank = 0, Efermi =   3.064117690498 calculate fermi energy took 0.044 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.344396, lowerbound = -1.076356, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1585.471 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 50.212 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.742 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 52.977 ms
rank =  0, finding HY took 25.245 ms
rank =  0, distributing HY into block cyclic form took 20.108 ms
rank =  0, finding Y'*HY took 3.856 ms
Rank 0, Project_Hamiltonian used 102.213 ms
Total time for projection: 102.225 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.838656346008512
    last  calculated eigval = 0.447723112572494
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.44539917022157
lambda[   4] =  -0.34143220300181
lambda[   5] =  -0.12901110288501
lambda[   6] =  -0.03563393561531
lambda[   7] =  -0.01829083323886
lambda[   8] =   0.05384255638215
lambda[   9] =   0.14256473690962
lambda[  10] =   0.26256155216135
lambda[  11] =   0.26647088690437
lambda[  12] =   0.30034558761341
lambda[  13] =   0.30365891048733
lambda[  14] =   0.34105135115443
lambda[  15] =   0.36039578011138
lambda[  16] =   0.38079736381938
lambda[  17] =   0.40227012240499
lambda[  18] =   0.42346338392402
lambda[  19] =   0.44772311257249
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.630 ms
rank =  0, Distributing orbital back into band + domain format took 19.170 ms
rank = 0, Subspace_Rotation used 27.812 ms

Total time for subspace rotation: 27.816 ms
rank = 0, Efermi =   0.302002249138 calculate fermi energy took 0.039 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.547723, lowerbound = -1.076356, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.501 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.017 ms
rank =  0, Distribute orbital to block cyclic format took 57.890 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.742 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 60.653 ms
rank =  0, finding HY took 25.136 ms
rank =  0, distributing HY into block cyclic form took 20.001 ms
rank =  0, finding Y'*HY took 3.860 ms
Rank 0, Project_Hamiltonian used 110.106 ms
Total time for projection: 110.111 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -1.003830058181193
    last  calculated eigval = 0.168151670327269
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.75388240358628
lambda[   4] =  -0.59913923704344
lambda[   5] =  -0.53393172073220
lambda[   6] =  -0.48585505973325
lambda[   7] =  -0.48311482318225
lambda[   8] =  -0.45475849069806
lambda[   9] =  -0.41752593970352
lambda[  10] =  -0.35932606605090
lambda[  11] =  -0.32061947050994
lambda[  12] =  -0.22729938756211
lambda[  13] =  -0.03235350778698
lambda[  14] =   0.02513367578064
lambda[  15] =   0.07949814990968
lambda[  16] =   0.10418639600661
lambda[  17] =   0.11938357046142
lambda[  18] =   0.13466955486937
lambda[  19] =   0.16815167032727
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 8.567 ms
rank =  0, Distributing orbital back into band + domain format took 19.188 ms
rank = 0, Subspace_Rotation used 27.766 ms

Total time for subspace rotation: 27.771 ms
rank = 0, Efermi =  -0.061294134637 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.268152, lowerbound = -1.076356, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1584.519 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 49.845 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.785 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 52.647 ms
rank =  0, finding HY took 25.150 ms
rank =  0, distributing HY into block cyclic form took 20.014 ms
rank =  0, finding Y'*HY took 3.865 ms
Rank 0, Project_Hamiltonian used 101.704 ms
Total time for projection: 101.711 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -1.004172856617136
    last  calculated eigval = 0.089490187032255
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.75652344973505
lambda[   4] =  -0.60348948317720
lambda[   5] =  -0.54563994073723
lambda[   6] =  -0.51923471789116
lambda[   7] =  -0.49102213288612
lambda[   8] =  -0.46488100995872
lambda[   9] =  -0.43794022870585
lambda[  10] =  -0.38274449144169
lambda[  11] =  -0.37463733149534
lambda[  12] =  -0.28011030603091
lambda[  13] =  -0.07271720444471
lambda[  14] =  -0.01374861366632
lambda[  15] =   0.03707928833048
lambda[  16] =   0.05709452298013
lambda[  17] =   0.06416916652309
lambda[  18] =   0.07571973080683
lambda[  19] =   0.08949018703225
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 8.626 ms
rank =  0, Distributing orbital back into band + domain format took 19.128 ms
rank = 0, Subspace_Rotation used 28.293 ms

Total time for subspace rotation: 28.298 ms
rank = 0, Efermi =  -0.101657831366 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 6.399 ms
rank = 0, --- Calculate rho: reduce over all band groups took 25.029 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.608 ms
rank = 0, Calculating density took 7039.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.946 ms
rank = 0, D2D took 2.052 ms
rank = 0, Transfering density took 2.059 ms
Etot    =   -38.303430606121
Eband   =   -13.360009757482
E1      =    26.918120795497
E2      =   -10.400097132953
E3      =   -13.757438639683
Exc     =   -12.228243090400
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 3.830e+00, dEband = 1.336e+00
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -38.303430606, dEtot = 3.830e+00, dEband = 1.336e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 53.0978126372554, which took 0.667 ms

iter_count = 96, r_2norm = 1.791e-03, tol*||rhs|| = 2.124e-03

Anderson update took 58.910 ms, out of which F'*F took 27.302 ms; b-Ax took 185.932 ms, out of which Lap took 163.631 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.147 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568406, int_b + int_rho = -7.640e-14, checking this took 0.144 ms
2-norm of RHS = 747.5448361665912, which took 0.221 ms

iter_count = 288, r_2norm = 6.605e-04, tol*||rhs|| = 7.475e-04

Anderson update took 176.820 ms, out of which F'*F took 77.783 ms; b-Ax took 529.424 ms, out of which Lap took 471.992 ms
Solving Poisson took 1235.417 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.281262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.192380 
Total time for convolution: 	 convolve: 5.178983 
Total time for convolution: 	 convolve: 5.151469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.175 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.151 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.681 ms

This SCF took 33485.892 ms, scf error = 1.764e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189490, lowerbound = -1.004173, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.296 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.768 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.860 ms
rank =  0, finding HY took 25.586 ms
rank =  0, distributing HY into block cyclic form took 21.833 ms
rank =  0, finding Y'*HY took 3.698 ms
Rank 0, Project_Hamiltonian used 74.005 ms
Total time for projection: 74.016 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.240 ms
    first calculated eigval = -0.999669771392431
    last  calculated eigval = 0.055872616664837
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.71646959417528
lambda[   4] =  -0.58349649089926
lambda[   5] =  -0.51578719145659
lambda[   6] =  -0.48599803266915
lambda[   7] =  -0.46105582677754
lambda[   8] =  -0.43317519625089
lambda[   9] =  -0.40733398527006
lambda[  10] =  -0.36814173266128
lambda[  11] =  -0.36172484427175
lambda[  12] =  -0.25439271644612
lambda[  13] =  -0.06005463590295
lambda[  14] =  -0.03088338041168
lambda[  15] =   0.01418863517400
lambda[  16] =   0.03393424216837
lambda[  17] =   0.03766332251312
lambda[  18] =   0.04652212828375
lambda[  19] =   0.05587261666484
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 8.658 ms
rank =  0, Distributing orbital back into band + domain format took 19.190 ms
rank = 0, Subspace_Rotation used 27.867 ms

Total time for subspace rotation: 27.875 ms
rank = 0, Efermi =  -0.088995262854 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.792 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.557 ms
rank = 0, Calculating density took 1731.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.939 ms
rank = 0, D2D took 2.042 ms
rank = 0, Transfering density took 2.048 ms
Etot    =   -38.232616818823
Eband   =   -12.747553324087
E1      =    26.371433786228
E2      =   -10.373690070780
E3      =   -13.927252356402
Exc     =   -12.366605381771
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 7.081e-03, dEband = 6.125e-02
rank = 0, Calculating/Estimating energy took 1.071 ms, Etot = -38.232616819, dEtot = 7.081e-03, dEband = 6.125e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.5728295521205, which took 0.055 ms

iter_count = 102, r_2norm = 7.159e-04, tol*||rhs|| = 9.029e-04

Anderson update took 62.702 ms, out of which F'*F took 27.894 ms; b-Ax took 192.238 ms, out of which Lap took 169.505 ms
rank = 0, Mixing (+ precond) took 442.768 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568408, int_b + int_rho = -4.729e-14, checking this took 0.137 ms
2-norm of RHS = 742.3422770668581, which took 0.235 ms

iter_count = 300, r_2norm = 6.464e-04, tol*||rhs|| = 7.423e-04

Anderson update took 186.275 ms, out of which F'*F took 80.581 ms; b-Ax took 552.639 ms, out of which Lap took 491.110 ms
Solving Poisson took 1291.731 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.195238 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.160666 
Total time for convolution: 	 convolve: 5.183444 
Total time for convolution: 	 convolve: 5.189989 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.203 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.420 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.077 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.625 ms

This SCF took 28243.609 ms, scf error = 1.178e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.155873, lowerbound = -0.999670, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.975 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.964 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.875 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.853 ms
rank =  0, finding HY took 26.671 ms
rank =  0, distributing HY into block cyclic form took 20.381 ms
rank =  0, finding Y'*HY took 3.926 ms
Rank 0, Project_Hamiltonian used 73.861 ms
Total time for projection: 73.872 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.983963698037687
    last  calculated eigval = 0.052662195898369
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65748565811931
lambda[   4] =  -0.55434161910069
lambda[   5] =  -0.46647268107280
lambda[   6] =  -0.43830736850205
lambda[   7] =  -0.41587166178636
lambda[   8] =  -0.38473970924956
lambda[   9] =  -0.35679696093136
lambda[  10] =  -0.33576184301146
lambda[  11] =  -0.33481416373872
lambda[  12] =  -0.21561764511632
lambda[  13] =  -0.03537757614175
lambda[  14] =  -0.03039809256854
lambda[  15] =   0.00537072855658
lambda[  16] =   0.02385813122010
lambda[  17] =   0.02721681549517
lambda[  18] =   0.03654816497241
lambda[  19] =   0.05266219589837
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 8.444 ms
rank =  0, Distributing orbital back into band + domain format took 19.196 ms
rank = 0, Subspace_Rotation used 27.665 ms

Total time for subspace rotation: 27.671 ms
rank = 0, Efermi =  -0.064320569948 calculate fermi energy took 0.100 ms
rank = 0, --- Calculate rho: sum over local bands took 6.917 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.535 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1736.337 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.021 ms
rank = 0, Transfering density took 2.026 ms
Etot    =   -38.182777773142
Eband   =   -11.758277520169
E1      =    25.521806006526
E2      =   -10.225030211326
E3      =   -14.235516988145
Exc     =   -12.616019132597
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 4.984e-03, dEband = 9.893e-02
rank = 0, Calculating/Estimating energy took 1.066 ms, Etot = -38.182777773, dEtot = 4.984e-03, dEband = 9.893e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.3266127061608, which took 0.397 ms

iter_count = 102, r_2norm = 2.640e-04, tol*||rhs|| = 2.931e-04

Anderson update took 62.644 ms, out of which F'*F took 28.279 ms; b-Ax took 192.449 ms, out of which Lap took 170.265 ms
rank = 0, Mixing (+ precond) took 437.829 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568395, int_b + int_rho = -1.855e-13, checking this took 0.134 ms
2-norm of RHS = 741.4439173680606, which took 0.151 ms

iter_count = 282, r_2norm = 6.209e-04, tol*||rhs|| = 7.414e-04

Anderson update took 177.575 ms, out of which F'*F took 79.538 ms; b-Ax took 538.256 ms, out of which Lap took 478.996 ms
Solving Poisson took 1207.228 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.217134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 77.533 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.150464 
Total time for convolution: 	 convolve: 5.164514 
Total time for convolution: 	 convolve: 5.153960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.647 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.452 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.479 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 48.015 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 51.525 ms

This SCF took 29205.728 ms, scf error = 4.819e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.152662, lowerbound = -0.983964, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1646.317 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.946 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.818 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.779 ms
rank =  0, finding HY took 25.466 ms
rank =  0, distributing HY into block cyclic form took 19.887 ms
rank =  0, finding Y'*HY took 6.450 ms
Rank 0, Project_Hamiltonian used 74.609 ms
Total time for projection: 74.625 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.640 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.256 ms
rank = 0, Solve_Generalized_EigenProblem used 0.903 ms
    first calculated eigval = -0.974205567629496
    last  calculated eigval = 0.049063080937126
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63845135261605
lambda[   4] =  -0.54141783819035
lambda[   5] =  -0.44925873989886
lambda[   6] =  -0.42177415100448
lambda[   7] =  -0.39706470128056
lambda[   8] =  -0.36529217706646
lambda[   9] =  -0.33909615361331
lambda[  10] =  -0.32257362017663
lambda[  11] =  -0.32162996434024
lambda[  12] =  -0.20421474330343
lambda[  13] =  -0.03609420578807
lambda[  14] =  -0.01834942079105
lambda[  15] =   0.00261124737006
lambda[  16] =   0.02023352140496
lambda[  17] =   0.02279811649557
lambda[  18] =   0.03265984357424
lambda[  19] =   0.04906308093713
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.609 ms
rank =  0, subspace rotation using ScaLAPACK took 8.008 ms
rank =  0, Distributing orbital back into band + domain format took 19.477 ms
rank = 0, Subspace_Rotation used 27.498 ms

Total time for subspace rotation: 27.504 ms
rank = 0, Efermi =  -0.065034832681 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 6.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.967 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.415 ms
rank = 0, Calculating density took 1770.444 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.120 ms
rank = 0, D2D took 2.230 ms
rank = 0, Transfering density took 2.238 ms
Etot    =   -38.175237702925
Eband   =   -11.379331729830
E1      =    25.248083389452
E2      =   -10.099570045086
E3      =   -14.363225028345
Exc     =   -12.715950109604
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 7.540e-04, dEband = 3.789e-02
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -38.175237703, dEtot = 7.540e-04, dEband = 3.789e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.6417867764713, which took 0.085 ms

iter_count = 108, r_2norm = 9.674e-05, tol*||rhs|| = 1.457e-04

Anderson update took 65.221 ms, out of which F'*F took 30.401 ms; b-Ax took 205.575 ms, out of which Lap took 183.287 ms
rank = 0, Mixing (+ precond) took 461.034 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568400, int_b + int_rho = -1.382e-13, checking this took 0.106 ms
2-norm of RHS = 741.5652569835748, which took 0.117 ms

iter_count = 258, r_2norm = 6.157e-04, tol*||rhs|| = 7.416e-04

Anderson update took 166.107 ms, out of which F'*F took 74.797 ms; b-Ax took 492.871 ms, out of which Lap took 442.600 ms
Solving Poisson took 1112.195 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.156082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 107.001 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.477 ms
Total time for convolution: 	 convolve: 5.173070 
Total time for convolution: 	 convolve: 5.155713 
Total time for convolution: 	 convolve: 5.172042 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.418 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.397 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.985 ms

This SCF took 28097.894 ms, scf error = 1.554e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.149063, lowerbound = -0.974206, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1612.617 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.891 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.733 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.584 ms
rank =  0, finding HY took 25.258 ms
rank =  0, distributing HY into block cyclic form took 20.221 ms
rank =  0, finding Y'*HY took 3.862 ms
Rank 0, Project_Hamiltonian used 72.962 ms
Total time for projection: 72.975 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.203 ms
rank = 0, Solve_Generalized_EigenProblem used 0.321 ms
    first calculated eigval = -0.971917926854854
    last  calculated eigval = 0.045227245122838
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63199765826919
lambda[   4] =  -0.53790816571801
lambda[   5] =  -0.44325001826715
lambda[   6] =  -0.41631354319278
lambda[   7] =  -0.39156967328390
lambda[   8] =  -0.35905184667217
lambda[   9] =  -0.33282944662139
lambda[  10] =  -0.31876119581669
lambda[  11] =  -0.31786908558259
lambda[  12] =  -0.19983388824371
lambda[  13] =  -0.03627805608713
lambda[  14] =  -0.01551097165579
lambda[  15] =   0.00132617882481
lambda[  16] =   0.01862012920470
lambda[  17] =   0.02045019498782
lambda[  18] =   0.03076418499445
lambda[  19] =   0.04522724512284
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.332 ms
rank =  0, subspace rotation using ScaLAPACK took 8.038 ms
rank =  0, Distributing orbital back into band + domain format took 19.494 ms
rank = 0, Subspace_Rotation used 27.545 ms

Total time for subspace rotation: 27.550 ms
rank = 0, Efermi =  -0.065218683050 calculate fermi energy took 0.586 ms
rank = 0, --- Calculate rho: sum over local bands took 6.745 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.472 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1732.926 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.953 ms
rank = 0, D2D took 2.056 ms
rank = 0, Transfering density took 2.062 ms
Etot    =   -38.174063581543
Eband   =   -11.260907565247
E1      =    25.178323738762
E2      =   -10.042476481011
E3      =   -14.401546166971
Exc     =   -12.744668076667
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 1.174e-04, dEband = 1.184e-02
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -38.174063582, dEtot = 1.174e-04, dEband = 1.184e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9774463359209, which took 0.078 ms

iter_count = 114, r_2norm = 2.671e-05, tol*||rhs|| = 3.910e-05

Anderson update took 69.898 ms, out of which F'*F took 32.143 ms; b-Ax took 218.791 ms, out of which Lap took 195.237 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 509.974 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568400, int_b + int_rho = -1.382e-13, checking this took 0.091 ms
2-norm of RHS = 742.0685914406608, which took 0.122 ms

iter_count = 252, r_2norm = 5.900e-04, tol*||rhs|| = 7.421e-04

Anderson update took 156.226 ms, out of which F'*F took 71.350 ms; b-Ax took 490.000 ms, out of which Lap took 430.255 ms
Solving Poisson took 1106.057 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.153 ms
Total time for convolution: 	 convolve: 5.174953 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.186741 
Total time for convolution: 	 convolve: 5.167575 
Total time for convolution: 	 convolve: 5.160636 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.505 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.972 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.512 ms

This SCF took 28062.376 ms, scf error = 8.552e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145227, lowerbound = -0.971918, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1612.794 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.755 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.599 ms
rank =  0, finding HY took 25.503 ms
rank =  0, distributing HY into block cyclic form took 19.982 ms
rank =  0, finding Y'*HY took 3.794 ms
Rank 0, Project_Hamiltonian used 71.907 ms
Total time for projection: 71.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.970222939542859
    last  calculated eigval = 0.042180002123928
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62878487321026
lambda[   4] =  -0.53577904121308
lambda[   5] =  -0.44014350285898
lambda[   6] =  -0.41341025404531
lambda[   7] =  -0.38835188001255
lambda[   8] =  -0.35538162802960
lambda[   9] =  -0.32935640183740
lambda[  10] =  -0.31690766822362
lambda[  11] =  -0.31550918231608
lambda[  12] =  -0.19732209294331
lambda[  13] =  -0.03592953578440
lambda[  14] =  -0.01372768697991
lambda[  15] =   0.00101102759803
lambda[  16] =   0.01808484743481
lambda[  17] =   0.02014526229116
lambda[  18] =   0.02986193535808
lambda[  19] =   0.04218000212393
==subpsace eigenproblem: bcast eigvals took 0.090 ms
Total time for solving subspace eigenvalue problem: 0.317 ms
rank =  0, subspace rotation using ScaLAPACK took 8.024 ms
rank =  0, Distributing orbital back into band + domain format took 19.351 ms
rank = 0, Subspace_Rotation used 27.389 ms

Total time for subspace rotation: 27.394 ms
rank = 0, Efermi =  -0.064870162606 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.959 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.419 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1731.894 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.965 ms
rank = 0, D2D took 2.068 ms
rank = 0, Transfering density took 2.071 ms
Etot    =   -38.173573569986
Eband   =   -11.195259820196
E1      =    25.159853615026
E2      =    -9.990754822417
E3      =   -14.415410760176
Exc     =   -12.753498621036
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 4.900e-05, dEband = 6.565e-03
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -38.173573570, dEtot = 4.900e-05, dEband = 6.565e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3636351151685, which took 0.085 ms

iter_count = 114, r_2norm = 1.059e-05, tol*||rhs|| = 1.455e-05

Anderson update took 69.651 ms, out of which F'*F took 32.888 ms; b-Ax took 221.327 ms, out of which Lap took 196.235 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.689 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568399, int_b + int_rho = -1.419e-13, checking this took 0.139 ms
2-norm of RHS = 742.2964184812728, which took 0.203 ms

iter_count = 246, r_2norm = 7.405e-04, tol*||rhs|| = 7.423e-04

Anderson update took 154.114 ms, out of which F'*F took 72.274 ms; b-Ax took 489.202 ms, out of which Lap took 434.325 ms
Solving Poisson took 1073.860 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.160614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 88.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.178123 
Total time for convolution: 	 convolve: 5.163482 
Total time for convolution: 	 convolve: 5.167198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.418 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.494 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.414 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.542 ms

This SCF took 28033.582 ms, scf error = 3.716e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142180, lowerbound = -0.970223, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.376 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.861 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.689 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.567 ms
rank =  0, finding HY took 25.265 ms
rank =  0, distributing HY into block cyclic form took 20.008 ms
rank =  0, finding Y'*HY took 3.746 ms
Rank 0, Project_Hamiltonian used 71.615 ms
Total time for projection: 71.625 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.967009058832988
    last  calculated eigval = 0.041300220742041
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62350211344154
lambda[   4] =  -0.53203151674229
lambda[   5] =  -0.43555874241671
lambda[   6] =  -0.40887699303421
lambda[   7] =  -0.38319078737677
lambda[   8] =  -0.34982697659598
lambda[   9] =  -0.32456466870780
lambda[  10] =  -0.31294518761498
lambda[  11] =  -0.31148506938642
lambda[  12] =  -0.19319713720573
lambda[  13] =  -0.03474256888399
lambda[  14] =  -0.01006853541101
lambda[  15] =   0.00203207101490
lambda[  16] =   0.01948275849345
lambda[  17] =   0.02192990090362
lambda[  18] =   0.03068989298039
lambda[  19] =   0.04130022074204
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 8.007 ms
rank =  0, Distributing orbital back into band + domain format took 19.474 ms
rank = 0, Subspace_Rotation used 27.493 ms

Total time for subspace rotation: 27.498 ms
rank = 0, Efermi =  -0.063683195778 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.870 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.460 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.606 ms
rank = 0, Calculating density took 1725.798 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.988 ms
rank = 0, D2D took 2.091 ms
rank = 0, Transfering density took 2.093 ms
Etot    =   -38.173242582551
Eband   =   -11.086729811432
E1      =    25.104726634192
E2      =    -9.932452012407
E3      =   -14.433834254975
Exc     =   -12.766691346321
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 3.310e-05, dEband = 1.085e-02
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -38.173242583, dEtot = 3.310e-05, dEband = 1.085e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2583150948907, which took 0.069 ms

iter_count = 114, r_2norm = 7.647e-06, tol*||rhs|| = 1.033e-05

Anderson update took 69.066 ms, out of which F'*F took 32.001 ms; b-Ax took 215.653 ms, out of which Lap took 191.377 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 500.769 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568390, int_b + int_rho = -2.328e-13, checking this took 0.076 ms
2-norm of RHS = 742.3557360520826, which took 0.207 ms

iter_count = 222, r_2norm = 6.879e-04, tol*||rhs|| = 7.424e-04

Anderson update took 137.789 ms, out of which F'*F took 64.641 ms; b-Ax took 440.053 ms, out of which Lap took 385.519 ms
Solving Poisson took 989.455 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 6.359522 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.172050 
Total time for convolution: 	 convolve: 5.264532 
Total time for convolution: 	 convolve: 5.172765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.168 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.001 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.613 ms

This SCF took 29172.414 ms, scf error = 1.825e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.141300, lowerbound = -0.967009, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1613.330 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.831 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.799 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.647 ms
rank =  0, finding HY took 25.298 ms
rank =  0, distributing HY into block cyclic form took 19.841 ms
rank =  0, finding Y'*HY took 3.768 ms
Rank 0, Project_Hamiltonian used 71.582 ms
Total time for projection: 71.593 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.966109388283655
    last  calculated eigval = 0.040237883227596
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62204814885188
lambda[   4] =  -0.53097352037033
lambda[   5] =  -0.43424472769619
lambda[   6] =  -0.40758842540307
lambda[   7] =  -0.38177635787489
lambda[   8] =  -0.34841673530948
lambda[   9] =  -0.32328033768634
lambda[  10] =  -0.31182139839672
lambda[  11] =  -0.31037950095374
lambda[  12] =  -0.19181774517431
lambda[  13] =  -0.03348334710365
lambda[  14] =  -0.00843471157064
lambda[  15] =   0.00330485776114
lambda[  16] =   0.02081385136587
lambda[  17] =   0.02356251114094
lambda[  18] =   0.03153076069313
lambda[  19] =   0.04023788322760
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.944 ms
rank =  0, Distributing orbital back into band + domain format took 19.459 ms
rank = 0, Subspace_Rotation used 27.415 ms

Total time for subspace rotation: 27.419 ms
rank = 0, Efermi =  -0.062423973932 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.909 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.421 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1731.671 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.975 ms
rank = 0, D2D took 2.080 ms
rank = 0, Transfering density took 2.086 ms
Etot    =   -38.173172114561
Eband   =   -11.056303725524
E1      =    25.092613317970
E2      =    -9.913900589288
E3      =   -14.434143168226
Exc     =   -12.766691138148
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 7.047e-06, dEband = 3.043e-03
rank = 0, Calculating/Estimating energy took 1.057 ms, Etot = -38.173172115, dEtot = 7.047e-06, dEband = 3.043e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1959691719777, which took 0.061 ms

iter_count = 108, r_2norm = 7.635e-06, tol*||rhs|| = 7.839e-06

Anderson update took 65.514 ms, out of which F'*F took 31.368 ms; b-Ax took 210.865 ms, out of which Lap took 186.150 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568400, int_b + int_rho = -1.310e-13, checking this took 0.157 ms
2-norm of RHS = 742.3185654213271, which took 0.165 ms

iter_count = 216, r_2norm = 6.954e-04, tol*||rhs|| = 7.423e-04

Anderson update took 131.073 ms, out of which F'*F took 64.976 ms; b-Ax took 440.859 ms, out of which Lap took 387.006 ms
Solving Poisson took 1000.250 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.306015 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.206072 
Total time for convolution: 	 convolve: 5.188756 
Total time for convolution: 	 convolve: 5.164721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.743 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.993 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.564 ms

This SCF took 28065.399 ms, scf error = 1.245e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.140238, lowerbound = -0.966109, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.620 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.803 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.741 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.563 ms
rank =  0, finding HY took 25.337 ms
rank =  0, distributing HY into block cyclic form took 20.047 ms
rank =  0, finding Y'*HY took 3.846 ms
Rank 0, Project_Hamiltonian used 71.819 ms
Total time for projection: 71.828 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.965002457505153
    last  calculated eigval = 0.039707344341002
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.62018159769249
lambda[   4] =  -0.52966744038146
lambda[   5] =  -0.43252847785915
lambda[   6] =  -0.40594239061118
lambda[   7] =  -0.38005848456673
lambda[   8] =  -0.34658422536928
lambda[   9] =  -0.32155568267861
lambda[  10] =  -0.31036104476567
lambda[  11] =  -0.30896394106292
lambda[  12] =  -0.19026309947105
lambda[  13] =  -0.03186316164633
lambda[  14] =  -0.00670120962545
lambda[  15] =   0.00518653549648
lambda[  16] =   0.02279249621355
lambda[  17] =   0.02536677227211
lambda[  18] =   0.03260654979429
lambda[  19] =   0.03970734434100
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 7.990 ms
rank =  0, Distributing orbital back into band + domain format took 19.493 ms
rank = 0, Subspace_Rotation used 27.496 ms

Total time for subspace rotation: 27.501 ms
rank = 0, Efermi =  -0.060803788501 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 6.624 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1730.164 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.713 ms
rank = 0, D2D took 2.811 ms
rank = 0, Transfering density took 2.813 ms
Etot    =   -38.173126238050
Eband   =   -11.018046582226
E1      =    25.071093090455
E2      =    -9.895894981191
E3      =   -14.439898993338
Exc     =   -12.771132394435
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 4.588e-06, dEband = 3.826e-03
rank = 0, Calculating/Estimating energy took 1.045 ms, Etot = -38.173126238, dEtot = 4.588e-06, dEband = 3.826e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1084507728631, which took 0.055 ms

iter_count = 114, r_2norm = 3.118e-06, tol*||rhs|| = 4.338e-06

Anderson update took 68.872 ms, out of which F'*F took 31.489 ms; b-Ax took 220.151 ms, out of which Lap took 196.743 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.719 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568399, int_b + int_rho = -1.419e-13, checking this took 0.142 ms
2-norm of RHS = 742.3117400797955, which took 0.178 ms

iter_count = 204, r_2norm = 7.191e-04, tol*||rhs|| = 7.423e-04

Anderson update took 126.819 ms, out of which F'*F took 60.031 ms; b-Ax took 398.508 ms, out of which Lap took 355.613 ms
Solving Poisson took 889.852 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.174293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.274 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.156064 
Total time for convolution: 	 convolve: 5.165452 
Total time for convolution: 	 convolve: 5.169057 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.770 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.247 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.017 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.726 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.988 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.531 ms

This SCF took 27864.277 ms, scf error = 8.096e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.139707, lowerbound = -0.965002, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1609.072 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.784 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.526 ms
rank =  0, finding HY took 25.338 ms
rank =  0, distributing HY into block cyclic form took 19.858 ms
rank =  0, finding Y'*HY took 3.773 ms
Rank 0, Project_Hamiltonian used 71.524 ms
Total time for projection: 71.534 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.964378495377967
    last  calculated eigval = 0.040218337395499
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61935060119832
lambda[   4] =  -0.52897761731055
lambda[   5] =  -0.43176644116914
lambda[   6] =  -0.40517190396631
lambda[   7] =  -0.37915189482092
lambda[   8] =  -0.34563114221248
lambda[   9] =  -0.32073911620514
lambda[  10] =  -0.30967751130818
lambda[  11] =  -0.30819196558826
lambda[  12] =  -0.18950288515388
lambda[  13] =  -0.02942321342852
lambda[  14] =  -0.00544139357360
lambda[  15] =   0.00853062070049
lambda[  16] =   0.02560663283509
lambda[  17] =   0.02742140043288
lambda[  18] =   0.03389916030364
lambda[  19] =   0.04021833739550
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 8.010 ms
rank =  0, Distributing orbital back into band + domain format took 19.384 ms
rank = 0, Subspace_Rotation used 27.406 ms

Total time for subspace rotation: 27.418 ms
rank = 0, Efermi =  -0.058363840404 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.790 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.498 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.184 ms
rank = 0, Calculating density took 1728.563 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.974 ms
rank = 0, D2D took 2.065 ms
rank = 0, Transfering density took 2.073 ms
Etot    =   -38.173132019730
Eband   =   -10.999304851504
E1      =    25.062736920086
E2      =    -9.885467746600
E3      =   -14.440186925632
Exc     =   -12.771384434170
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 5.782e-07, dEband = 1.874e-03
rank = 0, Calculating/Estimating energy took 1.230 ms, Etot = -38.173132020, dEtot = 5.782e-07, dEband = 1.874e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0647097839889, which took 0.076 ms

iter_count = 114, r_2norm = 2.097e-06, tol*||rhs|| = 2.588e-06

Anderson update took 69.418 ms, out of which F'*F took 33.081 ms; b-Ax took 224.250 ms, out of which Lap took 200.788 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568406, int_b + int_rho = -7.640e-14, checking this took 0.135 ms
2-norm of RHS = 742.3109519327320, which took 0.159 ms

iter_count = 180, r_2norm = 6.776e-04, tol*||rhs|| = 7.423e-04

Anderson update took 110.530 ms, out of which F'*F took 51.713 ms; b-Ax took 349.414 ms, out of which Lap took 309.434 ms
Solving Poisson took 777.971 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.172931 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.402 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.154778 
Total time for convolution: 	 convolve: 5.161896 
Total time for convolution: 	 convolve: 5.188987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.699 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.693 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.982 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.493 ms

This SCF took 27759.936 ms, scf error = 4.961e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.140218, lowerbound = -0.964378, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.540 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.941 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.748 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.709 ms
rank =  0, finding HY took 25.355 ms
rank =  0, distributing HY into block cyclic form took 19.756 ms
rank =  0, finding Y'*HY took 3.799 ms
Rank 0, Project_Hamiltonian used 71.645 ms
Total time for projection: 71.654 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.964056659966660
    last  calculated eigval = 0.039344754183010
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61884547076777
lambda[   4] =  -0.52858730827100
lambda[   5] =  -0.43133043623045
lambda[   6] =  -0.40473306246539
lambda[   7] =  -0.37859299518686
lambda[   8] =  -0.34503340535446
lambda[   9] =  -0.32026010718548
lambda[  10] =  -0.30930294384452
lambda[  11] =  -0.30775771605055
lambda[  12] =  -0.18911372496210
lambda[  13] =  -0.02805366390304
lambda[  14] =  -0.00495274168877
lambda[  15] =   0.00980990206144
lambda[  16] =   0.02539314552186
lambda[  17] =   0.02829633928909
lambda[  18] =   0.03303502767553
lambda[  19] =   0.03934475418301
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 7.929 ms
rank =  0, Distributing orbital back into band + domain format took 20.378 ms
rank = 0, Subspace_Rotation used 28.323 ms

Total time for subspace rotation: 28.327 ms
rank = 0, Efermi =  -0.056994290789 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.815 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.386 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1721.992 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.967 ms
rank = 0, D2D took 2.070 ms
rank = 0, Transfering density took 2.075 ms
Etot    =   -38.173208957439
Eband   =   -10.988453806253
E1      =    25.057277695129
E2      =    -9.879885431363
E3      =   -14.440912597481
Exc     =   -12.771996548785
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 7.694e-06, dEband = 1.085e-03
rank = 0, Calculating/Estimating energy took 1.045 ms, Etot = -38.173208957, dEtot = 7.694e-06, dEband = 1.085e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0555143970850, which took 0.055 ms

iter_count = 114, r_2norm = 1.753e-06, tol*||rhs|| = 2.221e-06

Anderson update took 68.838 ms, out of which F'*F took 33.035 ms; b-Ax took 220.682 ms, out of which Lap took 197.296 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 500.828 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568404, int_b + int_rho = -9.459e-14, checking this took 0.139 ms
2-norm of RHS = 742.3144368787563, which took 0.143 ms

iter_count = 162, r_2norm = 6.696e-04, tol*||rhs|| = 7.423e-04

Anderson update took 100.416 ms, out of which F'*F took 46.866 ms; b-Ax took 316.662 ms, out of which Lap took 279.585 ms
Solving Poisson took 703.259 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.173129 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.869 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.162958 
Total time for convolution: 	 convolve: 5.170147 
Total time for convolution: 	 convolve: 5.182849 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.764 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.489 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.996 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.519 ms

This SCF took 27672.175 ms, scf error = 3.741e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.139345, lowerbound = -0.964057, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1611.575 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.789 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.738 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.543 ms
rank =  0, finding HY took 25.318 ms
rank =  0, distributing HY into block cyclic form took 19.895 ms
rank =  0, finding Y'*HY took 3.748 ms
Rank 0, Project_Hamiltonian used 71.530 ms
Total time for projection: 71.540 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.963761717012326
    last  calculated eigval = 0.038528022335417
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61852882556389
lambda[   4] =  -0.52829697696917
lambda[   5] =  -0.43103712834877
lambda[   6] =  -0.40443831325072
lambda[   7] =  -0.37826605476227
lambda[   8] =  -0.34470766947835
lambda[   9] =  -0.31996480933005
lambda[  10] =  -0.30902204387116
lambda[  11] =  -0.30746034518429
lambda[  12] =  -0.18882548539289
lambda[  13] =  -0.02717760329829
lambda[  14] =  -0.00476593873671
lambda[  15] =   0.01040083142078
lambda[  16] =   0.02496915136986
lambda[  17] =   0.02842816519513
lambda[  18] =   0.03228596009201
lambda[  19] =   0.03852802233542
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 7.958 ms
rank =  0, Distributing orbital back into band + domain format took 20.180 ms
rank = 0, Subspace_Rotation used 28.154 ms

Total time for subspace rotation: 28.159 ms
rank = 0, Efermi =  -0.056118230202 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 6.718 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.443 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 1730.742 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.907 ms
rank = 0, D2D took 2.012 ms
rank = 0, Transfering density took 2.017 ms
Etot    =   -38.173277474268
Eband   =   -10.981197854099
E1      =    25.053538999093
E2      =    -9.876218863004
E3      =   -14.441411311700
Exc     =   -12.772414467592
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 6.852e-06, dEband = 7.256e-04
rank = 0, Calculating/Estimating energy took 1.071 ms, Etot = -38.173277474, dEtot = 6.852e-06, dEband = 7.256e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0386496900511, which took 0.057 ms

iter_count = 114, r_2norm = 1.005e-06, tol*||rhs|| = 1.546e-06

Anderson update took 69.174 ms, out of which F'*F took 32.904 ms; b-Ax took 223.911 ms, out of which Lap took 196.575 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 499.657 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568405, int_b + int_rho = -8.367e-14, checking this took 0.129 ms
2-norm of RHS = 742.3262980908906, which took 0.160 ms

iter_count = 174, r_2norm = 6.747e-04, tol*||rhs|| = 7.423e-04

Anderson update took 106.832 ms, out of which F'*F took 50.036 ms; b-Ax took 339.948 ms, out of which Lap took 300.859 ms
Solving Poisson took 760.725 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.148986 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 77.521 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.169036 
Total time for convolution: 	 convolve: 5.164990 
Total time for convolution: 	 convolve: 5.163161 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 2.049 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.964 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.467 ms

This SCF took 27693.917 ms, scf error = 2.744e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138528, lowerbound = -0.963762, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1624.034 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.936 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.742 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.694 ms
rank =  0, finding HY took 25.345 ms
rank =  0, distributing HY into block cyclic form took 19.778 ms
rank =  0, finding Y'*HY took 3.798 ms
Rank 0, Project_Hamiltonian used 71.644 ms
Total time for projection: 71.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.870 ms
    first calculated eigval = -0.963346017393948
    last  calculated eigval = 0.039542021822084
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61806597062987
lambda[   4] =  -0.52788123732995
lambda[   5] =  -0.43059872677436
lambda[   6] =  -0.40400349885290
lambda[   7] =  -0.37780120049103
lambda[   8] =  -0.34424584727994
lambda[   9] =  -0.31952688337386
lambda[  10] =  -0.30861529256219
lambda[  11] =  -0.30703580876389
lambda[  12] =  -0.18838974249713
lambda[  13] =  -0.02466016189834
lambda[  14] =  -0.00429032949776
lambda[  15] =   0.01257546773091
lambda[  16] =   0.02652423102010
lambda[  17] =   0.02986290975684
lambda[  18] =   0.03315625778903
lambda[  19] =   0.03954202182208
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.897 ms
rank =  0, subspace rotation using ScaLAPACK took 8.513 ms
rank =  0, Distributing orbital back into band + domain format took 19.368 ms
rank = 0, Subspace_Rotation used 27.897 ms

Total time for subspace rotation: 27.905 ms
rank = 0, Efermi =  -0.053600788810 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.749 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.553 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1743.484 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.051 ms
rank = 0, Transfering density took 2.057 ms
Etot    =   -38.173340684451
Eband   =   -10.970677714417
E1      =    25.048455645060
E2      =    -9.870588495606
E3      =   -14.442105297801
Exc     =   -12.772978082127
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 6.321e-06, dEband = 1.052e-03
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -38.173340684, dEtot = 6.321e-06, dEband = 1.052e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0326516933423, which took 0.177 ms

iter_count = 114, r_2norm = 8.623e-07, tol*||rhs|| = 1.306e-06

Anderson update took 69.096 ms, out of which F'*F took 33.320 ms; b-Ax took 223.425 ms, out of which Lap took 198.335 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568397, int_b + int_rho = -1.637e-13, checking this took 0.145 ms
2-norm of RHS = 742.3291053833428, which took 0.174 ms

iter_count = 132, r_2norm = 6.632e-04, tol*||rhs|| = 7.423e-04

Anderson update took 82.089 ms, out of which F'*F took 37.394 ms; b-Ax took 252.677 ms, out of which Lap took 224.056 ms
Solving Poisson took 570.946 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.163898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 83.762 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.222 ms
Total time for convolution: 	 convolve: 5.163505 
Total time for convolution: 	 convolve: 5.171960 
Total time for convolution: 	 convolve: 5.163453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.275 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.438 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.993 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.465 ms

This SCF took 27528.412 ms, scf error = 1.688e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.139542, lowerbound = -0.963346, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1607.462 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.809 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.757 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.583 ms
rank =  0, finding HY took 25.247 ms
rank =  0, distributing HY into block cyclic form took 19.794 ms
rank =  0, finding Y'*HY took 3.814 ms
Rank 0, Project_Hamiltonian used 72.394 ms
Total time for projection: 72.409 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.200 ms
    first calculated eigval = -0.963218079600621
    last  calculated eigval = 0.039334159902047
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61792717104051
lambda[   4] =  -0.52775398862640
lambda[   5] =  -0.43046520437602
lambda[   6] =  -0.40386998546413
lambda[   7] =  -0.37766972999859
lambda[   8] =  -0.34411365551974
lambda[   9] =  -0.31939511131057
lambda[  10] =  -0.30848536891349
lambda[  11] =  -0.30690865633063
lambda[  12] =  -0.18826063606234
lambda[  13] =  -0.02391006247098
lambda[  14] =  -0.00423850127443
lambda[  15] =   0.01290598286584
lambda[  16] =   0.02666983556735
lambda[  17] =   0.02995936910904
lambda[  18] =   0.03311741316995
lambda[  19] =   0.03933415990205
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.966 ms
rank =  0, Distributing orbital back into band + domain format took 19.363 ms
rank = 0, Subspace_Rotation used 27.340 ms

Total time for subspace rotation: 27.346 ms
rank = 0, Efermi =  -0.052850689374 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.814 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.345 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.604 ms
rank = 0, Calculating density took 1726.392 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.960 ms
rank = 0, D2D took 2.063 ms
rank = 0, Transfering density took 2.070 ms
Etot    =   -38.173361042085
Eband   =   -10.967514941567
E1      =    25.046839209156
E2      =    -9.868948862172
E3      =   -14.442424442243
Exc     =   -12.773224287716
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 2.036e-06, dEband = 3.163e-04
rank = 0, Calculating/Estimating energy took 1.063 ms, Etot = -38.173361042, dEtot = 2.036e-06, dEband = 3.163e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232713641353, which took 0.060 ms

iter_count = 108, r_2norm = 9.075e-07, tol*||rhs|| = 9.309e-07

Anderson update took 64.923 ms, out of which F'*F took 30.373 ms; b-Ax took 208.543 ms, out of which Lap took 185.579 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.487 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568400, int_b + int_rho = -1.382e-13, checking this took 0.145 ms
2-norm of RHS = 742.3332723893394, which took 0.177 ms

iter_count = 144, r_2norm = 6.239e-04, tol*||rhs|| = 7.423e-04

Anderson update took 88.707 ms, out of which F'*F took 42.360 ms; b-Ax took 284.215 ms, out of which Lap took 252.321 ms
Solving Poisson took 628.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.177287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 104.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.174296 
Total time for convolution: 	 convolve: 5.368170 
Total time for convolution: 	 convolve: 5.177924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.507 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.964 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.505 ms

This SCF took 27815.741 ms, scf error = 1.394e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139334, lowerbound = -0.963218, upperbound = 267.582954

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1614.326 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.929 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.771 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.716 ms
rank =  0, finding HY took 25.606 ms
rank =  0, distributing HY into block cyclic form took 19.713 ms
rank =  0, finding Y'*HY took 3.824 ms
Rank 0, Project_Hamiltonian used 71.885 ms
Total time for projection: 71.895 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.963050048541006
    last  calculated eigval = 0.039275806870738
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.61776921523298
lambda[   4] =  -0.52758806176805
lambda[   5] =  -0.43030759390107
lambda[   6] =  -0.40370592962523
lambda[   7] =  -0.37751287637411
lambda[   8] =  -0.34395662135181
lambda[   9] =  -0.31923740887714
lambda[  10] =  -0.30832028543008
lambda[  11] =  -0.30674548829167
lambda[  12] =  -0.18810511120551
lambda[  13] =  -0.02357038474913
lambda[  14] =  -0.00420076686509
lambda[  15] =   0.01250436863796
lambda[  16] =   0.02688753139728
lambda[  17] =   0.03022539972531
lambda[  18] =   0.03378712207728
lambda[  19] =   0.03927580687074
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.029 ms
rank =  0, Distributing orbital back into band + domain format took 19.382 ms
rank = 0, Subspace_Rotation used 27.425 ms

Total time for subspace rotation: 27.430 ms
rank = 0, Efermi =  -0.052511011579 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 6.765 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.485 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.609 ms
rank = 0, Calculating density took 1732.847 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.941 ms
rank = 0, D2D took 2.039 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -38.173389368666
Eband   =   -10.963656754805
E1      =    25.045080846700
E2      =    -9.866768444050
E3      =   -14.442603056775
Exc     =   -12.773350635013
Esc     =   -63.790834325607
Entropy =    -0.000000000766
dE = 2.833e-06, dEband = 3.858e-04
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -38.173389369, dEtot = 2.833e-06, dEband = 3.858e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0192553259201, which took 0.054 ms

iter_count = 108, r_2norm = 6.949e-07, tol*||rhs|| = 7.702e-07

Anderson update took 65.788 ms, out of which F'*F took 44.992 ms; b-Ax took 226.774 ms, out of which Lap took 204.183 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.490 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002568413, int_rho =  24.00000002568405, int_b + int_rho = -8.367e-14, checking this took 0.116 ms
2-norm of RHS = 742.3337239572685, which took 0.176 ms

iter_count = 126, r_2norm = 6.266e-04, tol*||rhs|| = 7.423e-04

Anderson update took 77.902 ms, out of which F'*F took 35.928 ms; b-Ax took 246.084 ms, out of which Lap took 217.069 ms
Solving Poisson took 557.117 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.834 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.176593 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.560 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.168358 
Total time for convolution: 	 convolve: 5.163882 
Total time for convolution: 	 convolve: 5.163520 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.414 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.318 ms

This SCF took 27494.184 ms, scf error = 9.890e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.61776921523298, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52758806176805, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43030759390107, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40370592962523, occ[   6] =   2.00000000000000
lambda[   7] =  -0.37751287637411, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34395662135181, occ[   8] =   2.00000000000000
lambda[   9] =  -0.31923740887714, occ[   9] =   2.00000000000000
lambda[  10] =  -0.30832028543008, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30674548829167, occ[  11] =   2.00000000000000
lambda[  12] =  -0.18810511120551, occ[  12] =   2.00000000000000
lambda[  13] =  -0.02357038474913, occ[  13] =   0.00000002568400
lambda[  14] =  -0.00420076686509, occ[  14] =   0.00000000000000
lambda[  15] =   0.01250436863796, occ[  15] =   0.00000000000000
lambda[  16] =   0.02688753139728, occ[  16] =   0.00000000000000
lambda[  17] =   0.03022539972531, occ[  17] =   0.00000000000000
lambda[  18] =   0.03378712207728, occ[  18] =   0.00000000000000
lambda[  19] =   0.03927580687074, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.395 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.595 ms, time for Allreduce/Reduce: 11.884 ms 
Time for calculating local force components: 23.744 ms
Start Calculating nonlocal forces
force_nloc = 
  0.34600562230513   1.01970337795089   0.00000128645859
 -0.04820353294958  -0.01414580933746  -0.00000001659875
  0.00854983364260   0.02813575949573  -0.04002474912619
  0.00854984366151   0.02813574628468   0.04002468531146
 -0.04993218024891  -0.01149338751628   0.00000001349396
  0.03244432103031  -0.03847397905415   0.00000002592104
  0.04440787506903  -0.06039799577232   0.00000000693680
 -0.02281897420652   0.02513181525057  -0.00000155729619
 -0.20090358290761  -0.09701142887702  -0.00000095671703
 -0.01747397308063  -0.00993159230962  -0.00000434681491
force_loc = 
 -0.33644064443987  -0.99150500581507   0.00000022249483
  0.05064458468200   0.01422607821870   0.00000000615381
 -0.00859341567213  -0.03058696951683   0.04221852918261
 -0.00859363150388  -0.03058680191722  -0.04221855249692
  0.05274409307394   0.01320360650774  -0.00000003382185
 -0.03366718939084   0.04147233223483  -0.00000052024049
 -0.04772180749345   0.06271970948921  -0.00000024957800
  0.02060487212328  -0.02116016683667   0.00000087825131
  0.19460594803031   0.08635345925436   0.00000099404070
  0.01723013990258   0.01399218522034   0.00000006608163
Time for calculating nonlocal force components: 42.769 ms
[32mforces_xc: 
[0m[32m -0.01068850570608  -0.03037275112268   0.00000001677148
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00098860255317  -0.00134183671753   0.00000005993930
[0m[32m  0.00904131848447   0.00852445937904   0.00000011338552
[0m[32m -0.00087138424033  -0.00468535563916  -0.00000001915097
[0mTime for calculating XC forces components: 34.412 ms
 Cartesian force = 
 -0.00111435111268  -0.00216492387227   0.00000193546672
  0.00245022846057   0.00008972399583   0.00000039929689
 -0.00003440530138  -0.00244175490651   0.00219418979825
 -0.00003461111423  -0.00244160051795  -0.00219345744364
  0.00282108955319   0.00171967410605   0.00000038941393
 -0.00121369163238   0.00300780829527  -0.00000008457762
 -0.00330475569627   0.00233116883148   0.00000016710063
 -0.00121632280192   0.00263926681096  -0.00000020936375
  0.00275286033533  -0.00212405512902   0.00000056045102
 -0.00110604069023  -0.00061530761385  -0.00000389014243
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 384.862 ms
The program took 454.643 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:54
Job ID:        2266630
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:24,vmem=8368K,walltime=00:07:47,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-35-1
---------------------------------------
