---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:14
Job ID:    2266618
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:20
Job ID:    2266618
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.085 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 6.469 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = C.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 106.608 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 44.435 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.036 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.119 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   11.312526	
   10.000000	   10.000000	    8.687474	
   10.000000	   10.000000	   13.513770	
   10.000000	   10.000000	    6.486230	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.190 ms
Set up communicators.

--set up spincomm took 2.229 ms

--set up kptcomm took 0.351 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.090 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.535 ms

Calculate_SplineDerivRadFun took 0.149 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.832 ms.
time spent on vectorized spline interp: 3.110 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.628 ms.
time spent on vectorized spline interp: 3.003 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.670 ms.

Calculating rb for all atom types took 13.290 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.201 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000048825, sum_int_rho = 17.9806031152423
PosCharge = 18.000000004883, NegCharge = -17.980603115242, scal_fac = 1.001078767465
After scaling, int_rho = 18.0000000048824, PosCharge + NegCharge - NetCharge = 9.592e-14
--Calculate Vref took 0.471 ms
--Calculate rho_guess took 4.766 ms

 integral of b = -18.0000000048825,
 int{b} + Nelectron + NetCharge = -4.883e-09,
 Esc = -53.8378863737441,
 MPI_Reduce took 2.212 ms

Calculating b & b_ref took 14.023 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.021 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.090 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.012 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.127 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.020 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.002 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.014 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 29.671 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488259, int_b + int_rho = -8.877e-13, checking this took 0.092 ms
2-norm of RHS = 505.7805507193053, which took 0.080 ms

iter_count = 426, r_2norm = 4.502e-04, tol*||rhs|| = 5.058e-04

Anderson update took 270.900 ms, out of which F'*F took 124.163 ms; b-Ax took 842.910 ms, out of which Lap took 747.988 ms
Solving Poisson took 1902.839 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.322 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.845 ms
Total time for convolution: 	 convolve: 5.092695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.593 ms
Total time for convolution: 	 convolve: 5.081912 
Total time for convolution: 	 convolve: 5.088477 
Total time for convolution: 	 convolve: 5.077623 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.734 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.672 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
rank = 0, XC calculation took 24246.797 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.603 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.188 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.823 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.135 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.903 ms
    Lanczos iter 55, eigmin  = -1.018836287, eigmax = 264.935737442, err_eigmin = 3.585e-04, err_eigmax = 9.790e-03
rank =   0, Lanczos took 142.678 ms, eigmin = -1.018836287252, eigmax = 267.585094816646

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.233129, lowerbound = -1.118836, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1471.539 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.901 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.438 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.573 ms
rank =  0, Distribute data + matrix mult took 21.945 ms
rank =  0, finding HY took 23.066 ms
rank =  0, distributing HY into block cyclic form took 16.073 ms
rank =  0, finding Y'*HY took 4.853 ms
Rank 0, Project_Hamiltonian used 65.987 ms
Total time for projection: 66.025 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.489 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.572 ms
    first calculated eigval = 2.806468452096128
    last  calculated eigval = 3.185998673208359
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80646845209613
lambda[   2] =   2.85445799926547
lambda[   3] =   2.86722468886057
lambda[   4] =   2.91545017147190
lambda[   5] =   2.93638723652884
lambda[   6] =   2.95398154033575
lambda[   7] =   2.98542563375095
lambda[   8] =   3.02195994897056
lambda[   9] =   3.04479313653368
lambda[  10] =   3.06461394149073
lambda[  11] =   3.09387731407931
lambda[  12] =   3.10705125109575
lambda[  13] =   3.12960250581927
lambda[  14] =   3.15910719672350
lambda[  15] =   3.18599867320836
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.587 ms
rank =  0, subspace rotation using ScaLAPACK took 4.356 ms
rank =  0, Distributing orbital back into band + domain format took 14.090 ms
rank = 0, Subspace_Rotation used 18.471 ms

Total time for subspace rotation: 18.479 ms
rank = 0, Efermi =   3.054703539116 calculate fermi energy took 0.116 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.285999, lowerbound = -1.118836, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1456.818 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.110 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 18.352 ms
rank =  0, finding HY took 22.382 ms
rank =  0, distributing HY into block cyclic form took 14.619 ms
rank =  0, finding Y'*HY took 4.697 ms
Rank 0, Project_Hamiltonian used 60.786 ms
Total time for projection: 60.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.817176559298820
    last  calculated eigval = 0.421956616686341
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.81717655929882
lambda[   2] =  -0.65020691421921
lambda[   3] =  -0.37030290380089
lambda[   4] =  -0.17642610770538
lambda[   5] =  -0.04906965623513
lambda[   6] =   0.01049174991719
lambda[   7] =   0.10412561344183
lambda[   8] =   0.16385652428864
lambda[   9] =   0.27271797287836
lambda[  10] =   0.30371054269154
lambda[  11] =   0.31284120099084
lambda[  12] =   0.37208873231158
lambda[  13] =   0.38496210042431
lambda[  14] =   0.40879797882913
lambda[  15] =   0.42195661668634
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 4.296 ms
rank =  0, Distributing orbital back into band + domain format took 14.639 ms
rank = 0, Subspace_Rotation used 18.958 ms

Total time for subspace rotation: 18.964 ms
rank = 0, Efermi =   0.288213662063 calculate fermi energy took 0.050 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.521957, lowerbound = -1.118836, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1437.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.871 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.640 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 18.565 ms
rank =  0, finding HY took 22.303 ms
rank =  0, distributing HY into block cyclic form took 14.611 ms
rank =  0, finding Y'*HY took 4.690 ms
Rank 0, Project_Hamiltonian used 60.209 ms
Total time for projection: 60.217 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.021755900381890
    last  calculated eigval = 0.129517835130053
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02175590038189
lambda[   2] =  -1.01343748494487
lambda[   3] =  -0.74542149493651
lambda[   4] =  -0.47677547090438
lambda[   5] =  -0.47360005845592
lambda[   6] =  -0.46016954752704
lambda[   7] =  -0.45743119298906
lambda[   8] =  -0.40413243326062
lambda[   9] =  -0.38499291164147
lambda[  10] =  -0.13692142215369
lambda[  11] =  -0.06893428735343
lambda[  12] =   0.07809600462736
lambda[  13] =   0.09912275636843
lambda[  14] =   0.10820663750058
lambda[  15] =   0.12951783513005
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 4.294 ms
rank =  0, Distributing orbital back into band + domain format took 14.742 ms
rank = 0, Subspace_Rotation used 19.058 ms

Total time for subspace rotation: 19.063 ms
rank = 0, Efermi =  -0.167330564297 calculate fermi energy took 0.031 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.229518, lowerbound = -1.118836, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1435.276 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.891 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.630 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.556 ms
rank =  0, finding HY took 22.270 ms
rank =  0, distributing HY into block cyclic form took 14.460 ms
rank =  0, finding Y'*HY took 4.822 ms
Rank 0, Project_Hamiltonian used 60.150 ms
Total time for projection: 60.160 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.022249866436441
    last  calculated eigval = 0.079513064984335
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02224986643644
lambda[   2] =  -1.01374416205774
lambda[   3] =  -0.74716311487145
lambda[   4] =  -0.48129368360746
lambda[   5] =  -0.47996513025212
lambda[   6] =  -0.47973486632162
lambda[   7] =  -0.47305121932273
lambda[   8] =  -0.42382968564550
lambda[   9] =  -0.42345869910276
lambda[  10] =  -0.19249051591993
lambda[  11] =  -0.18564621556568
lambda[  12] =   0.01721901401024
lambda[  13] =   0.02685599903949
lambda[  14] =   0.04360205452197
lambda[  15] =   0.07951306498433
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.310 ms
rank =  0, Distributing orbital back into band + domain format took 14.577 ms
rank = 0, Subspace_Rotation used 18.910 ms

Total time for subspace rotation: 18.916 ms
rank = 0, Efermi =  -0.222899792730 calculate fermi energy took 0.033 ms
rank = 0, --- Calculate rho: sum over local bands took 5.126 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.368 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 6280.984 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.903 ms
rank = 0, D2D took 1.136 ms
rank = 0, Transfering density took 1.148 ms
Etot    =   -32.816831757512
Eband   =   -11.088980856175
E1      =    22.003314469741
E2      =    -9.259603188813
E3      =   -10.611711790479
Exc     =    -9.764593976472
Esc     =   -53.837886373744
Entropy =    -0.000000000153
dE = 8.204e+00, dEband = 2.772e+00
rank = 0, Calculating/Estimating energy took 1.140 ms, Etot = -32.816831758, dEtot = 8.204e+00, dEband = 2.772e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 45.1574538357452, which took 0.151 ms

iter_count = 96, r_2norm = 1.173e-03, tol*||rhs|| = 1.806e-03

Anderson update took 56.917 ms, out of which F'*F took 26.586 ms; b-Ax took 183.686 ms, out of which Lap took 161.247 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.975 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488242, int_b + int_rho = -1.062e-12, checking this took 0.132 ms
2-norm of RHS = 501.6484086733126, which took 0.250 ms

iter_count = 276, r_2norm = 4.694e-04, tol*||rhs|| = 5.016e-04

Anderson update took 165.023 ms, out of which F'*F took 76.992 ms; b-Ax took 526.564 ms, out of which Lap took 466.362 ms
Solving Poisson took 1200.210 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.424 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.078521 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 105.264 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.077817 
Total time for convolution: 	 convolve: 5.078644 
Total time for convolution: 	 convolve: 5.080676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.430 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.925 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.299 ms

This SCF took 32318.076 ms, scf error = 1.822e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.179513, lowerbound = -1.022250, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1401.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.694 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.891 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.621 ms
rank =  0, finding HY took 22.213 ms
rank =  0, distributing HY into block cyclic form took 16.598 ms
rank =  0, finding Y'*HY took 2.908 ms
Rank 0, Project_Hamiltonian used 60.391 ms
Total time for projection: 60.404 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.977437783493584
    last  calculated eigval = 0.051189491869178
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97743778349358
lambda[   2] =  -0.96523430548566
lambda[   3] =  -0.74138232180412
lambda[   4] =  -0.45801503023947
lambda[   5] =  -0.45798398337190
lambda[   6] =  -0.43950508906227
lambda[   7] =  -0.43026021489559
lambda[   8] =  -0.39079264699571
lambda[   9] =  -0.39072569160009
lambda[  10] =  -0.17248920789478
lambda[  11] =  -0.17192755888055
lambda[  12] =   0.00567328889258
lambda[  13] =   0.01575749382929
lambda[  14] =   0.02120634217337
lambda[  15] =   0.05118949186918
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 4.179 ms
rank =  0, Distributing orbital back into band + domain format took 14.907 ms
rank = 0, Subspace_Rotation used 19.112 ms

Total time for subspace rotation: 19.119 ms
rank = 0, Efermi =  -0.203255628838 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.987 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.728 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.143 ms
rank = 0, Calculating density took 1489.943 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
rank = 0, D2D took 0.680 ms
rank = 0, Transfering density took 0.685 ms
Etot    =   -32.754581381531
Eband   =   -10.502674134738
E1      =    21.497230329515
E2      =    -9.210493154037
E3      =   -10.765564541842
Exc     =    -9.887308898289
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 1.556e-02, dEband = 1.466e-01
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -32.754581382, dEtot = 1.556e-02, dEband = 1.466e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 25.4730599059822, which took 0.067 ms

iter_count = 96, r_2norm = 8.025e-04, tol*||rhs|| = 1.019e-03

Anderson update took 57.147 ms, out of which F'*F took 26.764 ms; b-Ax took 184.212 ms, out of which Lap took 162.425 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.771 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488244, int_b + int_rho = -1.040e-12, checking this took 0.078 ms
2-norm of RHS = 499.3295667265259, which took 0.236 ms

iter_count = 282, r_2norm = 4.499e-04, tol*||rhs|| = 4.993e-04

Anderson update took 167.422 ms, out of which F'*F took 75.994 ms; b-Ax took 528.137 ms, out of which Lap took 465.319 ms
Solving Poisson took 1178.679 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.847 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.079811 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 84.422 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
Total time for convolution: 	 convolve: 5.081676 
Total time for convolution: 	 convolve: 5.076004 
Total time for convolution: 	 convolve: 5.100217 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.660 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.486 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.168 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.744 ms
---Transfer Veff_loc: D2D took 1.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.827 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.674 ms

This SCF took 27544.635 ms, scf error = 1.181e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.151189, lowerbound = -0.977438, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1409.912 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.703 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.008 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 18.734 ms
rank =  0, finding HY took 22.966 ms
rank =  0, distributing HY into block cyclic form took 14.449 ms
rank =  0, finding Y'*HY took 5.033 ms
Rank 0, Project_Hamiltonian used 61.216 ms
Total time for projection: 61.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.930580043595359
    last  calculated eigval = 0.043525512204095
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.93058004359536
lambda[   2] =  -0.91496484281932
lambda[   3] =  -0.71470563181025
lambda[   4] =  -0.43096570621278
lambda[   5] =  -0.43093129905830
lambda[   6] =  -0.40459731940653
lambda[   7] =  -0.39357080007683
lambda[   8] =  -0.35968790273839
lambda[   9] =  -0.35965377642428
lambda[  10] =  -0.14823351743517
lambda[  11] =  -0.14816601502029
lambda[  12] =  -0.00685674201690
lambda[  13] =   0.01984116300577
lambda[  14] =   0.03423007834095
lambda[  15] =   0.04352551220410
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 4.209 ms
rank =  0, Distributing orbital back into band + domain format took 14.662 ms
rank = 0, Subspace_Rotation used 18.890 ms

Total time for subspace rotation: 18.896 ms
rank = 0, Efermi =  -0.179203137448 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.040 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.243 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 1497.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.869 ms
rank = 0, D2D took 1.160 ms
rank = 0, Transfering density took 1.164 ms
Etot    =   -32.719138535459
Eband   =    -9.879314645008
E1      =    20.980865764468
E2      =    -9.106021789117
E3      =   -10.928718633418
Exc     =   -10.017543703555
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 8.861e-03, dEband = 1.558e-01
rank = 0, Calculating/Estimating energy took 1.149 ms, Etot = -32.719138535, dEtot = 8.861e-03, dEband = 1.558e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.5148256481948, which took 0.504 ms

iter_count = 108, r_2norm = 1.160e-04, tol*||rhs|| = 1.806e-04

Anderson update took 65.456 ms, out of which F'*F took 29.863 ms; b-Ax took 204.073 ms, out of which Lap took 180.403 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.928 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488239, int_b + int_rho = -1.088e-12, checking this took 0.120 ms
2-norm of RHS = 499.5790570246917, which took 0.154 ms

iter_count = 276, r_2norm = 4.694e-04, tol*||rhs|| = 4.996e-04

Anderson update took 165.821 ms, out of which F'*F took 78.198 ms; b-Ax took 534.419 ms, out of which Lap took 471.782 ms
Solving Poisson took 1177.466 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.617 ms
Total time for convolution: 	 convolve: 5.083836 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.395 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.630 ms
Total time for convolution: 	 convolve: 5.079234 
Total time for convolution: 	 convolve: 5.080795 
Total time for convolution: 	 convolve: 5.080243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.450 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.780 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.811 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.793 ms

This SCF took 28712.108 ms, scf error = 5.388e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.143526, lowerbound = -0.930580, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1317.462 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 523.376 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.852 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 527.264 ms
rank =  0, finding HY took 22.047 ms
rank =  0, distributing HY into block cyclic form took 14.364 ms
rank =  0, finding Y'*HY took 5.482 ms
Rank 0, Project_Hamiltonian used 569.202 ms
Total time for projection: 569.218 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.900404183988595
    last  calculated eigval = 0.043156023799576
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.90040418398860
lambda[   2] =  -0.88313506683904
lambda[   3] =  -0.69059227214882
lambda[   4] =  -0.41154708805736
lambda[   5] =  -0.41152926989162
lambda[   6] =  -0.38332584648343
lambda[   7] =  -0.37094717771909
lambda[   8] =  -0.34040892855174
lambda[   9] =  -0.34039665932378
lambda[  10] =  -0.13238005994386
lambda[  11] =  -0.13237144135892
lambda[  12] =  -0.01797275690217
lambda[  13] =   0.02230381724500
lambda[  14] =   0.04130257742030
lambda[  15] =   0.04315602379958
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 4.207 ms
rank =  0, Distributing orbital back into band + domain format took 14.822 ms
rank = 0, Subspace_Rotation used 19.053 ms

Total time for subspace rotation: 19.060 ms
rank = 0, Efermi =  -0.163378478986 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.109 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.275 ms
rank = 0, Calculating density took 1913.900 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.874 ms
rank = 0, D2D took 1.087 ms
rank = 0, Transfering density took 1.094 ms
Etot    =   -32.710290452330
Eband   =    -9.464572986653
E1      =    20.668625503927
E2      =    -8.988866253188
E3      =   -11.039221180042
Exc     =   -10.104544028935
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.212e-03, dEband = 1.037e-01
rank = 0, Calculating/Estimating energy took 1.589 ms, Etot = -32.710290452, dEtot = 2.212e-03, dEband = 1.037e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 1.8407982242301, which took 0.066 ms

iter_count = 108, r_2norm = 5.859e-05, tol*||rhs|| = 7.363e-05

Anderson update took 64.004 ms, out of which F'*F took 30.851 ms; b-Ax took 211.996 ms, out of which Lap took 187.016 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 470.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488241, int_b + int_rho = -1.073e-12, checking this took 0.125 ms
2-norm of RHS = 501.3224171260303, which took 0.212 ms

iter_count = 258, r_2norm = 4.812e-04, tol*||rhs|| = 5.013e-04

Anderson update took 155.773 ms, out of which F'*F took 72.294 ms; b-Ax took 490.005 ms, out of which Lap took 433.897 ms
Solving Poisson took 1097.082 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.081149 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.410 ms
Total time for convolution: 	 convolve: 5.081859 
Total time for convolution: 	 convolve: 5.079360 
Total time for convolution: 	 convolve: 5.078490 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.424 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.840 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.821 ms

This SCF took 27933.073 ms, scf error = 1.384e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.143156, lowerbound = -0.900404, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1403.423 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 14.911 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.551 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.494 ms
rank =  0, finding HY took 22.332 ms
rank =  0, distributing HY into block cyclic form took 14.250 ms
rank =  0, finding Y'*HY took 5.377 ms
Rank 0, Project_Hamiltonian used 60.494 ms
Total time for projection: 60.511 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.898623630057253
    last  calculated eigval = 0.039160897377738
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89862363005725
lambda[   2] =  -0.88127411124683
lambda[   3] =  -0.68869961774193
lambda[   4] =  -0.40996505565464
lambda[   5] =  -0.40996201444565
lambda[   6] =  -0.37918592098455
lambda[   7] =  -0.36679031682852
lambda[   8] =  -0.33836936802264
lambda[   9] =  -0.33836735785758
lambda[  10] =  -0.13033404464244
lambda[  11] =  -0.13033332528383
lambda[  12] =  -0.02366298680433
lambda[  13] =   0.02075152721904
lambda[  14] =   0.03650269588096
lambda[  15] =   0.03916089737774
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 4.226 ms
rank =  0, Distributing orbital back into band + domain format took 14.853 ms
rank = 0, Subspace_Rotation used 19.099 ms

Total time for subspace rotation: 19.105 ms
rank = 0, Efermi =  -0.161336402751 calculate fermi energy took 2.200 ms
rank = 0, --- Calculate rho: sum over local bands took 3.954 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.200 ms
rank = 0, Calculating density took 1491.826 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.776 ms
rank = 0, D2D took 1.879 ms
rank = 0, Transfering density took 1.889 ms
Etot    =   -32.709299773649
Eband   =    -9.422474786316
E1      =    20.678087367773
E2      =    -8.933889593702
E3      =   -11.048191047002
Exc     =   -10.109106621911
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.477e-04, dEband = 1.052e-02
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -32.709299774, dEtot = 2.477e-04, dEband = 1.052e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6516594970659, which took 0.114 ms

iter_count = 114, r_2norm = 1.685e-05, tol*||rhs|| = 2.607e-05

Anderson update took 67.358 ms, out of which F'*F took 32.284 ms; b-Ax took 218.313 ms, out of which Lap took 195.619 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.273 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488239, int_b + int_rho = -1.088e-12, checking this took 0.117 ms
2-norm of RHS = 501.8904943148855, which took 0.154 ms

iter_count = 240, r_2norm = 3.905e-04, tol*||rhs|| = 5.019e-04

Anderson update took 141.895 ms, out of which F'*F took 69.718 ms; b-Ax took 470.001 ms, out of which Lap took 419.586 ms
Solving Poisson took 1041.461 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.401 ms
Total time for convolution: 	 convolve: 5.118932 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.413 ms
Total time for convolution: 	 convolve: 5.128095 
Total time for convolution: 	 convolve: 5.086489 
Total time for convolution: 	 convolve: 5.088719 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.395 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.381 ms

This SCF took 27438.696 ms, scf error = 5.253e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.139161, lowerbound = -0.898624, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.005 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.389 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 18.440 ms
rank =  0, finding HY took 22.299 ms
rank =  0, distributing HY into block cyclic form took 14.643 ms
rank =  0, finding Y'*HY took 4.755 ms
Rank 0, Project_Hamiltonian used 60.175 ms
Total time for projection: 60.202 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.897578105072296
    last  calculated eigval = 0.034233838194165
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89757810507230
lambda[   2] =  -0.88014537027112
lambda[   3] =  -0.68785543196162
lambda[   4] =  -0.40909574173385
lambda[   5] =  -0.40909440054439
lambda[   6] =  -0.37695731018079
lambda[   7] =  -0.36456203927680
lambda[   8] =  -0.33713725156825
lambda[   9] =  -0.33713294165893
lambda[  10] =  -0.12914006228600
lambda[  11] =  -0.12913806538089
lambda[  12] =  -0.02642086237489
lambda[  13] =   0.02008369227296
lambda[  14] =   0.03261123353688
lambda[  15] =   0.03423383819417
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.246 ms
rank =  0, Distributing orbital back into band + domain format took 14.716 ms
rank = 0, Subspace_Rotation used 18.983 ms

Total time for subspace rotation: 18.989 ms
rank = 0, Efermi =  -0.160141781959 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 4.361 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.693 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.340 ms
rank = 0, Calculating density took 1482.635 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.835 ms
rank = 0, D2D took 1.102 ms
rank = 0, Transfering density took 1.105 ms
Etot    =   -32.708984933083
Eband   =    -9.399117185167
E1      =    20.676376002367
E2      =    -8.910399272481
E3      =   -11.053463730921
Exc     =   -10.112220379786
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 7.871e-05, dEband = 5.839e-03
rank = 0, Calculating/Estimating energy took 1.102 ms, Etot = -32.708984933, dEtot = 7.871e-05, dEband = 5.839e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3277822261773, which took 0.104 ms

iter_count = 108, r_2norm = 1.038e-05, tol*||rhs|| = 1.311e-05

Anderson update took 63.540 ms, out of which F'*F took 29.481 ms; b-Ax took 203.826 ms, out of which Lap took 179.980 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.350 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488242, int_b + int_rho = -1.062e-12, checking this took 0.136 ms
2-norm of RHS = 501.8644525306367, which took 0.232 ms

iter_count = 252, r_2norm = 4.807e-04, tol*||rhs|| = 5.019e-04

Anderson update took 152.797 ms, out of which F'*F took 69.869 ms; b-Ax took 474.667 ms, out of which Lap took 420.381 ms
Solving Poisson took 1063.535 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
Total time for convolution: 	 convolve: 5.080569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.788 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.421 ms
Total time for convolution: 	 convolve: 5.081432 
Total time for convolution: 	 convolve: 5.078351 
Total time for convolution: 	 convolve: 5.080505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.475 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.405 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.388 ms

This SCF took 27572.948 ms, scf error = 3.440e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134234, lowerbound = -0.897578, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1367.944 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.030 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.392 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 18.471 ms
rank =  0, finding HY took 22.254 ms
rank =  0, distributing HY into block cyclic form took 14.644 ms
rank =  0, finding Y'*HY took 4.686 ms
Rank 0, Project_Hamiltonian used 60.092 ms
Total time for projection: 60.114 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.894611409561866
    last  calculated eigval = 0.030209452461545
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89461140956187
lambda[   2] =  -0.87710402255621
lambda[   3] =  -0.68488284720030
lambda[   4] =  -0.40652772722858
lambda[   5] =  -0.40652744169540
lambda[   6] =  -0.37325588689691
lambda[   7] =  -0.36084074069541
lambda[   8] =  -0.33431472159726
lambda[   9] =  -0.33431205995848
lambda[  10] =  -0.12645127916463
lambda[  11] =  -0.12644901449645
lambda[  12] =  -0.02751871304569
lambda[  13] =   0.02096043984384
lambda[  14] =   0.02970282952194
lambda[  15] =   0.03020945246154
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 4.164 ms
rank =  0, Distributing orbital back into band + domain format took 15.296 ms
rank = 0, Subspace_Rotation used 19.483 ms

Total time for subspace rotation: 19.490 ms
rank = 0, Efermi =  -0.157452865042 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.956 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.464 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.260 ms
rank = 0, Calculating density took 1455.554 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.828 ms
rank = 0, D2D took 0.947 ms
rank = 0, Transfering density took 0.952 ms
Etot    =   -32.708948818278
Eband   =    -9.344753715398
E1      =    20.646102105789
E2      =    -8.883284279650
E3      =   -11.064601875254
Exc     =   -10.120296989674
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 9.029e-06, dEband = 1.359e-02
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -32.708948818, dEtot = 9.029e-06, dEband = 1.359e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2522113946609, which took 0.106 ms

iter_count = 108, r_2norm = 8.145e-06, tol*||rhs|| = 1.009e-05

Anderson update took 63.753 ms, out of which F'*F took 29.964 ms; b-Ax took 205.406 ms, out of which Lap took 181.417 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.272 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488238, int_b + int_rho = -1.106e-12, checking this took 0.116 ms
2-norm of RHS = 501.8798725491732, which took 0.196 ms

iter_count = 210, r_2norm = 4.903e-04, tol*||rhs|| = 5.019e-04

Anderson update took 125.049 ms, out of which F'*F took 58.311 ms; b-Ax took 397.656 ms, out of which Lap took 353.212 ms
Solving Poisson took 890.091 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
Total time for convolution: 	 convolve: 5.082883 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.633 ms
Total time for convolution: 	 convolve: 5.082808 
Total time for convolution: 	 convolve: 5.239179 
Total time for convolution: 	 convolve: 5.181217 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 129.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.651 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.655 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.372 ms

This SCF took 27986.901 ms, scf error = 1.322e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130209, lowerbound = -0.894611, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1408.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.781 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 18.526 ms
rank =  0, finding HY took 22.063 ms
rank =  0, distributing HY into block cyclic form took 14.748 ms
rank =  0, finding Y'*HY took 4.674 ms
Rank 0, Project_Hamiltonian used 60.052 ms
Total time for projection: 60.072 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.893565555286995
    last  calculated eigval = 0.028280745843211
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89356555528699
lambda[   2] =  -0.87602818850394
lambda[   3] =  -0.68394558177663
lambda[   4] =  -0.40561178286660
lambda[   5] =  -0.40561147627448
lambda[   6] =  -0.37220698038786
lambda[   7] =  -0.35978905387801
lambda[   8] =  -0.33333193937447
lambda[   9] =  -0.33333102727442
lambda[  10] =  -0.12553005918424
lambda[  11] =  -0.12552932689484
lambda[  12] =  -0.02716863781286
lambda[  13] =   0.02098270474188
lambda[  14] =   0.02730248859185
lambda[  15] =   0.02828074584321
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 4.861 ms
rank =  0, Distributing orbital back into band + domain format took 14.527 ms
rank = 0, Subspace_Rotation used 19.412 ms

Total time for subspace rotation: 19.423 ms
rank = 0, Efermi =  -0.156532410697 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.088 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.154 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.302 ms
rank = 0, Calculating density took 1496.294 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.719 ms
rank = 0, D2D took 0.840 ms
rank = 0, Transfering density took 0.846 ms
Etot    =   -32.709090875367
Eband   =    -9.326843171860
E1      =    20.636699980520
E2      =    -8.874101476354
E3      =   -11.066785149106
Exc     =   -10.121947935588
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 3.551e-05, dEband = 4.478e-03
rank = 0, Calculating/Estimating energy took 1.041 ms, Etot = -32.709090875, dEtot = 3.551e-05, dEband = 4.478e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1885689874183, which took 0.067 ms

iter_count = 102, r_2norm = 7.022e-06, tol*||rhs|| = 7.543e-06

Anderson update took 60.140 ms, out of which F'*F took 28.406 ms; b-Ax took 193.760 ms, out of which Lap took 171.360 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.291 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488243, int_b + int_rho = -1.055e-12, checking this took 0.132 ms
2-norm of RHS = 501.9324545038700, which took 0.149 ms

iter_count = 216, r_2norm = 4.377e-04, tol*||rhs|| = 5.019e-04

Anderson update took 128.585 ms, out of which F'*F took 60.272 ms; b-Ax took 407.442 ms, out of which Lap took 361.286 ms
Solving Poisson took 915.304 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.090040 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.308 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
Total time for convolution: 	 convolve: 5.085611 
Total time for convolution: 	 convolve: 5.081492 
Total time for convolution: 	 convolve: 5.084561 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 0.969 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.399 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.394 ms

This SCF took 27205.963 ms, scf error = 8.712e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128281, lowerbound = -0.893566, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1400.496 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.999 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 24.823 ms
rank =  0, finding HY took 22.109 ms
rank =  0, distributing HY into block cyclic form took 14.644 ms
rank =  0, finding Y'*HY took 4.793 ms
Rank 0, Project_Hamiltonian used 66.409 ms
Total time for projection: 66.434 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.892708813573381
    last  calculated eigval = 0.028536707159341
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89270881357338
lambda[   2] =  -0.87519262722479
lambda[   3] =  -0.68296167326578
lambda[   4] =  -0.40473612418957
lambda[   5] =  -0.40473594792229
lambda[   6] =  -0.37144326017423
lambda[   7] =  -0.35902897730021
lambda[   8] =  -0.33251100488672
lambda[   9] =  -0.33250972927641
lambda[  10] =  -0.12469488703028
lambda[  11] =  -0.12469414225026
lambda[  12] =  -0.02460594171265
lambda[  13] =   0.02201065601223
lambda[  14] =   0.02806796814642
lambda[  15] =   0.02853670715934
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.557 ms
rank =  0, subspace rotation using ScaLAPACK took 4.839 ms
rank =  0, Distributing orbital back into band + domain format took 14.252 ms
rank = 0, Subspace_Rotation used 19.115 ms

Total time for subspace rotation: 19.124 ms
rank = 0, Efermi =  -0.155697232388 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 3.966 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.570 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1494.548 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.942 ms
rank = 0, D2D took 1.071 ms
rank = 0, Transfering density took 1.077 ms
Etot    =   -32.709149736730
Eband   =    -9.311656316236
E1      =    20.630151929227
E2      =    -8.865165096759
E3      =   -11.067842961203
Exc     =   -10.122767033784
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 1.472e-05, dEband = 3.797e-03
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -32.709149737, dEtot = 1.472e-05, dEband = 3.797e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0724536135948, which took 0.093 ms

iter_count = 114, r_2norm = 2.084e-06, tol*||rhs|| = 2.898e-06

Anderson update took 66.940 ms, out of which F'*F took 31.518 ms; b-Ax took 216.986 ms, out of which Lap took 191.765 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.156 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488243, int_b + int_rho = -1.055e-12, checking this took 0.140 ms
2-norm of RHS = 501.9242486704046, which took 0.165 ms

iter_count = 192, r_2norm = 4.413e-04, tol*||rhs|| = 5.019e-04

Anderson update took 114.496 ms, out of which F'*F took 53.347 ms; b-Ax took 362.640 ms, out of which Lap took 321.703 ms
Solving Poisson took 813.999 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.091344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.392 ms
Total time for convolution: 	 convolve: 5.077369 
Total time for convolution: 	 convolve: 5.078667 
Total time for convolution: 	 convolve: 5.073899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.383 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.374 ms

This SCF took 27180.836 ms, scf error = 5.944e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128537, lowerbound = -0.892709, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1410.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.906 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.527 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.465 ms
rank =  0, finding HY took 22.123 ms
rank =  0, distributing HY into block cyclic form took 14.778 ms
rank =  0, finding Y'*HY took 4.684 ms
Rank 0, Project_Hamiltonian used 60.537 ms
Total time for projection: 60.555 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.586 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.672 ms
    first calculated eigval = -0.891880946071174
    last  calculated eigval = 0.029320600411264
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89188094607117
lambda[   2] =  -0.87435562213098
lambda[   3] =  -0.68214158667511
lambda[   4] =  -0.40398178256299
lambda[   5] =  -0.40398165621883
lambda[   6] =  -0.37067987119731
lambda[   7] =  -0.35826237857661
lambda[   8] =  -0.33175133212699
lambda[   9] =  -0.33175088240581
lambda[  10] =  -0.12396967337020
lambda[  11] =  -0.12396940136427
lambda[  12] =  -0.02325974457132
lambda[  13] =   0.02190521332264
lambda[  14] =   0.02809801627790
lambda[  15] =   0.02932060041126
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.688 ms
rank =  0, subspace rotation using ScaLAPACK took 4.329 ms
rank =  0, Distributing orbital back into band + domain format took 14.682 ms
rank = 0, Subspace_Rotation used 19.029 ms

Total time for subspace rotation: 19.036 ms
rank = 0, Efermi =  -0.154972254886 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.019 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.543 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.211 ms
rank = 0, Calculating density took 1498.280 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.823 ms
rank = 0, D2D took 1.062 ms
rank = 0, Transfering density took 1.065 ms
Etot    =   -32.709221941380
Eband   =    -9.297572116537
E1      =    20.622042416213
E2      =    -8.858682819675
E3      =   -11.069848847869
Exc     =   -10.124337534701
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 1.805e-05, dEband = 3.521e-03
rank = 0, Calculating/Estimating energy took 1.122 ms, Etot = -32.709221941, dEtot = 1.805e-05, dEband = 3.521e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0801602993041, which took 0.092 ms

iter_count = 108, r_2norm = 2.363e-06, tol*||rhs|| = 3.206e-06

Anderson update took 63.586 ms, out of which F'*F took 30.165 ms; b-Ax took 205.413 ms, out of which Lap took 181.722 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.443 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488241, int_b + int_rho = -1.073e-12, checking this took 0.138 ms
2-norm of RHS = 501.9455116651794, which took 0.253 ms

iter_count = 192, r_2norm = 4.888e-04, tol*||rhs|| = 5.019e-04

Anderson update took 114.415 ms, out of which F'*F took 53.493 ms; b-Ax took 362.994 ms, out of which Lap took 322.314 ms
Solving Poisson took 814.330 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.083519 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.690 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.952 ms
Total time for convolution: 	 convolve: 5.074790 
Total time for convolution: 	 convolve: 5.070804 
Total time for convolution: 	 convolve: 5.075032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.508 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.488 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.410 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.383 ms

This SCF took 27096.055 ms, scf error = 4.276e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129321, lowerbound = -0.891881, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1376.812 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.915 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.616 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.455 ms
rank =  0, finding HY took 22.270 ms
rank =  0, distributing HY into block cyclic form took 14.603 ms
rank =  0, finding Y'*HY took 4.798 ms
Rank 0, Project_Hamiltonian used 60.168 ms
Total time for projection: 60.188 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.891467816380872
    last  calculated eigval = 0.032692573924776
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89146781638087
lambda[   2] =  -0.87395850465534
lambda[   3] =  -0.68165659399489
lambda[   4] =  -0.40352209518490
lambda[   5] =  -0.40352204129332
lambda[   6] =  -0.37029075669732
lambda[   7] =  -0.35788123994776
lambda[   8] =  -0.33131721783664
lambda[   9] =  -0.33131717448912
lambda[  10] =  -0.12352620824207
lambda[  11] =  -0.12352604183734
lambda[  12] =  -0.02008327110069
lambda[  13] =   0.02325793419533
lambda[  14] =   0.02998114291584
lambda[  15] =   0.03269257392478
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 4.211 ms
rank =  0, Distributing orbital back into band + domain format took 14.818 ms
rank = 0, Subspace_Rotation used 19.052 ms

Total time for subspace rotation: 19.058 ms
rank = 0, Efermi =  -0.154528842710 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.055 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.384 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.208 ms
rank = 0, Calculating density took 1464.039 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.804 ms
rank = 0, D2D took 1.067 ms
rank = 0, Transfering density took 1.078 ms
Etot    =   -32.709240842722
Eband   =    -9.289866881563
E1      =    20.618922502586
E2      =    -8.853993209613
E3      =   -11.070182885034
Exc     =   -10.124586184492
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 4.725e-06, dEband = 1.926e-03
rank = 0, Calculating/Estimating energy took 1.195 ms, Etot = -32.709240843, dEtot = 4.725e-06, dEband = 1.926e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0736823481019, which took 0.077 ms

iter_count = 108, r_2norm = 1.998e-06, tol*||rhs|| = 2.947e-06

Anderson update took 63.654 ms, out of which F'*F took 29.882 ms; b-Ax took 204.807 ms, out of which Lap took 181.245 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.034 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488242, int_b + int_rho = -1.066e-12, checking this took 0.124 ms
2-norm of RHS = 501.9486019040868, which took 0.208 ms

iter_count = 174, r_2norm = 4.955e-04, tol*||rhs|| = 5.019e-04

Anderson update took 103.575 ms, out of which F'*F took 48.361 ms; b-Ax took 328.752 ms, out of which Lap took 291.571 ms
Solving Poisson took 737.942 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.657 ms
Total time for convolution: 	 convolve: 5.085837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.635 ms
Total time for convolution: 	 convolve: 5.081995 
Total time for convolution: 	 convolve: 5.082942 
Total time for convolution: 	 convolve: 5.089634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.657 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.668 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.380 ms

This SCF took 27083.537 ms, scf error = 3.149e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132693, lowerbound = -0.891468, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1397.798 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.099 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.608 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.739 ms
rank =  0, finding HY took 22.205 ms
rank =  0, distributing HY into block cyclic form took 14.686 ms
rank =  0, finding Y'*HY took 4.700 ms
Rank 0, Project_Hamiltonian used 60.371 ms
Total time for projection: 60.391 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -0.891172858901406
    last  calculated eigval = 0.034852604481994
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89117285890141
lambda[   2] =  -0.87366420162801
lambda[   3] =  -0.68137682959212
lambda[   4] =  -0.40323162136730
lambda[   5] =  -0.40323160768868
lambda[   6] =  -0.37001422373093
lambda[   7] =  -0.35760831861649
lambda[   8] =  -0.33102600926374
lambda[   9] =  -0.33102567629898
lambda[  10] =  -0.12325947660358
lambda[  11] =  -0.12325917944361
lambda[  12] =  -0.01901050377198
lambda[  13] =   0.02392712959567
lambda[  14] =   0.03010759185209
lambda[  15] =   0.03485260448199
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 4.244 ms
rank =  0, Distributing orbital back into band + domain format took 14.773 ms
rank = 0, Subspace_Rotation used 19.042 ms

Total time for subspace rotation: 19.048 ms
rank = 0, Efermi =  -0.154262045727 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.081 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.479 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.252 ms
rank = 0, Calculating density took 1485.370 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 1.057 ms
rank = 0, Transfering density took 1.060 ms
Etot    =   -32.709295789977
Eband   =    -9.284702694777
E1      =    20.616648645623
E2      =    -8.851025525319
E3      =   -11.070325322613
Exc     =   -10.124706214856
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 1.374e-05, dEband = 1.291e-03
rank = 0, Calculating/Estimating energy took 1.166 ms, Etot = -32.709295790, dEtot = 1.374e-05, dEband = 1.291e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0832976583955, which took 0.082 ms

iter_count = 102, r_2norm = 2.339e-06, tol*||rhs|| = 3.332e-06

Anderson update took 60.075 ms, out of which F'*F took 28.428 ms; b-Ax took 193.990 ms, out of which Lap took 171.630 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488237, int_b + int_rho = -1.110e-12, checking this took 0.123 ms
2-norm of RHS = 501.9492055590421, which took 0.250 ms

iter_count = 168, r_2norm = 4.255e-04, tol*||rhs|| = 5.019e-04

Anderson update took 99.861 ms, out of which F'*F took 46.625 ms; b-Ax took 317.059 ms, out of which Lap took 281.234 ms
Solving Poisson took 713.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.083115 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.274 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.848 ms
Total time for convolution: 	 convolve: 5.077475 
Total time for convolution: 	 convolve: 5.079371 
Total time for convolution: 	 convolve: 5.071924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.963 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.314 ms

This SCF took 27034.764 ms, scf error = 2.629e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134853, lowerbound = -0.891173, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1409.107 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.941 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.711 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 18.702 ms
rank =  0, finding HY took 22.077 ms
rank =  0, distributing HY into block cyclic form took 14.740 ms
rank =  0, finding Y'*HY took 4.716 ms
Rank 0, Project_Hamiltonian used 60.273 ms
Total time for projection: 60.357 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.890997251749143
    last  calculated eigval = 0.037791567750952
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89099725174914
lambda[   2] =  -0.87348734912821
lambda[   3] =  -0.68122375430710
lambda[   4] =  -0.40305917656637
lambda[   5] =  -0.40305911744873
lambda[   6] =  -0.36983413133561
lambda[   7] =  -0.35743029052144
lambda[   8] =  -0.33085108548391
lambda[   9] =  -0.33085049063097
lambda[  10] =  -0.12309540067599
lambda[  11] =  -0.12309496566116
lambda[  12] =  -0.01738990606600
lambda[  13] =   0.02483339023353
lambda[  14] =   0.03065174582710
lambda[  15] =   0.03779156775095
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.247 ms
rank =  0, Distributing orbital back into band + domain format took 14.688 ms
rank = 0, Subspace_Rotation used 18.954 ms

Total time for subspace rotation: 18.960 ms
rank = 0, Efermi =  -0.154097900310 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 4.050 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.469 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1496.454 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.712 ms
rank = 0, D2D took 1.033 ms
rank = 0, Transfering density took 1.037 ms
Etot    =   -32.709327978348
Eband   =    -9.281585294944
E1      =    20.615361722329
E2      =    -8.849186413946
E3      =   -11.070294924845
Exc     =   -10.124699370624
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 8.047e-06, dEband = 7.793e-04
rank = 0, Calculating/Estimating energy took 1.263 ms, Etot = -32.709327978, dEtot = 8.047e-06, dEband = 7.793e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0840122977358, which took 0.134 ms

iter_count = 102, r_2norm = 2.215e-06, tol*||rhs|| = 3.360e-06

Anderson update took 60.074 ms, out of which F'*F took 28.584 ms; b-Ax took 193.807 ms, out of which Lap took 171.548 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.196 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488246, int_b + int_rho = -1.026e-12, checking this took 0.089 ms
2-norm of RHS = 501.9488406518228, which took 0.197 ms

iter_count = 96, r_2norm = 4.824e-04, tol*||rhs|| = 5.019e-04

Anderson update took 56.924 ms, out of which F'*F took 29.312 ms; b-Ax took 183.456 ms, out of which Lap took 163.275 ms
Solving Poisson took 409.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.086114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.634 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
Total time for convolution: 	 convolve: 5.081151 
Total time for convolution: 	 convolve: 5.086653 
Total time for convolution: 	 convolve: 5.080032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.929 ms
---Transfer Veff_loc: D2D took 1.466 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.536 ms

This SCF took 26744.063 ms, scf error = 2.635e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137792, lowerbound = -0.890997, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.785 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 30.274 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.902 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 34.250 ms
rank =  0, finding HY took 22.057 ms
rank =  0, distributing HY into block cyclic form took 14.706 ms
rank =  0, finding Y'*HY took 4.730 ms
Rank 0, Project_Hamiltonian used 75.781 ms
Total time for projection: 75.797 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.891042431799555
    last  calculated eigval = 0.036981918705771
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89104243179955
lambda[   2] =  -0.87353369294065
lambda[   3] =  -0.68126678928810
lambda[   4] =  -0.40309885296834
lambda[   5] =  -0.40309877984252
lambda[   6] =  -0.36988223710266
lambda[   7] =  -0.35747891295538
lambda[   8] =  -0.33089284001662
lambda[   9] =  -0.33089224247587
lambda[  10] =  -0.12313608252848
lambda[  11] =  -0.12313565721211
lambda[  12] =  -0.01778756784102
lambda[  13] =   0.02463554336428
lambda[  14] =   0.03003592844955
lambda[  15] =   0.03698191870577
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 4.260 ms
rank =  0, Distributing orbital back into band + domain format took 14.802 ms
rank = 0, Subspace_Rotation used 19.079 ms

Total time for subspace rotation: 19.085 ms
rank = 0, Efermi =  -0.154138587064 calculate fermi energy took 0.107 ms
rank = 0, --- Calculate rho: sum over local bands took 4.009 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.542 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.239 ms
rank = 0, Calculating density took 1484.808 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.777 ms
rank = 0, D2D took 1.051 ms
rank = 0, Transfering density took 1.055 ms
Etot    =   -32.709327767524
Eband   =    -9.282373559381
E1      =    20.615806981359
E2      =    -8.849558390259
E3      =   -11.070164103102
Exc     =   -10.124597308965
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 5.271e-08, dEband = 1.971e-04
rank = 0, Calculating/Estimating energy took 1.135 ms, Etot = -32.709327768, dEtot = 5.271e-08, dEband = 1.971e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0730188265053, which took 0.083 ms

iter_count = 102, r_2norm = 2.233e-06, tol*||rhs|| = 2.921e-06

Anderson update took 59.988 ms, out of which F'*F took 28.223 ms; b-Ax took 193.639 ms, out of which Lap took 170.650 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.139 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488239, int_b + int_rho = -1.091e-12, checking this took 0.134 ms
2-norm of RHS = 501.9559340488503, which took 0.223 ms

iter_count = 138, r_2norm = 4.595e-04, tol*||rhs|| = 5.020e-04

Anderson update took 81.759 ms, out of which F'*F took 38.585 ms; b-Ax took 262.642 ms, out of which Lap took 233.330 ms
Solving Poisson took 586.344 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.080492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.748 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.392 ms
Total time for convolution: 	 convolve: 5.079245 
Total time for convolution: 	 convolve: 5.077467 
Total time for convolution: 	 convolve: 5.079179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.388 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.357 ms

This SCF took 28321.581 ms, scf error = 2.744e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136982, lowerbound = -0.891042, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.346 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 18.436 ms
rank =  0, finding HY took 22.155 ms
rank =  0, distributing HY into block cyclic form took 14.595 ms
rank =  0, finding Y'*HY took 4.745 ms
Rank 0, Project_Hamiltonian used 59.965 ms
Total time for projection: 59.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.890969819904402
    last  calculated eigval = 0.036057669469948
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89096981990440
lambda[   2] =  -0.87346054967399
lambda[   3] =  -0.68118694370683
lambda[   4] =  -0.40302985158802
lambda[   5] =  -0.40302981166941
lambda[   6] =  -0.36978408186415
lambda[   7] =  -0.35738079115554
lambda[   8] =  -0.33081839318350
lambda[   9] =  -0.33081786840631
lambda[  10] =  -0.12306235874454
lambda[  11] =  -0.12306192283242
lambda[  12] =  -0.01857700124683
lambda[  13] =   0.02437581915331
lambda[  14] =   0.02921534287603
lambda[  15] =   0.03605766946995
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.279 ms
rank =  0, Distributing orbital back into band + domain format took 14.717 ms
rank = 0, Subspace_Rotation used 19.019 ms

Total time for subspace rotation: 19.024 ms
rank = 0, Efermi =  -0.154064858260 calculate fermi energy took 0.105 ms
rank = 0, --- Calculate rho: sum over local bands took 4.054 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.495 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1468.481 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.805 ms
rank = 0, D2D took 1.086 ms
rank = 0, Transfering density took 1.090 ms
Etot    =   -32.709339134533
Eband   =    -9.280956222905
E1      =    20.615180239339
E2      =    -8.848694789895
E3      =   -11.070377382814
Exc     =   -10.124748949777
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.842e-06, dEband = 3.543e-04
rank = 0, Calculating/Estimating energy took 2.024 ms, Etot = -32.709339135, dEtot = 2.842e-06, dEband = 3.543e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0704305065827, which took 0.086 ms

iter_count = 102, r_2norm = 2.222e-06, tol*||rhs|| = 2.817e-06

Anderson update took 59.866 ms, out of which F'*F took 28.348 ms; b-Ax took 193.784 ms, out of which Lap took 171.660 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.385 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488240, int_b + int_rho = -1.084e-12, checking this took 0.112 ms
2-norm of RHS = 501.9549625378694, which took 0.245 ms

iter_count = 54, r_2norm = 4.811e-04, tol*||rhs|| = 5.020e-04

Anderson update took 31.951 ms, out of which F'*F took 15.103 ms; b-Ax took 101.924 ms, out of which Lap took 90.541 ms
Solving Poisson took 231.175 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.087458 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.597 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.621 ms
Total time for convolution: 	 convolve: 5.077567 
Total time for convolution: 	 convolve: 5.081043 
Total time for convolution: 	 convolve: 5.073118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.677 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.940 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.472 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.396 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.364 ms

This SCF took 26576.414 ms, scf error = 2.728e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136058, lowerbound = -0.890970, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1385.931 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.710 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.593 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.333 ms
rank =  0, finding HY took 22.270 ms
rank =  0, distributing HY into block cyclic form took 14.729 ms
rank =  0, finding Y'*HY took 4.644 ms
Rank 0, Project_Hamiltonian used 60.014 ms
Total time for projection: 60.034 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.890965307942393
    last  calculated eigval = 0.036031835252775
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89096530794239
lambda[   2] =  -0.87345560801908
lambda[   3] =  -0.68118481985577
lambda[   4] =  -0.40302636954664
lambda[   5] =  -0.40302633459640
lambda[   6] =  -0.36978157867454
lambda[   7] =  -0.35737816479585
lambda[   8] =  -0.33081449884702
lambda[   9] =  -0.33081400269298
lambda[  10] =  -0.12305819508081
lambda[  11] =  -0.12305778588798
lambda[  12] =  -0.01834272581324
lambda[  13] =   0.02445374352908
lambda[  14] =   0.02912119507550
lambda[  15] =   0.03603183525277
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.274 ms
rank =  0, Distributing orbital back into band + domain format took 14.724 ms
rank = 0, Subspace_Rotation used 19.018 ms

Total time for subspace rotation: 19.023 ms
rank = 0, Efermi =  -0.154060707862 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 3.989 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.288 ms
rank = 0, Calculating density took 1473.151 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 2.288 ms
rank = 0, D2D took 2.397 ms
rank = 0, Transfering density took 2.401 ms
Etot    =   -32.709331085516
Eband   =    -9.280893370542
E1      =    20.615122817002
E2      =    -8.848695841437
E3      =   -11.070398743870
Exc     =   -10.124768743383
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.012e-06, dEband = 1.571e-05
rank = 0, Calculating/Estimating energy took 1.118 ms, Etot = -32.709331086, dEtot = 2.012e-06, dEband = 1.571e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0529723433415, which took 0.091 ms

iter_count = 108, r_2norm = 1.398e-06, tol*||rhs|| = 2.119e-06

Anderson update took 63.382 ms, out of which F'*F took 29.902 ms; b-Ax took 204.868 ms, out of which Lap took 181.226 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.683 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488238, int_b + int_rho = -1.099e-12, checking this took 0.123 ms
2-norm of RHS = 501.9573644524360, which took 0.173 ms

iter_count = 138, r_2norm = 4.949e-04, tol*||rhs|| = 5.020e-04

Anderson update took 81.651 ms, out of which F'*F took 38.753 ms; b-Ax took 260.538 ms, out of which Lap took 231.714 ms
Solving Poisson took 585.041 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.093166 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.756 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.840 ms
Total time for convolution: 	 convolve: 5.098608 
Total time for convolution: 	 convolve: 5.153761 
Total time for convolution: 	 convolve: 5.101942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.477 ms
---Transfer Veff_loc: D2D took 0.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.397 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.371 ms

This SCF took 26993.677 ms, scf error = 2.645e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136032, lowerbound = -0.890965, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1407.367 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.754 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.580 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.369 ms
rank =  0, finding HY took 22.232 ms
rank =  0, distributing HY into block cyclic form took 14.674 ms
rank =  0, finding Y'*HY took 4.615 ms
Rank 0, Project_Hamiltonian used 59.927 ms
Total time for projection: 59.948 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.890942041790771
    last  calculated eigval = 0.037986584536408
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89094204179077
lambda[   2] =  -0.87343399894548
lambda[   3] =  -0.68115492228803
lambda[   4] =  -0.40299237293219
lambda[   5] =  -0.40299231872067
lambda[   6] =  -0.36974374134405
lambda[   7] =  -0.35734120286464
lambda[   8] =  -0.33078301078247
lambda[   9] =  -0.33078269562828
lambda[  10] =  -0.12301775293945
lambda[  11] =  -0.12301748403310
lambda[  12] =  -0.01638284897593
lambda[  13] =   0.02529377261480
lambda[  14] =   0.03010895882858
lambda[  15] =   0.03798658453641
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.242 ms
rank =  0, Distributing orbital back into band + domain format took 14.751 ms
rank = 0, Subspace_Rotation used 19.015 ms

Total time for subspace rotation: 19.021 ms
rank = 0, Efermi =  -0.154020336047 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 3.956 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.687 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.213 ms
rank = 0, Calculating density took 1494.438 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.931 ms
rank = 0, D2D took 1.103 ms
rank = 0, Transfering density took 1.112 ms
Etot    =   -32.709320820699
Eband   =    -9.280332611194
E1      =    20.615033242551
E2      =    -8.848257599869
E3      =   -11.070326976278
Exc     =   -10.124719654304
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.566e-06, dEband = 1.402e-04
rank = 0, Calculating/Estimating energy took 1.049 ms, Etot = -32.709320821, dEtot = 2.566e-06, dEband = 1.402e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0677633895335, which took 0.074 ms

iter_count = 102, r_2norm = 2.088e-06, tol*||rhs|| = 2.711e-06

Anderson update took 59.988 ms, out of which F'*F took 28.239 ms; b-Ax took 193.749 ms, out of which Lap took 171.709 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488242, int_b + int_rho = -1.059e-12, checking this took 0.125 ms
2-norm of RHS = 501.9557559021883, which took 0.129 ms

iter_count = 150, r_2norm = 5.017e-04, tol*||rhs|| = 5.020e-04

Anderson update took 88.811 ms, out of which F'*F took 41.898 ms; b-Ax took 282.638 ms, out of which Lap took 251.185 ms
Solving Poisson took 635.458 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.122216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.442 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
Total time for convolution: 	 convolve: 5.095060 
Total time for convolution: 	 convolve: 5.114820 
Total time for convolution: 	 convolve: 5.081100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.509 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.366 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.375 ms

This SCF took 26992.921 ms, scf error = 3.063e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137987, lowerbound = -0.890942, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1411.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.555 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.574 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.167 ms
rank =  0, finding HY took 22.130 ms
rank =  0, distributing HY into block cyclic form took 14.677 ms
rank =  0, finding Y'*HY took 4.615 ms
Rank 0, Project_Hamiltonian used 59.644 ms
Total time for projection: 59.670 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.890893874770387
    last  calculated eigval = 0.036097634281228
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89089387477039
lambda[   2] =  -0.87338379231746
lambda[   3] =  -0.68111400707746
lambda[   4] =  -0.40296085606625
lambda[   5] =  -0.40296080744373
lambda[   6] =  -0.36972404172223
lambda[   7] =  -0.35732017942140
lambda[   8] =  -0.33074960668649
lambda[   9] =  -0.33074923963579
lambda[  10] =  -0.12299645612787
lambda[  11] =  -0.12299610654847
lambda[  12] =  -0.01802649153805
lambda[  13] =   0.02465172264992
lambda[  14] =   0.02869241953926
lambda[  15] =   0.03609763428123
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.048 ms
rank =  0, Distributing orbital back into band + domain format took 14.381 ms
rank = 0, Subspace_Rotation used 18.465 ms

Total time for subspace rotation: 18.472 ms
rank = 0, Efermi =  -0.153998998720 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 3.840 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.218 ms
rank = 0, Calculating density took 1497.900 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.696 ms
rank = 0, D2D took 0.845 ms
rank = 0, Transfering density took 0.853 ms
Etot    =   -32.709344812353
Eband   =    -9.279712810883
E1      =    20.614472810493
E2      =    -8.848132536148
E3      =   -11.070484468880
Exc     =   -10.124835443091
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 5.998e-06, dEband = 1.550e-04
rank = 0, Calculating/Estimating energy took 1.589 ms, Etot = -32.709344812, dEtot = 5.998e-06, dEband = 1.550e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0645206110609, which took 0.067 ms

iter_count = 102, r_2norm = 1.608e-06, tol*||rhs|| = 2.581e-06

Anderson update took 60.154 ms, out of which F'*F took 28.558 ms; b-Ax took 193.911 ms, out of which Lap took 171.672 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.789 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488238, int_b + int_rho = -1.106e-12, checking this took 0.123 ms
2-norm of RHS = 501.9644234280355, which took 0.231 ms

iter_count = 162, r_2norm = 4.751e-04, tol*||rhs|| = 5.020e-04

Anderson update took 96.247 ms, out of which F'*F took 45.035 ms; b-Ax took 306.509 ms, out of which Lap took 272.247 ms
Solving Poisson took 686.764 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.023 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.086718 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.774 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.428 ms
Total time for convolution: 	 convolve: 5.083940 
Total time for convolution: 	 convolve: 5.081367 
Total time for convolution: 	 convolve: 5.114846 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.353 ms

This SCF took 27065.731 ms, scf error = 2.394e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136098, lowerbound = -0.890894, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1374.440 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.723 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.632 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.387 ms
rank =  0, finding HY took 21.999 ms
rank =  0, distributing HY into block cyclic form took 14.742 ms
rank =  0, finding Y'*HY took 4.638 ms
Rank 0, Project_Hamiltonian used 59.804 ms
Total time for projection: 59.821 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.890829721213505
    last  calculated eigval = 0.036711190569200
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89082972121351
lambda[   2] =  -0.87332616028938
lambda[   3] =  -0.68102043906652
lambda[   4] =  -0.40288172731686
lambda[   5] =  -0.40288154479207
lambda[   6] =  -0.36969298855848
lambda[   7] =  -0.35729043941010
lambda[   8] =  -0.33068457692310
lambda[   9] =  -0.33068453659575
lambda[  10] =  -0.12292818923945
lambda[  11] =  -0.12292800027692
lambda[  12] =  -0.01745252038134
lambda[  13] =   0.02514878039641
lambda[  14] =   0.02883054883420
lambda[  15] =   0.03671119056920
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 5.172 ms
rank =  0, Distributing orbital back into band + domain format took 14.163 ms
rank = 0, Subspace_Rotation used 19.357 ms

Total time for subspace rotation: 19.373 ms
rank = 0, Efermi =  -0.153930812295 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.973 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.560 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.156 ms
rank = 0, Calculating density took 1462.120 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.043 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
rank = 0, D2D took 0.701 ms
rank = 0, Transfering density took 0.706 ms
Etot    =   -32.709353373669
Eband   =    -9.278584268932
E1      =    20.614094418969
E2      =    -8.847383228485
E3      =   -11.070421746238
Exc     =   -10.124782124529
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.140e-06, dEband = 2.821e-04
rank = 0, Calculating/Estimating energy took 1.041 ms, Etot = -32.709353374, dEtot = 2.140e-06, dEband = 2.821e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0644407471060, which took 0.082 ms

iter_count = 102, r_2norm = 1.962e-06, tol*||rhs|| = 2.578e-06

Anderson update took 59.947 ms, out of which F'*F took 28.280 ms; b-Ax took 193.968 ms, out of which Lap took 171.600 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.670 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488238, int_b + int_rho = -1.102e-12, checking this took 0.108 ms
2-norm of RHS = 501.9529258188872, which took 0.140 ms

iter_count = 114, r_2norm = 4.628e-04, tol*||rhs|| = 5.020e-04

Anderson update took 67.425 ms, out of which F'*F took 31.765 ms; b-Ax took 215.186 ms, out of which Lap took 191.078 ms
Solving Poisson took 483.879 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.091114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 181.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
Total time for convolution: 	 convolve: 5.077713 
Total time for convolution: 	 convolve: 5.080228 
Total time for convolution: 	 convolve: 5.075133 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.009 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.513 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.391 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.360 ms

This SCF took 26892.904 ms, scf error = 2.508e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136711, lowerbound = -0.890830, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1420.308 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.735 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.628 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.397 ms
rank =  0, finding HY took 22.131 ms
rank =  0, distributing HY into block cyclic form took 14.788 ms
rank =  0, finding Y'*HY took 4.529 ms
Rank 0, Project_Hamiltonian used 59.889 ms
Total time for projection: 59.906 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.890693388379473
    last  calculated eigval = 0.034562202333156
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89069338837947
lambda[   2] =  -0.87318205929354
lambda[   3] =  -0.68090388542898
lambda[   4] =  -0.40278616865394
lambda[   5] =  -0.40278603443164
lambda[   6] =  -0.36958361521663
lambda[   7] =  -0.35717642904079
lambda[   8] =  -0.33058044984469
lambda[   9] =  -0.33058042901043
lambda[  10] =  -0.12283496714066
lambda[  11] =  -0.12283482740472
lambda[  12] =  -0.01886369237480
lambda[  13] =   0.02435992860432
lambda[  14] =   0.02784676605840
lambda[  15] =   0.03456220233316
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.854 ms
rank =  0, Distributing orbital back into band + domain format took 14.700 ms
rank = 0, Subspace_Rotation used 18.587 ms

Total time for subspace rotation: 18.594 ms
rank = 0, Efermi =  -0.153837614716 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 3.931 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.203 ms
rank = 0, Calculating density took 1506.934 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.659 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.809 ms
Etot    =   -32.709357223201
Eband   =    -9.276544919200
E1      =    20.612355829723
E2      =    -8.846949289235
E3      =   -11.071013854642
Exc     =   -10.125244903702
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 9.624e-07, dEband = 5.098e-04
rank = 0, Calculating/Estimating energy took 1.669 ms, Etot = -32.709357223, dEtot = 9.624e-07, dEband = 5.098e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0557152574509, which took 0.113 ms

iter_count = 96, r_2norm = 2.184e-06, tol*||rhs|| = 2.229e-06

Anderson update took 56.465 ms, out of which F'*F took 26.603 ms; b-Ax took 182.445 ms, out of which Lap took 161.599 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 411.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488242, int_b + int_rho = -1.062e-12, checking this took 0.125 ms
2-norm of RHS = 501.9503438849285, which took 0.220 ms

iter_count = 120, r_2norm = 4.755e-04, tol*||rhs|| = 5.020e-04

Anderson update took 71.090 ms, out of which F'*F took 33.288 ms; b-Ax took 226.424 ms, out of which Lap took 201.416 ms
Solving Poisson took 508.709 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.608 ms
Total time for convolution: 	 convolve: 5.083220 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.724 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.856 ms
Total time for convolution: 	 convolve: 5.078985 
Total time for convolution: 	 convolve: 5.080787 
Total time for convolution: 	 convolve: 5.128804 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.458 ms
---Transfer Veff_loc: D2D took 0.927 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.387 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.337 ms

This SCF took 26827.765 ms, scf error = 1.371e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.134562, lowerbound = -0.890693, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1418.457 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.912 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.513 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 18.483 ms
rank =  0, finding HY took 22.201 ms
rank =  0, distributing HY into block cyclic form took 14.663 ms
rank =  0, finding Y'*HY took 4.573 ms
Rank 0, Project_Hamiltonian used 59.959 ms
Total time for projection: 60.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.112 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.890570111199344
    last  calculated eigval = 0.033828092835209
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89057011119934
lambda[   2] =  -0.87305798635215
lambda[   3] =  -0.68077587875089
lambda[   4] =  -0.40267558077454
lambda[   5] =  -0.40267551756604
lambda[   6] =  -0.36948446446814
lambda[   7] =  -0.35707591445191
lambda[   8] =  -0.33047077816867
lambda[   9] =  -0.33047048718881
lambda[  10] =  -0.12272747549123
lambda[  11] =  -0.12272738953052
lambda[  12] =  -0.01915402207824
lambda[  13] =   0.02426063430063
lambda[  14] =   0.02765728458277
lambda[  15] =   0.03382809283521
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.953 ms
rank =  0, Distributing orbital back into band + domain format took 14.932 ms
rank = 0, Subspace_Rotation used 18.914 ms

Total time for subspace rotation: 18.923 ms
rank = 0, Efermi =  -0.153730150152 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 3.879 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.646 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1505.807 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.736 ms
rank = 0, D2D took 1.048 ms
rank = 0, Transfering density took 1.058 ms
Etot    =   -32.709361296912
Eband   =    -9.274513438440
E1      =    20.611075339701
E2      =    -8.846118865912
E3      =   -11.071356158269
Exc     =   -10.125511848454
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 1.018e-06, dEband = 5.079e-04
rank = 0, Calculating/Estimating energy took 1.146 ms, Etot = -32.709361297, dEtot = 1.018e-06, dEband = 5.079e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0407856805675, which took 0.104 ms

iter_count = 96, r_2norm = 1.583e-06, tol*||rhs|| = 1.631e-06

Anderson update took 56.243 ms, out of which F'*F took 26.558 ms; b-Ax took 182.375 ms, out of which Lap took 161.448 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.462 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488240, int_b + int_rho = -1.084e-12, checking this took 0.149 ms
2-norm of RHS = 501.9505579316231, which took 0.293 ms

iter_count = 132, r_2norm = 4.226e-04, tol*||rhs|| = 5.020e-04

Anderson update took 78.013 ms, out of which F'*F took 36.742 ms; b-Ax took 249.033 ms, out of which Lap took 221.292 ms
Solving Poisson took 559.364 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.098809 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 70.687 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.066 ms
Total time for convolution: 	 convolve: 5.082643 
Total time for convolution: 	 convolve: 5.086208 
Total time for convolution: 	 convolve: 5.078151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.398 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.372 ms

This SCF took 26967.119 ms, scf error = 1.006e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.133828, lowerbound = -0.890570, upperbound = 267.585095

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1404.455 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.497 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.312 ms
rank =  0, finding HY took 22.350 ms
rank =  0, distributing HY into block cyclic form took 14.712 ms
rank =  0, finding Y'*HY took 4.523 ms
Rank 0, Project_Hamiltonian used 59.937 ms
Total time for projection: 59.963 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.890450958581541
    last  calculated eigval = 0.033483455654458
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89045095858154
lambda[   2] =  -0.87293965779688
lambda[   3] =  -0.68065535941606
lambda[   4] =  -0.40256070147051
lambda[   5] =  -0.40256068326673
lambda[   6] =  -0.36938959225683
lambda[   7] =  -0.35698138457435
lambda[   8] =  -0.33035898722692
lambda[   9] =  -0.33035875260597
lambda[  10] =  -0.12262002057433
lambda[  11] =  -0.12261991102285
lambda[  12] =  -0.01926604917612
lambda[  13] =   0.02436808118764
lambda[  14] =   0.02753765744893
lambda[  15] =   0.03348345565446
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.222 ms
rank =  0, Distributing orbital back into band + domain format took 14.446 ms
rank = 0, Subspace_Rotation used 18.694 ms

Total time for subspace rotation: 18.700 ms
rank = 0, Efermi =  -0.153622683134 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 3.931 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.731 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.217 ms
rank = 0, Calculating density took 1491.323 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.857 ms
rank = 0, D2D took 1.069 ms
rank = 0, Transfering density took 1.077 ms
Etot    =   -32.709371171825
Eband   =    -9.272512154990
E1      =    20.610033257531
E2      =    -8.845102107926
E3      =   -11.071543952774
Exc     =   -10.125651961166
Esc     =   -53.837886373744
Entropy =    -0.000000000155
dE = 2.469e-06, dEband = 5.003e-04
rank = 0, Calculating/Estimating energy took 1.089 ms, Etot = -32.709371172, dEtot = 2.469e-06, dEband = 5.003e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0307416552362, which took 0.080 ms

iter_count = 102, r_2norm = 7.123e-07, tol*||rhs|| = 1.230e-06

Anderson update took 59.751 ms, out of which F'*F took 28.566 ms; b-Ax took 194.217 ms, out of which Lap took 171.856 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.235 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000000488348, int_rho =  18.00000000488241, int_b + int_rho = -1.070e-12, checking this took 0.151 ms
2-norm of RHS = 501.9498619975594, which took 0.221 ms

iter_count = 138, r_2norm = 4.851e-04, tol*||rhs|| = 5.019e-04

Anderson update took 83.204 ms, out of which F'*F took 38.323 ms; b-Ax took 260.325 ms, out of which Lap took 231.228 ms
Solving Poisson took 585.913 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.274 ms
Total time for convolution: 	 convolve: 5.084385 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.286 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
Total time for convolution: 	 convolve: 5.081016 
Total time for convolution: 	 convolve: 5.078787 
Total time for convolution: 	 convolve: 5.078544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.364 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.349 ms

This SCF took 26873.315 ms, scf error = 7.686e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.89045095858154, occ[   1] =   2.00000000000000
lambda[   2] =  -0.87293965779688, occ[   2] =   2.00000000000000
lambda[   3] =  -0.68065535941606, occ[   3] =   2.00000000000000
lambda[   4] =  -0.40256070147051, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40256068326673, occ[   5] =   2.00000000000000
lambda[   6] =  -0.36938959225683, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35698138457435, occ[   7] =   2.00000000000000
lambda[   8] =  -0.33035898722692, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33035875260597, occ[   9] =   2.00000000000000
lambda[  10] =  -0.12262002057433, occ[  10] =   0.00000000244136
lambda[  11] =  -0.12261991102285, occ[  11] =   0.00000000244105
lambda[  12] =  -0.01926604917612, occ[  12] =   0.00000000000000
lambda[  13] =   0.02436808118764, occ[  13] =   0.00000000000000
lambda[  14] =   0.02753765744893, occ[  14] =   0.00000000000000
lambda[  15] =   0.03348345565446, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.665 ms, time for Allreduce/Reduce: 5.741 ms 
Time for calculating local force components: 16.014 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000006518186   0.00000065226000  -0.12752310799096
  0.00000046793915  -0.00000016679043   0.12750976580573
  0.00000355002742   0.00000534681505  -0.98507912652045
 -0.00000387381294  -0.00000567175435   0.98508934580033
force_loc = 
 -0.00000195307539   0.00000218822693   0.09087820773510
  0.00000091675004   0.00000246059767  -0.09087511800650
  0.00000871729313   0.00001645930978   0.97236160138173
 -0.00001221628877  -0.00001189895446  -0.97237577125803
Time for calculating nonlocal force components: 31.968 ms
[32mforces_xc: 
[0m[32m -0.00000014133122   0.00000011245170   0.02046749695055
[0m[32m  0.00000009204291   0.00000021297881  -0.02046801487626
[0m[32m  0.00000037948687   0.00000075535874   0.01607320870993
[0m[32m -0.00000056358731  -0.00000051910118  -0.01607302763547
[0mTime for calculating XC forces components: 18.368 ms
 Cartesian force = 
 -0.00000088938119   0.00000047008907  -0.01617376832924
  0.00000261657566   0.00000002393648   0.01617026789904
  0.00001378665098   0.00002007863400   0.00335931854729
 -0.00001551384545  -0.00002057265955  -0.00335581811709
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 389.333 ms
The program took 633.363 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:55
Job ID:        2266618
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:10:00,vmem=8388K,walltime=00:10:50,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-33-2
---------------------------------------
