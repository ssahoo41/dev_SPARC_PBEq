---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:16
Job ID:    2266817
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:22
Job ID:    2266817
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.054 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 42.427 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 9.877 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 525.997 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.000 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.132 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   13.257811	    7.901855	   10.000000	
   12.980999	    6.102919	   10.000000	
    6.742189	   11.355365	   10.000000	
    8.189020	   13.897081	   11.664157	
    8.189020	   13.897081	    8.335843	
   12.555920	   12.311504	   10.000000	
    8.331579	   12.670726	   10.000000	
   10.777754	   11.260581	   10.000000	
   10.787497	    8.855725	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 1.176 ms
Set up communicators.

--set up spincomm took 1.278 ms

--set up kptcomm took 0.335 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.007 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.059 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.396 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.380 ms

Calculate_SplineDerivRadFun took 0.303 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.800 ms.
time spent on vectorized spline interp: 3.320 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.715 ms.
time spent on vectorized spline interp: 1.611 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.312 ms.
time spent on vectorized spline interp: 1.844 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.416 ms.
time spent on vectorized spline interp: 1.690 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.576 ms.

Calculating rb for all atom types took 21.294 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.820 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.016 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000250629, sum_int_rho = 23.4987582856428
PosCharge = 24.000000025063, NegCharge = -23.498758285643, scal_fac = 1.021330562804
After scaling, int_rho = 24.0000000250629, PosCharge + NegCharge - NetCharge = -3.197e-14
--Calculate Vref took 0.418 ms
--Calculate rho_guess took 2.095 ms

 integral of b = -24.0000000250629,
 int{b} + Nelectron + NetCharge = -2.506e-08,
 Esc = -68.5549771988696,
 MPI_Reduce took 11.346 ms

Calculating b & b_ref took 19.507 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.069 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.149 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.078 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.577 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.297 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506286, int_b + int_rho = 9.095e-14, checking this took 0.576 ms
2-norm of RHS = 729.0649046274394, which took 0.463 ms

iter_count = 420, r_2norm = 6.081e-04, tol*||rhs|| = 7.291e-04

Anderson update took 256.002 ms, out of which F'*F took 117.420 ms; b-Ax took 790.941 ms, out of which Lap took 705.549 ms
Solving Poisson took 1750.276 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.466 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.154920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
Total time for convolution: 	 convolve: 5.130929 
Total time for convolution: 	 convolve: 5.128688 
Total time for convolution: 	 convolve: 5.155891 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.735 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.403 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
rank = 0, XC calculation took 24453.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.305 ms
---Transfer Veff_loc: D2D took 5.893 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.220 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 17.251 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.180 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.819 ms
    Lanczos iter 53, eigmin  = -0.994377584, eigmax = 264.928053106, err_eigmin = 1.913e-03, err_eigmax = 9.536e-03
rank =   0, Lanczos took 143.436 ms, eigmin = -0.994377584245, eigmax = 267.577333637022

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.241478, lowerbound = -1.094378, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1591.354 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.698 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.847 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 24.563 ms
rank =  0, finding HY took 25.791 ms
rank =  0, distributing HY into block cyclic form took 23.030 ms
rank =  0, finding Y'*HY took 4.101 ms
Rank 0, Project_Hamiltonian used 77.513 ms
Total time for projection: 77.522 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.768 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.866 ms
    first calculated eigval = 2.748733509967504
    last  calculated eigval = 3.240200679850525
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.80353731485077
lambda[   4] =   2.81516238092030
lambda[   5] =   2.87351686054949
lambda[   6] =   2.91191427197578
lambda[   7] =   2.93024104494275
lambda[   8] =   2.95775087379291
lambda[   9] =   2.98636683934788
lambda[  10] =   3.01102432447983
lambda[  11] =   3.02760398161216
lambda[  12] =   3.04357955427178
lambda[  13] =   3.08945434525727
lambda[  14] =   3.12923193774693
lambda[  15] =   3.14514797240600
lambda[  16] =   3.15915094704525
lambda[  17] =   3.17379335287242
lambda[  18] =   3.21982378787257
lambda[  19] =   3.24020067985053
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.880 ms
rank =  0, subspace rotation using ScaLAPACK took 8.381 ms
rank =  0, Distributing orbital back into band + domain format took 19.276 ms
rank = 0, Subspace_Rotation used 27.668 ms

Total time for subspace rotation: 27.671 ms
rank = 0, Efermi =   3.066518335143 calculate fermi energy took 0.046 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.340201, lowerbound = -1.094378, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1570.765 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 42.667 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.767 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 45.459 ms
rank =  0, finding HY took 25.107 ms
rank =  0, distributing HY into block cyclic form took 19.768 ms
rank =  0, finding Y'*HY took 3.760 ms
Rank 0, Project_Hamiltonian used 94.117 ms
Total time for projection: 94.121 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 1.078 ms
    first calculated eigval = -0.775079358051140
    last  calculated eigval = 0.416165295111989
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.45873186335582
lambda[   4] =  -0.28850793762157
lambda[   5] =  -0.19533007827490
lambda[   6] =  -0.15300407631107
lambda[   7] =  -0.04720797374850
lambda[   8] =   0.03766249364833
lambda[   9] =   0.06466483487134
lambda[  10] =   0.14854688263908
lambda[  11] =   0.23380156894718
lambda[  12] =   0.25570639339553
lambda[  13] =   0.31926557641991
lambda[  14] =   0.34380282329243
lambda[  15] =   0.35116113636138
lambda[  16] =   0.37631196760930
lambda[  17] =   0.38952269892634
lambda[  18] =   0.40231092503579
lambda[  19] =   0.41616529511199
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 1.087 ms
rank =  0, subspace rotation using ScaLAPACK took 8.331 ms
rank =  0, Distributing orbital back into band + domain format took 19.084 ms
rank = 0, Subspace_Rotation used 27.425 ms

Total time for subspace rotation: 27.429 ms
rank = 0, Efermi =   0.290303794439 calculate fermi energy took 0.020 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.516165, lowerbound = -1.094378, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1569.784 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 40.170 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.737 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 42.923 ms
rank =  0, finding HY took 25.101 ms
rank =  0, distributing HY into block cyclic form took 19.849 ms
rank =  0, finding Y'*HY took 3.791 ms
Rank 0, Project_Hamiltonian used 91.688 ms
Total time for projection: 91.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -1.019641224478206
    last  calculated eigval = 0.135936988564434
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.78206428090681
lambda[   4] =  -0.59996293727171
lambda[   5] =  -0.54909595910167
lambda[   6] =  -0.50231253628666
lambda[   7] =  -0.47607325373600
lambda[   8] =  -0.46486636387914
lambda[   9] =  -0.41819874016635
lambda[  10] =  -0.36924827323360
lambda[  11] =  -0.28154031057063
lambda[  12] =  -0.22793603114519
lambda[  13] =  -0.00686716142898
lambda[  14] =   0.04840275661430
lambda[  15] =   0.06973346308342
lambda[  16] =   0.09392574479676
lambda[  17] =   0.10065275880754
lambda[  18] =   0.12332814889436
lambda[  19] =   0.13593698856443
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 8.313 ms
rank =  0, Distributing orbital back into band + domain format took 19.032 ms
rank = 0, Subspace_Rotation used 27.356 ms

Total time for subspace rotation: 27.360 ms
rank = 0, Efermi =  -0.035829952163 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.235937, lowerbound = -1.094378, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1576.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 32.942 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.775 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 35.732 ms
rank =  0, finding HY took 25.363 ms
rank =  0, distributing HY into block cyclic form took 19.813 ms
rank =  0, finding Y'*HY took 3.776 ms
Rank 0, Project_Hamiltonian used 85.158 ms
Total time for projection: 85.174 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -1.020067326517098
    last  calculated eigval = 0.078311576427862
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.78349455287599
lambda[   4] =  -0.60246756687181
lambda[   5] =  -0.55218891556738
lambda[   6] =  -0.50777716150740
lambda[   7] =  -0.48465442877518
lambda[   8] =  -0.47174604804510
lambda[   9] =  -0.43180798219653
lambda[  10] =  -0.39428127049120
lambda[  11] =  -0.29810099818019
lambda[  12] =  -0.27393768300991
lambda[  13] =  -0.07448187619058
lambda[  14] =   0.00655488663468
lambda[  15] =   0.01173457483621
lambda[  16] =   0.04591114539622
lambda[  17] =   0.04982849532180
lambda[  18] =   0.05532926250020
lambda[  19] =   0.07831157642786
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 8.368 ms
rank =  0, Distributing orbital back into band + domain format took 19.112 ms
rank = 0, Subspace_Rotation used 27.491 ms

Total time for subspace rotation: 27.494 ms
rank = 0, Efermi =  -0.103444666936 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 6.438 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.658 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.548 ms
rank = 0, Calculating density took 6934.301 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.890 ms
rank = 0, D2D took 1.995 ms
rank = 0, Transfering density took 2.000 ms
Etot    =   -41.989000922915
Eband   =   -13.392554551990
E1      =    27.328018643147
E2      =   -11.072494226532
E3      =   -14.333414260434
Exc     =   -12.775396301420
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 4.665e+00, dEband = 1.488e+00
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -41.989000923, dEtot = 4.665e+00, dEband = 1.488e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.7471678331958, which took 0.717 ms

iter_count = 96, r_2norm = 1.730e-03, tol*||rhs|| = 2.550e-03

Anderson update took 57.438 ms, out of which F'*F took 26.914 ms; b-Ax took 180.419 ms, out of which Lap took 161.064 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506290, int_b + int_rho = 1.273e-13, checking this took 0.147 ms
2-norm of RHS = 725.6703700912226, which took 0.240 ms

iter_count = 288, r_2norm = 5.886e-04, tol*||rhs|| = 7.257e-04

Anderson update took 172.634 ms, out of which F'*F took 80.564 ms; b-Ax took 539.110 ms, out of which Lap took 484.344 ms
Solving Poisson took 1190.603 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.252 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.277 ms
Total time for convolution: 	 convolve: 5.223856 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 85.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.234617 
Total time for convolution: 	 convolve: 5.229070 
Total time for convolution: 	 convolve: 5.197970 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.155 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.039 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.584 ms

This SCF took 33707.989 ms, scf error = 1.674e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.178312, lowerbound = -1.020067, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1296.493 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.720 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.671 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.408 ms
rank =  0, finding HY took 25.570 ms
rank =  0, distributing HY into block cyclic form took 22.066 ms
rank =  0, finding Y'*HY took 3.609 ms
Rank 0, Project_Hamiltonian used 73.681 ms
Total time for projection: 73.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.014628664409313
    last  calculated eigval = 0.052782291473581
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74660601335202
lambda[   4] =  -0.57450583345605
lambda[   5] =  -0.53217474922471
lambda[   6] =  -0.47069682795219
lambda[   7] =  -0.45746180568780
lambda[   8] =  -0.44312940696228
lambda[   9] =  -0.41053058625402
lambda[  10] =  -0.38402108933232
lambda[  11] =  -0.28333907001283
lambda[  12] =  -0.25882337098312
lambda[  13] =  -0.07656143466301
lambda[  14] =  -0.02089810550035
lambda[  15] =  -0.00341329648237
lambda[  16] =   0.02239288199415
lambda[  17] =   0.02850213940679
lambda[  18] =   0.03937711616041
lambda[  19] =   0.05278229147358
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.951 ms
rank =  0, Distributing orbital back into band + domain format took 19.303 ms
rank = 0, Subspace_Rotation used 27.266 ms

Total time for subspace rotation: 27.269 ms
rank = 0, Efermi =  -0.105524225363 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.488 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.455 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.631 ms
rank = 0, Calculating density took 1416.768 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.943 ms
rank = 0, D2D took 2.049 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -41.933337558556
Eband   =   -12.852728249691
E1      =    26.849790807666
E2      =   -11.038151850747
E3      =   -14.483664862188
Exc     =   -12.897239629847
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 6.185e-03, dEband = 5.998e-02
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -41.933337559, dEtot = 6.185e-03, dEband = 5.998e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.6846395361951, which took 0.070 ms

iter_count = 102, r_2norm = 5.873e-04, tol*||rhs|| = 7.074e-04

Anderson update took 60.363 ms, out of which F'*F took 28.294 ms; b-Ax took 191.830 ms, out of which Lap took 170.888 ms
rank = 0, Mixing (+ precond) took 431.789 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506281, int_b + int_rho = 4.366e-14, checking this took 0.127 ms
2-norm of RHS = 720.8350514722450, which took 0.179 ms

iter_count = 300, r_2norm = 7.014e-04, tol*||rhs|| = 7.208e-04

Anderson update took 178.092 ms, out of which F'*F took 82.646 ms; b-Ax took 556.297 ms, out of which Lap took 496.307 ms
Solving Poisson took 1234.753 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.202466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.378 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.261421 
Total time for convolution: 	 convolve: 5.216861 
Total time for convolution: 	 convolve: 5.244336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.054 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.950 ms

This SCF took 28002.920 ms, scf error = 1.138e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.152782, lowerbound = -1.014629, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1600.711 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.809 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.830 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.652 ms
rank =  0, finding HY took 26.699 ms
rank =  0, distributing HY into block cyclic form took 20.015 ms
rank =  0, finding Y'*HY took 3.963 ms
Rank 0, Project_Hamiltonian used 73.354 ms
Total time for projection: 73.363 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.006342958105402
    last  calculated eigval = 0.046915103832785
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.68024137778044
lambda[   4] =  -0.52822225801974
lambda[   5] =  -0.49873493836523
lambda[   6] =  -0.42027121605803
lambda[   7] =  -0.40888849799270
lambda[   8] =  -0.38275569745603
lambda[   9] =  -0.36148989927159
lambda[  10] =  -0.36081362705716
lambda[  11] =  -0.25095913021951
lambda[  12] =  -0.23155860640239
lambda[  13] =  -0.05026549936600
lambda[  14] =  -0.02909998589893
lambda[  15] =  -0.00821304544487
lambda[  16] =   0.01790632480787
lambda[  17] =   0.02290531336479
lambda[  18] =   0.03243287355411
lambda[  19] =   0.04691510383278
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.952 ms
rank =  0, Distributing orbital back into band + domain format took 19.463 ms
rank = 0, Subspace_Rotation used 27.426 ms

Total time for subspace rotation: 27.430 ms
rank = 0, Efermi =  -0.079228290011 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 6.544 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.382 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.725 ms
rank = 0, Calculating density took 1720.475 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.893 ms
rank = 0, D2D took 1.988 ms
rank = 0, Transfering density took 1.992 ms
Etot    =   -41.887171187878
Eband   =   -11.874156101846
E1      =    26.015461235853
E2      =   -10.878664747056
E3      =   -14.801010900792
Exc     =   -13.153174770114
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 5.130e-03, dEband = 1.087e-01
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -41.887171188, dEtot = 5.130e-03, dEband = 1.087e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 10.2008936090488, which took 0.557 ms

iter_count = 102, r_2norm = 2.495e-04, tol*||rhs|| = 4.080e-04

Anderson update took 60.138 ms, out of which F'*F took 28.100 ms; b-Ax took 192.095 ms, out of which Lap took 170.767 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 429.897 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506290, int_b + int_rho = 1.346e-13, checking this took 0.121 ms
2-norm of RHS = 720.7997780605176, which took 0.069 ms

iter_count = 270, r_2norm = 6.236e-04, tol*||rhs|| = 7.208e-04

Anderson update took 162.358 ms, out of which F'*F took 76.829 ms; b-Ax took 510.176 ms, out of which Lap took 456.638 ms
Solving Poisson took 1112.968 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.246652 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.199286 
Total time for convolution: 	 convolve: 5.184877 
Total time for convolution: 	 convolve: 5.205658 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.665 ms
---Transfer Veff_loc: D2D took 3.917 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.117 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.392 ms

This SCF took 28107.679 ms, scf error = 3.621e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146915, lowerbound = -1.006343, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.949 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.812 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.792 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.622 ms
rank =  0, finding HY took 25.299 ms
rank =  0, distributing HY into block cyclic form took 19.664 ms
rank =  0, finding Y'*HY took 3.773 ms
Rank 0, Project_Hamiltonian used 71.381 ms
Total time for projection: 71.390 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.999211326122883
    last  calculated eigval = 0.043591654272605
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67225574583498
lambda[   4] =  -0.52067679891295
lambda[   5] =  -0.49128131415371
lambda[   6] =  -0.41263311945130
lambda[   7] =  -0.40035464729208
lambda[   8] =  -0.37450456643384
lambda[   9] =  -0.35363719347696
lambda[  10] =  -0.35234704369624
lambda[  11] =  -0.24045839159519
lambda[  12] =  -0.22537784163287
lambda[  13] =  -0.04394106184998
lambda[  14] =  -0.03126727039662
lambda[  15] =  -0.00885720273080
lambda[  16] =   0.01595039574086
lambda[  17] =   0.01912086792047
lambda[  18] =   0.02550731018400
lambda[  19] =   0.04359165427260
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.999 ms
rank =  0, Distributing orbital back into band + domain format took 19.361 ms
rank = 0, Subspace_Rotation used 27.373 ms

Total time for subspace rotation: 27.378 ms
rank = 0, Efermi =  -0.072903852623 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 6.558 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.961 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.110 ms
rank = 0, Calculating density took 1724.689 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.114 ms
rank = 0, D2D took 2.219 ms
rank = 0, Transfering density took 2.222 ms
Etot    =   -41.883389177117
Eband   =   -11.683100279576
E1      =    25.895803662022
E2      =   -10.794747810598
E3      =   -14.868340537455
Exc     =   -13.204203707997
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 4.202e-04, dEband = 2.123e-02
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -41.883389177, dEtot = 4.202e-04, dEband = 2.123e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.6506370106536, which took 0.074 ms

iter_count = 108, r_2norm = 9.655e-05, tol*||rhs|| = 1.460e-04

Anderson update took 65.345 ms, out of which F'*F took 30.323 ms; b-Ax took 204.506 ms, out of which Lap took 182.983 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.452 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506286, int_b + int_rho = 9.095e-14, checking this took 0.166 ms
2-norm of RHS = 721.0770200300669, which took 0.188 ms

iter_count = 252, r_2norm = 6.780e-04, tol*||rhs|| = 7.211e-04

Anderson update took 148.912 ms, out of which F'*F took 70.429 ms; b-Ax took 475.251 ms, out of which Lap took 425.411 ms
Solving Poisson took 1041.654 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.199026 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.468 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.178627 
Total time for convolution: 	 convolve: 5.194021 
Total time for convolution: 	 convolve: 5.184566 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.718 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.874 ms

This SCF took 27997.768 ms, scf error = 1.525e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.143592, lowerbound = -0.999211, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.060 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.845 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.780 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.641 ms
rank =  0, finding HY took 25.408 ms
rank =  0, distributing HY into block cyclic form took 19.831 ms
rank =  0, finding Y'*HY took 4.001 ms
Rank 0, Project_Hamiltonian used 71.904 ms
Total time for projection: 71.914 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.996624554216116
    last  calculated eigval = 0.041834239674632
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66719624360723
lambda[   4] =  -0.51655484682718
lambda[   5] =  -0.48769841448493
lambda[   6] =  -0.40935979934298
lambda[   7] =  -0.39532102296558
lambda[   8] =  -0.36944321158025
lambda[   9] =  -0.34883182231115
lambda[  10] =  -0.34840814397036
lambda[  11] =  -0.23744924328242
lambda[  12] =  -0.22236082049317
lambda[  13] =  -0.04113157854514
lambda[  14] =  -0.03169680824783
lambda[  15] =  -0.00892503088514
lambda[  16] =   0.01484596393865
lambda[  17] =   0.01721933269005
lambda[  18] =   0.02156445713822
lambda[  19] =   0.04183423967463
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 7.891 ms
rank =  0, Distributing orbital back into band + domain format took 19.447 ms
rank = 0, Subspace_Rotation used 27.349 ms

Total time for subspace rotation: 27.353 ms
rank = 0, Efermi =  -0.070094374691 calculate fermi energy took 0.632 ms
rank = 0, --- Calculate rho: sum over local bands took 6.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.336 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1721.684 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.909 ms
rank = 0, D2D took 2.006 ms
rank = 0, Transfering density took 2.008 ms
Etot    =   -41.882335132167
Eband   =   -11.589334471583
E1      =    25.846756603227
E2      =   -10.743265443811
E3      =   -14.897916077854
Exc     =   -13.225961585859
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 1.171e-04, dEband = 1.042e-02
rank = 0, Calculating/Estimating energy took 1.125 ms, Etot = -41.882335132, dEtot = 1.171e-04, dEband = 1.042e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1203216015492, which took 0.072 ms

iter_count = 114, r_2norm = 2.831e-05, tol*||rhs|| = 4.481e-05

Anderson update took 78.946 ms, out of which F'*F took 31.360 ms; b-Ax took 212.651 ms, out of which Lap took 189.444 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.637 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506289, int_b + int_rho = 1.201e-13, checking this took 0.147 ms
2-norm of RHS = 721.4863323040003, which took 0.179 ms

iter_count = 246, r_2norm = 7.053e-04, tol*||rhs|| = 7.215e-04

Anderson update took 147.521 ms, out of which F'*F took 69.144 ms; b-Ax took 461.171 ms, out of which Lap took 411.683 ms
Solving Poisson took 1023.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.185292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.962 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.196170 
Total time for convolution: 	 convolve: 5.196113 
Total time for convolution: 	 convolve: 5.184196 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.470 ms

This SCF took 28028.819 ms, scf error = 7.716e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.141834, lowerbound = -0.996625, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1596.176 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.845 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.731 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.593 ms
rank =  0, finding HY took 25.322 ms
rank =  0, distributing HY into block cyclic form took 19.711 ms
rank =  0, finding Y'*HY took 3.756 ms
Rank 0, Project_Hamiltonian used 71.413 ms
Total time for projection: 71.423 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.994825578701155
    last  calculated eigval = 0.041204819938386
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66282510199471
lambda[   4] =  -0.51344956434687
lambda[   5] =  -0.48519346245510
lambda[   6] =  -0.40708408638765
lambda[   7] =  -0.39124253159072
lambda[   8] =  -0.36520980934607
lambda[   9] =  -0.34622455214698
lambda[  10] =  -0.34414070853106
lambda[  11] =  -0.23588710014369
lambda[  12] =  -0.22014934332689
lambda[  13] =  -0.03899525222121
lambda[  14] =  -0.03140585489632
lambda[  15] =  -0.00855648264544
lambda[  16] =   0.01457120045145
lambda[  17] =   0.01679899890288
lambda[  18] =   0.02016690654882
lambda[  19] =   0.04120481993839
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 7.910 ms
rank =  0, Distributing orbital back into band + domain format took 19.392 ms
rank = 0, Subspace_Rotation used 27.313 ms

Total time for subspace rotation: 27.317 ms
rank = 0, Efermi =  -0.067958115741 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 6.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.395 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1713.775 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.508 ms
rank = 0, D2D took 2.602 ms
rank = 0, Transfering density took 2.610 ms
Etot    =   -41.881831792558
Eband   =   -11.518714241659
E1      =    25.818220244024
E2      =   -10.696911026554
E3      =   -14.913241735144
Exc     =   -13.236513357004
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 5.593e-05, dEband = 7.847e-03
rank = 0, Calculating/Estimating energy took 1.155 ms, Etot = -41.881831793, dEtot = 5.593e-05, dEband = 7.847e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4404827760324, which took 0.070 ms

iter_count = 114, r_2norm = 1.166e-05, tol*||rhs|| = 1.762e-05

Anderson update took 67.822 ms, out of which F'*F took 31.807 ms; b-Ax took 214.430 ms, out of which Lap took 191.166 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 480.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506279, int_b + int_rho = 1.455e-14, checking this took 0.118 ms
2-norm of RHS = 721.7793263307674, which took 0.129 ms

iter_count = 246, r_2norm = 6.508e-04, tol*||rhs|| = 7.218e-04

Anderson update took 146.933 ms, out of which F'*F took 69.604 ms; b-Ax took 466.617 ms, out of which Lap took 416.634 ms
Solving Poisson took 1028.911 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.193555 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.959 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.197088 
Total time for convolution: 	 convolve: 5.184585 
Total time for convolution: 	 convolve: 5.196640 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.037 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.271 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.821 ms

This SCF took 28021.655 ms, scf error = 3.789e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.141205, lowerbound = -0.994826, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.169 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.853 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.799 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.671 ms
rank =  0, finding HY took 25.316 ms
rank =  0, distributing HY into block cyclic form took 19.804 ms
rank =  0, finding Y'*HY took 3.743 ms
Rank 0, Project_Hamiltonian used 71.573 ms
Total time for projection: 71.583 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.992382240090789
    last  calculated eigval = 0.042526922390145
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65753425982599
lambda[   4] =  -0.50989269855139
lambda[   5] =  -0.48219862112242
lambda[   6] =  -0.40409233089017
lambda[   7] =  -0.38654362890504
lambda[   8] =  -0.36030287536069
lambda[   9] =  -0.34274884533590
lambda[  10] =  -0.33944927163575
lambda[  11] =  -0.23285489667452
lambda[  12] =  -0.21732912629602
lambda[  13] =  -0.03587044352975
lambda[  14] =  -0.03019802245932
lambda[  15] =  -0.00719277510826
lambda[  16] =   0.01638864565155
lambda[  17] =   0.01816110621743
lambda[  18] =   0.02066185907673
lambda[  19] =   0.04252692239015
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.935 ms
rank =  0, Distributing orbital back into band + domain format took 19.662 ms
rank = 0, Subspace_Rotation used 28.357 ms

Total time for subspace rotation: 28.361 ms
rank = 0, Efermi =  -0.064834193887 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.689 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.379 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1722.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.925 ms
rank = 0, D2D took 2.029 ms
rank = 0, Transfering density took 2.035 ms
Etot    =   -41.881532064359
Eband   =   -11.430234570502
E1      =    25.776748173304
E2      =   -10.646136852467
E3      =   -14.926541751659
Exc     =   -13.245747071668
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 3.330e-05, dEband = 9.831e-03
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -41.881532064, dEtot = 3.330e-05, dEband = 9.831e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2489086775415, which took 0.106 ms

iter_count = 114, r_2norm = 6.554e-06, tol*||rhs|| = 9.956e-06

Anderson update took 68.220 ms, out of which F'*F took 31.396 ms; b-Ax took 212.833 ms, out of which Lap took 189.300 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.373 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506286, int_b + int_rho = 9.459e-14, checking this took 0.141 ms
2-norm of RHS = 721.8150975828814, which took 0.167 ms

iter_count = 234, r_2norm = 6.030e-04, tol*||rhs|| = 7.218e-04

Anderson update took 139.760 ms, out of which F'*F took 66.221 ms; b-Ax took 443.239 ms, out of which Lap took 395.583 ms
Solving Poisson took 979.080 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.187222 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.189460 
Total time for convolution: 	 convolve: 5.196616 
Total time for convolution: 	 convolve: 5.178860 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.753 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.896 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.433 ms

This SCF took 27950.590 ms, scf error = 1.791e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.142527, lowerbound = -0.992382, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1608.083 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.761 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.873 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.650 ms
rank =  0, finding HY took 25.274 ms
rank =  0, distributing HY into block cyclic form took 19.779 ms
rank =  0, finding Y'*HY took 3.732 ms
Rank 0, Project_Hamiltonian used 71.462 ms
Total time for projection: 71.472 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.990624096491683
    last  calculated eigval = 0.044754836837744
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65483825384489
lambda[   4] =  -0.50770582279605
lambda[   5] =  -0.48012734047766
lambda[   6] =  -0.40206079224910
lambda[   7] =  -0.38395992851580
lambda[   8] =  -0.35769421828039
lambda[   9] =  -0.34056125143208
lambda[  10] =  -0.33685472241361
lambda[  11] =  -0.23057404282040
lambda[  12] =  -0.21525843520345
lambda[  13] =  -0.03356173445683
lambda[  14] =  -0.02841514333336
lambda[  15] =  -0.00480156642163
lambda[  16] =   0.01982156419767
lambda[  17] =   0.02100923035716
lambda[  18] =   0.02231403119158
lambda[  19] =   0.04475483683774
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 7.900 ms
rank =  0, Distributing orbital back into band + domain format took 19.882 ms
rank = 0, Subspace_Rotation used 27.795 ms

Total time for subspace rotation: 27.800 ms
rank = 0, Efermi =  -0.062526425530 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 6.638 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.248 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1726.496 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.926 ms
rank = 0, D2D took 2.030 ms
rank = 0, Transfering density took 2.035 ms
Etot    =   -41.881417560167
Eband   =   -11.375423917266
E1      =    25.749617407386
E2      =   -10.616936904371
E3      =   -14.932361014167
Exc     =   -13.249931769207
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 1.272e-05, dEband = 6.090e-03
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -41.881417560, dEtot = 1.272e-05, dEband = 6.090e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1929116420799, which took 0.073 ms

iter_count = 108, r_2norm = 7.533e-06, tol*||rhs|| = 7.716e-06

Anderson update took 67.401 ms, out of which F'*F took 30.477 ms; b-Ax took 200.715 ms, out of which Lap took 181.366 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.372 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506284, int_b + int_rho = 7.276e-14, checking this took 0.117 ms
2-norm of RHS = 721.8003334668909, which took 0.152 ms

iter_count = 204, r_2norm = 7.073e-04, tol*||rhs|| = 7.218e-04

Anderson update took 121.883 ms, out of which F'*F took 58.115 ms; b-Ax took 388.776 ms, out of which Lap took 347.174 ms
Solving Poisson took 854.877 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.235183 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.303 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.182993 
Total time for convolution: 	 convolve: 5.184796 
Total time for convolution: 	 convolve: 5.188162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.730 ms
---Transfer Veff_loc: D2D took 3.549 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.091 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.674 ms

This SCF took 27872.927 ms, scf error = 1.003e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.144755, lowerbound = -0.990624, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.699 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.763 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.695 ms
rank =  0, finding HY took 25.429 ms
rank =  0, distributing HY into block cyclic form took 19.961 ms
rank =  0, finding Y'*HY took 3.755 ms
Rank 0, Project_Hamiltonian used 71.867 ms
Total time for projection: 71.877 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.990102557165651
    last  calculated eigval = 0.044574575255420
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65369761366107
lambda[   4] =  -0.50681898332511
lambda[   5] =  -0.47931295850595
lambda[   6] =  -0.40134133114136
lambda[   7] =  -0.38286312517599
lambda[   8] =  -0.35659098082200
lambda[   9] =  -0.33973828415064
lambda[  10] =  -0.33568280281884
lambda[  11] =  -0.22979083227034
lambda[  12] =  -0.21450890773525
lambda[  13] =  -0.03263074677212
lambda[  14] =  -0.02703292393182
lambda[  15] =  -0.00319087477791
lambda[  16] =   0.02162311820788
lambda[  17] =   0.02310168866209
lambda[  18] =   0.02357071655855
lambda[  19] =   0.04457457525542
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.992 ms
rank =  0, Distributing orbital back into band + domain format took 19.445 ms
rank = 0, Subspace_Rotation used 27.447 ms

Total time for subspace rotation: 27.454 ms
rank = 0, Efermi =  -0.061594595544 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.407 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.479 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1724.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.898 ms
rank = 0, D2D took 1.993 ms
rank = 0, Transfering density took 1.995 ms
Etot    =   -41.881425655171
Eband   =   -11.354145270090
E1      =    25.738816502076
E2      =   -10.606027319258
E3      =   -14.934310620488
Exc     =   -13.251457627285
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 8.994e-07, dEband = 2.364e-03
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -41.881425655, dEtot = 8.994e-07, dEband = 2.364e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1253780550000, which took 0.358 ms

iter_count = 114, r_2norm = 3.273e-06, tol*||rhs|| = 5.015e-06

Anderson update took 68.349 ms, out of which F'*F took 32.757 ms; b-Ax took 220.522 ms, out of which Lap took 195.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.037 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506292, int_b + int_rho = 1.564e-13, checking this took 0.156 ms
2-norm of RHS = 721.7940032831875, which took 0.166 ms

iter_count = 198, r_2norm = 6.913e-04, tol*||rhs|| = 7.218e-04

Anderson update took 117.558 ms, out of which F'*F took 55.453 ms; b-Ax took 372.128 ms, out of which Lap took 332.011 ms
Solving Poisson took 827.352 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.187734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.781 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.184659 
Total time for convolution: 	 convolve: 5.196956 
Total time for convolution: 	 convolve: 5.191821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.584 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.719 ms
---Transfer Veff_loc: D2D took 3.540 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.722 ms

This SCF took 27820.976 ms, scf error = 7.125e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.144575, lowerbound = -0.990103, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1603.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 19.863 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.816 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.695 ms
rank =  0, finding HY took 25.560 ms
rank =  0, distributing HY into block cyclic form took 19.919 ms
rank =  0, finding Y'*HY took 3.836 ms
Rank 0, Project_Hamiltonian used 72.448 ms
Total time for projection: 72.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.676 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.776 ms
    first calculated eigval = -0.989658225770833
    last  calculated eigval = 0.043657910752930
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65288772244776
lambda[   4] =  -0.50619974867177
lambda[   5] =  -0.47876912784830
lambda[   6] =  -0.40082430104720
lambda[   7] =  -0.38207638205875
lambda[   8] =  -0.35582823781158
lambda[   9] =  -0.33911093086920
lambda[  10] =  -0.33486917023289
lambda[  11] =  -0.22921391603603
lambda[  12] =  -0.21398563622228
lambda[  13] =  -0.03193394587362
lambda[  14] =  -0.02523914685704
lambda[  15] =  -0.00127539100905
lambda[  16] =   0.02301365399869
lambda[  17] =   0.02465549045922
lambda[  18] =   0.02548659804077
lambda[  19] =   0.04365791075293
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.809 ms
rank =  0, subspace rotation using ScaLAPACK took 7.887 ms
rank =  0, Distributing orbital back into band + domain format took 19.448 ms
rank = 0, Subspace_Rotation used 27.345 ms

Total time for subspace rotation: 27.350 ms
rank = 0, Efermi =  -0.060896983370 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 6.670 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.261 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1722.641 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.912 ms
rank = 0, D2D took 2.008 ms
rank = 0, Transfering density took 2.010 ms
Etot    =   -41.881467021853
Eband   =   -11.339010581299
E1      =    25.731718483787
E2      =   -10.597878683294
E3      =   -14.934829385407
Exc     =   -13.251905793425
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 4.596e-06, dEband = 1.682e-03
rank = 0, Calculating/Estimating energy took 0.992 ms, Etot = -41.881467022, dEtot = 4.596e-06, dEband = 1.682e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0743277611442, which took 0.057 ms

iter_count = 114, r_2norm = 2.031e-06, tol*||rhs|| = 2.973e-06

Anderson update took 68.429 ms, out of which F'*F took 31.537 ms; b-Ax took 218.903 ms, out of which Lap took 195.472 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506284, int_b + int_rho = 6.548e-14, checking this took 0.124 ms
2-norm of RHS = 721.7891397945823, which took 0.121 ms

iter_count = 192, r_2norm = 6.744e-04, tol*||rhs|| = 7.218e-04

Anderson update took 113.999 ms, out of which F'*F took 53.390 ms; b-Ax took 365.146 ms, out of which Lap took 325.845 ms
Solving Poisson took 802.985 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 6.301251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.254518 
Total time for convolution: 	 convolve: 5.201610 
Total time for convolution: 	 convolve: 5.179349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.865 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.396 ms

This SCF took 28972.216 ms, scf error = 5.049e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.143658, lowerbound = -0.989658, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1604.993 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.843 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.825 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.689 ms
rank =  0, finding HY took 25.331 ms
rank =  0, distributing HY into block cyclic form took 20.046 ms
rank =  0, finding Y'*HY took 3.814 ms
Rank 0, Project_Hamiltonian used 72.293 ms
Total time for projection: 72.305 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.989059816449630
    last  calculated eigval = 0.041346022591841
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65210825310333
lambda[   4] =  -0.50555137592307
lambda[   5] =  -0.47817591515007
lambda[   6] =  -0.40022466323912
lambda[   7] =  -0.38133395655520
lambda[   8] =  -0.35508411767815
lambda[   9] =  -0.33844921946756
lambda[  10] =  -0.33410399479780
lambda[  11] =  -0.22861793733885
lambda[  12] =  -0.21338558191098
lambda[  13] =  -0.03128218614007
lambda[  14] =  -0.02334087737979
lambda[  15] =   0.00022465358714
lambda[  16] =   0.02299882561816
lambda[  17] =   0.02595619899950
lambda[  18] =   0.02677765317473
lambda[  19] =   0.04134602259184
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.946 ms
rank =  0, Distributing orbital back into band + domain format took 19.407 ms
rank = 0, Subspace_Rotation used 27.363 ms

Total time for subspace rotation: 27.368 ms
rank = 0, Efermi =  -0.060245021519 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 6.650 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.369 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1723.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.926 ms
rank = 0, D2D took 2.033 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -41.881554574111
Eband   =   -11.323135600928
E1      =    25.723417504250
E2      =   -10.589990713955
E3      =   -14.936111440161
Exc     =   -13.252961431932
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 9.728e-06, dEband = 1.764e-03
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -41.881554574, dEtot = 9.728e-06, dEband = 1.764e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0674155168501, which took 0.072 ms

iter_count = 114, r_2norm = 1.773e-06, tol*||rhs|| = 2.697e-06

Anderson update took 69.903 ms, out of which F'*F took 32.475 ms; b-Ax took 218.511 ms, out of which Lap took 193.658 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.051 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506295, int_b + int_rho = 1.746e-13, checking this took 0.163 ms
2-norm of RHS = 721.7915295129914, which took 0.148 ms

iter_count = 162, r_2norm = 6.035e-04, tol*||rhs|| = 7.218e-04

Anderson update took 97.159 ms, out of which F'*F took 45.075 ms; b-Ax took 306.466 ms, out of which Lap took 273.310 ms
Solving Poisson took 683.326 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.202085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.851 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.179818 
Total time for convolution: 	 convolve: 5.183606 
Total time for convolution: 	 convolve: 5.194952 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.900 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.644 ms

This SCF took 27671.726 ms, scf error = 3.277e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.141346, lowerbound = -0.989060, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1598.626 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.835 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.792 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.644 ms
rank =  0, finding HY took 25.350 ms
rank =  0, distributing HY into block cyclic form took 19.950 ms
rank =  0, finding Y'*HY took 3.801 ms
Rank 0, Project_Hamiltonian used 71.774 ms
Total time for projection: 71.784 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.988769015216200
    last  calculated eigval = 0.039706957810968
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65179309507067
lambda[   4] =  -0.50525636602347
lambda[   5] =  -0.47788071708947
lambda[   6] =  -0.39994913433498
lambda[   7] =  -0.38103102363299
lambda[   8] =  -0.35477354501859
lambda[   9] =  -0.33816650024808
lambda[  10] =  -0.33380008141154
lambda[  11] =  -0.22834267954865
lambda[  12] =  -0.21309795208817
lambda[  13] =  -0.03098165210096
lambda[  14] =  -0.02242788290906
lambda[  15] =   0.00072653026378
lambda[  16] =   0.02288756119053
lambda[  17] =   0.02657939006119
lambda[  18] =   0.02728998774970
lambda[  19] =   0.03970695781097
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.285 ms
rank =  0, subspace rotation using ScaLAPACK took 7.966 ms
rank =  0, Distributing orbital back into band + domain format took 19.436 ms
rank = 0, Subspace_Rotation used 27.413 ms

Total time for subspace rotation: 27.417 ms
rank = 0, Efermi =  -0.059944461747 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 6.462 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1716.835 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.916 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.026 ms
Etot    =   -41.881598712232
Eband   =   -11.316034002143
E1      =    25.719663929967
E2      =   -10.586476844993
E3      =   -14.936742713616
Exc     =   -13.253470999047
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 4.904e-06, dEband = 7.891e-04
rank = 0, Calculating/Estimating energy took 1.135 ms, Etot = -41.881598712, dEtot = 4.904e-06, dEband = 7.891e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0362125737479, which took 0.056 ms

iter_count = 114, r_2norm = 1.004e-06, tol*||rhs|| = 1.449e-06

Anderson update took 69.044 ms, out of which F'*F took 32.457 ms; b-Ax took 215.911 ms, out of which Lap took 193.155 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.756 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506290, int_b + int_rho = 1.310e-13, checking this took 0.113 ms
2-norm of RHS = 721.8032623768042, which took 0.067 ms

iter_count = 174, r_2norm = 6.671e-04, tol*||rhs|| = 7.218e-04

Anderson update took 105.588 ms, out of which F'*F took 49.591 ms; b-Ax took 334.681 ms, out of which Lap took 299.349 ms
Solving Poisson took 734.250 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.191095 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.612 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.198449 
Total time for convolution: 	 convolve: 5.191117 
Total time for convolution: 	 convolve: 5.191225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 1.058 ms
---Transfer Veff_loc: D2D took 4.326 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.865 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.225 ms

This SCF took 27724.517 ms, scf error = 2.577e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.139707, lowerbound = -0.988769, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1605.943 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.830 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.794 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.640 ms
rank =  0, finding HY took 25.368 ms
rank =  0, distributing HY into block cyclic form took 19.897 ms
rank =  0, finding Y'*HY took 3.731 ms
Rank 0, Project_Hamiltonian used 71.659 ms
Total time for projection: 71.670 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.260 ms
    first calculated eigval = -0.988305127133097
    last  calculated eigval = 0.038805742353887
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65136377266311
lambda[   4] =  -0.50481327548423
lambda[   5] =  -0.47741934714663
lambda[   6] =  -0.39952515824748
lambda[   7] =  -0.38060037373633
lambda[   8] =  -0.35434318945826
lambda[   9] =  -0.33774120716576
lambda[  10] =  -0.33337800279674
lambda[  11] =  -0.22791017534583
lambda[  12] =  -0.21265143605532
lambda[  13] =  -0.03052813823102
lambda[  14] =  -0.02028604982012
lambda[  15] =   0.00162537215029
lambda[  16] =   0.02369182974644
lambda[  17] =   0.02847012183986
lambda[  18] =   0.02887390713977
lambda[  19] =   0.03880574235389
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 7.921 ms
rank =  0, Distributing orbital back into band + domain format took 19.408 ms
rank = 0, Subspace_Rotation used 27.340 ms

Total time for subspace rotation: 27.345 ms
rank = 0, Efermi =  -0.059490930517 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 6.685 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.316 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1723.938 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.917 ms
rank = 0, D2D took 2.023 ms
rank = 0, Transfering density took 2.025 ms
Etot    =   -41.881656216663
Eband   =   -11.305436822558
E1      =    25.714497022829
E2      =   -10.580839238811
E3      =   -14.937462312335
Exc     =   -13.254040768463
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 6.389e-06, dEband = 1.177e-03
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -41.881656217, dEtot = 6.389e-06, dEband = 1.177e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348857344821, which took 0.136 ms

iter_count = 108, r_2norm = 1.375e-06, tol*||rhs|| = 1.395e-06

Anderson update took 65.084 ms, out of which F'*F took 30.921 ms; b-Ax took 205.574 ms, out of which Lap took 183.307 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.549 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506298, int_b + int_rho = 2.110e-13, checking this took 0.138 ms
2-norm of RHS = 721.8082396149387, which took 0.139 ms

iter_count = 138, r_2norm = 6.942e-04, tol*||rhs|| = 7.218e-04

Anderson update took 82.187 ms, out of which F'*F took 37.425 ms; b-Ax took 260.273 ms, out of which Lap took 229.927 ms
Solving Poisson took 577.352 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.217311 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.275 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.182250 
Total time for convolution: 	 convolve: 5.205411 
Total time for convolution: 	 convolve: 5.190029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.036 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.472 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.391 ms

This SCF took 27554.396 ms, scf error = 1.602e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138806, lowerbound = -0.988305, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1619.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.907 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.772 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.696 ms
rank =  0, finding HY took 25.436 ms
rank =  0, distributing HY into block cyclic form took 19.832 ms
rank =  0, finding Y'*HY took 3.962 ms
Rank 0, Project_Hamiltonian used 71.954 ms
Total time for projection: 71.976 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.258 ms
    first calculated eigval = -0.988149873314208
    last  calculated eigval = 0.038087617131229
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65123294426495
lambda[   4] =  -0.50466981746360
lambda[   5] =  -0.47726759563178
lambda[   6] =  -0.39937863388218
lambda[   7] =  -0.38046768645916
lambda[   8] =  -0.35421265284056
lambda[   9] =  -0.33759978494376
lambda[  10] =  -0.33324590363949
lambda[  11] =  -0.22776507771210
lambda[  12] =  -0.21250370152102
lambda[  13] =  -0.03041746741873
lambda[  14] =  -0.01951100411330
lambda[  15] =   0.00184320917621
lambda[  16] =   0.02395238856713
lambda[  17] =   0.02878758170523
lambda[  18] =   0.02928491244956
lambda[  19] =   0.03808761713123
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.313 ms
rank =  0, subspace rotation using ScaLAPACK took 7.919 ms
rank =  0, Distributing orbital back into band + domain format took 19.684 ms
rank = 0, Subspace_Rotation used 27.616 ms

Total time for subspace rotation: 27.620 ms
rank = 0, Efermi =  -0.059380258664 calculate fermi energy took 0.074 ms
rank = 0, --- Calculate rho: sum over local bands took 6.685 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.471 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1738.636 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.984 ms
rank = 0, D2D took 2.089 ms
rank = 0, Transfering density took 2.095 ms
Etot    =   -41.881678294208
Eband   =   -11.302013556023
E1      =    25.712889382579
E2      =   -10.578943944776
E3      =   -14.937700809962
Exc     =   -13.254221675885
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 2.453e-06, dEband = 3.804e-04
rank = 0, Calculating/Estimating energy took 1.496 ms, Etot = -41.881678294, dEtot = 2.453e-06, dEband = 3.804e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0209977648493, which took 0.074 ms

iter_count = 114, r_2norm = 5.104e-07, tol*||rhs|| = 8.399e-07

Anderson update took 70.167 ms, out of which F'*F took 32.148 ms; b-Ax took 217.259 ms, out of which Lap took 193.129 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.542 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506295, int_b + int_rho = 1.783e-13, checking this took 0.123 ms
2-norm of RHS = 721.8145578658366, which took 0.128 ms

iter_count = 144, r_2norm = 7.106e-04, tol*||rhs|| = 7.218e-04

Anderson update took 85.975 ms, out of which F'*F took 39.313 ms; b-Ax took 273.512 ms, out of which Lap took 244.112 ms
Solving Poisson took 603.354 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.207447 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.897 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.185162 
Total time for convolution: 	 convolve: 5.196354 
Total time for convolution: 	 convolve: 5.182863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.957 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.483 ms

This SCF took 27666.089 ms, scf error = 1.259e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138088, lowerbound = -0.988150, upperbound = 267.577334

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1602.062 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.900 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.845 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.763 ms
rank =  0, finding HY took 25.379 ms
rank =  0, distributing HY into block cyclic form took 19.859 ms
rank =  0, finding Y'*HY took 4.116 ms
Rank 0, Project_Hamiltonian used 72.144 ms
Total time for projection: 72.156 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.987978520994569
    last  calculated eigval = 0.038258418514452
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65106642973729
lambda[   4] =  -0.50449698828698
lambda[   5] =  -0.47708829143091
lambda[   6] =  -0.39920147505213
lambda[   7] =  -0.38030036192441
lambda[   8] =  -0.35404975912520
lambda[   9] =  -0.33742768561675
lambda[  10] =  -0.33307472249764
lambda[  11] =  -0.22759205870236
lambda[  12] =  -0.21232866638391
lambda[  13] =  -0.03028364627721
lambda[  14] =  -0.01852444965463
lambda[  15] =   0.00192454263663
lambda[  16] =   0.02475496074801
lambda[  17] =   0.02933962156246
lambda[  18] =   0.02971463018525
lambda[  19] =   0.03825841851445
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.934 ms
rank =  0, Distributing orbital back into band + domain format took 19.449 ms
rank = 0, Subspace_Rotation used 27.394 ms

Total time for subspace rotation: 27.399 ms
rank = 0, Efermi =  -0.059246437232 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 6.583 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.312 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1720.499 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 3.314 ms
rank = 0, D2D took 3.422 ms
rank = 0, Transfering density took 3.427 ms
Etot    =   -41.881702207566
Eband   =   -11.297886326718
E1      =    25.711041546060
E2      =   -10.576577041738
E3      =   -14.937940149086
Exc     =   -13.254397418114
Esc     =   -68.554977198870
Entropy =    -0.000000000748
dE = 2.657e-06, dEband = 4.586e-04
rank = 0, Calculating/Estimating energy took 1.262 ms, Etot = -41.881702208, dEtot = 2.657e-06, dEband = 4.586e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0197460885174, which took 0.055 ms

iter_count = 108, r_2norm = 7.329e-07, tol*||rhs|| = 7.898e-07

Anderson update took 65.926 ms, out of which F'*F took 30.527 ms; b-Ax took 203.304 ms, out of which Lap took 181.825 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.860 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002506277, int_rho =  24.00000002506285, int_b + int_rho = 8.004e-14, checking this took 0.119 ms
2-norm of RHS = 721.8143492360371, which took 0.114 ms

iter_count = 114, r_2norm = 6.620e-04, tol*||rhs|| = 7.218e-04

Anderson update took 68.512 ms, out of which F'*F took 31.924 ms; b-Ax took 216.415 ms, out of which Lap took 192.606 ms
Solving Poisson took 476.654 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.205842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.578 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.183834 
Total time for convolution: 	 convolve: 5.199095 
Total time for convolution: 	 convolve: 5.209163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.113 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.497 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.888 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.420 ms

This SCF took 27495.878 ms, scf error = 9.311e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.65106642973729, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50449698828698, occ[   4] =   2.00000000000000
lambda[   5] =  -0.47708829143091, occ[   5] =   2.00000000000000
lambda[   6] =  -0.39920147505213, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38030036192441, occ[   7] =   2.00000000000000
lambda[   8] =  -0.35404975912520, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33742768561675, occ[   9] =   2.00000000000000
lambda[  10] =  -0.33307472249764, occ[  10] =   2.00000000000000
lambda[  11] =  -0.22759205870236, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21232866638391, occ[  12] =   2.00000000000000
lambda[  13] =  -0.03028364627721, occ[  13] =   0.00000002506289
lambda[  14] =  -0.01852444965463, occ[  14] =   0.00000000000000
lambda[  15] =   0.00192454263663, occ[  15] =   0.00000000000000
lambda[  16] =   0.02475496074801, occ[  16] =   0.00000000000000
lambda[  17] =   0.02933962156246, occ[  17] =   0.00000000000000
lambda[  18] =   0.02971463018525, occ[  18] =   0.00000000000000
lambda[  19] =   0.03825841851445, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.396 ms, time for Allreduce/Reduce: 13.221 ms 
Time for calculating local force components: 22.835 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.92222353854278  -0.56558260262013   0.00000008376394
  0.01019620325387   0.07545602949658   0.00000000202762
  0.03858948647392   0.03204697631011   0.00000000476912
  0.00389253793370  -0.02882821154668  -0.03921249016437
  0.00389253277841  -0.02882819650012   0.03921245601845
 -0.04389331234287  -0.02532212667206  -0.00000000992146
  0.04480970910186  -0.00378433112293  -0.00000030732148
 -0.03193180004038  -0.06820233422549   0.00000000635092
  0.77220836624659   0.51094425199874   0.00000028511151
force_loc = 
  0.90173833113920   0.54689562343699  -0.00000429330665
 -0.01047332310535  -0.07767501521403  -0.00000042693731
 -0.03998926608479  -0.03255773658169  -0.00000063477269
 -0.00378838416424   0.02946199465214   0.04009242938358
 -0.00378765268018   0.02946127793740  -0.04009265632270
  0.04604860120045   0.02660293288612   0.00000019321804
 -0.04213519886352   0.00229362360517  -0.00000339898015
  0.02667873608757   0.08413244476905   0.00000020435238
 -0.75337738115580  -0.50890156581700  -0.00000046915471
Time for calculating nonlocal force components: 43.394 ms
[32mforces_xc: 
[0m[32m  0.03027774828701   0.01572810435137  -0.00000015398458
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00221775618939   0.00039756911177  -0.00000012453850
[0m[32m  0.00222893362341  -0.00586678245555  -0.00000000898964
[0m[32m -0.02658186642527  -0.00766648319304   0.00000002387963
[0mTime for calculating XC forces components: 30.919 ms
 Cartesian force = 
  0.00977457349105  -0.00298170178807  -0.00000333180295
 -0.00029508724386  -0.00224181267375   0.00000060681465
 -0.00141774700326  -0.00053358722788   0.00000040172076
  0.00008618637709   0.00061095614916   0.00088097094355
  0.00008691270585   0.00061025448097  -0.00087916857991
  0.00213732146520   0.00125797925775   0.00000121502092
  0.00043878665657  -0.00111596536229  -0.00000279911579
 -0.00304209772178   0.01004050113171   0.00000123343800
 -0.00776884872686  -0.00564662396761   0.00000087156076
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 387.220 ms
The program took 453.861 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:57
Job ID:        2266817
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:32:48,vmem=8416K,walltime=00:07:44,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-22-2
---------------------------------------
