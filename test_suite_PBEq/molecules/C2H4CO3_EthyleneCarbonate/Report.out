---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:55
Job ID:    2266526
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:00
Job ID:    2266526
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.062 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 16.592 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 60.058 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 62.278 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.013 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.121 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   13.609984	
   10.000000	   12.143754	    9.847571	
   10.000000	    7.856246	    9.847571	
    8.323076	   12.234269	    6.390016	
   11.676924	   12.234269	    6.390016	
   11.676924	    7.765731	    6.390016	
    8.323076	    7.765731	    6.390016	
   10.000000	   10.000000	   11.372109	
   10.000000	   11.462750	    7.306679	
   10.000000	    8.537250	    7.306679	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.217 ms
Set up communicators.

--set up spincomm took 3.815 ms

--set up kptcomm took 0.348 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 25, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 25 
rank =  0, my blacs rank = 0, BLCYC size (170000, 13), actual size (170000, 13)
rank = 0, mb = nb = 25, mbQ = nbQ = 64
rank = 0, nr_Hp = 25, nc_Hp = 25
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.060 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.437 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 13
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.785 ms

Calculate_SplineDerivRadFun took 0.213 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.276 ms.
time spent on vectorized spline interp: 2.780 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.009 ms.
time spent on vectorized spline interp: 1.343 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.306 ms.
time spent on vectorized spline interp: 1.635 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.309 ms.

Calculating rb for all atom types took 15.669 ms
----------------------
Estimated memory usage
Total: 1.46 GB
orbitals             : 1.12 GB
global sized vectors : 213.62 MB
subspace matrices : 87.89 kB
others : 135.81 MB
----------------------------------------------
Estimated memory usage per processor: 124.49 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.061 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.016 ms
Calculating pseudocharge density ... 
the global sum of int_b = -34.0000000278702, sum_int_rho = 33.5890115566012
PosCharge = 34.000000027870, NegCharge = -33.589011556601, scal_fac = 1.012235801300
After scaling, int_rho = 34.0000000278704, PosCharge + NegCharge - NetCharge = -1.776e-13
--Calculate Vref took 0.767 ms
--Calculate rho_guess took 4.709 ms

 integral of b = -34.0000000278702,
 int{b} + Nelectron + NetCharge = -2.787e-08,
 Esc = -108.9125490871873,
 MPI_Reduce took 1.986 ms

Calculating b & b_ref took 17.036 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.027 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.037 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.012 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.089 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.010 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.030 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 51.282 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787016, int_b + int_rho = -1.164e-12, checking this took 0.092 ms
2-norm of RHS = 791.3076985041625, which took 0.466 ms

iter_count = 420, r_2norm = 6.994e-04, tol*||rhs|| = 7.913e-04

Anderson update took 233.754 ms, out of which F'*F took 106.658 ms; b-Ax took 716.798 ms, out of which Lap took 642.503 ms
Solving Poisson took 1516.321 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.409 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.194196 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
Total time for convolution: 	 convolve: 5.191398 
Total time for convolution: 	 convolve: 5.195316 
Total time for convolution: 	 convolve: 5.115096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.048 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.517 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
rank = 0, XC calculation took 24996.414 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.102 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.754 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.984 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.152 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.668 ms
    Lanczos iter 56, eigmin  = -1.097427671, eigmax = 264.953987144, err_eigmin = 4.827e-04, err_eigmax = 9.908e-03
rank =   0, Lanczos took 127.956 ms, eigmin = -1.097427670751, eigmax = 267.603527015099

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.203050, lowerbound = -1.197428, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2000.048 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.054 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.959 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.236 ms
rank =  0, Distribute data + matrix mult took 32.274 ms
rank =  0, finding HY took 34.436 ms
rank =  0, distributing HY into block cyclic form took 23.205 ms
rank =  0, finding Y'*HY took 6.181 ms
Rank 0, Project_Hamiltonian used 96.486 ms
Total time for projection: 96.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.303 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.363 ms
    first calculated eigval = 2.705265567602217
    last  calculated eigval = 3.285835673668014
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =   2.86764325776171
lambda[   9] =   2.90729432842747
lambda[  10] =   2.93195849055700
lambda[  11] =   2.96137659005377
lambda[  12] =   2.97348510029558
lambda[  13] =   2.98209872059875
lambda[  14] =   3.04578388375690
lambda[  15] =   3.04961738902052
lambda[  16] =   3.06009488928384
lambda[  17] =   3.07502837686362
lambda[  18] =   3.08148328165624
lambda[  19] =   3.11848284523310
lambda[  20] =   3.12531950722409
lambda[  21] =   3.15005587178169
lambda[  22] =   3.16599948190986
lambda[  23] =   3.20716979468152
lambda[  24] =   3.23052228061359
lambda[  25] =   3.28583567366801
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.379 ms
rank =  0, subspace rotation using ScaLAPACK took 6.526 ms
rank =  0, Distributing orbital back into band + domain format took 22.997 ms
rank = 0, Subspace_Rotation used 29.549 ms

Total time for subspace rotation: 29.553 ms
rank = 0, Efermi =   3.078257703398 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.385836, lowerbound = -1.197428, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2012.963 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.684 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.831 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 26.551 ms
rank =  0, finding HY took 34.206 ms
rank =  0, distributing HY into block cyclic form took 22.753 ms
rank =  0, finding Y'*HY took 4.998 ms
Rank 0, Project_Hamiltonian used 88.552 ms
Total time for projection: 88.568 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.177 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.971684180544649
    last  calculated eigval = 0.460887659487493
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.27183719759314
lambda[   9] =  -0.23632015612350
lambda[  10] =  -0.13016914021078
lambda[  11] =  -0.09889601548121
lambda[  12] =  -0.05258614854271
lambda[  13] =   0.03663271506656
lambda[  14] =   0.06066774045177
lambda[  15] =   0.10735240854859
lambda[  16] =   0.23332078584464
lambda[  17] =   0.24784597180073
lambda[  18] =   0.28845072934209
lambda[  19] =   0.34336904451121
lambda[  20] =   0.35636204076553
lambda[  21] =   0.36594490676782
lambda[  22] =   0.38795522500223
lambda[  23] =   0.40109635637933
lambda[  24] =   0.44004265854774
lambda[  25] =   0.46088765948749
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 6.516 ms
rank =  0, Distributing orbital back into band + domain format took 22.597 ms
rank = 0, Subspace_Rotation used 29.131 ms

Total time for subspace rotation: 29.135 ms
rank = 0, Efermi =   0.268148537643 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.560888, lowerbound = -1.197428, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2002.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.210 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.887 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 27.142 ms
rank =  0, finding HY took 33.310 ms
rank =  0, distributing HY into block cyclic form took 22.840 ms
rank =  0, finding Y'*HY took 4.981 ms
Rank 0, Project_Hamiltonian used 88.320 ms
Total time for projection: 88.327 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -1.101121795215737
    last  calculated eigval = 0.165152768579531
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.53981414500816
lambda[   9] =  -0.52995812279347
lambda[  10] =  -0.47465880171510
lambda[  11] =  -0.47133702604940
lambda[  12] =  -0.43146440082030
lambda[  13] =  -0.40155806459479
lambda[  14] =  -0.38593840696286
lambda[  15] =  -0.32798510820160
lambda[  16] =  -0.31331240967380
lambda[  17] =  -0.28428091524512
lambda[  18] =   0.00603774399906
lambda[  19] =   0.06271004114197
lambda[  20] =   0.09497127477251
lambda[  21] =   0.10302064703588
lambda[  22] =   0.12318154195286
lambda[  23] =   0.12932250981617
lambda[  24] =   0.13950505778380
lambda[  25] =   0.16515276857953
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 6.508 ms
rank =  0, Distributing orbital back into band + domain format took 23.104 ms
rank = 0, Subspace_Rotation used 29.630 ms

Total time for subspace rotation: 29.635 ms
rank = 0, Efermi =  -0.022828799175 calculate fermi energy took 0.026 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.265153, lowerbound = -1.197428, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2014.565 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.610 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.812 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 26.461 ms
rank =  0, finding HY took 33.897 ms
rank =  0, distributing HY into block cyclic form took 22.735 ms
rank =  0, finding Y'*HY took 4.999 ms
Rank 0, Project_Hamiltonian used 88.131 ms
Total time for projection: 88.137 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.212 ms
    first calculated eigval = -1.101237090982491
    last  calculated eigval = 0.094570801012124
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.54403685851437
lambda[   9] =  -0.53543992707775
lambda[  10] =  -0.48109610807980
lambda[  11] =  -0.48058572278087
lambda[  12] =  -0.43752043522122
lambda[  13] =  -0.41161114151463
lambda[  14] =  -0.39358511442640
lambda[  15] =  -0.33977498041596
lambda[  16] =  -0.33646663748737
lambda[  17] =  -0.32110828742311
lambda[  18] =  -0.02776540514268
lambda[  19] =  -0.01120772125308
lambda[  20] =   0.02643303776100
lambda[  21] =   0.04277174720685
lambda[  22] =   0.05830248295901
lambda[  23] =   0.06545438864880
lambda[  24] =   0.08026309319133
lambda[  25] =   0.09457080101212
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 6.526 ms
rank =  0, Distributing orbital back into band + domain format took 22.427 ms
rank = 0, Subspace_Rotation used 28.979 ms

Total time for subspace rotation: 28.985 ms
rank = 0, Efermi =  -0.056631948198 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 3.347 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.465 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.099 ms
rank = 0, Calculating density took 8646.320 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 0.878 ms
rank = 0, Transfering density took 0.887 ms
Etot    =   -70.176994418988
Eband   =   -20.199068716017
E1      =    39.078198424992
E2      =   -17.586724832262
E3      =   -22.066123942493
Exc     =   -19.796423814701
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 7.018e+00, dEband = 2.020e+00
rank = 0, Calculating/Estimating energy took 1.170 ms, Etot = -70.176994419, dEtot = 7.018e+00, dEband = 2.020e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 76.2221585202878, which took 1.218 ms

iter_count = 90, r_2norm = 2.656e-03, tol*||rhs|| = 3.049e-03

Anderson update took 55.251 ms, out of which F'*F took 29.049 ms; b-Ax took 160.290 ms, out of which Lap took 144.936 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 343.991 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787036, int_b + int_rho = -9.604e-13, checking this took 0.133 ms
2-norm of RHS = 786.4704703904071, which took 0.340 ms

iter_count = 276, r_2norm = 6.826e-04, tol*||rhs|| = 7.865e-04

Anderson update took 148.061 ms, out of which F'*F took 69.923 ms; b-Ax took 467.544 ms, out of which Lap took 420.714 ms
Solving Poisson took 993.843 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.395 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.083868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 118.705 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.082688 
Total time for convolution: 	 convolve: 5.083021 
Total time for convolution: 	 convolve: 5.090545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.121 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.653 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.964 ms

This SCF took 34562.074 ms, scf error = 1.422e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194571, lowerbound = -1.101237, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2000.649 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.660 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.861 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 26.566 ms
rank =  0, finding HY took 34.413 ms
rank =  0, distributing HY into block cyclic form took 21.665 ms
rank =  0, finding Y'*HY took 7.639 ms
Rank 0, Project_Hamiltonian used 90.320 ms
Total time for projection: 90.333 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -1.089794517526271
    last  calculated eigval = 0.073269661291754
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.51867874978005
lambda[   9] =  -0.51506696512268
lambda[  10] =  -0.45473450919520
lambda[  11] =  -0.44443021314761
lambda[  12] =  -0.42388669615262
lambda[  13] =  -0.38644763675802
lambda[  14] =  -0.37336017721277
lambda[  15] =  -0.30927448777589
lambda[  16] =  -0.30470396346958
lambda[  17] =  -0.30264973196826
lambda[  18] =  -0.03490549360039
lambda[  19] =  -0.02618742952738
lambda[  20] =  -0.00515241850300
lambda[  21] =   0.01741542461224
lambda[  22] =   0.02825233353768
lambda[  23] =   0.03447592040675
lambda[  24] =   0.06256596384093
lambda[  25] =   0.07326966129175
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 6.959 ms
rank =  0, Distributing orbital back into band + domain format took 23.771 ms
rank = 0, Subspace_Rotation used 30.759 ms

Total time for subspace rotation: 30.764 ms
rank = 0, Efermi =  -0.063772052216 calculate fermi energy took 0.154 ms
rank = 0, --- Calculate rho: sum over local bands took 3.444 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.469 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.092 ms
rank = 0, Calculating density took 2126.606 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.484 ms
rank = 0, D2D took 0.722 ms
rank = 0, Transfering density took 0.732 ms
Etot    =   -70.102154844445
Eband   =   -19.414657175402
E1      =    38.397568850093
E2      =   -17.507264253838
E3      =   -22.310248387315
Exc     =   -19.990030072273
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 7.484e-03, dEband = 7.844e-02
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -70.102154844, dEtot = 7.484e-03, dEband = 7.844e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 32.7294687869728, which took 0.077 ms

iter_count = 96, r_2norm = 1.045e-03, tol*||rhs|| = 1.309e-03

Anderson update took 52.001 ms, out of which F'*F took 24.198 ms; b-Ax took 162.464 ms, out of which Lap took 145.869 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.013 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787033, int_b + int_rho = -9.895e-13, checking this took 0.117 ms
2-norm of RHS = 782.5258276935117, which took 0.124 ms

iter_count = 288, r_2norm = 6.681e-04, tol*||rhs|| = 7.825e-04

Anderson update took 154.854 ms, out of which F'*F took 73.790 ms; b-Ax took 489.283 ms, out of which Lap took 440.928 ms
Solving Poisson took 1035.708 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.108220 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.295 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.085183 
Total time for convolution: 	 convolve: 5.088122 
Total time for convolution: 	 convolve: 5.117298 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 637.884 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.876 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 28625.145 ms, scf error = 9.171e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173270, lowerbound = -1.089795, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1998.876 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.660 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.140 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 26.833 ms
rank =  0, finding HY took 35.367 ms
rank =  0, distributing HY into block cyclic form took 25.249 ms
rank =  0, finding Y'*HY took 4.773 ms
Rank 0, Project_Hamiltonian used 92.265 ms
Total time for projection: 92.279 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.164 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 1.149 ms
    first calculated eigval = -1.076643404896174
    last  calculated eigval = 0.066637151959025
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.48579361894320
lambda[   9] =  -0.48285522987404
lambda[  10] =  -0.41796387829376
lambda[  11] =  -0.40976933620082
lambda[  12] =  -0.40754838270286
lambda[  13] =  -0.35038940666364
lambda[  14] =  -0.34873580676658
lambda[  15] =  -0.28293820613655
lambda[  16] =  -0.27643278933722
lambda[  17] =  -0.27294167831969
lambda[  18] =  -0.03357742839725
lambda[  19] =  -0.02412678700714
lambda[  20] =  -0.00660429113817
lambda[  21] =   0.01037157278073
lambda[  22] =   0.01846433804745
lambda[  23] =   0.02744892715859
lambda[  24] =   0.06021839031125
lambda[  25] =   0.06663715195903
==subpsace eigenproblem: bcast eigvals took 0.553 ms
Total time for solving subspace eigenvalue problem: 1.711 ms
rank =  0, subspace rotation using ScaLAPACK took 7.277 ms
rank =  0, Distributing orbital back into band + domain format took 23.619 ms
rank = 0, Subspace_Rotation used 30.916 ms

Total time for subspace rotation: 30.923 ms
rank = 0, Efermi =  -0.062443976890 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.477 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.463 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 2127.927 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.516 ms
rank = 0, D2D took 0.714 ms
rank = 0, Transfering density took 0.723 ms
Etot    =   -70.058966040473
Eband   =   -18.450991519226
E1      =    37.584564655467
E2      =   -17.332464073429
E3      =   -22.636638560238
Exc     =   -20.249092722364
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 4.319e-03, dEband = 9.637e-02
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -70.058966040, dEtot = 4.319e-03, dEband = 9.637e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 6.9552517605553, which took 0.047 ms

iter_count = 102, r_2norm = 2.224e-04, tol*||rhs|| = 2.782e-04

Anderson update took 55.440 ms, out of which F'*F took 25.886 ms; b-Ax took 173.352 ms, out of which Lap took 156.425 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.495 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787043, int_b + int_rho = -8.949e-13, checking this took 0.105 ms
2-norm of RHS = 783.2548285886209, which took 0.106 ms

iter_count = 276, r_2norm = 7.548e-04, tol*||rhs|| = 7.833e-04

Anderson update took 147.712 ms, out of which F'*F took 70.649 ms; b-Ax took 474.148 ms, out of which Lap took 427.860 ms
Solving Poisson took 991.897 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.079534 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.605 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.087529 
Total time for convolution: 	 convolve: 5.082122 
Total time for convolution: 	 convolve: 5.083598 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 27922.035 ms, scf error = 3.946e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.166637, lowerbound = -1.076643, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2001.101 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.765 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.893 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.696 ms
rank =  0, finding HY took 34.245 ms
rank =  0, distributing HY into block cyclic form took 22.677 ms
rank =  0, finding Y'*HY took 5.224 ms
Rank 0, Project_Hamiltonian used 88.920 ms
Total time for projection: 88.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.068568232352071
    last  calculated eigval = 0.062140182135932
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.47082047977990
lambda[   9] =  -0.46306937823708
lambda[  10] =  -0.40568638711517
lambda[  11] =  -0.39867259261612
lambda[  12] =  -0.39709328478658
lambda[  13] =  -0.33913817662901
lambda[  14] =  -0.33155317515687
lambda[  15] =  -0.27913612176231
lambda[  16] =  -0.27216096913246
lambda[  17] =  -0.26260376538055
lambda[  18] =  -0.03258585092030
lambda[  19] =  -0.01901712070742
lambda[  20] =  -0.00438347803693
lambda[  21] =   0.00859000901357
lambda[  22] =   0.01611515156402
lambda[  23] =   0.02437771582152
lambda[  24] =   0.05475490896619
lambda[  25] =   0.06214018213593
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 7.798 ms
rank =  0, Distributing orbital back into band + domain format took 23.258 ms
rank = 0, Subspace_Rotation used 31.078 ms

Total time for subspace rotation: 31.082 ms
rank = 0, Efermi =  -0.061452394054 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 3.434 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.714 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 2125.740 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.471 ms
rank = 0, D2D took 0.672 ms
rank = 0, Transfering density took 0.679 ms
Etot    =   -70.050619130308
Eband   =   -18.041642255973
E1      =    37.293942680097
E2      =   -17.190542274075
E3      =   -22.780972882092
Exc     =   -20.361885622583
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 8.347e-04, dEband = 4.093e-02
rank = 0, Calculating/Estimating energy took 1.094 ms, Etot = -70.050619130, dEtot = 8.347e-04, dEband = 4.093e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.4424114372685, which took 0.049 ms

iter_count = 102, r_2norm = 1.428e-04, tol*||rhs|| = 1.777e-04

Anderson update took 54.703 ms, out of which F'*F took 25.900 ms; b-Ax took 173.204 ms, out of which Lap took 156.418 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.687 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787036, int_b + int_rho = -9.532e-13, checking this took 0.115 ms
2-norm of RHS = 783.3841550070343, which took 0.091 ms

iter_count = 240, r_2norm = 6.162e-04, tol*||rhs|| = 7.834e-04

Anderson update took 128.366 ms, out of which F'*F took 61.122 ms; b-Ax took 407.440 ms, out of which Lap took 367.215 ms
Solving Poisson took 860.927 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.114 ms
Total time for convolution: 	 convolve: 5.085840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.645 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.113400 
Total time for convolution: 	 convolve: 5.277502 
Total time for convolution: 	 convolve: 5.135005 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.362 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.999 ms

This SCF took 28247.783 ms, scf error = 1.109e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.162140, lowerbound = -1.068568, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2001.747 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.630 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.891 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.562 ms
rank =  0, finding HY took 34.203 ms
rank =  0, distributing HY into block cyclic form took 22.757 ms
rank =  0, finding Y'*HY took 5.578 ms
Rank 0, Project_Hamiltonian used 89.152 ms
Total time for projection: 89.165 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.066517681982577
    last  calculated eigval = 0.059313576088489
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.46777307287150
lambda[   9] =  -0.45997148401714
lambda[  10] =  -0.39873553852152
lambda[  11] =  -0.39596209850566
lambda[  12] =  -0.39366824368599
lambda[  13] =  -0.33747943639586
lambda[  14] =  -0.32920130053030
lambda[  15] =  -0.27466026552959
lambda[  16] =  -0.26527714985956
lambda[  17] =  -0.26035981852257
lambda[  18] =  -0.03283063167878
lambda[  19] =  -0.01680058275014
lambda[  20] =  -0.00473635361979
lambda[  21] =   0.00732766484319
lambda[  22] =   0.01447727133647
lambda[  23] =   0.02184580331757
lambda[  24] =   0.04735723776866
lambda[  25] =   0.05931357608849
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 7.874 ms
rank =  0, Distributing orbital back into band + domain format took 23.217 ms
rank = 0, Subspace_Rotation used 31.114 ms

Total time for subspace rotation: 31.117 ms
rank = 0, Efermi =  -0.061697174788 calculate fermi energy took 0.175 ms
rank = 0, --- Calculate rho: sum over local bands took 3.399 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.518 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 2126.855 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.515 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.710 ms
Etot    =   -70.049802088819
Eband   =   -17.929306588633
E1      =    37.225346407689
E2      =   -17.139013464986
E3      =   -22.815204068674
Exc     =   -20.387510353519
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 8.170e-05, dEband = 1.123e-02
rank = 0, Calculating/Estimating energy took 0.962 ms, Etot = -70.049802089, dEtot = 8.170e-05, dEband = 1.123e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2843527114164, which took 0.060 ms

iter_count = 108, r_2norm = 4.969e-05, tol*||rhs|| = 5.137e-05

Anderson update took 57.745 ms, out of which F'*F took 27.514 ms; b-Ax took 183.925 ms, out of which Lap took 166.023 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.773 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787039, int_b + int_rho = -9.313e-13, checking this took 0.132 ms
2-norm of RHS = 783.9795831949311, which took 0.094 ms

iter_count = 240, r_2norm = 6.503e-04, tol*||rhs|| = 7.840e-04

Anderson update took 128.312 ms, out of which F'*F took 60.949 ms; b-Ax took 413.165 ms, out of which Lap took 372.048 ms
Solving Poisson took 863.782 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.081763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.739 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.103903 
Total time for convolution: 	 convolve: 5.087009 
Total time for convolution: 	 convolve: 5.104443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.013 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.453 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.484 ms

This SCF took 27910.353 ms, scf error = 6.632e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.159314, lowerbound = -1.066518, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2003.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.762 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.627 ms
rank =  0, finding HY took 34.552 ms
rank =  0, distributing HY into block cyclic form took 22.753 ms
rank =  0, finding Y'*HY took 5.116 ms
Rank 0, Project_Hamiltonian used 89.092 ms
Total time for projection: 89.104 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.167 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -1.063904225464308
    last  calculated eigval = 0.057987388921203
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.46552477903536
lambda[   9] =  -0.45730491014604
lambda[  10] =  -0.39607778365736
lambda[  11] =  -0.39363540097715
lambda[  12] =  -0.39109343301656
lambda[  13] =  -0.33578928702301
lambda[  14] =  -0.32719121146063
lambda[  15] =  -0.27267677436824
lambda[  16] =  -0.26291340761916
lambda[  17] =  -0.25819977088285
lambda[  18] =  -0.03266387158068
lambda[  19] =  -0.01442400526096
lambda[  20] =  -0.00426454208133
lambda[  21] =   0.00712075811918
lambda[  22] =   0.01395599123889
lambda[  23] =   0.02063424101533
lambda[  24] =   0.04157900673202
lambda[  25] =   0.05798738892120
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 7.811 ms
rank =  0, Distributing orbital back into band + domain format took 23.198 ms
rank = 0, Subspace_Rotation used 31.029 ms

Total time for subspace rotation: 31.033 ms
rank = 0, Efermi =  -0.061530414518 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.544 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 2128.457 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.496 ms
rank = 0, D2D took 0.814 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -70.049394150230
Eband   =   -17.850097788211
E1      =    37.194914667118
E2      =   -17.085341076321
E3      =   -22.831929994139
Exc     =   -20.398933011580
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 4.079e-05, dEband = 7.921e-03
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -70.049394150, dEtot = 4.079e-05, dEband = 7.921e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5620574670044, which took 0.058 ms

iter_count = 114, r_2norm = 1.467e-05, tol*||rhs|| = 2.248e-05

Anderson update took 61.070 ms, out of which F'*F took 28.936 ms; b-Ax took 194.737 ms, out of which Lap took 175.625 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.253 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787034, int_b + int_rho = -9.823e-13, checking this took 0.077 ms
2-norm of RHS = 784.2212870048062, which took 0.095 ms

iter_count = 228, r_2norm = 7.361e-04, tol*||rhs|| = 7.842e-04

Anderson update took 121.552 ms, out of which F'*F took 57.789 ms; b-Ax took 389.918 ms, out of which Lap took 349.984 ms
Solving Poisson took 817.955 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.086622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.730 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.139456 
Total time for convolution: 	 convolve: 5.094548 
Total time for convolution: 	 convolve: 5.094029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.156 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.973 ms

This SCF took 27873.636 ms, scf error = 2.817e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.157987, lowerbound = -1.063904, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2001.559 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.744 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.607 ms
rank =  0, finding HY took 34.353 ms
rank =  0, distributing HY into block cyclic form took 22.948 ms
rank =  0, finding Y'*HY took 5.006 ms
Rank 0, Project_Hamiltonian used 88.958 ms
Total time for projection: 88.971 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.161 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.061411983979174
    last  calculated eigval = 0.057372976018440
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.46304501694585
lambda[   9] =  -0.45487110593756
lambda[  10] =  -0.39381448033458
lambda[  11] =  -0.39128818693372
lambda[  12] =  -0.38917226625658
lambda[  13] =  -0.33322494003769
lambda[  14] =  -0.32467259194155
lambda[  15] =  -0.27051482961446
lambda[  16] =  -0.26073253504637
lambda[  17] =  -0.25582457521291
lambda[  18] =  -0.03220925705157
lambda[  19] =  -0.01281104291231
lambda[  20] =  -0.00337829535435
lambda[  21] =   0.00743856967633
lambda[  22] =   0.01430802318815
lambda[  23] =   0.02026354170714
lambda[  24] =   0.03767769740952
lambda[  25] =   0.05737297601844
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.805 ms
rank =  0, Distributing orbital back into band + domain format took 23.164 ms
rank = 0, Subspace_Rotation used 30.987 ms

Total time for subspace rotation: 30.990 ms
rank = 0, Efermi =  -0.061075800203 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.414 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.517 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.063 ms
rank = 0, Calculating density took 2125.909 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
rank = 0, D2D took 0.730 ms
rank = 0, Transfering density took 0.734 ms
Etot    =   -70.049214124906
Eband   =   -17.769649735590
E1      =    37.155302291391
E2      =   -17.040793062750
E3      =   -22.845281467310
Exc     =   -20.408392122750
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 1.800e-05, dEband = 8.045e-03
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -70.049214125, dEtot = 1.800e-05, dEband = 8.045e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3367136961671, which took 0.049 ms

iter_count = 108, r_2norm = 1.256e-05, tol*||rhs|| = 1.347e-05

Anderson update took 58.774 ms, out of which F'*F took 27.445 ms; b-Ax took 184.804 ms, out of which Lap took 166.670 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.896 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787034, int_b + int_rho = -9.823e-13, checking this took 0.116 ms
2-norm of RHS = 784.3894388701457, which took 0.078 ms

iter_count = 228, r_2norm = 6.503e-04, tol*||rhs|| = 7.844e-04

Anderson update took 121.428 ms, out of which F'*F took 57.449 ms; b-Ax took 388.626 ms, out of which Lap took 349.256 ms
Solving Poisson took 816.149 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.093010 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.349 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.123173 
Total time for convolution: 	 convolve: 5.104223 
Total time for convolution: 	 convolve: 5.079452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 27829.520 ms, scf error = 1.551e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.157373, lowerbound = -1.061412, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2001.953 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.901 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.531 ms
rank =  0, finding HY took 34.267 ms
rank =  0, distributing HY into block cyclic form took 22.680 ms
rank =  0, finding Y'*HY took 5.225 ms
Rank 0, Project_Hamiltonian used 88.745 ms
Total time for projection: 88.760 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.166 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -1.059365798992641
    last  calculated eigval = 0.057447725742602
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.46086221999392
lambda[   9] =  -0.45273363027987
lambda[  10] =  -0.39131935012696
lambda[  11] =  -0.38933646535259
lambda[  12] =  -0.38716755968600
lambda[  13] =  -0.33121586225503
lambda[  14] =  -0.32241294866584
lambda[  15] =  -0.26846159139422
lambda[  16] =  -0.25831365629082
lambda[  17] =  -0.25398016484425
lambda[  18] =  -0.03122772468724
lambda[  19] =  -0.01103973520157
lambda[  20] =  -0.00165075622875
lambda[  21] =   0.00857533215718
lambda[  22] =   0.01601045626821
lambda[  23] =   0.02060137173299
lambda[  24] =   0.03549378178821
lambda[  25] =   0.05744772574260
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 7.833 ms
rank =  0, Distributing orbital back into band + domain format took 23.210 ms
rank = 0, Subspace_Rotation used 31.058 ms

Total time for subspace rotation: 31.062 ms
rank = 0, Efermi =  -0.060094267733 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 3.456 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.532 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 2126.198 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.610 ms
rank = 0, D2D took 1.716 ms
rank = 0, Transfering density took 1.723 ms
Etot    =   -70.049213205005
Eband   =   -17.696994215456
E1      =    37.120407273624
E2      =   -17.000582349728
E3      =   -22.853511896471
Exc     =   -20.414171421355
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 9.199e-08, dEband = 7.266e-03
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -70.049213205, dEtot = 9.199e-08, dEband = 7.266e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2437721825021, which took 0.050 ms

iter_count = 108, r_2norm = 9.223e-06, tol*||rhs|| = 9.751e-06

Anderson update took 58.114 ms, out of which F'*F took 27.493 ms; b-Ax took 183.797 ms, out of which Lap took 165.744 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.905 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787039, int_b + int_rho = -9.313e-13, checking this took 0.112 ms
2-norm of RHS = 784.3918591936540, which took 0.098 ms

iter_count = 198, r_2norm = 7.538e-04, tol*||rhs|| = 7.844e-04

Anderson update took 105.293 ms, out of which F'*F took 49.910 ms; b-Ax took 338.134 ms, out of which Lap took 303.650 ms
Solving Poisson took 710.346 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.117692 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.572 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.081985 
Total time for convolution: 	 convolve: 5.104346 
Total time for convolution: 	 convolve: 5.096258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.960 ms

This SCF took 27701.138 ms, scf error = 8.424e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.157448, lowerbound = -1.059366, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2002.413 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.633 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.499 ms
rank =  0, finding HY took 34.733 ms
rank =  0, distributing HY into block cyclic form took 22.893 ms
rank =  0, finding Y'*HY took 5.233 ms
Rank 0, Project_Hamiltonian used 89.406 ms
Total time for projection: 89.422 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.162 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.058448496069547
    last  calculated eigval = 0.056750248198715
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45992347594081
lambda[   9] =  -0.45176816159230
lambda[  10] =  -0.39039954444818
lambda[  11] =  -0.38844707646771
lambda[  12] =  -0.38628575554231
lambda[  13] =  -0.33024423519199
lambda[  14] =  -0.32143874486358
lambda[  15] =  -0.26761436509266
lambda[  16] =  -0.25743456811447
lambda[  17] =  -0.25307443908438
lambda[  18] =  -0.03040268636637
lambda[  19] =  -0.01015820109062
lambda[  20] =  -0.00037987602081
lambda[  21] =   0.00956239721632
lambda[  22] =   0.01712057708236
lambda[  23] =   0.02112070082232
lambda[  24] =   0.03426579187155
lambda[  25] =   0.05675024819872
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 7.859 ms
rank =  0, Distributing orbital back into band + domain format took 23.263 ms
rank = 0, Subspace_Rotation used 31.138 ms

Total time for subspace rotation: 31.141 ms
rank = 0, Efermi =  -0.059269229463 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 3.554 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.702 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 2128.196 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
rank = 0, D2D took 0.514 ms
rank = 0, Transfering density took 0.519 ms
Etot    =   -70.049246727153
Eband   =   -17.665596176394
E1      =    37.103609461694
E2      =   -16.985115886126
E3      =   -22.857008708513
Exc     =   -20.416835519076
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 3.352e-06, dEband = 3.140e-03
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -70.049246727, dEtot = 3.352e-06, dEband = 3.140e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1122045439596, which took 0.063 ms

iter_count = 114, r_2norm = 2.845e-06, tol*||rhs|| = 4.488e-06

Anderson update took 61.276 ms, out of which F'*F took 29.096 ms; b-Ax took 194.132 ms, out of which Lap took 175.193 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.097 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787039, int_b + int_rho = -9.313e-13, checking this took 0.092 ms
2-norm of RHS = 784.3824056784014, which took 0.099 ms

iter_count = 204, r_2norm = 7.588e-04, tol*||rhs|| = 7.844e-04

Anderson update took 108.628 ms, out of which F'*F took 51.650 ms; b-Ax took 348.796 ms, out of which Lap took 313.454 ms
Solving Poisson took 731.267 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.083253 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.080934 
Total time for convolution: 	 convolve: 5.082488 
Total time for convolution: 	 convolve: 5.081837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.545 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.282 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.963 ms

This SCF took 27683.264 ms, scf error = 6.176e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.156750, lowerbound = -1.058448, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1998.661 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.873 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.500 ms
rank =  0, finding HY took 34.305 ms
rank =  0, distributing HY into block cyclic form took 22.801 ms
rank =  0, finding Y'*HY took 5.111 ms
Rank 0, Project_Hamiltonian used 88.762 ms
Total time for projection: 88.778 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -1.057163878343565
    last  calculated eigval = 0.057082013485277
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45878120043045
lambda[   9] =  -0.45067931585696
lambda[  10] =  -0.38892268285852
lambda[  11] =  -0.38743988753787
lambda[  12] =  -0.38504980520942
lambda[  13] =  -0.32899409708551
lambda[  14] =  -0.32038311153417
lambda[  15] =  -0.26630740659661
lambda[  16] =  -0.25595025037648
lambda[  17] =  -0.25196736739562
lambda[  18] =  -0.02771318242422
lambda[  19] =  -0.00860713006317
lambda[  20] =   0.00327160527739
lambda[  21] =   0.01283413852361
lambda[  22] =   0.02023059116334
lambda[  23] =   0.02301586041076
lambda[  24] =   0.03513923281468
lambda[  25] =   0.05708201348528
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 8.415 ms
rank =  0, Distributing orbital back into band + domain format took 22.483 ms
rank = 0, Subspace_Rotation used 30.921 ms

Total time for subspace rotation: 30.926 ms
rank = 0, Efermi =  -0.056579725468 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.523 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 2123.236 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.741 ms
rank = 0, Transfering density took 0.748 ms
Etot    =   -70.049307423320
Eband   =   -17.624471083186
E1      =    37.083593519310
E2      =   -16.963429355817
E3      =   -22.859188813725
Exc     =   -20.418498940969
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 6.070e-06, dEband = 4.113e-03
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -70.049307423, dEtot = 6.070e-06, dEband = 4.113e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0723001289301, which took 0.062 ms

iter_count = 108, r_2norm = 2.779e-06, tol*||rhs|| = 2.892e-06

Anderson update took 57.871 ms, out of which F'*F took 27.302 ms; b-Ax took 184.545 ms, out of which Lap took 166.583 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787041, int_b + int_rho = -9.095e-13, checking this took 0.111 ms
2-norm of RHS = 784.3932780814996, which took 0.093 ms

iter_count = 192, r_2norm = 6.959e-04, tol*||rhs|| = 7.844e-04

Anderson update took 101.921 ms, out of which F'*F took 48.850 ms; b-Ax took 328.803 ms, out of which Lap took 294.481 ms
Solving Poisson took 688.596 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.081685 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 59.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.082956 
Total time for convolution: 	 convolve: 5.085571 
Total time for convolution: 	 convolve: 5.097479 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.967 ms

This SCF took 27654.675 ms, scf error = 3.524e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.157082, lowerbound = -1.057164, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2004.037 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.696 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.081 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.816 ms
rank =  0, finding HY took 33.799 ms
rank =  0, distributing HY into block cyclic form took 22.668 ms
rank =  0, finding Y'*HY took 5.240 ms
Rank 0, Project_Hamiltonian used 88.567 ms
Total time for projection: 88.582 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -1.056293889976689
    last  calculated eigval = 0.056242541930060
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45792843025316
lambda[   9] =  -0.44983932113970
lambda[  10] =  -0.38807875245873
lambda[  11] =  -0.38660563396676
lambda[  12] =  -0.38423149619566
lambda[  13] =  -0.32815686227365
lambda[  14] =  -0.31952969331198
lambda[  15] =  -0.26548043524858
lambda[  16] =  -0.25511164673647
lambda[  17] =  -0.25114040011097
lambda[  18] =  -0.02467844957314
lambda[  19] =  -0.00758445703456
lambda[  20] =   0.00581735605223
lambda[  21] =   0.01653927650245
lambda[  22] =   0.02296370887430
lambda[  23] =   0.02491066604904
lambda[  24] =   0.03650466143906
lambda[  25] =   0.05624254193006
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 8.339 ms
rank =  0, Distributing orbital back into band + domain format took 22.752 ms
rank = 0, Subspace_Rotation used 31.114 ms

Total time for subspace rotation: 31.119 ms
rank = 0, Efermi =  -0.053544992672 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 3.474 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.504 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 2128.621 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
rank = 0, D2D took 0.726 ms
rank = 0, Transfering density took 0.734 ms
Etot    =   -70.049372360656
Eband   =   -17.595765872169
E1      =    37.069365904976
E2      =   -16.948513349384
E3      =   -22.861039712676
Exc     =   -20.419976367507
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 6.494e-06, dEband = 2.871e-03
rank = 0, Calculating/Estimating energy took 1.030 ms, Etot = -70.049372361, dEtot = 6.494e-06, dEband = 2.871e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0540597257652, which took 0.064 ms

iter_count = 114, r_2norm = 1.499e-06, tol*||rhs|| = 2.162e-06

Anderson update took 60.930 ms, out of which F'*F took 29.988 ms; b-Ax took 195.198 ms, out of which Lap took 176.034 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.094 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787042, int_b + int_rho = -9.022e-13, checking this took 0.132 ms
2-norm of RHS = 784.3933429014979, which took 0.116 ms

iter_count = 150, r_2norm = 6.284e-04, tol*||rhs|| = 7.844e-04

Anderson update took 79.691 ms, out of which F'*F took 38.031 ms; b-Ax took 255.744 ms, out of which Lap took 229.801 ms
Solving Poisson took 538.549 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.082257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.303 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.082329 
Total time for convolution: 	 convolve: 5.096579 
Total time for convolution: 	 convolve: 5.082309 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.765 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.653 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.962 ms

This SCF took 27503.914 ms, scf error = 2.117e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.156243, lowerbound = -1.056294, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2013.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.569 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.895 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 26.506 ms
rank =  0, finding HY took 34.359 ms
rank =  0, distributing HY into block cyclic form took 22.770 ms
rank =  0, finding Y'*HY took 5.068 ms
Rank 0, Project_Hamiltonian used 88.747 ms
Total time for projection: 88.763 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.163 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.589 ms
rank = 0, Solve_Generalized_EigenProblem used 1.188 ms
    first calculated eigval = -1.056074512050093
    last  calculated eigval = 0.053063507106004
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45773776659762
lambda[   9] =  -0.44966076058892
lambda[  10] =  -0.38788327418662
lambda[  11] =  -0.38642483183886
lambda[  12] =  -0.38403499838730
lambda[  13] =  -0.32795055268766
lambda[  14] =  -0.31934412838043
lambda[  15] =  -0.26527675853932
lambda[  16] =  -0.25490968650363
lambda[  17] =  -0.25094952197191
lambda[  18] =  -0.02386838479478
lambda[  19] =  -0.00734531392216
lambda[  20] =   0.00610017321634
lambda[  21] =   0.01734116073039
lambda[  22] =   0.02345427050480
lambda[  23] =   0.02532435753539
lambda[  24] =   0.03666956482165
lambda[  25] =   0.05306350710600
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.204 ms
rank =  0, subspace rotation using ScaLAPACK took 7.811 ms
rank =  0, Distributing orbital back into band + domain format took 23.157 ms
rank = 0, Subspace_Rotation used 30.988 ms

Total time for subspace rotation: 30.993 ms
rank = 0, Efermi =  -0.052734927938 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.424 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.523 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 2138.865 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.501 ms
rank = 0, D2D took 0.708 ms
rank = 0, Transfering density took 0.717 ms
Etot    =   -70.049400118517
Eband   =   -17.589076842998
E1      =    37.066062516633
E2      =   -16.945065950742
E3      =   -22.861265754096
Exc     =   -20.420168408974
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 2.776e-06, dEband = 6.689e-04
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -70.049400119, dEtot = 2.776e-06, dEband = 6.689e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0392875604887, which took 0.063 ms

iter_count = 108, r_2norm = 1.289e-06, tol*||rhs|| = 1.572e-06

Anderson update took 57.909 ms, out of which F'*F took 27.435 ms; b-Ax took 184.001 ms, out of which Lap took 165.920 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.262 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787036, int_b + int_rho = -9.604e-13, checking this took 0.105 ms
2-norm of RHS = 784.4012601436511, which took 0.098 ms

iter_count = 168, r_2norm = 6.474e-04, tol*||rhs|| = 7.844e-04

Anderson update took 89.022 ms, out of which F'*F took 42.678 ms; b-Ax took 289.978 ms, out of which Lap took 260.706 ms
Solving Poisson took 605.252 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.078789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 56.639 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.206 ms
Total time for convolution: 	 convolve: 5.079901 
Total time for convolution: 	 convolve: 5.086689 
Total time for convolution: 	 convolve: 5.084262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.954 ms

This SCF took 27543.035 ms, scf error = 1.773e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.153064, lowerbound = -1.056075, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2020.429 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.568 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.852 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 27.460 ms
rank =  0, finding HY took 33.476 ms
rank =  0, distributing HY into block cyclic form took 22.806 ms
rank =  0, finding Y'*HY took 5.149 ms
Rank 0, Project_Hamiltonian used 88.934 ms
Total time for projection: 88.947 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.157 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -1.055638742895733
    last  calculated eigval = 0.051229097919764
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45734252806686
lambda[   9] =  -0.44928039600329
lambda[  10] =  -0.38747852480020
lambda[  11] =  -0.38604621310630
lambda[  12] =  -0.38361172844464
lambda[  13] =  -0.32753277817185
lambda[  14] =  -0.31895512912540
lambda[  15] =  -0.26486070622254
lambda[  16] =  -0.25449690020901
lambda[  17] =  -0.25055621158101
lambda[  18] =  -0.02187716818142
lambda[  19] =  -0.00689031495785
lambda[  20] =   0.00622614272592
lambda[  21] =   0.01904843893801
lambda[  22] =   0.02462318285511
lambda[  23] =   0.02637277687721
lambda[  24] =   0.03875679598413
lambda[  25] =   0.05122909791976
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.810 ms
rank =  0, Distributing orbital back into band + domain format took 23.343 ms
rank = 0, Subspace_Rotation used 31.172 ms

Total time for subspace rotation: 31.176 ms
rank = 0, Efermi =  -0.050743711366 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 3.461 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.524 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 2144.991 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.761 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -70.049468774559
Eband   =   -17.575265605963
E1      =    37.059536148241
E2      =   -16.937683776784
E3      =   -22.861532301840
Exc     =   -20.420406307446
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 6.866e-06, dEband = 1.381e-03
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -70.049468775, dEtot = 6.866e-06, dEband = 1.381e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0375107069204, which took 0.109 ms

iter_count = 108, r_2norm = 1.476e-06, tol*||rhs|| = 1.500e-06

Anderson update took 58.253 ms, out of which F'*F took 40.141 ms; b-Ax took 197.313 ms, out of which Lap took 179.034 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 409.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787033, int_b + int_rho = -9.895e-13, checking this took 0.118 ms
2-norm of RHS = 784.4004013179568, which took 0.096 ms

iter_count = 108, r_2norm = 7.416e-04, tol*||rhs|| = 7.844e-04

Anderson update took 57.370 ms, out of which F'*F took 27.144 ms; b-Ax took 184.041 ms, out of which Lap took 165.179 ms
Solving Poisson took 388.154 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.087 ms
Total time for convolution: 	 convolve: 5.091292 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.368 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.082113 
Total time for convolution: 	 convolve: 5.080262 
Total time for convolution: 	 convolve: 5.100349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.019 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.391 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.957 ms

This SCF took 27439.648 ms, scf error = 1.197e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.151229, lowerbound = -1.055639, upperbound = 267.603527

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2000.643 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.888 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.563 ms
rank =  0, finding HY took 34.359 ms
rank =  0, distributing HY into block cyclic form took 22.774 ms
rank =  0, finding Y'*HY took 5.108 ms
Rank 0, Project_Hamiltonian used 88.848 ms
Total time for projection: 88.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -1.055553382235943
    last  calculated eigval = 0.048435634053989
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45726229590413
lambda[   9] =  -0.44920409765532
lambda[  10] =  -0.38739717207012
lambda[  11] =  -0.38597035236931
lambda[  12] =  -0.38353361889505
lambda[  13] =  -0.32744356239644
lambda[  14] =  -0.31887492601045
lambda[  15] =  -0.26477669359640
lambda[  16] =  -0.25441367731603
lambda[  17] =  -0.25047551089700
lambda[  18] =  -0.02159138403204
lambda[  19] =  -0.00681388398031
lambda[  20] =   0.00617540857029
lambda[  21] =   0.01923771748098
lambda[  22] =   0.02474318193615
lambda[  23] =   0.02641392435724
lambda[  24] =   0.03890746818786
lambda[  25] =   0.04843563405399
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 7.789 ms
rank =  0, Distributing orbital back into band + domain format took 23.101 ms
rank = 0, Subspace_Rotation used 30.910 ms

Total time for subspace rotation: 30.913 ms
rank = 0, Efermi =  -0.050457927120 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.433 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.525 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 2124.828 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 0.754 ms
rank = 0, Transfering density took 0.758 ms
Etot    =   -70.049485125568
Eband   =   -17.572490847405
E1      =    37.058069030314
E2      =   -16.936325143357
E3      =   -22.861704401438
Exc     =   -20.420543765256
Esc     =  -108.912549087187
Entropy =    -0.000000000829
dE = 1.635e-06, dEband = 2.775e-04
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -70.049485126, dEtot = 1.635e-06, dEband = 2.775e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0243738732267, which took 0.051 ms

iter_count = 108, r_2norm = 9.415e-07, tol*||rhs|| = 9.750e-07

Anderson update took 57.756 ms, out of which F'*F took 27.588 ms; b-Ax took 183.721 ms, out of which Lap took 165.516 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.694 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002787132, int_rho =  34.00000002787033, int_b + int_rho = -9.895e-13, checking this took 0.107 ms
2-norm of RHS = 784.4031523688312, which took 0.110 ms

iter_count = 144, r_2norm = 6.967e-04, tol*||rhs|| = 7.844e-04

Anderson update took 76.244 ms, out of which F'*F took 36.446 ms; b-Ax took 245.561 ms, out of which Lap took 220.434 ms
Solving Poisson took 518.680 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.077602 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.082825 
Total time for convolution: 	 convolve: 5.087115 
Total time for convolution: 	 convolve: 5.079753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.011 ms
---Transfer Veff_loc: D2D took 1.458 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.287 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.759 ms

This SCF took 27457.187 ms, scf error = 9.816e-05
The last 18 occupations of kpoints #1 are (Nelectron = 34):
lambda[   8] =  -0.45726229590413, occ[   8] =   2.00000000000000
lambda[   9] =  -0.44920409765532, occ[   9] =   2.00000000000000
lambda[  10] =  -0.38739717207012, occ[  10] =   2.00000000000000
lambda[  11] =  -0.38597035236931, occ[  11] =   2.00000000000000
lambda[  12] =  -0.38353361889505, occ[  12] =   2.00000000000000
lambda[  13] =  -0.32744356239644, occ[  13] =   2.00000000000000
lambda[  14] =  -0.31887492601045, occ[  14] =   2.00000000000000
lambda[  15] =  -0.26477669359640, occ[  15] =   2.00000000000000
lambda[  16] =  -0.25441367731603, occ[  16] =   2.00000000000000
lambda[  17] =  -0.25047551089700, occ[  17] =   2.00000000000000
lambda[  18] =  -0.02159138403204, occ[  18] =   0.00000002787037
lambda[  19] =  -0.00681388398031, occ[  19] =   0.00000000000000
lambda[  20] =   0.00617540857029, occ[  20] =   0.00000000000000
lambda[  21] =   0.01923771748098, occ[  21] =   0.00000000000000
lambda[  22] =   0.02474318193615, occ[  22] =   0.00000000000000
lambda[  23] =   0.02641392435724, occ[  23] =   0.00000000000000
lambda[  24] =   0.03890746818786, occ[  24] =   0.00000000000000
lambda[  25] =   0.04843563405399, occ[  25] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 23 (90%) = 0.000000000000000.
Occupation of state 25 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 1.154 ms, time for Allreduce/Reduce: 8.333 ms 
Time for calculating local force components: 23.638 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000015912929  -0.00000194326641  -1.30810078778764
 -0.00000037657354  -0.99627885139609  -0.36713443489801
  0.00000010040618   0.99627760723414  -0.36713629245781
  0.04185770800342  -0.01975644250255   0.02327682082036
 -0.04185776434823  -0.01975646985065   0.02327685127549
 -0.04185776629772   0.01975645329476   0.02327688371607
  0.04185777368161   0.01975648557829   0.02327689068176
  0.00000005232819  -0.00000105767956  -0.10135956809488
 -0.00000061312403   0.01800934481600   0.18711942141752
 -0.00000039085383  -0.01801121984795   0.18712104162918
force_loc = 
  0.00000141935773   0.00000313421534   1.28936196274288
  0.00000188602864   0.96151445011743   0.38919683331539
  0.00000175871713  -0.96151275668096   0.38919647111323
 -0.04487191599220   0.02183713076375  -0.02534469662169
  0.04487200140385   0.02183659228128  -0.02534476895595
  0.04487216807178  -0.02183660935844  -0.02534431256295
 -0.04487134395464  -0.02183682628543  -0.02534460638596
  0.00000048910166   0.00000009404365   0.06001972999881
  0.00000166638364  -0.02446486513688  -0.20218392974223
  0.00000150141165   0.02446428092967  -0.20218438969261
Time for calculating nonlocal force components: 42.765 ms
[32mforces_xc: 
[0m[32m  0.00000006705167   0.00000014335274   0.03001395885796
[0m[32m  0.00000005028855   0.03040240146967   0.01204091062590
[0m[32m  0.00000005560741  -0.03040237442478   0.01204087515202
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000001621634  -0.00000000313956   0.01658213344606
[0m[32m  0.00000011176097   0.00008639423454  -0.00786494516857
[0m[32m  0.00000007442190  -0.00008644293983  -0.00786496000865
[0mTime for calculating XC forces components: 34.830 ms
 Cartesian force = 
  0.00000075671594   0.00000146931945   0.01121582457164
  0.00000067092090  -0.00436186479121   0.03404399980172
  0.00000102590799   0.00436261114619   0.03404174456586
 -0.00301509681152   0.00208082327898  -0.00212718504290
  0.00301334823288   0.00208025744841  -0.00212722692203
  0.00301351295132  -0.00208002104590  -0.00212673808845
 -0.00301445909577  -0.00208020568936  -0.00212702494577
 -0.00000033117656  -0.00000083175768  -0.02481701389158
  0.00000027619784  -0.00636899106856  -0.02298876273485
  0.00000029615698   0.00636675315967  -0.02298761731365
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 384.110 ms
The program took 424.412 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:06
Job ID:        2266526
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:27:36,vmem=8280K,walltime=00:07:18,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-14-2
---------------------------------------
