---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:57
Job ID:    2266475
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266475
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 1.277 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 1.062 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 10.283 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.980 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.108 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.519434	
   10.003286	   14.059020	    9.988089	
    9.996714	    5.940980	    9.988089	
   11.660436	   12.516701	    7.480566	
    8.336616	   12.519608	    7.484860	
    8.339564	    7.483299	    7.480566	
   11.663384	    7.480392	    7.484860	
   10.000000	   10.000000	   10.235517	
   10.000000	   12.437783	    8.716067	
   10.000000	    7.562217	    8.716067	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.192 ms
Set up communicators.

--set up spincomm took 3.844 ms

--set up kptcomm took 0.367 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.057 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.629 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.820 ms.
time spent on vectorized spline interp: 3.130 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.726 ms.
time spent on vectorized spline interp: 1.358 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.311 ms.
time spent on vectorized spline interp: 1.662 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.304 ms.

Calculating rb for all atom types took 16.326 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.061 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000258316, sum_int_rho = 23.3975071331098
PosCharge = 24.000000025832, NegCharge = -23.397507133110, scal_fac = 1.025750302769
After scaling, int_rho = 24.0000000258316, PosCharge + NegCharge - NetCharge = -4.263e-14
--Calculate Vref took 0.558 ms
--Calculate rho_guess took 3.181 ms

 integral of b = -24.0000000258316,
 int{b} + Nelectron + NetCharge = -2.583e-08,
 Esc = -63.7899154909673,
 MPI_Reduce took 6.206 ms

Calculating b & b_ref took 17.075 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.072 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.083 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.081 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.601 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.026 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.535 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583163, int_b + int_rho = -4.729e-14, checking this took 0.626 ms
2-norm of RHS = 751.3716937644078, which took 0.481 ms

iter_count = 420, r_2norm = 6.231e-04, tol*||rhs|| = 7.514e-04

Anderson update took 233.040 ms, out of which F'*F took 106.686 ms; b-Ax took 723.967 ms, out of which Lap took 648.696 ms
Solving Poisson took 1532.969 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.395 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.139422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.492 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
Total time for convolution: 	 convolve: 5.145708 
Total time for convolution: 	 convolve: 5.221035 
Total time for convolution: 	 convolve: 5.243963 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 14.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.479 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, XC calculation took 24709.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 4.843 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.129 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.112 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.683 ms
    Lanczos iter 54, eigmin  = -0.980347433, eigmax = 264.935340067, err_eigmin = 3.456e-03, err_eigmax = 9.795e-03
rank =   0, Lanczos took 122.467 ms, eigmin = -0.980347432760, eigmax = 267.584693467614

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.252173, lowerbound = -1.080347, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1451.771 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.245 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.745 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.007 ms
rank =  0, finding HY took 24.584 ms
rank =  0, distributing HY into block cyclic form took 20.626 ms
rank =  0, finding Y'*HY took 4.049 ms
Rank 0, Project_Hamiltonian used 71.700 ms
Total time for projection: 71.711 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.732 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.823 ms
    first calculated eigval = 2.731336779011817
    last  calculated eigval = 3.247711662015163
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.80738271911518
lambda[   4] =   2.83663409153006
lambda[   5] =   2.86118820798314
lambda[   6] =   2.89901616176199
lambda[   7] =   2.91965037609383
lambda[   8] =   2.97636150778986
lambda[   9] =   2.98984949476510
lambda[  10] =   2.99287016259290
lambda[  11] =   3.01908993592943
lambda[  12] =   3.03083875019160
lambda[  13] =   3.08103185748304
lambda[  14] =   3.12701526159697
lambda[  15] =   3.14009311713897
lambda[  16] =   3.15689900937245
lambda[  17] =   3.18118047935675
lambda[  18] =   3.20629815962843
lambda[  19] =   3.24771166201516
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.841 ms
rank =  0, subspace rotation using ScaLAPACK took 6.921 ms
rank =  0, Distributing orbital back into band + domain format took 17.374 ms
rank = 0, Subspace_Rotation used 24.307 ms

Total time for subspace rotation: 24.310 ms
rank = 0, Efermi =   3.055945042473 calculate fermi energy took 0.041 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.347712, lowerbound = -1.080347, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1403.550 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.141 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.691 ms
rank =  0, finding HY took 23.938 ms
rank =  0, distributing HY into block cyclic form took 17.232 ms
rank =  0, finding Y'*HY took 3.668 ms
Rank 0, Project_Hamiltonian used 64.549 ms
Total time for projection: 64.553 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.860373480144100
    last  calculated eigval = 0.437908163747674
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.46006116392735
lambda[   4] =  -0.24942316701931
lambda[   5] =  -0.16958423289654
lambda[   6] =  -0.09899175790338
lambda[   7] =  -0.06177157254694
lambda[   8] =   0.00630746151524
lambda[   9] =   0.08340858782351
lambda[  10] =   0.13486249248598
lambda[  11] =   0.20091029169808
lambda[  12] =   0.29442927620497
lambda[  13] =   0.33343513228346
lambda[  14] =   0.35145665100066
lambda[  15] =   0.36485432826425
lambda[  16] =   0.37435066151878
lambda[  17] =   0.39752734860366
lambda[  18] =   0.41210996697298
lambda[  19] =   0.43790816374767
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 6.889 ms
rank =  0, Distributing orbital back into band + domain format took 17.034 ms
rank = 0, Subspace_Rotation used 23.933 ms

Total time for subspace rotation: 23.937 ms
rank = 0, Efermi =   0.313932300373 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.537908, lowerbound = -1.080347, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1401.463 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.155 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.650 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.821 ms
rank =  0, finding HY took 23.962 ms
rank =  0, distributing HY into block cyclic form took 17.194 ms
rank =  0, finding Y'*HY took 3.623 ms
Rank 0, Project_Hamiltonian used 65.555 ms
Total time for projection: 65.559 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.009522074194612
    last  calculated eigval = 0.144976922332754
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.75874011995154
lambda[   4] =  -0.56594023562463
lambda[   5] =  -0.49872574870901
lambda[   6] =  -0.49772927506305
lambda[   7] =  -0.48889652507916
lambda[   8] =  -0.46340259323639
lambda[   9] =  -0.43584844660269
lambda[  10] =  -0.41467774062080
lambda[  11] =  -0.32469972682027
lambda[  12] =  -0.20722679431409
lambda[  13] =   0.02387873561288
lambda[  14] =   0.07711949274333
lambda[  15] =   0.08334122480717
lambda[  16] =   0.09741858285781
lambda[  17] =   0.11136200718133
lambda[  18] =   0.13135491884134
lambda[  19] =   0.14497692233275
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 6.857 ms
rank =  0, Distributing orbital back into band + domain format took 17.230 ms
rank = 0, Subspace_Rotation used 24.098 ms

Total time for subspace rotation: 24.102 ms
rank = 0, Efermi =  -0.005056698995 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.244977, lowerbound = -1.080347, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1402.503 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.535 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.700 ms
rank =  0, finding HY took 23.906 ms
rank =  0, distributing HY into block cyclic form took 17.119 ms
rank =  0, finding Y'*HY took 3.684 ms
Rank 0, Project_Hamiltonian used 64.435 ms
Total time for projection: 64.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.009684915220217
    last  calculated eigval = 0.100487315619420
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.76014980890557
lambda[   4] =  -0.56928998826739
lambda[   5] =  -0.50431021112367
lambda[   6] =  -0.50297522688719
lambda[   7] =  -0.49804494563889
lambda[   8] =  -0.46912234964338
lambda[   9] =  -0.44233259791082
lambda[  10] =  -0.42953595665072
lambda[  11] =  -0.36087656647566
lambda[  12] =  -0.27482150562858
lambda[  13] =  -0.06549638395791
lambda[  14] =   0.00878999762536
lambda[  15] =   0.04069659317340
lambda[  16] =   0.04645005042262
lambda[  17] =   0.05288743775716
lambda[  18] =   0.07032656472565
lambda[  19] =   0.10048731561942
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 6.889 ms
rank =  0, Distributing orbital back into band + domain format took 17.183 ms
rank = 0, Subspace_Rotation used 25.021 ms

Total time for subspace rotation: 25.026 ms
rank = 0, Efermi =  -0.094431818576 calculate fermi energy took 0.022 ms
rank = 0, --- Calculate rho: sum over local bands took 5.173 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.484 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 6165.674 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.823 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -38.315353701693
Eband   =   -13.241993004194
E1      =    26.867011585673
E2      =   -10.329960452913
E3      =   -13.723483119595
Exc     =   -12.203900363942
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 3.832e+00, dEband = 1.324e+00
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -38.315353702, dEtot = 3.832e+00, dEband = 1.324e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 54.1221913013663, which took 0.765 ms

iter_count = 96, r_2norm = 1.605e-03, tol*||rhs|| = 2.165e-03

Anderson update took 50.920 ms, out of which F'*F took 23.918 ms; b-Ax took 162.527 ms, out of which Lap took 145.116 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.595 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583165, int_b + int_rho = -2.547e-14, checking this took 0.116 ms
2-norm of RHS = 747.3578786055808, which took 0.220 ms

iter_count = 282, r_2norm = 6.839e-04, tol*||rhs|| = 7.474e-04

Anderson update took 149.580 ms, out of which F'*F took 70.003 ms; b-Ax took 479.369 ms, out of which Lap took 427.681 ms
Solving Poisson took 1010.581 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.253006 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.230405 
Total time for convolution: 	 convolve: 5.164961 
Total time for convolution: 	 convolve: 5.166254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 3.768 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.797 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.598 ms

This SCF took 32365.484 ms, scf error = 1.757e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.200487, lowerbound = -1.009685, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1414.460 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.095 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.516 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.625 ms
rank =  0, finding HY took 24.113 ms
rank =  0, distributing HY into block cyclic form took 19.418 ms
rank =  0, finding Y'*HY took 3.577 ms
Rank 0, Project_Hamiltonian used 66.760 ms
Total time for projection: 66.770 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.995940872358148
    last  calculated eigval = 0.072543090631958
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.72329223586633
lambda[   4] =  -0.54343260945268
lambda[   5] =  -0.47679224916835
lambda[   6] =  -0.47489339611904
lambda[   7] =  -0.46720284327846
lambda[   8] =  -0.43467519022626
lambda[   9] =  -0.41077162919546
lambda[  10] =  -0.40723246270387
lambda[  11] =  -0.35011331837259
lambda[  12] =  -0.25330765470483
lambda[  13] =  -0.08217944342878
lambda[  14] =  -0.02242076698700
lambda[  15] =   0.01803648020277
lambda[  16] =   0.03013512327752
lambda[  17] =   0.03338157542181
lambda[  18] =   0.04272889384271
lambda[  19] =   0.07254309063196
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.921 ms
rank =  0, Distributing orbital back into band + domain format took 16.754 ms
rank = 0, Subspace_Rotation used 24.690 ms

Total time for subspace rotation: 24.712 ms
rank = 0, Efermi =  -0.111114877984 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.268 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.234 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.609 ms
rank = 0, Calculating density took 1522.835 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.903 ms
rank = 0, Transfering density took 1.904 ms
Etot    =   -38.248318565516
Eband   =   -12.612926465953
E1      =    26.306701292633
E2      =   -10.294883744190
E3      =   -13.900591091758
Exc     =   -12.347652736408
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 6.704e-03, dEband = 6.291e-02
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -38.248318566, dEtot = 6.704e-03, dEband = 6.291e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 25.6292577547758, which took 0.128 ms

iter_count = 102, r_2norm = 6.230e-04, tol*||rhs|| = 1.025e-03

Anderson update took 54.643 ms, out of which F'*F took 25.572 ms; b-Ax took 172.879 ms, out of which Lap took 154.275 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.243 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583171, int_b + int_rho = 3.274e-14, checking this took 0.097 ms
2-norm of RHS = 742.2789130003471, which took 0.132 ms

iter_count = 294, r_2norm = 7.100e-04, tol*||rhs|| = 7.423e-04

Anderson update took 157.656 ms, out of which F'*F took 73.061 ms; b-Ax took 498.546 ms, out of which Lap took 445.023 ms
Solving Poisson took 1053.236 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.211661 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.236368 
Total time for convolution: 	 convolve: 5.206386 
Total time for convolution: 	 convolve: 5.255515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.113 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.702 ms

This SCF took 27901.858 ms, scf error = 1.197e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.172543, lowerbound = -0.995941, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1438.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.174 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.870 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.056 ms
rank =  0, finding HY took 25.252 ms
rank =  0, distributing HY into block cyclic form took 17.341 ms
rank =  0, finding Y'*HY took 3.820 ms
Rank 0, Project_Hamiltonian used 66.495 ms
Total time for projection: 66.505 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -0.976597480051522
    last  calculated eigval = 0.056311977044089
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66746591893410
lambda[   4] =  -0.50094299523363
lambda[   5] =  -0.43441555042042
lambda[   6] =  -0.43429823105346
lambda[   7] =  -0.42399558587640
lambda[   8] =  -0.38213522497104
lambda[   9] =  -0.37245535537297
lambda[  10] =  -0.36050201681440
lambda[  11] =  -0.33227958710711
lambda[  12] =  -0.22371484984572
lambda[  13] =  -0.07301553304762
lambda[  14] =  -0.03222886197986
lambda[  15] =   0.01194503343391
lambda[  16] =   0.02147149893352
lambda[  17] =   0.02342326931693
lambda[  18] =   0.03709338184091
lambda[  19] =   0.05631197704409
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 7.990 ms
rank =  0, Distributing orbital back into band + domain format took 16.838 ms
rank = 0, Subspace_Rotation used 24.844 ms

Total time for subspace rotation: 24.850 ms
rank = 0, Efermi =  -0.101950967652 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.361 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.273 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1547.824 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -38.200866584273
Eband   =   -11.660290484825
E1      =    25.478970050211
E2      =   -10.158321231422
E3      =   -14.210551799141
Exc     =   -12.598503688484
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 4.745e-03, dEband = 9.526e-02
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -38.200866584, dEtot = 4.745e-03, dEband = 9.526e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 8.1084636960732, which took 0.539 ms

iter_count = 102, r_2norm = 2.375e-04, tol*||rhs|| = 3.243e-04

Anderson update took 54.463 ms, out of which F'*F took 25.384 ms; b-Ax took 173.956 ms, out of which Lap took 154.245 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.624 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583174, int_b + int_rho = 6.912e-14, checking this took 0.106 ms
2-norm of RHS = 741.4348538430196, which took 0.140 ms

iter_count = 276, r_2norm = 5.912e-04, tol*||rhs|| = 7.414e-04

Anderson update took 150.375 ms, out of which F'*F took 68.759 ms; b-Ax took 469.574 ms, out of which Lap took 418.700 ms
Solving Poisson took 994.294 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.178924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.983 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.259328 
Total time for convolution: 	 convolve: 5.199396 
Total time for convolution: 	 convolve: 5.278997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.541 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.134 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.706 ms

This SCF took 27883.728 ms, scf error = 4.604e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.156312, lowerbound = -0.976597, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1442.159 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.176 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.597 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.790 ms
rank =  0, finding HY took 23.838 ms
rank =  0, distributing HY into block cyclic form took 17.202 ms
rank =  0, finding Y'*HY took 3.578 ms
Rank 0, Project_Hamiltonian used 64.440 ms
Total time for projection: 65.516 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.750 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.270 ms
rank = 0, Solve_Generalized_EigenProblem used 1.025 ms
    first calculated eigval = -0.966336426901726
    last  calculated eigval = 0.046360189886720
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.65223184305500
lambda[   4] =  -0.48650069711746
lambda[   5] =  -0.42191219416034
lambda[   6] =  -0.42031533852598
lambda[   7] =  -0.41076420001393
lambda[   8] =  -0.36730129274176
lambda[   9] =  -0.35945513606888
lambda[  10] =  -0.34497802235125
lambda[  11] =  -0.32378908772393
lambda[  12] =  -0.21405581769142
lambda[  13] =  -0.06411651573927
lambda[  14] =  -0.03495916738464
lambda[  15] =   0.01002465003774
lambda[  16] =   0.01739604580703
lambda[  17] =   0.01912429818700
lambda[  18] =   0.03123174913580
lambda[  19] =   0.04636018988672
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.041 ms
rank =  0, subspace rotation using ScaLAPACK took 7.266 ms
rank =  0, Distributing orbital back into band + domain format took 16.799 ms
rank = 0, Subspace_Rotation used 24.101 ms

Total time for subspace rotation: 24.105 ms
rank = 0, Efermi =  -0.093051950294 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.335 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.590 ms
rank = 0, Calculating density took 1550.163 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.053 ms
rank = 0, D2D took 2.162 ms
rank = 0, Transfering density took 2.169 ms
Etot    =   -38.194684134143
Eband   =   -11.349296308065
E1      =    25.245517710894
E2      =   -10.061955339972
E3      =   -14.326816311243
Exc     =   -12.689761696450
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 6.182e-04, dEband = 3.110e-02
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -38.194684134, dEtot = 6.182e-04, dEband = 3.110e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.0692571153934, which took 0.061 ms

iter_count = 108, r_2norm = 7.159e-05, tol*||rhs|| = 8.277e-05

Anderson update took 57.319 ms, out of which F'*F took 26.906 ms; b-Ax took 183.307 ms, out of which Lap took 163.352 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.278 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583155, int_b + int_rho = -1.273e-13, checking this took 0.115 ms
2-norm of RHS = 741.5565381919376, which took 0.150 ms

iter_count = 258, r_2norm = 6.459e-04, tol*||rhs|| = 7.416e-04

Anderson update took 138.101 ms, out of which F'*F took 63.429 ms; b-Ax took 433.169 ms, out of which Lap took 386.711 ms
Solving Poisson took 927.327 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.180069 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.701 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.165767 
Total time for convolution: 	 convolve: 5.240893 
Total time for convolution: 	 convolve: 5.174732 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 3.538 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.529 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.104 ms

This SCF took 27765.991 ms, scf error = 1.740e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.146360, lowerbound = -0.966336, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1433.162 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 62.966 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.079 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.453 ms
rank =  0, finding HY took 23.449 ms
rank =  0, distributing HY into block cyclic form took 17.143 ms
rank =  0, finding Y'*HY took 3.913 ms
Rank 0, Project_Hamiltonian used 110.987 ms
Total time for projection: 111.011 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.958943234626895
    last  calculated eigval = 0.039665946089354
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.64626202229889
lambda[   4] =  -0.47979125066122
lambda[   5] =  -0.41622138839478
lambda[   6] =  -0.41380797424616
lambda[   7] =  -0.40382947718451
lambda[   8] =  -0.36133782521630
lambda[   9] =  -0.35251502950537
lambda[  10] =  -0.33827129626741
lambda[  11] =  -0.31776354880609
lambda[  12] =  -0.20759876942168
lambda[  13] =  -0.05819284593507
lambda[  14] =  -0.03540720426683
lambda[  15] =   0.00962683159855
lambda[  16] =   0.01514418182952
lambda[  17] =   0.01784677152063
lambda[  18] =   0.02611931407728
lambda[  19] =   0.03966594608935
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 7.261 ms
rank =  0, Distributing orbital back into band + domain format took 16.707 ms
rank = 0, Subspace_Rotation used 23.980 ms

Total time for subspace rotation: 23.984 ms
rank = 0, Efermi =  -0.087128280509 calculate fermi energy took 0.544 ms
rank = 0, --- Calculate rho: sum over local bands took 5.336 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.407 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1585.287 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.808 ms
rank = 0, D2D took 1.917 ms
rank = 0, Transfering density took 1.922 ms
Etot    =   -38.193195715085
Eband   =   -11.194542876615
E1      =    25.153227857449
E2      =    -9.987381477355
E3      =   -14.381236159886
Exc     =   -12.730582841422
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 1.488e-04, dEband = 1.548e-02
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -38.193195715, dEtot = 1.488e-04, dEband = 1.548e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5667490550073, which took 0.107 ms

iter_count = 108, r_2norm = 3.927e-05, tol*||rhs|| = 6.267e-05

Anderson update took 58.196 ms, out of which F'*F took 26.730 ms; b-Ax took 181.837 ms, out of which Lap took 162.098 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.300 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583151, int_b + int_rho = -1.601e-13, checking this took 0.104 ms
2-norm of RHS = 741.9997122089459, which took 0.107 ms

iter_count = 240, r_2norm = 6.588e-04, tol*||rhs|| = 7.420e-04

Anderson update took 127.796 ms, out of which F'*F took 60.149 ms; b-Ax took 409.655 ms, out of which Lap took 366.029 ms
Solving Poisson took 861.806 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.110 ms
Total time for convolution: 	 convolve: 5.202408 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.217777 
Total time for convolution: 	 convolve: 5.280287 
Total time for convolution: 	 convolve: 5.181323 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 3.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.234 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.852 ms

This SCF took 27761.758 ms, scf error = 6.126e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.139666, lowerbound = -0.958943, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1445.071 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.145 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.571 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.731 ms
rank =  0, finding HY took 23.768 ms
rank =  0, distributing HY into block cyclic form took 17.090 ms
rank =  0, finding Y'*HY took 3.536 ms
Rank 0, Project_Hamiltonian used 64.148 ms
Total time for projection: 64.158 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.956546114622756
    last  calculated eigval = 0.035801530566093
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.64329144041148
lambda[   4] =  -0.47714823988411
lambda[   5] =  -0.41374968507205
lambda[   6] =  -0.41116393633780
lambda[   7] =  -0.40086882208932
lambda[   8] =  -0.35860602746256
lambda[   9] =  -0.34973814421920
lambda[  10] =  -0.33533721195917
lambda[  11] =  -0.31513680083948
lambda[  12] =  -0.20469836902707
lambda[  13] =  -0.05618873913366
lambda[  14] =  -0.03507723021134
lambda[  15] =   0.00992047223876
lambda[  16] =   0.01433667949033
lambda[  17] =   0.01764125944213
lambda[  18] =   0.02261270823239
lambda[  19] =   0.03580153056609
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 7.269 ms
rank =  0, Distributing orbital back into band + domain format took 16.715 ms
rank = 0, Subspace_Rotation used 23.994 ms

Total time for subspace rotation: 23.998 ms
rank = 0, Efermi =  -0.085124173712 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.369 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.392 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1549.945 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.865 ms
rank = 0, D2D took 1.964 ms
rank = 0, Transfering density took 1.967 ms
Etot    =   -38.192894087405
Eband   =   -11.128745639179
E1      =    25.128021024986
E2      =    -9.943234727769
E3      =   -14.392315498060
Exc     =   -12.737804207304
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 3.016e-05, dEband = 6.580e-03
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -38.192894087, dEtot = 3.016e-05, dEband = 6.580e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5418383653112, which took 0.051 ms

iter_count = 108, r_2norm = 1.941e-05, tol*||rhs|| = 2.167e-05

Anderson update took 57.773 ms, out of which F'*F took 26.700 ms; b-Ax took 182.604 ms, out of which Lap took 162.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.718 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583169, int_b + int_rho = 1.091e-14, checking this took 0.099 ms
2-norm of RHS = 742.2608475497162, which took 0.073 ms

iter_count = 234, r_2norm = 6.753e-04, tol*||rhs|| = 7.423e-04

Anderson update took 124.654 ms, out of which F'*F took 58.667 ms; b-Ax took 399.424 ms, out of which Lap took 358.803 ms
Solving Poisson took 843.494 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.172479 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.162836 
Total time for convolution: 	 convolve: 5.170163 
Total time for convolution: 	 convolve: 5.176632 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.997 ms
---Transfer Veff_loc: D2D took 7.579 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.979 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.594 ms

This SCF took 27578.630 ms, scf error = 3.316e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135802, lowerbound = -0.956546, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.001 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.508 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.675 ms
rank =  0, finding HY took 23.793 ms
rank =  0, distributing HY into block cyclic form took 17.182 ms
rank =  0, finding Y'*HY took 3.565 ms
Rank 0, Project_Hamiltonian used 64.237 ms
Total time for projection: 64.248 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.954180271838408
    last  calculated eigval = 0.034404565492473
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.64012316763070
lambda[   4] =  -0.47419536924170
lambda[   5] =  -0.41107477786401
lambda[   6] =  -0.40821478688852
lambda[   7] =  -0.39798278052276
lambda[   8] =  -0.35572002514111
lambda[   9] =  -0.34697376563073
lambda[  10] =  -0.33221605529819
lambda[  11] =  -0.31279853171081
lambda[  12] =  -0.20219399400377
lambda[  13] =  -0.05384719415196
lambda[  14] =  -0.03423043070048
lambda[  15] =   0.01081204319137
lambda[  16] =   0.01483777927534
lambda[  17] =   0.01806082462008
lambda[  18] =   0.02084896365057
lambda[  19] =   0.03440456549247
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 7.254 ms
rank =  0, Distributing orbital back into band + domain format took 16.683 ms
rank = 0, Subspace_Rotation used 23.947 ms

Total time for subspace rotation: 23.951 ms
rank = 0, Efermi =  -0.082782628773 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.397 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.440 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 1544.960 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.926 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -38.192717611831
Eband   =   -11.061287245488
E1      =    25.096053489538
E2      =    -9.904118901866
E3      =   -14.405217540297
Exc     =   -12.746904806306
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 1.765e-05, dEband = 6.746e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -38.192717612, dEtot = 1.765e-05, dEband = 6.746e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2019811460105, which took 0.059 ms

iter_count = 114, r_2norm = 5.377e-06, tol*||rhs|| = 8.079e-06

Anderson update took 60.867 ms, out of which F'*F took 28.486 ms; b-Ax took 192.104 ms, out of which Lap took 172.061 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.422 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583166, int_b + int_rho = -1.091e-14, checking this took 0.100 ms
2-norm of RHS = 742.3018295892592, which took 0.109 ms

iter_count = 228, r_2norm = 7.408e-04, tol*||rhs|| = 7.423e-04

Anderson update took 122.760 ms, out of which F'*F took 56.949 ms; b-Ax took 391.350 ms, out of which Lap took 348.174 ms
Solving Poisson took 829.478 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.164856 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.177686 
Total time for convolution: 	 convolve: 5.160172 
Total time for convolution: 	 convolve: 5.164528 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.119 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 3.506 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.074 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.625 ms

This SCF took 27626.589 ms, scf error = 1.784e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134405, lowerbound = -0.954180, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.171 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.092 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.521 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.627 ms
rank =  0, finding HY took 23.987 ms
rank =  0, distributing HY into block cyclic form took 17.063 ms
rank =  0, finding Y'*HY took 3.594 ms
Rank 0, Project_Hamiltonian used 64.298 ms
Total time for projection: 64.309 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.950900961940416
    last  calculated eigval = 0.035034585609558
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63715259852351
lambda[   4] =  -0.47111233761739
lambda[   5] =  -0.40834691752106
lambda[   6] =  -0.40515403105105
lambda[   7] =  -0.39494849058606
lambda[   8] =  -0.35307085752714
lambda[   9] =  -0.34395470399578
lambda[  10] =  -0.32928411362544
lambda[  11] =  -0.30996970722623
lambda[  12] =  -0.19908228787803
lambda[  13] =  -0.05097004039361
lambda[  14] =  -0.03215425497740
lambda[  15] =   0.01332169801358
lambda[  16] =   0.01751367787547
lambda[  17] =   0.01975282285863
lambda[  18] =   0.02136774984234
lambda[  19] =   0.03503458560956
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.272 ms
rank =  0, Distributing orbital back into band + domain format took 16.701 ms
rank = 0, Subspace_Rotation used 23.985 ms

Total time for subspace rotation: 23.989 ms
rank = 0, Efermi =  -0.079905474936 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.527 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.240 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.562 ms
rank = 0, Calculating density took 1545.193 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.926 ms
Etot    =   -38.192690764493
Eband   =   -10.989805839069
E1      =    25.058202748533
E2      =    -9.868034354605
E3      =   -14.414669957259
Exc     =   -12.753876494083
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 2.685e-06, dEband = 7.148e-03
rank = 0, Calculating/Estimating energy took 1.312 ms, Etot = -38.192690764, dEtot = 2.685e-06, dEband = 7.148e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1615930590874, which took 0.119 ms

iter_count = 114, r_2norm = 4.472e-06, tol*||rhs|| = 6.464e-06

Anderson update took 60.949 ms, out of which F'*F took 28.842 ms; b-Ax took 195.787 ms, out of which Lap took 175.868 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.742 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583164, int_b + int_rho = -3.638e-14, checking this took 0.155 ms
2-norm of RHS = 742.3122025194301, which took 0.127 ms

iter_count = 198, r_2norm = 6.445e-04, tol*||rhs|| = 7.423e-04

Anderson update took 105.433 ms, out of which F'*F took 53.412 ms; b-Ax took 340.907 ms, out of which Lap took 305.822 ms
Solving Poisson took 717.027 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.258798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.170082 
Total time for convolution: 	 convolve: 5.178842 
Total time for convolution: 	 convolve: 5.166229 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.852 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.166 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.706 ms

This SCF took 27501.097 ms, scf error = 9.313e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135035, lowerbound = -0.950901, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1454.572 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.095 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.589 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.700 ms
rank =  0, finding HY took 23.828 ms
rank =  0, distributing HY into block cyclic form took 17.108 ms
rank =  0, finding Y'*HY took 3.542 ms
Rank 0, Project_Hamiltonian used 64.216 ms
Total time for projection: 64.227 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.950146101691289
    last  calculated eigval = 0.035107689829825
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63664412285833
lambda[   4] =  -0.47053680865200
lambda[   5] =  -0.40778154297917
lambda[   6] =  -0.40457616618089
lambda[   7] =  -0.39431905535139
lambda[   8] =  -0.35256442330743
lambda[   9] =  -0.34332226230298
lambda[  10] =  -0.32873242579140
lambda[  11] =  -0.30926516601105
lambda[  12] =  -0.19836884598350
lambda[  13] =  -0.05028145650366
lambda[  14] =  -0.03092272093766
lambda[  15] =   0.01467934994221
lambda[  16] =   0.01865022336921
lambda[  17] =   0.02076284514865
lambda[  18] =   0.02193264938387
lambda[  19] =   0.03510768982982
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.289 ms
rank =  0, Distributing orbital back into band + domain format took 16.721 ms
rank = 0, Subspace_Rotation used 24.020 ms

Total time for subspace rotation: 24.025 ms
rank = 0, Efermi =  -0.079216891171 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.346 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.370 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 1559.454 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.757 ms
rank = 0, D2D took 2.867 ms
rank = 0, Transfering density took 2.874 ms
Etot    =   -38.192718405791
Eband   =   -10.975302972832
E1      =    25.052366253942
E2      =    -9.859195897109
E3      =   -14.415071079812
Exc     =   -12.754133172084
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 2.764e-06, dEband = 1.450e-03
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -38.192718406, dEtot = 2.764e-06, dEband = 1.450e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0836619097945, which took 0.413 ms

iter_count = 108, r_2norm = 3.342e-06, tol*||rhs|| = 3.346e-06

Anderson update took 57.630 ms, out of which F'*F took 27.045 ms; b-Ax took 182.853 ms, out of which Lap took 164.289 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.923 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583158, int_b + int_rho = -9.459e-14, checking this took 0.127 ms
2-norm of RHS = 742.2929716967255, which took 0.334 ms

iter_count = 204, r_2norm = 7.368e-04, tol*||rhs|| = 7.423e-04

Anderson update took 109.614 ms, out of which F'*F took 51.109 ms; b-Ax took 343.297 ms, out of which Lap took 308.561 ms
Solving Poisson took 731.875 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.203949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.165890 
Total time for convolution: 	 convolve: 5.202900 
Total time for convolution: 	 convolve: 5.160968 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.122 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.886 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.059 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.593 ms

This SCF took 27448.610 ms, scf error = 6.904e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.135108, lowerbound = -0.950146, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1431.398 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.102 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.527 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.644 ms
rank =  0, finding HY took 24.464 ms
rank =  0, distributing HY into block cyclic form took 17.233 ms
rank =  0, finding Y'*HY took 3.547 ms
Rank 0, Project_Hamiltonian used 64.919 ms
Total time for projection: 64.931 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.948885558585584
    last  calculated eigval = 0.036942693711720
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63529234599444
lambda[   4] =  -0.46923075803664
lambda[   5] =  -0.40651121023811
lambda[   6] =  -0.40326158216874
lambda[   7] =  -0.39300497333818
lambda[   8] =  -0.35126575740130
lambda[   9] =  -0.34202597192759
lambda[  10] =  -0.32738468754695
lambda[  11] =  -0.30802298644997
lambda[  12] =  -0.19707936101450
lambda[  13] =  -0.04897096996331
lambda[  14] =  -0.02717600935977
lambda[  15] =   0.01940463112404
lambda[  16] =   0.02200555566154
lambda[  17] =   0.02485296781549
lambda[  18] =   0.02547917336039
lambda[  19] =   0.03694269371172
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.260 ms
rank =  0, Distributing orbital back into band + domain format took 17.123 ms
rank = 0, Subspace_Rotation used 24.395 ms

Total time for subspace rotation: 24.400 ms
rank = 0, Efermi =  -0.077906404479 calculate fermi energy took 0.628 ms
rank = 0, --- Calculate rho: sum over local bands took 5.239 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.504 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1538.408 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.817 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -38.192740810418
Eband   =   -10.944072039686
E1      =    25.036389107504
E2      =    -9.843388077675
E3      =   -14.417763475746
Exc     =   -12.756293939919
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 2.240e-06, dEband = 3.123e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -38.192740810, dEtot = 2.240e-06, dEband = 3.123e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0611710016259, which took 0.071 ms

iter_count = 108, r_2norm = 2.182e-06, tol*||rhs|| = 2.447e-06

Anderson update took 58.117 ms, out of which F'*F took 27.139 ms; b-Ax took 183.808 ms, out of which Lap took 165.725 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.511 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583164, int_b + int_rho = -3.274e-14, checking this took 0.102 ms
2-norm of RHS = 742.3022548937089, which took 0.130 ms

iter_count = 186, r_2norm = 5.941e-04, tol*||rhs|| = 7.423e-04

Anderson update took 99.429 ms, out of which F'*F took 46.642 ms; b-Ax took 328.428 ms, out of which Lap took 296.295 ms
Solving Poisson took 684.275 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.171798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.178826 
Total time for convolution: 	 convolve: 5.170668 
Total time for convolution: 	 convolve: 5.164263 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.748 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.168 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.694 ms

This SCF took 27535.780 ms, scf error = 3.715e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136943, lowerbound = -0.948886, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1437.553 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.201 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.535 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.753 ms
rank =  0, finding HY took 23.916 ms
rank =  0, distributing HY into block cyclic form took 17.139 ms
rank =  0, finding Y'*HY took 3.660 ms
Rank 0, Project_Hamiltonian used 64.496 ms
Total time for projection: 64.508 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.948115480459126
    last  calculated eigval = 0.038108009102032
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63454653295962
lambda[   4] =  -0.46848410398896
lambda[   5] =  -0.40578889255891
lambda[   6] =  -0.40251343804943
lambda[   7] =  -0.39225704503056
lambda[   8] =  -0.35056970413682
lambda[   9] =  -0.34129083377630
lambda[  10] =  -0.32664874920839
lambda[  11] =  -0.30728126258709
lambda[  12] =  -0.19632126930979
lambda[  13] =  -0.04820237772243
lambda[  14] =  -0.02423743856661
lambda[  15] =   0.02318908764532
lambda[  16] =   0.02410780187815
lambda[  17] =   0.02785920484527
lambda[  18] =   0.02925843265248
lambda[  19] =   0.03810800910203
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 7.746 ms
rank =  0, Distributing orbital back into band + domain format took 16.711 ms
rank = 0, Subspace_Rotation used 24.469 ms

Total time for subspace rotation: 24.475 ms
rank = 0, Efermi =  -0.077137812351 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.363 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.360 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1543.633 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.839 ms
rank = 0, D2D took 1.939 ms
rank = 0, Transfering density took 1.944 ms
Etot    =   -38.192803238902
Eband   =   -10.926246517311
E1      =    25.027273938757
E2      =    -9.834338582220
E3      =   -14.419234949759
Exc     =   -12.757488700590
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 6.243e-06, dEband = 1.783e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -38.192803239, dEtot = 6.243e-06, dEband = 1.783e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0580891317022, which took 0.051 ms

iter_count = 108, r_2norm = 1.524e-06, tol*||rhs|| = 2.324e-06

Anderson update took 57.792 ms, out of which F'*F took 26.938 ms; b-Ax took 182.789 ms, out of which Lap took 163.743 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.854 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583159, int_b + int_rho = -8.367e-14, checking this took 0.099 ms
2-norm of RHS = 742.3110192386310, which took 0.127 ms

iter_count = 162, r_2norm = 6.622e-04, tol*||rhs|| = 7.423e-04

Anderson update took 86.836 ms, out of which F'*F took 40.377 ms; b-Ax took 272.347 ms, out of which Lap took 244.816 ms
Solving Poisson took 580.677 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.183199 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.165992 
Total time for convolution: 	 convolve: 5.161190 
Total time for convolution: 	 convolve: 5.183498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.507 ms

This SCF took 27213.763 ms, scf error = 2.222e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.138108, lowerbound = -0.948115, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1444.872 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.152 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.711 ms
rank =  0, finding HY took 23.731 ms
rank =  0, distributing HY into block cyclic form took 17.221 ms
rank =  0, finding Y'*HY took 3.670 ms
Rank 0, Project_Hamiltonian used 64.364 ms
Total time for projection: 64.377 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.948017784843360
    last  calculated eigval = 0.038695321272063
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63439393060278
lambda[   4] =  -0.46833821332349
lambda[   5] =  -0.40562960871012
lambda[   6] =  -0.40236853723215
lambda[   7] =  -0.39211402862778
lambda[   8] =  -0.35040820779188
lambda[   9] =  -0.34115667923519
lambda[  10] =  -0.32648874468265
lambda[  11] =  -0.30714469448002
lambda[  12] =  -0.19621326051981
lambda[  13] =  -0.04803745261979
lambda[  14] =  -0.02271761262464
lambda[  15] =   0.02450067726600
lambda[  16] =   0.02514199375023
lambda[  17] =   0.02932554835591
lambda[  18] =   0.03139254914985
lambda[  19] =   0.03869532127206
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.268 ms
rank =  0, Distributing orbital back into band + domain format took 16.776 ms
rank = 0, Subspace_Rotation used 24.055 ms

Total time for subspace rotation: 24.060 ms
rank = 0, Efermi =  -0.076972887269 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.368 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.353 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.595 ms
rank = 0, Calculating density took 1550.265 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.931 ms
Etot    =   -38.192846974458
Eband   =   -10.922860856669
E1      =    25.026094877388
E2      =    -9.832157682314
E3      =   -14.419058614955
Exc     =   -12.757381800708
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 4.374e-06, dEband = 3.386e-04
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -38.192846974, dEtot = 4.374e-06, dEband = 3.386e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0549967303843, which took 0.058 ms

iter_count = 108, r_2norm = 1.582e-06, tol*||rhs|| = 2.200e-06

Anderson update took 57.538 ms, out of which F'*F took 26.835 ms; b-Ax took 181.487 ms, out of which Lap took 162.583 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.432 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583169, int_b + int_rho = 1.091e-14, checking this took 0.096 ms
2-norm of RHS = 742.3105690096244, which took 0.153 ms

iter_count = 108, r_2norm = 6.487e-04, tol*||rhs|| = 7.423e-04

Anderson update took 57.799 ms, out of which F'*F took 26.986 ms; b-Ax took 182.049 ms, out of which Lap took 163.320 ms
Solving Poisson took 388.816 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.184090 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.168369 
Total time for convolution: 	 convolve: 5.166501 
Total time for convolution: 	 convolve: 5.165221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.639 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.977 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.512 ms

This SCF took 27036.029 ms, scf error = 1.879e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138695, lowerbound = -0.948018, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1408.404 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.054 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.520 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.589 ms
rank =  0, finding HY took 23.795 ms
rank =  0, distributing HY into block cyclic form took 17.202 ms
rank =  0, finding Y'*HY took 3.598 ms
Rank 0, Project_Hamiltonian used 72.208 ms
Total time for projection: 72.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.664 ms
rank = 0, Solve_Generalized_EigenProblem used 1.157 ms
    first calculated eigval = -0.947934936659127
    last  calculated eigval = 0.038652846348722
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63432815297934
lambda[   4] =  -0.46826952875531
lambda[   5] =  -0.40556510025815
lambda[   6] =  -0.40229947615862
lambda[   7] =  -0.39204456791198
lambda[   8] =  -0.35034798480716
lambda[   9] =  -0.34108692824446
lambda[  10] =  -0.32642584649175
lambda[  11] =  -0.30707253172764
lambda[  12] =  -0.19613822268894
lambda[  13] =  -0.04797072958187
lambda[  14] =  -0.02253529631886
lambda[  15] =   0.02448817151709
lambda[  16] =   0.02524367750146
lambda[  17] =   0.02943254553678
lambda[  18] =   0.03157531331324
lambda[  19] =   0.03865284634872
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.181 ms
rank =  0, subspace rotation using ScaLAPACK took 7.231 ms
rank =  0, Distributing orbital back into band + domain format took 16.747 ms
rank = 0, Subspace_Rotation used 23.988 ms

Total time for subspace rotation: 23.993 ms
rank = 0, Efermi =  -0.076906164149 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.254 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.555 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 1522.338 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.821 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -38.192860898943
Eband   =   -10.921203684518
E1      =    25.025182336063
E2      =    -9.831375219934
E3      =   -14.419186636853
Exc     =   -12.757485915537
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 1.392e-06, dEband = 1.657e-04
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -38.192860899, dEtot = 1.392e-06, dEband = 1.657e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320329684146, which took 0.061 ms

iter_count = 108, r_2norm = 9.531e-07, tol*||rhs|| = 1.281e-06

Anderson update took 57.920 ms, out of which F'*F took 27.174 ms; b-Ax took 181.705 ms, out of which Lap took 163.066 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.038 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583159, int_b + int_rho = -8.367e-14, checking this took 0.086 ms
2-norm of RHS = 742.3152832382048, which took 0.139 ms

iter_count = 156, r_2norm = 6.804e-04, tol*||rhs|| = 7.423e-04

Anderson update took 84.010 ms, out of which F'*F took 38.873 ms; b-Ax took 263.355 ms, out of which Lap took 236.227 ms
Solving Poisson took 559.377 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.176356 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.223 ms
Total time for convolution: 	 convolve: 5.188089 
Total time for convolution: 	 convolve: 5.168169 
Total time for convolution: 	 convolve: 5.175547 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.222 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.723 ms

This SCF took 27206.682 ms, scf error = 1.595e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138653, lowerbound = -0.947935, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.954 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.174 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.341 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.355 ms
rank =  0, finding HY took 23.642 ms
rank =  0, distributing HY into block cyclic form took 17.195 ms
rank =  0, finding Y'*HY took 3.766 ms
Rank 0, Project_Hamiltonian used 65.989 ms
Total time for projection: 66.002 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.947804319191053
    last  calculated eigval = 0.039918934996738
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63416429574367
lambda[   4] =  -0.46811631000099
lambda[   5] =  -0.40540759923168
lambda[   6] =  -0.40214542683594
lambda[   7] =  -0.39188631399686
lambda[   8] =  -0.35017607214885
lambda[   9] =  -0.34093370709780
lambda[  10] =  -0.32626166198359
lambda[  11] =  -0.30692775895092
lambda[  12] =  -0.19601148711924
lambda[  13] =  -0.04787235219297
lambda[  14] =  -0.02241935780460
lambda[  15] =   0.02357749555346
lambda[  16] =   0.02549981433777
lambda[  17] =   0.03028478075112
lambda[  18] =   0.03103198344822
lambda[  19] =   0.03991893499674
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 7.213 ms
rank =  0, Distributing orbital back into band + domain format took 17.278 ms
rank = 0, Subspace_Rotation used 24.503 ms

Total time for subspace rotation: 24.509 ms
rank = 0, Efermi =  -0.076807786861 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.298 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.469 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1548.170 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.812 ms
rank = 0, D2D took 1.912 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -38.192920497316
Eband   =   -10.917548032661
E1      =    25.023692497365
E2      =    -9.829163124858
E3      =   -14.419116996291
Exc     =   -12.757429591431
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 5.960e-06, dEband = 3.656e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -38.192920497, dEtot = 5.960e-06, dEband = 3.656e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0259931688548, which took 0.080 ms

iter_count = 108, r_2norm = 9.920e-07, tol*||rhs|| = 1.040e-06

Anderson update took 57.714 ms, out of which F'*F took 27.325 ms; b-Ax took 182.367 ms, out of which Lap took 163.874 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.799 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583166, int_b + int_rho = -1.455e-14, checking this took 0.105 ms
2-norm of RHS = 742.3105780302801, which took 0.135 ms

iter_count = 96, r_2norm = 6.760e-04, tol*||rhs|| = 7.423e-04

Anderson update took 51.605 ms, out of which F'*F took 24.124 ms; b-Ax took 161.778 ms, out of which Lap took 145.539 ms
Solving Poisson took 345.669 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.137 ms
Total time for convolution: 	 convolve: 5.172887 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.701 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.189706 
Total time for convolution: 	 convolve: 5.251358 
Total time for convolution: 	 convolve: 5.179101 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.768 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.989 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.560 ms

This SCF took 27158.721 ms, scf error = 1.490e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139919, lowerbound = -0.947804, upperbound = 267.584693

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.243 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.088 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.519 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.620 ms
rank =  0, finding HY took 23.776 ms
rank =  0, distributing HY into block cyclic form took 17.190 ms
rank =  0, finding Y'*HY took 3.998 ms
Rank 0, Project_Hamiltonian used 64.610 ms
Total time for projection: 64.621 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.947685845442398
    last  calculated eigval = 0.039757635979992
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.63410057060165
lambda[   4] =  -0.46804312314795
lambda[   5] =  -0.40534156537056
lambda[   6] =  -0.40206958191784
lambda[   7] =  -0.39181270549167
lambda[   8] =  -0.35012599472862
lambda[   9] =  -0.34085677121448
lambda[  10] =  -0.32620315365699
lambda[  11] =  -0.30684127651804
lambda[  12] =  -0.19591361121644
lambda[  13] =  -0.04779243997911
lambda[  14] =  -0.02243282412954
lambda[  15] =   0.02344835146397
lambda[  16] =   0.02539672919163
lambda[  17] =   0.03023954892763
lambda[  18] =   0.03096687193921
lambda[  19] =   0.03975763597999
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.222 ms
rank =  0, Distributing orbital back into band + domain format took 16.711 ms
rank = 0, Subspace_Rotation used 23.945 ms

Total time for subspace rotation: 23.949 ms
rank = 0, Efermi =  -0.076727874575 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.427 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.340 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1545.528 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.918 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -38.192921904729
Eband   =   -10.915715792482
E1      =    25.022462387480
E2      =    -9.828503051082
E3      =   -14.419398805322
Exc     =   -12.757654864393
Esc     =   -63.789915490967
Entropy =    -0.000000000770
dE = 1.407e-07, dEband = 1.832e-04
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -38.192921905, dEtot = 1.407e-07, dEband = 1.832e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0181357375957, which took 0.060 ms

iter_count = 108, r_2norm = 5.234e-07, tol*||rhs|| = 7.254e-07

Anderson update took 58.141 ms, out of which F'*F took 27.045 ms; b-Ax took 182.442 ms, out of which Lap took 163.852 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.696 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002583167, int_rho =  24.00000002583160, int_b + int_rho = -6.912e-14, checking this took 0.108 ms
2-norm of RHS = 742.3101092875554, which took 0.128 ms

iter_count = 120, r_2norm = 7.388e-04, tol*||rhs|| = 7.423e-04

Anderson update took 64.604 ms, out of which F'*F took 30.363 ms; b-Ax took 202.790 ms, out of which Lap took 182.145 ms
Solving Poisson took 432.930 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.240083 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.257695 
Total time for convolution: 	 convolve: 5.202190 
Total time for convolution: 	 convolve: 5.177448 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 4.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.234 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.756 ms

This SCF took 27252.130 ms, scf error = 9.051e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.63410057060165, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46804312314795, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40534156537056, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40206958191784, occ[   6] =   2.00000000000000
lambda[   7] =  -0.39181270549167, occ[   7] =   2.00000000000000
lambda[   8] =  -0.35012599472862, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34085677121448, occ[   9] =   2.00000000000000
lambda[  10] =  -0.32620315365699, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30684127651804, occ[  11] =   2.00000000000000
lambda[  12] =  -0.19591361121644, occ[  12] =   2.00000000000000
lambda[  13] =  -0.04779243997911, occ[  13] =   0.00000002583165
lambda[  14] =  -0.02243282412954, occ[  14] =   0.00000000000000
lambda[  15] =   0.02344835146397, occ[  15] =   0.00000000000000
lambda[  16] =   0.02539672919163, occ[  16] =   0.00000000000000
lambda[  17] =   0.03023954892763, occ[  17] =   0.00000000000000
lambda[  18] =   0.03096687193921, occ[  18] =   0.00000000000000
lambda[  19] =   0.03975763597999, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.723 ms, time for Allreduce/Reduce: 8.724 ms 
Time for calculating local force components: 20.322 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000009751492  -0.00000062749790  -1.17645064134828
 -0.00009100280460  -0.03952077858797  -0.03121511701159
  0.00009102731658   0.03952081494301  -0.03121513457523
 -0.03912779751669  -0.00257310601379   0.02915497307521
  0.03920581976051  -0.00264280742267   0.02906813612730
  0.03912787018678   0.00257308628334   0.02915501728869
 -0.03920587749449   0.00264279438557   0.02906819504918
  0.00000026497594  -0.00000102215714   0.10131222282145
 -0.00000504779923  -0.01639748484155  -0.02706755552566
  0.00000571861552   0.01639692665507  -0.02706680383470
force_loc = 
  0.00000167071907  -0.00000449094282   1.16217521887256
  0.00007155808427   0.04073894672705   0.03172361744766
 -0.00007144614542  -0.04073846455667   0.03172297925613
  0.03970223369982   0.00256196774967  -0.02988692168885
 -0.03980467420030   0.00263242450546  -0.02978891101862
 -0.03970137755191  -0.00256227250174  -0.02988649335735
  0.03980465362415  -0.00263227634985  -0.02978920328227
  0.00000015833936   0.00000078719416  -0.12110831056812
  0.00006360192807   0.01595568387790   0.02691687737534
 -0.00006451277966  -0.01595402409976   0.02691662712402
Time for calculating nonlocal force components: 36.943 ms
[32mforces_xc: 
[0m[32m  0.00000007146989  -0.00000011511973   0.02749044239290
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000003556428   0.00000008539164   0.00730560852687
[0m[32m  0.00000099249027   0.00090404313813   0.00077288757972
[0m[32m -0.00000109089198  -0.00090400507523   0.00077291657473
[0mTime for calculating XC forces components: 29.746 ms
 Cartesian force = 
  0.00000137657937  -0.00000484212887   0.01320695718708
 -0.00001971281500   0.00121855957066   0.00050043770596
  0.00001931307649  -0.00121725818207   0.00049978195079
  0.00057416808845  -0.00001074683254  -0.00074001134376
 -0.00059912253447  -0.00000999148563  -0.00072883762143
 -0.00057377545980   0.00001120521319  -0.00073953879876
  0.00059850803498   0.00001090946730  -0.00072907096320
  0.00000011965634   0.00000024186024  -0.01249854194991
  0.00005927852444   0.00046263360605   0.00061414669929
 -0.00006015315079  -0.00046071108834   0.00061467713394
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Time for printing density: 387.243 ms
The program took 445.266 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:30
Job ID:        2266475
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:34:36,vmem=8460K,walltime=00:07:53,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-16-1
---------------------------------------
