---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:45
Job ID:    2266868
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:50
Job ID:    2266868
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 33.833 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 17.831 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 80.707 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.022 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.087 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.613600	    7.692388	   10.000000	
    9.987347	    8.751414	   12.105206	
    9.987347	    8.751414	    7.894794	
   11.692982	   12.172489	   12.284977	
   11.692982	   12.172489	    7.715023	
    8.307018	   12.307612	   12.201748	
    8.307018	   12.307612	    7.798252	
    9.987347	   11.365702	   11.465080	
    9.987347	   11.365702	    8.534920	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.164 ms
Set up communicators.

--set up spincomm took 2.427 ms

--set up kptcomm took 0.364 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.007 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.066 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.380 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.581 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.815 ms.
time spent on vectorized spline interp: 3.169 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.847 ms.
time spent on vectorized spline interp: 1.360 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.309 ms.
time spent on vectorized spline interp: 1.676 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.617 ms.

Calculating rb for all atom types took 15.803 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.057 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000374702, sum_int_rho = 29.5961827071039
PosCharge = 30.000000037470, NegCharge = -29.596182707104, scal_fac = 1.013644236973
After scaling, int_rho = 30.0000000374703, PosCharge + NegCharge - NetCharge = -9.948e-14
--Calculate Vref took 0.564 ms
--Calculate rho_guess took 3.478 ms

 integral of b = -30.0000000374702,
 int{b} + Nelectron + NetCharge = -3.747e-08,
 Esc = -98.5608700445231,
 MPI_Reduce took 7.668 ms

Calculating b & b_ref took 19.365 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.102 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.110 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.118 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.739 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.002 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.007 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 47.490 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747026, int_b + int_rho = -2.910e-14, checking this took 0.089 ms
2-norm of RHS = 757.0270187859091, which took 0.096 ms

iter_count = 420, r_2norm = 6.338e-04, tol*||rhs|| = 7.570e-04

Anderson update took 233.931 ms, out of which F'*F took 106.218 ms; b-Ax took 752.553 ms, out of which Lap took 677.509 ms
Solving Poisson took 1554.405 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
Total time for convolution: 	 convolve: 5.191837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.160199 
Total time for convolution: 	 convolve: 5.202882 
Total time for convolution: 	 convolve: 5.162997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.757 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, XC calculation took 24659.021 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 4.911 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.312 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.346 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.159 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.657 ms
    Lanczos iter 54, eigmin  = -1.076547752, eigmax = 264.936420569, err_eigmin = 7.337e-04, err_eigmax = 9.793e-03
rank =   0, Lanczos took 127.953 ms, eigmin = -1.076547752107, eigmax = 267.585784774395

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.204619, lowerbound = -1.176548, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1564.068 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 34.513 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.080 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 37.612 ms
rank =  0, finding HY took 27.320 ms
rank =  0, distributing HY into block cyclic form took 20.887 ms
rank =  0, finding Y'*HY took 6.338 ms
Rank 0, Project_Hamiltonian used 92.208 ms
Total time for projection: 92.223 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.840 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.798 ms
rank = 0, Solve_Generalized_EigenProblem used 1.644 ms
    first calculated eigval = 2.672499844621923
    last  calculated eigval = 3.265190446026835
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.87533605856463
lambda[   7] =   2.88502161682992
lambda[   8] =   2.89703391482933
lambda[   9] =   2.93763909441645
lambda[  10] =   2.95879751577052
lambda[  11] =   2.97140937125510
lambda[  12] =   2.97583185932392
lambda[  13] =   3.01462137520631
lambda[  14] =   3.02943844501676
lambda[  15] =   3.05029094787216
lambda[  16] =   3.07385956064926
lambda[  17] =   3.09501389442516
lambda[  18] =   3.12717723227310
lambda[  19] =   3.14466608265106
lambda[  20] =   3.16540672623517
lambda[  21] =   3.18000983100978
lambda[  22] =   3.21753136587987
lambda[  23] =   3.26519044602683
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.661 ms
rank =  0, subspace rotation using ScaLAPACK took 9.250 ms
rank =  0, Distributing orbital back into band + domain format took 19.877 ms
rank = 0, Subspace_Rotation used 29.144 ms

Total time for subspace rotation: 29.148 ms
rank = 0, Efermi =   3.062075255861 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.365190, lowerbound = -1.176548, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1540.369 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 32.250 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.112 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 35.378 ms
rank =  0, finding HY took 26.967 ms
rank =  0, distributing HY into block cyclic form took 19.706 ms
rank =  0, finding Y'*HY took 4.804 ms
Rank 0, Project_Hamiltonian used 86.886 ms
Total time for projection: 86.898 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.158 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.911298775857563
    last  calculated eigval = 0.451724026440732
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.21029083417021
lambda[   7] =  -0.18462959904750
lambda[   8] =  -0.11349870666043
lambda[   9] =   0.00890244226398
lambda[  10] =   0.03752455989336
lambda[  11] =   0.07304656620197
lambda[  12] =   0.13753542267506
lambda[  13] =   0.16205696507121
lambda[  14] =   0.26017969451898
lambda[  15] =   0.28424009770080
lambda[  16] =   0.29516720142281
lambda[  17] =   0.33354518290273
lambda[  18] =   0.34638007285284
lambda[  19] =   0.37901337027528
lambda[  20] =   0.39880550489867
lambda[  21] =   0.41184911758968
lambda[  22] =   0.42286607065795
lambda[  23] =   0.45172402644073
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 9.170 ms
rank =  0, Distributing orbital back into band + domain format took 19.804 ms
rank = 0, Subspace_Rotation used 28.992 ms

Total time for subspace rotation: 28.997 ms
rank = 0, Efermi =   0.289703649850 calculate fermi energy took 0.027 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.551724, lowerbound = -1.176548, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1555.290 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.160 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.865 ms
rank =  0, finding HY took 27.032 ms
rank =  0, distributing HY into block cyclic form took 20.057 ms
rank =  0, finding Y'*HY took 4.635 ms
Rank 0, Project_Hamiltonian used 78.629 ms
Total time for projection: 78.634 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.241 ms
    first calculated eigval = -1.083384513428723
    last  calculated eigval = 0.153379309375819
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54553354521413
lambda[   7] =  -0.52301207796171
lambda[   8] =  -0.48868550619154
lambda[   9] =  -0.45224471594737
lambda[  10] =  -0.43661984565186
lambda[  11] =  -0.37110141406193
lambda[  12] =  -0.35716741817587
lambda[  13] =  -0.31192610867270
lambda[  14] =  -0.26760369793639
lambda[  15] =  -0.18494987601529
lambda[  16] =   0.01445934944348
lambda[  17] =   0.04562300290567
lambda[  18] =   0.08817234881345
lambda[  19] =   0.09697804152260
lambda[  20] =   0.11822336278394
lambda[  21] =   0.12983696364262
lambda[  22] =   0.13343152838007
lambda[  23] =   0.15337930937582
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 9.156 ms
rank =  0, Distributing orbital back into band + domain format took 19.945 ms
rank = 0, Subspace_Rotation used 29.114 ms

Total time for subspace rotation: 29.118 ms
rank = 0, Efermi =  -0.014137272511 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.253379, lowerbound = -1.176548, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1555.345 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.479 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.050 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.546 ms
rank =  0, finding HY took 27.050 ms
rank =  0, distributing HY into block cyclic form took 19.599 ms
rank =  0, finding Y'*HY took 4.953 ms
Rank 0, Project_Hamiltonian used 78.176 ms
Total time for projection: 78.180 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.239 ms
    first calculated eigval = -1.083559202462008
    last  calculated eigval = 0.096107396588114
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54963956252493
lambda[   7] =  -0.52832163232424
lambda[   8] =  -0.50018403474422
lambda[   9] =  -0.46083857881222
lambda[  10] =  -0.45624671159163
lambda[  11] =  -0.38512245366657
lambda[  12] =  -0.38198212307093
lambda[  13] =  -0.33180845169004
lambda[  14] =  -0.28727064224162
lambda[  15] =  -0.22427275814340
lambda[  16] =  -0.02019227548333
lambda[  17] =  -0.00282395049769
lambda[  18] =   0.00067184716404
lambda[  19] =   0.02040836815653
lambda[  20] =   0.05664334768968
lambda[  21] =   0.05821315536624
lambda[  22] =   0.07937438967298
lambda[  23] =   0.09610739658811
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 9.200 ms
rank =  0, Distributing orbital back into band + domain format took 20.483 ms
rank = 0, Subspace_Rotation used 29.718 ms

Total time for subspace rotation: 29.722 ms
rank = 0, Efermi =  -0.048788897446 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 5.306 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.136 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 6817.862 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -63.950614248871
Eband   =   -16.754921104123
E1      =    34.009841720416
E2      =   -15.282712460891
E3      =   -19.724318355429
Exc     =   -17.651695635855
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 7.106e+00, dEband = 1.862e+00
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -63.950614249, dEtot = 7.106e+00, dEband = 1.862e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 106.0112585560302, which took 0.410 ms

iter_count = 90, r_2norm = 2.731e-03, tol*||rhs|| = 4.240e-03

Anderson update took 48.385 ms, out of which F'*F took 22.615 ms; b-Ax took 153.253 ms, out of which Lap took 136.642 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.864 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747034, int_b + int_rho = 5.093e-14, checking this took 0.132 ms
2-norm of RHS = 755.0346275953625, which took 0.857 ms

iter_count = 282, r_2norm = 7.046e-04, tol*||rhs|| = 7.550e-04

Anderson update took 149.837 ms, out of which F'*F took 69.883 ms; b-Ax took 480.072 ms, out of which Lap took 425.145 ms
Solving Poisson took 1015.666 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.378 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.244920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.326407 
Total time for convolution: 	 convolve: 5.245767 
Total time for convolution: 	 convolve: 5.267940 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.549 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.979 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.563 ms

This SCF took 33353.435 ms, scf error = 1.643e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.196107, lowerbound = -1.083559, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1544.404 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 64.155 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.992 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 67.168 ms
rank =  0, finding HY took 26.890 ms
rank =  0, distributing HY into block cyclic form took 20.130 ms
rank =  0, finding Y'*HY took 5.608 ms
Rank 0, Project_Hamiltonian used 119.826 ms
Total time for projection: 119.849 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -1.096290340069146
    last  calculated eigval = 0.077144555601638
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52473671675221
lambda[   7] =  -0.50920233577974
lambda[   8] =  -0.49344201670540
lambda[   9] =  -0.45318475010394
lambda[  10] =  -0.43433912271332
lambda[  11] =  -0.37890801969235
lambda[  12] =  -0.37300557458030
lambda[  13] =  -0.33242287043434
lambda[  14] =  -0.27880148344146
lambda[  15] =  -0.23172103831129
lambda[  16] =  -0.03993104019885
lambda[  17] =  -0.03036265515437
lambda[  18] =  -0.01538319360148
lambda[  19] =  -0.00282077843633
lambda[  20] =   0.02436515380892
lambda[  21] =   0.03470984989228
lambda[  22] =   0.04600647165476
lambda[  23] =   0.07714455560164
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 9.344 ms
rank =  0, Distributing orbital back into band + domain format took 19.611 ms
rank = 0, Subspace_Rotation used 28.972 ms

Total time for subspace rotation: 28.976 ms
rank = 0, Efermi =  -0.068527667284 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.419 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.189 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 1710.802 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.788 ms
rank = 0, D2D took 1.897 ms
rank = 0, Transfering density took 1.902 ms
Etot    =   -63.892469778525
Eband   =   -16.488762376218
E1      =    33.739117073910
E2      =   -15.324347830976
E3      =   -19.837949975001
Exc     =   -17.744252236567
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 6.460e-03, dEband = 2.957e-02
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -63.892469779, dEtot = 6.460e-03, dEband = 2.957e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 32.9898546193446, which took 0.051 ms

iter_count = 96, r_2norm = 8.150e-04, tol*||rhs|| = 1.320e-03

Anderson update took 51.473 ms, out of which F'*F took 23.801 ms; b-Ax took 162.460 ms, out of which Lap took 144.811 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.298 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747031, int_b + int_rho = 2.547e-14, checking this took 0.104 ms
2-norm of RHS = 752.0243364295624, which took 0.099 ms

iter_count = 294, r_2norm = 7.245e-04, tol*||rhs|| = 7.520e-04

Anderson update took 155.973 ms, out of which F'*F took 72.779 ms; b-Ax took 498.892 ms, out of which Lap took 443.290 ms
Solving Poisson took 1058.688 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.212820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.941 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.197877 
Total time for convolution: 	 convolve: 5.191684 
Total time for convolution: 	 convolve: 5.210726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.954 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.565 ms

This SCF took 28008.737 ms, scf error = 1.114e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177145, lowerbound = -1.096290, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1537.969 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 66.620 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.504 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 70.143 ms
rank =  0, finding HY took 27.115 ms
rank =  0, distributing HY into block cyclic form took 19.696 ms
rank =  0, finding Y'*HY took 4.812 ms
Rank 0, Project_Hamiltonian used 121.799 ms
Total time for projection: 121.820 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -1.113617194435420
    last  calculated eigval = 0.068780079393459
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.48625698554531
lambda[   7] =  -0.47845118608887
lambda[   8] =  -0.47294767199528
lambda[   9] =  -0.43566225087770
lambda[  10] =  -0.39266301250310
lambda[  11] =  -0.35175575323999
lambda[  12] =  -0.35026721549968
lambda[  13] =  -0.32033063960176
lambda[  14] =  -0.26036959268055
lambda[  15] =  -0.22593022363444
lambda[  16] =  -0.05575813522529
lambda[  17] =  -0.03844431133340
lambda[  18] =  -0.02381973043155
lambda[  19] =   0.00026773349305
lambda[  20] =   0.01457824226033
lambda[  21] =   0.02646647107945
lambda[  22] =   0.03275294018166
lambda[  23] =   0.06878007939346
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 9.343 ms
rank =  0, Distributing orbital back into band + domain format took 19.998 ms
rank = 0, Subspace_Rotation used 29.361 ms

Total time for subspace rotation: 29.367 ms
rank = 0, Efermi =  -0.084354757238 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.898 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.622 ms
rank = 0, Calculating density took 1706.608 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.865 ms
rank = 0, D2D took 1.965 ms
rank = 0, Transfering density took 1.971 ms
Etot    =   -63.846206773217
Eband   =   -15.863252114061
E1      =    33.159369001618
E2      =   -15.268255821963
E3      =   -20.134090244682
Exc     =   -17.983799681791
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 5.140e-03, dEband = 6.950e-02
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -63.846206773, dEtot = 5.140e-03, dEband = 6.950e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.1213004686684, which took 0.058 ms

iter_count = 96, r_2norm = 3.422e-04, tol*||rhs|| = 4.449e-04

Anderson update took 51.384 ms, out of which F'*F took 23.735 ms; b-Ax took 160.794 ms, out of which Lap took 144.052 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.823 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747036, int_b + int_rho = 6.912e-14, checking this took 0.124 ms
2-norm of RHS = 751.5864296608333, which took 0.125 ms

iter_count = 258, r_2norm = 6.813e-04, tol*||rhs|| = 7.516e-04

Anderson update took 137.956 ms, out of which F'*F took 64.846 ms; b-Ax took 439.673 ms, out of which Lap took 392.467 ms
Solving Poisson took 929.291 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.183036 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.186671 
Total time for convolution: 	 convolve: 5.206100 
Total time for convolution: 	 convolve: 5.220346 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.515 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.940 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.488 ms

This SCF took 27781.050 ms, scf error = 3.051e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.168780, lowerbound = -1.113617, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1536.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 64.480 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.207 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 67.705 ms
rank =  0, finding HY took 26.621 ms
rank =  0, distributing HY into block cyclic form took 19.912 ms
rank =  0, finding Y'*HY took 4.944 ms
Rank 0, Project_Hamiltonian used 119.240 ms
Total time for projection: 119.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.149 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.246 ms
    first calculated eigval = -1.104455917953463
    last  calculated eigval = 0.061720503444306
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47898024603572
lambda[   7] =  -0.47148145735003
lambda[   8] =  -0.46489360538790
lambda[   9] =  -0.42704276174224
lambda[  10] =  -0.38618667196590
lambda[  11] =  -0.34456133502861
lambda[  12] =  -0.34361406209130
lambda[  13] =  -0.31123883790132
lambda[  14] =  -0.25478031643439
lambda[  15] =  -0.21518766317123
lambda[  16] =  -0.04890019223756
lambda[  17] =  -0.03153601745714
lambda[  18] =  -0.02683739242411
lambda[  19] =   0.00065151122503
lambda[  20] =   0.01057735414024
lambda[  21] =   0.02119763124986
lambda[  22] =   0.02874909873832
lambda[  23] =   0.06172050344431
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.303 ms
rank =  0, subspace rotation using ScaLAPACK took 9.279 ms
rank =  0, Distributing orbital back into band + domain format took 19.761 ms
rank = 0, Subspace_Rotation used 29.056 ms

Total time for subspace rotation: 29.062 ms
rank = 0, Efermi =  -0.077496814208 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.480 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.824 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.654 ms
rank = 0, Calculating density took 1703.472 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.995 ms
rank = 0, D2D took 2.104 ms
rank = 0, Transfering density took 2.110 ms
Etot    =   -63.843122372401
Eband   =   -15.637499328735
E1      =    32.997818335889
E2      =   -15.188365543434
E3      =   -20.217864409278
Exc     =   -18.048801286640
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 3.427e-04, dEband = 2.508e-02
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -63.843122372, dEtot = 3.427e-04, dEband = 2.508e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.4968129688209, which took 0.074 ms

iter_count = 102, r_2norm = 1.244e-04, tol*||rhs|| = 1.799e-04

Anderson update took 54.207 ms, out of which F'*F took 25.589 ms; b-Ax took 173.584 ms, out of which Lap took 154.892 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.014 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747035, int_b + int_rho = 6.185e-14, checking this took 0.105 ms
2-norm of RHS = 751.7673255018759, which took 0.087 ms

iter_count = 240, r_2norm = 6.813e-04, tol*||rhs|| = 7.518e-04

Anderson update took 127.541 ms, out of which F'*F took 59.801 ms; b-Ax took 410.297 ms, out of which Lap took 366.288 ms
Solving Poisson took 864.012 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.184682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.336 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.211763 
Total time for convolution: 	 convolve: 5.221374 
Total time for convolution: 	 convolve: 5.217798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.742 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.520 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.297 ms

This SCF took 27815.011 ms, scf error = 1.119e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.161721, lowerbound = -1.104456, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1537.120 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 62.512 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.095 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 65.626 ms
rank =  0, finding HY took 26.781 ms
rank =  0, distributing HY into block cyclic form took 19.685 ms
rank =  0, finding Y'*HY took 4.812 ms
Rank 0, Project_Hamiltonian used 116.938 ms
Total time for projection: 116.962 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.102233236452658
    last  calculated eigval = 0.055997998072961
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47584706981086
lambda[   7] =  -0.46807844274234
lambda[   8] =  -0.46165419350038
lambda[   9] =  -0.42434147950703
lambda[  10] =  -0.38208327494727
lambda[  11] =  -0.34104069209273
lambda[  12] =  -0.34085586091158
lambda[  13] =  -0.30848508299814
lambda[  14] =  -0.25061576855771
lambda[  15] =  -0.21291878668323
lambda[  16] =  -0.04746262336699
lambda[  17] =  -0.03053240476841
lambda[  18] =  -0.02793515100862
lambda[  19] =   0.00114863340652
lambda[  20] =   0.00920595248295
lambda[  21] =   0.01841767143256
lambda[  22] =   0.02691064290368
lambda[  23] =   0.05599799807296
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 9.266 ms
rank =  0, Distributing orbital back into band + domain format took 19.564 ms
rank = 0, Subspace_Rotation used 28.844 ms

Total time for subspace rotation: 28.849 ms
rank = 0, Efermi =  -0.076059245330 calculate fermi energy took 1.037 ms
rank = 0, --- Calculate rho: sum over local bands took 5.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1701.560 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.797 ms
rank = 0, D2D took 1.906 ms
rank = 0, Transfering density took 1.912 ms
Etot    =   -63.842514500777
Eband   =   -15.543668459808
E1      =    32.941380182123
E2      =   -15.144230441857
E3      =   -20.248156678045
Exc     =   -18.071743297366
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 6.754e-05, dEband = 1.043e-02
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -63.842514501, dEtot = 6.754e-05, dEband = 1.043e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5377941475188, which took 0.091 ms

iter_count = 108, r_2norm = 4.157e-05, tol*||rhs|| = 6.151e-05

Anderson update took 57.405 ms, out of which F'*F took 27.188 ms; b-Ax took 183.228 ms, out of which Lap took 164.264 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.561 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747025, int_b + int_rho = -4.366e-14, checking this took 0.099 ms
2-norm of RHS = 752.1327817105719, which took 0.128 ms

iter_count = 234, r_2norm = 6.750e-04, tol*||rhs|| = 7.521e-04

Anderson update took 125.250 ms, out of which F'*F took 58.964 ms; b-Ax took 400.982 ms, out of which Lap took 357.772 ms
Solving Poisson took 846.866 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.223214 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.159323 
Total time for convolution: 	 convolve: 5.237131 
Total time for convolution: 	 convolve: 5.211523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.532 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.491 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.418 ms

This SCF took 27810.648 ms, scf error = 5.802e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.155998, lowerbound = -1.102233, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1535.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 66.383 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.061 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 69.460 ms
rank =  0, finding HY took 26.792 ms
rank =  0, distributing HY into block cyclic form took 19.746 ms
rank =  0, finding Y'*HY took 4.709 ms
Rank 0, Project_Hamiltonian used 120.737 ms
Total time for projection: 120.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.236 ms
    first calculated eigval = -1.099207911833021
    last  calculated eigval = 0.050586953578802
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47372576378922
lambda[   7] =  -0.46579498098670
lambda[   8] =  -0.45940029812171
lambda[   9] =  -0.42226834024600
lambda[  10] =  -0.37975043447440
lambda[  11] =  -0.33913983178199
lambda[  12] =  -0.33864157802924
lambda[  13] =  -0.30626061802087
lambda[  14] =  -0.24812492636701
lambda[  15] =  -0.21073117397079
lambda[  16] =  -0.04534849525632
lambda[  17] =  -0.02866022505729
lambda[  18] =  -0.02788848987398
lambda[  19] =   0.00150526060932
lambda[  20] =   0.00866007930557
lambda[  21] =   0.01670911361328
lambda[  22] =   0.02592767220459
lambda[  23] =   0.05058695357880
==subpsace eigenproblem: bcast eigvals took 0.072 ms
Total time for solving subspace eigenvalue problem: 0.314 ms
rank =  0, subspace rotation using ScaLAPACK took 9.261 ms
rank =  0, Distributing orbital back into band + domain format took 19.853 ms
rank = 0, Subspace_Rotation used 29.129 ms

Total time for subspace rotation: 29.133 ms
rank = 0, Efermi =  -0.073945117205 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.855 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1703.023 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.821 ms
rank = 0, D2D took 1.913 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -63.842280794227
Eband   =   -15.475121683104
E1      =    32.911477523421
E2      =   -15.101702383039
E3      =   -20.261560321509
Exc     =   -18.081029293464
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 2.597e-05, dEband = 7.616e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -63.842280794, dEtot = 2.597e-05, dEband = 7.616e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4554407036520, which took 0.068 ms

iter_count = 114, r_2norm = 1.160e-05, tol*||rhs|| = 1.822e-05

Anderson update took 60.573 ms, out of which F'*F took 28.787 ms; b-Ax took 192.984 ms, out of which Lap took 173.231 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.039 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747026, int_b + int_rho = -2.910e-14, checking this took 0.081 ms
2-norm of RHS = 752.5155052143334, which took 0.128 ms

iter_count = 234, r_2norm = 6.720e-04, tol*||rhs|| = 7.525e-04

Anderson update took 125.049 ms, out of which F'*F took 58.479 ms; b-Ax took 395.270 ms, out of which Lap took 353.774 ms
Solving Poisson took 841.059 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.244248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.187001 
Total time for convolution: 	 convolve: 5.260765 
Total time for convolution: 	 convolve: 5.211633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.020 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.555 ms

This SCF took 27915.325 ms, scf error = 2.681e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.150587, lowerbound = -1.099208, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1538.045 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 63.954 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.026 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 66.999 ms
rank =  0, finding HY took 26.819 ms
rank =  0, distributing HY into block cyclic form took 19.634 ms
rank =  0, finding Y'*HY took 4.779 ms
Rank 0, Project_Hamiltonian used 118.260 ms
Total time for projection: 118.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.249 ms
    first calculated eigval = -1.097286241522411
    last  calculated eigval = 0.046049955210958
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47136956660378
lambda[   7] =  -0.46328182809503
lambda[   8] =  -0.45709214172551
lambda[   9] =  -0.42012815990552
lambda[  10] =  -0.37725685397218
lambda[  11] =  -0.33669327779032
lambda[  12] =  -0.33647255479170
lambda[  13] =  -0.30427446071257
lambda[  14] =  -0.24614113143838
lambda[  15] =  -0.20906687058692
lambda[  16] =  -0.04392822394421
lambda[  17] =  -0.02730868028305
lambda[  18] =  -0.02705809294458
lambda[  19] =   0.00228956246731
lambda[  20] =   0.00890699900045
lambda[  21] =   0.01614992604883
lambda[  22] =   0.02557324337209
lambda[  23] =   0.04604995521096
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.290 ms
rank =  0, subspace rotation using ScaLAPACK took 9.314 ms
rank =  0, Distributing orbital back into band + domain format took 20.061 ms
rank = 0, Subspace_Rotation used 29.390 ms

Total time for subspace rotation: 29.395 ms
rank = 0, Efermi =  -0.072524845920 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.522 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.947 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1703.186 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.906 ms
rank = 0, Transfering density took 1.908 ms
Etot    =   -63.842164580245
Eband   =   -15.408502229134
E1      =    32.883347158904
E2      =   -15.060380226933
E3      =   -20.270749316101
Exc     =   -18.087269007422
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 1.291e-05, dEband = 7.402e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -63.842164580, dEtot = 1.291e-05, dEband = 7.402e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2731427710266, which took 0.055 ms

iter_count = 108, r_2norm = 9.665e-06, tol*||rhs|| = 1.093e-05

Anderson update took 57.835 ms, out of which F'*F took 26.847 ms; b-Ax took 182.983 ms, out of which Lap took 164.000 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.539 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747023, int_b + int_rho = -5.821e-14, checking this took 0.103 ms
2-norm of RHS = 752.6038202738072, which took 0.113 ms

iter_count = 222, r_2norm = 7.077e-04, tol*||rhs|| = 7.526e-04

Anderson update took 118.704 ms, out of which F'*F took 55.785 ms; b-Ax took 375.569 ms, out of which Lap took 336.670 ms
Solving Poisson took 796.825 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.192027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.219270 
Total time for convolution: 	 convolve: 5.193138 
Total time for convolution: 	 convolve: 5.353481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.732 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.403 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.023 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.594 ms

This SCF took 27876.520 ms, scf error = 1.195e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146050, lowerbound = -1.097286, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1552.278 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 49.292 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.052 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 52.362 ms
rank =  0, finding HY took 26.925 ms
rank =  0, distributing HY into block cyclic form took 19.709 ms
rank =  0, finding Y'*HY took 4.745 ms
Rank 0, Project_Hamiltonian used 103.776 ms
Total time for projection: 103.796 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -1.095102741504387
    last  calculated eigval = 0.043673845704701
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46939594244281
lambda[   7] =  -0.46131671831115
lambda[   8] =  -0.45506973853832
lambda[   9] =  -0.41807145361294
lambda[  10] =  -0.37534479793415
lambda[  11] =  -0.33471898314461
lambda[  12] =  -0.33439866217688
lambda[  13] =  -0.30221786830139
lambda[  14] =  -0.24406219212915
lambda[  15] =  -0.20698009510227
lambda[  16] =  -0.04197814596677
lambda[  17] =  -0.02578443484856
lambda[  18] =  -0.02501709349957
lambda[  19] =   0.00354909275223
lambda[  20] =   0.00999286921637
lambda[  21] =   0.01688260551443
lambda[  22] =   0.02547250854002
lambda[  23] =   0.04367384570470
==subpsace eigenproblem: bcast eigvals took 0.043 ms
Total time for solving subspace eigenvalue problem: 0.304 ms
rank =  0, subspace rotation using ScaLAPACK took 9.340 ms
rank =  0, Distributing orbital back into band + domain format took 49.258 ms
rank = 0, Subspace_Rotation used 58.618 ms

Total time for subspace rotation: 58.622 ms
rank = 0, Efermi =  -0.070574767896 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.611 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.729 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.634 ms
rank = 0, Calculating density took 1732.102 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.896 ms
rank = 0, D2D took 3.006 ms
rank = 0, Transfering density took 3.009 ms
Etot    =   -63.842173176655
Eband   =   -15.347051748519
E1      =    32.853085862548
E2      =   -15.027410891423
E3      =   -20.276824487099
Exc     =   -18.091572623578
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 9.552e-07, dEband = 6.828e-03
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -63.842173177, dEtot = 9.552e-07, dEband = 6.828e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1804963382022, which took 0.079 ms

iter_count = 108, r_2norm = 6.873e-06, tol*||rhs|| = 7.220e-06

Anderson update took 57.553 ms, out of which F'*F took 27.548 ms; b-Ax took 183.281 ms, out of which Lap took 164.166 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747023, int_b + int_rho = -5.821e-14, checking this took 0.102 ms
2-norm of RHS = 752.6216875071141, which took 0.130 ms

iter_count = 198, r_2norm = 6.961e-04, tol*||rhs|| = 7.526e-04

Anderson update took 105.486 ms, out of which F'*F took 49.263 ms; b-Ax took 334.497 ms, out of which Lap took 299.293 ms
Solving Poisson took 708.880 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.177751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 98.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.299447 
Total time for convolution: 	 convolve: 5.181914 
Total time for convolution: 	 convolve: 5.227790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.579 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.017 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.629 ms

This SCF took 28034.967 ms, scf error = 6.511e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.143674, lowerbound = -1.095103, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1561.978 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 26.232 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.068 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 29.318 ms
rank =  0, finding HY took 27.120 ms
rank =  0, distributing HY into block cyclic form took 19.606 ms
rank =  0, finding Y'*HY took 4.742 ms
Rank 0, Project_Hamiltonian used 80.817 ms
Total time for projection: 80.827 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.180 ms
rank = 0, Solve_Generalized_EigenProblem used 0.326 ms
    first calculated eigval = -1.094347897919828
    last  calculated eigval = 0.041917305735968
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46852775387493
lambda[   7] =  -0.46043364493175
lambda[   8] =  -0.45419818015977
lambda[   9] =  -0.41720319337563
lambda[  10] =  -0.37446024468087
lambda[  11] =  -0.33383478499241
lambda[  12] =  -0.33353024013647
lambda[  13] =  -0.30136731399361
lambda[  14] =  -0.24321193816416
lambda[  15] =  -0.20615243171650
lambda[  16] =  -0.04118062176697
lambda[  17] =  -0.02489493461418
lambda[  18] =  -0.02424454416215
lambda[  19] =   0.00432925902267
lambda[  20] =   0.01078378854162
lambda[  21] =   0.01738595039603
lambda[  22] =   0.02509117610304
lambda[  23] =   0.04191730573597
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.354 ms
rank =  0, subspace rotation using ScaLAPACK took 9.338 ms
rank =  0, Distributing orbital back into band + domain format took 20.036 ms
rank = 0, Subspace_Rotation used 29.389 ms

Total time for subspace rotation: 29.394 ms
rank = 0, Efermi =  -0.069777243789 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.591 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.918 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1689.781 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.886 ms
rank = 0, D2D took 1.983 ms
rank = 0, Transfering density took 1.986 ms
Etot    =   -63.842192780791
Eband   =   -15.321305539537
E1      =    32.839855161308
E2      =   -15.014182404639
E3      =   -20.279712866391
Exc     =   -18.093767627964
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 2.178e-06, dEband = 2.861e-03
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -63.842192781, dEtot = 2.178e-06, dEband = 2.861e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0966656385241, which took 0.054 ms

iter_count = 108, r_2norm = 3.212e-06, tol*||rhs|| = 3.867e-06

Anderson update took 57.690 ms, out of which F'*F took 26.832 ms; b-Ax took 184.377 ms, out of which Lap took 164.281 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747036, int_b + int_rho = 6.912e-14, checking this took 0.115 ms
2-norm of RHS = 752.6272867948816, which took 0.078 ms

iter_count = 210, r_2norm = 6.575e-04, tol*||rhs|| = 7.526e-04

Anderson update took 112.231 ms, out of which F'*F took 52.027 ms; b-Ax took 356.506 ms, out of which Lap took 318.961 ms
Solving Poisson took 753.343 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.306691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.620271 
Total time for convolution: 	 convolve: 5.238009 
Total time for convolution: 	 convolve: 5.238441 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.445 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.229 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.802 ms

This SCF took 28285.513 ms, scf error = 4.979e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.141917, lowerbound = -1.094348, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1567.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 32.665 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.021 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 35.705 ms
rank =  0, finding HY took 26.881 ms
rank =  0, distributing HY into block cyclic form took 19.542 ms
rank =  0, finding Y'*HY took 4.877 ms
Rank 0, Project_Hamiltonian used 87.035 ms
Total time for projection: 87.052 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 0.256 ms
    first calculated eigval = -1.092900173768151
    last  calculated eigval = 0.041683618023357
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46730009348297
lambda[   7] =  -0.45920440204954
lambda[   8] =  -0.45295470028802
lambda[   9] =  -0.41592037843240
lambda[  10] =  -0.37327179465322
lambda[  11] =  -0.33263088454549
lambda[  12] =  -0.33225990760511
lambda[  13] =  -0.30004230990696
lambda[  14] =  -0.24188316588902
lambda[  15] =  -0.20476956226570
lambda[  16] =  -0.03936435789984
lambda[  17] =  -0.02279519976904
lambda[  18] =  -0.02216402672768
lambda[  19] =   0.00707126407292
lambda[  20] =   0.01449662902702
lambda[  21] =   0.02049694513156
lambda[  22] =   0.02624849364267
lambda[  23] =   0.04168361802336
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.273 ms
rank =  0, subspace rotation using ScaLAPACK took 9.364 ms
rank =  0, Distributing orbital back into band + domain format took 20.217 ms
rank = 0, Subspace_Rotation used 29.597 ms

Total time for subspace rotation: 29.602 ms
rank = 0, Efermi =  -0.067960979920 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.588 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.833 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.624 ms
rank = 0, Calculating density took 1702.095 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.010 ms
rank = 0, Transfering density took 2.012 ms
Etot    =   -63.842216586696
Eband   =   -15.282814740733
E1      =    32.821756194378
E2      =   -14.993445218679
E3      =   -20.281084777841
Exc     =   -18.094817991233
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 2.645e-06, dEband = 4.277e-03
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -63.842216587, dEtot = 2.645e-06, dEband = 4.277e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1002575419542, which took 0.050 ms

iter_count = 102, r_2norm = 3.914e-06, tol*||rhs|| = 4.010e-06

Anderson update took 54.291 ms, out of which F'*F took 25.394 ms; b-Ax took 173.663 ms, out of which Lap took 155.192 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747040, int_b + int_rho = 1.128e-13, checking this took 0.102 ms
2-norm of RHS = 752.6273774557718, which took 0.099 ms

iter_count = 174, r_2norm = 7.203e-04, tol*||rhs|| = 7.526e-04

Anderson update took 92.727 ms, out of which F'*F took 43.040 ms; b-Ax took 293.977 ms, out of which Lap took 262.405 ms
Solving Poisson took 623.759 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.240813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.237839 
Total time for convolution: 	 convolve: 5.282543 
Total time for convolution: 	 convolve: 5.239405 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.007 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.537 ms

This SCF took 27762.131 ms, scf error = 2.554e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.141684, lowerbound = -1.092900, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1557.310 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 41.649 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.046 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 44.713 ms
rank =  0, finding HY took 26.970 ms
rank =  0, distributing HY into block cyclic form took 19.640 ms
rank =  0, finding Y'*HY took 4.823 ms
Rank 0, Project_Hamiltonian used 96.178 ms
Total time for projection: 96.192 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.230 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.319 ms
    first calculated eigval = -1.092268851835154
    last  calculated eigval = 0.041111755218628
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46671207074271
lambda[   7] =  -0.45860949391351
lambda[   8] =  -0.45236363813711
lambda[   9] =  -0.41532247708454
lambda[  10] =  -0.37268984670176
lambda[  11] =  -0.33204362650338
lambda[  12] =  -0.33166405110696
lambda[  13] =  -0.29943914695485
lambda[  14] =  -0.24127567600327
lambda[  15] =  -0.20415545233043
lambda[  16] =  -0.03856429908818
lambda[  17] =  -0.02219608766222
lambda[  18] =  -0.02055012543746
lambda[  19] =   0.00838724148007
lambda[  20] =   0.01645141237882
lambda[  21] =   0.02206160017238
lambda[  22] =   0.02655933957498
lambda[  23] =   0.04111175521863
==subpsace eigenproblem: bcast eigvals took 0.044 ms
Total time for solving subspace eigenvalue problem: 0.370 ms
rank =  0, subspace rotation using ScaLAPACK took 9.277 ms
rank =  0, Distributing orbital back into band + domain format took 20.178 ms
rank = 0, Subspace_Rotation used 29.470 ms

Total time for subspace rotation: 29.476 ms
rank = 0, Efermi =  -0.067160921014 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.725 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.724 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.615 ms
rank = 0, Calculating density took 1700.542 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.838 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -63.842239905817
Eband   =   -15.264742556507
E1      =    32.812319654335
E2      =   -14.984472457292
E3      =   -20.282598717342
Exc     =   -18.096018132651
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 2.591e-06, dEband = 2.008e-03
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -63.842239906, dEtot = 2.591e-06, dEband = 2.008e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0481730938712, which took 0.055 ms

iter_count = 108, r_2norm = 1.714e-06, tol*||rhs|| = 1.927e-06

Anderson update took 57.418 ms, out of which F'*F took 26.850 ms; b-Ax took 183.749 ms, out of which Lap took 164.515 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.162 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747036, int_b + int_rho = 6.548e-14, checking this took 0.109 ms
2-norm of RHS = 752.6310849111353, which took 0.141 ms

iter_count = 168, r_2norm = 6.582e-04, tol*||rhs|| = 7.526e-04

Anderson update took 89.883 ms, out of which F'*F took 41.668 ms; b-Ax took 284.132 ms, out of which Lap took 254.206 ms
Solving Poisson took 602.729 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.310867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.338758 
Total time for convolution: 	 convolve: 5.276006 
Total time for convolution: 	 convolve: 5.208414 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.000 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.570 ms

This SCF took 28158.514 ms, scf error = 1.722e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.141112, lowerbound = -1.092269, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1553.291 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 43.167 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.937 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.123 ms
rank =  0, finding HY took 27.117 ms
rank =  0, distributing HY into block cyclic form took 19.647 ms
rank =  0, finding Y'*HY took 4.808 ms
Rank 0, Project_Hamiltonian used 97.729 ms
Total time for projection: 97.746 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.037 ms
rank = 0, Solve_Generalized_EigenProblem used 1.204 ms
    first calculated eigval = -1.091803642279943
    last  calculated eigval = 0.042089053204264
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46628304800722
lambda[   7] =  -0.45817660609483
lambda[   8] =  -0.45193723278523
lambda[   9] =  -0.41488646114821
lambda[  10] =  -0.37227383405020
lambda[  11] =  -0.33161289403055
lambda[  12] =  -0.33123931625434
lambda[  13] =  -0.29900101782912
lambda[  14] =  -0.24084814982237
lambda[  15] =  -0.20370881862335
lambda[  16] =  -0.03791621086358
lambda[  17] =  -0.02175721491316
lambda[  18] =  -0.01853346179132
lambda[  19] =   0.00988539738568
lambda[  20] =   0.01858428120414
lambda[  21] =   0.02386822871679
lambda[  22] =   0.02707455206789
lambda[  23] =   0.04208905320426
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 1.225 ms
rank =  0, subspace rotation using ScaLAPACK took 9.338 ms
rank =  0, Distributing orbital back into band + domain format took 19.927 ms
rank = 0, Subspace_Rotation used 29.283 ms

Total time for subspace rotation: 29.288 ms
rank = 0, Efermi =  -0.066512832832 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.678 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.713 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 1698.666 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.923 ms
rank = 0, Transfering density took 1.926 ms
Etot    =   -63.842266052200
Eband   =   -15.251661641636
E1      =    32.805831262147
E2      =   -14.977738342828
E3      =   -20.283249749454
Exc     =   -18.096553719365
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 2.905e-06, dEband = 1.453e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -63.842266052, dEtot = 2.905e-06, dEband = 1.453e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0323863929224, which took 0.057 ms

iter_count = 108, r_2norm = 1.178e-06, tol*||rhs|| = 1.295e-06

Anderson update took 57.194 ms, out of which F'*F took 26.731 ms; b-Ax took 183.648 ms, out of which Lap took 163.971 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.102 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747029, int_b + int_rho = -3.638e-15, checking this took 0.108 ms
2-norm of RHS = 752.6338777165114, which took 0.138 ms

iter_count = 150, r_2norm = 6.406e-04, tol*||rhs|| = 7.526e-04

Anderson update took 86.389 ms, out of which F'*F took 39.628 ms; b-Ax took 282.433 ms, out of which Lap took 256.182 ms
Solving Poisson took 571.080 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.177874 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.329218 
Total time for convolution: 	 convolve: 5.190593 
Total time for convolution: 	 convolve: 5.213939 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.598 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.016 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.647 ms

This SCF took 27608.715 ms, scf error = 1.142e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.142089, lowerbound = -1.091804, upperbound = 267.585785

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.655 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 32.035 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 35.469 ms
rank =  0, finding HY took 26.630 ms
rank =  0, distributing HY into block cyclic form took 19.655 ms
rank =  0, finding Y'*HY took 4.816 ms
Rank 0, Project_Hamiltonian used 86.606 ms
Total time for projection: 86.627 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -1.091608970177063
    last  calculated eigval = 0.043271864855573
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46609507571050
lambda[   7] =  -0.45798879966212
lambda[   8] =  -0.45174915508996
lambda[   9] =  -0.41469253844495
lambda[  10] =  -0.37209079932657
lambda[  11] =  -0.33142800582266
lambda[  12] =  -0.33105063761326
lambda[  13] =  -0.29880753091303
lambda[  14] =  -0.24065931846422
lambda[  15] =  -0.20351265112987
lambda[  16] =  -0.03764961095655
lambda[  17] =  -0.02161738351627
lambda[  18] =  -0.01744644464990
lambda[  19] =   0.01046357799791
lambda[  20] =   0.01933848775332
lambda[  21] =   0.02458841314817
lambda[  22] =   0.02735351071934
lambda[  23] =   0.04327186485557
==subpsace eigenproblem: bcast eigvals took 0.057 ms
Total time for solving subspace eigenvalue problem: 0.306 ms
rank =  0, subspace rotation using ScaLAPACK took 9.321 ms
rank =  0, Distributing orbital back into band + domain format took 19.957 ms
rank = 0, Subspace_Rotation used 29.294 ms

Total time for subspace rotation: 29.299 ms
rank = 0, Efermi =  -0.066246232889 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.605 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.805 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.624 ms
rank = 0, Calculating density took 1705.050 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.913 ms
rank = 0, D2D took 2.016 ms
rank = 0, Transfering density took 2.019 ms
Etot    =   -63.842302688184
Eband   =   -15.245968446687
E1      =    32.803118651795
E2      =   -14.974702785115
E3      =   -20.283410503706
Exc     =   -18.096696136484
Esc     =   -98.560870044523
Entropy =    -0.000000001105
dE = 4.071e-06, dEband = 6.326e-04
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -63.842302688, dEtot = 4.071e-06, dEband = 6.326e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0230154386518, which took 0.134 ms

iter_count = 114, r_2norm = 5.589e-07, tol*||rhs|| = 9.206e-07

Anderson update took 60.537 ms, out of which F'*F took 28.428 ms; b-Ax took 193.546 ms, out of which Lap took 173.052 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.297 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003747029, int_rho =  30.00000003747019, int_b + int_rho = -1.019e-13, checking this took 0.114 ms
2-norm of RHS = 752.6356253844900, which took 0.072 ms

iter_count = 126, r_2norm = 7.270e-04, tol*||rhs|| = 7.526e-04

Anderson update took 97.592 ms, out of which F'*F took 31.670 ms; b-Ax took 213.439 ms, out of which Lap took 190.789 ms
Solving Poisson took 483.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.223798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.327448 
Total time for convolution: 	 convolve: 5.239947 
Total time for convolution: 	 convolve: 5.356189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.557 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.266 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.858 ms

This SCF took 27801.974 ms, scf error = 8.144e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.46609507571050, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45798879966212, occ[   7] =   2.00000000000000
lambda[   8] =  -0.45174915508996, occ[   8] =   2.00000000000000
lambda[   9] =  -0.41469253844495, occ[   9] =   2.00000000000000
lambda[  10] =  -0.37209079932657, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33142800582266, occ[  11] =   2.00000000000000
lambda[  12] =  -0.33105063761326, occ[  12] =   2.00000000000000
lambda[  13] =  -0.29880753091303, occ[  13] =   2.00000000000000
lambda[  14] =  -0.24065931846422, occ[  14] =   2.00000000000000
lambda[  15] =  -0.20351265112987, occ[  15] =   2.00000000000000
lambda[  16] =  -0.03764961095655, occ[  16] =   0.00000003747030
lambda[  17] =  -0.02161738351627, occ[  17] =   0.00000000000000
lambda[  18] =  -0.01744644464990, occ[  18] =   0.00000000000000
lambda[  19] =   0.01046357799791, occ[  19] =   0.00000000000000
lambda[  20] =   0.01933848775332, occ[  20] =   0.00000000000000
lambda[  21] =   0.02458841314817, occ[  21] =   0.00000000000000
lambda[  22] =   0.02735351071934, occ[  22] =   0.00000000000000
lambda[  23] =   0.04327186485557, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.912 ms, time for Allreduce/Reduce: 9.616 ms 
Time for calculating local force components: 21.728 ms
Start Calculating nonlocal forces
force_nloc = 
  0.80656219135412   0.61767937303387   0.00000059817134
 -0.42978780952802   0.56588037895697  -0.77266517770447
 -0.42978897481345   0.56588118212380   0.77266631045776
 -0.04305355550290  -0.02058154912780  -0.02089901745820
 -0.04305361061717  -0.02058161772304   0.02089901593319
  0.04195047888711  -0.02327637491073  -0.01889026174756
  0.04195057543126  -0.02327639104817   0.01889028014191
  0.00822874404581  -0.16115219273681   0.01158406070700
  0.00822905198547  -0.16114810773096  -0.01158654852788
force_loc = 
 -0.78235329231038  -0.60407845827316   0.00000041390743
  0.41703341383499  -0.54999172941604   0.75440554199161
  0.41703067163191  -0.54999654139006  -0.75440230526026
  0.04625657601680   0.02203504930525   0.02288289412223
  0.04625651306266   0.02203552945807  -0.02288285647145
 -0.04518492759954   0.02577946289753   0.02046803473884
 -0.04518483069574   0.02577977176356  -0.02046791147969
 -0.00780707483863   0.15510690393489  -0.01115971747149
 -0.00780990073408   0.15510994702130   0.01116080308096
Time for calculating nonlocal force components: 42.779 ms
[32mforces_xc: 
[0m[32m -0.03279823909370  -0.02347780857453   0.00000001927688
[0m[32m  0.01642882410992  -0.01731409100804   0.02769638122868
[0m[32m  0.01642862866223  -0.01731440889873  -0.02769621728126
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00023170307278   0.00715446758112   0.00048191275516
[0m[32m -0.00023188799828   0.00715469884586  -0.00048189245100
[0mTime for calculating XC forces components: 30.967 ms
 Cartesian force = 
 -0.00848599140746  -0.00958883760096   0.00000054683791
  0.00377777705938  -0.00113738525424   0.00943626099806
  0.00377367412318  -0.00114171195212  -0.00943269660151
  0.00330636915639   0.00174155639032   0.00198339214628
  0.00330625108798   0.00174196794790  -0.00198432505600
 -0.00313110006994   0.00279114419968   0.00157728847353
 -0.00313090662199   0.00279143692827  -0.00157811585553
  0.00029331477688   0.00139723499208   0.00090577147292
  0.00029061189559   0.00140459434907  -0.00090812241566
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 390.616 ms
The program took 396.327 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:27
Job ID:        2266868
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:21:12,vmem=8392K,walltime=00:06:46,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-17-1
---------------------------------------
