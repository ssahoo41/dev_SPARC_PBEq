---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:21
Job ID:    2266644
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:26
Job ID:    2266644
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 7.333 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 7.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 8.189 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 59.896 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.963 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.125 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   12.211849	    9.167204	
   10.000000	    7.788151	    9.167204	
    8.318248	    9.861636	   11.824460	
   11.681752	   10.138364	   11.824460	
    8.476134	   12.185659	    8.175540	
   11.523866	    7.814341	    8.175540	
   10.000000	   10.000000	   10.637109	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.206 ms
Set up communicators.

--set up spincomm took 3.719 ms

--set up kptcomm took 0.365 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.864 ms

Calculate_SplineDerivRadFun took 0.209 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.271 ms.
time spent on vectorized spline interp: 3.276 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.013 ms.
time spent on vectorized spline interp: 1.387 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.391 ms.
time spent on vectorized spline interp: 1.824 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.315 ms.

Calculating rb for all atom types took 16.497 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.818 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.019 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000210144, sum_int_rho = 19.6041792465186
PosCharge = 20.000000021014, NegCharge = -19.604179246519, scal_fac = 1.020190632289
After scaling, int_rho = 20.0000000210145, PosCharge + NegCharge - NetCharge = -8.882e-14
--Calculate Vref took 0.372 ms
--Calculate rho_guess took 2.300 ms

 integral of b = -20.0000000210144,
 int{b} + Nelectron + NetCharge = -2.101e-08,
 Esc = -64.1981097176413,
 MPI_Reduce took 5.931 ms

Calculating b & b_ref took 14.312 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.040 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.050 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 32.912 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101437, int_b + int_rho = 5.457e-14, checking this took 0.090 ms
2-norm of RHS = 657.3461411526921, which took 0.464 ms

iter_count = 420, r_2norm = 5.188e-04, tol*||rhs|| = 6.573e-04

Anderson update took 269.495 ms, out of which F'*F took 119.677 ms; b-Ax took 814.663 ms, out of which Lap took 729.163 ms
Solving Poisson took 1823.755 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
Total time for convolution: 	 convolve: 5.119194 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.010 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.130932 
Total time for convolution: 	 convolve: 5.114478 
Total time for convolution: 	 convolve: 5.129244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.711 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, XC calculation took 24444.852 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.578 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.661 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.133 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.001 ms
rank =  0, One H*x took 1.903 ms
    Lanczos iter 53, eigmin  = -1.054729866, eigmax = 264.923606007, err_eigmin = 2.854e-04, err_eigmax = 9.830e-03
rank =   0, Lanczos took 137.296 ms, eigmin = -1.054729865719, eigmax = 267.572842066945

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.209056, lowerbound = -1.154730, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1677.184 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.073 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.051 ms
rank =  0, Distribute data + matrix mult took 3.132 ms
rank =  0, finding HY took 26.368 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.952 ms
Rank 0, Project_Hamiltonian used 33.478 ms
Total time for projection: 33.505 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.260 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.368 ms
    first calculated eigval = 2.769899798090990
    last  calculated eigval = 3.263944722466900
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.76989979809099
lambda[   2] =   2.81320948154128
lambda[   3] =   2.86591805007422
lambda[   4] =   2.91067836456659
lambda[   5] =   2.93178878771969
lambda[   6] =   2.93882215315583
lambda[   7] =   2.97134240415169
lambda[   8] =   2.98543432743142
lambda[   9] =   3.01307076530601
lambda[  10] =   3.04005545127198
lambda[  11] =   3.07459276646581
lambda[  12] =   3.10573093513253
lambda[  13] =   3.11869007433160
lambda[  14] =   3.14294900000571
lambda[  15] =   3.15703147495868
lambda[  16] =   3.24008824925681
lambda[  17] =   3.26394472246690
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.718 ms
rank =  0, subspace rotation using ScaLAPACK took 4.745 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 4.768 ms

Total time for subspace rotation: 4.768 ms
rank = 0, Efermi =   3.057324125958 calculate fermi energy took 0.096 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.363945, lowerbound = -1.154730, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1664.995 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 3.001 ms
rank =  0, finding HY took 26.257 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.870 ms
Rank 0, Project_Hamiltonian used 33.165 ms
Total time for projection: 33.189 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -0.821559907614875
    last  calculated eigval = 0.473081696730608
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82155990761488
lambda[   2] =  -0.78125612814249
lambda[   3] =  -0.49332508483004
lambda[   4] =  -0.19924540792556
lambda[   5] =  -0.12822518198444
lambda[   6] =  -0.04696286418891
lambda[   7] =   0.09711911409945
lambda[   8] =   0.16386134731432
lambda[   9] =   0.20149894823006
lambda[  10] =   0.27538206587603
lambda[  11] =   0.34583950365715
lambda[  12] =   0.35681893674465
lambda[  13] =   0.36386408100042
lambda[  14] =   0.38358557817760
lambda[  15] =   0.42392126306830
lambda[  16] =   0.44087464250485
lambda[  17] =   0.47308169673061
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 4.688 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.702 ms

Total time for subspace rotation: 4.703 ms
rank = 0, Efermi =   0.316717671596 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.573082, lowerbound = -1.154730, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1661.840 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.949 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 3.913 ms
rank =  0, finding HY took 26.264 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.893 ms
Rank 0, Project_Hamiltonian used 34.093 ms
Total time for projection: 34.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -1.056268124664219
    last  calculated eigval = 0.161120646129613
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -1.05626812466422
lambda[   2] =  -0.99857950632143
lambda[   3] =  -0.70347627953157
lambda[   4] =  -0.58380647607940
lambda[   5] =  -0.49879885803349
lambda[   6] =  -0.47974043151122
lambda[   7] =  -0.44906557473467
lambda[   8] =  -0.35956954485303
lambda[   9] =  -0.33418095045766
lambda[  10] =  -0.30016690043423
lambda[  11] =   0.05522597449395
lambda[  12] =   0.08995218191655
lambda[  13] =   0.10307668421938
lambda[  14] =   0.11576633087766
lambda[  15] =   0.12633568718747
lambda[  16] =   0.15774464178333
lambda[  17] =   0.16112064612961
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 4.982 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.992 ms

Total time for subspace rotation: 4.993 ms
rank = 0, Efermi =   0.026104142931 calculate fermi energy took 0.034 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.261121, lowerbound = -1.154730, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1660.353 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.986 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.063 ms
rank =  0, Distribute data + matrix mult took 3.054 ms
rank =  0, finding HY took 26.190 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.901 ms
Rank 0, Project_Hamiltonian used 33.169 ms
Total time for projection: 33.174 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -1.056573650612871
    last  calculated eigval = 0.098263582895311
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -1.05657365061287
lambda[   2] =  -0.99884535366814
lambda[   3] =  -0.70471923270667
lambda[   4] =  -0.58554549675157
lambda[   5] =  -0.50986192638126
lambda[   6] =  -0.49626037377479
lambda[   7] =  -0.45427315454872
lambda[   8] =  -0.37821566913246
lambda[   9] =  -0.35468934033101
lambda[  10] =  -0.32886564023354
lambda[  11] =  -0.00394153497911
lambda[  12] =   0.03688032082000
lambda[  13] =   0.04205739382788
lambda[  14] =   0.05572379599345
lambda[  15] =   0.07497709406864
lambda[  16] =   0.08652762565638
lambda[  17] =   0.09826358289531
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.120 ms
rank =  0, subspace rotation using ScaLAPACK took 4.793 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.801 ms

Total time for subspace rotation: 4.802 ms
rank = 0, Efermi =  -0.033063366576 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 2.013 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 6961.612 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
rank = 0, D2D took 0.334 ms
rank = 0, Transfering density took 0.340 ms
Etot    =   -41.536948062347
Eband   =   -11.735699676365
E1      =    22.724967996576
E2      =   -10.207963109359
E3      =   -13.063275707059
Exc     =   -11.599345480705
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 5.934e+00, dEband = 1.677e+00
rank = 0, Calculating/Estimating energy took 1.617 ms, Etot = -41.536948062, dEtot = 5.934e+00, dEband = 1.677e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 64.5912367252753, which took 0.067 ms

iter_count = 90, r_2norm = 2.142e-03, tol*||rhs|| = 2.584e-03

Anderson update took 53.097 ms, out of which F'*F took 26.253 ms; b-Ax took 174.321 ms, out of which Lap took 155.171 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 384.238 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101440, int_b + int_rho = 8.731e-14, checking this took 0.124 ms
2-norm of RHS = 653.4557152835251, which took 0.200 ms

iter_count = 282, r_2norm = 5.785e-04, tol*||rhs|| = 6.535e-04

Anderson update took 167.237 ms, out of which F'*F took 77.892 ms; b-Ax took 523.212 ms, out of which Lap took 467.032 ms
Solving Poisson took 1195.410 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.851 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.103647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.400 ms
Total time for convolution: 	 convolve: 5.101154 
Total time for convolution: 	 convolve: 5.101737 
Total time for convolution: 	 convolve: 5.135827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 33161.141 ms, scf error = 1.353e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198264, lowerbound = -1.056574, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1651.094 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.954 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 2.976 ms
rank =  0, finding HY took 25.737 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.979 ms
Rank 0, Project_Hamiltonian used 32.721 ms
Total time for projection: 32.742 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -1.028683545804774
    last  calculated eigval = 0.077870446232643
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -1.02868354580477
lambda[   2] =  -0.96716894220713
lambda[   3] =  -0.67889574287605
lambda[   4] =  -0.56087434725928
lambda[   5] =  -0.48517040599574
lambda[   6] =  -0.47116182070414
lambda[   7] =  -0.42127735917741
lambda[   8] =  -0.34729012675242
lambda[   9] =  -0.32229066587548
lambda[  10] =  -0.29577603926298
lambda[  11] =  -0.03064380286532
lambda[  12] =   0.00997637590947
lambda[  13] =   0.01726003129663
lambda[  14] =   0.02587818182531
lambda[  15] =   0.04223549263140
lambda[  16] =   0.05961434448741
lambda[  17] =   0.07787044623264
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 4.850 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 4.863 ms

Total time for subspace rotation: 4.865 ms
rank = 0, Efermi =  -0.059765634485 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 2.087 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1692.001 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
rank = 0, D2D took 0.506 ms
rank = 0, Transfering density took 0.516 ms
Etot    =   -41.503527148725
Eband   =   -11.157177992475
E1      =    22.251587985254
E2      =   -10.102658010174
E3      =   -13.221480809231
Exc     =   -11.723966242638
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 4.774e-03, dEband = 8.265e-02
rank = 0, Calculating/Estimating energy took 1.223 ms, Etot = -41.503527149, dEtot = 4.774e-03, dEband = 8.265e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.9663615327690, which took 1.359 ms

iter_count = 96, r_2norm = 8.323e-04, tol*||rhs|| = 9.987e-04

Anderson update took 58.643 ms, out of which F'*F took 27.688 ms; b-Ax took 184.591 ms, out of which Lap took 164.932 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101443, int_b + int_rho = 1.237e-13, checking this took 0.119 ms
2-norm of RHS = 650.2760381864399, which took 0.137 ms

iter_count = 294, r_2norm = 5.226e-04, tol*||rhs|| = 6.503e-04

Anderson update took 174.979 ms, out of which F'*F took 83.124 ms; b-Ax took 564.385 ms, out of which Lap took 503.952 ms
Solving Poisson took 1247.049 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.142493 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 141.811 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.147443 
Total time for convolution: 	 convolve: 5.157917 
Total time for convolution: 	 convolve: 5.157995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.583 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.558 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.097 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.317 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 28115.113 ms, scf error = 8.967e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177870, lowerbound = -1.028684, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1638.106 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.978 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 3.036 ms
rank =  0, finding HY took 25.749 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.850 ms
Rank 0, Project_Hamiltonian used 32.662 ms
Total time for projection: 32.687 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.996775405073787
    last  calculated eigval = 0.070142996606064
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.99677540507379
lambda[   2] =  -0.93233759459341
lambda[   3] =  -0.64090776194076
lambda[   4] =  -0.52924727069071
lambda[   5] =  -0.45102783037653
lambda[   6] =  -0.43590505209185
lambda[   7] =  -0.38375057041138
lambda[   8] =  -0.30820155604009
lambda[   9] =  -0.28551304787146
lambda[  10] =  -0.25792763850845
lambda[  11] =  -0.03544283914053
lambda[  12] =  -0.00445006247519
lambda[  13] =   0.00609255640417
lambda[  14] =   0.02255898431184
lambda[  15] =   0.02933796896474
lambda[  16] =   0.04622863520230
lambda[  17] =   0.07014299660606
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 4.916 ms
rank =  0, Distributing orbital back into band + domain format took 0.006 ms
rank = 0, Subspace_Rotation used 4.931 ms

Total time for subspace rotation: 4.933 ms
rank = 0, Efermi =  -0.064564670702 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.963 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.028 ms
rank = 0, Calculating density took 1678.883 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, D2D took 0.416 ms
rank = 0, Transfering density took 0.422 ms
Etot    =   -41.482174877745
Eband   =   -10.443187455942
E1      =    21.693158197081
E2      =    -9.923056038107
E3      =   -13.434579460524
Exc     =   -11.891671399244
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 3.050e-03, dEband = 1.020e-01
rank = 0, Calculating/Estimating energy took 1.341 ms, Etot = -41.482174878, dEtot = 3.050e-03, dEband = 1.020e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.1948388532757, which took 0.122 ms

iter_count = 102, r_2norm = 1.919e-04, tol*||rhs|| = 2.078e-04

Anderson update took 64.999 ms, out of which F'*F took 29.792 ms; b-Ax took 198.288 ms, out of which Lap took 177.506 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 448.521 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101447, int_b + int_rho = 1.601e-13, checking this took 0.134 ms
2-norm of RHS = 651.4004605849962, which took 0.137 ms

iter_count = 282, r_2norm = 5.233e-04, tol*||rhs|| = 6.514e-04

Anderson update took 167.864 ms, out of which F'*F took 78.454 ms; b-Ax took 532.066 ms, out of which Lap took 474.262 ms
Solving Poisson took 1176.526 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.175546 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.605 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.170684 
Total time for convolution: 	 convolve: 5.178259 
Total time for convolution: 	 convolve: 6.315377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.767 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.355 ms

This SCF took 29250.767 ms, scf error = 3.782e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.170143, lowerbound = -0.996775, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1638.941 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.045 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.110 ms
rank =  0, Distribute data + matrix mult took 3.162 ms
rank =  0, finding HY took 25.749 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.916 ms
Rank 0, Project_Hamiltonian used 32.851 ms
Total time for projection: 32.864 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.043 ms
rank = 0, Solve_Generalized_EigenProblem used 0.856 ms
    first calculated eigval = -0.990505714785035
    last  calculated eigval = 0.064184248555421
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.99050571478503
lambda[   2] =  -0.92721480302238
lambda[   3] =  -0.62496907471915
lambda[   4] =  -0.51950487273493
lambda[   5] =  -0.43730894411576
lambda[   6] =  -0.42174717065347
lambda[   7] =  -0.37688160974967
lambda[   8] =  -0.29688319004200
lambda[   9] =  -0.27892897531742
lambda[  10] =  -0.25103732003196
lambda[  11] =  -0.03567276576930
lambda[  12] =  -0.00757688631939
lambda[  13] =   0.00220896007830
lambda[  14] =   0.01928690906665
lambda[  15] =   0.02654906739686
lambda[  16] =   0.03852613017551
lambda[  17] =   0.06418424855542
==subpsace eigenproblem: bcast eigvals took 0.522 ms
Total time for solving subspace eigenvalue problem: 1.391 ms
rank =  0, subspace rotation using ScaLAPACK took 4.927 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.936 ms

Total time for subspace rotation: 4.938 ms
rank = 0, Efermi =  -0.064794597328 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.075 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1680.410 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
rank = 0, D2D took 0.492 ms
rank = 0, Transfering density took 0.499 ms
Etot    =   -41.478155430887
Eband   =   -10.249963351093
E1      =    21.585632921004
E2      =    -9.826069001845
E3      =   -13.498893180419
Exc     =   -11.940677464790
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 5.742e-04, dEband = 2.760e-02
rank = 0, Calculating/Estimating energy took 1.565 ms, Etot = -41.478155431, dEtot = 5.742e-04, dEband = 2.760e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7918695315353, which took 0.102 ms

iter_count = 102, r_2norm = 1.090e-04, tol*||rhs|| = 1.117e-04

Anderson update took 62.268 ms, out of which F'*F took 30.087 ms; b-Ax took 200.348 ms, out of which Lap took 179.449 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.293 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101446, int_b + int_rho = 1.564e-13, checking this took 0.117 ms
2-norm of RHS = 651.6865440397505, which took 0.120 ms

iter_count = 252, r_2norm = 5.473e-04, tol*||rhs|| = 6.517e-04

Anderson update took 153.551 ms, out of which F'*F took 70.242 ms; b-Ax took 475.870 ms, out of which Lap took 423.177 ms
Solving Poisson took 1056.089 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.174206 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 87.637 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.225 ms
Total time for convolution: 	 convolve: 5.186028 
Total time for convolution: 	 convolve: 5.182701 
Total time for convolution: 	 convolve: 5.184162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.318 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.335 ms

This SCF took 28127.560 ms, scf error = 9.722e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.164184, lowerbound = -0.990506, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1648.956 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.782 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 2.815 ms
rank =  0, finding HY took 25.551 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.791 ms
Rank 0, Project_Hamiltonian used 32.966 ms
Total time for projection: 44.372 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.987264095880957
    last  calculated eigval = 0.059966708487491
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98726409588096
lambda[   2] =  -0.92391723565119
lambda[   3] =  -0.62146595786837
lambda[   4] =  -0.51632054660718
lambda[   5] =  -0.43386451460142
lambda[   6] =  -0.41827407728152
lambda[   7] =  -0.37359397607098
lambda[   8] =  -0.29330824434260
lambda[   9] =  -0.27563911422867
lambda[  10] =  -0.24766733177159
lambda[  11] =  -0.03587611100926
lambda[  12] =  -0.00844541699093
lambda[  13] =   0.00091496730566
lambda[  14] =   0.01725199257125
lambda[  15] =   0.02519139904450
lambda[  16] =   0.03397035014730
lambda[  17] =   0.05996670848749
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 5.149 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.155 ms

Total time for subspace rotation: 5.156 ms
rank = 0, Efermi =  -0.064997942575 calculate fermi energy took 1.374 ms
rank = 0, --- Calculate rho: sum over local bands took 2.033 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1702.172 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
rank = 0, D2D took 0.516 ms
rank = 0, Transfering density took 0.528 ms
Etot    =   -41.477742377709
Eband   =   -10.182630189363
E1      =    21.552575912158
E2      =    -9.787562700846
E3      =   -13.516159919996
Exc     =   -11.953301003074
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 5.901e-05, dEband = 9.619e-03
rank = 0, Calculating/Estimating energy took 1.228 ms, Etot = -41.477742378, dEtot = 5.901e-05, dEband = 9.619e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6798903836306, which took 0.062 ms

iter_count = 114, r_2norm = 1.842e-05, tol*||rhs|| = 2.720e-05

Anderson update took 69.933 ms, out of which F'*F took 33.607 ms; b-Ax took 223.666 ms, out of which Lap took 200.599 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 500.922 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101442, int_b + int_rho = 1.091e-13, checking this took 0.090 ms
2-norm of RHS = 651.9712465132983, which took 0.147 ms

iter_count = 252, r_2norm = 5.457e-04, tol*||rhs|| = 6.520e-04

Anderson update took 150.413 ms, out of which F'*F took 69.737 ms; b-Ax took 473.904 ms, out of which Lap took 421.670 ms
Solving Poisson took 1050.860 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.113 ms
Total time for convolution: 	 convolve: 5.175745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 111.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.186297 
Total time for convolution: 	 convolve: 5.181991 
Total time for convolution: 	 convolve: 5.184721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 28116.522 ms, scf error = 5.567e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.159967, lowerbound = -0.987264, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1642.094 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.953 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 3.009 ms
rank =  0, finding HY took 25.758 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.784 ms
Rank 0, Project_Hamiltonian used 32.575 ms
Total time for projection: 32.605 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.984212569910498
    last  calculated eigval = 0.056098833555026
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98421256991050
lambda[   2] =  -0.92082288391229
lambda[   3] =  -0.61921009677721
lambda[   4] =  -0.51370722751813
lambda[   5] =  -0.43146186882911
lambda[   6] =  -0.41582124319776
lambda[   7] =  -0.37072306362593
lambda[   8] =  -0.29062807671643
lambda[   9] =  -0.27278805418583
lambda[  10] =  -0.24479467955962
lambda[  11] =  -0.03583430476663
lambda[  12] =  -0.00857969435489
lambda[  13] =   0.00106890659281
lambda[  14] =   0.01619046981348
lambda[  15] =   0.02491266171822
lambda[  16] =   0.03117258633216
lambda[  17] =   0.05609883355503
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.875 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.887 ms

Total time for subspace rotation: 4.887 ms
rank = 0, Efermi =  -0.064956136367 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.187 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1682.392 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.488 ms
rank = 0, Transfering density took 0.492 ms
Etot    =   -41.477535309329
Eband   =   -10.128339529219
E1      =    21.531900575214
E2      =    -9.751347613177
E3      =   -13.524361902855
Exc     =   -11.958696153084
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 2.958e-05, dEband = 7.756e-03
rank = 0, Calculating/Estimating energy took 2.928 ms, Etot = -41.477535309, dEtot = 2.958e-05, dEband = 7.756e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3446869790980, which took 0.059 ms

iter_count = 108, r_2norm = 1.273e-05, tol*||rhs|| = 1.379e-05

Anderson update took 66.157 ms, out of which F'*F took 31.776 ms; b-Ax took 212.859 ms, out of which Lap took 190.902 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.995 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101449, int_b + int_rho = 1.783e-13, checking this took 0.136 ms
2-norm of RHS = 652.0715783169658, which took 0.182 ms

iter_count = 246, r_2norm = 6.407e-04, tol*||rhs|| = 6.521e-04

Anderson update took 147.235 ms, out of which F'*F took 67.747 ms; b-Ax took 467.083 ms, out of which Lap took 415.044 ms
Solving Poisson took 1029.258 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.181421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 108.307 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.191037 
Total time for convolution: 	 convolve: 5.190588 
Total time for convolution: 	 convolve: 5.176706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.662 ms

This SCF took 28288.480 ms, scf error = 2.613e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.156099, lowerbound = -0.984213, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.060 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.923 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 2.943 ms
rank =  0, finding HY took 25.997 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.850 ms
Rank 0, Project_Hamiltonian used 32.817 ms
Total time for projection: 32.840 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.122 ms
    first calculated eigval = -0.980462422675658
    last  calculated eigval = 0.052894245562824
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.98046242267566
lambda[   2] =  -0.91723268092097
lambda[   3] =  -0.61538615870454
lambda[   4] =  -0.51011047896188
lambda[   5] =  -0.42771103476827
lambda[   6] =  -0.41196256027960
lambda[   7] =  -0.36699818573380
lambda[   8] =  -0.28691521411616
lambda[   9] =  -0.26932442703851
lambda[  10] =  -0.24126688645175
lambda[  11] =  -0.03513338355813
lambda[  12] =  -0.00794050469720
lambda[  13] =   0.00316589098280
lambda[  14] =   0.01608273457536
lambda[  15] =   0.02590103285900
lambda[  16] =   0.03028156926045
lambda[  17] =   0.05289424556282
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.517 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.526 ms

Total time for subspace rotation: 4.527 ms
rank = 0, Efermi =  -0.064255215164 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 2.324 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1686.100 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
rank = 0, D2D took 0.408 ms
rank = 0, Transfering density took 0.410 ms
Etot    =   -41.477456119350
Eband   =   -10.054740100041
E1      =    21.494900785951
E2      =    -9.712208031265
E3      =   -13.533499000791
Exc     =   -11.965214119045
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.131e-05, dEband = 1.051e-02
rank = 0, Calculating/Estimating energy took 2.695 ms, Etot = -41.477456119, dEtot = 1.131e-05, dEband = 1.051e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2464276353139, which took 0.068 ms

iter_count = 114, r_2norm = 5.995e-06, tol*||rhs|| = 9.857e-06

Anderson update took 69.363 ms, out of which F'*F took 33.274 ms; b-Ax took 227.391 ms, out of which Lap took 204.543 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 502.574 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101456, int_b + int_rho = 2.474e-13, checking this took 0.087 ms
2-norm of RHS = 652.0825818425534, which took 0.197 ms

iter_count = 216, r_2norm = 6.465e-04, tol*||rhs|| = 6.521e-04

Anderson update took 129.254 ms, out of which F'*F took 59.348 ms; b-Ax took 405.430 ms, out of which Lap took 360.891 ms
Solving Poisson took 902.748 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.182125 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 89.460 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.194738 
Total time for convolution: 	 convolve: 5.186442 
Total time for convolution: 	 convolve: 5.175085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.697 ms
---Transfer Veff_loc: D2D took 0.795 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.140 ms

This SCF took 27922.861 ms, scf error = 1.216e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.152894, lowerbound = -0.980462, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 3239.549 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.964 ms
rank =  0, finding HY took 25.645 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.778 ms
Rank 0, Project_Hamiltonian used 32.415 ms
Total time for projection: 32.441 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.979724779539520
    last  calculated eigval = 0.049841799905575
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97972477953952
lambda[   2] =  -0.91641597406917
lambda[   3] =  -0.61484653305595
lambda[   4] =  -0.50944821153655
lambda[   5] =  -0.42712873563564
lambda[   6] =  -0.41140045889027
lambda[   7] =  -0.36615911535203
lambda[   8] =  -0.28617519555491
lambda[   9] =  -0.26850949252884
lambda[  10] =  -0.24044079605406
lambda[  11] =  -0.03442723944027
lambda[  12] =  -0.00688992791712
lambda[  13] =   0.00482504383821
lambda[  14] =   0.01635877765654
lambda[  15] =   0.02617075047910
lambda[  16] =   0.02971955238823
lambda[  17] =   0.04984179990558
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 4.863 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.873 ms

Total time for subspace rotation: 4.873 ms
rank = 0, Efermi =  -0.063549071044 calculate fermi energy took 0.095 ms
rank = 0, --- Calculate rho: sum over local bands took 2.253 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 3279.471 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
rank = 0, D2D took 0.465 ms
rank = 0, Transfering density took 0.474 ms
Etot    =   -41.477573502824
Eband   =   -10.040498585157
E1      =    21.490027689563
E2      =    -9.702729206881
E3      =   -13.533068910905
Exc     =   -11.964791006744
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.677e-05, dEband = 2.035e-03
rank = 0, Calculating/Estimating energy took 1.938 ms, Etot = -41.477573503, dEtot = 1.677e-05, dEband = 2.035e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1354527946849, which took 0.105 ms

iter_count = 114, r_2norm = 3.703e-06, tol*||rhs|| = 5.418e-06

Anderson update took 70.010 ms, out of which F'*F took 33.549 ms; b-Ax took 226.236 ms, out of which Lap took 203.220 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 503.851 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101451, int_b + int_rho = 2.037e-13, checking this took 0.118 ms
2-norm of RHS = 652.0765712769786, which took 0.165 ms

iter_count = 216, r_2norm = 5.721e-04, tol*||rhs|| = 6.521e-04

Anderson update took 129.011 ms, out of which F'*F took 60.019 ms; b-Ax took 407.598 ms, out of which Lap took 362.256 ms
Solving Poisson took 902.766 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.182907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.450 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.180205 
Total time for convolution: 	 convolve: 5.177462 
Total time for convolution: 	 convolve: 5.200925 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 29496.020 ms, scf error = 9.828e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.149842, lowerbound = -0.979725, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1644.845 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.960 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.441 ms
rank =  0, Distribute data + matrix mult took 3.408 ms
rank =  0, finding HY took 26.000 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.000 ms
Rank 0, Project_Hamiltonian used 33.436 ms
Total time for projection: 33.459 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.978669518015324
    last  calculated eigval = 0.046834782488815
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97866951801532
lambda[   2] =  -0.91539315779155
lambda[   3] =  -0.61356533011774
lambda[   4] =  -0.50833282520089
lambda[   5] =  -0.42589476817500
lambda[   6] =  -0.41016475737678
lambda[   7] =  -0.36504021354004
lambda[   8] =  -0.28498422161811
lambda[   9] =  -0.26745135415310
lambda[  10] =  -0.23935608107192
lambda[  11] =  -0.03260945356590
lambda[  12] =  -0.00425089546272
lambda[  13] =   0.00751306833787
lambda[  14] =   0.01740638468403
lambda[  15] =   0.02727221290792
lambda[  16] =   0.03049733326849
lambda[  17] =   0.04683478248882
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.881 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.890 ms

Total time for subspace rotation: 4.891 ms
rank = 0, Efermi =  -0.061731285171 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 2.245 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1685.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
rank = 0, D2D took 0.474 ms
rank = 0, Transfering density took 0.477 ms
Etot    =   -41.477607129042
Eband   =   -10.017704454806
E1      =    21.478319203343
E2      =    -9.691213078843
E3      =   -13.534965262655
Exc     =   -11.966290500805
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 4.804e-06, dEband = 3.256e-03
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -41.477607129, dEtot = 4.804e-06, dEband = 3.256e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1014574099607, which took 0.073 ms

iter_count = 108, r_2norm = 3.480e-06, tol*||rhs|| = 4.058e-06

Anderson update took 66.147 ms, out of which F'*F took 32.169 ms; b-Ax took 212.025 ms, out of which Lap took 190.301 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.108 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101443, int_b + int_rho = 1.237e-13, checking this took 0.139 ms
2-norm of RHS = 652.0652776423728, which took 0.141 ms

iter_count = 210, r_2norm = 5.332e-04, tol*||rhs|| = 6.521e-04

Anderson update took 125.371 ms, out of which F'*F took 58.119 ms; b-Ax took 398.984 ms, out of which Lap took 355.759 ms
Solving Poisson took 878.038 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.190515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.736 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.196506 
Total time for convolution: 	 convolve: 5.191235 
Total time for convolution: 	 convolve: 5.239936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.766 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 28134.420 ms, scf error = 5.532e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.146835, lowerbound = -0.978670, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1638.943 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.966 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 3.022 ms
rank =  0, finding HY took 25.770 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.983 ms
Rank 0, Project_Hamiltonian used 32.801 ms
Total time for projection: 32.826 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.977237580210957
    last  calculated eigval = 0.044009705387110
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97723758021096
lambda[   2] =  -0.91399003180796
lambda[   3] =  -0.61219431382513
lambda[   4] =  -0.50696478662996
lambda[   5] =  -0.42451728890108
lambda[   6] =  -0.40879239856365
lambda[   7] =  -0.36372122577409
lambda[   8] =  -0.28366127537410
lambda[   9] =  -0.26611195713029
lambda[  10] =  -0.23800957759442
lambda[  11] =  -0.02929231416244
lambda[  12] =   0.00072289395926
lambda[  13] =   0.01023517295236
lambda[  14] =   0.01977388999536
lambda[  15] =   0.02895349845521
lambda[  16] =   0.03121564763942
lambda[  17] =   0.04400970538711
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 5.044 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.056 ms

Total time for subspace rotation: 5.057 ms
rank = 0, Efermi =  -0.058414145766 calculate fermi energy took 0.103 ms
rank = 0, --- Calculate rho: sum over local bands took 2.187 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1680.254 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.843 ms
rank = 0, D2D took 0.939 ms
rank = 0, Transfering density took 0.946 ms
Etot    =   -41.477685034953
Eband   =    -9.990400872239
E1      =    21.463783468204
E2      =    -9.677881392790
E3      =   -13.537465709555
Exc     =   -11.968305014992
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.113e-05, dEband = 3.901e-03
rank = 0, Calculating/Estimating energy took 1.100 ms, Etot = -41.477685035, dEtot = 1.113e-05, dEband = 3.901e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1039592136268, which took 0.056 ms

iter_count = 102, r_2norm = 3.785e-06, tol*||rhs|| = 4.158e-06

Anderson update took 62.395 ms, out of which F'*F took 29.996 ms; b-Ax took 199.635 ms, out of which Lap took 178.990 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 448.640 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101448, int_b + int_rho = 1.673e-13, checking this took 0.127 ms
2-norm of RHS = 652.0883951054714, which took 0.138 ms

iter_count = 180, r_2norm = 5.723e-04, tol*||rhs|| = 6.521e-04

Anderson update took 107.067 ms, out of which F'*F took 49.605 ms; b-Ax took 339.663 ms, out of which Lap took 301.197 ms
Solving Poisson took 752.774 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.173474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 98.427 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.185639 
Total time for convolution: 	 convolve: 5.197063 
Total time for convolution: 	 convolve: 5.167244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.152 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.337 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.356 ms

This SCF took 27691.115 ms, scf error = 3.358e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.144010, lowerbound = -0.977238, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1648.160 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.934 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.086 ms
rank =  0, Distribute data + matrix mult took 3.024 ms
rank =  0, finding HY took 26.040 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.960 ms
Rank 0, Project_Hamiltonian used 33.049 ms
Total time for projection: 33.082 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.977018951286279
    last  calculated eigval = 0.041679811937526
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97701895128628
lambda[   2] =  -0.91380083197973
lambda[   3] =  -0.61191848747708
lambda[   4] =  -0.50671357091162
lambda[   5] =  -0.42424908764783
lambda[   6] =  -0.40853022842491
lambda[   7] =  -0.36355450863087
lambda[   8] =  -0.28346117173068
lambda[   9] =  -0.26593538178116
lambda[  10] =  -0.23783755530772
lambda[  11] =  -0.02823305429049
lambda[  12] =   0.00223989064842
lambda[  13] =   0.01003091955193
lambda[  14] =   0.02069894687018
lambda[  15] =   0.02887512731532
lambda[  16] =   0.03095060103071
lambda[  17] =   0.04167981193753
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 5.093 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 5.869 ms

Total time for subspace rotation: 5.870 ms
rank = 0, Efermi =  -0.057354885901 calculate fermi energy took 0.623 ms
rank = 0, --- Calculate rho: sum over local bands took 1.986 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.029 ms
rank = 0, Calculating density took 1689.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
rank = 0, D2D took 0.420 ms
rank = 0, Transfering density took 0.427 ms
Etot    =   -41.477748888814
Eband   =    -9.986039550949
E1      =    21.462397140378
E2      =    -9.674956647397
E3      =   -13.537052301489
Exc     =   -11.968005708856
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 9.122e-06, dEband = 6.230e-04
rank = 0, Calculating/Estimating energy took 1.418 ms, Etot = -41.477748889, dEtot = 9.122e-06, dEband = 6.230e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0652952139386, which took 0.119 ms

iter_count = 108, r_2norm = 1.619e-06, tol*||rhs|| = 2.612e-06

Anderson update took 66.084 ms, out of which F'*F took 32.195 ms; b-Ax took 211.770 ms, out of which Lap took 189.841 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.868 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101437, int_b + int_rho = 5.821e-14, checking this took 0.136 ms
2-norm of RHS = 652.0991444882901, which took 0.181 ms

iter_count = 174, r_2norm = 5.454e-04, tol*||rhs|| = 6.521e-04

Anderson update took 103.841 ms, out of which F'*F took 47.830 ms; b-Ax took 327.171 ms, out of which Lap took 291.029 ms
Solving Poisson took 727.534 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.185602 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 41.562 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.189199 
Total time for convolution: 	 convolve: 5.175258 
Total time for convolution: 	 convolve: 5.185811 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 27730.022 ms, scf error = 2.840e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.141680, lowerbound = -0.977019, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.253 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.946 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 3.006 ms
rank =  0, finding HY took 25.772 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.851 ms
Rank 0, Project_Hamiltonian used 32.660 ms
Total time for projection: 32.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.976646552932479
    last  calculated eigval = 0.041308087658911
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97664655293248
lambda[   2] =  -0.91342270445465
lambda[   3] =  -0.61153952527469
lambda[   4] =  -0.50633520487492
lambda[   5] =  -0.42387721740690
lambda[   6] =  -0.40815750598078
lambda[   7] =  -0.36317259338984
lambda[   8] =  -0.28308319850817
lambda[   9] =  -0.26556186669556
lambda[  10] =  -0.23746459359374
lambda[  11] =  -0.02584901715919
lambda[  12] =   0.00517111054898
lambda[  13] =   0.01095474841216
lambda[  14] =   0.02211794511569
lambda[  15] =   0.02938994535342
lambda[  16] =   0.03358662846242
lambda[  17] =   0.04130808765891
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 5.136 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 5.145 ms

Total time for subspace rotation: 5.147 ms
rank = 0, Efermi =  -0.054970848746 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.090 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1686.985 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.047 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
rank = 0, D2D took 0.553 ms
rank = 0, Transfering density took 0.556 ms
Etot    =   -41.477783873724
Eband   =    -9.978521926767
E1      =    21.458914544843
E2      =    -9.670803737618
E3      =   -13.537455657752
Exc     =   -11.968326168900
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 4.998e-06, dEband = 1.074e-03
rank = 0, Calculating/Estimating energy took 1.273 ms, Etot = -41.477783874, dEtot = 4.998e-06, dEband = 1.074e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0512057199393, which took 0.062 ms

iter_count = 108, r_2norm = 1.389e-06, tol*||rhs|| = 2.048e-06

Anderson update took 65.988 ms, out of which F'*F took 31.705 ms; b-Ax took 212.120 ms, out of which Lap took 189.878 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.710 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101452, int_b + int_rho = 2.110e-13, checking this took 0.134 ms
2-norm of RHS = 652.0971434489410, which took 0.149 ms

iter_count = 156, r_2norm = 5.263e-04, tol*||rhs|| = 6.521e-04

Anderson update took 93.014 ms, out of which F'*F took 43.095 ms; b-Ax took 294.509 ms, out of which Lap took 261.751 ms
Solving Poisson took 653.049 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.189029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.582 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.178194 
Total time for convolution: 	 convolve: 5.176426 
Total time for convolution: 	 convolve: 5.197337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.704 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.351 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.372 ms

This SCF took 27628.643 ms, scf error = 2.521e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.141308, lowerbound = -0.976647, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1645.374 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.939 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.982 ms
rank =  0, finding HY took 26.825 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.844 ms
Rank 0, Project_Hamiltonian used 33.679 ms
Total time for projection: 33.700 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.976438687228965
    last  calculated eigval = 0.040940011898514
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97643868722896
lambda[   2] =  -0.91320997144495
lambda[   3] =  -0.61131369350705
lambda[   4] =  -0.50612290915819
lambda[   5] =  -0.42365793091662
lambda[   6] =  -0.40793448952107
lambda[   7] =  -0.36294377572573
lambda[   8] =  -0.28285398342418
lambda[   9] =  -0.26534193470196
lambda[  10] =  -0.23724403650190
lambda[  11] =  -0.02467855057927
lambda[  12] =   0.00615918521098
lambda[  13] =   0.01130306302619
lambda[  14] =   0.02272520404466
lambda[  15] =   0.02918741097914
lambda[  16] =   0.03626432689975
lambda[  17] =   0.04094001189851
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 5.196 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 5.210 ms

Total time for subspace rotation: 5.211 ms
rank = 0, Efermi =  -0.053800382137 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.989 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1687.072 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 0.265 ms
rank = 0, D2D took 0.417 ms
rank = 0, Transfering density took 0.425 ms
Etot    =   -41.477802526009
Eband   =    -9.974122824780
E1      =    21.456570059192
E2      =    -9.668651222531
E3      =   -13.537874276122
Exc     =   -11.968665540801
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 2.665e-06, dEband = 6.284e-04
rank = 0, Calculating/Estimating energy took 1.426 ms, Etot = -41.477802526, dEtot = 2.665e-06, dEband = 6.284e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0483455432368, which took 0.061 ms

iter_count = 108, r_2norm = 1.470e-06, tol*||rhs|| = 1.934e-06

Anderson update took 66.248 ms, out of which F'*F took 31.985 ms; b-Ax took 211.595 ms, out of which Lap took 190.032 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.214 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101447, int_b + int_rho = 1.637e-13, checking this took 0.121 ms
2-norm of RHS = 652.0960444785956, which took 0.126 ms

iter_count = 90, r_2norm = 6.274e-04, tol*||rhs|| = 6.521e-04

Anderson update took 53.688 ms, out of which F'*F took 25.237 ms; b-Ax took 169.597 ms, out of which Lap took 150.925 ms
Solving Poisson took 378.055 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.175999 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 75.945 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.187655 
Total time for convolution: 	 convolve: 5.205471 
Total time for convolution: 	 convolve: 5.198130 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 27385.852 ms, scf error = 1.837e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.140940, lowerbound = -0.976439, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1639.123 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.036 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 3.061 ms
rank =  0, finding HY took 25.711 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.927 ms
Rank 0, Project_Hamiltonian used 33.448 ms
Total time for projection: 33.481 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.604 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.039 ms
rank = 0, Solve_Generalized_EigenProblem used 0.648 ms
    first calculated eigval = -0.976384292421111
    last  calculated eigval = 0.039898769926038
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97638429242111
lambda[   2] =  -0.91315480485153
lambda[   3] =  -0.61126263400306
lambda[   4] =  -0.50607208904271
lambda[   5] =  -0.42360704756155
lambda[   6] =  -0.40788302590261
lambda[   7] =  -0.36288988883974
lambda[   8] =  -0.28280122245839
lambda[   9] =  -0.26528840934277
lambda[  10] =  -0.23719011991708
lambda[  11] =  -0.02460630246520
lambda[  12] =   0.00615244065679
lambda[  13] =   0.01128632040025
lambda[  14] =   0.02265210004620
lambda[  15] =   0.02892668982852
lambda[  16] =   0.03650512918240
lambda[  17] =   0.03989876992604
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.664 ms
rank =  0, subspace rotation using ScaLAPACK took 4.783 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.793 ms

Total time for subspace rotation: 4.794 ms
rank = 0, Efermi =  -0.053728134052 calculate fermi energy took 0.117 ms
rank = 0, --- Calculate rho: sum over local bands took 2.292 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1680.579 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
rank = 0, D2D took 0.423 ms
rank = 0, Transfering density took 0.430 ms
Etot    =   -41.477804900165
Eband   =    -9.973067069198
E1      =    21.455952481945
E2      =    -9.668173949361
E3      =   -13.538041799999
Exc     =   -11.968796344001
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 3.392e-07, dEband = 1.508e-04
rank = 0, Calculating/Estimating energy took 1.793 ms, Etot = -41.477804900, dEtot = 3.392e-07, dEband = 1.508e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0402388871659, which took 0.063 ms

iter_count = 108, r_2norm = 1.406e-06, tol*||rhs|| = 1.610e-06

Anderson update took 66.203 ms, out of which F'*F took 31.763 ms; b-Ax took 211.758 ms, out of which Lap took 189.474 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.498 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101447, int_b + int_rho = 1.601e-13, checking this took 0.157 ms
2-norm of RHS = 652.0963835190687, which took 0.161 ms

iter_count = 108, r_2norm = 6.077e-04, tol*||rhs|| = 6.521e-04

Anderson update took 64.465 ms, out of which F'*F took 29.771 ms; b-Ax took 203.811 ms, out of which Lap took 181.057 ms
Solving Poisson took 453.423 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.192341 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.448 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 6.092323 
Total time for convolution: 	 convolve: 5.186447 
Total time for convolution: 	 convolve: 5.186070 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 28330.817 ms, scf error = 1.604e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139899, lowerbound = -0.976384, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1648.496 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.374 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 3.415 ms
rank =  0, finding HY took 27.260 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.856 ms
Rank 0, Project_Hamiltonian used 35.349 ms
Total time for projection: 35.378 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.976286113775548
    last  calculated eigval = 0.039211353018233
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97628611377555
lambda[   2] =  -0.91305809891708
lambda[   3] =  -0.61117114751304
lambda[   4] =  -0.50598000783351
lambda[   5] =  -0.42351569306564
lambda[   6] =  -0.40779213449948
lambda[   7] =  -0.36280099306095
lambda[   8] =  -0.28271331379327
lambda[   9] =  -0.26519867613088
lambda[  10] =  -0.23709968078456
lambda[  11] =  -0.02477331814933
lambda[  12] =   0.00580016860698
lambda[  13] =   0.01110073537729
lambda[  14] =   0.02258147940033
lambda[  15] =   0.02858133505995
lambda[  16] =   0.03663312597851
lambda[  17] =   0.03921135301823
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.956 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.964 ms

Total time for subspace rotation: 4.965 ms
rank = 0, Efermi =  -0.053895149757 calculate fermi energy took 0.104 ms
rank = 0, --- Calculate rho: sum over local bands took 2.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1691.341 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
rank = 0, D2D took 0.459 ms
rank = 0, Transfering density took 0.468 ms
Etot    =   -41.477819023129
Eband   =    -9.971231719269
E1      =    21.454959847801
E2      =    -9.667267712451
E3      =   -13.538247116864
Exc     =   -11.968952262704
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 2.018e-06, dEband = 2.622e-04
rank = 0, Calculating/Estimating energy took 1.691 ms, Etot = -41.477819023, dEtot = 2.018e-06, dEband = 2.622e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0523103158790, which took 0.060 ms

iter_count = 96, r_2norm = 2.039e-06, tol*||rhs|| = 2.092e-06

Anderson update took 58.830 ms, out of which F'*F took 28.218 ms; b-Ax took 188.077 ms, out of which Lap took 168.643 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.199 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101440, int_b + int_rho = 9.459e-14, checking this took 0.148 ms
2-norm of RHS = 652.1034760068501, which took 0.169 ms

iter_count = 156, r_2norm = 6.279e-04, tol*||rhs|| = 6.521e-04

Anderson update took 92.909 ms, out of which F'*F took 43.072 ms; b-Ax took 293.621 ms, out of which Lap took 261.296 ms
Solving Poisson took 652.160 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.129 ms
Total time for convolution: 	 convolve: 5.169293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.891 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.189614 
Total time for convolution: 	 convolve: 5.182139 
Total time for convolution: 	 convolve: 5.178678 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.914 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 27627.119 ms, scf error = 1.393e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139211, lowerbound = -0.976286, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1639.385 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.938 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 2.975 ms
rank =  0, finding HY took 25.794 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.848 ms
Rank 0, Project_Hamiltonian used 32.646 ms
Total time for projection: 32.670 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.976235702528998
    last  calculated eigval = 0.041965920397287
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97623570252900
lambda[   2] =  -0.91300806140731
lambda[   3] =  -0.61109793438936
lambda[   4] =  -0.50591324162869
lambda[   5] =  -0.42344377470039
lambda[   6] =  -0.40772364872400
lambda[   7] =  -0.36273799019816
lambda[   8] =  -0.28264542133393
lambda[   9] =  -0.26514166142281
lambda[  10] =  -0.23704309701485
lambda[  11] =  -0.02519807755808
lambda[  12] =   0.00390975958717
lambda[  13] =   0.01125555853507
lambda[  14] =   0.02424550496385
lambda[  15] =   0.02859344747867
lambda[  16] =   0.03848626260369
lambda[  17] =   0.04196592039729
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.909 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.916 ms

Total time for subspace rotation: 4.917 ms
rank = 0, Efermi =  -0.054319909176 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.216 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1679.506 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, D2D took 0.426 ms
rank = 0, Transfering density took 0.428 ms
Etot    =   -41.477856216184
Eband   =    -9.969981067227
E1      =    21.454890285734
E2      =    -9.666154979440
E3      =   -13.537767151770
Exc     =   -11.968577847629
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 5.313e-06, dEband = 1.787e-04
rank = 0, Calculating/Estimating energy took 1.656 ms, Etot = -41.477856216, dEtot = 5.313e-06, dEband = 1.787e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0404837858686, which took 0.068 ms

iter_count = 102, r_2norm = 1.544e-06, tol*||rhs|| = 1.619e-06

Anderson update took 62.488 ms, out of which F'*F took 29.885 ms; b-Ax took 200.356 ms, out of which Lap took 179.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.140 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101453, int_b + int_rho = 2.219e-13, checking this took 0.151 ms
2-norm of RHS = 652.0984184046829, which took 0.174 ms

iter_count = 114, r_2norm = 5.871e-04, tol*||rhs|| = 6.521e-04

Anderson update took 67.749 ms, out of which F'*F took 31.578 ms; b-Ax took 217.097 ms, out of which Lap took 193.274 ms
Solving Poisson took 480.009 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.206549 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.242 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.166801 
Total time for convolution: 	 convolve: 5.220860 
Total time for convolution: 	 convolve: 5.189429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.125 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.045 ms
---Transfer Veff_loc: D2D took 1.136 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.156 ms

This SCF took 27519.749 ms, scf error = 2.133e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.141966, lowerbound = -0.976236, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.665 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.953 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 3.032 ms
rank =  0, finding HY took 26.004 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.824 ms
Rank 0, Project_Hamiltonian used 32.890 ms
Total time for projection: 32.918 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.976023504302002
    last  calculated eigval = 0.040339739966743
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97602350430200
lambda[   2] =  -0.91279677286541
lambda[   3] =  -0.61091017871984
lambda[   4] =  -0.50572166938341
lambda[   5] =  -0.42325628978841
lambda[   6] =  -0.40753460335279
lambda[   7] =  -0.36254021076808
lambda[   8] =  -0.28245506364743
lambda[   9] =  -0.26494436086299
lambda[  10] =  -0.23684295065107
lambda[  11] =  -0.02424380597114
lambda[  12] =   0.00567599130223
lambda[  13] =   0.01164326214777
lambda[  14] =   0.02366560748129
lambda[  15] =   0.02877629653041
lambda[  16] =   0.03860336271208
lambda[  17] =   0.04033973996674
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 4.638 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.647 ms

Total time for subspace rotation: 4.648 ms
rank = 0, Efermi =  -0.053365637526 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.281 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.029 ms
rank = 0, Calculating density took 1686.820 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.264 ms
rank = 0, D2D took 0.406 ms
rank = 0, Transfering density took 0.408 ms
Etot    =   -41.477843408372
Eband   =    -9.966051209192
E1      =    21.452489664975
E2      =    -9.664473064593
E3      =   -13.538493429052
Exc     =   -11.969138639528
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.830e-06, dEband = 5.614e-04
rank = 0, Calculating/Estimating energy took 2.859 ms, Etot = -41.477843408, dEtot = 1.830e-06, dEband = 5.614e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0356225236150, which took 0.072 ms

iter_count = 108, r_2norm = 1.041e-06, tol*||rhs|| = 1.425e-06

Anderson update took 66.335 ms, out of which F'*F took 31.914 ms; b-Ax took 212.029 ms, out of which Lap took 190.120 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.217 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101454, int_b + int_rho = 2.292e-13, checking this took 0.147 ms
2-norm of RHS = 652.0986316417614, which took 0.211 ms

iter_count = 78, r_2norm = 5.833e-04, tol*||rhs|| = 6.521e-04

Anderson update took 46.449 ms, out of which F'*F took 21.527 ms; b-Ax took 146.406 ms, out of which Lap took 130.220 ms
Solving Poisson took 327.784 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.180985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 100.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.193183 
Total time for convolution: 	 convolve: 5.167766 
Total time for convolution: 	 convolve: 5.209090 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.331 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 27393.923 ms, scf error = 1.193e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.140340, lowerbound = -0.976024, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1642.055 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.973 ms
rank =  0, finding HY took 25.749 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 3.891 ms
Rank 0, Project_Hamiltonian used 32.644 ms
Total time for projection: 32.661 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.975972577859553
    last  calculated eigval = 0.040370239857549
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97597257785955
lambda[   2] =  -0.91274709873500
lambda[   3] =  -0.61086372150258
lambda[   4] =  -0.50567464963337
lambda[   5] =  -0.42321032560763
lambda[   6] =  -0.40748819648054
lambda[   7] =  -0.36249452683073
lambda[   8] =  -0.28241057304594
lambda[   9] =  -0.26489890511053
lambda[  10] =  -0.23679713104802
lambda[  11] =  -0.02411988457345
lambda[  12] =   0.00568899146173
lambda[  13] =   0.01174994941424
lambda[  14] =   0.02384146442077
lambda[  15] =   0.02887381276953
lambda[  16] =   0.03904941025675
lambda[  17] =   0.04037023985755
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 4.926 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.933 ms

Total time for subspace rotation: 4.934 ms
rank = 0, Efermi =  -0.053241716186 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.209 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1682.177 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, D2D took 0.470 ms
rank = 0, Transfering density took 0.474 ms
Etot    =   -41.477844425631
Eband   =    -9.965115412215
E1      =    21.451976718290
E2      =    -9.664016491320
E3      =   -13.538629943070
Exc     =   -11.969242447825
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.453e-07, dEband = 1.337e-04
rank = 0, Calculating/Estimating energy took 3.488 ms, Etot = -41.477844426, dEtot = 1.453e-07, dEband = 1.337e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0263452972929, which took 0.119 ms

iter_count = 108, r_2norm = 9.826e-07, tol*||rhs|| = 1.054e-06

Anderson update took 66.757 ms, out of which F'*F took 31.929 ms; b-Ax took 211.416 ms, out of which Lap took 190.032 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.444 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101450, int_b + int_rho = 1.892e-13, checking this took 0.153 ms
2-norm of RHS = 652.1006553835282, which took 0.144 ms

iter_count = 102, r_2norm = 6.392e-04, tol*||rhs|| = 6.521e-04

Anderson update took 60.650 ms, out of which F'*F took 28.296 ms; b-Ax took 192.516 ms, out of which Lap took 171.200 ms
Solving Poisson took 428.094 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.196498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.184161 
Total time for convolution: 	 convolve: 5.183428 
Total time for convolution: 	 convolve: 5.164762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 27391.234 ms, scf error = 1.114e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.140370, lowerbound = -0.975973, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1644.328 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.922 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 2.944 ms
rank =  0, finding HY took 25.905 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.956 ms
Rank 0, Project_Hamiltonian used 32.836 ms
Total time for projection: 32.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.975897078909241
    last  calculated eigval = 0.040828259415223
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97589707890924
lambda[   2] =  -0.91267390946007
lambda[   3] =  -0.61078907833667
lambda[   4] =  -0.50560046291399
lambda[   5] =  -0.42313629965593
lambda[   6] =  -0.40741345074216
lambda[   7] =  -0.36242395540965
lambda[   8] =  -0.28233980871160
lambda[   9] =  -0.26482848368550
lambda[  10] =  -0.23672679532087
lambda[  11] =  -0.02393604916424
lambda[  12] =   0.00571227731282
lambda[  13] =   0.01207207945241
lambda[  14] =   0.02432604556564
lambda[  15] =   0.02911172593892
lambda[  16] =   0.03957849760870
lambda[  17] =   0.04082825941522
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 5.014 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.026 ms

Total time for subspace rotation: 5.027 ms
rank = 0, Efermi =  -0.053057880773 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 2.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1684.659 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.423 ms
rank = 0, D2D took 1.523 ms
rank = 0, Transfering density took 1.531 ms
Etot    =   -41.477851477253
Eband   =    -9.963658646794
E1      =    21.451301406202
E2      =    -9.663211169195
E3      =   -13.538701025284
Exc     =   -11.969296712869
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 1.007e-06, dEband = 2.081e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -41.477851477, dEtot = 1.007e-06, dEband = 2.081e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0458562747463, which took 0.070 ms

iter_count = 102, r_2norm = 1.568e-06, tol*||rhs|| = 1.834e-06

Anderson update took 62.527 ms, out of which F'*F took 29.891 ms; b-Ax took 201.072 ms, out of which Lap took 180.836 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.299 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101450, int_b + int_rho = 1.892e-13, checking this took 0.123 ms
2-norm of RHS = 652.0970598554782, which took 0.160 ms

iter_count = 132, r_2norm = 5.820e-04, tol*||rhs|| = 6.521e-04

Anderson update took 78.813 ms, out of which F'*F took 36.251 ms; b-Ax took 248.343 ms, out of which Lap took 221.316 ms
Solving Poisson took 552.531 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.199701 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.169856 
Total time for convolution: 	 convolve: 5.192206 
Total time for convolution: 	 convolve: 5.189688 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 27564.635 ms, scf error = 1.196e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.140828, lowerbound = -0.975897, upperbound = 267.572842

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1656.333 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.959 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 3.039 ms
rank =  0, finding HY took 25.787 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.937 ms
Rank 0, Project_Hamiltonian used 32.794 ms
Total time for projection: 32.825 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.975931576526976
    last  calculated eigval = 0.038825755873486
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.97593157652698
lambda[   2] =  -0.91270813580226
lambda[   3] =  -0.61083968176269
lambda[   4] =  -0.50564395732020
lambda[   5] =  -0.42318585714453
lambda[   6] =  -0.40746274832788
lambda[   7] =  -0.36246724245644
lambda[   8] =  -0.28238949299513
lambda[   9] =  -0.26487099906856
lambda[  10] =  -0.23676937692247
lambda[  11] =  -0.02586024604418
lambda[  12] =   0.00359243669999
lambda[  13] =   0.01084550931850
lambda[  14] =   0.02313506217439
lambda[  15] =   0.02824933839224
lambda[  16] =   0.03666234902325
lambda[  17] =   0.03882575587349
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 5.090 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 5.096 ms

Total time for subspace rotation: 5.097 ms
rank = 0, Efermi =  -0.054982077676 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.728 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1697.788 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
rank = 0, D2D took 0.327 ms
rank = 0, Transfering density took 0.332 ms
Etot    =   -41.477857117285
Eband   =    -9.964538137198
E1      =    21.451523584483
E2      =    -9.663848426059
E3      =   -13.538738691032
Exc     =   -11.969319963389
Esc     =   -64.198109717641
Entropy =    -0.000000000630
dE = 8.057e-07, dEband = 1.256e-04
rank = 0, Calculating/Estimating energy took 1.165 ms, Etot = -41.477857117, dEtot = 8.057e-07, dEband = 1.256e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0317014623169, which took 0.058 ms

iter_count = 102, r_2norm = 1.090e-06, tol*||rhs|| = 1.268e-06

Anderson update took 62.579 ms, out of which F'*F took 29.945 ms; b-Ax took 200.734 ms, out of which Lap took 179.692 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.235 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002101431, int_rho =  20.00000002101446, int_b + int_rho = 1.528e-13, checking this took 0.129 ms
2-norm of RHS = 652.0969886078643, which took 0.115 ms

iter_count = 120, r_2norm = 6.277e-04, tol*||rhs|| = 6.521e-04

Anderson update took 74.300 ms, out of which F'*F took 33.077 ms; b-Ax took 226.920 ms, out of which Lap took 201.690 ms
Solving Poisson took 506.304 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.205735 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.170400 
Total time for convolution: 	 convolve: 5.193208 
Total time for convolution: 	 convolve: 5.169846 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.583 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.348 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.369 ms

This SCF took 27436.683 ms, scf error = 7.250e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.97593157652698, occ[   1] =   2.00000000000000
lambda[   2] =  -0.91270813580226, occ[   2] =   2.00000000000000
lambda[   3] =  -0.61083968176269, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50564395732020, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42318585714453, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40746274832788, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36246724245644, occ[   7] =   2.00000000000000
lambda[   8] =  -0.28238949299513, occ[   8] =   2.00000000000000
lambda[   9] =  -0.26487099906856, occ[   9] =   2.00000000000000
lambda[  10] =  -0.23676937692247, occ[  10] =   2.00000000000000
lambda[  11] =  -0.02586024604418, occ[  11] =   0.00000002101447
lambda[  12] =   0.00359243669999, occ[  12] =   0.00000000000000
lambda[  13] =   0.01084550931850, occ[  13] =   0.00000000000000
lambda[  14] =   0.02313506217439, occ[  14] =   0.00000000000000
lambda[  15] =   0.02824933839224, occ[  15] =   0.00000000000000
lambda[  16] =   0.03666234902325, occ[  16] =   0.00000000000000
lambda[  17] =   0.03882575587349, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.514 ms, time for Allreduce/Reduce: 6.818 ms 
Time for calculating local force components: 16.300 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.76704542596695  -0.71420530663695  -0.01460275143689
  0.76704381312292   0.71420346673706  -0.01460291409248
  0.04219593024936   0.00349580180856  -0.03068963652286
 -0.04219596095071  -0.00349585545424  -0.03068963180953
  0.06185979260670  -0.00089071284179   0.04223176021766
 -0.06185981148396   0.00089069541675   0.04223173404281
 -0.00000038254406   0.00000008736920  -0.20616040204531
force_loc = 
  0.74671337887286   0.69860355794161   0.01309281256824
 -0.74671257130131  -0.69860241315709   0.01309298070465
 -0.04633638494849  -0.00403003557250   0.03363138960546
  0.04633624988059   0.00402985222866   0.03363111989348
 -0.06522381694534   0.00258264921485  -0.04493046793032
  0.06522375340743  -0.00258267261102  -0.04492991313190
  0.00000116693319   0.00000074373737   0.19821156486237
Time for calculating nonlocal force components: 27.889 ms
[32mforces_xc: 
[0m[32m  0.02271030699643   0.02149805329524  -0.00035329621949
[0m[32m -0.02271018897405  -0.02149803126534  -0.00035320046816
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000004573095   0.00000001013964   0.01118889544709
[0mTime for calculating XC forces components: 21.509 ms
 Cartesian force = 
  0.00237827494726   0.00589632026419  -0.00186324132882
 -0.00237893210752  -0.00589696202108  -0.00186314009668
 -0.00414043965421  -0.00053421809965   0.00294174684191
  0.00414030397480   0.00053401243870   0.00294148184326
 -0.00336400929372   0.00169195203734  -0.00269871395334
  0.00336395696840  -0.00169196152999  -0.00269818532978
  0.00000084516500   0.00000085691049   0.00324005202347
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.049 ms
Time for printing density: 404.040 ms
The program took 592.384 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:19
Job ID:        2266644
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:02:00,vmem=8348K,walltime=00:10:10,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-5-1
---------------------------------------
