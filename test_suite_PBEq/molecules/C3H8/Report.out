---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:07
Job ID:    2266763
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:11
Job ID:    2266763
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.055 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 14.112 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 11.
[32m
Time for finding element is 0.011 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 22.264 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 70.239 ms

Freeing SPARC_INPUT_MPI datatype took 0.018 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.960 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.118 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.655992	   10.000000	   12.034988	
    8.344008	   10.000000	   12.034988	
   10.000000	   14.109157	   10.370297	
   10.000000	    5.890843	   10.370297	
   11.669254	   12.496132	    7.965012	
    8.330746	   12.496132	    7.965012	
    8.330746	    7.503868	    7.965012	
   11.669254	    7.503868	    7.965012	
   10.000000	   10.000000	   10.787110	
   10.000000	   12.411685	    9.187957	
   10.000000	    7.588315	    9.187957	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.007 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.217 ms
Set up communicators.

--set up spincomm took 3.959 ms

--set up kptcomm took 0.386 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.120 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.569 ms

Calculate_SplineDerivRadFun took 0.118 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.389 ms.
time spent on vectorized spline interp: 2.760 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.047 ms.
time spent on vectorized spline interp: 1.631 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.671 ms.

Calculating rb for all atom types took 11.508 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.069 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000262177, sum_int_rho = 19.2048743325999
PosCharge = 20.000000026218, NegCharge = -19.204874332600, scal_fac = 1.041402285683
After scaling, int_rho = 20.0000000262177, PosCharge + NegCharge - NetCharge = -1.066e-14
--Calculate Vref took 0.492 ms
--Calculate rho_guess took 2.634 ms

 integral of b = -20.0000000262177,
 int{b} + Nelectron + NetCharge = -2.622e-08,
 Esc = -42.6836696115905,
 MPI_Reduce took 10.162 ms

Calculating b & b_ref took 19.963 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.008 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.100 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 33.876 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621763, int_b + int_rho = -1.201e-13, checking this took 0.266 ms
2-norm of RHS = 767.6949713735245, which took 1.052 ms

iter_count = 414, r_2norm = 7.570e-04, tol*||rhs|| = 7.677e-04

Anderson update took 206.647 ms, out of which F'*F took 98.154 ms; b-Ax took 654.994 ms, out of which Lap took 593.664 ms
Solving Poisson took 1302.752 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
Total time for convolution: 	 convolve: 5.202860 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
Total time for convolution: 	 convolve: 5.251123 
Total time for convolution: 	 convolve: 5.161997 
Total time for convolution: 	 convolve: 5.190304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.527 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
rank = 0, XC calculation took 24684.057 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.602 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.809 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.133 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.694 ms
    Lanczos iter 53, eigmin  = -0.810895467, eigmax = 264.928866106, err_eigmin = 4.276e-04, err_eigmax = 9.977e-03
rank =   0, Lanczos took 127.235 ms, eigmin = -0.810895467387, eigmax = 267.578154766852

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.333630, lowerbound = -0.910895, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1472.644 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.045 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 3.068 ms
rank =  0, finding HY took 25.593 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.267 ms
Rank 0, Project_Hamiltonian used 32.043 ms
Total time for projection: 32.060 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.323 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.419 ms
    first calculated eigval = 2.760261924474672
    last  calculated eigval = 3.266410818909230
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.76026192447467
lambda[   2] =   2.82453650398332
lambda[   3] =   2.86056583071141
lambda[   4] =   2.91024638168701
lambda[   5] =   2.92623157993798
lambda[   6] =   2.94468751050020
lambda[   7] =   2.96808780998533
lambda[   8] =   2.97791575987935
lambda[   9] =   3.02311730661573
lambda[  10] =   3.03547168561957
lambda[  11] =   3.07284076620389
lambda[  12] =   3.10742069823662
lambda[  13] =   3.11352211892211
lambda[  14] =   3.14055028732788
lambda[  15] =   3.15694627261647
lambda[  16] =   3.23498198026694
lambda[  17] =   3.26641081890923
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.435 ms
rank =  0, subspace rotation using ScaLAPACK took 3.585 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.591 ms

Total time for subspace rotation: 3.592 ms
rank = 0, Efermi =   3.054156285501 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.366411, lowerbound = -0.910895, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1195.265 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.825 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.844 ms
rank =  0, finding HY took 20.987 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.970 ms
Rank 0, Project_Hamiltonian used 26.821 ms
Total time for projection: 26.833 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.520827030405807
    last  calculated eigval = 0.469333187521726
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.52082703040581
lambda[   2] =  -0.41214378134059
lambda[   3] =  -0.17871510121481
lambda[   4] =  -0.14501570079385
lambda[   5] =  -0.09731573268088
lambda[   6] =  -0.04204692650490
lambda[   7] =   0.10347159777447
lambda[   8] =   0.19992126373304
lambda[   9] =   0.24749632222781
lambda[  10] =   0.27039908248494
lambda[  11] =   0.32640943818120
lambda[  12] =   0.35033133857826
lambda[  13] =   0.37828422741733
lambda[  14] =   0.39069374716986
lambda[  15] =   0.41754470595777
lambda[  16] =   0.45693544486657
lambda[  17] =   0.46933318752173
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.164 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.170 ms

Total time for subspace rotation: 3.171 ms
rank = 0, Efermi =   0.298575825762 calculate fermi energy took 0.040 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.569333, lowerbound = -0.910895, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1201.721 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.856 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.874 ms
rank =  0, finding HY took 21.086 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.039 ms
Rank 0, Project_Hamiltonian used 27.015 ms
Total time for projection: 27.019 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.813685925546454
    last  calculated eigval = 0.155775918181278
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81368592554645
lambda[   2] =  -0.72477063358318
lambda[   3] =  -0.63048187374040
lambda[   4] =  -0.50123584519273
lambda[   5] =  -0.48277110014883
lambda[   6] =  -0.45316576315409
lambda[   7] =  -0.42885828528032
lambda[   8] =  -0.38609701151382
lambda[   9] =  -0.37841032223466
lambda[  10] =  -0.25884013307547
lambda[  11] =   0.06238222050630
lambda[  12] =   0.07465183754537
lambda[  13] =   0.11064614433811
lambda[  14] =   0.11869720910331
lambda[  15] =   0.12774213652939
lambda[  16] =   0.14559161924465
lambda[  17] =   0.15577591818128
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.128 ms
rank =  0, subspace rotation using ScaLAPACK took 3.065 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.070 ms

Total time for subspace rotation: 3.071 ms
rank = 0, Efermi =   0.033460226050 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.255776, lowerbound = -0.910895, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1190.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.853 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.894 ms
rank =  0, finding HY took 21.135 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.948 ms
Rank 0, Project_Hamiltonian used 26.994 ms
Total time for projection: 26.997 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.815292930592940
    last  calculated eigval = 0.097299992207162
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81529293059294
lambda[   2] =  -0.72956052557179
lambda[   3] =  -0.63658400974821
lambda[   4] =  -0.50565932570201
lambda[   5] =  -0.49243354917544
lambda[   6] =  -0.46162291280166
lambda[   7] =  -0.44107495421436
lambda[   8] =  -0.40715065225860
lambda[   9] =  -0.39915954297560
lambda[  10] =  -0.38193742851537
lambda[  11] =   0.01133777424895
lambda[  12] =   0.03485649384814
lambda[  13] =   0.05178526375388
lambda[  14] =   0.06528224431326
lambda[  15] =   0.07451744185236
lambda[  16] =   0.08001597681469
lambda[  17] =   0.09729999220716
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.130 ms
rank =  0, subspace rotation using ScaLAPACK took 3.129 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.134 ms

Total time for subspace rotation: 3.135 ms
rank = 0, Efermi =  -0.017584220308 calculate fermi energy took 0.018 ms
rank = 0, --- Calculate rho: sum over local bands took 1.565 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 5317.943 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, D2D took 0.349 ms
rank = 0, Transfering density took 0.356 ms
Etot    =   -22.968980239720
Eband   =   -10.540951662815
E1      =    21.902103841367
E2      =    -7.089265013596
E3      =   -10.041580112643
Exc     =    -8.777307932139
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 2.088e+00, dEband = 9.583e-01
rank = 0, Calculating/Estimating energy took 0.885 ms, Etot = -22.968980240, dEtot = 2.088e+00, dEband = 9.583e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 42.5425178632952, which took 0.039 ms

iter_count = 96, r_2norm = 1.607e-03, tol*||rhs|| = 1.702e-03

Anderson update took 41.359 ms, out of which F'*F took 21.709 ms; b-Ax took 142.438 ms, out of which Lap took 129.782 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 276.853 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621767, int_b + int_rho = -8.731e-14, checking this took 0.924 ms
2-norm of RHS = 763.1564381107842, which took 0.093 ms

iter_count = 282, r_2norm = 7.290e-04, tol*||rhs|| = 7.632e-04

Anderson update took 120.961 ms, out of which F'*F took 63.664 ms; b-Ax took 415.747 ms, out of which Lap took 381.745 ms
Solving Poisson took 796.586 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.902 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.279016 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.281399 
Total time for convolution: 	 convolve: 5.240380 
Total time for convolution: 	 convolve: 5.208716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.762 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.344 ms

This SCF took 31431.505 ms, scf error = 2.212e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.197300, lowerbound = -0.815293, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1723.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.844 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.885 ms
rank =  0, finding HY took 31.584 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 16.673 ms
Rank 0, Project_Hamiltonian used 51.164 ms
Total time for projection: 51.174 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.034 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.784111150091326
    last  calculated eigval = 0.074067512792063
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.78411115009133
lambda[   2] =  -0.69518676552029
lambda[   3] =  -0.60521655333674
lambda[   4] =  -0.47860582782968
lambda[   5] =  -0.46291637817313
lambda[   6] =  -0.43001745091041
lambda[   7] =  -0.41070097540752
lambda[   8] =  -0.37500253681061
lambda[   9] =  -0.37016853003362
lambda[  10] =  -0.35754209056371
lambda[  11] =  -0.02217269803055
lambda[  12] =   0.01598847395635
lambda[  13] =   0.02192745761295
lambda[  14] =   0.03521639552926
lambda[  15] =   0.04314346439452
lambda[  16] =   0.05043383274722
lambda[  17] =   0.07406751279206
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.070 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.075 ms

Total time for subspace rotation: 3.076 ms
rank = 0, Efermi =  -0.051094692444 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.583 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1779.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
rank = 0, D2D took 0.342 ms
rank = 0, Transfering density took 0.344 ms
Etot    =   -22.918386070819
Eband   =    -9.938936517935
E1      =    21.343709031746
E2      =    -7.066253009415
E3      =   -10.210948459123
Exc     =    -8.916690440796
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 4.599e-03, dEband = 5.473e-02
rank = 0, Calculating/Estimating energy took 19.519 ms, Etot = -22.918386071, dEtot = 4.599e-03, dEband = 5.473e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 13.3356339596540, which took 18.480 ms

iter_count = 102, r_2norm = 5.044e-04, tol*||rhs|| = 5.334e-04

Anderson update took 160.131 ms, out of which F'*F took 23.526 ms; b-Ax took 310.067 ms, out of which Lap took 297.207 ms
rank = 0, Mixing (+ precond) took 627.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621763, int_b + int_rho = -1.201e-13, checking this took 0.088 ms
2-norm of RHS = 755.2603162641149, which took 0.079 ms

iter_count = 300, r_2norm = 6.831e-04, tol*||rhs|| = 7.553e-04

Anderson update took 270.831 ms, out of which F'*F took 85.850 ms; b-Ax took 563.810 ms, out of which Lap took 524.273 ms
Solving Poisson took 1132.408 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Total time for convolution: 	 convolve: 5.364136 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 278.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.372990 
Total time for convolution: 	 convolve: 5.212140 
Total time for convolution: 	 convolve: 5.218337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.515 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.172 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 29004.125 ms, scf error = 1.560e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.174068, lowerbound = -0.784111, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1181.161 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.851 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.871 ms
rank =  0, finding HY took 20.930 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.918 ms
Rank 0, Project_Hamiltonian used 26.739 ms
Total time for projection: 26.750 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.724363060977821
    last  calculated eigval = 0.063731042032972
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.72436306097782
lambda[   2] =  -0.63093680738979
lambda[   3] =  -0.54323771026797
lambda[   4] =  -0.42515236933164
lambda[   5] =  -0.40620476120038
lambda[   6] =  -0.37053059229297
lambda[   7] =  -0.35312817942109
lambda[   8] =  -0.31387664282456
lambda[   9] =  -0.31298762629854
lambda[  10] =  -0.30444775791588
lambda[  11] =  -0.03154007923221
lambda[  12] =   0.01123410146814
lambda[  13] =   0.01251509829921
lambda[  14] =   0.02023090782549
lambda[  15] =   0.02726025881982
lambda[  16] =   0.03453659736189
lambda[  17] =   0.06373104203297
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 3.172 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.178 ms

Total time for subspace rotation: 3.178 ms
rank = 0, Efermi =  -0.060462073701 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.592 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1213.029 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
rank = 0, D2D took 0.342 ms
rank = 0, Transfering density took 0.344 ms
Etot    =   -22.869700564569
Eband   =    -8.769731016668
E1      =    20.301495579144
E2      =    -6.916111614859
E3      =   -10.603283180841
Exc     =    -9.237190310373
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 4.426e-03, dEband = 1.063e-01
rank = 0, Calculating/Estimating energy took 0.853 ms, Etot = -22.869700565, dEtot = 4.426e-03, dEband = 1.063e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.7167031109896, which took 0.050 ms

iter_count = 108, r_2norm = 1.181e-04, tol*||rhs|| = 1.887e-04

Anderson update took 45.305 ms, out of which F'*F took 24.510 ms; b-Ax took 162.581 ms, out of which Lap took 147.939 ms
rank = 0, Mixing (+ precond) took 315.134 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621768, int_b + int_rho = -7.276e-14, checking this took 0.082 ms
2-norm of RHS = 754.8399212578140, which took 0.078 ms

iter_count = 270, r_2norm = 6.209e-04, tol*||rhs|| = 7.548e-04

Anderson update took 126.277 ms, out of which F'*F took 83.523 ms; b-Ax took 428.542 ms, out of which Lap took 392.121 ms
Solving Poisson took 813.822 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.250112 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.187063 
Total time for convolution: 	 convolve: 5.190703 
Total time for convolution: 	 convolve: 5.190960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.308 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 27158.400 ms, scf error = 5.002e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.163731, lowerbound = -0.724363, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 2269.767 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.847 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 2.868 ms
rank =  0, finding HY took 21.856 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.052 ms
Rank 0, Project_Hamiltonian used 27.797 ms
Total time for projection: 27.810 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.716753074332817
    last  calculated eigval = 0.057735181489411
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.71675307433282
lambda[   2] =  -0.62363995738362
lambda[   3] =  -0.53357804907451
lambda[   4] =  -0.41598084587929
lambda[   5] =  -0.39810155292697
lambda[   6] =  -0.36275648602455
lambda[   7] =  -0.34480005169107
lambda[   8] =  -0.30661522259992
lambda[   9] =  -0.30436393728644
lambda[  10] =  -0.29391703713528
lambda[  11] =  -0.03361863349121
lambda[  12] =   0.00919127268561
lambda[  13] =   0.00994906301460
lambda[  14] =   0.01455711298182
lambda[  15] =   0.01853768830045
lambda[  16] =   0.02703279622738
lambda[  17] =   0.05773518148941
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.039 ms
rank = 0, Efermi =  -0.062540628040 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 1.493 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 2302.433 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.362 ms
rank = 0, Transfering density took 0.367 ms
Etot    =   -22.865402066398
Eband   =    -8.601012429550
E1      =    20.198475064266
E2      =    -6.835597110112
E3      =   -10.681650280242
Exc     =    -9.296442479096
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 3.908e-04, dEband = 1.534e-02
rank = 0, Calculating/Estimating energy took 2.719 ms, Etot = -22.865402066, dEtot = 3.908e-04, dEband = 1.534e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3948137822748, which took 0.054 ms

iter_count = 114, r_2norm = 3.728e-05, tol*||rhs|| = 5.579e-05

Anderson update took 48.202 ms, out of which F'*F took 25.801 ms; b-Ax took 172.105 ms, out of which Lap took 156.550 ms
rank = 0, Mixing (+ precond) took 333.470 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621764, int_b + int_rho = -1.091e-13, checking this took 0.075 ms
2-norm of RHS = 754.7647692146199, which took 0.079 ms

iter_count = 252, r_2norm = 6.916e-04, tol*||rhs|| = 7.548e-04

Anderson update took 106.734 ms, out of which F'*F took 57.152 ms; b-Ax took 379.662 ms, out of which Lap took 343.918 ms
Solving Poisson took 726.503 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.206453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.535 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.234111 
Total time for convolution: 	 convolve: 5.200137 
Total time for convolution: 	 convolve: 5.231050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
---Transfer Veff_loc: D2D took 0.290 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.306 ms

This SCF took 28282.788 ms, scf error = 1.583e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.157735, lowerbound = -0.716753, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1188.375 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.855 ms
rank =  0, finding HY took 21.008 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.080 ms
Rank 0, Project_Hamiltonian used 26.962 ms
Total time for projection: 26.974 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.031 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.710896439534082
    last  calculated eigval = 0.053030777749851
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.71089643953408
lambda[   2] =  -0.61758689205477
lambda[   3] =  -0.52734776578229
lambda[   4] =  -0.41003237377013
lambda[   5] =  -0.39216266343146
lambda[   6] =  -0.35687882476495
lambda[   7] =  -0.33873787588316
lambda[   8] =  -0.30081939291192
lambda[   9] =  -0.29847479066919
lambda[  10] =  -0.28769454836925
lambda[  11] =  -0.03387183417272
lambda[  12] =   0.00826593991463
lambda[  13] =   0.00923007257057
lambda[  14] =   0.01191245530583
lambda[  15] =   0.01496660329756
lambda[  16] =   0.02299372121875
lambda[  17] =   0.05303077774985
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.092 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.098 ms

Total time for subspace rotation: 3.098 ms
rank = 0, Efermi =  -0.062793828733 calculate fermi energy took 2.223 ms
rank = 0, --- Calculate rho: sum over local bands took 1.518 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1222.459 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
rank = 0, D2D took 0.348 ms
rank = 0, Transfering density took 0.354 ms
Etot    =   -22.864259592954
Eband   =    -8.481263135230
E1      =    20.124623900758
E2      =    -6.780047618793
E3      =   -10.725063634340
Exc     =    -9.329061999243
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 1.039e-04, dEband = 1.089e-02
rank = 0, Calculating/Estimating energy took 0.981 ms, Etot = -22.864259593, dEtot = 1.039e-04, dEband = 1.089e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5553578366989, which took 0.052 ms

iter_count = 114, r_2norm = 1.476e-05, tol*||rhs|| = 2.221e-05

Anderson update took 49.062 ms, out of which F'*F took 25.897 ms; b-Ax took 172.706 ms, out of which Lap took 156.907 ms
rank = 0, Mixing (+ precond) took 340.737 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621766, int_b + int_rho = -9.823e-14, checking this took 0.082 ms
2-norm of RHS = 755.2294354447345, which took 0.066 ms

iter_count = 252, r_2norm = 6.316e-04, tol*||rhs|| = 7.552e-04

Anderson update took 107.587 ms, out of which F'*F took 57.022 ms; b-Ax took 395.915 ms, out of which Lap took 360.792 ms
Solving Poisson took 741.532 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.210731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.155 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.204724 
Total time for convolution: 	 convolve: 5.213314 
Total time for convolution: 	 convolve: 5.242245 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
---Transfer Veff_loc: D2D took 0.302 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.318 ms

This SCF took 27219.268 ms, scf error = 7.415e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.153031, lowerbound = -0.710896, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1184.494 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.839 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.859 ms
rank =  0, finding HY took 21.040 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.932 ms
Rank 0, Project_Hamiltonian used 26.850 ms
Total time for projection: 26.864 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.104 ms
    first calculated eigval = -0.705213120842221
    last  calculated eigval = 0.048409015414645
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.70521312084222
lambda[   2] =  -0.61172967735079
lambda[   3] =  -0.52240691290157
lambda[   4] =  -0.40500929985939
lambda[   5] =  -0.38666529200033
lambda[   6] =  -0.35139754749078
lambda[   7] =  -0.33329834565050
lambda[   8] =  -0.29521238790346
lambda[   9] =  -0.29336122966006
lambda[  10] =  -0.28300250511267
lambda[  11] =  -0.03296516497530
lambda[  12] =   0.00853597258330
lambda[  13] =   0.00969693070437
lambda[  14] =   0.01138646963160
lambda[  15] =   0.01452632136442
lambda[  16] =   0.02174374246281
lambda[  17] =   0.04840901541464
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 3.001 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.011 ms

Total time for subspace rotation: 3.012 ms
rank = 0, Efermi =  -0.061887159481 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.544 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1216.267 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
rank = 0, D2D took 0.342 ms
rank = 0, Transfering density took 0.351 ms
Etot    =   -22.863772603216
Eband   =    -8.374592638408
E1      =    20.074429678466
E2      =    -6.717743919845
E3      =   -10.745215984991
Exc     =    -9.342899935738
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 4.427e-05, dEband = 9.697e-03
rank = 0, Calculating/Estimating energy took 2.566 ms, Etot = -22.863772603, dEtot = 4.427e-05, dEband = 9.697e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2717528384793, which took 0.078 ms

iter_count = 114, r_2norm = 8.404e-06, tol*||rhs|| = 1.087e-05

Anderson update took 48.323 ms, out of which F'*F took 25.786 ms; b-Ax took 171.893 ms, out of which Lap took 156.431 ms
rank = 0, Mixing (+ precond) took 333.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621777, int_b + int_rho = 1.091e-14, checking this took 0.092 ms
2-norm of RHS = 755.3467111937135, which took 0.087 ms

iter_count = 234, r_2norm = 6.967e-04, tol*||rhs|| = 7.553e-04

Anderson update took 98.490 ms, out of which F'*F took 53.056 ms; b-Ax took 353.659 ms, out of which Lap took 319.407 ms
Solving Poisson took 673.410 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.211195 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.204716 
Total time for convolution: 	 convolve: 5.198604 
Total time for convolution: 	 convolve: 5.188728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.330 ms

This SCF took 27065.334 ms, scf error = 3.307e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.148409, lowerbound = -0.705213, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1181.179 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.831 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.849 ms
rank =  0, finding HY took 20.894 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.969 ms
Rank 0, Project_Hamiltonian used 26.729 ms
Total time for projection: 26.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.701496167711189
    last  calculated eigval = 0.044098820357455
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.70149616771119
lambda[   2] =  -0.60832091093238
lambda[   3] =  -0.51879985874166
lambda[   4] =  -0.40155278297024
lambda[   5] =  -0.38322176219531
lambda[   6] =  -0.34797230987611
lambda[   7] =  -0.33007291011300
lambda[   8] =  -0.29170334895708
lambda[   9] =  -0.28988556972977
lambda[  10] =  -0.27956143252835
lambda[  11] =  -0.03142679000810
lambda[  12] =   0.00974653051796
lambda[  13] =   0.01086359173621
lambda[  14] =   0.01261734918547
lambda[  15] =   0.01527826153768
lambda[  16] =   0.02181450690208
lambda[  17] =   0.04409882035745
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.152 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 3.163 ms

Total time for subspace rotation: 3.164 ms
rank = 0, Efermi =  -0.060348784423 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 1.550 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1213.491 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.346 ms
rank = 0, Transfering density took 0.351 ms
Etot    =   -22.863649286963
Eband   =    -8.305174108334
E1      =    20.039385567749
E2      =    -6.680029395906
E3      =   -10.757390919090
Exc     =    -9.351611449002
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 1.121e-05, dEband = 6.311e-03
rank = 0, Calculating/Estimating energy took 1.111 ms, Etot = -22.863649287, dEtot = 1.121e-05, dEband = 6.311e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1970255290045, which took 0.051 ms

iter_count = 114, r_2norm = 6.016e-06, tol*||rhs|| = 7.881e-06

Anderson update took 47.961 ms, out of which F'*F took 25.832 ms; b-Ax took 173.047 ms, out of which Lap took 157.159 ms
rank = 0, Mixing (+ precond) took 333.483 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621755, int_b + int_rho = -2.001e-13, checking this took 0.079 ms
2-norm of RHS = 755.3685211941984, which took 0.086 ms

iter_count = 216, r_2norm = 6.335e-04, tol*||rhs|| = 7.554e-04

Anderson update took 91.413 ms, out of which F'*F took 48.886 ms; b-Ax took 325.395 ms, out of which Lap took 295.009 ms
Solving Poisson took 621.067 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.207161 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.203145 
Total time for convolution: 	 convolve: 5.357193 
Total time for convolution: 	 convolve: 5.172244 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.993 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.101 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
---Transfer Veff_loc: D2D took 0.296 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.314 ms

This SCF took 27749.957 ms, scf error = 1.965e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.144099, lowerbound = -0.701496, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1206.916 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.857 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.877 ms
rank =  0, finding HY took 20.837 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.968 ms
Rank 0, Project_Hamiltonian used 26.703 ms
Total time for projection: 26.714 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.699511394392155
    last  calculated eigval = 0.040638960100902
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69951139439215
lambda[   2] =  -0.60626879234857
lambda[   3] =  -0.51691064548888
lambda[   4] =  -0.39974133316937
lambda[   5] =  -0.38129537297426
lambda[   6] =  -0.34601359131668
lambda[   7] =  -0.32816367237342
lambda[   8] =  -0.28971375910650
lambda[   9] =  -0.28801720501573
lambda[  10] =  -0.27782517178561
lambda[  11] =  -0.02968836871443
lambda[  12] =   0.01177723342365
lambda[  13] =   0.01272994109432
lambda[  14] =   0.01456169249492
lambda[  15] =   0.01636194112345
lambda[  16] =   0.02219230650577
lambda[  17] =   0.04063896010090
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.135 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.142 ms

Total time for subspace rotation: 3.143 ms
rank = 0, Efermi =  -0.058610363157 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 1.568 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1238.655 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
rank = 0, D2D took 0.347 ms
rank = 0, Transfering density took 0.350 ms
Etot    =   -22.863599534022
Eband   =    -8.266921876721
E1      =    20.019314140529
E2      =    -6.661003360202
E3      =   -10.760985469595
Exc     =    -9.354311015256
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 4.523e-06, dEband = 3.477e-03
rank = 0, Calculating/Estimating energy took 1.780 ms, Etot = -22.863599534, dEtot = 4.523e-06, dEband = 3.477e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0875756025360, which took 0.162 ms

iter_count = 114, r_2norm = 2.718e-06, tol*||rhs|| = 3.503e-06

Anderson update took 48.000 ms, out of which F'*F took 25.784 ms; b-Ax took 172.000 ms, out of which Lap took 156.359 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 332.980 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621766, int_b + int_rho = -9.095e-14, checking this took 0.082 ms
2-norm of RHS = 755.3364662043590, which took 0.065 ms

iter_count = 222, r_2norm = 6.046e-04, tol*||rhs|| = 7.553e-04

Anderson update took 93.760 ms, out of which F'*F took 50.098 ms; b-Ax took 335.613 ms, out of which Lap took 303.670 ms
Solving Poisson took 640.005 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.211617 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.871 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.227320 
Total time for convolution: 	 convolve: 5.213297 
Total time for convolution: 	 convolve: 5.196201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
---Transfer Veff_loc: D2D took 0.362 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.381 ms

This SCF took 27082.848 ms, scf error = 1.519e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.140639, lowerbound = -0.699511, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1184.343 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.857 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 2.882 ms
rank =  0, finding HY took 20.915 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.885 ms
Rank 0, Project_Hamiltonian used 27.724 ms
Total time for projection: 27.738 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.030 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.697729463072297
    last  calculated eigval = 0.038396509283941
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69772946307230
lambda[   2] =  -0.60442243896275
lambda[   3] =  -0.51498913643858
lambda[   4] =  -0.39787825884140
lambda[   5] =  -0.37945114786129
lambda[   6] =  -0.34417119203352
lambda[   7] =  -0.32627615306759
lambda[   8] =  -0.28791724434774
lambda[   9] =  -0.28616520213329
lambda[  10] =  -0.27589270805416
lambda[  11] =  -0.02566556674078
lambda[  12] =   0.01658083140456
lambda[  13] =   0.01782760997379
lambda[  14] =   0.01891072515583
lambda[  15] =   0.02044283545306
lambda[  16] =   0.02539034449459
lambda[  17] =   0.03839650928394
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.080 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.085 ms

Total time for subspace rotation: 3.086 ms
rank = 0, Efermi =  -0.054587561179 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.618 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1217.074 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
rank = 0, D2D took 0.343 ms
rank = 0, Transfering density took 0.349 ms
Etot    =   -22.863539999904
Eband   =    -8.229785890298
E1      =    20.001294293158
E2      =    -6.641049021807
E3      =   -10.764949199860
Exc     =    -9.357377012059
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 5.412e-06, dEband = 3.376e-03
rank = 0, Calculating/Estimating energy took 1.300 ms, Etot = -22.863540000, dEtot = 5.412e-06, dEband = 3.376e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0582764086955, which took 0.054 ms

iter_count = 114, r_2norm = 1.727e-06, tol*||rhs|| = 2.331e-06

Anderson update took 48.274 ms, out of which F'*F took 25.714 ms; b-Ax took 173.119 ms, out of which Lap took 157.056 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.046 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621767, int_b + int_rho = -8.004e-14, checking this took 0.083 ms
2-norm of RHS = 755.3367918049205, which took 0.080 ms

iter_count = 192, r_2norm = 6.907e-04, tol*||rhs|| = 7.553e-04

Anderson update took 82.119 ms, out of which F'*F took 43.437 ms; b-Ax took 289.860 ms, out of which Lap took 262.492 ms
Solving Poisson took 554.126 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.237190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.293 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.239105 
Total time for convolution: 	 convolve: 5.201110 
Total time for convolution: 	 convolve: 5.197876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.747 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.317 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.334 ms

This SCF took 27518.958 ms, scf error = 7.087e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.138397, lowerbound = -0.697729, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1181.824 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.922 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.993 ms
rank =  0, Distribute data + matrix mult took 3.923 ms
rank =  0, finding HY took 21.302 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.917 ms
Rank 0, Project_Hamiltonian used 28.163 ms
Total time for projection: 28.252 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.029 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.696413251161808
    last  calculated eigval = 0.035353304291928
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69641325116181
lambda[   2] =  -0.60315002576416
lambda[   3] =  -0.51378634412974
lambda[   4] =  -0.39665302206708
lambda[   5] =  -0.37820261843681
lambda[   6] =  -0.34292209463099
lambda[   7] =  -0.32504934925551
lambda[   8] =  -0.28665011132432
lambda[   9] =  -0.28494227873343
lambda[  10] =  -0.27471928544812
lambda[  11] =  -0.02223674913405
lambda[  12] =   0.01961591500603
lambda[  13] =   0.02169276767657
lambda[  14] =   0.02181272511107
lambda[  15] =   0.02396667829338
lambda[  16] =   0.02920112969924
lambda[  17] =   0.03535330429193
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.130 ms
rank =  0, subspace rotation using ScaLAPACK took 3.236 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.240 ms

Total time for subspace rotation: 3.241 ms
rank = 0, Efermi =  -0.051158743558 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 1.576 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1215.167 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
rank = 0, D2D took 0.352 ms
rank = 0, Transfering density took 0.357 ms
Etot    =   -22.863602949384
Eband   =    -8.204976762487
E1      =    19.987793373393
E2      =    -6.629116932210
E3      =   -10.767932660947
Exc     =    -9.359799541075
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 5.723e-06, dEband = 2.255e-03
rank = 0, Calculating/Estimating energy took 2.226 ms, Etot = -22.863602949, dEtot = 5.723e-06, dEband = 2.255e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0363127824654, which took 0.124 ms

iter_count = 114, r_2norm = 1.185e-06, tol*||rhs|| = 1.453e-06

Anderson update took 48.410 ms, out of which F'*F took 26.011 ms; b-Ax took 173.946 ms, out of which Lap took 158.382 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.831 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621768, int_b + int_rho = -6.912e-14, checking this took 0.090 ms
2-norm of RHS = 755.3520548242941, which took 0.082 ms

iter_count = 168, r_2norm = 7.193e-04, tol*||rhs|| = 7.554e-04

Anderson update took 71.165 ms, out of which F'*F took 38.119 ms; b-Ax took 254.746 ms, out of which Lap took 230.216 ms
Solving Poisson took 486.091 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.209242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 48.442 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.206080 
Total time for convolution: 	 convolve: 5.239161 
Total time for convolution: 	 convolve: 5.166469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
---Transfer Veff_loc: D2D took 0.294 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.324 ms

This SCF took 26915.643 ms, scf error = 4.345e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.135353, lowerbound = -0.696413, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1183.994 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.843 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.054 ms
rank =  0, Distribute data + matrix mult took 2.900 ms
rank =  0, finding HY took 21.066 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.911 ms
Rank 0, Project_Hamiltonian used 26.905 ms
Total time for projection: 26.923 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.030 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.696235674998650
    last  calculated eigval = 0.034503106850681
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69623567499865
lambda[   2] =  -0.60297465019653
lambda[   3] =  -0.51361852042165
lambda[   4] =  -0.39646066907653
lambda[   5] =  -0.37801516541813
lambda[   6] =  -0.34273931179601
lambda[   7] =  -0.32485618640762
lambda[   8] =  -0.28647564898632
lambda[   9] =  -0.28476181049431
lambda[  10] =  -0.27453116611384
lambda[  11] =  -0.02004974956743
lambda[  12] =   0.02118790887315
lambda[  13] =   0.02333078073513
lambda[  14] =   0.02411984775530
lambda[  15] =   0.02626087691742
lambda[  16] =   0.03056160707339
lambda[  17] =   0.03450310685068
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 3.099 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.103 ms

Total time for subspace rotation: 3.104 ms
rank = 0, Efermi =  -0.048971743986 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.575 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1215.892 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, D2D took 0.349 ms
rank = 0, Transfering density took 0.351 ms
Etot    =   -22.863639505686
Eband   =    -8.201337608345
E1      =    19.986910730094
E2      =    -6.626473651239
E3      =   -10.767391398331
Exc     =    -9.359408064633
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 3.323e-06, dEband = 3.308e-04
rank = 0, Calculating/Estimating energy took 1.355 ms, Etot = -22.863639506, dEtot = 3.323e-06, dEband = 3.308e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0439185831640, which took 0.054 ms

iter_count = 108, r_2norm = 1.423e-06, tol*||rhs|| = 1.757e-06

Anderson update took 45.866 ms, out of which F'*F took 24.529 ms; b-Ax took 163.780 ms, out of which Lap took 148.394 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 316.876 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621772, int_b + int_rho = -3.638e-14, checking this took 0.089 ms
2-norm of RHS = 755.3645395250667, which took 0.908 ms

iter_count = 168, r_2norm = 6.572e-04, tol*||rhs|| = 7.554e-04

Anderson update took 71.192 ms, out of which F'*F took 38.017 ms; b-Ax took 253.331 ms, out of which Lap took 229.617 ms
Solving Poisson took 484.832 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.206251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.740 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.221526 
Total time for convolution: 	 convolve: 5.184856 
Total time for convolution: 	 convolve: 5.202539 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.325 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.342 ms

This SCF took 26847.404 ms, scf error = 3.085e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134503, lowerbound = -0.696236, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1181.219 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.840 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.858 ms
rank =  0, finding HY took 20.863 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.990 ms
Rank 0, Project_Hamiltonian used 26.731 ms
Total time for projection: 26.742 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.696083534909045
    last  calculated eigval = 0.036463362489224
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69608353490904
lambda[   2] =  -0.60277060610333
lambda[   3] =  -0.51340672067261
lambda[   4] =  -0.39627634694036
lambda[   5] =  -0.37782372180247
lambda[   6] =  -0.34254108844585
lambda[   7] =  -0.32464298532769
lambda[   8] =  -0.28629835297040
lambda[   9] =  -0.28458169738090
lambda[  10] =  -0.27433367567531
lambda[  11] =  -0.01922217161071
lambda[  12] =   0.02089458769128
lambda[  13] =   0.02331194883982
lambda[  14] =   0.02438194756072
lambda[  15] =   0.02750292708465
lambda[  16] =   0.02971967834835
lambda[  17] =   0.03646336248922
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 3.222 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.227 ms

Total time for subspace rotation: 3.227 ms
rank = 0, Efermi =  -0.048144166067 calculate fermi energy took 0.107 ms
rank = 0, --- Calculate rho: sum over local bands took 1.590 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1213.136 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
rank = 0, D2D took 0.365 ms
rank = 0, Transfering density took 0.367 ms
Etot    =   -22.863732385982
Eband   =    -8.197517460960
E1      =    19.985436853568
E2      =    -6.624067175365
E3      =   -10.767354536670
Exc     =    -9.359403878253
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 8.444e-06, dEband = 3.473e-04
rank = 0, Calculating/Estimating energy took 0.885 ms, Etot = -22.863732386, dEtot = 8.444e-06, dEband = 3.473e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0443481267981, which took 0.051 ms

iter_count = 108, r_2norm = 1.363e-06, tol*||rhs|| = 1.774e-06

Anderson update took 45.681 ms, out of which F'*F took 24.526 ms; b-Ax took 163.229 ms, out of which Lap took 148.443 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 317.082 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621763, int_b + int_rho = -1.273e-13, checking this took 0.084 ms
2-norm of RHS = 755.3617757821777, which took 0.078 ms

iter_count = 120, r_2norm = 7.374e-04, tol*||rhs|| = 7.554e-04

Anderson update took 50.717 ms, out of which F'*F took 27.259 ms; b-Ax took 181.332 ms, out of which Lap took 164.099 ms
Solving Poisson took 347.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.228703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.477 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.203287 
Total time for convolution: 	 convolve: 5.183068 
Total time for convolution: 	 convolve: 5.178121 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 26701.471 ms, scf error = 2.836e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136463, lowerbound = -0.696084, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1190.753 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.841 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 2.862 ms
rank =  0, finding HY took 20.925 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.949 ms
Rank 0, Project_Hamiltonian used 26.757 ms
Total time for projection: 26.767 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.695894577076189
    last  calculated eigval = 0.036873678866847
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69589457707619
lambda[   2] =  -0.60260269733935
lambda[   3] =  -0.51324567467456
lambda[   4] =  -0.39611554466547
lambda[   5] =  -0.37766161987799
lambda[   6] =  -0.34237652227302
lambda[   7] =  -0.32449205258682
lambda[   8] =  -0.28612587427532
lambda[   9] =  -0.28441882530937
lambda[  10] =  -0.27418509793255
lambda[  11] =  -0.01879667346548
lambda[  12] =   0.02109414689468
lambda[  13] =   0.02360410771103
lambda[  14] =   0.02471162006101
lambda[  15] =   0.02786281359147
lambda[  16] =   0.02964881181223
lambda[  17] =   0.03687367886685
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 3.021 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.026 ms

Total time for subspace rotation: 3.026 ms
rank = 0, Efermi =  -0.047718667921 calculate fermi energy took 0.242 ms
rank = 0, --- Calculate rho: sum over local bands took 1.578 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1222.612 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.369 ms
rank = 0, Transfering density took 0.371 ms
Etot    =   -22.863738393528
Eband   =    -8.194236972514
E1      =    19.983384810227
E2      =    -6.622717068047
E3      =   -10.767900859900
Exc     =    -9.359834546815
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 5.461e-07, dEband = 2.982e-04
rank = 0, Calculating/Estimating energy took 2.269 ms, Etot = -22.863738394, dEtot = 5.461e-07, dEband = 2.982e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0261923653641, which took 0.054 ms

iter_count = 108, r_2norm = 1.041e-06, tol*||rhs|| = 1.048e-06

Anderson update took 45.465 ms, out of which F'*F took 24.500 ms; b-Ax took 163.672 ms, out of which Lap took 148.438 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 316.573 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621772, int_b + int_rho = -3.274e-14, checking this took 0.084 ms
2-norm of RHS = 755.3582275798962, which took 0.067 ms

iter_count = 132, r_2norm = 6.377e-04, tol*||rhs|| = 7.554e-04

Anderson update took 79.707 ms, out of which F'*F took 29.775 ms; b-Ax took 198.707 ms, out of which Lap took 180.195 ms
Solving Poisson took 404.095 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.427484 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.208724 
Total time for convolution: 	 convolve: 5.197830 
Total time for convolution: 	 convolve: 5.176635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.415 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 26968.070 ms, scf error = 1.823e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136874, lowerbound = -0.695895, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1176.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.916 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 2.937 ms
rank =  0, finding HY took 20.787 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.878 ms
Rank 0, Project_Hamiltonian used 26.621 ms
Total time for projection: 26.640 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.695800408934798
    last  calculated eigval = 0.037783148304012
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69580040893480
lambda[   2] =  -0.60251907767849
lambda[   3] =  -0.51315175237034
lambda[   4] =  -0.39602021376371
lambda[   5] =  -0.37757578518894
lambda[   6] =  -0.34228926562460
lambda[   7] =  -0.32440681458220
lambda[   8] =  -0.28604155158737
lambda[   9] =  -0.28432945249929
lambda[  10] =  -0.27409031590127
lambda[  11] =  -0.01855921138696
lambda[  12] =   0.02074676045298
lambda[  13] =   0.02353395166329
lambda[  14] =   0.02432835097022
lambda[  15] =   0.02833884433087
lambda[  16] =   0.03037396403893
lambda[  17] =   0.03778314830401
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.032 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.047481205900 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.520 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1208.477 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
rank = 0, D2D took 0.355 ms
rank = 0, Transfering density took 0.358 ms
Etot    =   -22.863766835749
Eband   =    -8.192449276749
E1      =    19.982570790977
E2      =    -6.621732425949
E3      =   -10.767831530322
Exc     =    -9.359782693876
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 2.586e-06, dEband = 1.625e-04
rank = 0, Calculating/Estimating energy took 3.818 ms, Etot = -22.863766836, dEtot = 2.586e-06, dEband = 1.625e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0156889684709, which took 0.129 ms

iter_count = 114, r_2norm = 4.362e-07, tol*||rhs|| = 6.276e-07

Anderson update took 49.869 ms, out of which F'*F took 25.835 ms; b-Ax took 171.224 ms, out of which Lap took 156.224 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.053 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621761, int_b + int_rho = -1.455e-13, checking this took 0.081 ms
2-norm of RHS = 755.3540303106355, which took 0.095 ms

iter_count = 120, r_2norm = 7.405e-04, tol*||rhs|| = 7.554e-04

Anderson update took 50.528 ms, out of which F'*F took 27.051 ms; b-Ax took 179.847 ms, out of which Lap took 163.089 ms
Solving Poisson took 345.427 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.181053 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.816 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.248082 
Total time for convolution: 	 convolve: 5.280375 
Total time for convolution: 	 convolve: 5.197317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
---Transfer Veff_loc: D2D took 0.297 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.314 ms

This SCF took 26847.073 ms, scf error = 1.401e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137783, lowerbound = -0.695800, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1182.988 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.849 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 2.901 ms
rank =  0, finding HY took 20.988 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.039 ms
Rank 0, Project_Hamiltonian used 26.944 ms
Total time for projection: 26.955 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.695733820158153
    last  calculated eigval = 0.037778076828554
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69573382015815
lambda[   2] =  -0.60245948032042
lambda[   3] =  -0.51309401362654
lambda[   4] =  -0.39595742468557
lambda[   5] =  -0.37751791189649
lambda[   6] =  -0.34223007484466
lambda[   7] =  -0.32434806062340
lambda[   8] =  -0.28598290420547
lambda[   9] =  -0.28427083765126
lambda[  10] =  -0.27403140026380
lambda[  11] =  -0.01849773913222
lambda[  12] =   0.02054958605437
lambda[  13] =   0.02348142231745
lambda[  14] =   0.02397810128913
lambda[  15] =   0.02851188483831
lambda[  16] =   0.03151823906354
lambda[  17] =   0.03777807682855
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.016 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.022 ms

Total time for subspace rotation: 3.022 ms
rank = 0, Efermi =  -0.047419733607 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.659 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1214.940 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.353 ms
rank = 0, Transfering density took 0.359 ms
Etot    =   -22.863778558718
Eband   =    -8.191251857037
E1      =    19.981911334148
E2      =    -6.621180925782
E3      =   -10.767850601552
Exc     =    -9.359799950791
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 1.066e-06, dEband = 1.089e-04
rank = 0, Calculating/Estimating energy took 2.128 ms, Etot = -22.863778559, dEtot = 1.066e-06, dEband = 1.089e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0160853237970, which took 0.050 ms

iter_count = 108, r_2norm = 6.319e-07, tol*||rhs|| = 6.434e-07

Anderson update took 45.618 ms, out of which F'*F took 24.633 ms; b-Ax took 163.129 ms, out of which Lap took 148.419 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 316.141 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621771, int_b + int_rho = -4.002e-14, checking this took 0.080 ms
2-norm of RHS = 755.3549921878511, which took 0.107 ms

iter_count = 102, r_2norm = 7.362e-04, tol*||rhs|| = 7.554e-04

Anderson update took 43.199 ms, out of which F'*F took 23.066 ms; b-Ax took 153.405 ms, out of which Lap took 138.891 ms
Solving Poisson took 294.694 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Total time for convolution: 	 convolve: 5.257613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.254349 
Total time for convolution: 	 convolve: 5.268156 
Total time for convolution: 	 convolve: 5.213029 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
---Transfer Veff_loc: D2D took 0.297 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.315 ms

This SCF took 26818.299 ms, scf error = 1.045e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137778, lowerbound = -0.695734, upperbound = 267.578155

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1186.730 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.847 ms
rank =  0, finding HY took 20.869 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.917 ms
Rank 0, Project_Hamiltonian used 26.651 ms
Total time for projection: 26.662 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.026 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.695618821153004
    last  calculated eigval = 0.038769489930169
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.69561882115300
lambda[   2] =  -0.60234798078232
lambda[   3] =  -0.51298466077802
lambda[   4] =  -0.39584741541478
lambda[   5] =  -0.37740899559424
lambda[   6] =  -0.34212061234031
lambda[   7] =  -0.32423980694162
lambda[   8] =  -0.28587341494175
lambda[   9] =  -0.28416247265274
lambda[  10] =  -0.27392364148804
lambda[  11] =  -0.01806109094761
lambda[  12] =   0.02074775168817
lambda[  13] =   0.02371939432453
lambda[  14] =   0.02422636716804
lambda[  15] =   0.02895573689444
lambda[  16] =   0.03245859024682
lambda[  17] =   0.03876948993017
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.058 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.065 ms

Total time for subspace rotation: 3.066 ms
rank = 0, Efermi =  -0.046983085460 calculate fermi energy took 0.071 ms
rank = 0, --- Calculate rho: sum over local bands took 1.533 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1218.330 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
rank = 0, D2D took 0.343 ms
rank = 0, Transfering density took 0.344 ms
Etot    =   -22.863791486851
Eband   =    -8.189055644647
E1      =    19.980818732880
E2      =    -6.620010993519
E3      =   -10.768047776415
Exc     =    -9.359943732645
Esc     =   -42.683669611590
Entropy =    -0.000000000781
dE = 1.175e-06, dEband = 1.997e-04
rank = 0, Calculating/Estimating energy took 3.035 ms, Etot = -22.863791487, dEtot = 1.175e-06, dEband = 1.997e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0145138927336, which took 0.067 ms

iter_count = 108, r_2norm = 4.729e-07, tol*||rhs|| = 5.806e-07

Anderson update took 45.685 ms, out of which F'*F took 24.392 ms; b-Ax took 163.057 ms, out of which Lap took 148.278 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 315.856 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002621776, int_rho =  20.00000002621773, int_b + int_rho = -2.183e-14, checking this took 0.087 ms
2-norm of RHS = 755.3577260214182, which took 0.076 ms

iter_count = 102, r_2norm = 6.495e-04, tol*||rhs|| = 7.554e-04

Anderson update took 43.028 ms, out of which F'*F took 23.003 ms; b-Ax took 154.096 ms, out of which Lap took 139.466 ms
Solving Poisson took 295.256 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.214828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.692 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.179314 
Total time for convolution: 	 convolve: 5.187517 
Total time for convolution: 	 convolve: 5.158071 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.311 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 26593.125 ms, scf error = 7.931e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.69561882115300, occ[   1] =   2.00000000000000
lambda[   2] =  -0.60234798078232, occ[   2] =   2.00000000000000
lambda[   3] =  -0.51298466077802, occ[   3] =   2.00000000000000
lambda[   4] =  -0.39584741541478, occ[   4] =   2.00000000000000
lambda[   5] =  -0.37740899559424, occ[   5] =   2.00000000000000
lambda[   6] =  -0.34212061234031, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32423980694162, occ[   7] =   2.00000000000000
lambda[   8] =  -0.28587341494175, occ[   8] =   2.00000000000000
lambda[   9] =  -0.28416247265274, occ[   9] =   2.00000000000000
lambda[  10] =  -0.27392364148804, occ[  10] =   2.00000000000000
lambda[  11] =  -0.01806109094761, occ[  11] =   0.00000002621767
lambda[  12] =   0.02074775168817, occ[  12] =   0.00000000000000
lambda[  13] =   0.02371939432453, occ[  13] =   0.00000000000000
lambda[  14] =   0.02422636716804, occ[  14] =   0.00000000000000
lambda[  15] =   0.02895573689444, occ[  15] =   0.00000000000000
lambda[  16] =   0.03245859024682, occ[  16] =   0.00000000000000
lambda[  17] =   0.03876948993017, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.152 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.562 ms, time for Allreduce/Reduce: 8.640 ms 
Time for calculating local force components: 18.074 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.03864115126648  -0.00000003138662  -0.02955707244613
  0.03864123360008  -0.00000004193220  -0.02955709362658
  0.00000002461403  -0.04029756701041  -0.02764732816876
  0.00000002905415   0.04029754696613  -0.02764731439520
 -0.03910662364664  -0.00234316807289   0.02888839253028
  0.03910669905131  -0.00234313291789   0.02888838302578
  0.03910668144103   0.00234310664480   0.02888837304753
 -0.03910657947156   0.00234310522468   0.02888833785397
  0.00000093552811  -0.00000050982219  -0.01458639496619
  0.00000085535301   0.00361957593090  -0.00160887825721
  0.00000116069008  -0.00362120105019  -0.00160984634639
force_loc = 
  0.03975663996487  -0.00000026756069   0.03041840497470
 -0.03975534733323  -0.00000003218772   0.03041801192136
  0.00000039384689   0.04131520560565   0.02819332539913
 -0.00000022468421  -0.04131498359333   0.02819276706574
  0.04003575587577   0.00248263716150  -0.02952039284624
 -0.04003528347732   0.00248171035377  -0.02951980248637
 -0.04003546743286  -0.00248227294963  -0.02952029414883
  0.04003531843749  -0.00248230532907  -0.02952037748293
 -0.00000302672083   0.00000286421810   0.01109590159058
 -0.00000317017767  -0.00474246313658   0.00283179026448
 -0.00000017903472   0.00474239500131   0.00283146247004
Time for calculating nonlocal force components: 24.702 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000016745305   0.00000010926730   0.00243489672495
[0m[32m -0.00000015570841   0.00108494766840  -0.00082862827370
[0m[32m -0.00000002559274  -0.00108491414860  -0.00082854998905
[0mTime for calculating XC forces components: 27.328 ms
 Cartesian force = 
  0.00111564092956  -0.00000032739682   0.00085968948903
 -0.00111396150198  -0.00000010256943   0.00085927525524
  0.00000057069209   0.00101761014574   0.00054435419083
 -0.00000004339889  -0.00101746507670   0.00054380963099
  0.00092928446030   0.00013944063911  -0.00063364335550
 -0.00092843219484   0.00013854898638  -0.00063306250013
 -0.00092863376065  -0.00013919475433  -0.00063356414084
  0.00092889119711  -0.00013922855389  -0.00063368266850
 -0.00000210641459   0.00000243521371  -0.00105723969020
 -0.00000231830190  -0.00003796798678   0.00039264069403
  0.00000110829379   0.00003625135303   0.00039142309506
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Time for printing density: 377.661 ms
The program took 467.986 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:00
Job ID:        2266763
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:35:12,vmem=8308K,walltime=00:07:56,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-20-1
---------------------------------------
