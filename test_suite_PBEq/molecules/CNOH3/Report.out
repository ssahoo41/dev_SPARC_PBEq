---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:28
Job ID:    2266646
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:33
Job ID:    2266646
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.079 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 18.962 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 8.168 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 96.836 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.022 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.329 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.846571	   11.429620	    9.944822	
   11.986512	    8.570380	   11.732525	
   12.279928	    8.736781	    8.267475	
    7.720072	    8.678213	   11.364590	
   11.161906	    9.136183	    9.938726	
    8.464737	    8.966079	    9.603821	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.404 ms
Set up communicators.

--set up spincomm took 1.000 ms

--set up kptcomm took 0.362 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.036 ms

Calculate_SplineDerivRadFun took 0.335 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.960 ms.
time spent on vectorized spline interp: 3.734 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.681 ms.
time spent on vectorized spline interp: 1.592 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.354 ms.
time spent on vectorized spline interp: 1.869 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.510 ms.
time spent on vectorized spline interp: 1.659 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.542 ms.

Calculating rb for all atom types took 21.916 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.933 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000265296, sum_int_rho = 17.6992775426468
PosCharge = 18.000000026530, NegCharge = -17.699277542647, scal_fac = 1.016990664345
After scaling, int_rho = 18.0000000265296, PosCharge + NegCharge - NetCharge = 2.132e-14
--Calculate Vref took 0.323 ms
--Calculate rho_guess took 1.932 ms

 integral of b = -18.0000000265296,
 int{b} + Nelectron + NetCharge = -2.653e-08,
 Esc = -55.2964042154270,
 MPI_Reduce took 2.465 ms

Calculating b & b_ref took 10.074 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.039 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.113 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.017 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.149 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.253 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652964, int_b + int_rho = -6.548e-14, checking this took 0.091 ms
2-norm of RHS = 610.0070819454608, which took 0.146 ms

iter_count = 420, r_2norm = 5.286e-04, tol*||rhs|| = 6.100e-04

Anderson update took 258.248 ms, out of which F'*F took 119.498 ms; b-Ax took 812.625 ms, out of which Lap took 722.316 ms
Solving Poisson took 1798.635 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.159419 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.114288 
Total time for convolution: 	 convolve: 5.133118 
Total time for convolution: 	 convolve: 5.104520 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.706 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.169 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.318 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
rank = 0, XC calculation took 24416.380 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.576 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.315 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 5.327 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.837 ms
    Lanczos iter 53, eigmin  = -1.075449936, eigmax = 264.923704483, err_eigmin = 5.599e-04, err_eigmax = 9.663e-03
rank =   0, Lanczos took 132.778 ms, eigmin = -1.075449936360, eigmax = 267.572941527593

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.198746, lowerbound = -1.175450, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1420.285 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.354 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.221 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.978 ms
rank =  0, Distribute data + matrix mult took 20.578 ms
rank =  0, finding HY took 23.242 ms
rank =  0, distributing HY into block cyclic form took 14.250 ms
rank =  0, finding Y'*HY took 6.076 ms
Rank 0, Project_Hamiltonian used 64.186 ms
Total time for projection: 64.200 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.504 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.574 ms
    first calculated eigval = 2.802006314655685
    last  calculated eigval = 3.221865267541217
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80200631465569
lambda[   2] =   2.82370568787129
lambda[   3] =   2.88615815946013
lambda[   4] =   2.92713336794014
lambda[   5] =   2.93222758822882
lambda[   6] =   2.96578835058864
lambda[   7] =   2.99137621113451
lambda[   8] =   3.02460032973855
lambda[   9] =   3.04062470577396
lambda[  10] =   3.07395999835307
lambda[  11] =   3.10418058093349
lambda[  12] =   3.11945734477097
lambda[  13] =   3.14186750580144
lambda[  14] =   3.16064221099172
lambda[  15] =   3.22186526754122
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.590 ms
rank =  0, subspace rotation using ScaLAPACK took 4.312 ms
rank =  0, Distributing orbital back into band + domain format took 14.134 ms
rank = 0, Subspace_Rotation used 18.468 ms

Total time for subspace rotation: 18.472 ms
rank = 0, Efermi =   3.057292367030 calculate fermi energy took 0.117 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.321865, lowerbound = -1.175450, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1351.614 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 33.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.416 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 36.536 ms
rank =  0, finding HY took 21.804 ms
rank =  0, distributing HY into block cyclic form took 14.429 ms
rank =  0, finding Y'*HY took 4.649 ms
Rank 0, Project_Hamiltonian used 77.463 ms
Total time for projection: 77.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.720576062761837
    last  calculated eigval = 0.440474911106736
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.72057606276184
lambda[   2] =  -0.46961159897955
lambda[   3] =  -0.33976284649658
lambda[   4] =  -0.13248124052016
lambda[   5] =  -0.03540646153466
lambda[   6] =   0.15494633939636
lambda[   7] =   0.18713709980866
lambda[   8] =   0.28065169331685
lambda[   9] =   0.28743829657486
lambda[  10] =   0.32366809424704
lambda[  11] =   0.34147603541352
lambda[  12] =   0.37633116600298
lambda[  13] =   0.38748756656537
lambda[  14] =   0.42249371194627
lambda[  15] =   0.44047491110674
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.328 ms
rank =  0, Distributing orbital back into band + domain format took 13.802 ms
rank = 0, Subspace_Rotation used 18.148 ms

Total time for subspace rotation: 18.156 ms
rank = 0, Efermi =   0.305555572268 calculate fermi energy took 0.029 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.540475, lowerbound = -1.175450, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1365.150 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 53.355 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.807 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 57.198 ms
rank =  0, finding HY took 21.736 ms
rank =  0, distributing HY into block cyclic form took 14.395 ms
rank =  0, finding Y'*HY took 4.787 ms
Rank 0, Project_Hamiltonian used 98.154 ms
Total time for projection: 98.160 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -1.079103352548091
    last  calculated eigval = 0.152700756151137
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07910335254809
lambda[   2] =  -0.78246425546712
lambda[   3] =  -0.68637868037650
lambda[   4] =  -0.55306873344964
lambda[   5] =  -0.48184887853513
lambda[   6] =  -0.42376604532159
lambda[   7] =  -0.38629327726313
lambda[   8] =  -0.33008106597192
lambda[   9] =  -0.24163568270717
lambda[  10] =   0.03595336734936
lambda[  11] =   0.04611060688763
lambda[  12] =   0.08502354265601
lambda[  13] =   0.11367057902183
lambda[  14] =   0.13549658122615
lambda[  15] =   0.15270075615114
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 4.271 ms
rank =  0, Distributing orbital back into band + domain format took 14.280 ms
rank = 0, Subspace_Rotation used 18.568 ms

Total time for subspace rotation: 18.572 ms
rank = 0, Efermi =   0.007042092473 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.252701, lowerbound = -1.175450, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1367.695 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 56.105 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.723 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.104 ms
rank =  0, Distribute data + matrix mult took 59.954 ms
rank =  0, finding HY took 21.772 ms
rank =  0, distributing HY into block cyclic form took 14.354 ms
rank =  0, finding Y'*HY took 4.712 ms
Rank 0, Project_Hamiltonian used 100.841 ms
Total time for projection: 100.847 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 1.228 ms
    first calculated eigval = -1.079564955383305
    last  calculated eigval = 0.100097348042776
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07956495538330
lambda[   2] =  -0.78415798044937
lambda[   3] =  -0.68836966461955
lambda[   4] =  -0.56188765895751
lambda[   5] =  -0.51096435392903
lambda[   6] =  -0.43305019279452
lambda[   7] =  -0.39874014135745
lambda[   8] =  -0.36014861427932
lambda[   9] =  -0.28750420054350
lambda[  10] =  -0.02729412349971
lambda[  11] =  -0.01836644062766
lambda[  12] =   0.03109287109828
lambda[  13] =   0.04496630573218
lambda[  14] =   0.06828155349626
lambda[  15] =   0.10009734804278
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 1.237 ms
rank =  0, subspace rotation using ScaLAPACK took 4.364 ms
rank =  0, Distributing orbital back into band + domain format took 14.331 ms
rank = 0, Subspace_Rotation used 18.723 ms

Total time for subspace rotation: 18.729 ms
rank = 0, Efermi =  -0.056205407750 calculate fermi energy took 0.035 ms
rank = 0, --- Calculate rho: sum over local bands took 3.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.606 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.183 ms
rank = 0, Calculating density took 6065.279 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.790 ms
rank = 0, D2D took 1.002 ms
rank = 0, Transfering density took 1.005 ms
Etot    =   -34.669695844633
Eband   =   -10.208775525351
E1      =    20.738098653710
E2      =    -8.900560805916
E3      =   -11.252597890102
Exc     =   -10.055773452793
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 5.778e+00, dEband = 1.701e+00
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -34.669695845, dEtot = 5.778e+00, dEband = 1.701e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 66.6620331453208, which took 0.063 ms

iter_count = 90, r_2norm = 1.863e-03, tol*||rhs|| = 2.666e-03

Anderson update took 54.614 ms, out of which F'*F took 26.443 ms; b-Ax took 171.781 ms, out of which Lap took 153.178 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 383.253 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652964, int_b + int_rho = -7.276e-14, checking this took 0.115 ms
2-norm of RHS = 607.5137831495525, which took 0.183 ms

iter_count = 282, r_2norm = 4.762e-04, tol*||rhs|| = 6.075e-04

Anderson update took 170.511 ms, out of which F'*F took 78.733 ms; b-Ax took 530.717 ms, out of which Lap took 471.744 ms
Solving Poisson took 1187.906 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.154966 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.127668 
Total time for convolution: 	 convolve: 5.139733 
Total time for convolution: 	 convolve: 5.216138 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.968 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.814 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.802 ms

This SCF took 32356.576 ms, scf error = 1.589e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.200097, lowerbound = -1.079565, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1421.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.503 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.585 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.129 ms
rank =  0, finding HY took 22.159 ms
rank =  0, distributing HY into block cyclic form took 14.403 ms
rank =  0, finding Y'*HY took 4.635 ms
Rank 0, Project_Hamiltonian used 59.399 ms
Total time for projection: 59.416 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.072233679630894
    last  calculated eigval = 0.074978929634528
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07223367963089
lambda[   2] =  -0.76633041088848
lambda[   3] =  -0.66478614591673
lambda[   4] =  -0.54236224886334
lambda[   5] =  -0.49130334609740
lambda[   6] =  -0.42040052968237
lambda[   7] =  -0.38167869601624
lambda[   8] =  -0.33880531778450
lambda[   9] =  -0.27369869089734
lambda[  10] =  -0.05037056694174
lambda[  11] =  -0.02105426108850
lambda[  12] =  -0.00574905363227
lambda[  13] =   0.01035753047280
lambda[  14] =   0.04486929898601
lambda[  15] =   0.07497892963453
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 4.280 ms
rank =  0, Distributing orbital back into band + domain format took 14.381 ms
rank = 0, Subspace_Rotation used 18.684 ms

Total time for subspace rotation: 18.691 ms
rank = 0, Efermi =  -0.079281839916 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.099 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.835 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.175 ms
rank = 0, Calculating density took 1506.540 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.685 ms
rank = 0, D2D took 0.936 ms
rank = 0, Transfering density took 0.946 ms
Etot    =   -34.646892718671
Eband   =    -9.903198132891
E1      =    20.459950919448
E2      =    -8.876872519845
E3      =   -11.349380082392
Exc     =   -10.133493891247
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 3.801e-03, dEband = 5.093e-02
rank = 0, Calculating/Estimating energy took 1.244 ms, Etot = -34.646892719, dEtot = 3.801e-03, dEband = 5.093e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 16.6630572317485, which took 0.062 ms

iter_count = 102, r_2norm = 4.348e-04, tol*||rhs|| = 6.665e-04

Anderson update took 61.005 ms, out of which F'*F took 27.942 ms; b-Ax took 192.162 ms, out of which Lap took 169.641 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 439.826 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652957, int_b + int_rho = -1.382e-13, checking this took 0.083 ms
2-norm of RHS = 603.9435138238987, which took 0.187 ms

iter_count = 294, r_2norm = 5.454e-04, tol*||rhs|| = 6.039e-04

Anderson update took 175.407 ms, out of which F'*F took 82.261 ms; b-Ax took 552.609 ms, out of which Lap took 492.386 ms
Solving Poisson took 1229.785 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.878 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.170795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.158818 
Total time for convolution: 	 convolve: 5.213724 
Total time for convolution: 	 convolve: 5.176765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.817 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.813 ms

This SCF took 27962.590 ms, scf error = 1.088e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.174979, lowerbound = -1.072234, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.616 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.087 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.989 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.084 ms
rank =  0, Distribute data + matrix mult took 23.184 ms
rank =  0, finding HY took 23.027 ms
rank =  0, distributing HY into block cyclic form took 14.673 ms
rank =  0, finding Y'*HY took 4.632 ms
Rank 0, Project_Hamiltonian used 65.565 ms
Total time for projection: 65.581 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.051485093979089
    last  calculated eigval = 0.059225921979398
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05148509397909
lambda[   2] =  -0.73260593972466
lambda[   3] =  -0.61931067577806
lambda[   4] =  -0.50483746805415
lambda[   5] =  -0.45054792346045
lambda[   6] =  -0.38983798607544
lambda[   7] =  -0.34751485268844
lambda[   8] =  -0.29851944369631
lambda[   9] =  -0.23712976277742
lambda[  10] =  -0.03961367870880
lambda[  11] =  -0.02358776523895
lambda[  12] =  -0.00167708642542
lambda[  13] =   0.00598116117922
lambda[  14] =   0.03415792951274
lambda[  15] =   0.05922592197940
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 4.198 ms
rank =  0, Distributing orbital back into band + domain format took 14.387 ms
rank = 0, Subspace_Rotation used 18.608 ms

Total time for subspace rotation: 18.613 ms
rank = 0, Efermi =  -0.068524951703 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.024 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.891 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.187 ms
rank = 0, Calculating density took 1485.256 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.692 ms
rank = 0, D2D took 0.936 ms
rank = 0, Transfering density took 0.946 ms
Etot    =   -34.622794110851
Eband   =    -9.263578293519
E1      =    19.926492738638
E2      =    -8.749767258747
E3      =   -11.573109584369
Exc     =   -10.312181182868
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 4.016e-03, dEband = 1.066e-01
rank = 0, Calculating/Estimating energy took 1.099 ms, Etot = -34.622794111, dEtot = 4.016e-03, dEband = 1.066e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.3859948326899, which took 0.425 ms

iter_count = 102, r_2norm = 1.990e-04, tol*||rhs|| = 2.554e-04

Anderson update took 61.710 ms, out of which F'*F took 29.065 ms; b-Ax took 197.127 ms, out of which Lap took 175.353 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.790 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652957, int_b + int_rho = -1.455e-13, checking this took 0.118 ms
2-norm of RHS = 604.1810191278618, which took 0.177 ms

iter_count = 264, r_2norm = 4.956e-04, tol*||rhs|| = 6.042e-04

Anderson update took 159.693 ms, out of which F'*F took 75.947 ms; b-Ax took 502.014 ms, out of which Lap took 448.197 ms
Solving Poisson took 1103.429 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.033 ms
Total time for convolution: 	 convolve: 5.128370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.163039 
Total time for convolution: 	 convolve: 5.169952 
Total time for convolution: 	 convolve: 5.120564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.973 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 1.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.326 ms

This SCF took 27659.678 ms, scf error = 2.597e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159226, lowerbound = -1.051485, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1406.540 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 26.481 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.528 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.119 ms
rank =  0, Distribute data + matrix mult took 30.154 ms
rank =  0, finding HY took 22.169 ms
rank =  0, distributing HY into block cyclic form took 14.640 ms
rank =  0, finding Y'*HY took 5.200 ms
Rank 0, Project_Hamiltonian used 72.208 ms
Total time for projection: 72.232 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.046627314529854
    last  calculated eigval = 0.049459874008220
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04662731452985
lambda[   2] =  -0.72717685407079
lambda[   3] =  -0.61143007363799
lambda[   4] =  -0.49817433428724
lambda[   5] =  -0.44329892593339
lambda[   6] =  -0.38389348741894
lambda[   7] =  -0.34206369108950
lambda[   8] =  -0.29146467067885
lambda[   9] =  -0.23075615903235
lambda[  10] =  -0.03841797360131
lambda[  11] =  -0.02813912940315
lambda[  12] =  -0.00231548007421
lambda[  13] =   0.00645354042716
lambda[  14] =   0.02797943994166
lambda[  15] =   0.04945987400822
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.237 ms
rank =  0, Distributing orbital back into band + domain format took 14.259 ms
rank = 0, Subspace_Rotation used 18.513 ms

Total time for subspace rotation: 18.518 ms
rank = 0, Efermi =  -0.067329248067 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.001 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.164 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.247 ms
rank = 0, Calculating density took 1505.011 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.713 ms
rank = 0, D2D took 0.966 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -34.621301358551
Eband   =    -9.149771022377
E1      =    19.856644068734
E2      =    -8.698139772596
E3      =   -11.612054456445
Exc     =   -10.341964417731
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 2.488e-04, dEband = 1.897e-02
rank = 0, Calculating/Estimating energy took 1.339 ms, Etot = -34.621301359, dEtot = 2.488e-04, dEband = 1.897e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1539721670114, which took 0.059 ms

iter_count = 114, r_2norm = 3.082e-05, tol*||rhs|| = 4.616e-05

Anderson update took 67.697 ms, out of which F'*F took 32.336 ms; b-Ax took 220.114 ms, out of which Lap took 195.671 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.952 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652967, int_b + int_rho = -3.638e-14, checking this took 0.109 ms
2-norm of RHS = 605.2656160696531, which took 0.144 ms

iter_count = 264, r_2norm = 5.379e-04, tol*||rhs|| = 6.053e-04

Anderson update took 159.228 ms, out of which F'*F took 71.934 ms; b-Ax took 484.652 ms, out of which Lap took 435.739 ms
Solving Poisson took 1105.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.022 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.131374 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.940 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.126298 
Total time for convolution: 	 convolve: 5.124258 
Total time for convolution: 	 convolve: 5.144358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.396 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.045 ms
---Transfer Veff_loc: D2D took 1.801 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.870 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.706 ms

This SCF took 27829.823 ms, scf error = 1.451e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.149460, lowerbound = -1.046627, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1391.290 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.456 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.834 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.319 ms
rank =  0, finding HY took 22.063 ms
rank =  0, distributing HY into block cyclic form took 14.024 ms
rank =  0, finding Y'*HY took 5.229 ms
Rank 0, Project_Hamiltonian used 59.679 ms
Total time for projection: 59.694 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.042167321670630
    last  calculated eigval = 0.042695468145328
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04216732167063
lambda[   2] =  -0.72392473740202
lambda[   3] =  -0.60694991367950
lambda[   4] =  -0.49394404948138
lambda[   5] =  -0.43896591625521
lambda[   6] =  -0.37989477248087
lambda[   7] =  -0.33907894875411
lambda[   8] =  -0.28709271285551
lambda[   9] =  -0.22703471057038
lambda[  10] =  -0.03733188709181
lambda[  11] =  -0.02875066215678
lambda[  12] =  -0.00307733913942
lambda[  13] =   0.00708249959894
lambda[  14] =   0.02355279766442
lambda[  15] =   0.04269546814533
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.348 ms
rank =  0, Distributing orbital back into band + domain format took 14.323 ms
rank = 0, Subspace_Rotation used 18.693 ms

Total time for subspace rotation: 18.699 ms
rank = 0, Efermi =  -0.066243178627 calculate fermi energy took 2.140 ms
rank = 0, --- Calculate rho: sum over local bands took 4.066 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.873 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.197 ms
rank = 0, Calculating density took 1478.200 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.663 ms
rank = 0, D2D took 1.117 ms
rank = 0, Transfering density took 1.127 ms
Etot    =   -34.620387538031
Eband   =    -9.078106167290
E1      =    19.842119007505
E2      =    -8.635903112286
E3      =   -11.629182297230
Exc     =   -10.353081571544
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 1.523e-04, dEband = 1.194e-02
rank = 0, Calculating/Estimating energy took 1.162 ms, Etot = -34.620387538, dEtot = 1.523e-04, dEband = 1.194e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7268099849894, which took 0.626 ms

iter_count = 108, r_2norm = 2.572e-05, tol*||rhs|| = 2.907e-05

Anderson update took 64.767 ms, out of which F'*F took 30.327 ms; b-Ax took 207.878 ms, out of which Lap took 184.855 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.873 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652967, int_b + int_rho = -4.366e-14, checking this took 0.129 ms
2-norm of RHS = 605.3332528742179, which took 0.194 ms

iter_count = 240, r_2norm = 5.462e-04, tol*||rhs|| = 6.053e-04

Anderson update took 143.797 ms, out of which F'*F took 65.791 ms; b-Ax took 448.431 ms, out of which Lap took 400.320 ms
Solving Poisson took 1006.811 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.139025 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.127254 
Total time for convolution: 	 convolve: 5.155025 
Total time for convolution: 	 convolve: 5.130603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.516 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.642 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.372 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 27534.370 ms, scf error = 3.904e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.142695, lowerbound = -1.042167, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1397.294 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.306 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.906 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 18.255 ms
rank =  0, finding HY took 22.129 ms
rank =  0, distributing HY into block cyclic form took 14.188 ms
rank =  0, finding Y'*HY took 4.603 ms
Rank 0, Project_Hamiltonian used 59.211 ms
Total time for projection: 59.226 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -1.039039601179506
    last  calculated eigval = 0.035594237519699
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03903960117951
lambda[   2] =  -0.72070389958222
lambda[   3] =  -0.60414946762446
lambda[   4] =  -0.49108759831168
lambda[   5] =  -0.43600948941607
lambda[   6] =  -0.37711115466115
lambda[   7] =  -0.33585692798647
lambda[   8] =  -0.28402012548648
lambda[   9] =  -0.22396344005159
lambda[  10] =  -0.03662195330318
lambda[  11] =  -0.02819774459885
lambda[  12] =  -0.00338335497560
lambda[  13] =   0.00807988656864
lambda[  14] =   0.02033055543867
lambda[  15] =   0.03559423751970
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.317 ms
rank =  0, Distributing orbital back into band + domain format took 14.373 ms
rank = 0, Subspace_Rotation used 18.715 ms

Total time for subspace rotation: 18.721 ms
rank = 0, Efermi =  -0.065533249479 calculate fermi energy took 0.104 ms
rank = 0, --- Calculate rho: sum over local bands took 3.911 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.217 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1482.950 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
rank = 0, D2D took 0.983 ms
rank = 0, Transfering density took 0.987 ms
Etot    =   -34.620219824662
Eband   =    -9.023883409571
E1      =    19.811717976402
E2      =    -8.609690745259
E3      =   -11.638791162936
Exc     =   -10.360132083470
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 2.795e-05, dEband = 9.037e-03
rank = 0, Calculating/Estimating energy took 1.926 ms, Etot = -34.620219825, dEtot = 2.795e-05, dEband = 9.037e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4083135076971, which took 0.057 ms

iter_count = 108, r_2norm = 1.596e-05, tol*||rhs|| = 1.633e-05

Anderson update took 64.162 ms, out of which F'*F took 28.642 ms; b-Ax took 198.128 ms, out of which Lap took 176.827 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652957, int_b + int_rho = -1.419e-13, checking this took 0.109 ms
2-norm of RHS = 605.5092342509485, which took 0.120 ms

iter_count = 240, r_2norm = 5.328e-04, tol*||rhs|| = 6.055e-04

Anderson update took 145.802 ms, out of which F'*F took 67.389 ms; b-Ax took 448.682 ms, out of which Lap took 401.894 ms
Solving Poisson took 1005.790 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.177895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.122388 
Total time for convolution: 	 convolve: 5.173866 
Total time for convolution: 	 convolve: 5.191637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.368 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.367 ms

This SCF took 27641.706 ms, scf error = 2.640e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135594, lowerbound = -1.039040, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1396.956 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.611 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 18.172 ms
rank =  0, finding HY took 22.105 ms
rank =  0, distributing HY into block cyclic form took 14.228 ms
rank =  0, finding Y'*HY took 4.626 ms
Rank 0, Project_Hamiltonian used 59.175 ms
Total time for projection: 59.191 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.036499201284156
    last  calculated eigval = 0.033043553869908
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03649920128416
lambda[   2] =  -0.71865014137084
lambda[   3] =  -0.60234544096117
lambda[   4] =  -0.48921365281064
lambda[   5] =  -0.43397794194559
lambda[   6] =  -0.37493165319741
lambda[   7] =  -0.33377217466643
lambda[   8] =  -0.28203168868972
lambda[   9] =  -0.22174671842772
lambda[  10] =  -0.03589378842431
lambda[  11] =  -0.02675505753865
lambda[  12] =  -0.00304659113618
lambda[  13] =   0.00925162085610
lambda[  14] =   0.01873569633785
lambda[  15] =   0.03304355386991
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 4.322 ms
rank =  0, Distributing orbital back into band + domain format took 14.265 ms
rank = 0, Subspace_Rotation used 18.609 ms

Total time for subspace rotation: 18.615 ms
rank = 0, Efermi =  -0.064805069778 calculate fermi energy took 0.094 ms
rank = 0, --- Calculate rho: sum over local bands took 3.883 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.326 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1482.579 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.721 ms
rank = 0, D2D took 0.982 ms
rank = 0, Transfering density took 0.989 ms
Etot    =   -34.620169030922
Eband   =    -8.986337227660
E1      =    19.796654141430
E2      =    -8.585874001641
E3      =   -11.642508355794
Exc     =   -10.362464085910
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 8.466e-06, dEband = 6.258e-03
rank = 0, Calculating/Estimating energy took 1.796 ms, Etot = -34.620169031, dEtot = 8.466e-06, dEband = 6.258e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2675731987794, which took 0.058 ms

iter_count = 108, r_2norm = 9.865e-06, tol*||rhs|| = 1.070e-05

Anderson update took 64.298 ms, out of which F'*F took 29.346 ms; b-Ax took 197.546 ms, out of which Lap took 176.821 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.667 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652962, int_b + int_rho = -9.459e-14, checking this took 0.090 ms
2-norm of RHS = 605.5086995052369, which took 0.167 ms

iter_count = 222, r_2norm = 6.032e-04, tol*||rhs|| = 6.055e-04

Anderson update took 133.374 ms, out of which F'*F took 65.031 ms; b-Ax took 436.238 ms, out of which Lap took 392.147 ms
Solving Poisson took 941.014 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.147578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.146938 
Total time for convolution: 	 convolve: 5.140944 
Total time for convolution: 	 convolve: 5.142257 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.956 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.979 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.380 ms

This SCF took 27523.088 ms, scf error = 1.509e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.133044, lowerbound = -1.036499, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1357.352 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.552 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.590 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.179 ms
rank =  0, finding HY took 22.154 ms
rank =  0, distributing HY into block cyclic form took 14.126 ms
rank =  0, finding Y'*HY took 4.726 ms
Rank 0, Project_Hamiltonian used 59.226 ms
Total time for projection: 59.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.034953921327771
    last  calculated eigval = 0.031976046173041
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03495392132777
lambda[   2] =  -0.71710907987165
lambda[   3] =  -0.60073914194163
lambda[   4] =  -0.48771630804393
lambda[   5] =  -0.43231007433998
lambda[   6] =  -0.37331433474960
lambda[   7] =  -0.33215391717767
lambda[   8] =  -0.28040869552946
lambda[   9] =  -0.22002598827002
lambda[  10] =  -0.03489102451700
lambda[  11] =  -0.02536546992532
lambda[  12] =  -0.00187589464987
lambda[  13] =   0.01071116740081
lambda[  14] =   0.01814099605413
lambda[  15] =   0.03197604617304
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 4.336 ms
rank =  0, Distributing orbital back into band + domain format took 14.194 ms
rank = 0, Subspace_Rotation used 18.550 ms

Total time for subspace rotation: 18.555 ms
rank = 0, Efermi =  -0.063802302232 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.898 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.506 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.195 ms
rank = 0, Calculating density took 1443.497 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.240 ms
rank = 0, D2D took 1.353 ms
rank = 0, Transfering density took 1.358 ms
Etot    =   -34.620206073449
Eband   =    -8.957462923429
E1      =    19.781756501768
E2      =    -8.570983099136
E3      =   -11.646053635779
Exc     =   -10.365132170486
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 6.174e-06, dEband = 4.812e-03
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -34.620206073, dEtot = 6.174e-06, dEband = 4.812e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1621096388975, which took 0.143 ms

iter_count = 108, r_2norm = 6.115e-06, tol*||rhs|| = 6.484e-06

Anderson update took 64.016 ms, out of which F'*F took 28.784 ms; b-Ax took 197.268 ms, out of which Lap took 176.264 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.040 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652957, int_b + int_rho = -1.455e-13, checking this took 0.117 ms
2-norm of RHS = 605.5158076352120, which took 0.188 ms

iter_count = 216, r_2norm = 5.594e-04, tol*||rhs|| = 6.055e-04

Anderson update took 129.631 ms, out of which F'*F took 63.248 ms; b-Ax took 424.252 ms, out of which Lap took 381.324 ms
Solving Poisson took 915.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.159780 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.187438 
Total time for convolution: 	 convolve: 5.145034 
Total time for convolution: 	 convolve: 5.155453 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.588 ms
======D2D: initiated sending and receiving took 1.503 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.348 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.337 ms

This SCF took 27511.103 ms, scf error = 9.951e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131976, lowerbound = -1.034954, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1389.554 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.628 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.223 ms
rank =  0, finding HY took 22.033 ms
rank =  0, distributing HY into block cyclic form took 14.114 ms
rank =  0, finding Y'*HY took 4.714 ms
Rank 0, Project_Hamiltonian used 59.126 ms
Total time for projection: 59.141 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.034039085863950
    last  calculated eigval = 0.031520160377025
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03403908586395
lambda[   2] =  -0.71617506302901
lambda[   3] =  -0.59989047219986
lambda[   4] =  -0.48684244822449
lambda[   5] =  -0.43141689818822
lambda[   6] =  -0.37242556787709
lambda[   7] =  -0.33122214559952
lambda[   8] =  -0.27946475386531
lambda[   9] =  -0.21908450968218
lambda[  10] =  -0.03321310834198
lambda[  11] =  -0.02398734501793
lambda[  12] =   0.00055952868723
lambda[  13] =   0.01252828403024
lambda[  14] =   0.01837454088297
lambda[  15] =   0.03152016037702
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.174 ms
rank =  0, subspace rotation using ScaLAPACK took 4.334 ms
rank =  0, Distributing orbital back into band + domain format took 14.382 ms
rank = 0, Subspace_Rotation used 19.218 ms

Total time for subspace rotation: 19.226 ms
rank = 0, Efermi =  -0.062124388647 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 4.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 1475.257 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.849 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.010 ms
Etot    =   -34.620277449472
Eband   =    -8.941121889940
E1      =    19.775027778954
E2      =    -8.561301638371
E3      =   -11.646076258888
Exc     =   -10.365157019527
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 1.190e-05, dEband = 2.724e-03
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -34.620277449, dEtot = 1.190e-05, dEband = 2.724e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0969712823546, which took 0.050 ms

iter_count = 108, r_2norm = 3.706e-06, tol*||rhs|| = 3.879e-06

Anderson update took 64.369 ms, out of which F'*F took 29.309 ms; b-Ax took 197.586 ms, out of which Lap took 176.997 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.623 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652960, int_b + int_rho = -1.128e-13, checking this took 0.115 ms
2-norm of RHS = 605.5045719126903, which took 0.187 ms

iter_count = 210, r_2norm = 4.913e-04, tol*||rhs|| = 6.055e-04

Anderson update took 125.638 ms, out of which F'*F took 61.502 ms; b-Ax took 413.525 ms, out of which Lap took 371.320 ms
Solving Poisson took 888.701 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.127501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.155224 
Total time for convolution: 	 convolve: 5.163672 
Total time for convolution: 	 convolve: 5.134984 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.440 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.938 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.336 ms

This SCF took 27476.189 ms, scf error = 6.817e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131520, lowerbound = -1.034039, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1396.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.556 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.624 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.216 ms
rank =  0, finding HY took 22.049 ms
rank =  0, distributing HY into block cyclic form took 14.154 ms
rank =  0, finding Y'*HY took 4.698 ms
Rank 0, Project_Hamiltonian used 59.161 ms
Total time for projection: 59.176 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.032705397460064
    last  calculated eigval = 0.031639872848780
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03270539746006
lambda[   2] =  -0.71494209547518
lambda[   3] =  -0.59874279788293
lambda[   4] =  -0.48567893304858
lambda[   5] =  -0.43020905314882
lambda[   6] =  -0.37118871737860
lambda[   7] =  -0.33000779471586
lambda[   8] =  -0.27826110663832
lambda[   9] =  -0.21779785811553
lambda[  10] =  -0.03041746710036
lambda[  11] =  -0.02210750802235
lambda[  12] =   0.00442411065908
lambda[  13] =   0.01521710372757
lambda[  14] =   0.01956419864047
lambda[  15] =   0.03163987284878
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 5.063 ms
rank =  0, Distributing orbital back into band + domain format took 13.697 ms
rank = 0, Subspace_Rotation used 18.782 ms

Total time for subspace rotation: 18.794 ms
rank = 0, Efermi =  -0.059328767315 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.197 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.329 ms
rank = 0, Calculating density took 1483.355 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
rank = 0, D2D took 0.687 ms
rank = 0, Transfering density took 0.692 ms
Etot    =   -34.620324438846
Eband   =    -8.919067508535
E1      =    19.763506075873
E2      =    -8.550276211000
E3      =   -11.648263740940
Exc     =   -10.366898741907
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 7.832e-06, dEband = 3.676e-03
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -34.620324439, dEtot = 7.832e-06, dEband = 3.676e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0812162556817, which took 0.126 ms

iter_count = 108, r_2norm = 2.710e-06, tol*||rhs|| = 3.249e-06

Anderson update took 63.981 ms, out of which F'*F took 28.924 ms; b-Ax took 197.506 ms, out of which Lap took 176.557 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652967, int_b + int_rho = -3.638e-14, checking this took 0.130 ms
2-norm of RHS = 605.5016982253676, which took 0.186 ms

iter_count = 186, r_2norm = 6.002e-04, tol*||rhs|| = 6.055e-04

Anderson update took 111.327 ms, out of which F'*F took 54.412 ms; b-Ax took 364.168 ms, out of which Lap took 327.189 ms
Solving Poisson took 787.773 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.160691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.196448 
Total time for convolution: 	 convolve: 5.131084 
Total time for convolution: 	 convolve: 5.143760 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.718 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.304 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.372 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.344 ms

This SCF took 27397.220 ms, scf error = 4.052e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131640, lowerbound = -1.032705, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1392.344 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.434 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.013 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.486 ms
rank =  0, finding HY took 22.042 ms
rank =  0, distributing HY into block cyclic form took 14.167 ms
rank =  0, finding Y'*HY took 4.722 ms
Rank 0, Project_Hamiltonian used 59.458 ms
Total time for projection: 59.474 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.031963495002672
    last  calculated eigval = 0.031288783114570
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03196349500267
lambda[   2] =  -0.71421855118818
lambda[   3] =  -0.59804196352902
lambda[   4] =  -0.48498591847118
lambda[   5] =  -0.42950899348789
lambda[   6] =  -0.37050781502055
lambda[   7] =  -0.32929110592866
lambda[   8] =  -0.27758641925867
lambda[   9] =  -0.21712414682093
lambda[  10] =  -0.02849982251412
lambda[  11] =  -0.02103952752976
lambda[  12] =   0.00674639736046
lambda[  13] =   0.01689350898910
lambda[  14] =   0.02018809266604
lambda[  15] =   0.03128878311457
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.190 ms
rank =  0, Distributing orbital back into band + domain format took 15.161 ms
rank = 0, Subspace_Rotation used 19.378 ms

Total time for subspace rotation: 19.384 ms
rank = 0, Efermi =  -0.057411184044 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.017 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.176 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.272 ms
rank = 0, Calculating density took 1479.000 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.510 ms
rank = 0, D2D took 0.666 ms
rank = 0, Transfering density took 0.671 ms
Etot    =   -34.620378946694
Eband   =    -8.906456818172
E1      =    19.756602064365
E2      =    -8.544278472102
E3      =   -11.649514804636
Exc     =   -10.367913253408
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 9.085e-06, dEband = 2.102e-03
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -34.620378947, dEtot = 9.085e-06, dEband = 2.102e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0492739180256, which took 0.060 ms

iter_count = 108, r_2norm = 1.930e-06, tol*||rhs|| = 1.971e-06

Anderson update took 64.141 ms, out of which F'*F took 29.010 ms; b-Ax took 196.877 ms, out of which Lap took 176.256 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.137 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652960, int_b + int_rho = -1.128e-13, checking this took 0.121 ms
2-norm of RHS = 605.5145181224302, which took 0.129 ms

iter_count = 168, r_2norm = 6.034e-04, tol*||rhs|| = 6.055e-04

Anderson update took 101.403 ms, out of which F'*F took 48.391 ms; b-Ax took 327.502 ms, out of which Lap took 293.838 ms
Solving Poisson took 711.691 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.124344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.532 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.172697 
Total time for convolution: 	 convolve: 5.144374 
Total time for convolution: 	 convolve: 5.151376 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.366 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.348 ms

This SCF took 27322.493 ms, scf error = 2.825e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131289, lowerbound = -1.031963, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1399.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.657 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.286 ms
rank =  0, finding HY took 21.978 ms
rank =  0, distributing HY into block cyclic form took 14.038 ms
rank =  0, finding Y'*HY took 4.777 ms
Rank 0, Project_Hamiltonian used 59.122 ms
Total time for projection: 59.134 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.441 ms
rank = 0, Solve_Generalized_EigenProblem used 0.550 ms
    first calculated eigval = -1.031712173914327
    last  calculated eigval = 0.031388145057649
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03171217391433
lambda[   2] =  -0.71397888495221
lambda[   3] =  -0.59778111564646
lambda[   4] =  -0.48473564436877
lambda[   5] =  -0.42925670680527
lambda[   6] =  -0.37025699292804
lambda[   7] =  -0.32905325156758
lambda[   8] =  -0.27735481620427
lambda[   9] =  -0.21689896429026
lambda[  10] =  -0.02741086095704
lambda[  11] =  -0.02006304925286
lambda[  12] =   0.00843838619791
lambda[  13] =   0.01785724803400
lambda[  14] =   0.02056096523625
lambda[  15] =   0.03138814505765
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.566 ms
rank =  0, subspace rotation using ScaLAPACK took 4.282 ms
rank =  0, Distributing orbital back into band + domain format took 14.728 ms
rank = 0, Subspace_Rotation used 19.034 ms

Total time for subspace rotation: 19.040 ms
rank = 0, Efermi =  -0.056322237092 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.941 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.180 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 1486.136 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.885 ms
rank = 0, D2D took 0.990 ms
rank = 0, Transfering density took 0.993 ms
Etot    =   -34.620413862109
Eband   =    -8.902057102082
E1      =    19.754872001121
E2      =    -8.541583354411
E3      =   -11.649524360511
Exc     =   -10.367932259853
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 5.819e-06, dEband = 7.333e-04
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -34.620413862, dEtot = 5.819e-06, dEband = 7.333e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0436718220204, which took 0.098 ms

iter_count = 114, r_2norm = 1.084e-06, tol*||rhs|| = 1.747e-06

Anderson update took 67.550 ms, out of which F'*F took 30.460 ms; b-Ax took 207.917 ms, out of which Lap took 185.962 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.738 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652970, int_b + int_rho = -7.276e-15, checking this took 0.129 ms
2-norm of RHS = 605.5192099543018, which took 0.170 ms

iter_count = 150, r_2norm = 4.960e-04, tol*||rhs|| = 6.055e-04

Anderson update took 90.030 ms, out of which F'*F took 43.382 ms; b-Ax took 302.072 ms, out of which Lap took 272.335 ms
Solving Poisson took 644.074 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.154786 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.741 ms
Total time for convolution: 	 convolve: 5.132584 
Total time for convolution: 	 convolve: 5.131323 
Total time for convolution: 	 convolve: 5.150897 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.365 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.351 ms

This SCF took 27224.426 ms, scf error = 2.115e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131388, lowerbound = -1.031712, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1405.483 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.270 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.686 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.065 ms
rank =  0, Distribute data + matrix mult took 18.047 ms
rank =  0, finding HY took 21.653 ms
rank =  0, distributing HY into block cyclic form took 14.170 ms
rank =  0, finding Y'*HY took 4.667 ms
Rank 0, Project_Hamiltonian used 59.072 ms
Total time for projection: 59.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.031538533864554
    last  calculated eigval = 0.031352610945254
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03153853386455
lambda[   2] =  -0.71379531385033
lambda[   3] =  -0.59759711857739
lambda[   4] =  -0.48455629081139
lambda[   5] =  -0.42907501575031
lambda[   6] =  -0.37007841017209
lambda[   7] =  -0.32887308960414
lambda[   8] =  -0.27717672653309
lambda[   9] =  -0.21672126151168
lambda[  10] =  -0.02690292419087
lambda[  11] =  -0.01940951637509
lambda[  12] =   0.00917560824794
lambda[  13] =   0.01820645314053
lambda[  14] =   0.02055789211205
lambda[  15] =   0.03135261094525
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.299 ms
rank =  0, Distributing orbital back into band + domain format took 14.306 ms
rank = 0, Subspace_Rotation used 18.626 ms

Total time for subspace rotation: 18.633 ms
rank = 0, Efermi =  -0.055814281643 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 4.040 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.255 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1491.022 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.769 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -34.620437418070
Eband   =    -8.898823522064
E1      =    19.753313174440
E2      =    -8.539830601278
E3      =   -11.649779003980
Exc     =   -10.368132459487
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 3.926e-06, dEband = 5.389e-04
rank = 0, Calculating/Estimating energy took 1.088 ms, Etot = -34.620437418, dEtot = 3.926e-06, dEband = 5.389e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0361951739537, which took 0.109 ms

iter_count = 114, r_2norm = 8.982e-07, tol*||rhs|| = 1.448e-06

Anderson update took 67.904 ms, out of which F'*F took 31.286 ms; b-Ax took 209.134 ms, out of which Lap took 187.070 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.812 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652966, int_b + int_rho = -5.093e-14, checking this took 0.110 ms
2-norm of RHS = 605.5238350781035, which took 0.150 ms

iter_count = 150, r_2norm = 5.115e-04, tol*||rhs|| = 6.055e-04

Anderson update took 89.552 ms, out of which F'*F took 43.417 ms; b-Ax took 291.747 ms, out of which Lap took 261.739 ms
Solving Poisson took 634.192 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.154690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.134141 
Total time for convolution: 	 convolve: 5.124907 
Total time for convolution: 	 convolve: 5.142552 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.513 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.368 ms

This SCF took 27220.901 ms, scf error = 1.810e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.131353, lowerbound = -1.031539, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1386.171 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.775 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.594 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.405 ms
rank =  0, finding HY took 22.000 ms
rank =  0, distributing HY into block cyclic form took 14.297 ms
rank =  0, finding Y'*HY took 4.522 ms
Rank 0, Project_Hamiltonian used 59.266 ms
Total time for projection: 59.284 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.031379150161678
    last  calculated eigval = 0.031665125089668
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03137915016168
lambda[   2] =  -0.71362278104265
lambda[   3] =  -0.59742727078848
lambda[   4] =  -0.48438949055028
lambda[   5] =  -0.42890651464985
lambda[   6] =  -0.36991061756316
lambda[   7] =  -0.32870341908304
lambda[   8] =  -0.27700802966203
lambda[   9] =  -0.21655273323663
lambda[  10] =  -0.02674244354056
lambda[  11] =  -0.01882145157048
lambda[  12] =   0.00917985506514
lambda[  13] =   0.01824448916767
lambda[  14] =   0.02054300997990
lambda[  15] =   0.03166512508967
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.348 ms
rank =  0, Distributing orbital back into band + domain format took 14.161 ms
rank = 0, Subspace_Rotation used 18.534 ms

Total time for subspace rotation: 18.540 ms
rank = 0, Efermi =  -0.055653763329 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.984 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.230 ms
rank = 0, Calculating density took 1471.866 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.807 ms
rank = 0, D2D took 1.048 ms
rank = 0, Transfering density took 1.059 ms
Etot    =   -34.620464350982
Eband   =    -8.895800014185
E1      =    19.751900416150
E2      =    -8.538148899645
E3      =   -11.649968089859
Exc     =   -10.368277526233
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 4.489e-06, dEband = 5.039e-04
rank = 0, Calculating/Estimating energy took 1.085 ms, Etot = -34.620464351, dEtot = 4.489e-06, dEband = 5.039e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354401163443, which took 0.109 ms

iter_count = 108, r_2norm = 1.078e-06, tol*||rhs|| = 1.418e-06

Anderson update took 63.671 ms, out of which F'*F took 29.245 ms; b-Ax took 197.705 ms, out of which Lap took 176.519 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.294 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652964, int_b + int_rho = -7.276e-14, checking this took 0.122 ms
2-norm of RHS = 605.5288248843090, which took 0.111 ms

iter_count = 150, r_2norm = 6.011e-04, tol*||rhs|| = 6.055e-04

Anderson update took 89.617 ms, out of which F'*F took 42.776 ms; b-Ax took 291.842 ms, out of which Lap took 262.038 ms
Solving Poisson took 634.318 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.154007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.162722 
Total time for convolution: 	 convolve: 5.135648 
Total time for convolution: 	 convolve: 5.162962 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.775 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.373 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.072 ms

This SCF took 27244.941 ms, scf error = 1.540e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.131665, lowerbound = -1.031379, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.232 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.197 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.689 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 17.919 ms
rank =  0, finding HY took 21.973 ms
rank =  0, distributing HY into block cyclic form took 14.170 ms
rank =  0, finding Y'*HY took 4.696 ms
Rank 0, Project_Hamiltonian used 58.802 ms
Total time for projection: 58.827 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.031406322653761
    last  calculated eigval = 0.033085665006095
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03140632265376
lambda[   2] =  -0.71362451518144
lambda[   3] =  -0.59740279933819
lambda[   4] =  -0.48437580964958
lambda[   5] =  -0.42889307394913
lambda[   6] =  -0.36990651541113
lambda[   7] =  -0.32869757549975
lambda[   8] =  -0.27699336851836
lambda[   9] =  -0.21655628268642
lambda[  10] =  -0.02689061502715
lambda[  11] =  -0.01819167662168
lambda[  12] =   0.00903254427810
lambda[  13] =   0.01817541488928
lambda[  14] =   0.02048747918627
lambda[  15] =   0.03308566500609
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 4.317 ms
rank =  0, Distributing orbital back into band + domain format took 14.356 ms
rank = 0, Subspace_Rotation used 18.699 ms

Total time for subspace rotation: 18.707 ms
rank = 0, Efermi =  -0.055801903770 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 4.039 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.218 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.223 ms
rank = 0, Calculating density took 1466.585 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.779 ms
rank = 0, D2D took 1.014 ms
rank = 0, Transfering density took 1.017 ms
Etot    =   -34.620487008016
Eband   =    -8.895712526489
E1      =    19.752294829535
E2      =    -8.537747059850
E3      =   -11.649529805535
Exc     =   -10.367941960230
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 3.776e-06, dEband = 1.458e-05
rank = 0, Calculating/Estimating energy took 1.105 ms, Etot = -34.620487008, dEtot = 3.776e-06, dEband = 1.458e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0338800496170, which took 0.059 ms

iter_count = 108, r_2norm = 1.034e-06, tol*||rhs|| = 1.355e-06

Anderson update took 63.894 ms, out of which F'*F took 28.811 ms; b-Ax took 197.022 ms, out of which Lap took 176.283 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.860 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652962, int_b + int_rho = -9.459e-14, checking this took 0.099 ms
2-norm of RHS = 605.5306960622630, which took 0.187 ms

iter_count = 90, r_2norm = 5.498e-04, tol*||rhs|| = 6.055e-04

Anderson update took 53.611 ms, out of which F'*F took 26.011 ms; b-Ax took 174.577 ms, out of which Lap took 156.563 ms
Solving Poisson took 381.847 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.132259 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.146374 
Total time for convolution: 	 convolve: 5.126986 
Total time for convolution: 	 convolve: 5.153454 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.887 ms
---Transfer Veff_loc: D2D took 2.086 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.358 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.466 ms

This SCF took 26950.677 ms, scf error = 2.022e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133086, lowerbound = -1.031406, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.332 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.520 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.751 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.301 ms
rank =  0, finding HY took 22.063 ms
rank =  0, distributing HY into block cyclic form took 14.208 ms
rank =  0, finding Y'*HY took 4.640 ms
Rank 0, Project_Hamiltonian used 59.254 ms
Total time for projection: 59.267 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.031402160770934
    last  calculated eigval = 0.032239078183230
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03140216077093
lambda[   2] =  -0.71362119679804
lambda[   3] =  -0.59740222482357
lambda[   4] =  -0.48437426968253
lambda[   5] =  -0.42889129127359
lambda[   6] =  -0.36990367100406
lambda[   7] =  -0.32869435664661
lambda[   8] =  -0.27699172565077
lambda[   9] =  -0.21655346306354
lambda[  10] =  -0.02689801526994
lambda[  11] =  -0.01836556819482
lambda[  12] =   0.00892868326585
lambda[  13] =   0.01810740806248
lambda[  14] =   0.02019984541637
lambda[  15] =   0.03223907818323
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.312 ms
rank =  0, Distributing orbital back into band + domain format took 14.334 ms
rank = 0, Subspace_Rotation used 18.672 ms

Total time for subspace rotation: 18.679 ms
rank = 0, Efermi =  -0.055809308228 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 3.971 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.251 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.263 ms
rank = 0, Calculating density took 1476.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.797 ms
rank = 0, D2D took 0.998 ms
rank = 0, Transfering density took 1.002 ms
Etot    =   -34.620486837669
Eband   =    -8.895668720141
E1      =    19.752306078912
E2      =    -8.537684129959
E3      =   -11.649538890760
Exc     =   -10.367943000942
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 2.839e-08, dEband = 7.301e-06
rank = 0, Calculating/Estimating energy took 1.100 ms, Etot = -34.620486838, dEtot = 2.839e-08, dEband = 7.301e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0355601728391, which took 0.060 ms

iter_count = 108, r_2norm = 1.037e-06, tol*||rhs|| = 1.422e-06

Anderson update took 63.770 ms, out of which F'*F took 29.023 ms; b-Ax took 197.168 ms, out of which Lap took 176.367 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.508 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652957, int_b + int_rho = -1.455e-13, checking this took 0.138 ms
2-norm of RHS = 605.5290177024137, which took 0.135 ms

iter_count = 36, r_2norm = 5.336e-04, tol*||rhs|| = 6.055e-04

Anderson update took 21.490 ms, out of which F'*F took 10.400 ms; b-Ax took 70.048 ms, out of which Lap took 62.970 ms
Solving Poisson took 154.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.125913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.146152 
Total time for convolution: 	 convolve: 5.131785 
Total time for convolution: 	 convolve: 5.134349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.617 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.361 ms

This SCF took 28173.857 ms, scf error = 2.080e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.132239, lowerbound = -1.031402, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1396.570 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.589 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 18.282 ms
rank =  0, finding HY took 22.070 ms
rank =  0, distributing HY into block cyclic form took 14.259 ms
rank =  0, finding Y'*HY took 4.633 ms
Rank 0, Project_Hamiltonian used 59.286 ms
Total time for projection: 59.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.031388504981831
    last  calculated eigval = 0.031831702979884
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03138850498183
lambda[   2] =  -0.71361271571515
lambda[   3] =  -0.59740062228770
lambda[   4] =  -0.48436937422812
lambda[   5] =  -0.42888738910040
lambda[   6] =  -0.36989666102521
lambda[   7] =  -0.32868762420479
lambda[   8] =  -0.27698669168118
lambda[   9] =  -0.21654523937549
lambda[  10] =  -0.02696599301038
lambda[  11] =  -0.01849408789124
lambda[  12] =   0.00878643166455
lambda[  13] =   0.01800260966716
lambda[  14] =   0.01996898041078
lambda[  15] =   0.03183170297988
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.287 ms
rank =  0, Distributing orbital back into band + domain format took 14.280 ms
rank = 0, Subspace_Rotation used 18.588 ms

Total time for subspace rotation: 18.593 ms
rank = 0, Efermi =  -0.055877287655 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.910 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.314 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1482.216 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.991 ms
Etot    =   -34.620487052337
Eband   =    -8.895549645915
E1      =    19.752174438909
E2      =    -8.537689178295
E3      =   -11.649583830936
Exc     =   -10.367980638344
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 3.578e-08, dEband = 1.985e-05
rank = 0, Calculating/Estimating energy took 1.173 ms, Etot = -34.620487052, dEtot = 3.578e-08, dEband = 1.985e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0314017148674, which took 0.055 ms

iter_count = 108, r_2norm = 9.880e-07, tol*||rhs|| = 1.256e-06

Anderson update took 64.004 ms, out of which F'*F took 28.839 ms; b-Ax took 197.794 ms, out of which Lap took 176.822 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.606 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652958, int_b + int_rho = -1.310e-13, checking this took 0.107 ms
2-norm of RHS = 605.5279771498082, which took 0.171 ms

iter_count = 96, r_2norm = 5.902e-04, tol*||rhs|| = 6.055e-04

Anderson update took 58.306 ms, out of which F'*F took 27.652 ms; b-Ax took 186.142 ms, out of which Lap took 167.140 ms
Solving Poisson took 408.240 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.157667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.573 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.142375 
Total time for convolution: 	 convolve: 5.140129 
Total time for convolution: 	 convolve: 5.142643 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.371 ms

This SCF took 26977.033 ms, scf error = 1.875e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.131832, lowerbound = -1.031389, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1394.957 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.570 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.603 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.210 ms
rank =  0, finding HY took 22.066 ms
rank =  0, distributing HY into block cyclic form took 14.019 ms
rank =  0, finding Y'*HY took 4.823 ms
Rank 0, Project_Hamiltonian used 59.161 ms
Total time for projection: 59.174 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.031351209516549
    last  calculated eigval = 0.031826197620344
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03135120951655
lambda[   2] =  -0.71357923540087
lambda[   3] =  -0.59737138814990
lambda[   4] =  -0.48433758852820
lambda[   5] =  -0.42885926935907
lambda[   6] =  -0.36986443782915
lambda[   7] =  -0.32865795205863
lambda[   8] =  -0.27695997599944
lambda[   9] =  -0.21651716600647
lambda[  10] =  -0.02684573790373
lambda[  11] =  -0.01822619282640
lambda[  12] =   0.00901850570743
lambda[  13] =   0.01811351568834
lambda[  14] =   0.02003217359823
lambda[  15] =   0.03182619762034
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 4.311 ms
rank =  0, Distributing orbital back into band + domain format took 14.251 ms
rank = 0, Subspace_Rotation used 18.579 ms

Total time for subspace rotation: 18.584 ms
rank = 0, Efermi =  -0.055757028508 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.888 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.364 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.228 ms
rank = 0, Calculating density took 1480.509 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.751 ms
rank = 0, D2D took 1.712 ms
rank = 0, Transfering density took 1.716 ms
Etot    =   -34.620487608769
Eband   =    -8.894996446409
E1      =    19.751860362440
E2      =    -8.537444787078
E3      =   -11.649626173621
Exc     =   -10.368018269281
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 9.274e-08, dEband = 9.220e-05
rank = 0, Calculating/Estimating energy took 1.931 ms, Etot = -34.620487609, dEtot = 9.274e-08, dEband = 9.220e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0401327790251, which took 0.054 ms

iter_count = 102, r_2norm = 1.581e-06, tol*||rhs|| = 1.605e-06

Anderson update took 60.220 ms, out of which F'*F took 27.355 ms; b-Ax took 186.612 ms, out of which Lap took 167.188 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.291 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652958, int_b + int_rho = -1.273e-13, checking this took 0.123 ms
2-norm of RHS = 605.5215150374737, which took 0.134 ms

iter_count = 126, r_2norm = 5.439e-04, tol*||rhs|| = 6.055e-04

Anderson update took 75.994 ms, out of which F'*F took 36.372 ms; b-Ax took 245.595 ms, out of which Lap took 220.330 ms
Solving Poisson took 534.409 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.176329 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.134243 
Total time for convolution: 	 convolve: 5.161159 
Total time for convolution: 	 convolve: 5.152114 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.355 ms

This SCF took 27257.850 ms, scf error = 1.767e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.131826, lowerbound = -1.031351, upperbound = 267.572942

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.099 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.404 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.712 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.147 ms
rank =  0, finding HY took 22.023 ms
rank =  0, distributing HY into block cyclic form took 14.214 ms
rank =  0, finding Y'*HY took 4.731 ms
Rank 0, Project_Hamiltonian used 59.160 ms
Total time for projection: 59.176 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -1.031200678003946
    last  calculated eigval = 0.031317070399852
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03120067800395
lambda[   2] =  -0.71345296385763
lambda[   3] =  -0.59727344679459
lambda[   4] =  -0.48422787910897
lambda[   5] =  -0.42875351171473
lambda[   6] =  -0.36974101569697
lambda[   7] =  -0.32854162342024
lambda[   8] =  -0.27685412417635
lambda[   9] =  -0.21639142062293
lambda[  10] =  -0.02714170531017
lambda[  11] =  -0.01877864698636
lambda[  12] =   0.00832143567551
lambda[  13] =   0.01767034451943
lambda[  14] =   0.01955478118652
lambda[  15] =   0.03131707039985
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.401 ms
rank =  0, Distributing orbital back into band + domain format took 14.199 ms
rank = 0, Subspace_Rotation used 18.628 ms

Total time for subspace rotation: 18.634 ms
rank = 0, Efermi =  -0.056053003547 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.912 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.351 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 1476.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.284 ms
rank = 0, D2D took 1.387 ms
rank = 0, Transfering density took 1.395 ms
Etot    =   -34.620494891377
Eband   =    -8.892873327513
E1      =    19.750427519521
E2      =    -8.536665040666
E3      =   -11.649992361390
Exc     =   -10.368302269224
Esc     =   -55.296404215427
Entropy =    -0.000000000790
dE = 1.214e-06, dEband = 3.539e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -34.620494891, dEtot = 1.214e-06, dEband = 3.539e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0284108571845, which took 0.083 ms

iter_count = 102, r_2norm = 1.080e-06, tol*||rhs|| = 1.136e-06

Anderson update took 60.357 ms, out of which F'*F took 27.388 ms; b-Ax took 186.471 ms, out of which Lap took 167.036 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.363 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002652971, int_rho =  18.00000002652967, int_b + int_rho = -4.366e-14, checking this took 0.109 ms
2-norm of RHS = 605.5251032965132, which took 0.175 ms

iter_count = 132, r_2norm = 5.245e-04, tol*||rhs|| = 6.055e-04

Anderson update took 78.415 ms, out of which F'*F took 37.972 ms; b-Ax took 256.731 ms, out of which Lap took 230.560 ms
Solving Poisson took 559.448 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.151156 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.141157 
Total time for convolution: 	 convolve: 5.132628 
Total time for convolution: 	 convolve: 5.159651 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.505 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.365 ms

This SCF took 27093.994 ms, scf error = 9.172e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.03120067800395, occ[   1] =   2.00000000000000
lambda[   2] =  -0.71345296385763, occ[   2] =   2.00000000000000
lambda[   3] =  -0.59727344679459, occ[   3] =   2.00000000000000
lambda[   4] =  -0.48422787910897, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42875351171473, occ[   5] =   2.00000000000000
lambda[   6] =  -0.36974101569697, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32854162342024, occ[   7] =   2.00000000000000
lambda[   8] =  -0.27685412417635, occ[   8] =   2.00000000000000
lambda[   9] =  -0.21639142062293, occ[   9] =   2.00000000000000
lambda[  10] =  -0.02714170531017, occ[  10] =   0.00000002652888
lambda[  11] =  -0.01877864698636, occ[  11] =   0.00000000000074
lambda[  12] =   0.00832143567551, occ[  12] =   0.00000000000000
lambda[  13] =   0.01767034451943, occ[  13] =   0.00000000000000
lambda[  14] =   0.01955478118652, occ[  14] =   0.00000000000000
lambda[  15] =   0.03131707039985, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.485 ms, time for Allreduce/Reduce: 7.298 ms 
Time for calculating local force components: 16.055 ms
Start Calculating nonlocal forces
force_nloc = 
  0.11286163767203  -1.14910601624234  -0.02702650275023
 -0.02147122633311   0.01446550249745  -0.04559722079502
 -0.02895587953095   0.01033680508771   0.04361857378138
  0.02723137521823   0.00979307568254  -0.05764573891413
 -0.21985237320960   0.14972058429340  -0.00474643056785
  0.55461513464412   0.34317263641515   0.77229128594503
force_loc = 
 -0.11214919372019   1.11843812962416   0.02576698210815
  0.02405804412356  -0.01580079522537   0.04987725987459
  0.03201208337184  -0.01149683223717  -0.04763494688863
 -0.03064766289535  -0.01143392625161   0.06201217856112
  0.21502149160343  -0.14600863561125   0.00430756369613
 -0.54077628418170  -0.33087688478543  -0.75450652915665
Time for calculating nonlocal force components: 32.280 ms
[32mforces_xc: 
[0m[32m -0.00194093407702   0.03695829366800   0.00100357003845
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00673715029970  -0.00509314501645   0.00014705540874
[0m[32m -0.01671660280339  -0.01288527521513  -0.02187551698552
[0mTime for calculating XC forces components: 19.986 ms
 Cartesian force = 
 -0.00123295015545   0.00625982093588  -0.00025454782955
  0.00258235776019  -0.00136587884186   0.00428144185364
  0.00305174381062  -0.00119061326341  -0.00401497033318
 -0.00342074770738  -0.00167143668301   0.00436784242106
  0.00190180866325  -0.00141178244824  -0.00029040868891
 -0.00288221237124  -0.00062010969935  -0.00408935742307
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Time for printing density: 394.652 ms
The program took 554.418 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:49
Job ID:        2266646
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:55:36,vmem=8408K,walltime=00:09:38,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-5-2
---------------------------------------
