---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:12
Job ID:    2266813
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:18
Job ID:    2266813
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 6.119 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 12.157 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 41.720 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.895 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.103 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   12.060681	   11.721884	
   12.379469	    7.939319	   11.721884	
    7.620531	    7.939319	   11.721884	
   10.000000	   12.060681	    8.278116	
   12.379469	    7.939319	    8.278116	
    7.620531	    7.939319	    8.278116	
   10.000000	   10.960413	   10.000000	
   11.426609	    8.489452	   10.000000	
    8.573391	    8.489452	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.188 ms
Set up communicators.

--set up spincomm took 3.705 ms

--set up kptcomm took 0.379 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.053 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.527 ms

Calculate_SplineDerivRadFun took 0.110 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.784 ms.
time spent on vectorized spline interp: 3.321 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.604 ms.
time spent on vectorized spline interp: 1.910 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.519 ms.

Calculating rb for all atom types took 12.148 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.043 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000221377, sum_int_rho = 17.3987396256272
PosCharge = 18.000000022138, NegCharge = -17.398739625627, scal_fac = 1.034557698399
After scaling, int_rho = 18.0000000221377, PosCharge + NegCharge - NetCharge = -6.040e-14
--Calculate Vref took 0.441 ms
--Calculate rho_guess took 2.449 ms

 integral of b = -18.0000000221377,
 int{b} + Nelectron + NetCharge = -2.214e-08,
 Esc = -39.7751410878879,
 MPI_Reduce took 7.370 ms

Calculating b & b_ref took 16.364 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.032 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.106 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.018 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.155 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.015 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.878 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213770, int_b + int_rho = 4.366e-14, checking this took 0.756 ms
2-norm of RHS = 694.8234380716081, which took 0.102 ms

iter_count = 420, r_2norm = 5.897e-04, tol*||rhs|| = 6.948e-04

Anderson update took 261.919 ms, out of which F'*F took 126.670 ms; b-Ax took 857.758 ms, out of which Lap took 763.873 ms
Solving Poisson took 1916.358 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
Total time for convolution: 	 convolve: 5.094446 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.490 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.096024 
Total time for convolution: 	 convolve: 5.092883 
Total time for convolution: 	 convolve: 5.094635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.425 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
rank = 0, XC calculation took 24204.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.582 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.200 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.891 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.139 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.889 ms
    Lanczos iter 53, eigmin  = -0.893802137, eigmax = 264.926639922, err_eigmin = 8.761e-04, err_eigmax = 9.734e-03
rank =   0, Lanczos took 138.247 ms, eigmin = -0.893802137323, eigmax = 267.575906321174

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.291052, lowerbound = -0.993802, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1431.711 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 41.850 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.057 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.412 ms
rank =  0, Distribute data + matrix mult took 46.341 ms
rank =  0, finding HY took 22.967 ms
rank =  0, distributing HY into block cyclic form took 15.622 ms
rank =  0, finding Y'*HY took 5.109 ms
Rank 0, Project_Hamiltonian used 90.074 ms
Total time for projection: 90.092 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 2.729 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 2.798 ms
    first calculated eigval = 2.801779973478616
    last  calculated eigval = 3.218333063565962
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80177997347862
lambda[   2] =   2.83486702975315
lambda[   3] =   2.88864191277660
lambda[   4] =   2.92218444627741
lambda[   5] =   2.94024386486015
lambda[   6] =   2.96425039479958
lambda[   7] =   2.99460966845259
lambda[   8] =   3.02642750925316
lambda[   9] =   3.03539888348365
lambda[  10] =   3.08034015088603
lambda[  11] =   3.10160945639227
lambda[  12] =   3.11750442128229
lambda[  13] =   3.14139886580797
lambda[  14] =   3.15024650017504
lambda[  15] =   3.21833306356596
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 2.811 ms
rank =  0, subspace rotation using ScaLAPACK took 4.246 ms
rank =  0, Distributing orbital back into band + domain format took 14.116 ms
rank = 0, Subspace_Rotation used 18.381 ms

Total time for subspace rotation: 18.385 ms
rank = 0, Efermi =   3.057870397816 calculate fermi energy took 0.086 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.318333, lowerbound = -0.993802, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1393.799 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 38.536 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.662 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 42.238 ms
rank =  0, finding HY took 21.894 ms
rank =  0, distributing HY into block cyclic form took 14.525 ms
rank =  0, finding Y'*HY took 4.829 ms
Rank 0, Project_Hamiltonian used 83.517 ms
Total time for projection: 83.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.642592784338099
    last  calculated eigval = 0.447084853663464
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.64259278433810
lambda[   2] =  -0.37145327158066
lambda[   3] =  -0.14110859189172
lambda[   4] =   0.05276273998617
lambda[   5] =   0.07560041239094
lambda[   6] =   0.11621109374659
lambda[   7] =   0.19665734535918
lambda[   8] =   0.27776977348568
lambda[   9] =   0.30017732307300
lambda[  10] =   0.33767030651273
lambda[  11] =   0.35788926775220
lambda[  12] =   0.38130639653183
lambda[  13] =   0.38266954446278
lambda[  14] =   0.42572938848554
lambda[  15] =   0.44708485366346
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.184 ms
rank =  0, Distributing orbital back into band + domain format took 13.957 ms
rank = 0, Subspace_Rotation used 18.153 ms

Total time for subspace rotation: 18.158 ms
rank = 0, Efermi =   0.318923863014 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.547085, lowerbound = -0.993802, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1381.659 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 37.259 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 41.015 ms
rank =  0, finding HY took 21.796 ms
rank =  0, distributing HY into block cyclic form took 14.516 ms
rank =  0, finding Y'*HY took 4.802 ms
Rank 0, Project_Hamiltonian used 82.157 ms
Total time for projection: 82.164 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.897647608991908
    last  calculated eigval = 0.165987039427542
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89764760899191
lambda[   2] =  -0.65112675531323
lambda[   3] =  -0.63860903588634
lambda[   4] =  -0.53397833420082
lambda[   5] =  -0.51933988423983
lambda[   6] =  -0.41682683117608
lambda[   7] =  -0.39690557063343
lambda[   8] =  -0.36059746791183
lambda[   9] =  -0.34485784985930
lambda[  10] =   0.06091522752022
lambda[  11] =   0.08790236313127
lambda[  12] =   0.09831320410523
lambda[  13] =   0.12781880833323
lambda[  14] =   0.14567894226109
lambda[  15] =   0.16598703942754
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.167 ms
rank =  0, subspace rotation using ScaLAPACK took 4.268 ms
rank =  0, Distributing orbital back into band + domain format took 14.580 ms
rank = 0, Subspace_Rotation used 18.866 ms

Total time for subspace rotation: 18.871 ms
rank = 0, Efermi =   0.031840317706 calculate fermi energy took 0.031 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.265987, lowerbound = -0.993802, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.244 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 39.896 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.709 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.044 ms
rank =  0, Distribute data + matrix mult took 43.668 ms
rank =  0, finding HY took 21.945 ms
rank =  0, distributing HY into block cyclic form took 14.457 ms
rank =  0, finding Y'*HY took 4.878 ms
Rank 0, Project_Hamiltonian used 84.976 ms
Total time for projection: 84.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.898924734490038
    last  calculated eigval = 0.109535576746348
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89892473449004
lambda[   2] =  -0.65333448424914
lambda[   3] =  -0.65325106895944
lambda[   4] =  -0.55341211322272
lambda[   5] =  -0.53642843421905
lambda[   6] =  -0.42829191961203
lambda[   7] =  -0.42803107248230
lambda[   8] =  -0.37238793936136
lambda[   9] =  -0.37190612452059
lambda[  10] =   0.01763114742478
lambda[  11] =   0.02078047921515
lambda[  12] =   0.04544965240049
lambda[  13] =   0.08819578342852
lambda[  14] =   0.09822368869921
lambda[  15] =   0.10953557674635
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.282 ms
rank =  0, Distributing orbital back into band + domain format took 14.556 ms
rank = 0, Subspace_Rotation used 18.852 ms

Total time for subspace rotation: 18.857 ms
rank = 0, Efermi =  -0.011466354018 calculate fermi energy took 0.027 ms
rank = 0, --- Calculate rho: sum over local bands took 3.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.310 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.226 ms
rank = 0, Calculating density took 6166.149 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.596 ms
rank = 0, D2D took 0.895 ms
rank = 0, Transfering density took 0.900 ms
Etot    =   -21.721777873391
Eband   =    -9.791935781841
E1      =    19.991287754209
E2      =    -6.776434748233
E3      =    -9.208242172741
Exc     =    -8.130665678180
Esc     =   -39.775141087888
Entropy =    -0.000000000665
dE = 2.414e+00, dEband = 1.088e+00
rank = 0, Calculating/Estimating energy took 1.440 ms, Etot = -21.721777873, dEtot = 2.414e+00, dEband = 1.088e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 39.9513283747664, which took 0.044 ms

iter_count = 96, r_2norm = 1.533e-03, tol*||rhs|| = 1.598e-03

Anderson update took 59.895 ms, out of which F'*F took 27.050 ms; b-Ax took 180.109 ms, out of which Lap took 160.787 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.536 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213769, int_b + int_rho = 3.274e-14, checking this took 0.113 ms
2-norm of RHS = 690.6652899636483, which took 0.205 ms

iter_count = 288, r_2norm = 5.457e-04, tol*||rhs|| = 6.907e-04

Anderson update took 184.923 ms, out of which F'*F took 81.059 ms; b-Ax took 539.862 ms, out of which Lap took 484.801 ms
Solving Poisson took 1227.819 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.436 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.105423 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.510 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.115471 
Total time for convolution: 	 convolve: 5.105113 
Total time for convolution: 	 convolve: 5.107184 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.760 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.829 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.610 ms

This SCF took 32224.957 ms, scf error = 2.128e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.209536, lowerbound = -0.898925, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1363.094 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 72.179 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.654 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 75.972 ms
rank =  0, finding HY took 22.314 ms
rank =  0, distributing HY into block cyclic form took 14.753 ms
rank =  0, finding Y'*HY took 4.822 ms
Rank 0, Project_Hamiltonian used 117.892 ms
Total time for projection: 117.908 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.863621886831212
    last  calculated eigval = 0.073851200092661
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.86362188683121
lambda[   2] =  -0.62224944413206
lambda[   3] =  -0.62189672254942
lambda[   4] =  -0.52494993724140
lambda[   5] =  -0.50373992447909
lambda[   6] =  -0.40093345923644
lambda[   7] =  -0.40056489796030
lambda[   8] =  -0.34023376018175
lambda[   9] =  -0.33996636423967
lambda[  10] =  -0.01163807201521
lambda[  11] =   0.00510467782250
lambda[  12] =   0.02776284558125
lambda[  13] =   0.05805032267720
lambda[  14] =   0.07143426231403
lambda[  15] =   0.07385120009266
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.238 ms
rank =  0, Distributing orbital back into band + domain format took 14.709 ms
rank = 0, Subspace_Rotation used 18.967 ms

Total time for subspace rotation: 18.972 ms
rank = 0, Efermi =  -0.040712981769 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.063 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.187 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.196 ms
rank = 0, Calculating density took 1507.696 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.859 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -21.675356419014
Eband   =    -9.236312793960
E1      =    19.491041418712
E2      =    -6.742246854573
E3      =    -9.352319945701
Exc     =    -8.249510755489
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 5.158e-03, dEband = 6.174e-02
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -21.675356419, dEtot = 5.158e-03, dEband = 6.174e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.1928239906830, which took 0.155 ms

iter_count = 108, r_2norm = 2.859e-04, tol*||rhs|| = 4.477e-04

Anderson update took 70.213 ms, out of which F'*F took 30.603 ms; b-Ax took 200.398 ms, out of which Lap took 180.310 ms
rank = 0, Mixing (+ precond) took 464.441 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213774, int_b + int_rho = 8.004e-14, checking this took 0.075 ms
2-norm of RHS = 683.2583765080836, which took 0.182 ms

iter_count = 306, r_2norm = 5.793e-04, tol*||rhs|| = 6.833e-04

Anderson update took 187.308 ms, out of which F'*F took 86.002 ms; b-Ax took 576.203 ms, out of which Lap took 513.612 ms
Solving Poisson took 1268.505 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.882 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.111787 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 144.720 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.112594 
Total time for convolution: 	 convolve: 5.112386 
Total time for convolution: 	 convolve: 5.106469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.671 ms
---Transfer Veff_loc: D2D took 1.394 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.812 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.567 ms

This SCF took 27816.988 ms, scf error = 1.501e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.173851, lowerbound = -0.863622, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1363.277 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 58.180 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.855 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.120 ms
rank =  0, Distribute data + matrix mult took 62.173 ms
rank =  0, finding HY took 22.885 ms
rank =  0, distributing HY into block cyclic form took 14.036 ms
rank =  0, finding Y'*HY took 5.648 ms
Rank 0, Project_Hamiltonian used 104.771 ms
Total time for projection: 104.783 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.081 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.793797116294429
    last  calculated eigval = 0.060034753457892
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.79379711629443
lambda[   2] =  -0.55762888052819
lambda[   3] =  -0.55738193943318
lambda[   4] =  -0.46530107992762
lambda[   5] =  -0.43729538289875
lambda[   6] =  -0.34229379398983
lambda[   7] =  -0.34206632997444
lambda[   8] =  -0.27648574020954
lambda[   9] =  -0.27644134643304
lambda[  10] =  -0.02435400044789
lambda[  11] =   0.00483375028921
lambda[  12] =   0.02645499800587
lambda[  13] =   0.03968649018209
lambda[  14] =   0.05392229946193
lambda[  15] =   0.06003475345789
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 4.104 ms
rank =  0, Distributing orbital back into band + domain format took 14.644 ms
rank = 0, Subspace_Rotation used 18.764 ms

Total time for subspace rotation: 18.769 ms
rank = 0, Efermi =  -0.053428910179 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.175 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.078 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.188 ms
rank = 0, Calculating density took 1494.573 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.832 ms
rank = 0, D2D took 1.040 ms
rank = 0, Transfering density took 1.045 ms
Etot    =   -21.629476843116
Eband   =    -8.097383219917
E1      =    18.505685350795
E2      =    -6.570418588593
E3      =    -9.703481933144
Exc     =    -8.536538407180
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 5.098e-03, dEband = 1.265e-01
rank = 0, Calculating/Estimating energy took 1.088 ms, Etot = -21.629476843, dEtot = 5.098e-03, dEband = 1.265e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 3.9779630050076, which took 0.066 ms

iter_count = 108, r_2norm = 1.125e-04, tol*||rhs|| = 1.591e-04

Anderson update took 64.886 ms, out of which F'*F took 29.869 ms; b-Ax took 201.982 ms, out of which Lap took 179.500 ms
rank = 0, Mixing (+ precond) took 458.955 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213775, int_b + int_rho = 9.459e-14, checking this took 0.122 ms
2-norm of RHS = 683.4329595701350, which took 0.205 ms

iter_count = 270, r_2norm = 5.847e-04, tol*||rhs|| = 6.834e-04

Anderson update took 164.279 ms, out of which F'*F took 73.725 ms; b-Ax took 501.564 ms, out of which Lap took 445.029 ms
Solving Poisson took 1131.646 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.072452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.987 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.089417 
Total time for convolution: 	 convolve: 5.109982 
Total time for convolution: 	 convolve: 5.084191 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.640 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.479 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.808 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.765 ms

This SCF took 27434.906 ms, scf error = 4.369e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.160035, lowerbound = -0.793797, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1378.142 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.674 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.556 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.082 ms
rank =  0, Distribute data + matrix mult took 22.330 ms
rank =  0, finding HY took 22.179 ms
rank =  0, distributing HY into block cyclic form took 14.266 ms
rank =  0, finding Y'*HY took 5.990 ms
Rank 0, Project_Hamiltonian used 64.799 ms
Total time for projection: 64.811 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.789415771008759
    last  calculated eigval = 0.052635911807959
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.78941577100876
lambda[   2] =  -0.54949520822771
lambda[   3] =  -0.54936244847959
lambda[   4] =  -0.45730733163605
lambda[   5] =  -0.43039453173929
lambda[   6] =  -0.33279014504657
lambda[   7] =  -0.33265855897310
lambda[   8] =  -0.27131715277578
lambda[   9] =  -0.27130481054367
lambda[  10] =  -0.02910365736351
lambda[  11] =   0.00306682033853
lambda[  12] =   0.01970376643206
lambda[  13] =   0.02434278375487
lambda[  14] =   0.04026026033312
lambda[  15] =   0.05263591180796
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 4.202 ms
rank =  0, Distributing orbital back into band + domain format took 14.302 ms
rank = 0, Subspace_Rotation used 18.524 ms

Total time for subspace rotation: 18.530 ms
rank = 0, Efermi =  -0.058178567092 calculate fermi energy took 0.080 ms
rank = 0, --- Calculate rho: sum over local bands took 2.800 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.774 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.245 ms
rank = 0, Calculating density took 1469.608 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.739 ms
rank = 0, D2D took 1.104 ms
rank = 0, Transfering density took 1.107 ms
Etot    =   -21.626144883446
Eband   =    -7.968091917505
E1      =    18.447276897947
E2      =    -6.488090072191
E3      =    -9.756626359736
Exc     =    -8.574905207263
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 3.702e-04, dEband = 1.437e-02
rank = 0, Calculating/Estimating energy took 1.290 ms, Etot = -21.626144883, dEtot = 3.702e-04, dEband = 1.437e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1963221119121, which took 0.072 ms

iter_count = 114, r_2norm = 3.277e-05, tol*||rhs|| = 4.785e-05

Anderson update took 67.655 ms, out of which F'*F took 32.171 ms; b-Ax took 216.758 ms, out of which Lap took 192.532 ms
rank = 0, Mixing (+ precond) took 498.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213764, int_b + int_rho = -2.183e-14, checking this took 0.112 ms
2-norm of RHS = 683.4521185694529, which took 0.106 ms

iter_count = 258, r_2norm = 5.554e-04, tol*||rhs|| = 6.835e-04

Anderson update took 158.649 ms, out of which F'*F took 70.148 ms; b-Ax took 484.317 ms, out of which Lap took 427.840 ms
Solving Poisson took 1086.099 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.077933 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.590 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.080972 
Total time for convolution: 	 convolve: 5.077100 
Total time for convolution: 	 convolve: 5.072327 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.627 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.130 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.819 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.794 ms

This SCF took 27387.257 ms, scf error = 1.436e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.152636, lowerbound = -0.789416, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1371.776 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 38.991 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.711 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 42.740 ms
rank =  0, finding HY took 22.267 ms
rank =  0, distributing HY into block cyclic form took 14.658 ms
rank =  0, finding Y'*HY took 4.785 ms
Rank 0, Project_Hamiltonian used 84.486 ms
Total time for projection: 84.506 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.783342033640799
    last  calculated eigval = 0.046007063762670
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.78334203364080
lambda[   2] =  -0.54281234994070
lambda[   3] =  -0.54274640642465
lambda[   4] =  -0.45083591072088
lambda[   5] =  -0.42406291885149
lambda[   6] =  -0.32601681849705
lambda[   7] =  -0.32594099449552
lambda[   8] =  -0.26545963646411
lambda[   9] =  -0.26544297318013
lambda[  10] =  -0.03093611863210
lambda[  11] =   0.00223399199359
lambda[  12] =   0.01477628955812
lambda[  13] =   0.01647427164775
lambda[  14] =   0.03092940857437
lambda[  15] =   0.04600706376267
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.168 ms
rank =  0, Distributing orbital back into band + domain format took 14.624 ms
rank = 0, Subspace_Rotation used 18.810 ms

Total time for subspace rotation: 18.814 ms
rank = 0, Efermi =  -0.060011028296 calculate fermi energy took 2.477 ms
rank = 0, --- Calculate rho: sum over local bands took 3.822 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.022 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.189 ms
rank = 0, Calculating density took 1483.873 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.948 ms
Etot    =   -21.625026162831
Eband   =    -7.853320085116
E1      =    18.380551987293
E2      =    -6.431758955273
E3      =    -9.792814630611
Exc     =    -8.601690562342
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 1.243e-04, dEband = 1.275e-02
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -21.625026163, dEtot = 1.243e-04, dEband = 1.275e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3602689752456, which took 0.242 ms

iter_count = 114, r_2norm = 1.092e-05, tol*||rhs|| = 1.441e-05

Anderson update took 67.414 ms, out of which F'*F took 32.470 ms; b-Ax took 217.593 ms, out of which Lap took 194.629 ms
rank = 0, Mixing (+ precond) took 489.339 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213776, int_b + int_rho = 1.019e-13, checking this took 0.106 ms
2-norm of RHS = 683.9454913734376, which took 0.141 ms

iter_count = 258, r_2norm = 6.531e-04, tol*||rhs|| = 6.839e-04

Anderson update took 157.755 ms, out of which F'*F took 71.506 ms; b-Ax took 487.363 ms, out of which Lap took 431.815 ms
Solving Poisson took 1086.030 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.080746 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.837 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.081682 
Total time for convolution: 	 convolve: 5.081259 
Total time for convolution: 	 convolve: 5.102399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.623 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.732 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.400 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.376 ms

This SCF took 27385.276 ms, scf error = 6.869e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.146007, lowerbound = -0.783342, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1455.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.662 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.576 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.105 ms
rank =  0, Distribute data + matrix mult took 18.364 ms
rank =  0, finding HY took 22.435 ms
rank =  0, distributing HY into block cyclic form took 14.471 ms
rank =  0, finding Y'*HY took 4.806 ms
Rank 0, Project_Hamiltonian used 60.109 ms
Total time for projection: 60.122 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.773825297041713
    last  calculated eigval = 0.039935962226006
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.77382529704171
lambda[   2] =  -0.53464990297908
lambda[   3] =  -0.53463628456964
lambda[   4] =  -0.44283632507628
lambda[   5] =  -0.41592367599970
lambda[   6] =  -0.31846416094334
lambda[   7] =  -0.31843268416767
lambda[   8] =  -0.25672444401257
lambda[   9] =  -0.25670720573450
lambda[  10] =  -0.03029920195613
lambda[  11] =   0.00319553100880
lambda[  12] =   0.01211100316131
lambda[  13] =   0.01579248885337
lambda[  14] =   0.02661311687456
lambda[  15] =   0.03993596222601
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.213 ms
rank =  0, Distributing orbital back into band + domain format took 14.641 ms
rank = 0, Subspace_Rotation used 18.873 ms

Total time for subspace rotation: 18.878 ms
rank = 0, Efermi =  -0.059374111703 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.078 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.215 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.204 ms
rank = 0, Calculating density took 1543.046 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.194 ms
rank = 0, D2D took 1.313 ms
rank = 0, Transfering density took 1.320 ms
Etot    =   -21.624445102926
Eband   =    -7.704399961720
E1      =    18.307182741508
E2      =    -6.348991355207
E3      =    -9.818319688880
Exc     =    -8.619397838251
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 6.456e-05, dEband = 1.655e-02
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -21.624445103, dEtot = 6.456e-05, dEband = 1.655e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2938988669608, which took 0.049 ms

iter_count = 114, r_2norm = 7.903e-06, tol*||rhs|| = 1.176e-05

Anderson update took 67.940 ms, out of which F'*F took 32.139 ms; b-Ax took 216.938 ms, out of which Lap took 194.050 ms
rank = 0, Mixing (+ precond) took 485.932 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213768, int_b + int_rho = 1.819e-14, checking this took 0.118 ms
2-norm of RHS = 683.9350114087630, which took 0.140 ms

iter_count = 228, r_2norm = 6.449e-04, tol*||rhs|| = 6.839e-04

Anderson update took 135.825 ms, out of which F'*F took 62.226 ms; b-Ax took 428.374 ms, out of which Lap took 378.811 ms
Solving Poisson took 953.022 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.081345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.571 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.098520 
Total time for convolution: 	 convolve: 5.081841 
Total time for convolution: 	 convolve: 5.072361 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.012 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.383 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.352 ms

This SCF took 27305.135 ms, scf error = 2.801e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.139936, lowerbound = -0.773825, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1383.454 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 49.449 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.623 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 53.117 ms
rank =  0, finding HY took 22.431 ms
rank =  0, distributing HY into block cyclic form took 14.695 ms
rank =  0, finding Y'*HY took 4.574 ms
Rank 0, Project_Hamiltonian used 94.857 ms
Total time for projection: 94.879 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.771766295584676
    last  calculated eigval = 0.034696130811707
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.77176629558468
lambda[   2] =  -0.53207083919886
lambda[   3] =  -0.53204901040236
lambda[   4] =  -0.44041451267598
lambda[   5] =  -0.41353938811854
lambda[   6] =  -0.31589060400551
lambda[   7] =  -0.31585621544849
lambda[   8] =  -0.25441483438578
lambda[   9] =  -0.25440224247007
lambda[  10] =  -0.02878357046576
lambda[  11] =   0.00498714138654
lambda[  12] =   0.01272626124839
lambda[  13] =   0.01575166974613
lambda[  14] =   0.02438132283172
lambda[  15] =   0.03469613081171
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.258 ms
rank =  0, Distributing orbital back into band + domain format took 14.591 ms
rank = 0, Subspace_Rotation used 18.864 ms

Total time for subspace rotation: 19.312 ms
rank = 0, Efermi =  -0.057858480182 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.537 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.286 ms
rank = 0, Calculating density took 1505.177 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.859 ms
rank = 0, D2D took 1.025 ms
rank = 0, Transfering density took 1.031 ms
Etot    =   -21.624334940987
Eband   =    -7.660807885218
E1      =    18.286629149140
E2      =    -6.324593871735
E3      =    -9.823686357869
Exc     =    -8.623295345962
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 1.224e-05, dEband = 4.844e-03
rank = 0, Calculating/Estimating energy took 1.027 ms, Etot = -21.624334941, dEtot = 1.224e-05, dEband = 4.844e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1165901505650, which took 0.075 ms

iter_count = 114, r_2norm = 4.155e-06, tol*||rhs|| = 4.664e-06

Anderson update took 67.710 ms, out of which F'*F took 31.582 ms; b-Ax took 213.379 ms, out of which Lap took 189.446 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.455 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213768, int_b + int_rho = 2.183e-14, checking this took 0.099 ms
2-norm of RHS = 683.9223757606043, which took 0.144 ms

iter_count = 222, r_2norm = 6.036e-04, tol*||rhs|| = 6.839e-04

Anderson update took 131.828 ms, out of which F'*F took 62.850 ms; b-Ax took 419.961 ms, out of which Lap took 373.322 ms
Solving Poisson took 932.762 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.078594 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.390 ms
Total time for convolution: 	 convolve: 5.074605 
Total time for convolution: 	 convolve: 5.078751 
Total time for convolution: 	 convolve: 5.075150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.392 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.379 ms

This SCF took 27239.672 ms, scf error = 1.872e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.134696, lowerbound = -0.771766, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1360.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 55.381 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.522 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 58.943 ms
rank =  0, finding HY took 22.135 ms
rank =  0, distributing HY into block cyclic form took 14.485 ms
rank =  0, finding Y'*HY took 4.753 ms
Rank 0, Project_Hamiltonian used 100.348 ms
Total time for projection: 100.363 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.769350407386345
    last  calculated eigval = 0.031907268384451
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76935040738635
lambda[   2] =  -0.52973765462707
lambda[   3] =  -0.52971467499292
lambda[   4] =  -0.43817415363270
lambda[   5] =  -0.41123295799910
lambda[   6] =  -0.31369906187144
lambda[   7] =  -0.31366519692236
lambda[   8] =  -0.25200742422851
lambda[   9] =  -0.25199678438062
lambda[  10] =  -0.02567310712703
lambda[  11] =   0.00934159148204
lambda[  12] =   0.01591697048302
lambda[  13] =   0.01784529086417
lambda[  14] =   0.02461998292853
lambda[  15] =   0.03190726838445
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 4.160 ms
rank =  0, Distributing orbital back into band + domain format took 14.433 ms
rank = 0, Subspace_Rotation used 18.609 ms

Total time for subspace rotation: 18.614 ms
rank = 0, Efermi =  -0.054748016850 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.869 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.334 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 1487.709 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 1.450 ms
rank = 0, Transfering density took 1.458 ms
Etot    =   -21.624210443924
Eband   =    -7.619156632650
E1      =    18.264785693569
E2      =    -6.304065797689
E3      =    -9.827564231155
Exc     =    -8.626328445136
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 1.383e-05, dEband = 4.628e-03
rank = 0, Calculating/Estimating energy took 1.127 ms, Etot = -21.624210444, dEtot = 1.383e-05, dEband = 4.628e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0590179530214, which took 0.054 ms

iter_count = 114, r_2norm = 2.045e-06, tol*||rhs|| = 2.361e-06

Anderson update took 67.308 ms, out of which F'*F took 32.070 ms; b-Ax took 216.295 ms, out of which Lap took 193.022 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.882 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213776, int_b + int_rho = 1.019e-13, checking this took 0.121 ms
2-norm of RHS = 683.9332982220225, which took 0.127 ms

iter_count = 216, r_2norm = 5.622e-04, tol*||rhs|| = 6.839e-04

Anderson update took 128.666 ms, out of which F'*F took 60.584 ms; b-Ax took 410.452 ms, out of which Lap took 364.667 ms
Solving Poisson took 907.589 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.081692 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.555 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.082531 
Total time for convolution: 	 convolve: 5.086230 
Total time for convolution: 	 convolve: 5.075047 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.502 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.958 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.381 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.362 ms

This SCF took 27207.214 ms, scf error = 1.041e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131907, lowerbound = -0.769350, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1365.871 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 51.425 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.569 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 55.040 ms
rank =  0, finding HY took 22.274 ms
rank =  0, distributing HY into block cyclic form took 14.523 ms
rank =  0, finding Y'*HY took 4.748 ms
Rank 0, Project_Hamiltonian used 96.622 ms
Total time for projection: 96.654 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.767136151867928
    last  calculated eigval = 0.034624796402226
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76713615186793
lambda[   2] =  -0.52774052788309
lambda[   3] =  -0.52772231291185
lambda[   4] =  -0.43612861583412
lambda[   5] =  -0.40921144008823
lambda[   6] =  -0.31170903882768
lambda[   7] =  -0.31167704952578
lambda[   8] =  -0.24994043100797
lambda[   9] =  -0.24993283724742
lambda[  10] =  -0.01975714903526
lambda[  11] =   0.01604191488620
lambda[  12] =   0.02137815504711
lambda[  13] =   0.02343085771706
lambda[  14] =   0.02720380217661
lambda[  15] =   0.03462479640223
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 4.775 ms
rank =  0, Distributing orbital back into band + domain format took 14.276 ms
rank = 0, Subspace_Rotation used 19.075 ms

Total time for subspace rotation: 19.083 ms
rank = 0, Efermi =  -0.048832058772 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.965 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.179 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.310 ms
rank = 0, Calculating density took 1489.835 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.683 ms
rank = 0, D2D took 0.796 ms
rank = 0, Transfering density took 0.803 ms
Etot    =   -21.624216821467
Eband   =    -7.582396810826
E1      =    18.246313684404
E2      =    -6.284978084260
E3      =    -9.831463165928
Exc     =    -8.629433856683
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 7.086e-07, dEband = 4.084e-03
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -21.624216821, dEtot = 7.086e-07, dEband = 4.084e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0719959748247, which took 0.057 ms

iter_count = 108, r_2norm = 2.581e-06, tol*||rhs|| = 2.880e-06

Anderson update took 64.201 ms, out of which F'*F took 30.295 ms; b-Ax took 202.587 ms, out of which Lap took 180.149 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.893 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213778, int_b + int_rho = 1.201e-13, checking this took 0.119 ms
2-norm of RHS = 683.9346116300912, which took 0.127 ms

iter_count = 174, r_2norm = 5.979e-04, tol*||rhs|| = 6.839e-04

Anderson update took 103.614 ms, out of which F'*F took 49.874 ms; b-Ax took 329.972 ms, out of which Lap took 293.882 ms
Solving Poisson took 732.332 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.084789 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.748 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.084607 
Total time for convolution: 	 convolve: 5.081927 
Total time for convolution: 	 convolve: 5.073964 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.341 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.392 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 27016.964 ms, scf error = 5.680e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.134625, lowerbound = -0.767136, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1379.120 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 43.562 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.493 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 47.094 ms
rank =  0, finding HY took 22.394 ms
rank =  0, distributing HY into block cyclic form took 14.238 ms
rank =  0, finding Y'*HY took 5.047 ms
Rank 0, Project_Hamiltonian used 88.809 ms
Total time for projection: 88.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.488 ms
    first calculated eigval = -0.767388405165818
    last  calculated eigval = 0.033809750207623
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76738840516582
lambda[   2] =  -0.52792400271100
lambda[   3] =  -0.52790113479745
lambda[   4] =  -0.43631219330179
lambda[   5] =  -0.40940707348085
lambda[   6] =  -0.31188039792313
lambda[   7] =  -0.31184335526405
lambda[   8] =  -0.25015669162092
lambda[   9] =  -0.25014890734294
lambda[  10] =  -0.02015221683471
lambda[  11] =   0.01486214721195
lambda[  12] =   0.01914998239919
lambda[  13] =   0.02204254431375
lambda[  14] =   0.02359613483267
lambda[  15] =   0.03380975020762
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.505 ms
rank =  0, subspace rotation using ScaLAPACK took 4.876 ms
rank =  0, Distributing orbital back into band + domain format took 14.300 ms
rank = 0, Subspace_Rotation used 19.200 ms

Total time for subspace rotation: 19.207 ms
rank = 0, Efermi =  -0.049227126577 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.875 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.422 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1495.391 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.806 ms
rank = 0, D2D took 0.923 ms
rank = 0, Transfering density took 0.929 ms
Etot    =   -21.624409540711
Eband   =    -7.585924323662
E1      =    18.248484523452
E2      =    -6.286584603568
E3      =    -9.830004618244
Exc     =    -8.628417873763
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 2.141e-05, dEband = 3.919e-04
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -21.624409541, dEtot = 2.141e-05, dEband = 3.919e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0707399537795, which took 0.065 ms

iter_count = 108, r_2norm = 2.197e-06, tol*||rhs|| = 2.830e-06

Anderson update took 63.976 ms, out of which F'*F took 30.395 ms; b-Ax took 205.393 ms, out of which Lap took 182.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.163 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213772, int_b + int_rho = 6.548e-14, checking this took 0.130 ms
2-norm of RHS = 683.9556636748333, which took 0.213 ms

iter_count = 174, r_2norm = 6.183e-04, tol*||rhs|| = 6.840e-04

Anderson update took 103.799 ms, out of which F'*F took 48.542 ms; b-Ax took 330.154 ms, out of which Lap took 293.449 ms
Solving Poisson took 731.916 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.098926 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.205 ms
Total time for convolution: 	 convolve: 5.078828 
Total time for convolution: 	 convolve: 6.230675 
Total time for convolution: 	 convolve: 5.235538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.385 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.365 ms

This SCF took 28333.157 ms, scf error = 4.613e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133810, lowerbound = -0.767388, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1398.906 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 41.367 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.675 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 45.080 ms
rank =  0, finding HY took 22.232 ms
rank =  0, distributing HY into block cyclic form took 15.001 ms
rank =  0, finding Y'*HY took 3.974 ms
Rank 0, Project_Hamiltonian used 86.908 ms
Total time for projection: 86.933 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.767036908577288
    last  calculated eigval = 0.037361007485241
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76703690857729
lambda[   2] =  -0.52746435056317
lambda[   3] =  -0.52743901264421
lambda[   4] =  -0.43588706428095
lambda[   5] =  -0.40898515349861
lambda[   6] =  -0.31143231690048
lambda[   7] =  -0.31139306547910
lambda[   8] =  -0.24974184660670
lambda[   9] =  -0.24973343840219
lambda[  10] =  -0.01663370414684
lambda[  11] =   0.01768598937786
lambda[  12] =   0.02131375005063
lambda[  13] =   0.02284229751772
lambda[  14] =   0.02705906230478
lambda[  15] =   0.03736100748524
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.224 ms
rank =  0, Distributing orbital back into band + domain format took 14.672 ms
rank = 0, Subspace_Rotation used 18.914 ms

Total time for subspace rotation: 18.919 ms
rank = 0, Efermi =  -0.045708613873 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.904 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.432 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1512.635 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.753 ms
rank = 0, D2D took 1.021 ms
rank = 0, Transfering density took 1.032 ms
Etot    =   -21.624437542378
Eband   =    -7.578226314274
E1      =    18.245246339394
E2      =    -6.281946924094
E3      =    -9.830633057980
Exc     =    -8.628896461023
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 3.111e-06, dEband = 8.553e-04
rank = 0, Calculating/Estimating energy took 1.133 ms, Etot = -21.624437542, dEtot = 3.111e-06, dEband = 8.553e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0725636635009, which took 0.064 ms

iter_count = 108, r_2norm = 2.232e-06, tol*||rhs|| = 2.903e-06

Anderson update took 64.430 ms, out of which F'*F took 29.953 ms; b-Ax took 202.405 ms, out of which Lap took 179.750 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.891 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213770, int_b + int_rho = 4.002e-14, checking this took 0.110 ms
2-norm of RHS = 683.9550971972474, which took 0.153 ms

iter_count = 132, r_2norm = 6.282e-04, tol*||rhs|| = 6.840e-04

Anderson update took 78.341 ms, out of which F'*F took 37.797 ms; b-Ax took 250.801 ms, out of which Lap took 223.129 ms
Solving Poisson took 555.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.078366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.710 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.098067 
Total time for convolution: 	 convolve: 5.078671 
Total time for convolution: 	 convolve: 5.075127 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.953 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.377 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.353 ms

This SCF took 26903.862 ms, scf error = 4.937e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.137361, lowerbound = -0.767037, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1365.162 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 55.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.692 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 59.584 ms
rank =  0, finding HY took 22.130 ms
rank =  0, distributing HY into block cyclic form took 14.751 ms
rank =  0, finding Y'*HY took 4.482 ms
Rank 0, Project_Hamiltonian used 101.633 ms
Total time for projection: 101.651 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.767233030878829
    last  calculated eigval = 0.036717814664951
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76723303087883
lambda[   2] =  -0.52764414825583
lambda[   3] =  -0.52761810253814
lambda[   4] =  -0.43606446817494
lambda[   5] =  -0.40916439460289
lambda[   6] =  -0.31160498589775
lambda[   7] =  -0.31156492999732
lambda[   8] =  -0.24992416130605
lambda[   9] =  -0.24991526373164
lambda[  10] =  -0.01706705476111
lambda[  11] =   0.01724434593575
lambda[  12] =   0.02085356302976
lambda[  13] =   0.02212560082734
lambda[  14] =   0.02618012610815
lambda[  15] =   0.03671781466495
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 4.237 ms
rank =  0, Distributing orbital back into band + domain format took 14.663 ms
rank = 0, Subspace_Rotation used 18.918 ms

Total time for subspace rotation: 18.922 ms
rank = 0, Efermi =  -0.046141964477 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.958 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.354 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.213 ms
rank = 0, Calculating density took 1493.564 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.743 ms
rank = 0, D2D took 1.070 ms
rank = 0, Transfering density took 1.073 ms
Etot    =   -21.624437667745
Eband   =    -7.581466971145
E1      =    18.247052651696
E2      =    -6.283526954741
E3      =    -9.830033687183
Exc     =    -8.628442901670
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 1.393e-08, dEband = 3.601e-04
rank = 0, Calculating/Estimating energy took 1.090 ms, Etot = -21.624437668, dEtot = 1.393e-08, dEband = 3.601e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0556879825976, which took 0.066 ms

iter_count = 108, r_2norm = 1.860e-06, tol*||rhs|| = 2.228e-06

Anderson update took 64.262 ms, out of which F'*F took 30.474 ms; b-Ax took 204.998 ms, out of which Lap took 183.191 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.754 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213774, int_b + int_rho = 8.004e-14, checking this took 0.118 ms
2-norm of RHS = 683.9521677677104, which took 0.211 ms

iter_count = 144, r_2norm = 5.579e-04, tol*||rhs|| = 6.840e-04

Anderson update took 88.464 ms, out of which F'*F took 40.306 ms; b-Ax took 274.538 ms, out of which Lap took 244.323 ms
Solving Poisson took 608.024 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.077873 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.090994 
Total time for convolution: 	 convolve: 5.081930 
Total time for convolution: 	 convolve: 5.080492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.387 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.387 ms

This SCF took 26924.340 ms, scf error = 5.432e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136718, lowerbound = -0.767233, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1363.600 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 57.758 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.656 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 61.454 ms
rank =  0, finding HY took 22.411 ms
rank =  0, distributing HY into block cyclic form took 14.609 ms
rank =  0, finding Y'*HY took 4.658 ms
Rank 0, Project_Hamiltonian used 103.162 ms
Total time for projection: 103.176 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -0.766953833634059
    last  calculated eigval = 0.037648212421053
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76695383363406
lambda[   2] =  -0.52739178386754
lambda[   3] =  -0.52736568989563
lambda[   4] =  -0.43581251957740
lambda[   5] =  -0.40891128162106
lambda[   6] =  -0.31136381812435
lambda[   7] =  -0.31132381400468
lambda[   8] =  -0.24966738544988
lambda[   9] =  -0.24965803295090
lambda[  10] =  -0.01629971921296
lambda[  11] =   0.01734561938264
lambda[  12] =   0.02107026255079
lambda[  13] =   0.02208095872231
lambda[  14] =   0.02685798870379
lambda[  15] =   0.03764821242105
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.241 ms
rank =  0, Distributing orbital back into band + domain format took 14.655 ms
rank = 0, Subspace_Rotation used 18.913 ms

Total time for subspace rotation: 18.918 ms
rank = 0, Efermi =  -0.045374628946 calculate fermi energy took 0.092 ms
rank = 0, --- Calculate rho: sum over local bands took 3.969 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.328 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.252 ms
rank = 0, Calculating density took 1493.566 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.786 ms
rank = 0, D2D took 0.962 ms
rank = 0, Transfering density took 0.965 ms
Etot    =   -21.624472311649
Eband   =    -7.576896318612
E1      =    18.244505053811
E2      =    -6.281344632853
E3      =    -9.830608631779
Exc     =    -8.628893222929
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 3.849e-06, dEband = 5.079e-04
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -21.624472312, dEtot = 3.849e-06, dEband = 5.079e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0573671000013, which took 0.061 ms

iter_count = 102, r_2norm = 1.564e-06, tol*||rhs|| = 2.295e-06

Anderson update took 60.800 ms, out of which F'*F took 28.223 ms; b-Ax took 191.225 ms, out of which Lap took 170.010 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213773, int_b + int_rho = 6.912e-14, checking this took 0.129 ms
2-norm of RHS = 683.9462819230537, which took 0.170 ms

iter_count = 168, r_2norm = 5.846e-04, tol*||rhs|| = 6.839e-04

Anderson update took 99.020 ms, out of which F'*F took 48.107 ms; b-Ax took 319.438 ms, out of which Lap took 284.192 ms
Solving Poisson took 705.986 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.074879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.460 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.077330 
Total time for convolution: 	 convolve: 5.079573 
Total time for convolution: 	 convolve: 5.078534 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.111 ms
---Transfer Veff_loc: D2D took 1.837 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.380 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.242 ms

This SCF took 26994.198 ms, scf error = 4.292e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137648, lowerbound = -0.766954, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1408.274 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 40.799 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.726 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 44.568 ms
rank =  0, finding HY took 22.441 ms
rank =  0, distributing HY into block cyclic form took 14.576 ms
rank =  0, finding Y'*HY took 4.726 ms
Rank 0, Project_Hamiltonian used 86.351 ms
Total time for projection: 86.394 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.766214303978144
    last  calculated eigval = 0.038723327384487
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76621430397814
lambda[   2] =  -0.52674905462012
lambda[   3] =  -0.52672705765525
lambda[   4] =  -0.43515895587364
lambda[   5] =  -0.40825993441354
lambda[   6] =  -0.31074196740573
lambda[   7] =  -0.31070671570820
lambda[   8] =  -0.24899840983727
lambda[   9] =  -0.24899090457088
lambda[  10] =  -0.01514840658514
lambda[  11] =   0.01669396708184
lambda[  12] =   0.02195290075604
lambda[  13] =   0.02295146009329
lambda[  14] =   0.02807845646383
lambda[  15] =   0.03872332738449
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.216 ms
rank =  0, Distributing orbital back into band + domain format took 14.823 ms
rank = 0, Subspace_Rotation used 19.062 ms

Total time for subspace rotation: 19.068 ms
rank = 0, Efermi =  -0.044223316362 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 4.014 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.228 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1521.519 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.765 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -21.624499945909
Eband   =    -7.565094608461
E1      =    18.238110284676
E2      =    -6.275554213426
E3      =    -9.832074507550
Exc     =    -8.630003254549
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 3.070e-06, dEband = 1.311e-03
rank = 0, Calculating/Estimating energy took 1.101 ms, Etot = -21.624499946, dEtot = 3.070e-06, dEband = 1.311e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0462262252594, which took 0.060 ms

iter_count = 102, r_2norm = 1.408e-06, tol*||rhs|| = 1.849e-06

Anderson update took 60.296 ms, out of which F'*F took 28.792 ms; b-Ax took 194.085 ms, out of which Lap took 173.000 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.386 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213773, int_b + int_rho = 6.912e-14, checking this took 0.115 ms
2-norm of RHS = 683.9443379958539, which took 0.229 ms

iter_count = 132, r_2norm = 6.484e-04, tol*||rhs|| = 6.839e-04

Anderson update took 78.223 ms, out of which F'*F took 36.884 ms; b-Ax took 251.143 ms, out of which Lap took 223.172 ms
Solving Poisson took 554.634 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.075091 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.822 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.079272 
Total time for convolution: 	 convolve: 5.099034 
Total time for convolution: 	 convolve: 5.094766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.400 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.389 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.370 ms

This SCF took 26886.210 ms, scf error = 1.989e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138723, lowerbound = -0.766214, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1427.159 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 25.215 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.690 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 28.949 ms
rank =  0, finding HY took 22.229 ms
rank =  0, distributing HY into block cyclic form took 14.443 ms
rank =  0, finding Y'*HY took 4.784 ms
Rank 0, Project_Hamiltonian used 70.436 ms
Total time for projection: 70.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.766016783860802
    last  calculated eigval = 0.039950737753282
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76601678386080
lambda[   2] =  -0.52658986673863
lambda[   3] =  -0.52656823373896
lambda[   4] =  -0.43499428269486
lambda[   5] =  -0.40809537836339
lambda[   6] =  -0.31059020876302
lambda[   7] =  -0.31055522801219
lambda[   8] =  -0.24882736510842
lambda[   9] =  -0.24882069683222
lambda[  10] =  -0.01511985936233
lambda[  11] =   0.01597978585569
lambda[  12] =   0.02158286920515
lambda[  13] =   0.02255023585508
lambda[  14] =   0.02784549866044
lambda[  15] =   0.03995073775328
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 4.234 ms
rank =  0, Distributing orbital back into band + domain format took 14.605 ms
rank = 0, Subspace_Rotation used 18.858 ms

Total time for subspace rotation: 18.863 ms
rank = 0, Efermi =  -0.044194769026 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.929 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.398 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.234 ms
rank = 0, Calculating density took 1524.316 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 1.011 ms
rank = 0, Transfering density took 1.014 ms
Etot    =   -21.624527164971
Eband   =    -7.562116088560
E1      =    18.236393155806
E2      =    -6.274204107779
E3      =    -9.832371517202
Exc     =    -8.630238768646
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 3.024e-06, dEband = 3.309e-04
rank = 0, Calculating/Estimating energy took 1.073 ms, Etot = -21.624527165, dEtot = 3.024e-06, dEband = 3.309e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0354259229954, which took 0.142 ms

iter_count = 102, r_2norm = 1.131e-06, tol*||rhs|| = 1.417e-06

Anderson update took 60.951 ms, out of which F'*F took 28.369 ms; b-Ax took 190.604 ms, out of which Lap took 169.433 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 432.197 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213770, int_b + int_rho = 4.366e-14, checking this took 0.118 ms
2-norm of RHS = 683.9465070722495, which took 0.189 ms

iter_count = 102, r_2norm = 6.158e-04, tol*||rhs|| = 6.839e-04

Anderson update took 59.973 ms, out of which F'*F took 29.156 ms; b-Ax took 193.634 ms, out of which Lap took 172.627 ms
Solving Poisson took 429.410 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.080892 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.264 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.075431 
Total time for convolution: 	 convolve: 5.077347 
Total time for convolution: 	 convolve: 5.077106 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.585 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.389 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.356 ms

This SCF took 26704.744 ms, scf error = 1.056e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139951, lowerbound = -0.766017, upperbound = 267.575906

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1373.656 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 53.936 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.654 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 57.636 ms
rank =  0, finding HY took 22.424 ms
rank =  0, distributing HY into block cyclic form took 14.597 ms
rank =  0, finding Y'*HY took 4.592 ms
Rank 0, Project_Hamiltonian used 99.284 ms
Total time for projection: 99.298 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -0.765936656539444
    last  calculated eigval = 0.041347566131178
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.76593665653944
lambda[   2] =  -0.52650911173171
lambda[   3] =  -0.52648841270123
lambda[   4] =  -0.43491404530030
lambda[   5] =  -0.40801771213190
lambda[   6] =  -0.31051003992552
lambda[   7] =  -0.31047610586336
lambda[   8] =  -0.24874912380135
lambda[   9] =  -0.24874297594140
lambda[  10] =  -0.01445373601387
lambda[  11] =   0.01606202077685
lambda[  12] =   0.02173603052253
lambda[  13] =   0.02251818903561
lambda[  14] =   0.02868790986315
lambda[  15] =   0.04134756613118
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.210 ms
rank =  0, Distributing orbital back into band + domain format took 14.499 ms
rank = 0, Subspace_Rotation used 18.723 ms

Total time for subspace rotation: 18.728 ms
rank = 0, Efermi =  -0.043528645790 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.932 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.275 ms
rank = 0, Calculating density took 1499.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.873 ms
rank = 0, D2D took 1.043 ms
rank = 0, Transfering density took 1.046 ms
Etot    =   -21.624536213440
Eband   =    -7.560688368192
E1      =    18.235718074888
E2      =    -6.273405949340
E3      =    -9.832503336275
Exc     =    -8.630334117199
Esc     =   -39.775141087888
Entropy =    -0.000000000663
dE = 1.005e-06, dEband = 1.586e-04
rank = 0, Calculating/Estimating energy took 1.513 ms, Etot = -21.624536213, dEtot = 1.005e-06, dEband = 1.586e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0180284807943, which took 0.082 ms

iter_count = 102, r_2norm = 5.337e-07, tol*||rhs|| = 7.211e-07

Anderson update took 60.708 ms, out of which F'*F took 28.755 ms; b-Ax took 193.591 ms, out of which Lap took 172.909 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.869 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002213766, int_rho =  18.00000002213779, int_b + int_rho = 1.310e-13, checking this took 0.124 ms
2-norm of RHS = 683.9477789276885, which took 0.214 ms

iter_count = 132, r_2norm = 6.265e-04, tol*||rhs|| = 6.839e-04

Anderson update took 77.992 ms, out of which F'*F took 36.948 ms; b-Ax took 250.864 ms, out of which Lap took 223.311 ms
Solving Poisson took 554.328 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.091466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.646 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.075971 
Total time for convolution: 	 convolve: 5.083902 
Total time for convolution: 	 convolve: 5.090274 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.753 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.375 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.363 ms

This SCF took 26987.035 ms, scf error = 8.554e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.76593665653944, occ[   1] =   2.00000000000000
lambda[   2] =  -0.52650911173171, occ[   2] =   2.00000000000000
lambda[   3] =  -0.52648841270123, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43491404530030, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40801771213190, occ[   5] =   2.00000000000000
lambda[   6] =  -0.31051003992552, occ[   6] =   2.00000000000000
lambda[   7] =  -0.31047610586336, occ[   7] =   2.00000000000000
lambda[   8] =  -0.24874912380135, occ[   8] =   2.00000000000000
lambda[   9] =  -0.24874297594140, occ[   9] =   2.00000000000000
lambda[  10] =  -0.01445373601387, occ[  10] =   0.00000002213773
lambda[  11] =   0.01606202077685, occ[  11] =   0.00000000000000
lambda[  12] =   0.02173603052253, occ[  12] =   0.00000000000000
lambda[  13] =   0.02251818903561, occ[  13] =   0.00000000000000
lambda[  14] =   0.02868790986315, occ[  14] =   0.00000000000000
lambda[  15] =   0.04134756613118, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.537 ms, time for Allreduce/Reduce: 9.225 ms 
Time for calculating local force components: 19.062 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000003445407  -0.02814119190991  -0.04301180994349
 -0.02430901908698   0.01409357604781  -0.04304784115962
  0.02430915338878   0.01409364832970  -0.04304802407912
  0.00000001278191  -0.02814120669028   0.04301190527689
 -0.02430906159646   0.01409359905008   0.04304798737188
  0.02430920015116   0.01409365295944   0.04304814768165
 -0.00000115466485  -0.15228896452878   0.00000115213287
 -0.13193358644811   0.07606770933738   0.00000194878322
  0.13193461124500   0.07606894501625   0.00000141551041
force_loc = 
  0.00000049930707   0.03056734474260   0.04558815581707
  0.02642212626996  -0.01530176562043   0.04558108202832
 -0.02642218760213  -0.01530098293474   0.04557953281432
  0.00000011022856   0.03056704606759  -0.04558784715434
  0.02642256705379  -0.01530160089724  -0.04558098658191
 -0.02642154710371  -0.01530150932147  -0.04557959702317
  0.00000425170629   0.14467183964595  -0.00000170529088
  0.12541276540222  -0.07227142601974   0.00000081539217
 -0.12541685427532  -0.07227182555512   0.00000083841097
Time for calculating nonlocal force components: 32.719 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000028823421   0.00431603761086  -0.00000010054049
[0m[32m  0.00373161807202  -0.00215695438829   0.00000010680281
[0m[32m -0.00373174210591  -0.00215688192561   0.00000007677722
[0mTime for calculating XC forces components: 25.831 ms
 Cartesian force = 
  0.00000030204875   0.00242625405313   0.00257576220394
  0.00211287547058  -0.00120808835218   0.00253265719906
 -0.00211326592574  -0.00120723338460   0.00253092506555
 -0.00000010870192   0.00242594059775  -0.00257652554709
  0.00211327374493  -0.00120790062672  -0.00253358287967
 -0.00211257866495  -0.00120775514159  -0.00253203301117
  0.00000315356326  -0.00330098605153  -0.00000123736814
 -0.00278943468627   0.00163943014979   0.00000228730856
  0.00278578315137   0.00164033875596   0.00000174702896
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 377.608 ms
The program took 468.652 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:09
Job ID:        2266813
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:36:00,vmem=8300K,walltime=00:08:00,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-16-1
---------------------------------------
