---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:05
Job ID:    2266587
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:10
Job ID:    2266587
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 11.909 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 25.166 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 65.446 ms

Freeing SPARC_INPUT_MPI datatype took 0.015 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.963 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.087 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.768622	    6.383634	   10.000000	
    9.184586	   13.616366	   10.000000	
   13.231378	   10.870165	   10.000000	
    8.011019	    8.001634	   10.000000	
   11.310528	   10.183187	   10.000000	
   10.579245	    7.800520	   10.000000	
    7.119922	   10.337351	   10.000000	
    9.276139	   11.716178	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.009 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.183 ms
Set up communicators.

--set up spincomm took 3.845 ms

--set up kptcomm took 0.366 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.825 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 9.672 ms

Calculate_SplineDerivRadFun took 0.214 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.276 ms.
time spent on vectorized spline interp: 2.715 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.026 ms.
time spent on vectorized spline interp: 1.762 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.509 ms.
time spent on vectorized spline interp: 1.706 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.415 ms.

Calculating rb for all atom types took 16.421 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.902 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000232655, sum_int_rho = 25.6871008030441
PosCharge = 26.000000023266, NegCharge = -25.687100803044, scal_fac = 1.012181180843
After scaling, int_rho = 26.0000000232655, PosCharge + NegCharge - NetCharge = 4.619e-14
--Calculate Vref took 0.619 ms
--Calculate rho_guess took 3.536 ms

 integral of b = -26.0000000232655,
 int{b} + Nelectron + NetCharge = -2.327e-08,
 Esc = -74.7701015650724,
 MPI_Reduce took 9.752 ms

Calculating b & b_ref took 21.904 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.010 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.021 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.796 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326558, int_b + int_rho = 1.928e-13, checking this took 0.090 ms
2-norm of RHS = 701.7268676903832, which took 0.460 ms

iter_count = 420, r_2norm = 6.680e-04, tol*||rhs|| = 7.017e-04

Anderson update took 259.830 ms, out of which F'*F took 117.444 ms; b-Ax took 796.535 ms, out of which Lap took 709.487 ms
Solving Poisson took 1756.798 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.830 ms
Total time for convolution: 	 convolve: 5.122774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.305 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
Total time for convolution: 	 convolve: 5.163751 
Total time for convolution: 	 convolve: 5.125162 
Total time for convolution: 	 convolve: 5.114501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.092 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.444 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
rank = 0, XC calculation took 24424.445 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 2.182 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.140 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.444 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.151 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.807 ms
    Lanczos iter 53, eigmin  = -1.081966926, eigmax = 264.933949707, err_eigmin = 4.235e-04, err_eigmax = 9.625e-03
rank =   0, Lanczos took 132.404 ms, eigmin = -1.081966925648, eigmax = 267.583289204406

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.200661, lowerbound = -1.181967, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2008.604 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 23.536 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.220 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 27.797 ms
rank =  0, finding HY took 34.833 ms
rank =  0, distributing HY into block cyclic form took 22.085 ms
rank =  0, finding Y'*HY took 6.314 ms
Rank 0, Project_Hamiltonian used 91.067 ms
Total time for projection: 91.105 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.551 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.710 ms
rank = 0, Solve_Generalized_EigenProblem used 1.270 ms
    first calculated eigval = 2.698937058740879
    last  calculated eigval = 3.217190995674453
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.82210474001959
lambda[   5] =   2.86302199171998
lambda[   6] =   2.88461749753457
lambda[   7] =   2.92016765358664
lambda[   8] =   2.93526550297876
lambda[   9] =   2.95140006764551
lambda[  10] =   2.98941348376497
lambda[  11] =   3.00169318151145
lambda[  12] =   3.02449121701414
lambda[  13] =   3.06150941916804
lambda[  14] =   3.07036266781913
lambda[  15] =   3.10126988516211
lambda[  16] =   3.12396537845057
lambda[  17] =   3.14924392522614
lambda[  18] =   3.15530911829595
lambda[  19] =   3.17150021787147
lambda[  20] =   3.21719099567445
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.876 ms
rank =  0, subspace rotation using ScaLAPACK took 4.187 ms
rank =  0, Distributing orbital back into band + domain format took 23.669 ms
rank = 0, Subspace_Rotation used 27.882 ms

Total time for subspace rotation: 27.887 ms
rank = 0, Efermi =   3.065936043602 calculate fermi energy took 0.077 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.317191, lowerbound = -1.181967, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2007.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.164 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.071 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 25.272 ms
rank =  0, finding HY took 34.003 ms
rank =  0, distributing HY into block cyclic form took 21.054 ms
rank =  0, finding Y'*HY took 5.983 ms
Rank 0, Project_Hamiltonian used 86.343 ms
Total time for projection: 86.355 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.841901835496977
    last  calculated eigval = 0.442372588511594
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.40384783256493
lambda[   5] =  -0.31454442189972
lambda[   6] =  -0.23189343519875
lambda[   7] =  -0.16045246790931
lambda[   8] =  -0.04954866097802
lambda[   9] =  -0.00993269186671
lambda[  10] =   0.14034556890143
lambda[  11] =   0.21179546285770
lambda[  12] =   0.22661946607415
lambda[  13] =   0.26292809859370
lambda[  14] =   0.30054000766656
lambda[  15] =   0.35265064223854
lambda[  16] =   0.37299680162582
lambda[  17] =   0.39325094909564
lambda[  18] =   0.39529394438894
lambda[  19] =   0.41168936948799
lambda[  20] =   0.44237258851159
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 4.102 ms
rank =  0, Distributing orbital back into band + domain format took 23.760 ms
rank = 0, Subspace_Rotation used 27.878 ms

Total time for subspace rotation: 27.883 ms
rank = 0, Efermi =   0.281734105946 calculate fermi energy took 0.033 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542373, lowerbound = -1.181967, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2041.603 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.154 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.091 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 26.299 ms
rank =  0, finding HY took 33.205 ms
rank =  0, distributing HY into block cyclic form took 20.897 ms
rank =  0, finding Y'*HY took 6.079 ms
Rank 0, Project_Hamiltonian used 86.513 ms
Total time for projection: 86.518 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -1.083936486095402
    last  calculated eigval = 0.148926234954274
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.67593830262512
lambda[   5] =  -0.65800097581285
lambda[   6] =  -0.60594530818736
lambda[   7] =  -0.50955748273090
lambda[   8] =  -0.48186316454723
lambda[   9] =  -0.46413118675833
lambda[  10] =  -0.37494703169410
lambda[  11] =  -0.33563311236865
lambda[  12] =  -0.31695556377524
lambda[  13] =  -0.22270734520494
lambda[  14] =  -0.05211411557429
lambda[  15] =   0.07248580823024
lambda[  16] =   0.07993681207985
lambda[  17] =   0.10934233938592
lambda[  18] =   0.11673962772009
lambda[  19] =   0.13198736898003
lambda[  20] =   0.14892623495427
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 4.143 ms
rank =  0, Distributing orbital back into band + domain format took 23.745 ms
rank = 0, Subspace_Rotation used 27.905 ms

Total time for subspace rotation: 27.911 ms
rank = 0, Efermi =  -0.081144185028 calculate fermi energy took 0.033 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.248926, lowerbound = -1.181967, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2049.850 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 21.199 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.048 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.278 ms
rank =  0, finding HY took 34.083 ms
rank =  0, distributing HY into block cyclic form took 21.171 ms
rank =  0, finding Y'*HY took 5.811 ms
Rank 0, Project_Hamiltonian used 86.374 ms
Total time for projection: 86.378 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -1.084517246591832
    last  calculated eigval = 0.085821719905758
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.67904351730820
lambda[   5] =  -0.66075240729540
lambda[   6] =  -0.60843149261655
lambda[   7] =  -0.51502337338195
lambda[   8] =  -0.49034159718180
lambda[   9] =  -0.48295089314715
lambda[  10] =  -0.39583020823147
lambda[  11] =  -0.35610589748084
lambda[  12] =  -0.35425083215207
lambda[  13] =  -0.31570397894878
lambda[  14] =  -0.09715792748094
lambda[  15] =  -0.02898747483792
lambda[  16] =   0.03407073849928
lambda[  17] =   0.04818154882467
lambda[  18] =   0.06404526055600
lambda[  19] =   0.08250573601066
lambda[  20] =   0.08582171990576
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 4.049 ms
rank =  0, Distributing orbital back into band + domain format took 23.690 ms
rank = 0, Subspace_Rotation used 27.753 ms

Total time for subspace rotation: 27.759 ms
rank = 0, Efermi =  -0.126187996909 calculate fermi energy took 0.032 ms
rank = 0, --- Calculate rho: sum over local bands took 5.063 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.092 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.285 ms
rank = 0, Calculating density took 8715.830 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.858 ms
rank = 0, D2D took 1.524 ms
rank = 0, Transfering density took 1.534 ms
Etot    =   -45.005162316206
Eband   =   -15.449241113110
E1      =    30.842194316422
E2      =   -12.827057749514
E3      =   -15.521826390011
Exc     =   -13.976898093274
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 5.626e+00, dEband = 1.931e+00
rank = 0, Calculating/Estimating energy took 1.659 ms, Etot = -45.005162316, dEtot = 5.626e+00, dEband = 1.931e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 53.3005599321959, which took 0.052 ms

iter_count = 96, r_2norm = 1.626e-03, tol*||rhs|| = 2.132e-03

Anderson update took 56.809 ms, out of which F'*F took 25.980 ms; b-Ax took 179.690 ms, out of which Lap took 159.256 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.745 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326541, int_b + int_rho = 2.547e-14, checking this took 0.127 ms
2-norm of RHS = 697.5913710623186, which took 0.128 ms

iter_count = 288, r_2norm = 5.537e-04, tol*||rhs|| = 6.976e-04

Anderson update took 170.026 ms, out of which F'*F took 79.950 ms; b-Ax took 550.560 ms, out of which Lap took 490.342 ms
Solving Poisson took 1197.560 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.829 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.122784 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.802 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.136212 
Total time for convolution: 	 convolve: 5.094853 
Total time for convolution: 	 convolve: 5.123978 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.581 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.268 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.541 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.831 ms

This SCF took 34825.853 ms, scf error = 1.579e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.185822, lowerbound = -1.084517, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2016.866 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.580 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.318 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.361 ms
rank =  0, Distribute data + matrix mult took 26.275 ms
rank =  0, finding HY took 33.705 ms
rank =  0, distributing HY into block cyclic form took 21.226 ms
rank =  0, finding Y'*HY took 6.132 ms
Rank 0, Project_Hamiltonian used 87.369 ms
Total time for projection: 87.384 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.062152183194090
    last  calculated eigval = 0.065728697352750
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65306694675718
lambda[   5] =  -0.63678294910303
lambda[   6] =  -0.58475585254947
lambda[   7] =  -0.49168315718792
lambda[   8] =  -0.47193759978451
lambda[   9] =  -0.45546894551929
lambda[  10] =  -0.36322008435123
lambda[  11] =  -0.32899867423925
lambda[  12] =  -0.31647453833533
lambda[  13] =  -0.30189714566117
lambda[  14] =  -0.08780257931885
lambda[  15] =  -0.04503002488369
lambda[  16] =   0.00253307766527
lambda[  17] =   0.01905494586634
lambda[  18] =   0.03782237575670
lambda[  19] =   0.04701485240153
lambda[  20] =   0.06572869735275
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 4.812 ms
rank =  0, Distributing orbital back into band + domain format took 24.118 ms
rank = 0, Subspace_Rotation used 28.948 ms

Total time for subspace rotation: 28.954 ms
rank = 0, Efermi =  -0.116832648747 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.481 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.008 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.262 ms
rank = 0, Calculating density took 2143.662 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.073 ms
rank = 0, D2D took 1.184 ms
rank = 0, Transfering density took 1.191 ms
Etot    =   -44.965526089039
Eband   =   -14.782146760005
E1      =    30.248947119218
E2      =   -12.758579882614
E3      =   -15.696396668472
Exc     =   -14.117201433569
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 4.955e-03, dEband = 8.339e-02
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -44.965526089, dEtot = 4.955e-03, dEband = 8.339e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 25.0126938346593, which took 0.143 ms

iter_count = 102, r_2norm = 6.887e-04, tol*||rhs|| = 1.001e-03

Anderson update took 59.981 ms, out of which F'*F took 28.132 ms; b-Ax took 192.421 ms, out of which Lap took 170.682 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.983 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326556, int_b + int_rho = 1.746e-13, checking this took 0.129 ms
2-norm of RHS = 692.8735489620791, which took 0.194 ms

iter_count = 300, r_2norm = 5.647e-04, tol*||rhs|| = 6.929e-04

Anderson update took 177.761 ms, out of which F'*F took 83.201 ms; b-Ax took 562.584 ms, out of which Lap took 500.724 ms
Solving Poisson took 1241.229 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.090267 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.000 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.089878 
Total time for convolution: 	 convolve: 5.121130 
Total time for convolution: 	 convolve: 5.093923 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.976 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.153 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.277 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.615 ms

This SCF took 28243.340 ms, scf error = 1.073e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165729, lowerbound = -1.062152, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1835.379 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.398 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.260 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 25.681 ms
rank =  0, finding HY took 34.341 ms
rank =  0, distributing HY into block cyclic form took 22.246 ms
rank =  0, finding Y'*HY took 6.062 ms
Rank 0, Project_Hamiltonian used 88.365 ms
Total time for projection: 88.379 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.023135244061191
    last  calculated eigval = 0.056077558207457
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61245364884959
lambda[   5] =  -0.59359935838062
lambda[   6] =  -0.54307670859994
lambda[   7] =  -0.44990439492902
lambda[   8] =  -0.44060634512535
lambda[   9] =  -0.40901570864890
lambda[  10] =  -0.31361273942504
lambda[  11] =  -0.29224180009034
lambda[  12] =  -0.26768693770140
lambda[  13] =  -0.26374806670987
lambda[  14] =  -0.05608681238218
lambda[  15] =  -0.02117907740005
lambda[  16] =  -0.01412077591093
lambda[  17] =   0.00948762390668
lambda[  18] =   0.02881107378749
lambda[  19] =   0.03114030741583
lambda[  20] =   0.05607755820746
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 8.665 ms
rank =  0, Distributing orbital back into band + domain format took 20.308 ms
rank = 0, Subspace_Rotation used 28.995 ms

Total time for subspace rotation: 29.003 ms
rank = 0, Efermi =  -0.085116881855 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.486 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.985 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.184 ms
rank = 0, Calculating density took 1964.259 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.671 ms
rank = 0, D2D took 0.813 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -44.924883279008
Eband   =   -13.687379086594
E1      =    29.340452133547
E2      =   -12.553553604135
E3      =   -15.995317946295
Exc     =   -14.356726310624
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 5.080e-03, dEband = 1.368e-01
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -44.924883279, dEtot = 5.080e-03, dEband = 1.368e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.1764635819776, which took 0.070 ms

iter_count = 102, r_2norm = 2.941e-04, tol*||rhs|| = 3.271e-04

Anderson update took 60.363 ms, out of which F'*F took 28.728 ms; b-Ax took 193.499 ms, out of which Lap took 171.981 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.716 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326546, int_b + int_rho = 7.276e-14, checking this took 0.119 ms
2-norm of RHS = 692.8895263449418, which took 0.207 ms

iter_count = 276, r_2norm = 6.176e-04, tol*||rhs|| = 6.929e-04

Anderson update took 164.525 ms, out of which F'*F took 79.759 ms; b-Ax took 522.439 ms, out of which Lap took 465.847 ms
Solving Poisson took 1144.612 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.095551 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.097314 
Total time for convolution: 	 convolve: 5.094162 
Total time for convolution: 	 convolve: 5.127665 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.398 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.280 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.529 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.831 ms

This SCF took 27954.138 ms, scf error = 3.816e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.156078, lowerbound = -1.023135, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2023.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 24.539 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 10.887 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 35.480 ms
rank =  0, finding HY took 33.524 ms
rank =  0, distributing HY into block cyclic form took 21.099 ms
rank =  0, finding Y'*HY took 5.666 ms
Rank 0, Project_Hamiltonian used 95.802 ms
Total time for projection: 95.830 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.552 ms
rank = 0, Solve_Generalized_EigenProblem used 1.035 ms
    first calculated eigval = -1.010852419345748
    last  calculated eigval = 0.048983675327393
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59953804421329
lambda[   5] =  -0.57915957905572
lambda[   6] =  -0.52851574447352
lambda[   7] =  -0.43564823146355
lambda[   8] =  -0.43068822648139
lambda[   9] =  -0.39283871252609
lambda[  10] =  -0.29984947146252
lambda[  11] =  -0.28307768198934
lambda[  12] =  -0.25620249170430
lambda[  13] =  -0.25084801206674
lambda[  14] =  -0.04579951975221
lambda[  15] =  -0.02819356912718
lambda[  16] =  -0.00744562941333
lambda[  17] =   0.00676535209222
lambda[  18] =   0.02161520525387
lambda[  19] =   0.02794953509581
lambda[  20] =   0.04898367532739
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.051 ms
rank =  0, subspace rotation using ScaLAPACK took 8.286 ms
rank =  0, Distributing orbital back into band + domain format took 20.729 ms
rank = 0, Subspace_Rotation used 29.029 ms

Total time for subspace rotation: 29.034 ms
rank = 0, Efermi =  -0.074829589216 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.353 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.255 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.493 ms
rank = 0, Calculating density took 2159.385 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.142 ms
rank = 0, D2D took 1.276 ms
rank = 0, Transfering density took 1.282 ms
Etot    =   -44.919943731168
Eband   =   -13.350897374779
E1      =    29.106130294169
E2      =   -12.436016561299
E3      =   -16.087753115264
Exc     =   -14.428844761354
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 6.174e-04, dEband = 4.206e-02
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -44.919943731, dEtot = 6.174e-04, dEband = 4.206e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7307742816956, which took 0.069 ms

iter_count = 108, r_2norm = 9.321e-05, tol*||rhs|| = 1.092e-04

Anderson update took 64.780 ms, out of which F'*F took 30.112 ms; b-Ax took 203.675 ms, out of which Lap took 181.434 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.735 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326551, int_b + int_rho = 1.237e-13, checking this took 0.126 ms
2-norm of RHS = 694.0061061765273, which took 0.150 ms

iter_count = 270, r_2norm = 5.459e-04, tol*||rhs|| = 6.940e-04

Anderson update took 160.474 ms, out of which F'*F took 75.393 ms; b-Ax took 511.540 ms, out of which Lap took 455.544 ms
Solving Poisson took 1120.028 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.260684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.098980 
Total time for convolution: 	 convolve: 5.099607 
Total time for convolution: 	 convolve: 5.091154 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.175 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.303 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.234 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.569 ms

This SCF took 28348.765 ms, scf error = 1.839e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.148984, lowerbound = -1.010852, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.113 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.057 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.209 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.294 ms
rank =  0, finding HY took 32.565 ms
rank =  0, distributing HY into block cyclic form took 21.157 ms
rank =  0, finding Y'*HY took 5.563 ms
Rank 0, Project_Hamiltonian used 85.102 ms
Total time for projection: 85.117 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.005278193102262
    last  calculated eigval = 0.044479352607049
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59391552089180
lambda[   5] =  -0.57277810323630
lambda[   6] =  -0.52193391455134
lambda[   7] =  -0.42911948259043
lambda[   8] =  -0.42604608777235
lambda[   9] =  -0.38527710472762
lambda[  10] =  -0.29393058306464
lambda[  11] =  -0.27910854728632
lambda[  12] =  -0.25114649150285
lambda[  13] =  -0.24540015455454
lambda[  14] =  -0.04132667838453
lambda[  15] =  -0.03128667185991
lambda[  16] =  -0.00421235650879
lambda[  17] =   0.00582954497936
lambda[  18] =   0.01820818472717
lambda[  19] =   0.02601576355631
lambda[  20] =   0.04447935260705
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 8.338 ms
rank =  0, Distributing orbital back into band + domain format took 20.848 ms
rank = 0, Subspace_Rotation used 29.200 ms

Total time for subspace rotation: 29.205 ms
rank = 0, Efermi =  -0.070356749983 calculate fermi energy took 2.153 ms
rank = 0, --- Calculate rho: sum over local bands took 5.749 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.394 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 2116.328 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.039 ms
rank = 0, D2D took 1.199 ms
rank = 0, Transfering density took 1.205 ms
Etot    =   -44.918248180162
Eband   =   -13.202531964549
E1      =    29.045007986787
E2      =   -12.340331135603
E3      =   -16.122303138256
Exc     =   -14.453256910491
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 2.119e-04, dEband = 1.855e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -44.918248180, dEtot = 2.119e-04, dEband = 1.855e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8004176879826, which took 0.064 ms

iter_count = 114, r_2norm = 2.431e-05, tol*||rhs|| = 3.202e-05

Anderson update took 69.026 ms, out of which F'*F took 31.800 ms; b-Ax took 214.736 ms, out of which Lap took 191.306 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.170 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326552, int_b + int_rho = 1.382e-13, checking this took 0.118 ms
2-norm of RHS = 694.6022889954589, which took 0.116 ms

iter_count = 252, r_2norm = 6.262e-04, tol*||rhs|| = 6.946e-04

Anderson update took 150.094 ms, out of which F'*F took 71.161 ms; b-Ax took 479.934 ms, out of which Lap took 427.334 ms
Solving Poisson took 1053.831 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.194 ms
Total time for convolution: 	 convolve: 5.111571 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.555 ms
Total time for convolution: 	 convolve: 5.090301 
Total time for convolution: 	 convolve: 5.093947 
Total time for convolution: 	 convolve: 5.092652 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.641 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.614 ms

This SCF took 28026.295 ms, scf error = 7.381e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.144479, lowerbound = -1.005278, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1991.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 21.293 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.036 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.359 ms
rank =  0, finding HY took 32.485 ms
rank =  0, distributing HY into block cyclic form took 21.011 ms
rank =  0, finding Y'*HY took 5.582 ms
Rank 0, Project_Hamiltonian used 84.480 ms
Total time for projection: 84.494 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.002059568673685
    last  calculated eigval = 0.041312249981075
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59113438240210
lambda[   5] =  -0.56970048985674
lambda[   6] =  -0.51903887529649
lambda[   7] =  -0.42612043790696
lambda[   8] =  -0.42319544233539
lambda[   9] =  -0.38191097164624
lambda[  10] =  -0.29004760415295
lambda[  11] =  -0.27561903800798
lambda[  12] =  -0.24857662652705
lambda[  13] =  -0.24090334326364
lambda[  14] =  -0.03902233929539
lambda[  15] =  -0.03280018791737
lambda[  16] =  -0.00194761382640
lambda[  17] =   0.00535723406480
lambda[  18] =   0.01681438709907
lambda[  19] =   0.02452740110543
lambda[  20] =   0.04131224998107
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 8.260 ms
rank =  0, Distributing orbital back into band + domain format took 20.849 ms
rank = 0, Subspace_Rotation used 29.128 ms

Total time for subspace rotation: 29.133 ms
rank = 0, Efermi =  -0.068052865464 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.951 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.343 ms
rank = 0, Calculating density took 2115.229 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.023 ms
rank = 0, D2D took 1.189 ms
rank = 0, Transfering density took 1.192 ms
Etot    =   -44.917640463132
Eband   =   -13.118349223988
E1      =    29.016927193089
E2      =   -12.279920290187
E3      =   -16.135915474512
Exc     =   -14.461952631165
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 7.596e-05, dEband = 1.052e-02
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -44.917640463, dEtot = 7.596e-05, dEband = 1.052e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5102999784719, which took 0.072 ms

iter_count = 114, r_2norm = 1.315e-05, tol*||rhs|| = 2.041e-05

Anderson update took 68.058 ms, out of which F'*F took 31.284 ms; b-Ax took 213.245 ms, out of which Lap took 189.895 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.441 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326550, int_b + int_rho = 1.164e-13, checking this took 0.126 ms
2-norm of RHS = 694.8257748445700, which took 0.164 ms

iter_count = 252, r_2norm = 5.675e-04, tol*||rhs|| = 6.948e-04

Anderson update took 151.378 ms, out of which F'*F took 67.940 ms; b-Ax took 469.669 ms, out of which Lap took 416.717 ms
Solving Poisson took 1053.829 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.166994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.106677 
Total time for convolution: 	 convolve: 5.115340 
Total time for convolution: 	 convolve: 5.094488 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.597 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.015 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.242 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.498 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.071 ms

This SCF took 28345.403 ms, scf error = 3.619e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.141312, lowerbound = -1.002060, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.676 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.171 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.407 ms
rank =  0, finding HY took 32.703 ms
rank =  0, distributing HY into block cyclic form took 20.838 ms
rank =  0, finding Y'*HY took 5.761 ms
Rank 0, Project_Hamiltonian used 84.745 ms
Total time for projection: 84.758 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.998409487414267
    last  calculated eigval = 0.039268600846994
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58811056362980
lambda[   5] =  -0.56617708596777
lambda[   6] =  -0.51585840323394
lambda[   7] =  -0.42302145820628
lambda[   8] =  -0.41975516435464
lambda[   9] =  -0.37854488795699
lambda[  10] =  -0.28618917761180
lambda[  11] =  -0.27196875684481
lambda[  12] =  -0.24511069461184
lambda[  13] =  -0.23676663295774
lambda[  14] =  -0.03594340090413
lambda[  15] =  -0.03349285598298
lambda[  16] =   0.00092968610977
lambda[  17] =   0.00587751380667
lambda[  18] =   0.01725239125782
lambda[  19] =   0.02413715325880
lambda[  20] =   0.03926860084699
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 8.901 ms
rank =  0, Distributing orbital back into band + domain format took 20.647 ms
rank = 0, Subspace_Rotation used 29.567 ms

Total time for subspace rotation: 29.572 ms
rank = 0, Efermi =  -0.065025389533 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.598 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.745 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.297 ms
rank = 0, Calculating density took 2155.998 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.063 ms
rank = 0, D2D took 1.170 ms
rank = 0, Transfering density took 1.172 ms
Etot    =   -44.917392523114
Eband   =   -13.027213989695
E1      =    28.976966151789
E2      =   -12.225921205247
E3      =   -16.144726169650
Exc     =   -14.467690494333
Esc     =   -74.770101565072
Entropy =    -0.000000000700
dE = 3.099e-05, dEband = 1.139e-02
rank = 0, Calculating/Estimating energy took 1.072 ms, Etot = -44.917392523, dEtot = 3.099e-05, dEband = 1.139e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3292151976427, which took 0.070 ms

iter_count = 114, r_2norm = 8.423e-06, tol*||rhs|| = 1.317e-05

Anderson update took 67.188 ms, out of which F'*F took 31.082 ms; b-Ax took 213.317 ms, out of which Lap took 188.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.150 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326547, int_b + int_rho = 8.004e-14, checking this took 0.078 ms
2-norm of RHS = 694.7750379683152, which took 0.114 ms

iter_count = 234, r_2norm = 5.636e-04, tol*||rhs|| = 6.948e-04

Anderson update took 137.767 ms, out of which F'*F took 64.494 ms; b-Ax took 438.015 ms, out of which Lap took 390.553 ms
Solving Poisson took 972.475 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.094847 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.145314 
Total time for convolution: 	 convolve: 5.111708 
Total time for convolution: 	 convolve: 5.094784 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.988 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
---Transfer Veff_loc: D2D took 1.738 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.931 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.701 ms

This SCF took 28213.557 ms, scf error = 1.948e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.139269, lowerbound = -0.998409, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2021.669 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.156 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.182 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.364 ms
rank =  0, finding HY took 32.693 ms
rank =  0, distributing HY into block cyclic form took 20.977 ms
rank =  0, finding Y'*HY took 6.006 ms
Rank 0, Project_Hamiltonian used 85.071 ms
Total time for projection: 85.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.995876427077426
    last  calculated eigval = 0.037842015657674
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58590290551769
lambda[   5] =  -0.56362250883267
lambda[   6] =  -0.51347158522859
lambda[   7] =  -0.42066795819888
lambda[   8] =  -0.41741599158330
lambda[   9] =  -0.37603449169134
lambda[  10] =  -0.28329603785966
lambda[  11] =  -0.26949870434319
lambda[  12] =  -0.24261841856801
lambda[  13] =  -0.23378684914233
lambda[  14] =  -0.03367051906364
lambda[  15] =  -0.03329262020922
lambda[  16] =   0.00316118561315
lambda[  17] =   0.00694929868935
lambda[  18] =   0.01799244884994
lambda[  19] =   0.02437786918108
lambda[  20] =   0.03784201565767
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 8.271 ms
rank =  0, Distributing orbital back into band + domain format took 20.861 ms
rank = 0, Subspace_Rotation used 29.155 ms

Total time for subspace rotation: 29.160 ms
rank = 0, Efermi =  -0.063150828799 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.380 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.027 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.330 ms
rank = 0, Calculating density took 2145.970 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.009 ms
rank = 0, D2D took 1.188 ms
rank = 0, Transfering density took 1.190 ms
Etot    =   -44.917374533596
Eband   =   -12.961354214765
E1      =    28.939474330730
E2      =   -12.195448860240
E3      =   -16.153449759236
Exc     =   -14.474291703254
Esc     =   -74.770101565072
Entropy =    -0.000000000709
dE = 2.249e-06, dEband = 8.232e-03
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -44.917374534, dEtot = 2.249e-06, dEband = 8.232e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1940911010891, which took 0.062 ms

iter_count = 114, r_2norm = 5.971e-06, tol*||rhs|| = 7.764e-06

Anderson update took 68.950 ms, out of which F'*F took 31.634 ms; b-Ax took 213.818 ms, out of which Lap took 189.456 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.397 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326554, int_b + int_rho = 1.528e-13, checking this took 0.138 ms
2-norm of RHS = 694.7854945722804, which took 0.102 ms

iter_count = 216, r_2norm = 6.742e-04, tol*||rhs|| = 6.948e-04

Anderson update took 125.888 ms, out of which F'*F took 60.746 ms; b-Ax took 405.940 ms, out of which Lap took 361.597 ms
Solving Poisson took 898.411 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.122544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.097636 
Total time for convolution: 	 convolve: 5.142479 
Total time for convolution: 	 convolve: 5.095481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
---Transfer Veff_loc: D2D took 1.743 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.938 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.715 ms

This SCF took 27983.334 ms, scf error = 1.324e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.137842, lowerbound = -0.995876, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2002.569 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.202 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.170 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.401 ms
rank =  0, finding HY took 32.717 ms
rank =  0, distributing HY into block cyclic form took 21.787 ms
rank =  0, finding Y'*HY took 4.950 ms
Rank 0, Project_Hamiltonian used 84.892 ms
Total time for projection: 84.905 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.994917737907263
    last  calculated eigval = 0.037227251177165
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58506300944967
lambda[   5] =  -0.56267754189922
lambda[   6] =  -0.51256159472537
lambda[   7] =  -0.41976683001116
lambda[   8] =  -0.41643165779720
lambda[   9] =  -0.37506935172107
lambda[  10] =  -0.28230684826052
lambda[  11] =  -0.26853301985718
lambda[  12] =  -0.24159543606601
lambda[  13] =  -0.23282144828841
lambda[  14] =  -0.03266691325969
lambda[  15] =  -0.03206858402120
lambda[  16] =   0.00440400589694
lambda[  17] =   0.00861434063545
lambda[  18] =   0.01907386987614
lambda[  19] =   0.02536630905819
lambda[  20] =   0.03722725117716
==subpsace eigenproblem: bcast eigvals took 0.071 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.247 ms
rank =  0, Distributing orbital back into band + domain format took 20.827 ms
rank = 0, Subspace_Rotation used 29.090 ms

Total time for subspace rotation: 29.103 ms
rank = 0, Efermi =  -0.062065847014 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.399 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.818 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.434 ms
rank = 0, Calculating density took 2126.611 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.029 ms
rank = 0, D2D took 2.041 ms
rank = 0, Transfering density took 2.046 ms
Etot    =   -44.917448710178
Eband   =   -12.936782568464
E1      =    28.929634656667
E2      =   -12.180611079560
E3      =   -16.153369774714
Exc     =   -14.474180086873
Esc     =   -74.770101565072
Entropy =    -0.000000000709
dE = 9.272e-06, dEband = 3.071e-03
rank = 0, Calculating/Estimating energy took 0.960 ms, Etot = -44.917448710, dEtot = 9.272e-06, dEband = 3.071e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1199281711451, which took 0.057 ms

iter_count = 114, r_2norm = 3.047e-06, tol*||rhs|| = 4.797e-06

Anderson update took 67.766 ms, out of which F'*F took 31.350 ms; b-Ax took 212.274 ms, out of which Lap took 187.838 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.049 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326556, int_b + int_rho = 1.710e-13, checking this took 0.107 ms
2-norm of RHS = 694.7621564923098, which took 0.168 ms

iter_count = 216, r_2norm = 6.641e-04, tol*||rhs|| = 6.948e-04

Anderson update took 128.650 ms, out of which F'*F took 70.397 ms; b-Ax took 437.845 ms, out of which Lap took 393.916 ms
Solving Poisson took 926.628 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.094827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.097376 
Total time for convolution: 	 convolve: 5.095565 
Total time for convolution: 	 convolve: 5.117895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.898 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.626 ms

This SCF took 27966.608 ms, scf error = 8.617e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137227, lowerbound = -0.994918, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2030.404 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.273 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.125 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.424 ms
rank =  0, finding HY took 32.760 ms
rank =  0, distributing HY into block cyclic form took 20.995 ms
rank =  0, finding Y'*HY took 5.626 ms
Rank 0, Project_Hamiltonian used 84.835 ms
Total time for projection: 84.849 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.993671484440092
    last  calculated eigval = 0.037704208689615
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58386349031696
lambda[   5] =  -0.56138944967454
lambda[   6] =  -0.51133384252574
lambda[   7] =  -0.41853349054400
lambda[   8] =  -0.41517637953463
lambda[   9] =  -0.37371370167366
lambda[  10] =  -0.28105649723730
lambda[  11] =  -0.26723342926097
lambda[  12] =  -0.24033153598969
lambda[  13] =  -0.23154366416073
lambda[  14] =  -0.03136260202407
lambda[  15] =  -0.02840943258498
lambda[  16] =   0.00627287211223
lambda[  17] =   0.01271293680973
lambda[  18] =   0.02217290147540
lambda[  19] =   0.02888460540897
lambda[  20] =   0.03770420868961
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 8.247 ms
rank =  0, Distributing orbital back into band + domain format took 20.753 ms
rank = 0, Subspace_Rotation used 29.013 ms

Total time for subspace rotation: 29.026 ms
rank = 0, Efermi =  -0.060421430518 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.513 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.962 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.025 ms
rank = 0, Calculating density took 2155.571 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.688 ms
rank = 0, D2D took 0.805 ms
rank = 0, Transfering density took 0.810 ms
Etot    =   -44.917538749218
Eband   =   -12.903988628928
E1      =    28.913530248684
E2      =   -12.163594125720
E3      =   -16.154931287993
Exc     =   -14.475504216915
Esc     =   -74.770101565072
Entropy =    -0.000000000699
dE = 1.125e-05, dEband = 4.099e-03
rank = 0, Calculating/Estimating energy took 0.977 ms, Etot = -44.917538749, dEtot = 1.125e-05, dEband = 4.099e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0898792360827, which took 0.097 ms

iter_count = 114, r_2norm = 2.467e-06, tol*||rhs|| = 3.595e-06

Anderson update took 67.402 ms, out of which F'*F took 31.471 ms; b-Ax took 213.443 ms, out of which Lap took 188.917 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.886 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326563, int_b + int_rho = 2.474e-13, checking this took 0.121 ms
2-norm of RHS = 694.7571678291565, which took 0.098 ms

iter_count = 180, r_2norm = 6.320e-04, tol*||rhs|| = 6.948e-04

Anderson update took 106.339 ms, out of which F'*F took 48.930 ms; b-Ax took 336.458 ms, out of which Lap took 299.829 ms
Solving Poisson took 748.094 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.115596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.100296 
Total time for convolution: 	 convolve: 5.095021 
Total time for convolution: 	 convolve: 5.096688 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.152 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.898 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.644 ms

This SCF took 27863.312 ms, scf error = 5.240e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137704, lowerbound = -0.993671, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.550 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.109 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.165 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.302 ms
rank =  0, finding HY took 32.598 ms
rank =  0, distributing HY into block cyclic form took 21.488 ms
rank =  0, finding Y'*HY took 7.123 ms
Rank 0, Project_Hamiltonian used 86.555 ms
Total time for projection: 86.570 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.993139375103327
    last  calculated eigval = 0.036714279076770
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58337744595248
lambda[   5] =  -0.56085819275301
lambda[   6] =  -0.51085402446384
lambda[   7] =  -0.41804108050862
lambda[   8] =  -0.41466715949072
lambda[   9] =  -0.37320198614862
lambda[  10] =  -0.28052470146237
lambda[  11] =  -0.26670254248448
lambda[  12] =  -0.23981773825999
lambda[  13] =  -0.23100359698858
lambda[  14] =  -0.03089604115951
lambda[  15] =  -0.02714301238512
lambda[  16] =   0.00659509405724
lambda[  17] =   0.01312379835949
lambda[  18] =   0.02255008208082
lambda[  19] =   0.02896252496661
lambda[  20] =   0.03671427907677
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 25.218 ms
rank =  0, Distributing orbital back into band + domain format took 13.459 ms
rank = 0, Subspace_Rotation used 38.702 ms

Total time for subspace rotation: 38.710 ms
rank = 0, Efermi =  -0.059937004794 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.297 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.441 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 2167.753 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.719 ms
rank = 0, D2D took 0.828 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -44.917653851529
Eband   =   -12.890533632422
E1      =    28.906059861867
E2      =   -12.157285536924
E3      =   -16.156093610893
Exc     =   -14.476457663022
Esc     =   -74.770101565072
Entropy =    -0.000000000697
dE = 1.439e-05, dEband = 1.682e-03
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -44.917653852, dEtot = 1.439e-05, dEband = 1.682e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0723143632153, which took 0.064 ms

iter_count = 108, r_2norm = 2.564e-06, tol*||rhs|| = 2.893e-06

Anderson update took 63.818 ms, out of which F'*F took 29.547 ms; b-Ax took 201.599 ms, out of which Lap took 178.045 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.007 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326551, int_b + int_rho = 1.273e-13, checking this took 0.121 ms
2-norm of RHS = 694.7897137188012, which took 0.192 ms

iter_count = 186, r_2norm = 6.788e-04, tol*||rhs|| = 6.948e-04

Anderson update took 109.681 ms, out of which F'*F took 51.390 ms; b-Ax took 348.021 ms, out of which Lap took 310.032 ms
Solving Poisson took 774.372 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.093564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.100435 
Total time for convolution: 	 convolve: 5.100873 
Total time for convolution: 	 convolve: 5.107004 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.422 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.636 ms

This SCF took 27791.678 ms, scf error = 3.910e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136714, lowerbound = -0.993139, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2023.026 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.174 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.446 ms
rank =  0, finding HY took 32.653 ms
rank =  0, distributing HY into block cyclic form took 20.975 ms
rank =  0, finding Y'*HY took 5.619 ms
Rank 0, Project_Hamiltonian used 84.727 ms
Total time for projection: 84.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.992619516423630
    last  calculated eigval = 0.037678739489768
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58287527393467
lambda[   5] =  -0.56032271596139
lambda[   6] =  -0.51034691624030
lambda[   7] =  -0.41752699377517
lambda[   8] =  -0.41413065549231
lambda[   9] =  -0.37266499985682
lambda[  10] =  -0.28005613153311
lambda[  11] =  -0.26619898655711
lambda[  12] =  -0.23927451526245
lambda[  13] =  -0.23057038599247
lambda[  14] =  -0.03036738218054
lambda[  15] =  -0.02256773912622
lambda[  16] =   0.00717982656322
lambda[  17] =   0.01588385548262
lambda[  18] =   0.02635632508116
lambda[  19] =   0.03225382954142
lambda[  20] =   0.03767873948977
==subpsace eigenproblem: bcast eigvals took 0.071 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 8.423 ms
rank =  0, Distributing orbital back into band + domain format took 16.791 ms
rank = 0, Subspace_Rotation used 25.234 ms

Total time for subspace rotation: 25.243 ms
rank = 0, Efermi =  -0.059397505029 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.862 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.158 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.181 ms
rank = 0, Calculating density took 2142.205 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 20.100 ms
rank = 0, Transfering density took 20.111 ms
Etot    =   -44.917753543044
Eband   =   -12.877337328401
E1      =    28.900523535650
E2      =   -12.149501031906
E3      =   -16.156358958677
Exc     =   -14.476698175108
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 1.246e-05, dEband = 1.650e-03
rank = 0, Calculating/Estimating energy took 1.456 ms, Etot = -44.917753543, dEtot = 1.246e-05, dEband = 1.650e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0616964504708, which took 0.059 ms

iter_count = 108, r_2norm = 2.335e-06, tol*||rhs|| = 2.468e-06

Anderson update took 63.570 ms, out of which F'*F took 29.612 ms; b-Ax took 201.777 ms, out of which Lap took 178.452 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.646 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326550, int_b + int_rho = 1.128e-13, checking this took 0.118 ms
2-norm of RHS = 694.7875123088181, which took 0.129 ms

iter_count = 138, r_2norm = 5.582e-04, tol*||rhs|| = 6.948e-04

Anderson update took 80.776 ms, out of which F'*F took 37.844 ms; b-Ax took 257.430 ms, out of which Lap took 229.309 ms
Solving Poisson took 573.912 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.116650 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
Total time for convolution: 	 convolve: 5.095082 
Total time for convolution: 	 convolve: 5.115466 
Total time for convolution: 	 convolve: 5.092608 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.093 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
---Transfer Veff_loc: D2D took 1.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.887 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.590 ms

This SCF took 27578.404 ms, scf error = 2.683e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.137679, lowerbound = -0.992620, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2011.885 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.283 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.570 ms
rank =  0, finding HY took 32.554 ms
rank =  0, distributing HY into block cyclic form took 20.974 ms
rank =  0, finding Y'*HY took 5.651 ms
Rank 0, Project_Hamiltonian used 84.780 ms
Total time for projection: 84.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.992443883462931
    last  calculated eigval = 0.037365146594243
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58271539055129
lambda[   5] =  -0.56015778590594
lambda[   6] =  -0.51018359541535
lambda[   7] =  -0.41736912341783
lambda[   8] =  -0.41396684679374
lambda[   9] =  -0.37250804558688
lambda[  10] =  -0.27988340245188
lambda[  11] =  -0.26602950796750
lambda[  12] =  -0.23911442791860
lambda[  13] =  -0.23039320540980
lambda[  14] =  -0.03021577737691
lambda[  15] =  -0.02176331034061
lambda[  16] =   0.00729667369579
lambda[  17] =   0.01567317543141
lambda[  18] =   0.02691209891723
lambda[  19] =   0.03283614913158
lambda[  20] =   0.03736514659424
==subpsace eigenproblem: bcast eigvals took 0.073 ms
Total time for solving subspace eigenvalue problem: 0.898 ms
rank =  0, subspace rotation using ScaLAPACK took 8.264 ms
rank =  0, Distributing orbital back into band + domain format took 21.253 ms
rank = 0, Subspace_Rotation used 29.536 ms

Total time for subspace rotation: 29.544 ms
rank = 0, Efermi =  -0.059245868241 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.454 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.932 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.272 ms
rank = 0, Calculating density took 2136.906 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.061 ms
rank = 0, D2D took 1.168 ms
rank = 0, Transfering density took 1.174 ms
Etot    =   -44.917773095481
Eband   =   -12.872991543004
E1      =    28.898079346008
E2      =   -12.147482544274
E3      =   -16.156815167237
Exc     =   -14.477057044228
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 2.444e-06, dEband = 5.432e-04
rank = 0, Calculating/Estimating energy took 0.954 ms, Etot = -44.917773095, dEtot = 2.444e-06, dEband = 5.432e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348877316693, which took 0.086 ms

iter_count = 114, r_2norm = 9.533e-07, tol*||rhs|| = 1.396e-06

Anderson update took 67.283 ms, out of which F'*F took 31.256 ms; b-Ax took 212.633 ms, out of which Lap took 187.897 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.075 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326539, int_b + int_rho = 7.276e-15, checking this took 0.115 ms
2-norm of RHS = 694.7943921733602, which took 0.143 ms

iter_count = 162, r_2norm = 5.945e-04, tol*||rhs|| = 6.948e-04

Anderson update took 95.450 ms, out of which F'*F took 45.542 ms; b-Ax took 303.957 ms, out of which Lap took 271.270 ms
Solving Poisson took 675.507 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.099418 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.597 ms
Total time for convolution: 	 convolve: 5.105059 
Total time for convolution: 	 convolve: 5.130407 
Total time for convolution: 	 convolve: 5.097980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.428 ms
---Transfer Veff_loc: D2D took 1.733 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.906 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.671 ms

This SCF took 27716.061 ms, scf error = 2.198e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137365, lowerbound = -0.992444, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2019.362 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.234 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.124 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.387 ms
rank =  0, finding HY took 32.667 ms
rank =  0, distributing HY into block cyclic form took 21.074 ms
rank =  0, finding Y'*HY took 4.724 ms
Rank 0, Project_Hamiltonian used 84.822 ms
Total time for projection: 84.836 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.992195778352886
    last  calculated eigval = 0.037123549841676
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58246831127107
lambda[   5] =  -0.55992075307829
lambda[   6] =  -0.50993304254833
lambda[   7] =  -0.41713385266336
lambda[   8] =  -0.41371998695272
lambda[   9] =  -0.37227529234024
lambda[  10] =  -0.27966169646637
lambda[  11] =  -0.26578957192533
lambda[  12] =  -0.23888451773196
lambda[  13] =  -0.23017637872061
lambda[  14] =  -0.03001642570858
lambda[  15] =  -0.02159749117786
lambda[  16] =   0.00739781245304
lambda[  17] =   0.01393000003507
lambda[  18] =   0.02737921503044
lambda[  19] =   0.03366310547898
lambda[  20] =   0.03712354984168
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 8.212 ms
rank =  0, Distributing orbital back into band + domain format took 20.759 ms
rank = 0, Subspace_Rotation used 28.985 ms

Total time for subspace rotation: 28.991 ms
rank = 0, Efermi =  -0.059046517602 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.344 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.058 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.351 ms
rank = 0, Calculating density took 2143.261 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.997 ms
rank = 0, D2D took 1.168 ms
rank = 0, Transfering density took 1.176 ms
Etot    =   -44.917828088695
Eband   =   -12.866803142156
E1      =    28.895279594230
E2      =   -12.143973790570
E3      =   -16.157047108819
Exc     =   -14.477223874391
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 6.874e-06, dEband = 7.736e-04
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -44.917828089, dEtot = 6.874e-06, dEband = 7.736e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0320845891083, which took 0.061 ms

iter_count = 114, r_2norm = 8.504e-07, tol*||rhs|| = 1.283e-06

Anderson update took 66.973 ms, out of which F'*F took 31.798 ms; b-Ax took 213.814 ms, out of which Lap took 189.358 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 481.852 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326542, int_b + int_rho = 3.274e-14, checking this took 0.124 ms
2-norm of RHS = 694.7918660111326, which took 0.124 ms

iter_count = 132, r_2norm = 6.293e-04, tol*||rhs|| = 6.948e-04

Anderson update took 77.410 ms, out of which F'*F took 47.655 ms; b-Ax took 257.028 ms, out of which Lap took 230.253 ms
Solving Poisson took 559.043 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.090990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.113549 
Total time for convolution: 	 convolve: 5.103903 
Total time for convolution: 	 convolve: 5.105220 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.016 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.444 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.211 ms

This SCF took 27587.058 ms, scf error = 1.822e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137124, lowerbound = -0.992196, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2022.805 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.185 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.849 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 26.067 ms
rank =  0, finding HY took 32.518 ms
rank =  0, distributing HY into block cyclic form took 21.018 ms
rank =  0, finding Y'*HY took 5.600 ms
Rank 0, Project_Hamiltonian used 85.237 ms
Total time for projection: 85.248 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.992064603463479
    last  calculated eigval = 0.037262385534087
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58234426910722
lambda[   5] =  -0.55979558503973
lambda[   6] =  -0.50981195745771
lambda[   7] =  -0.41701329657116
lambda[   8] =  -0.41359390254295
lambda[   9] =  -0.37215772003154
lambda[  10] =  -0.27954093474727
lambda[  11] =  -0.26566505760170
lambda[  12] =  -0.23876122338436
lambda[  13] =  -0.23005779269967
lambda[  14] =  -0.02990931122081
lambda[  15] =  -0.02123414446911
lambda[  16] =   0.00746490720592
lambda[  17] =   0.01369667163774
lambda[  18] =   0.02751964238809
lambda[  19] =   0.03456193097613
lambda[  20] =   0.03726238553409
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 8.216 ms
rank =  0, Distributing orbital back into band + domain format took 20.669 ms
rank = 0, Subspace_Rotation used 28.900 ms

Total time for subspace rotation: 28.905 ms
rank = 0, Efermi =  -0.058939396264 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.437 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.882 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.354 ms
rank = 0, Calculating density took 2147.019 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.016 ms
rank = 0, D2D took 1.183 ms
rank = 0, Transfering density took 1.186 ms
Etot    =   -44.917844652178
Eband   =   -12.863576012408
E1      =    28.893547031423
E2      =   -12.142419175613
E3      =   -16.157252030280
Exc     =   -14.477385311317
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 2.070e-06, dEband = 4.034e-04
rank = 0, Calculating/Estimating energy took 1.017 ms, Etot = -44.917844652, dEtot = 2.070e-06, dEband = 4.034e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0325026842884, which took 0.066 ms

iter_count = 108, r_2norm = 1.103e-06, tol*||rhs|| = 1.300e-06

Anderson update took 63.239 ms, out of which F'*F took 29.477 ms; b-Ax took 204.967 ms, out of which Lap took 181.262 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.641 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326556, int_b + int_rho = 1.710e-13, checking this took 0.122 ms
2-norm of RHS = 694.7903562675422, which took 0.172 ms

iter_count = 138, r_2norm = 6.248e-04, tol*||rhs|| = 6.948e-04

Anderson update took 81.694 ms, out of which F'*F took 38.061 ms; b-Ax took 258.385 ms, out of which Lap took 230.658 ms
Solving Poisson took 575.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.101631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.089941 
Total time for convolution: 	 convolve: 5.114597 
Total time for convolution: 	 convolve: 5.125426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.894 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.420 ms

This SCF took 27578.574 ms, scf error = 1.469e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137262, lowerbound = -0.992065, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2024.631 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.228 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.145 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.400 ms
rank =  0, finding HY took 32.525 ms
rank =  0, distributing HY into block cyclic form took 21.001 ms
rank =  0, finding Y'*HY took 5.648 ms
Rank 0, Project_Hamiltonian used 84.604 ms
Total time for projection: 84.617 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.991981900281233
    last  calculated eigval = 0.037801151313274
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58225224505569
lambda[   5] =  -0.55970444273079
lambda[   6] =  -0.50972176637775
lambda[   7] =  -0.41692033725859
lambda[   8] =  -0.41350407154547
lambda[   9] =  -0.37206411208786
lambda[  10] =  -0.27945857112440
lambda[  11] =  -0.26558102768227
lambda[  12] =  -0.23866882253191
lambda[  13] =  -0.22998367103058
lambda[  14] =  -0.02983288633942
lambda[  15] =  -0.02069410002281
lambda[  16] =   0.00751340547193
lambda[  17] =   0.01386512293992
lambda[  18] =   0.02775621839704
lambda[  19] =   0.03572359755511
lambda[  20] =   0.03780115131327
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 8.354 ms
rank =  0, Distributing orbital back into band + domain format took 20.895 ms
rank = 0, Subspace_Rotation used 29.267 ms

Total time for subspace rotation: 29.274 ms
rank = 0, Efermi =  -0.058862963796 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.625 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.483 ms
rank = 0, Calculating density took 2148.780 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.111 ms
rank = 0, D2D took 1.234 ms
rank = 0, Transfering density took 1.241 ms
Etot    =   -44.917855341772
Eband   =   -12.861298169604
E1      =    28.892516758299
E2      =   -12.141176485312
E3      =   -16.157205751967
Exc     =   -14.477354601978
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 1.336e-06, dEband = 2.847e-04
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -44.917855342, dEtot = 1.336e-06, dEband = 2.847e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0317310759447, which took 0.073 ms

iter_count = 108, r_2norm = 1.119e-06, tol*||rhs|| = 1.269e-06

Anderson update took 63.145 ms, out of which F'*F took 29.909 ms; b-Ax took 202.471 ms, out of which Lap took 179.288 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.330 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326540, int_b + int_rho = 1.819e-14, checking this took 0.119 ms
2-norm of RHS = 694.7900196226100, which took 0.073 ms

iter_count = 72, r_2norm = 6.676e-04, tol*||rhs|| = 6.948e-04

Anderson update took 43.337 ms, out of which F'*F took 19.683 ms; b-Ax took 134.325 ms, out of which Lap took 119.881 ms
Solving Poisson took 302.152 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.090435 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.094297 
Total time for convolution: 	 convolve: 5.090517 
Total time for convolution: 	 convolve: 5.095834 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.575 ms
---Transfer Veff_loc: D2D took 4.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.892 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.409 ms

This SCF took 27390.763 ms, scf error = 1.422e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137801, lowerbound = -0.991982, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2051.821 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.371 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.031 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.429 ms
rank =  0, finding HY took 32.693 ms
rank =  0, distributing HY into block cyclic form took 20.969 ms
rank =  0, finding Y'*HY took 6.907 ms
Rank 0, Project_Hamiltonian used 86.033 ms
Total time for projection: 86.054 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.991972540925694
    last  calculated eigval = 0.037842895100733
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58224190168031
lambda[   5] =  -0.55969262095584
lambda[   6] =  -0.50971190567808
lambda[   7] =  -0.41690922431167
lambda[   8] =  -0.41349355424106
lambda[   9] =  -0.37205192407554
lambda[  10] =  -0.27944625733665
lambda[  11] =  -0.26556983381514
lambda[  12] =  -0.23865729373510
lambda[  13] =  -0.22997153055213
lambda[  14] =  -0.02982247114726
lambda[  15] =  -0.02046477494743
lambda[  16] =   0.00751661018500
lambda[  17] =   0.01383350276754
lambda[  18] =   0.02771470801549
lambda[  19] =   0.03595067146802
lambda[  20] =   0.03784289510073
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 8.239 ms
rank =  0, Distributing orbital back into band + domain format took 20.732 ms
rank = 0, Subspace_Rotation used 28.984 ms

Total time for subspace rotation: 28.988 ms
rank = 0, Efermi =  -0.058852546448 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.525 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.916 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.371 ms
rank = 0, Calculating density took 2177.018 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.036 ms
rank = 0, D2D took 1.206 ms
rank = 0, Transfering density took 1.213 ms
Etot    =   -44.917849163610
Eband   =   -12.861011364104
E1      =    28.892377605672
E2      =   -12.141033370272
E3      =   -16.157220450329
Exc     =   -14.477367660011
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 7.723e-07, dEband = 3.585e-05
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -44.917849164, dEtot = 7.723e-07, dEband = 3.585e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0311928680340, which took 1.101 ms

iter_count = 108, r_2norm = 1.098e-06, tol*||rhs|| = 1.248e-06

Anderson update took 63.168 ms, out of which F'*F took 29.879 ms; b-Ax took 203.547 ms, out of which Lap took 179.738 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.854 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326546, int_b + int_rho = 6.912e-14, checking this took 0.117 ms
2-norm of RHS = 694.7899343850797, which took 0.184 ms

iter_count = 102, r_2norm = 6.372e-04, tol*||rhs|| = 6.948e-04

Anderson update took 60.215 ms, out of which F'*F took 27.729 ms; b-Ax took 188.972 ms, out of which Lap took 168.462 ms
Solving Poisson took 423.403 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.097853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.091223 
Total time for convolution: 	 convolve: 5.102391 
Total time for convolution: 	 convolve: 5.094426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.407 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 1.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.886 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.586 ms

This SCF took 27433.244 ms, scf error = 1.397e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.137843, lowerbound = -0.991973, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2001.414 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.022 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.699 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 25.758 ms
rank =  0, finding HY took 32.531 ms
rank =  0, distributing HY into block cyclic form took 20.987 ms
rank =  0, finding Y'*HY took 5.593 ms
Rank 0, Project_Hamiltonian used 84.900 ms
Total time for projection: 84.913 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.991918829045573
    last  calculated eigval = 0.037708689035657
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58219478906761
lambda[   5] =  -0.55964761261704
lambda[   6] =  -0.50966514495965
lambda[   7] =  -0.41686503815491
lambda[   8] =  -0.41344518505859
lambda[   9] =  -0.37201416003973
lambda[  10] =  -0.27940311692241
lambda[  11] =  -0.26552456993260
lambda[  12] =  -0.23861302217169
lambda[  13] =  -0.22993024694925
lambda[  14] =  -0.02978866505771
lambda[  15] =  -0.02079283582394
lambda[  16] =   0.00748375461058
lambda[  17] =   0.01344247809093
lambda[  18] =   0.02711782198025
lambda[  19] =   0.03559608095248
lambda[  20] =   0.03770868903566
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 8.304 ms
rank =  0, Distributing orbital back into band + domain format took 20.747 ms
rank = 0, Subspace_Rotation used 29.067 ms

Total time for subspace rotation: 29.073 ms
rank = 0, Efermi =  -0.058818744362 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.807 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.345 ms
rank = 0, Calculating density took 2125.312 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.014 ms
rank = 0, D2D took 1.186 ms
rank = 0, Transfering density took 1.190 ms
Etot    =   -44.917857432092
Eband   =   -12.859820118250
E1      =    28.891706738976
E2      =   -12.140483077780
E3      =   -16.157315694165
Exc     =   -14.477441258994
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 1.034e-06, dEband = 1.489e-04
rank = 0, Calculating/Estimating energy took 1.873 ms, Etot = -44.917857432, dEtot = 1.034e-06, dEband = 1.489e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0298530121492, which took 0.084 ms

iter_count = 108, r_2norm = 9.967e-07, tol*||rhs|| = 1.194e-06

Anderson update took 63.393 ms, out of which F'*F took 29.830 ms; b-Ax took 202.782 ms, out of which Lap took 179.833 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.991 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326552, int_b + int_rho = 1.346e-13, checking this took 0.133 ms
2-norm of RHS = 694.7906684024384, which took 0.148 ms

iter_count = 126, r_2norm = 6.725e-04, tol*||rhs|| = 6.948e-04

Anderson update took 74.753 ms, out of which F'*F took 34.265 ms; b-Ax took 234.330 ms, out of which Lap took 208.906 ms
Solving Poisson took 527.924 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.122120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.118722 
Total time for convolution: 	 convolve: 5.096720 
Total time for convolution: 	 convolve: 5.137580 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.089 ms
======D2D: initiated sending and receiving took 1.107 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.601 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.163 ms

This SCF took 27572.754 ms, scf error = 1.237e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.137709, lowerbound = -0.991919, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2018.669 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.380 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.526 ms
rank =  0, finding HY took 32.775 ms
rank =  0, distributing HY into block cyclic form took 20.963 ms
rank =  0, finding Y'*HY took 5.597 ms
Rank 0, Project_Hamiltonian used 84.893 ms
Total time for projection: 84.908 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.991899215721450
    last  calculated eigval = 0.037496317410667
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58217372834643
lambda[   5] =  -0.55963131246782
lambda[   6] =  -0.50964768841117
lambda[   7] =  -0.41684564514576
lambda[   8] =  -0.41342867049360
lambda[   9] =  -0.37199792809267
lambda[  10] =  -0.27939589137542
lambda[  11] =  -0.26551126912809
lambda[  12] =  -0.23859812060618
lambda[  13] =  -0.22992527518681
lambda[  14] =  -0.02979386211880
lambda[  15] =  -0.02165914097924
lambda[  16] =   0.00736878422293
lambda[  17] =   0.01302411002526
lambda[  18] =   0.02590890059390
lambda[  19] =   0.03448001820231
lambda[  20] =   0.03749631741067
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 8.214 ms
rank =  0, Distributing orbital back into band + domain format took 20.861 ms
rank = 0, Subspace_Rotation used 29.091 ms

Total time for subspace rotation: 29.096 ms
rank = 0, Efermi =  -0.058823965022 calculate fermi energy took 0.109 ms
rank = 0, --- Calculate rho: sum over local bands took 5.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.384 ms
rank = 0, Calculating density took 2142.902 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.563 ms
rank = 0, D2D took 1.667 ms
rank = 0, Transfering density took 1.672 ms
Etot    =   -44.917864145867
Eband   =   -12.859413066701
E1      =    28.891483762525
E2      =   -12.140294828004
E3      =   -16.157296705398
Exc     =   -14.477424809325
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 8.392e-07, dEband = 5.088e-05
rank = 0, Calculating/Estimating energy took 1.164 ms, Etot = -44.917864146, dEtot = 8.392e-07, dEband = 5.088e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292511960975, which took 0.074 ms

iter_count = 108, r_2norm = 8.007e-07, tol*||rhs|| = 1.170e-06

Anderson update took 64.674 ms, out of which F'*F took 30.015 ms; b-Ax took 203.048 ms, out of which Lap took 180.083 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.947 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326551, int_b + int_rho = 1.273e-13, checking this took 0.128 ms
2-norm of RHS = 694.7932828754455, which took 0.174 ms

iter_count = 120, r_2norm = 6.341e-04, tol*||rhs|| = 6.948e-04

Anderson update took 71.298 ms, out of which F'*F took 32.830 ms; b-Ax took 223.699 ms, out of which Lap took 199.589 ms
Solving Poisson took 500.923 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.091656 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.120962 
Total time for convolution: 	 convolve: 5.123544 
Total time for convolution: 	 convolve: 5.092027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.430 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.971 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.622 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.639 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.547 ms

This SCF took 27511.965 ms, scf error = 1.098e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.137496, lowerbound = -0.991899, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.127 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.436 ms
rank =  0, finding HY took 32.555 ms
rank =  0, distributing HY into block cyclic form took 20.982 ms
rank =  0, finding Y'*HY took 5.639 ms
Rank 0, Project_Hamiltonian used 84.650 ms
Total time for projection: 84.667 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.991903073698816
    last  calculated eigval = 0.037840131730461
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58217245033900
lambda[   5] =  -0.55963772379554
lambda[   6] =  -0.50965001335783
lambda[   7] =  -0.41684796138823
lambda[   8] =  -0.41343248925140
lambda[   9] =  -0.37200504953996
lambda[  10] =  -0.27941114436727
lambda[  11] =  -0.26551928907901
lambda[  12] =  -0.23860570065313
lambda[  13] =  -0.22994383571671
lambda[  14] =  -0.02980981404994
lambda[  15] =  -0.02189578338648
lambda[  16] =   0.00729434516574
lambda[  17] =   0.01288094803808
lambda[  18] =   0.02544297101233
lambda[  19] =   0.03417754951007
lambda[  20] =   0.03784013173046
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 8.235 ms
rank =  0, Distributing orbital back into band + domain format took 20.863 ms
rank = 0, Subspace_Rotation used 29.115 ms

Total time for subspace rotation: 29.134 ms
rank = 0, Efermi =  -0.058839929002 calculate fermi energy took 0.186 ms
rank = 0, --- Calculate rho: sum over local bands took 5.859 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.433 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.402 ms
rank = 0, Calculating density took 2156.064 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.967 ms
rank = 0, D2D took 1.116 ms
rank = 0, Transfering density took 1.125 ms
Etot    =   -44.917866975946
Eband   =   -12.859582571149
E1      =    28.891630236378
E2      =   -12.140325635551
E3      =   -16.157229983033
Exc     =   -14.477368693989
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 3.538e-07, dEband = 2.119e-05
rank = 0, Calculating/Estimating energy took 2.015 ms, Etot = -44.917866976, dEtot = 3.538e-07, dEband = 2.119e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0339946101074, which took 0.067 ms

iter_count = 102, r_2norm = 1.300e-06, tol*||rhs|| = 1.360e-06

Anderson update took 60.463 ms, out of which F'*F took 28.394 ms; b-Ax took 192.684 ms, out of which Lap took 171.316 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.537 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326548, int_b + int_rho = 9.095e-14, checking this took 0.138 ms
2-norm of RHS = 694.7944783275503, which took 0.171 ms

iter_count = 78, r_2norm = 6.382e-04, tol*||rhs|| = 6.948e-04

Anderson update took 46.032 ms, out of which F'*F took 22.120 ms; b-Ax took 145.933 ms, out of which Lap took 130.309 ms
Solving Poisson took 327.895 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.105996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.091600 
Total time for convolution: 	 convolve: 5.096226 
Total time for convolution: 	 convolve: 5.095472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.660 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.913 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.607 ms

This SCF took 27331.594 ms, scf error = 1.116e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.137840, lowerbound = -0.991903, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.336 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.046 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.410 ms
rank =  0, finding HY took 32.500 ms
rank =  0, distributing HY into block cyclic form took 20.878 ms
rank =  0, finding Y'*HY took 5.616 ms
Rank 0, Project_Hamiltonian used 84.440 ms
Total time for projection: 84.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.991956556994868
    last  calculated eigval = 0.036983498628135
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58221698329079
lambda[   5] =  -0.55968195284170
lambda[   6] =  -0.50969198912358
lambda[   7] =  -0.41688975892484
lambda[   8] =  -0.41347664662724
lambda[   9] =  -0.37204335109189
lambda[  10] =  -0.27945125944281
lambda[  11] =  -0.26556291608421
lambda[  12] =  -0.23864663643204
lambda[  13] =  -0.22998396194209
lambda[  14] =  -0.02984874929556
lambda[  15] =  -0.02228856631820
lambda[  16] =   0.00724314706902
lambda[  17] =   0.01266211143113
lambda[  18] =   0.02497355066706
lambda[  19] =   0.03358701269434
lambda[  20] =   0.03698349862813
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.234 ms
rank =  0, Distributing orbital back into band + domain format took 21.823 ms
rank = 0, Subspace_Rotation used 30.081 ms

Total time for subspace rotation: 30.086 ms
rank = 0, Efermi =  -0.058878893170 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.887 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 2155.519 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.869 ms
rank = 0, D2D took 0.969 ms
rank = 0, Transfering density took 0.975 ms
Etot    =   -44.917873302343
Eband   =   -12.860728020493
E1      =    28.892372847830
E2      =   -12.140772294484
E3      =   -16.157006030462
Exc     =   -14.477194888858
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 7.908e-07, dEband = 1.432e-04
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -44.917873302, dEtot = 7.908e-07, dEband = 1.432e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304160508132, which took 0.066 ms

iter_count = 102, r_2norm = 1.021e-06, tol*||rhs|| = 1.217e-06

Anderson update took 59.840 ms, out of which F'*F took 28.438 ms; b-Ax took 193.020 ms, out of which Lap took 171.301 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.329 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326554, int_b + int_rho = 1.528e-13, checking this took 0.137 ms
2-norm of RHS = 694.7895579600316, which took 0.162 ms

iter_count = 132, r_2norm = 6.881e-04, tol*||rhs|| = 6.948e-04

Anderson update took 78.109 ms, out of which F'*F took 36.431 ms; b-Ax took 246.103 ms, out of which Lap took 219.703 ms
Solving Poisson took 549.501 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.099402 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.094793 
Total time for convolution: 	 convolve: 5.090430 
Total time for convolution: 	 convolve: 5.125242 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.369 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.478 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 1.557 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.685 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.400 ms

This SCF took 27590.563 ms, scf error = 1.374e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.136983, lowerbound = -0.991957, upperbound = 267.583289

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2058.788 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.374 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.214 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.615 ms
rank =  0, finding HY took 32.687 ms
rank =  0, distributing HY into block cyclic form took 20.929 ms
rank =  0, finding Y'*HY took 5.602 ms
Rank 0, Project_Hamiltonian used 84.865 ms
Total time for projection: 84.879 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.991722938669171
    last  calculated eigval = 0.036862226211543
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58201658780440
lambda[   5] =  -0.55948441402224
lambda[   6] =  -0.50950045943254
lambda[   7] =  -0.41669933854290
lambda[   8] =  -0.41327585137888
lambda[   9] =  -0.37186853710377
lambda[  10] =  -0.27927163771574
lambda[  11] =  -0.26537144070478
lambda[  12] =  -0.23845676762078
lambda[  13] =  -0.22981160031407
lambda[  14] =  -0.02966790230789
lambda[  15] =  -0.02222190643639
lambda[  16] =   0.00737092825783
lambda[  17] =   0.01235503514184
lambda[  18] =   0.02460824241446
lambda[  19] =   0.03351014865898
lambda[  20] =   0.03686222621154
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 9.091 ms
rank =  0, Distributing orbital back into band + domain format took 20.433 ms
rank = 0, Subspace_Rotation used 29.548 ms

Total time for subspace rotation: 29.556 ms
rank = 0, Efermi =  -0.058698058760 calculate fermi energy took 0.664 ms
rank = 0, --- Calculate rho: sum over local bands took 5.607 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.019 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.337 ms
rank = 0, Calculating density took 2184.068 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.857 ms
rank = 0, D2D took 0.998 ms
rank = 0, Transfering density took 1.005 ms
Etot    =   -44.917872177619
Eband   =   -12.855619187013
E1      =    28.889266581151
E2      =   -12.138607779494
E3      =   -16.157741966274
Exc     =   -14.477767751757
Esc     =   -74.770101565072
Entropy =    -0.000000000696
dE = 1.406e-07, dEband = 6.386e-04
rank = 0, Calculating/Estimating energy took 2.278 ms, Etot = -44.917872178, dEtot = 1.406e-07, dEband = 6.386e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0268605286170, which took 0.064 ms

iter_count = 102, r_2norm = 9.481e-07, tol*||rhs|| = 1.074e-06

Anderson update took 60.672 ms, out of which F'*F took 28.384 ms; b-Ax took 190.808 ms, out of which Lap took 169.514 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002326539, int_rho =  26.00000002326552, int_b + int_rho = 1.346e-13, checking this took 0.132 ms
2-norm of RHS = 694.7908064754337, which took 0.160 ms

iter_count = 96, r_2norm = 6.526e-04, tol*||rhs|| = 6.948e-04

Anderson update took 56.481 ms, out of which F'*F took 27.249 ms; b-Ax took 180.672 ms, out of which Lap took 160.922 ms
Solving Poisson took 401.940 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.116177 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.098730 
Total time for convolution: 	 convolve: 5.108207 
Total time for convolution: 	 convolve: 5.094023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.582 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.449 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.056 ms

This SCF took 27427.669 ms, scf error = 6.851e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.58201658780440, occ[   4] =   2.00000000000000
lambda[   5] =  -0.55948441402224, occ[   5] =   2.00000000000000
lambda[   6] =  -0.50950045943254, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41669933854290, occ[   7] =   2.00000000000000
lambda[   8] =  -0.41327585137888, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37186853710377, occ[   9] =   2.00000000000000
lambda[  10] =  -0.27927163771574, occ[  10] =   2.00000000000000
lambda[  11] =  -0.26537144070478, occ[  11] =   2.00000000000000
lambda[  12] =  -0.23845676762078, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22981160031407, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02966790230789, occ[  14] =   0.00000002326326
lambda[  15] =  -0.02222190643639, occ[  15] =   0.00000000000224
lambda[  16] =   0.00737092825783, occ[  16] =   0.00000000000000
lambda[  17] =   0.01235503514184, occ[  17] =   0.00000000000000
lambda[  18] =   0.02460824241446, occ[  18] =   0.00000000000000
lambda[  19] =   0.03351014865898, occ[  19] =   0.00000000000000
lambda[  20] =   0.03686222621154, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.361 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 1.226 ms, time for Allreduce/Reduce: 10.394 ms 
Time for calculating local force components: 24.307 ms
Start Calculating nonlocal forces
force_nloc = 
  0.03269763394735   0.04266045981369   0.00000005808923
  0.00390824185787  -0.06806747699305   0.00000000908748
 -0.05102352109523  -0.01716465284419   0.00000002596987
  0.05239100385330   0.07693255466541  -0.00000143276744
 -0.13486979592847   0.04584930216648  -0.00000086767234
 -0.46281639792596   0.75936688354458  -0.00000161903808
  0.94821020944999  -0.20575425053024  -0.00000055397869
 -0.07810048442882  -0.07164261939048   0.00000099888073
force_loc = 
 -0.03461159147392  -0.04470464715576  -0.00000051684615
 -0.00388081448809   0.07177774429260   0.00000005367887
  0.05383282888658   0.01794897370815   0.00000001631314
 -0.05241867744594  -0.08671125683159  -0.00000703867790
  0.14104014911529  -0.03789999792133  -0.00000028189014
  0.45319277661628  -0.74985390528016  -0.00000401359986
 -0.93058822914596   0.20946634827544  -0.00000074949921
  0.07362224702265   0.07563905715301   0.00000653639667
Time for calculating nonlocal force components: 48.880 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00082018246330   0.00210600866476  -0.00000034513918
[0m[32m  0.00045017239620  -0.00429467707316   0.00000000773419
[0m[32m  0.01139892485919  -0.01714275606780  -0.00000012627660
[0m[32m -0.02579910174117   0.00138910503711   0.00000004828179
[0m[32m  0.00414574436076   0.00033090039288   0.00000030591768
[0mTime for calculating XC forces components: 32.321 ms
 Cartesian force = 
 -0.00190909955514  -0.00207307454537   0.00000072687257
  0.00003228534120   0.00368138009626   0.00000124839584
  0.00281416576277   0.00075543366067   0.00000122791250
 -0.00084299808452  -0.00770158070471  -0.00000763095502
  0.00662538355445   0.00362573996870   0.00000004380120
  0.00178016152093  -0.00765866500668  -0.00000457328505
 -0.00817226346571   0.00507231557901  -0.00000006956662
 -0.00032763507398   0.00429845095212   0.00000902682458
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Time for printing density: 392.178 ms
The program took 646.663 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:57
Job ID:        2266587
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:11:24,vmem=8288K,walltime=00:10:57,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-23-2
---------------------------------------
