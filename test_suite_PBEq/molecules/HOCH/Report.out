---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:29
Job ID:    2266843
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:34
Job ID:    2266843
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 11.549 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 4.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 4.112 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 113.786 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.953 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.102 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.157589	    8.805115	   10.000000	
    8.097457	   11.733884	   10.000000	
   11.902543	    8.266116	   10.000000	
   10.157589	   11.297580	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.173 ms
Set up communicators.

--set up spincomm took 2.248 ms

--set up kptcomm took 0.341 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 12, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 12 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 12, mbQ = nbQ = 64
rank = 0, nr_Hp = 12, nc_Hp = 12
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.098 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.033 ms

Calculate_SplineDerivRadFun took 0.212 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.808 ms.
time spent on vectorized spline interp: 3.349 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.728 ms.
time spent on vectorized spline interp: 1.609 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.322 ms.
time spent on vectorized spline interp: 1.882 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.532 ms.

Calculating rb for all atom types took 17.087 ms
----------------------
Estimated memory usage
Total: 839.24 MB
orbitals             : 549.32 MB
global sized vectors : 213.62 MB
subspace matrices : 3.38 kB
others : 76.29 MB
----------------------------------------------
Estimated memory usage per processor: 69.94 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.826 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -12.0000000102913, sum_int_rho = 11.7984904584846
PosCharge = 12.000000010291, NegCharge = -11.798490458485, scal_fac = 1.017079265565
After scaling, int_rho = 12.0000000102913, PosCharge + NegCharge - NetCharge = -1.776e-15
--Calculate Vref took 0.232 ms
--Calculate rho_guess took 1.205 ms

 integral of b = -12.0000000102913,
 int{b} + Nelectron + NetCharge = -1.029e-08,
 Esc = -37.2738108210355,
 MPI_Reduce took 2.138 ms

Calculating b & b_ref took 7.849 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.080 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.088 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.048 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.314 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.999 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029134, int_b + int_rho = -1.273e-14, checking this took 0.092 ms
2-norm of RHS = 493.4862001437882, which took 0.160 ms

iter_count = 420, r_2norm = 4.301e-04, tol*||rhs|| = 4.935e-04

Anderson update took 264.024 ms, out of which F'*F took 117.416 ms; b-Ax took 806.348 ms, out of which Lap took 714.504 ms
Solving Poisson took 1781.283 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
Total time for convolution: 	 convolve: 5.122315 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.781 ms
Total time for convolution: 	 convolve: 5.098250 
Total time for convolution: 	 convolve: 5.131116 
Total time for convolution: 	 convolve: 5.095422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.718 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.313 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
rank = 0, XC calculation took 24653.754 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 4.809 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.957 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.892 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.198 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.905 ms
    Lanczos iter 53, eigmin  = -1.069175499, eigmax = 264.921684581, err_eigmin = 4.399e-04, err_eigmax = 9.637e-03
rank =   0, Lanczos took 134.770 ms, eigmin = -1.069175498661, eigmax = 267.570901426737

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.200863, lowerbound = -1.169175, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 924.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.117 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.463 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 30.601 ms
rank =  0, finding HY took 16.327 ms
rank =  0, distributing HY into block cyclic form took 9.476 ms
rank =  0, finding Y'*HY took 2.797 ms
Rank 0, Project_Hamiltonian used 59.234 ms
Total time for projection: 59.252 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.191 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.725 ms
rank = 0, Solve_Generalized_EigenProblem used 2.335 ms
    first calculated eigval = 2.832161410100093
    last  calculated eigval = 3.202043366354917
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =   2.83216141010009
lambda[   2] =   2.86009436751721
lambda[   3] =   2.89295029502934
lambda[   4] =   2.92836817098005
lambda[   5] =   2.96886216436024
lambda[   6] =   2.98052339856729
lambda[   7] =   3.03828469028546
lambda[   8] =   3.04567968743364
lambda[   9] =   3.08864381790101
lambda[  10] =   3.11916873194193
lambda[  11] =   3.13660934286176
lambda[  12] =   3.20204336635492
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 2.353 ms
rank =  0, subspace rotation using ScaLAPACK took 3.567 ms
rank =  0, Distributing orbital back into band + domain format took 8.570 ms
rank = 0, Subspace_Rotation used 12.152 ms

Total time for subspace rotation: 12.156 ms
rank = 0, Efermi =   3.009573262140 calculate fermi energy took 0.065 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.302043, lowerbound = -1.169175, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 941.007 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.600 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.977 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 12.605 ms
rank =  0, finding HY took 15.357 ms
rank =  0, distributing HY into block cyclic form took 8.653 ms
rank =  0, finding Y'*HY took 2.767 ms
Rank 0, Project_Hamiltonian used 39.411 ms
Total time for projection: 39.422 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.910514722371388
    last  calculated eigval = 0.430729813691854
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -0.91051472237139
lambda[   2] =  -0.31136522266697
lambda[   3] =  -0.04948465206004
lambda[   4] =   0.01032971910030
lambda[   5] =   0.19147532472310
lambda[   6] =   0.29535709450106
lambda[   7] =   0.33090665864636
lambda[   8] =   0.35036771810234
lambda[   9] =   0.36956919937270
lambda[  10] =   0.38432056530281
lambda[  11] =   0.42027689500056
lambda[  12] =   0.43072981369185
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.458 ms
rank =  0, Distributing orbital back into band + domain format took 8.541 ms
rank = 0, Subspace_Rotation used 12.016 ms

Total time for subspace rotation: 12.021 ms
rank = 0, Efermi =   0.313131888194 calculate fermi energy took 0.048 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.530730, lowerbound = -1.169175, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 941.000 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.836 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.791 ms
rank =  0, finding HY took 15.155 ms
rank =  0, distributing HY into block cyclic form took 8.793 ms
rank =  0, finding Y'*HY took 2.755 ms
Rank 0, Project_Hamiltonian used 37.524 ms
Total time for projection: 37.527 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.776 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.307 ms
rank = 0, Solve_Generalized_EigenProblem used 1.092 ms
    first calculated eigval = -1.071924246817787
    last  calculated eigval = 0.167436464458062
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.07192424681779
lambda[   2] =  -0.67615641369976
lambda[   3] =  -0.48001090306816
lambda[   4] =  -0.46306786914577
lambda[   5] =  -0.41336668365163
lambda[   6] =  -0.24419058677484
lambda[   7] =  -0.06244750864042
lambda[   8] =   0.07036131548820
lambda[   9] =   0.09650166471723
lambda[  10] =   0.11057668800988
lambda[  11] =   0.12473782912607
lambda[  12] =   0.16743646445806
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 2.002 ms
rank =  0, subspace rotation using ScaLAPACK took 3.491 ms
rank =  0, Distributing orbital back into band + domain format took 8.516 ms
rank = 0, Subspace_Rotation used 12.022 ms

Total time for subspace rotation: 12.028 ms
rank = 0, Efermi =  -0.092205581960 calculate fermi energy took 0.049 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.267436, lowerbound = -1.169175, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 941.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.677 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.824 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.526 ms
rank =  0, finding HY took 15.212 ms
rank =  0, distributing HY into block cyclic form took 8.787 ms
rank =  0, finding Y'*HY took 2.765 ms
Rank 0, Project_Hamiltonian used 37.322 ms
Total time for projection: 37.335 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -1.072006627855950
    last  calculated eigval = 0.096681340370932
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.07200662785595
lambda[   2] =  -0.67846042573727
lambda[   3] =  -0.49024372082363
lambda[   4] =  -0.48795685875759
lambda[   5] =  -0.42337674092701
lambda[   6] =  -0.26443653985558
lambda[   7] =  -0.14984354390434
lambda[   8] =   0.02716479093436
lambda[   9] =   0.05140750278994
lambda[  10] =   0.05620569405670
lambda[  11] =   0.07842161146430
lambda[  12] =   0.09668134037093
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 3.545 ms
rank =  0, Distributing orbital back into band + domain format took 8.503 ms
rank = 0, Subspace_Rotation used 12.063 ms

Total time for subspace rotation: 12.067 ms
rank = 0, Efermi =  -0.179601617223 calculate fermi energy took 0.035 ms
rank = 0, --- Calculate rho: sum over local bands took 3.534 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.248 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.618 ms
rank = 0, Calculating density took 4128.227 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.929 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -23.671816908952
Eband   =    -6.832961829456
E1      =    13.721446068454
E2      =    -5.934802713086
E3      =    -7.501608545711
Exc     =    -6.722901585396
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 5.918e+00, dEband = 1.708e+00
rank = 0, Calculating/Estimating energy took 1.478 ms, Etot = -23.671816909, dEtot = 5.918e+00, dEband = 1.708e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.4734083522560, which took 0.067 ms

iter_count = 90, r_2norm = 1.670e-03, tol*||rhs|| = 1.699e-03

Anderson update took 54.284 ms, out of which F'*F took 25.195 ms; b-Ax took 172.719 ms, out of which Lap took 152.029 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 386.272 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029132, int_b + int_rho = -3.456e-14, checking this took 0.132 ms
2-norm of RHS = 491.3182370084093, which took 0.173 ms

iter_count = 282, r_2norm = 4.281e-04, tol*||rhs|| = 4.913e-04

Anderson update took 180.207 ms, out of which F'*F took 85.459 ms; b-Ax took 548.250 ms, out of which Lap took 488.185 ms
Solving Poisson took 1205.945 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.079841 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.083284 
Total time for convolution: 	 convolve: 5.127535 
Total time for convolution: 	 convolve: 5.079272 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.116 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.349 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 3.559 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.039 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.633 ms

This SCF took 30074.763 ms, scf error = 1.441e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.196681, lowerbound = -1.072007, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 935.218 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.735 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.931 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.688 ms
rank =  0, finding HY took 15.731 ms
rank =  0, distributing HY into block cyclic form took 8.541 ms
rank =  0, finding Y'*HY took 2.756 ms
Rank 0, Project_Hamiltonian used 37.746 ms
Total time for projection: 37.759 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -1.055583910771348
    last  calculated eigval = 0.064633458136765
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.05558391077135
lambda[   2] =  -0.66141271833441
lambda[   3] =  -0.46976787715173
lambda[   4] =  -0.46732053813177
lambda[   5] =  -0.40897739279151
lambda[   6] =  -0.24219965071320
lambda[   7] =  -0.14051780434874
lambda[   8] =   0.00544702225722
lambda[   9] =   0.00878047299026
lambda[  10] =   0.03500636658286
lambda[  11] =   0.05517429115383
lambda[  12] =   0.06463345813677
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 3.415 ms
rank =  0, Distributing orbital back into band + domain format took 8.522 ms
rank = 0, Subspace_Rotation used 11.957 ms

Total time for subspace rotation: 11.962 ms
rank = 0, Efermi =  -0.170275877629 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.187 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.760 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1001.791 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.869 ms
rank = 0, D2D took 2.976 ms
rank = 0, Transfering density took 2.984 ms
Etot    =   -23.655188807242
Eband   =    -6.610524177234
E1      =    13.525139649733
E2      =    -5.911057029214
E3      =    -7.570901713767
Exc     =    -6.777952201372
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 4.157e-03, dEband = 5.561e-02
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -23.655188807, dEtot = 4.157e-03, dEband = 5.561e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.7974429104439, which took 0.054 ms

iter_count = 102, r_2norm = 3.686e-04, tol*||rhs|| = 4.719e-04

Anderson update took 60.848 ms, out of which F'*F took 27.356 ms; b-Ax took 190.295 ms, out of which Lap took 167.404 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.419 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029134, int_b + int_rho = -9.095e-15, checking this took 0.113 ms
2-norm of RHS = 488.6379146952701, which took 0.173 ms

iter_count = 300, r_2norm = 4.596e-04, tol*||rhs|| = 4.886e-04

Anderson update took 181.472 ms, out of which F'*F took 86.662 ms; b-Ax took 565.254 ms, out of which Lap took 505.067 ms
Solving Poisson took 1260.571 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.086005 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.073766 
Total time for convolution: 	 convolve: 5.112219 
Total time for convolution: 	 convolve: 5.067605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.503 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.073 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.611 ms

This SCF took 27021.728 ms, scf error = 1.004e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.164633, lowerbound = -1.055584, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 934.981 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.682 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.393 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.091 ms
rank =  0, finding HY took 15.520 ms
rank =  0, distributing HY into block cyclic form took 9.053 ms
rank =  0, finding Y'*HY took 2.659 ms
Rank 0, Project_Hamiltonian used 38.354 ms
Total time for projection: 38.365 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -1.030175342914962
    last  calculated eigval = 0.047536929569718
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.03017534291496
lambda[   2] =  -0.63054052589474
lambda[   3] =  -0.43507068918882
lambda[   4] =  -0.42500703245762
lambda[   5] =  -0.38702587363746
lambda[   6] =  -0.19535698552361
lambda[   7] =  -0.11011876737352
lambda[   8] =  -0.02002663494108
lambda[   9] =  -0.00330495889780
lambda[  10] =   0.02629081171782
lambda[  11] =   0.03858165365474
lambda[  12] =   0.04753692956972
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 3.437 ms
rank =  0, Distributing orbital back into band + domain format took 8.481 ms
rank = 0, Subspace_Rotation used 11.933 ms

Total time for subspace rotation: 11.938 ms
rank = 0, Efermi =  -0.139876840674 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.273 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.591 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1002.065 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.519 ms
rank = 0, D2D took 2.620 ms
rank = 0, Transfering density took 2.628 ms
Etot    =   -23.636975389568
Eband   =    -6.206352900368
E1      =    13.187192486375
E2      =    -5.831879499302
E3      =    -7.721842387945
Exc     =    -6.897726041472
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 4.553e-03, dEband = 1.010e-01
rank = 0, Calculating/Estimating energy took 1.174 ms, Etot = -23.636975390, dEtot = 4.553e-03, dEband = 1.010e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.6151345471729, which took 0.058 ms

iter_count = 102, r_2norm = 1.707e-04, tol*||rhs|| = 1.846e-04

Anderson update took 61.693 ms, out of which F'*F took 27.965 ms; b-Ax took 191.816 ms, out of which Lap took 169.791 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.619 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029130, int_b + int_rho = -4.911e-14, checking this took 0.111 ms
2-norm of RHS = 489.4433910970905, which took 0.199 ms

iter_count = 270, r_2norm = 4.273e-04, tol*||rhs|| = 4.894e-04

Anderson update took 161.946 ms, out of which F'*F took 76.299 ms; b-Ax took 512.793 ms, out of which Lap took 454.009 ms
Solving Poisson took 1135.195 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.103797 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.093339 
Total time for convolution: 	 convolve: 5.076783 
Total time for convolution: 	 convolve: 5.082248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.120 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.020 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.592 ms

This SCF took 26930.948 ms, scf error = 2.532e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.147537, lowerbound = -1.030175, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 957.560 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.734 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.794 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.549 ms
rank =  0, finding HY took 15.392 ms
rank =  0, distributing HY into block cyclic form took 8.565 ms
rank =  0, finding Y'*HY took 2.776 ms
Rank 0, Project_Hamiltonian used 37.324 ms
Total time for projection: 37.339 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.032283306671387
    last  calculated eigval = 0.040032769164543
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.03228330667139
lambda[   2] =  -0.63051021569195
lambda[   3] =  -0.43624685226013
lambda[   4] =  -0.42189498693303
lambda[   5] =  -0.38920137148421
lambda[   6] =  -0.19198971950478
lambda[   7] =  -0.10931943585709
lambda[   8] =  -0.03219673893434
lambda[   9] =  -0.00511482940812
lambda[  10] =   0.02340937741318
lambda[  11] =   0.03021508395151
lambda[  12] =   0.04003276916454
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.422 ms
rank =  0, Distributing orbital back into band + domain format took 8.510 ms
rank = 0, Subspace_Rotation used 11.947 ms

Total time for subspace rotation: 11.952 ms
rank = 0, Efermi =  -0.139077509169 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.046 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.103 ms
rank = 0, Calculating density took 1025.026 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.012 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.182 ms
rank = 0, D2D took 2.292 ms
rank = 0, Transfering density took 2.299 ms
Etot    =   -23.636204395482
Eband   =    -6.204252906216
E1      =    13.201533602705
E2      =    -5.813644307645
E3      =    -7.729053406195
Exc     =    -6.902371984460
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 1.927e-04, dEband = 5.250e-04
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -23.636204395, dEtot = 1.927e-04, dEband = 5.250e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5824068166478, which took 0.107 ms

iter_count = 108, r_2norm = 5.267e-05, tol*||rhs|| = 6.330e-05

Anderson update took 64.426 ms, out of which F'*F took 29.722 ms; b-Ax took 207.662 ms, out of which Lap took 183.291 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.597 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029129, int_b + int_rho = -6.185e-14, checking this took 0.115 ms
2-norm of RHS = 489.9345054947150, which took 0.143 ms

iter_count = 270, r_2norm = 3.816e-04, tol*||rhs|| = 4.899e-04

Anderson update took 162.317 ms, out of which F'*F took 76.663 ms; b-Ax took 519.004 ms, out of which Lap took 462.439 ms
Solving Poisson took 1150.301 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.079471 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.092440 
Total time for convolution: 	 convolve: 5.081587 
Total time for convolution: 	 convolve: 5.101322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.269 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.862 ms

This SCF took 26992.907 ms, scf error = 1.256e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.140033, lowerbound = -1.032283, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 938.888 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.829 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.578 ms
rank =  0, finding HY took 15.425 ms
rank =  0, distributing HY into block cyclic form took 8.600 ms
rank =  0, finding Y'*HY took 2.868 ms
Rank 0, Project_Hamiltonian used 37.501 ms
Total time for projection: 37.513 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -1.031277097843235
    last  calculated eigval = 0.035808856703046
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.03127709784323
lambda[   2] =  -0.62944610177906
lambda[   3] =  -0.43507121823947
lambda[   4] =  -0.41951607128283
lambda[   5] =  -0.38844814112245
lambda[   6] =  -0.18959121413270
lambda[   7] =  -0.10837408854188
lambda[   8] =  -0.03713263602273
lambda[   9] =  -0.00553004098437
lambda[  10] =   0.02166242501814
lambda[  11] =   0.02550898391633
lambda[  12] =   0.03580885670305
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.730 ms
rank =  0, Distributing orbital back into band + domain format took 8.467 ms
rank = 0, Subspace_Rotation used 12.215 ms

Total time for subspace rotation: 12.223 ms
rank = 0, Efermi =  -0.138132161840 calculate fermi energy took 0.898 ms
rank = 0, --- Calculate rho: sum over local bands took 3.384 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.172 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1006.596 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.988 ms
rank = 0, D2D took 2.090 ms
rank = 0, Transfering density took 2.097 ms
Etot    =   -23.635861978111
Eband   =    -6.186699689915
E1      =    13.202192225180
E2      =    -5.792835853239
E3      =    -7.737863446420
Exc     =    -6.908242991685
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 8.560e-05, dEband = 4.388e-03
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -23.635861978, dEtot = 8.560e-05, dEband = 4.388e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9821152117551, which took 0.074 ms

iter_count = 108, r_2norm = 2.637e-05, tol*||rhs|| = 3.928e-05

Anderson update took 64.718 ms, out of which F'*F took 30.133 ms; b-Ax took 207.314 ms, out of which Lap took 183.256 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.466 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029134, int_b + int_rho = -1.637e-14, checking this took 0.113 ms
2-norm of RHS = 490.0953917680579, which took 0.235 ms

iter_count = 252, r_2norm = 4.493e-04, tol*||rhs|| = 4.901e-04

Anderson update took 152.554 ms, out of which F'*F took 71.263 ms; b-Ax took 481.440 ms, out of which Lap took 428.308 ms
Solving Poisson took 1075.290 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.095856 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.109195 
Total time for convolution: 	 convolve: 5.089539 
Total time for convolution: 	 convolve: 5.073204 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.587 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.545 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.804 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.384 ms

This SCF took 26993.073 ms, scf error = 5.497e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.135809, lowerbound = -1.031277, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 936.615 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.867 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.617 ms
rank =  0, finding HY took 15.504 ms
rank =  0, distributing HY into block cyclic form took 8.576 ms
rank =  0, finding Y'*HY took 2.734 ms
Rank 0, Project_Hamiltonian used 37.463 ms
Total time for projection: 37.475 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -1.030179943977581
    last  calculated eigval = 0.033110183155659
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.03017994397758
lambda[   2] =  -0.62882840839729
lambda[   3] =  -0.43416150673880
lambda[   4] =  -0.41881628217761
lambda[   5] =  -0.38742212257939
lambda[   6] =  -0.18853149075302
lambda[   7] =  -0.10749452140395
lambda[   8] =  -0.03922194628172
lambda[   9] =  -0.00545394180966
lambda[  10] =   0.02078264594419
lambda[  11] =   0.02308491107348
lambda[  12] =   0.03311018315566
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 3.141 ms
rank =  0, Distributing orbital back into band + domain format took 9.247 ms
rank = 0, Subspace_Rotation used 12.411 ms

Total time for subspace rotation: 12.417 ms
rank = 0, Efermi =  -0.137252594712 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.357 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.501 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1003.320 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.965 ms
rank = 0, D2D took 2.068 ms
rank = 0, Transfering density took 2.074 ms
Etot    =   -23.635897418004
Eband   =    -6.175879510354
E1      =    13.200893131192
E2      =    -5.782304896443
E3      =    -7.739885137596
Exc     =    -6.909290251531
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 8.860e-06, dEband = 2.705e-03
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -23.635897418, dEtot = 8.860e-06, dEband = 2.705e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3121788685655, which took 0.062 ms

iter_count = 114, r_2norm = 8.750e-06, tol*||rhs|| = 1.249e-05

Anderson update took 67.311 ms, out of which F'*F took 31.928 ms; b-Ax took 215.533 ms, out of which Lap took 192.148 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029134, int_b + int_rho = -1.091e-14, checking this took 0.106 ms
2-norm of RHS = 490.1173959289476, which took 0.245 ms

iter_count = 246, r_2norm = 4.834e-04, tol*||rhs|| = 4.901e-04

Anderson update took 145.661 ms, out of which F'*F took 68.642 ms; b-Ax took 467.333 ms, out of which Lap took 412.685 ms
Solving Poisson took 1031.750 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.084791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.438 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.080090 
Total time for convolution: 	 convolve: 5.074632 
Total time for convolution: 	 convolve: 5.070604 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.022 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.621 ms

This SCF took 26892.580 ms, scf error = 3.126e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.133110, lowerbound = -1.030180, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 940.051 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.840 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.663 ms
rank =  0, finding HY took 15.542 ms
rank =  0, distributing HY into block cyclic form took 8.521 ms
rank =  0, finding Y'*HY took 2.705 ms
Rank 0, Project_Hamiltonian used 37.472 ms
Total time for projection: 37.486 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.028931310646552
    last  calculated eigval = 0.031601701353621
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02893131064655
lambda[   2] =  -0.62761441155713
lambda[   3] =  -0.43278651239266
lambda[   4] =  -0.41708461886992
lambda[   5] =  -0.38619358523874
lambda[   6] =  -0.18614062110016
lambda[   7] =  -0.10545863371837
lambda[   8] =  -0.04025757461235
lambda[   9] =  -0.00474464014480
lambda[  10] =   0.02051614700677
lambda[  11] =   0.02216376435127
lambda[  12] =   0.03160170135362
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 3.376 ms
rank =  0, Distributing orbital back into band + domain format took 8.879 ms
rank = 0, Subspace_Rotation used 12.271 ms

Total time for subspace rotation: 12.277 ms
rank = 0, Efermi =  -0.135216707004 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.423 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.495 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 1006.663 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.929 ms
rank = 0, D2D took 2.050 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -23.635924760577
Eband   =    -6.157502120696
E1      =    13.191271655003
E2      =    -5.772295063941
E3      =    -7.744097454628
Exc     =    -6.912275992104
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 6.836e-06, dEband = 4.594e-03
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -23.635924761, dEtot = 6.836e-06, dEband = 4.594e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1719323684576, which took 0.096 ms

iter_count = 114, r_2norm = 4.453e-06, tol*||rhs|| = 6.877e-06

Anderson update took 68.479 ms, out of which F'*F took 32.161 ms; b-Ax took 214.410 ms, out of which Lap took 191.028 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.576 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029128, int_b + int_rho = -7.094e-14, checking this took 0.147 ms
2-norm of RHS = 490.0629492203823, which took 0.236 ms

iter_count = 240, r_2norm = 4.051e-04, tol*||rhs|| = 4.901e-04

Anderson update took 144.255 ms, out of which F'*F took 69.010 ms; b-Ax took 468.074 ms, out of which Lap took 416.810 ms
Solving Poisson took 1022.772 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.085189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.922 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.110749 
Total time for convolution: 	 convolve: 5.077315 
Total time for convolution: 	 convolve: 5.079424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.416 ms
---Transfer Veff_loc: D2D took 3.553 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.831 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.420 ms

This SCF took 26918.502 ms, scf error = 1.746e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.131602, lowerbound = -1.028931, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 941.794 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.832 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.582 ms
rank =  0, finding HY took 15.352 ms
rank =  0, distributing HY into block cyclic form took 8.597 ms
rank =  0, finding Y'*HY took 2.714 ms
Rank 0, Project_Hamiltonian used 37.271 ms
Total time for projection: 37.283 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.639 ms
rank = 0, Solve_Generalized_EigenProblem used 1.424 ms
    first calculated eigval = -1.027864433001001
    last  calculated eigval = 0.030861105435843
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02786443300100
lambda[   2] =  -0.62653751486442
lambda[   3] =  -0.43155632563707
lambda[   4] =  -0.41563553329940
lambda[   5] =  -0.38506058700620
lambda[   6] =  -0.18453681596663
lambda[   7] =  -0.10396987988041
lambda[   8] =  -0.03919760415857
lambda[   9] =  -0.00295657043371
lambda[  10] =   0.02105628771188
lambda[  11] =   0.02297583611052
lambda[  12] =   0.03086110543584
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.452 ms
rank =  0, subspace rotation using ScaLAPACK took 3.452 ms
rank =  0, Distributing orbital back into band + domain format took 8.455 ms
rank = 0, Subspace_Rotation used 11.936 ms

Total time for subspace rotation: 11.943 ms
rank = 0, Efermi =  -0.133727953145 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.396 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.566 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1009.146 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.963 ms
rank = 0, D2D took 2.066 ms
rank = 0, Transfering density took 2.072 ms
Etot    =   -23.636066466510
Eband   =    -6.142382420619
E1      =    13.182872973872
E2      =    -5.764873430986
E3      =    -7.746439344682
Exc     =    -6.914058974079
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 3.543e-05, dEband = 3.780e-03
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -23.636066467, dEtot = 3.543e-05, dEband = 3.780e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1030232958353, which took 0.063 ms

iter_count = 114, r_2norm = 3.243e-06, tol*||rhs|| = 4.121e-06

Anderson update took 67.003 ms, out of which F'*F took 32.159 ms; b-Ax took 215.333 ms, out of which Lap took 191.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.307 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029132, int_b + int_rho = -3.274e-14, checking this took 0.111 ms
2-norm of RHS = 490.0895465635411, which took 0.175 ms

iter_count = 216, r_2norm = 4.309e-04, tol*||rhs|| = 4.901e-04

Anderson update took 126.327 ms, out of which F'*F took 60.282 ms; b-Ax took 415.255 ms, out of which Lap took 365.275 ms
Solving Poisson took 910.859 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.089890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.797 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.079512 
Total time for convolution: 	 convolve: 5.073252 
Total time for convolution: 	 convolve: 5.071691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.478 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.837 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.352 ms

This SCF took 26736.654 ms, scf error = 9.580e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130861, lowerbound = -1.027864, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 944.056 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.848 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.612 ms
rank =  0, finding HY took 15.439 ms
rank =  0, distributing HY into block cyclic form took 8.533 ms
rank =  0, finding Y'*HY took 2.568 ms
Rank 0, Project_Hamiltonian used 37.739 ms
Total time for projection: 37.750 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.027466479838259
    last  calculated eigval = 0.030689413868305
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02746647983826
lambda[   2] =  -0.62610775493122
lambda[   3] =  -0.43119872712440
lambda[   4] =  -0.41509093798965
lambda[   5] =  -0.38465098944158
lambda[   6] =  -0.18405362102437
lambda[   7] =  -0.10346693124353
lambda[   8] =  -0.03712516309218
lambda[   9] =  -0.00153885240397
lambda[  10] =   0.02170199708921
lambda[  11] =   0.02434634500129
lambda[  12] =   0.03068941386831
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.445 ms
rank =  0, Distributing orbital back into band + domain format took 8.480 ms
rank = 0, Subspace_Rotation used 11.938 ms

Total time for subspace rotation: 11.944 ms
rank = 0, Efermi =  -0.133225004544 calculate fermi energy took 0.113 ms
rank = 0, --- Calculate rho: sum over local bands took 3.414 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.324 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1010.473 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.039 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -23.636144369540
Eband   =    -6.137137021764
E1      =    13.181333120236
E2      =    -5.761051565226
E3      =    -7.746541615804
Exc     =    -6.914122827692
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 1.948e-05, dEband = 1.311e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -23.636144370, dEtot = 1.948e-05, dEband = 1.311e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0747197482960, which took 0.108 ms

iter_count = 114, r_2norm = 1.881e-06, tol*||rhs|| = 2.989e-06

Anderson update took 67.589 ms, out of which F'*F took 32.213 ms; b-Ax took 216.142 ms, out of which Lap took 192.825 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.433 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029136, int_b + int_rho = 1.091e-14, checking this took 0.123 ms
2-norm of RHS = 490.0922318134174, which took 0.217 ms

iter_count = 210, r_2norm = 4.406e-04, tol*||rhs|| = 4.901e-04

Anderson update took 126.951 ms, out of which F'*F took 60.830 ms; b-Ax took 404.366 ms, out of which Lap took 360.850 ms
Solving Poisson took 894.211 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.071726 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.184 ms
Total time for convolution: 	 convolve: 5.095537 
Total time for convolution: 	 convolve: 5.084564 
Total time for convolution: 	 convolve: 5.075722 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.824 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.401 ms

This SCF took 26748.308 ms, scf error = 7.040e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130689, lowerbound = -1.027466, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 956.817 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.741 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.859 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.711 ms
rank =  0, finding HY took 15.239 ms
rank =  0, distributing HY into block cyclic form took 8.586 ms
rank =  0, finding Y'*HY took 2.724 ms
Rank 0, Project_Hamiltonian used 38.300 ms
Total time for projection: 38.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.026473981719752
    last  calculated eigval = 0.031179339883748
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02647398171975
lambda[   2] =  -0.62517976952092
lambda[   3] =  -0.43035094663126
lambda[   4] =  -0.41416694442299
lambda[   5] =  -0.38373576051980
lambda[   6] =  -0.18321701711750
lambda[   7] =  -0.10260538086704
lambda[   8] =  -0.03358146170839
lambda[   9] =   0.00019999487436
lambda[  10] =   0.02280026981873
lambda[  11] =   0.02724029381248
lambda[  12] =   0.03117933988375
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.241 ms
rank =  0, Distributing orbital back into band + domain format took 8.763 ms
rank = 0, Subspace_Rotation used 12.024 ms

Total time for subspace rotation: 12.030 ms
rank = 0, Efermi =  -0.132363454168 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.331 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1023.984 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.066 ms
rank = 0, Transfering density took 2.072 ms
Etot    =   -23.636238764025
Eband   =    -6.126248840920
E1      =    13.175392920573
E2      =    -5.755785542904
E3      =    -7.747802187165
Exc     =    -6.915159752396
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 2.360e-05, dEband = 2.722e-03
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -23.636238764, dEtot = 2.360e-05, dEband = 2.722e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0670996690071, which took 0.074 ms

iter_count = 108, r_2norm = 2.275e-06, tol*||rhs|| = 2.684e-06

Anderson update took 64.225 ms, out of which F'*F took 29.950 ms; b-Ax took 203.394 ms, out of which Lap took 180.164 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.380 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029127, int_b + int_rho = -8.367e-14, checking this took 0.124 ms
2-norm of RHS = 490.1051859174317, which took 0.213 ms

iter_count = 186, r_2norm = 4.230e-04, tol*||rhs|| = 4.901e-04

Anderson update took 109.724 ms, out of which F'*F took 52.316 ms; b-Ax took 356.065 ms, out of which Lap took 313.765 ms
Solving Poisson took 783.746 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.069120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 80.919 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.111599 
Total time for convolution: 	 convolve: 5.075231 
Total time for convolution: 	 convolve: 5.073750 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.809 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.334 ms

This SCF took 28524.623 ms, scf error = 3.896e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131179, lowerbound = -1.026474, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 959.852 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.245 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 11.133 ms
rank =  0, finding HY took 15.397 ms
rank =  0, distributing HY into block cyclic form took 8.574 ms
rank =  0, finding Y'*HY took 2.736 ms
Rank 0, Project_Hamiltonian used 37.867 ms
Total time for projection: 37.881 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -1.026197041185214
    last  calculated eigval = 0.031383293791564
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02619704118521
lambda[   2] =  -0.62489775409580
lambda[   3] =  -0.43008241940835
lambda[   4] =  -0.41389048052572
lambda[   5] =  -0.38345038636083
lambda[   6] =  -0.18299697693768
lambda[   7] =  -0.10241705559439
lambda[   8] =  -0.03177665717731
lambda[   9] =   0.00015259155132
lambda[  10] =   0.02267933155174
lambda[  11] =   0.02846202496906
lambda[  12] =   0.03138329379156
==subpsace eigenproblem: bcast eigvals took 0.078 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 3.436 ms
rank =  0, Distributing orbital back into band + domain format took 8.477 ms
rank = 0, Subspace_Rotation used 11.927 ms

Total time for subspace rotation: 11.932 ms
rank = 0, Efermi =  -0.132175128870 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.381 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.470 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.606 ms
rank = 0, Calculating density took 1026.901 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.945 ms
rank = 0, D2D took 2.040 ms
rank = 0, Transfering density took 2.042 ms
Etot    =   -23.636293085830
Eband   =    -6.123030118081
E1      =    13.174134308651
E2      =    -5.753752137516
E3      =    -7.747913296214
Exc     =    -6.915251888779
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 1.358e-05, dEband = 8.047e-04
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -23.636293086, dEtot = 1.358e-05, dEband = 8.047e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0498268051203, which took 0.099 ms

iter_count = 108, r_2norm = 1.512e-06, tol*||rhs|| = 1.993e-06

Anderson update took 64.245 ms, out of which F'*F took 30.456 ms; b-Ax took 206.037 ms, out of which Lap took 184.242 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.488 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029130, int_b + int_rho = -5.275e-14, checking this took 0.159 ms
2-norm of RHS = 490.1150545958697, which took 0.242 ms

iter_count = 180, r_2norm = 4.225e-04, tol*||rhs|| = 4.901e-04

Anderson update took 108.015 ms, out of which F'*F took 51.667 ms; b-Ax took 346.653 ms, out of which Lap took 307.338 ms
Solving Poisson took 765.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.118 ms
Total time for convolution: 	 convolve: 5.075064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 59.832 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.084617 
Total time for convolution: 	 convolve: 5.093719 
Total time for convolution: 	 convolve: 5.076217 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.601 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.064 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.638 ms

This SCF took 26697.706 ms, scf error = 3.081e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131383, lowerbound = -1.026197, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 946.006 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.867 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.645 ms
rank =  0, finding HY took 15.380 ms
rank =  0, distributing HY into block cyclic form took 8.562 ms
rank =  0, finding Y'*HY took 2.741 ms
Rank 0, Project_Hamiltonian used 37.357 ms
Total time for projection: 37.368 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.026041475164760
    last  calculated eigval = 0.032738917970731
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02604147516476
lambda[   2] =  -0.62469782563653
lambda[   3] =  -0.42988928022010
lambda[   4] =  -0.41365468112320
lambda[   5] =  -0.38326604908459
lambda[   6] =  -0.18277102410503
lambda[   7] =  -0.10222559089113
lambda[   8] =  -0.02925758816080
lambda[   9] =   0.00044076633906
lambda[  10] =   0.02355072076324
lambda[  11] =   0.03116154137687
lambda[  12] =   0.03273891797073
==subpsace eigenproblem: bcast eigvals took 0.074 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 3.429 ms
rank =  0, Distributing orbital back into band + domain format took 8.498 ms
rank = 0, Subspace_Rotation used 11.941 ms

Total time for subspace rotation: 11.947 ms
rank = 0, Efermi =  -0.131983664174 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.379 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.554 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1012.241 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.037 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -23.636330876126
Eband   =    -6.120640671720
E1      =    13.173247273485
E2      =    -5.752217761016
E3      =    -7.747946275416
Exc     =    -6.915290692972
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 9.448e-06, dEband = 5.974e-04
rank = 0, Calculating/Estimating energy took 1.016 ms, Etot = -23.636330876, dEtot = 9.448e-06, dEband = 5.974e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0487660009074, which took 0.070 ms

iter_count = 108, r_2norm = 1.594e-06, tol*||rhs|| = 1.951e-06

Anderson update took 64.003 ms, out of which F'*F took 30.771 ms; b-Ax took 204.963 ms, out of which Lap took 182.696 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.227 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029130, int_b + int_rho = -4.729e-14, checking this took 0.119 ms
2-norm of RHS = 490.1127824938388, which took 0.198 ms

iter_count = 60, r_2norm = 4.783e-04, tol*||rhs|| = 4.901e-04

Anderson update took 35.298 ms, out of which F'*F took 16.821 ms; b-Ax took 115.128 ms, out of which Lap took 101.577 ms
Solving Poisson took 256.393 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.133130 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.810 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.070902 
Total time for convolution: 	 convolve: 5.093051 
Total time for convolution: 	 convolve: 5.076295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.020 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.615 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.254 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.176 ms

This SCF took 26127.790 ms, scf error = 2.920e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132739, lowerbound = -1.026041, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 943.760 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.716 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.890 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.633 ms
rank =  0, finding HY took 15.410 ms
rank =  0, distributing HY into block cyclic form took 8.616 ms
rank =  0, finding Y'*HY took 2.728 ms
Rank 0, Project_Hamiltonian used 37.414 ms
Total time for projection: 37.433 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -1.026018277579459
    last  calculated eigval = 0.032642249444168
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02601827757946
lambda[   2] =  -0.62468359474123
lambda[   3] =  -0.42987135271601
lambda[   4] =  -0.41364987063894
lambda[   5] =  -0.38324544435294
lambda[   6] =  -0.18276712348998
lambda[   7] =  -0.10221681220473
lambda[   8] =  -0.02920360589768
lambda[   9] =   0.00041780478666
lambda[  10] =   0.02327590252593
lambda[  11] =   0.03105803614136
lambda[  12] =   0.03264224944417
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 3.434 ms
rank =  0, Distributing orbital back into band + domain format took 8.492 ms
rank = 0, Subspace_Rotation used 11.942 ms

Total time for subspace rotation: 11.948 ms
rank = 0, Efermi =  -0.131974885536 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.382 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.497 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1009.966 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.951 ms
rank = 0, D2D took 2.048 ms
rank = 0, Transfering density took 2.051 ms
Etot    =   -23.636330483255
Eband   =    -6.120471328089
E1      =    13.173104424964
E2      =    -5.752189583289
E3      =    -7.747969548320
Exc     =    -6.915311890387
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 9.822e-08, dEband = 4.234e-05
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -23.636330483, dEtot = 9.822e-08, dEband = 4.234e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0470169444975, which took 0.083 ms

iter_count = 108, r_2norm = 1.612e-06, tol*||rhs|| = 1.881e-06

Anderson update took 64.281 ms, out of which F'*F took 30.486 ms; b-Ax took 204.056 ms, out of which Lap took 181.967 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.353 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029125, int_b + int_rho = -1.000e-13, checking this took 0.131 ms
2-norm of RHS = 490.1114209542053, which took 0.079 ms

iter_count = 84, r_2norm = 4.689e-04, tol*||rhs|| = 4.901e-04

Anderson update took 50.562 ms, out of which F'*F took 23.984 ms; b-Ax took 162.889 ms, out of which Lap took 144.509 ms
Solving Poisson took 359.051 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.071194 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 70.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.076851 
Total time for convolution: 	 convolve: 5.078267 
Total time for convolution: 	 convolve: 5.110954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.084 ms
---Transfer Veff_loc: D2D took 4.383 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.416 ms

This SCF took 26244.565 ms, scf error = 2.676e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132642, lowerbound = -1.026018, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 941.976 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.809 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.557 ms
rank =  0, finding HY took 15.379 ms
rank =  0, distributing HY into block cyclic form took 8.545 ms
rank =  0, finding Y'*HY took 2.734 ms
Rank 0, Project_Hamiltonian used 37.245 ms
Total time for projection: 37.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.025972179661505
    last  calculated eigval = 0.032639806880738
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02597217966150
lambda[   2] =  -0.62464513295224
lambda[   3] =  -0.42982973041923
lambda[   4] =  -0.41361603414854
lambda[   5] =  -0.38320274310744
lambda[   6] =  -0.18273470195402
lambda[   7] =  -0.10218484275646
lambda[   8] =  -0.02909772956000
lambda[   9] =   0.00040826920069
lambda[  10] =   0.02310297737043
lambda[  11] =   0.03109789531288
lambda[  12] =   0.03263980688074
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 3.441 ms
rank =  0, Distributing orbital back into band + domain format took 8.445 ms
rank = 0, Subspace_Rotation used 11.900 ms

Total time for subspace rotation: 11.904 ms
rank = 0, Efermi =  -0.131942916055 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.416 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.574 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 1008.079 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.951 ms
rank = 0, D2D took 2.047 ms
rank = 0, Transfering density took 2.049 ms
Etot    =   -23.636334662016
Eband   =    -6.120001045538
E1      =    13.172822829601
E2      =    -5.751985705803
E3      =    -7.748025154412
Exc     =    -6.915356484943
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 1.045e-06, dEband = 1.176e-04
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -23.636334662, dEtot = 1.045e-06, dEband = 1.176e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0357167394622, which took 0.069 ms

iter_count = 108, r_2norm = 1.390e-06, tol*||rhs|| = 1.429e-06

Anderson update took 64.423 ms, out of which F'*F took 31.310 ms; b-Ax took 210.104 ms, out of which Lap took 186.237 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.184 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029134, int_b + int_rho = -1.637e-14, checking this took 0.119 ms
2-norm of RHS = 490.1083453666678, which took 0.227 ms

iter_count = 156, r_2norm = 4.750e-04, tol*||rhs|| = 4.901e-04

Anderson update took 92.497 ms, out of which F'*F took 45.616 ms; b-Ax took 309.444 ms, out of which Lap took 273.076 ms
Solving Poisson took 670.812 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.075054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.095006 
Total time for convolution: 	 convolve: 5.083976 
Total time for convolution: 	 convolve: 5.078964 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.535 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.821 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.390 ms

This SCF took 26585.735 ms, scf error = 2.463e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132640, lowerbound = -1.025972, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 949.845 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.866 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.609 ms
rank =  0, finding HY took 15.439 ms
rank =  0, distributing HY into block cyclic form took 8.515 ms
rank =  0, finding Y'*HY took 2.735 ms
Rank 0, Project_Hamiltonian used 37.332 ms
Total time for projection: 37.344 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.025720534080191
    last  calculated eigval = 0.033270951772060
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02572053408019
lambda[   2] =  -0.62441703845331
lambda[   3] =  -0.42959437959853
lambda[   4] =  -0.41339338898789
lambda[   5] =  -0.38296608939350
lambda[   6] =  -0.18252863287743
lambda[   7] =  -0.10199579980407
lambda[   8] =  -0.02935368479640
lambda[   9] =  -0.00002636086454
lambda[  10] =   0.02365196670231
lambda[  11] =   0.03162872721024
lambda[  12] =   0.03327095177206
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 3.427 ms
rank =  0, Distributing orbital back into band + domain format took 8.495 ms
rank = 0, Subspace_Rotation used 11.936 ms

Total time for subspace rotation: 11.942 ms
rank = 0, Efermi =  -0.131753873094 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.323 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.419 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.577 ms
rank = 0, Calculating density took 1015.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.957 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.055 ms
Etot    =   -23.636365517359
Eband   =    -6.117240127831
E1      =    13.171327231402
E2      =    -5.750624887434
E3      =    -7.748330664493
Exc     =    -6.915597351506
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 7.714e-06, dEband = 6.902e-04
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -23.636365517, dEtot = 7.714e-06, dEband = 6.902e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0370943393878, which took 0.085 ms

iter_count = 108, r_2norm = 9.200e-07, tol*||rhs|| = 1.484e-06

Anderson update took 65.123 ms, out of which F'*F took 31.301 ms; b-Ax took 209.998 ms, out of which Lap took 185.791 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.845 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029128, int_b + int_rho = -6.730e-14, checking this took 0.141 ms
2-norm of RHS = 490.1179786802223, which took 0.244 ms

iter_count = 168, r_2norm = 4.246e-04, tol*||rhs|| = 4.901e-04

Anderson update took 102.113 ms, out of which F'*F took 48.177 ms; b-Ax took 326.216 ms, out of which Lap took 288.778 ms
Solving Poisson took 721.069 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.074932 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.952 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.072604 
Total time for convolution: 	 convolve: 5.080053 
Total time for convolution: 	 convolve: 5.080374 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.835 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.405 ms

This SCF took 26679.695 ms, scf error = 1.666e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133271, lowerbound = -1.025721, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 944.724 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 8.706 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.821 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.547 ms
rank =  0, finding HY took 15.462 ms
rank =  0, distributing HY into block cyclic form took 8.560 ms
rank =  0, finding Y'*HY took 2.727 ms
Rank 0, Project_Hamiltonian used 37.328 ms
Total time for projection: 37.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.025861943200832
    last  calculated eigval = 0.034063245073460
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02586194320083
lambda[   2] =  -0.62450889554036
lambda[   3] =  -0.42971686717001
lambda[   4] =  -0.41345741457672
lambda[   5] =  -0.38308653316266
lambda[   6] =  -0.18259738345665
lambda[   7] =  -0.10207079461656
lambda[   8] =  -0.02984770421847
lambda[   9] =   0.00043329710478
lambda[  10] =   0.02538412394774
lambda[  11] =   0.03267554576077
lambda[  12] =   0.03406324507346
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 3.430 ms
rank =  0, Distributing orbital back into band + domain format took 8.468 ms
rank = 0, Subspace_Rotation used 11.914 ms

Total time for subspace rotation: 11.920 ms
rank = 0, Efermi =  -0.131828867914 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.410 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.598 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.017 ms
rank = 0, Calculating density took 1011.348 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.142 ms
rank = 0, D2D took 2.264 ms
rank = 0, Transfering density took 2.268 ms
Etot    =   -23.636385377937
Eband   =    -6.118458075265
E1      =    13.172434386477
E2      =    -5.750840439571
E3      =    -7.747779504195
Exc     =    -6.915170811564
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 4.965e-06, dEband = 3.045e-04
rank = 0, Calculating/Estimating energy took 1.893 ms, Etot = -23.636385378, dEtot = 4.965e-06, dEband = 3.045e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0348895796466, which took 0.076 ms

iter_count = 108, r_2norm = 8.754e-07, tol*||rhs|| = 1.396e-06

Anderson update took 64.772 ms, out of which F'*F took 30.545 ms; b-Ax took 206.507 ms, out of which Lap took 182.074 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.693 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029127, int_b + int_rho = -8.367e-14, checking this took 0.117 ms
2-norm of RHS = 490.1191418921277, which took 0.221 ms

iter_count = 138, r_2norm = 4.395e-04, tol*||rhs|| = 4.901e-04

Anderson update took 82.324 ms, out of which F'*F took 39.341 ms; b-Ax took 283.823 ms, out of which Lap took 251.368 ms
Solving Poisson took 604.491 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.069294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 65.974 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.072466 
Total time for convolution: 	 convolve: 5.081156 
Total time for convolution: 	 convolve: 5.080907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.783 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.351 ms

This SCF took 26535.870 ms, scf error = 3.279e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134063, lowerbound = -1.025862, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 940.296 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.706 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.847 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.580 ms
rank =  0, finding HY took 15.395 ms
rank =  0, distributing HY into block cyclic form took 8.534 ms
rank =  0, finding Y'*HY took 2.723 ms
Rank 0, Project_Hamiltonian used 37.260 ms
Total time for projection: 37.270 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.025889817069116
    last  calculated eigval = 0.034112684834035
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02588981706912
lambda[   2] =  -0.62452293269423
lambda[   3] =  -0.42972903762553
lambda[   4] =  -0.41344157078688
lambda[   5] =  -0.38310367154517
lambda[   6] =  -0.18256166188725
lambda[   7] =  -0.10204400836408
lambda[   8] =  -0.02915809851434
lambda[   9] =   0.00047387714595
lambda[  10] =   0.02485539806029
lambda[  11] =   0.03291301311343
lambda[  12] =   0.03411268483404
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 3.430 ms
rank =  0, Distributing orbital back into band + domain format took 8.490 ms
rank = 0, Subspace_Rotation used 11.936 ms

Total time for subspace rotation: 11.942 ms
rank = 0, Efermi =  -0.131802081683 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.409 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1006.264 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.904 ms
rank = 0, Transfering density took 2.907 ms
Etot    =   -23.636380666507
Eband   =    -6.118497384267
E1      =    13.172553004610
E2      =    -5.750762222872
E3      =    -7.747788695996
Exc     =    -6.915176384367
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 1.178e-06, dEband = 9.827e-06
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -23.636380667, dEtot = 1.178e-06, dEband = 9.827e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0366724831304, which took 0.079 ms

iter_count = 102, r_2norm = 1.355e-06, tol*||rhs|| = 1.467e-06

Anderson update took 61.497 ms, out of which F'*F took 29.127 ms; b-Ax took 196.113 ms, out of which Lap took 172.955 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 443.154 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029127, int_b + int_rho = -8.185e-14, checking this took 0.112 ms
2-norm of RHS = 490.1186245185028, which took 0.235 ms

iter_count = 138, r_2norm = 4.678e-04, tol*||rhs|| = 4.901e-04

Anderson update took 83.803 ms, out of which F'*F took 40.208 ms; b-Ax took 270.805 ms, out of which Lap took 240.172 ms
Solving Poisson took 596.747 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.088975 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.355 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.075776 
Total time for convolution: 	 convolve: 5.076339 
Total time for convolution: 	 convolve: 5.083044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.844 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.345 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.010 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.572 ms

This SCF took 26437.299 ms, scf error = 3.759e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134113, lowerbound = -1.025890, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 935.111 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.737 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.832 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.592 ms
rank =  0, finding HY took 15.443 ms
rank =  0, distributing HY into block cyclic form took 8.590 ms
rank =  0, finding Y'*HY took 2.744 ms
Rank 0, Project_Hamiltonian used 37.398 ms
Total time for projection: 37.415 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -1.025836557737012
    last  calculated eigval = 0.033410090375945
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02583655773701
lambda[   2] =  -0.62448139496612
lambda[   3] =  -0.42969081066391
lambda[   4] =  -0.41342850999367
lambda[   5] =  -0.38306356379092
lambda[   6] =  -0.18256825076072
lambda[   7] =  -0.10204606563333
lambda[   8] =  -0.03013310310029
lambda[   9] =   0.00009829632647
lambda[  10] =   0.02445007629227
lambda[  11] =   0.03207240826237
lambda[  12] =   0.03341009037594
==subpsace eigenproblem: bcast eigvals took 0.088 ms
Total time for solving subspace eigenvalue problem: 0.271 ms
rank =  0, subspace rotation using ScaLAPACK took 3.439 ms
rank =  0, Distributing orbital back into band + domain format took 8.453 ms
rank = 0, Subspace_Rotation used 11.908 ms

Total time for subspace rotation: 11.914 ms
rank = 0, Efermi =  -0.131804138935 calculate fermi energy took 0.110 ms
rank = 0, --- Calculate rho: sum over local bands took 3.425 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.616 ms
rank = 0, Calculating density took 1001.347 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.566 ms
rank = 0, D2D took 2.664 ms
rank = 0, Transfering density took 2.672 ms
Etot    =   -23.636384410460
Eband   =    -6.118138176875
E1      =    13.172230926887
E2      =    -5.750699290808
E3      =    -7.747875877539
Exc     =    -6.915241507469
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 9.360e-07, dEband = 8.980e-05
rank = 0, Calculating/Estimating energy took 1.162 ms, Etot = -23.636384410, dEtot = 9.360e-07, dEband = 8.980e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0331447973423, which took 0.087 ms

iter_count = 102, r_2norm = 1.206e-06, tol*||rhs|| = 1.326e-06

Anderson update took 60.575 ms, out of which F'*F took 29.045 ms; b-Ax took 212.871 ms, out of which Lap took 184.556 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029129, int_b + int_rho = -6.366e-14, checking this took 0.119 ms
2-norm of RHS = 490.1146544390892, which took 0.177 ms

iter_count = 120, r_2norm = 4.773e-04, tol*||rhs|| = 4.901e-04

Anderson update took 71.022 ms, out of which F'*F took 33.880 ms; b-Ax took 231.247 ms, out of which Lap took 203.484 ms
Solving Poisson took 512.722 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.110766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.106292 
Total time for convolution: 	 convolve: 5.123565 
Total time for convolution: 	 convolve: 5.072438 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.795 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.369 ms

This SCF took 26435.783 ms, scf error = 3.160e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133410, lowerbound = -1.025837, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 940.003 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.760 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.838 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.619 ms
rank =  0, finding HY took 15.774 ms
rank =  0, distributing HY into block cyclic form took 8.545 ms
rank =  0, finding Y'*HY took 2.735 ms
Rank 0, Project_Hamiltonian used 37.718 ms
Total time for projection: 37.729 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.025646830193192
    last  calculated eigval = 0.033276903854727
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02564683019319
lambda[   2] =  -0.62432620300857
lambda[   3] =  -0.42951928602846
lambda[   4] =  -0.41330697080896
lambda[   5] =  -0.38289298021576
lambda[   6] =  -0.18246725018378
lambda[   7] =  -0.10193414672443
lambda[   8] =  -0.03036666186839
lambda[   9] =   0.00011672158734
lambda[  10] =   0.02438597142897
lambda[  11] =   0.03192798399765
lambda[  12] =   0.03327690385473
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 3.410 ms
rank =  0, Distributing orbital back into band + domain format took 8.492 ms
rank = 0, Subspace_Rotation used 11.919 ms

Total time for subspace rotation: 11.925 ms
rank = 0, Efermi =  -0.131692220009 calculate fermi energy took 0.101 ms
rank = 0, --- Calculate rho: sum over local bands took 3.992 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.781 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1006.463 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.955 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.069 ms
Etot    =   -23.636385881375
Eband   =    -6.116319041926
E1      =    13.171072109217
E2      =    -5.749951065292
E3      =    -7.748241158148
Exc     =    -6.915520350756
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 3.677e-07, dEband = 4.548e-04
rank = 0, Calculating/Estimating energy took 1.293 ms, Etot = -23.636385881, dEtot = 3.677e-07, dEband = 4.548e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281621353521, which took 0.090 ms

iter_count = 102, r_2norm = 9.930e-07, tol*||rhs|| = 1.126e-06

Anderson update took 61.117 ms, out of which F'*F took 28.344 ms; b-Ax took 194.178 ms, out of which Lap took 171.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.723 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029126, int_b + int_rho = -9.277e-14, checking this took 0.116 ms
2-norm of RHS = 490.1136840040700, which took 0.205 ms

iter_count = 138, r_2norm = 4.778e-04, tol*||rhs|| = 4.901e-04

Anderson update took 83.624 ms, out of which F'*F took 39.065 ms; b-Ax took 266.760 ms, out of which Lap took 235.203 ms
Solving Poisson took 590.112 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.072976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.087908 
Total time for convolution: 	 convolve: 5.080425 
Total time for convolution: 	 convolve: 5.080673 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.394 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.831 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.369 ms

This SCF took 26416.642 ms, scf error = 1.757e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.133277, lowerbound = -1.025647, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 943.500 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.730 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.834 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.586 ms
rank =  0, finding HY took 15.424 ms
rank =  0, distributing HY into block cyclic form took 8.567 ms
rank =  0, finding Y'*HY took 2.745 ms
Rank 0, Project_Hamiltonian used 37.348 ms
Total time for projection: 37.360 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -1.025465710367359
    last  calculated eigval = 0.033090702891955
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02546571036736
lambda[   2] =  -0.62416432605518
lambda[   3] =  -0.42935284538820
lambda[   4] =  -0.41317851099522
lambda[   5] =  -0.38272588990023
lambda[   6] =  -0.18236461779266
lambda[   7] =  -0.10181650859690
lambda[   8] =  -0.03078170110290
lambda[   9] =   0.00021243828334
lambda[  10] =   0.02464623840908
lambda[  11] =   0.03169052745152
lambda[  12] =   0.03309070289196
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 3.434 ms
rank =  0, Distributing orbital back into band + domain format took 8.849 ms
rank = 0, Subspace_Rotation used 13.059 ms

Total time for subspace rotation: 13.065 ms
rank = 0, Efermi =  -0.131574581874 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.304 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.478 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1010.629 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.950 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.059 ms
Etot    =   -23.636389140631
Eband   =    -6.114503802046
E1      =    13.170041698997
E2      =    -5.749103807048
E3      =    -7.748481698692
Exc     =    -6.915701721972
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 8.148e-07, dEband = 4.538e-04
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -23.636389141, dEtot = 8.148e-07, dEband = 4.538e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0233855259365, which took 0.083 ms

iter_count = 102, r_2norm = 7.935e-07, tol*||rhs|| = 9.354e-07

Anderson update took 61.325 ms, out of which F'*F took 29.123 ms; b-Ax took 196.979 ms, out of which Lap took 173.274 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 443.361 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029132, int_b + int_rho = -2.910e-14, checking this took 0.124 ms
2-norm of RHS = 490.1145144901246, which took 0.166 ms

iter_count = 114, r_2norm = 4.866e-04, tol*||rhs|| = 4.901e-04

Anderson update took 68.470 ms, out of which F'*F took 32.521 ms; b-Ax took 223.800 ms, out of which Lap took 196.303 ms
Solving Poisson took 490.201 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.072954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.269 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.074656 
Total time for convolution: 	 convolve: 5.080289 
Total time for convolution: 	 convolve: 5.073593 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.562 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.793 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.391 ms

This SCF took 26647.337 ms, scf error = 1.147e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.133091, lowerbound = -1.025466, upperbound = 267.570901

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 715.390 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 8.833 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.832 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.698 ms
rank =  0, finding HY took 15.426 ms
rank =  0, distributing HY into block cyclic form took 8.562 ms
rank =  0, finding Y'*HY took 2.749 ms
Rank 0, Project_Hamiltonian used 37.467 ms
Total time for projection: 37.484 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -1.025378749510905
    last  calculated eigval = 0.033267622636651
The last 12 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 12):
lambda[   1] =  -1.02537874951090
lambda[   2] =  -0.62407759791951
lambda[   3] =  -0.42927135209584
lambda[   4] =  -0.41310286156624
lambda[   5] =  -0.38264446729425
lambda[   6] =  -0.18229494131626
lambda[   7] =  -0.10174316096052
lambda[   8] =  -0.03064935737575
lambda[   9] =   0.00031548942764
lambda[  10] =   0.02477815208523
lambda[  11] =   0.03185190327452
lambda[  12] =   0.03326762263665
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 1.354 ms
rank =  0, Distributing orbital back into band + domain format took 34.187 ms
rank = 0, Subspace_Rotation used 35.554 ms

Total time for subspace rotation: 35.559 ms
rank = 0, Efermi =  -0.131501234261 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.483 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.359 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 805.557 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.937 ms
rank = 0, D2D took 2.039 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -23.636390838820
Eband   =    -6.113539940453
E1      =    13.169506136922
E2      =    -5.748646177279
E3      =    -7.748602382127
Exc     =    -6.915794773344
Esc     =   -37.273810821035
Entropy =    -0.000000000315
dE = 4.245e-07, dEband = 2.410e-04
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -23.636390839, dEtot = 4.245e-07, dEband = 2.410e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0248713713364, which took 0.076 ms

iter_count = 96, r_2norm = 9.143e-07, tol*||rhs|| = 9.949e-07

Anderson update took 57.462 ms, out of which F'*F took 28.067 ms; b-Ax took 186.536 ms, out of which Lap took 164.998 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.411 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -12.00000001029135, int_rho =  12.00000001029132, int_b + int_rho = -3.638e-14, checking this took 0.117 ms
2-norm of RHS = 490.1171000336843, which took 0.219 ms

iter_count = 144, r_2norm = 4.253e-04, tol*||rhs|| = 4.901e-04

Anderson update took 86.913 ms, out of which F'*F took 40.910 ms; b-Ax took 277.277 ms, out of which Lap took 244.653 ms
Solving Poisson took 613.222 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.070763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 87.558 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.076751 
Total time for convolution: 	 convolve: 6.272670 
Total time for convolution: 	 convolve: 5.073198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.809 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.357 ms

This SCF took 27415.246 ms, scf error = 9.694e-05
The last 12 occupations of kpoints #1 are (Nelectron = 12):
lambda[   1] =  -1.02537874951090, occ[   1] =   2.00000000000000
lambda[   2] =  -0.62407759791951, occ[   2] =   2.00000000000000
lambda[   3] =  -0.42927135209584, occ[   3] =   2.00000000000000
lambda[   4] =  -0.41310286156624, occ[   4] =   2.00000000000000
lambda[   5] =  -0.38264446729425, occ[   5] =   2.00000000000000
lambda[   6] =  -0.18229494131626, occ[   6] =   2.00000000000000
lambda[   7] =  -0.10174316096052, occ[   7] =   0.00000001029130
lambda[   8] =  -0.03064935737575, occ[   8] =   0.00000000000000
lambda[   9] =   0.00031548942764, occ[   9] =   0.00000000000000
lambda[  10] =   0.02477815208523, occ[  10] =   0.00000000000000
lambda[  11] =   0.03185190327452, occ[  11] =   0.00000000000000
lambda[  12] =   0.03326762263665, occ[  12] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 11 (90%) = 0.000000000000000.
Occupation of state 12 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.108 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.293 ms, time for Allreduce/Reduce: 5.250 ms 
Time for calculating local force components: 12.012 ms
Start Calculating nonlocal forces
force_nloc = 
  0.85855134303086   0.63672133678422   0.00000003338576
  0.04730013967410  -0.01228670585544  -0.00000002152595
 -0.07245470653933   0.02321859971634   0.00000000300858
 -0.39420878846660  -0.53276766409372  -0.00000320929534
force_loc = 
 -0.83639764361982  -0.61783280382153   0.00000003616717
 -0.05162192445409   0.01355263856522  -0.00000009090187
  0.07713021050743  -0.02660789257919  -0.00000002514533
  0.38544265553670   0.51788700252830  -0.00000101645692
Time for calculating nonlocal force components: 25.691 ms
[32mforces_xc: 
[0m[32m -0.02544838473709  -0.01615763785618  -0.00000000272495
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01143495740339   0.01417202407108  -0.00000005775501
[0mTime for calculating XC forces components: 13.989 ms
 Cartesian force = 
 -0.00322664990994   0.00275617074174   0.00000115463894
 -0.00425374936388   0.00129120834500   0.00000097538315
  0.00474353938422  -0.00336401722763   0.00000106567421
  0.00273685988960  -0.00068336185911  -0.00000319569630
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Time for printing density: 389.987 ms
The program took 594.768 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:37:30
Job ID:        2266843
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:01:12,vmem=13392K,walltime=00:10:06,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-018-9-2
---------------------------------------
