---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:53
Job ID:    2267009
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:00
Job ID:    2267009
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.059 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.012 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 4.828 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 16.100 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 132.756 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.964 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.101 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.659644	   10.000000	   11.888083	
    8.340356	   10.000000	   11.888083	
   11.532729	   12.452547	    8.111917	
    8.467271	   12.452547	    8.111917	
    8.467271	    7.547453	    8.111917	
   11.532729	    7.547453	    8.111917	
   10.000000	   10.000000	   10.664468	
   10.000000	   12.382125	    9.262086	
   10.000000	    7.617875	    9.262086	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 3.807 ms

--set up kptcomm took 0.344 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.876 ms

Calculate_SplineDerivRadFun took 0.198 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.273 ms.
time spent on vectorized spline interp: 2.728 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.024 ms.
time spent on vectorized spline interp: 1.765 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.538 ms.
time spent on vectorized spline interp: 1.733 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.312 ms.

Calculating rb for all atom types took 16.384 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.918 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.018 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000249278, sum_int_rho = 19.4078476106462
PosCharge = 20.000000024928, NegCharge = -19.407847610646, scal_fac = 1.030510978145
After scaling, int_rho = 20.0000000249275, PosCharge + NegCharge - NetCharge = 2.665e-13
--Calculate Vref took 0.433 ms
--Calculate rho_guess took 2.523 ms

 integral of b = -20.0000000249278,
 int{b} + Nelectron + NetCharge = -2.493e-08,
 Esc = -52.2131540150961,
 MPI_Reduce took 6.994 ms

Calculating b & b_ref took 16.298 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.056 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.063 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 32.773 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492770, int_b + int_rho = -4.729e-14, checking this took 0.088 ms
2-norm of RHS = 721.7903797128040, which took 0.785 ms

iter_count = 414, r_2norm = 7.206e-04, tol*||rhs|| = 7.218e-04

Anderson update took 260.327 ms, out of which F'*F took 118.643 ms; b-Ax took 796.628 ms, out of which Lap took 714.953 ms
Solving Poisson took 1757.303 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.478 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
Total time for convolution: 	 convolve: 5.113442 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.939 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
Total time for convolution: 	 convolve: 5.116938 
Total time for convolution: 	 convolve: 5.112789 
Total time for convolution: 	 convolve: 5.114084 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
rank = 0, XC calculation took 24381.136 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.590 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.694 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.121 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 2.018 ms
    Lanczos iter 53, eigmin  = -0.931004442, eigmax = 264.926256371, err_eigmin = 2.760e-04, err_eigmax = 9.981e-03
rank =   0, Lanczos took 131.664 ms, eigmin = -0.931004442252, eigmax = 267.575518934374

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.272257, lowerbound = -1.031004, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1693.487 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.124 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 3.152 ms
rank =  0, finding HY took 26.029 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.989 ms
Rank 0, Project_Hamiltonian used 33.201 ms
Total time for projection: 33.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.232 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.322 ms
    first calculated eigval = 2.761534268719768
    last  calculated eigval = 3.264170513318221
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.76153426871977
lambda[   2] =   2.82016656838256
lambda[   3] =   2.86183487583148
lambda[   4] =   2.91234170037962
lambda[   5] =   2.92961925499197
lambda[   6] =   2.94039185232968
lambda[   7] =   2.97208688281136
lambda[   8] =   2.98170676462245
lambda[   9] =   3.02577452276852
lambda[  10] =   3.03044905627109
lambda[  11] =   3.07561998966350
lambda[  12] =   3.10731005251523
lambda[  13] =   3.11769882365217
lambda[  14] =   3.14340963620446
lambda[  15] =   3.15701336587103
lambda[  16] =   3.23885702524419
lambda[  17] =   3.26417051331822
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.624 ms
rank =  0, subspace rotation using ScaLAPACK took 4.552 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.565 ms

Total time for subspace rotation: 4.566 ms
rank = 0, Efermi =   3.053041912834 calculate fermi energy took 0.072 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.364171, lowerbound = -1.031004, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1665.950 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.931 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.954 ms
rank =  0, finding HY took 26.095 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.826 ms
Rank 0, Project_Hamiltonian used 32.912 ms
Total time for projection: 32.946 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.636005201230013
    last  calculated eigval = 0.472121139823710
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.63600520123001
lambda[   2] =  -0.58286106172948
lambda[   3] =  -0.42942868612526
lambda[   4] =  -0.20125582311683
lambda[   5] =  -0.13676962420671
lambda[   6] =  -0.09586202680712
lambda[   7] =   0.14592056474517
lambda[   8] =   0.19582660271769
lambda[   9] =   0.24509969697667
lambda[  10] =   0.25745166949616
lambda[  11] =   0.34291899294730
lambda[  12] =   0.35485156770953
lambda[  13] =   0.37855628877996
lambda[  14] =   0.38808246790358
lambda[  15] =   0.42072748875334
lambda[  16] =   0.43480017465568
lambda[  17] =   0.47212113982371
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.123 ms
rank =  0, subspace rotation using ScaLAPACK took 4.579 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.587 ms

Total time for subspace rotation: 4.588 ms
rank = 0, Efermi =   0.313951301378 calculate fermi energy took 0.026 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.572121, lowerbound = -1.031004, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1662.531 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.631 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 4.672 ms
rank =  0, finding HY took 26.753 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.165 ms
Rank 0, Project_Hamiltonian used 35.633 ms
Total time for projection: 35.650 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.017 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.931829704453386
    last  calculated eigval = 0.162009440138864
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93182970445339
lambda[   2] =  -0.86776957467489
lambda[   3] =  -0.68351113942717
lambda[   4] =  -0.55606231115350
lambda[   5] =  -0.51007468792149
lambda[   6] =  -0.49579477393531
lambda[   7] =  -0.44015285783254
lambda[   8] =  -0.36881289894712
lambda[   9] =  -0.32545629438324
lambda[  10] =  -0.27061662570461
lambda[  11] =   0.05170995737911
lambda[  12] =   0.07692562161801
lambda[  13] =   0.10048618742831
lambda[  14] =   0.12213953529417
lambda[  15] =   0.13208674049623
lambda[  16] =   0.15607362700543
lambda[  17] =   0.16200944013886
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 4.653 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.663 ms

Total time for subspace rotation: 4.664 ms
rank = 0, Efermi =   0.022742265899 calculate fermi energy took 0.045 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.262009, lowerbound = -1.031004, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1666.177 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.037 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.939 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.959 ms
rank =  0, finding HY took 26.056 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.003 ms
Rank 0, Project_Hamiltonian used 33.082 ms
Total time for projection: 33.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.101 ms
    first calculated eigval = -0.932739812192226
    last  calculated eigval = 0.103468730670823
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.93273981219223
lambda[   2] =  -0.86843710283769
lambda[   3] =  -0.68531514188986
lambda[   4] =  -0.55903888972927
lambda[   5] =  -0.51595164604287
lambda[   6] =  -0.50500479072772
lambda[   7] =  -0.46334677845646
lambda[   8] =  -0.40576625169183
lambda[   9] =  -0.34589274512020
lambda[  10] =  -0.30015096733183
lambda[  11] =  -0.00329224699559
lambda[  12] =   0.03016495270056
lambda[  13] =   0.04516188761161
lambda[  14] =   0.06203434806033
lambda[  15] =   0.07579828816926
lambda[  16] =   0.08498315159709
lambda[  17] =   0.10346873067082
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.112 ms
rank =  0, subspace rotation using ScaLAPACK took 4.653 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.664 ms

Total time for subspace rotation: 4.665 ms
rank = 0, Efermi =  -0.032259938454 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 1.725 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 6979.437 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
rank = 0, D2D took 0.393 ms
rank = 0, Transfering density took 0.400 ms
Etot    =   -30.441528079078
Eband   =   -11.163288252122
E1      =    22.873521964445
E2      =    -8.701647292658
E3      =   -11.346723178530
Exc     =    -9.986978246749
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 3.382e+00, dEband = 1.240e+00
rank = 0, Calculating/Estimating energy took 2.138 ms, Etot = -30.441528079, dEtot = 3.382e+00, dEband = 1.240e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 52.9979199500577, which took 0.080 ms

iter_count = 96, r_2norm = 1.565e-03, tol*||rhs|| = 2.120e-03

Anderson update took 56.743 ms, out of which F'*F took 26.879 ms; b-Ax took 180.102 ms, out of which Lap took 160.404 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.212 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492756, int_b + int_rho = -1.892e-13, checking this took 0.135 ms
2-norm of RHS = 717.3273916011782, which took 0.175 ms

iter_count = 282, r_2norm = 7.118e-04, tol*||rhs|| = 7.173e-04

Anderson update took 165.479 ms, out of which F'*F took 77.871 ms; b-Ax took 526.668 ms, out of which Lap took 467.737 ms
Solving Poisson took 1165.960 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.940 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.105474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.872 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
Total time for convolution: 	 convolve: 5.108380 
Total time for convolution: 	 convolve: 5.104481 
Total time for convolution: 	 convolve: 5.099548 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.383 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.550 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.343 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.360 ms

This SCF took 32996.150 ms, scf error = 1.810e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.203469, lowerbound = -0.932740, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1666.485 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.949 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.984 ms
rank =  0, finding HY took 25.710 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.836 ms
Rank 0, Project_Hamiltonian used 32.557 ms
Total time for projection: 32.595 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.899610538524910
    last  calculated eigval = 0.077694239483021
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.89961053852491
lambda[   2] =  -0.83057821621900
lambda[   3] =  -0.65472045904617
lambda[   4] =  -0.53080495666842
lambda[   5] =  -0.48176648806094
lambda[   6] =  -0.47235578761145
lambda[   7] =  -0.43400590221620
lambda[   8] =  -0.38103737704745
lambda[   9] =  -0.30785362748558
lambda[  10] =  -0.25892973804124
lambda[  11] =  -0.03240456598064
lambda[  12] =   0.01233223558569
lambda[  13] =   0.01598785937506
lambda[  14] =   0.02780147160278
lambda[  15] =   0.04806506547248
lambda[  16] =   0.05329899333756
lambda[  17] =   0.07769423948302
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 4.787 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.800 ms

Total time for subspace rotation: 4.801 ms
rank = 0, Efermi =  -0.061372257485 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 2.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1706.841 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
rank = 0, D2D took 0.433 ms
rank = 0, Transfering density took 0.439 ms
Etot    =   -30.389699214804
Eband   =   -10.503326182650
E1      =    22.306621178933
E2      =    -8.625575884228
E3      =   -11.522607177450
Exc     =   -10.128023256925
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 5.759e-03, dEband = 7.333e-02
rank = 0, Calculating/Estimating energy took 1.817 ms, Etot = -30.389699215, dEtot = 5.759e-03, dEband = 7.333e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.9268454415508, which took 1.314 ms

iter_count = 102, r_2norm = 5.833e-04, tol*||rhs|| = 7.971e-04

Anderson update took 60.792 ms, out of which F'*F took 29.255 ms; b-Ax took 196.306 ms, out of which Lap took 175.415 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.469 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492751, int_b + int_rho = -2.401e-13, checking this took 0.151 ms
2-norm of RHS = 712.3970311708051, which took 0.136 ms

iter_count = 294, r_2norm = 6.625e-04, tol*||rhs|| = 7.124e-04

Anderson update took 172.439 ms, out of which F'*F took 84.210 ms; b-Ax took 570.386 ms, out of which Lap took 507.746 ms
Solving Poisson took 1234.669 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.539 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.171928 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.162292 
Total time for convolution: 	 convolve: 5.163637 
Total time for convolution: 	 convolve: 5.166018 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.537 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.657 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.313 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 28047.003 ms, scf error = 1.200e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.177694, lowerbound = -0.899611, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.223 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.948 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 2.975 ms
rank =  0, finding HY took 25.689 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.876 ms
Rank 0, Project_Hamiltonian used 32.568 ms
Total time for projection: 32.592 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.855982345358809
    last  calculated eigval = 0.069443992532258
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.85598234535881
lambda[   2] =  -0.78285335136042
lambda[   3] =  -0.60869004646192
lambda[   4] =  -0.49144954813011
lambda[   5] =  -0.43647441253888
lambda[   6] =  -0.43062149611439
lambda[   7] =  -0.39169059196555
lambda[   8] =  -0.34121749580938
lambda[   9] =  -0.26051519072430
lambda[  10] =  -0.20856737994861
lambda[  11] =  -0.03769314619490
lambda[  12] =   0.00606059723800
lambda[  13] =   0.00815817453087
lambda[  14] =   0.01348396382870
lambda[  15] =   0.03481890404320
lambda[  16] =   0.03802253272326
lambda[  17] =   0.06944399253226
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 4.947 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 4.965 ms

Total time for subspace rotation: 4.966 ms
rank = 0, Efermi =  -0.066660837633 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.002 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1687.298 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
rank = 0, D2D took 0.501 ms
rank = 0, Transfering density took 0.509 ms
Etot    =   -30.357437027276
Eband   =    -9.616123717764
E1      =    21.569685550055
E2      =    -8.454253322581
E3      =   -11.790316172472
Exc     =   -10.342414338779
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 3.585e-03, dEband = 9.858e-02
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -30.357437027, dEtot = 3.585e-03, dEband = 9.858e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.5959220931690, which took 0.068 ms

iter_count = 108, r_2norm = 1.308e-04, tol*||rhs|| = 1.838e-04

Anderson update took 64.664 ms, out of which F'*F took 31.347 ms; b-Ax took 210.353 ms, out of which Lap took 188.081 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.455 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492757, int_b + int_rho = -1.819e-13, checking this took 0.143 ms
2-norm of RHS = 712.3692208411593, which took 0.121 ms

iter_count = 276, r_2norm = 6.889e-04, tol*||rhs|| = 7.124e-04

Anderson update took 164.302 ms, out of which F'*F took 77.012 ms; b-Ax took 521.340 ms, out of which Lap took 463.294 ms
Solving Poisson took 1150.249 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.433 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.152539 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.160979 
Total time for convolution: 	 convolve: 5.163581 
Total time for convolution: 	 convolve: 5.158786 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27924.052 ms, scf error = 5.171e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.169444, lowerbound = -0.855982, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1639.800 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.015 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 3.039 ms
rank =  0, finding HY took 25.660 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.926 ms
Rank 0, Project_Hamiltonian used 32.657 ms
Total time for projection: 32.680 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.030 ms
rank = 0, Solve_Generalized_EigenProblem used 0.510 ms
    first calculated eigval = -0.844563615541479
    last  calculated eigval = 0.064944208840612
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.84456361554148
lambda[   2] =  -0.77287411909888
lambda[   3] =  -0.59012692788278
lambda[   4] =  -0.47764789629811
lambda[   5] =  -0.42449704954196
lambda[   6] =  -0.41985849270037
lambda[   7] =  -0.37605048812756
lambda[   8] =  -0.32204409877548
lambda[   9] =  -0.25111538800189
lambda[  10] =  -0.20030175242237
lambda[  11] =  -0.03802534038210
lambda[  12] =   0.00339271259438
lambda[  13] =   0.00596715395910
lambda[  14] =   0.01025706420968
lambda[  15] =   0.02488933172788
lambda[  16] =   0.03350810489474
lambda[  17] =   0.06494420884061
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.534 ms
rank =  0, subspace rotation using ScaLAPACK took 4.549 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.558 ms

Total time for subspace rotation: 4.559 ms
rank = 0, Efermi =  -0.066993031877 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.223 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1680.446 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, D2D took 0.450 ms
rank = 0, Transfering density took 0.458 ms
Etot    =   -30.351806870744
Eband   =    -9.358159657730
E1      =    21.408455914213
E2      =    -8.341712554245
E3      =   -11.885223528744
Exc     =   -10.415885194375
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 6.256e-04, dEband = 2.866e-02
rank = 0, Calculating/Estimating energy took 2.097 ms, Etot = -30.351806871, dEtot = 6.256e-04, dEband = 2.866e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9564809663657, which took 0.063 ms

iter_count = 108, r_2norm = 7.366e-05, tol*||rhs|| = 7.826e-05

Anderson update took 63.228 ms, out of which F'*F took 31.261 ms; b-Ax took 212.828 ms, out of which Lap took 189.925 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.912 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492755, int_b + int_rho = -2.001e-13, checking this took 0.114 ms
2-norm of RHS = 712.4380457692578, which took 0.151 ms

iter_count = 246, r_2norm = 6.456e-04, tol*||rhs|| = 7.124e-04

Anderson update took 146.005 ms, out of which F'*F took 68.306 ms; b-Ax took 466.286 ms, out of which Lap took 413.760 ms
Solving Poisson took 1026.963 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.158155 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.381 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.754 ms
Total time for convolution: 	 convolve: 5.153061 
Total time for convolution: 	 convolve: 5.166473 
Total time for convolution: 	 convolve: 5.159653 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.784 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.022 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.327 ms

This SCF took 28983.477 ms, scf error = 1.278e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.164944, lowerbound = -0.844564, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.409 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.958 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 2.980 ms
rank =  0, finding HY took 24.864 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.988 ms
Rank 0, Project_Hamiltonian used 32.867 ms
Total time for projection: 32.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.108 ms
    first calculated eigval = -0.839635418297412
    last  calculated eigval = 0.061989204409178
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83963541829741
lambda[   2] =  -0.76766815157407
lambda[   3] =  -0.58510278233181
lambda[   4] =  -0.47289163907394
lambda[   5] =  -0.41972862929670
lambda[   6] =  -0.41494799415536
lambda[   7] =  -0.37128620148694
lambda[   8] =  -0.31709463892061
lambda[   9] =  -0.24613875046541
lambda[  10] =  -0.19521652078143
lambda[  11] =  -0.03818371927257
lambda[  12] =   0.00238508447731
lambda[  13] =   0.00482147238984
lambda[  14] =   0.00884607982528
lambda[  15] =   0.01925459384850
lambda[  16] =   0.03068396518279
lambda[  17] =   0.06198920440918
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.125 ms
rank =  0, subspace rotation using ScaLAPACK took 4.282 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.295 ms

Total time for subspace rotation: 4.296 ms
rank = 0, Efermi =  -0.067151410741 calculate fermi energy took 3.713 ms
rank = 0, --- Calculate rho: sum over local bands took 2.032 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1693.572 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
rank = 0, D2D took 0.498 ms
rank = 0, Transfering density took 0.510 ms
Etot    =   -30.351058062480
Eband   =    -9.259421453719
E1      =    21.351133631562
E2      =    -8.293630437657
E3      =   -11.914876099540
Exc     =   -10.438122761679
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 8.320e-05, dEband = 1.097e-02
rank = 0, Calculating/Estimating energy took 1.146 ms, Etot = -30.351058062, dEtot = 8.320e-05, dEband = 1.097e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7647902717969, which took 0.055 ms

iter_count = 114, r_2norm = 1.948e-05, tol*||rhs|| = 3.059e-05

Anderson update took 67.111 ms, out of which F'*F took 33.101 ms; b-Ax took 225.134 ms, out of which Lap took 201.169 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.624 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492754, int_b + int_rho = -2.037e-13, checking this took 0.118 ms
2-norm of RHS = 712.7860030699040, which took 0.137 ms

iter_count = 240, r_2norm = 6.873e-04, tol*||rhs|| = 7.128e-04

Anderson update took 146.888 ms, out of which F'*F took 70.569 ms; b-Ax took 479.299 ms, out of which Lap took 420.744 ms
Solving Poisson took 1039.706 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.145 ms
Total time for convolution: 	 convolve: 5.168514 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.164580 
Total time for convolution: 	 convolve: 5.180700 
Total time for convolution: 	 convolve: 5.166560 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.345 ms

This SCF took 27889.003 ms, scf error = 7.439e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.161989, lowerbound = -0.839635, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1645.334 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.923 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.946 ms
rank =  0, finding HY took 25.571 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.914 ms
Rank 0, Project_Hamiltonian used 32.463 ms
Total time for projection: 32.484 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.837039048241531
    last  calculated eigval = 0.059607791654915
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83703904824153
lambda[   2] =  -0.76497553991844
lambda[   3] =  -0.58329653995558
lambda[   4] =  -0.47067646262658
lambda[   5] =  -0.41739895515875
lambda[   6] =  -0.41250991844236
lambda[   7] =  -0.36917507919913
lambda[   8] =  -0.31524707986118
lambda[   9] =  -0.24353268394299
lambda[  10] =  -0.19245471727827
lambda[  11] =  -0.03814181952771
lambda[  12] =   0.00212989318219
lambda[  13] =   0.00481888973726
lambda[  14] =   0.00840338682199
lambda[  15] =   0.01642714824216
lambda[  16] =   0.02918134805283
lambda[  17] =   0.05960779165492
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 4.801 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.813 ms

Total time for subspace rotation: 4.814 ms
rank = 0, Efermi =  -0.067109511022 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.177 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1685.400 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
rank = 0, D2D took 0.527 ms
rank = 0, Transfering density took 0.537 ms
Etot    =   -30.350765135297
Eband   =    -9.212612050200
E1      =    21.338523959290
E2      =    -8.257017126959
E3      =   -11.921116248645
Exc     =   -10.441656404151
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 3.255e-05, dEband = 5.201e-03
rank = 0, Calculating/Estimating energy took 3.615 ms, Etot = -30.350765135, dEtot = 3.255e-05, dEband = 5.201e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4129406134507, which took 0.131 ms

iter_count = 108, r_2norm = 1.557e-05, tol*||rhs|| = 1.652e-05

Anderson update took 63.288 ms, out of which F'*F took 31.466 ms; b-Ax took 213.274 ms, out of which Lap took 190.332 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.323 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492745, int_b + int_rho = -2.983e-13, checking this took 0.137 ms
2-norm of RHS = 712.9049896908891, which took 0.118 ms

iter_count = 246, r_2norm = 6.473e-04, tol*||rhs|| = 7.129e-04

Anderson update took 146.082 ms, out of which F'*F took 68.188 ms; b-Ax took 465.762 ms, out of which Lap took 412.914 ms
Solving Poisson took 1026.734 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.181512 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.162262 
Total time for convolution: 	 convolve: 5.198858 
Total time for convolution: 	 convolve: 6.105207 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.761 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.698 ms

This SCF took 28818.014 ms, scf error = 3.743e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.159608, lowerbound = -0.837039, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.954 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.047 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 3.074 ms
rank =  0, finding HY took 25.730 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.911 ms
Rank 0, Project_Hamiltonian used 32.748 ms
Total time for projection: 32.765 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.832329547507400
    last  calculated eigval = 0.058311530821940
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83232954750740
lambda[   2] =  -0.76052845616965
lambda[   3] =  -0.57847945528559
lambda[   4] =  -0.46650227873766
lambda[   5] =  -0.41258619480556
lambda[   6] =  -0.40864463798072
lambda[   7] =  -0.36426779755798
lambda[   8] =  -0.31082323376883
lambda[   9] =  -0.23907469250952
lambda[  10] =  -0.18777005188214
lambda[  11] =  -0.03758605121840
lambda[  12] =   0.00270298875214
lambda[  13] =   0.00676200352221
lambda[  14] =   0.00955909094815
lambda[  15] =   0.01542626096387
lambda[  16] =   0.02900967617691
lambda[  17] =   0.05831153082194
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.344 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.356 ms

Total time for subspace rotation: 4.357 ms
rank = 0, Efermi =  -0.066553742706 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.594 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1690.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
rank = 0, D2D took 0.405 ms
rank = 0, Transfering density took 0.409 ms
Etot    =   -30.350528561544
Eband   =    -9.122012693347
E1      =    21.291711735667
E2      =    -8.209254609792
E3      =   -11.936040125267
Exc     =   -10.452368323082
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 2.629e-05, dEband = 1.007e-02
rank = 0, Calculating/Estimating energy took 2.107 ms, Etot = -30.350528562, dEtot = 2.629e-05, dEband = 1.007e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2399256875841, which took 0.060 ms

iter_count = 114, r_2norm = 7.266e-06, tol*||rhs|| = 9.597e-06

Anderson update took 67.118 ms, out of which F'*F took 33.096 ms; b-Ax took 226.120 ms, out of which Lap took 202.025 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.094 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492752, int_b + int_rho = -2.292e-13, checking this took 0.076 ms
2-norm of RHS = 712.9352206737041, which took 0.112 ms

iter_count = 210, r_2norm = 6.542e-04, tol*||rhs|| = 7.129e-04

Anderson update took 128.431 ms, out of which F'*F took 58.278 ms; b-Ax took 399.164 ms, out of which Lap took 354.187 ms
Solving Poisson took 880.606 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.200910 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.153504 
Total time for convolution: 	 convolve: 5.180011 
Total time for convolution: 	 convolve: 5.171655 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.003 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27759.701 ms, scf error = 1.841e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.158312, lowerbound = -0.832330, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1639.245 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.975 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.997 ms
rank =  0, finding HY took 25.511 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.927 ms
Rank 0, Project_Hamiltonian used 32.465 ms
Total time for projection: 32.490 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.831984320503323
    last  calculated eigval = 0.056121217993143
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83198432050332
lambda[   2] =  -0.76015418315091
lambda[   3] =  -0.57814896232477
lambda[   4] =  -0.46612842184120
lambda[   5] =  -0.41225387248195
lambda[   6] =  -0.40824056415956
lambda[   7] =  -0.36390307168813
lambda[   8] =  -0.31045539167733
lambda[   9] =  -0.23863547241887
lambda[  10] =  -0.18732726952411
lambda[  11] =  -0.03713376860929
lambda[  12] =   0.00335932286140
lambda[  13] =   0.00770953069987
lambda[  14] =   0.01013480900632
lambda[  15] =   0.01506601169947
lambda[  16] =   0.02869047103143
lambda[  17] =   0.05612121799314
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 5.026 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 5.035 ms

Total time for subspace rotation: 5.036 ms
rank = 0, Efermi =  -0.066101460085 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.203 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1679.267 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.473 ms
rank = 0, Transfering density took 0.479 ms
Etot    =   -30.350634320451
Eband   =    -9.114463060466
E1      =    21.291264378368
E2      =    -8.202455352731
E3      =   -11.933722689323
Exc     =   -10.450459664567
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 1.175e-05, dEband = 8.388e-04
rank = 0, Calculating/Estimating energy took 1.433 ms, Etot = -30.350634320, dEtot = 1.175e-05, dEband = 8.388e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1426590024105, which took 0.152 ms

iter_count = 114, r_2norm = 4.084e-06, tol*||rhs|| = 5.706e-06

Anderson update took 67.028 ms, out of which F'*F took 33.213 ms; b-Ax took 224.785 ms, out of which Lap took 200.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.509 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492756, int_b + int_rho = -1.928e-13, checking this took 0.139 ms
2-norm of RHS = 712.8978208988249, which took 0.140 ms

iter_count = 222, r_2norm = 5.927e-04, tol*||rhs|| = 7.129e-04

Anderson update took 131.742 ms, out of which F'*F took 61.470 ms; b-Ax took 420.602 ms, out of which Lap took 372.707 ms
Solving Poisson took 926.650 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.122 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.167132 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.173498 
Total time for convolution: 	 convolve: 5.167164 
Total time for convolution: 	 convolve: 5.185734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 27782.124 ms, scf error = 1.376e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.156121, lowerbound = -0.831984, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1651.522 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.969 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.991 ms
rank =  0, finding HY took 25.749 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.037 ms
Rank 0, Project_Hamiltonian used 32.811 ms
Total time for projection: 32.832 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.830441894861214
    last  calculated eigval = 0.054476495040473
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83044189486121
lambda[   2] =  -0.75860853432519
lambda[   3] =  -0.57635317742380
lambda[   4] =  -0.46454962544793
lambda[   5] =  -0.41067471337939
lambda[   6] =  -0.40672581746126
lambda[   7] =  -0.36218608998995
lambda[   8] =  -0.30867903417439
lambda[   9] =  -0.23703028771336
lambda[  10] =  -0.18570720177782
lambda[  11] =  -0.03492562404546
lambda[  12] =   0.00682672763467
lambda[  13] =   0.01054552496450
lambda[  14] =   0.01274119763757
lambda[  15] =   0.01632039542058
lambda[  16] =   0.02991021538593
lambda[  17] =   0.05447649504047
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 4.827 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.835 ms

Total time for subspace rotation: 4.836 ms
rank = 0, Efermi =  -0.063893315543 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.256 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1691.751 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
rank = 0, D2D took 0.469 ms
rank = 0, Transfering density took 1.385 ms
Etot    =   -30.350660071026
Eband   =    -9.081912753979
E1      =    21.274316507288
E2      =    -8.186073925485
E3      =   -11.937128204197
Exc     =   -10.453111938177
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 2.861e-06, dEband = 3.617e-03
rank = 0, Calculating/Estimating energy took 1.641 ms, Etot = -30.350660071, dEtot = 2.861e-06, dEband = 3.617e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1147916781871, which took 0.055 ms

iter_count = 108, r_2norm = 4.330e-06, tol*||rhs|| = 4.592e-06

Anderson update took 63.650 ms, out of which F'*F took 31.484 ms; b-Ax took 213.430 ms, out of which Lap took 190.753 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.592 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492756, int_b + int_rho = -1.892e-13, checking this took 0.110 ms
2-norm of RHS = 712.8900298892265, which took 0.141 ms

iter_count = 204, r_2norm = 6.195e-04, tol*||rhs|| = 7.129e-04

Anderson update took 120.595 ms, out of which F'*F took 59.988 ms; b-Ax took 391.103 ms, out of which Lap took 347.719 ms
Solving Poisson took 854.548 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.187043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
Total time for convolution: 	 convolve: 5.201378 
Total time for convolution: 	 convolve: 5.186794 
Total time for convolution: 	 convolve: 5.158324 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 27749.543 ms, scf error = 8.024e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.154476, lowerbound = -0.830442, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1641.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.939 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.964 ms
rank =  0, finding HY took 25.551 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.918 ms
Rank 0, Project_Hamiltonian used 32.466 ms
Total time for projection: 32.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.829236244717005
    last  calculated eigval = 0.050675646144405
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82923624471700
lambda[   2] =  -0.75744795182483
lambda[   3] =  -0.57526035404302
lambda[   4] =  -0.46346244708696
lambda[   5] =  -0.40950011059746
lambda[   6] =  -0.40566649753910
lambda[   7] =  -0.36104545039790
lambda[   8] =  -0.30761524496099
lambda[   9] =  -0.23592520865443
lambda[  10] =  -0.18460266944653
lambda[  11] =  -0.03240282375407
lambda[  12] =   0.01017458320718
lambda[  13] =   0.01223478119366
lambda[  14] =   0.01488091362524
lambda[  15] =   0.01809647404033
lambda[  16] =   0.03021715477724
lambda[  17] =   0.05067564614441
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 4.693 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.703 ms

Total time for subspace rotation: 4.704 ms
rank = 0, Efermi =  -0.061370515218 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.338 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1682.008 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
rank = 0, D2D took 0.341 ms
rank = 0, Transfering density took 0.343 ms
Etot    =   -30.350763121076
Eband   =    -9.059524359344
E1      =    21.262389917951
E2      =    -8.175194223468
E3      =   -11.938892545560
Exc     =   -10.454561432870
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 1.145e-05, dEband = 2.488e-03
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -30.350763121, dEtot = 1.145e-05, dEband = 2.488e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0914779064252, which took 0.055 ms

iter_count = 108, r_2norm = 2.696e-06, tol*||rhs|| = 3.659e-06

Anderson update took 63.881 ms, out of which F'*F took 31.250 ms; b-Ax took 213.131 ms, out of which Lap took 190.056 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.344 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492764, int_b + int_rho = -1.128e-13, checking this took 0.123 ms
2-norm of RHS = 712.9090952668764, which took 0.106 ms

iter_count = 186, r_2norm = 6.234e-04, tol*||rhs|| = 7.129e-04

Anderson update took 110.191 ms, out of which F'*F took 51.598 ms; b-Ax took 352.392 ms, out of which Lap took 312.212 ms
Solving Poisson took 776.797 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.167834 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.213 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.394 ms
Total time for convolution: 	 convolve: 5.180463 
Total time for convolution: 	 convolve: 5.182448 
Total time for convolution: 	 convolve: 5.167011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.103 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.333 ms

This SCF took 27628.529 ms, scf error = 5.756e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.150676, lowerbound = -0.829236, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1665.376 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.936 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.959 ms
rank =  0, finding HY took 25.729 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.009 ms
Rank 0, Project_Hamiltonian used 32.729 ms
Total time for projection: 32.752 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.097 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.828820228184004
    last  calculated eigval = 0.046245798138329
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82882022818400
lambda[   2] =  -0.75708468945557
lambda[   3] =  -0.57478247754315
lambda[   4] =  -0.46300676373000
lambda[   5] =  -0.40909986697672
lambda[   6] =  -0.40527155453535
lambda[   7] =  -0.36058374942404
lambda[   8] =  -0.30708667122561
lambda[   9] =  -0.23558958418929
lambda[  10] =  -0.18432000021717
lambda[  11] =  -0.03010960374305
lambda[  12] =   0.01274880603490
lambda[  13] =   0.01298602460616
lambda[  14] =   0.01655349702981
lambda[  15] =   0.02059072946122
lambda[  16] =   0.03066772231973
lambda[  17] =   0.04624579813833
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.790 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.304 ms

Total time for subspace rotation: 5.305 ms
rank = 0, Efermi =  -0.059077295188 calculate fermi energy took 0.663 ms
rank = 0, --- Calculate rho: sum over local bands took 2.133 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1706.485 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.450 ms
rank = 0, Transfering density took 0.453 ms
Etot    =   -30.350829719312
Eband   =    -9.051291171712
E1      =    21.259189104766
E2      =    -8.170093819670
E3      =   -11.939059487895
Exc     =   -10.454726944090
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 7.400e-06, dEband = 9.148e-04
rank = 0, Calculating/Estimating energy took 2.143 ms, Etot = -30.350829719, dEtot = 7.400e-06, dEband = 9.148e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0668687931540, which took 0.145 ms

iter_count = 108, r_2norm = 2.315e-06, tol*||rhs|| = 2.675e-06

Anderson update took 63.730 ms, out of which F'*F took 31.461 ms; b-Ax took 212.911 ms, out of which Lap took 190.324 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492760, int_b + int_rho = -1.419e-13, checking this took 0.147 ms
2-norm of RHS = 712.9152635766100, which took 0.130 ms

iter_count = 162, r_2norm = 6.184e-04, tol*||rhs|| = 7.129e-04

Anderson update took 95.897 ms, out of which F'*F took 45.068 ms; b-Ax took 308.049 ms, out of which Lap took 273.131 ms
Solving Poisson took 677.423 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.162072 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.159062 
Total time for convolution: 	 convolve: 5.209443 
Total time for convolution: 	 convolve: 5.159301 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.016 ms
======D2D: initiated sending and receiving took 1.414 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 27516.582 ms, scf error = 4.237e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.146246, lowerbound = -0.828820, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1640.167 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.973 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 3.021 ms
rank =  0, finding HY took 25.629 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.940 ms
Rank 0, Project_Hamiltonian used 32.629 ms
Total time for projection: 32.653 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.103 ms
    first calculated eigval = -0.828487718269919
    last  calculated eigval = 0.042413027816826
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82848771826992
lambda[   2] =  -0.75675644448937
lambda[   3] =  -0.57444733456180
lambda[   4] =  -0.46267978729825
lambda[   5] =  -0.40877070521825
lambda[   6] =  -0.40495129799168
lambda[   7] =  -0.36025584764945
lambda[   8] =  -0.30675708979633
lambda[   9] =  -0.23527230105053
lambda[  10] =  -0.18401208188966
lambda[  11] =  -0.02900505956082
lambda[  12] =   0.01272825441146
lambda[  13] =   0.01393364577495
lambda[  14] =   0.01725438582387
lambda[  15] =   0.02172775803255
lambda[  16] =   0.03088449120509
lambda[  17] =   0.04241302781683
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.119 ms
rank =  0, subspace rotation using ScaLAPACK took 5.167 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 5.180 ms

Total time for subspace rotation: 5.181 ms
rank = 0, Efermi =  -0.057972751001 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.024 ms
rank = 0, Calculating density took 1680.855 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, D2D took 0.510 ms
rank = 0, Transfering density took 0.521 ms
Etot    =   -30.350880158899
Eband   =    -9.044781217154
E1      =    21.255966954278
E2      =    -8.166650323739
E3      =   -11.939567937661
Exc     =   -10.455130141583
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 5.604e-06, dEband = 7.233e-04
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -30.350880159, dEtot = 5.604e-06, dEband = 7.233e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0466861004864, which took 0.060 ms

iter_count = 108, r_2norm = 1.474e-06, tol*||rhs|| = 1.867e-06

Anderson update took 63.028 ms, out of which F'*F took 31.561 ms; b-Ax took 213.820 ms, out of which Lap took 190.578 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.140 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492762, int_b + int_rho = -1.310e-13, checking this took 0.140 ms
2-norm of RHS = 712.9217439581583, which took 0.121 ms

iter_count = 168, r_2norm = 6.337e-04, tol*||rhs|| = 7.129e-04

Anderson update took 99.434 ms, out of which F'*F took 46.601 ms; b-Ax took 318.616 ms, out of which Lap took 282.458 ms
Solving Poisson took 702.806 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.165737 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.162170 
Total time for convolution: 	 convolve: 5.175853 
Total time for convolution: 	 convolve: 5.179988 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.671 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.345 ms

This SCF took 27526.901 ms, scf error = 3.389e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.142413, lowerbound = -0.828488, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.569 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.936 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.961 ms
rank =  0, finding HY took 25.743 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.953 ms
Rank 0, Project_Hamiltonian used 32.689 ms
Total time for projection: 32.714 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.828057921058700
    last  calculated eigval = 0.041205382475863
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82805792105870
lambda[   2] =  -0.75631731452868
lambda[   3] =  -0.57399440355036
lambda[   4] =  -0.46224789585773
lambda[   5] =  -0.40833669478684
lambda[   6] =  -0.40452009404153
lambda[   7] =  -0.35982425498952
lambda[   8] =  -0.30632039262190
lambda[   9] =  -0.23483341324329
lambda[  10] =  -0.18358032709597
lambda[  11] =  -0.02711569195367
lambda[  12] =   0.01294453719119
lambda[  13] =   0.01513891595452
lambda[  14] =   0.01844746100549
lambda[  15] =   0.02319248860182
lambda[  16] =   0.03369838005072
lambda[  17] =   0.04120538247586
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 4.973 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.987 ms

Total time for subspace rotation: 4.988 ms
rank = 0, Efermi =  -0.056083383428 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 2.139 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1691.246 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
rank = 0, D2D took 0.480 ms
rank = 0, Transfering density took 0.489 ms
Etot    =   -30.350938862165
Eband   =    -9.036065424225
E1      =    21.251544638969
E2      =    -8.162121600392
E3      =   -11.940375931972
Exc     =   -10.455761593433
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 6.523e-06, dEband = 9.684e-04
rank = 0, Calculating/Estimating energy took 1.318 ms, Etot = -30.350938862, dEtot = 6.523e-06, dEband = 9.684e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0389779614548, which took 0.070 ms

iter_count = 108, r_2norm = 1.282e-06, tol*||rhs|| = 1.559e-06

Anderson update took 63.865 ms, out of which F'*F took 31.610 ms; b-Ax took 213.503 ms, out of which Lap took 190.781 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.783 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492746, int_b + int_rho = -2.874e-13, checking this took 0.129 ms
2-norm of RHS = 712.9208491752751, which took 0.140 ms

iter_count = 138, r_2norm = 6.193e-04, tol*||rhs|| = 7.129e-04

Anderson update took 81.656 ms, out of which F'*F took 38.328 ms; b-Ax took 262.605 ms, out of which Lap took 233.175 ms
Solving Poisson took 577.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.169105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.578 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.167394 
Total time for convolution: 	 convolve: 5.167135 
Total time for convolution: 	 convolve: 5.176415 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.345 ms

This SCF took 27391.355 ms, scf error = 2.105e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.141205, lowerbound = -0.828058, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1646.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.939 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.960 ms
rank =  0, finding HY took 25.834 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.908 ms
Rank 0, Project_Hamiltonian used 33.199 ms
Total time for projection: 33.812 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.031 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.827921632289188
    last  calculated eigval = 0.040087888102418
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82792163228919
lambda[   2] =  -0.75617833483286
lambda[   3] =  -0.57385426803836
lambda[   4] =  -0.46211468540154
lambda[   5] =  -0.40819875686645
lambda[   6] =  -0.40438736713462
lambda[   7] =  -0.35968851704948
lambda[   8] =  -0.30618696460800
lambda[   9] =  -0.23469379240907
lambda[  10] =  -0.18343933208357
lambda[  11] =  -0.02682630256653
lambda[  12] =   0.01288860645297
lambda[  13] =   0.01482136808171
lambda[  14] =   0.01845278895012
lambda[  15] =   0.02347413465247
lambda[  16] =   0.03508222011075
lambda[  17] =   0.04008788810242
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 4.539 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.547 ms

Total time for subspace rotation: 4.548 ms
rank = 0, Efermi =  -0.055793994052 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.312 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1687.669 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, D2D took 0.478 ms
rank = 0, Transfering density took 0.486 ms
Etot    =   -30.350965796599
Eband   =    -9.033327302095
E1      =    21.250082769871
E2      =    -8.160780314825
E3      =   -11.940582557199
Exc     =   -10.455930120559
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 2.993e-06, dEband = 3.042e-04
rank = 0, Calculating/Estimating energy took 3.662 ms, Etot = -30.350965797, dEtot = 2.993e-06, dEband = 3.042e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0331097139008, which took 0.059 ms

iter_count = 108, r_2norm = 1.004e-06, tol*||rhs|| = 1.324e-06

Anderson update took 63.333 ms, out of which F'*F took 31.322 ms; b-Ax took 213.278 ms, out of which Lap took 190.463 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.279 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492750, int_b + int_rho = -2.474e-13, checking this took 0.132 ms
2-norm of RHS = 712.9232131938961, which took 0.113 ms

iter_count = 138, r_2norm = 6.129e-04, tol*||rhs|| = 7.129e-04

Anderson update took 81.864 ms, out of which F'*F took 38.325 ms; b-Ax took 260.971 ms, out of which Lap took 231.617 ms
Solving Poisson took 576.584 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.166062 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.315 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.166432 
Total time for convolution: 	 convolve: 5.233421 
Total time for convolution: 	 convolve: 5.168300 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 27458.767 ms, scf error = 1.534e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.140088, lowerbound = -0.827922, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.638 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.426 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 3.453 ms
rank =  0, finding HY took 25.685 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.852 ms
Rank 0, Project_Hamiltonian used 33.587 ms
Total time for projection: 33.601 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.827943043450091
    last  calculated eigval = 0.040205639723472
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82794304345009
lambda[   2] =  -0.75620005544322
lambda[   3] =  -0.57385887296724
lambda[   4] =  -0.46211772101607
lambda[   5] =  -0.40821948701953
lambda[   6] =  -0.40439397818304
lambda[   7] =  -0.35969805304683
lambda[   8] =  -0.30618036844086
lambda[   9] =  -0.23471134957489
lambda[  10] =  -0.18346124690541
lambda[  11] =  -0.02686090543424
lambda[  12] =   0.01296171819839
lambda[  13] =   0.01450376103984
lambda[  14] =   0.01861044968253
lambda[  15] =   0.02389532606370
lambda[  16] =   0.03451937152730
lambda[  17] =   0.04020563972347
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 4.589 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.600 ms

Total time for subspace rotation: 4.601 ms
rank = 0, Efermi =  -0.055828596935 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.357 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1691.517 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.454 ms
rank = 0, Transfering density took 0.462 ms
Etot    =   -30.350981028473
Eband   =    -9.033568352764
E1      =    21.250518060834
E2      =    -8.160650939908
E3      =   -11.940240173067
Exc     =   -10.455667833678
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 1.692e-06, dEband = 2.678e-05
rank = 0, Calculating/Estimating energy took 3.192 ms, Etot = -30.350981028, dEtot = 1.692e-06, dEband = 2.678e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0321075407279, which took 0.110 ms

iter_count = 108, r_2norm = 1.001e-06, tol*||rhs|| = 1.284e-06

Anderson update took 63.429 ms, out of which F'*F took 31.529 ms; b-Ax took 213.275 ms, out of which Lap took 190.514 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.232 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492751, int_b + int_rho = -2.365e-13, checking this took 0.135 ms
2-norm of RHS = 712.9233764479695, which took 0.134 ms

iter_count = 84, r_2norm = 6.480e-04, tol*||rhs|| = 7.129e-04

Anderson update took 49.917 ms, out of which F'*F took 23.353 ms; b-Ax took 158.944 ms, out of which Lap took 141.021 ms
Solving Poisson took 352.816 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.159702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.170216 
Total time for convolution: 	 convolve: 5.165160 
Total time for convolution: 	 convolve: 5.169996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 27161.380 ms, scf error = 1.887e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.140206, lowerbound = -0.827943, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1645.460 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.000 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 3.021 ms
rank =  0, finding HY took 25.466 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.906 ms
Rank 0, Project_Hamiltonian used 32.418 ms
Total time for projection: 32.444 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.827957470254019
    last  calculated eigval = 0.039680215521742
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82795747025402
lambda[   2] =  -0.75621353668471
lambda[   3] =  -0.57386886056859
lambda[   4] =  -0.46212763062749
lambda[   5] =  -0.40823290655622
lambda[   6] =  -0.40440412505951
lambda[   7] =  -0.35970896663770
lambda[   8] =  -0.30618808963099
lambda[   9] =  -0.23472138521112
lambda[  10] =  -0.18347188071859
lambda[  11] =  -0.02677975931164
lambda[  12] =   0.01304070231431
lambda[  13] =   0.01450817582228
lambda[  14] =   0.01866909596271
lambda[  15] =   0.02403171137544
lambda[  16] =   0.03466122407607
lambda[  17] =   0.03968021552174
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 4.504 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.513 ms

Total time for subspace rotation: 4.514 ms
rank = 0, Efermi =  -0.055747450792 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.403 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1685.123 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, D2D took 0.453 ms
rank = 0, Transfering density took 0.460 ms
Etot    =   -30.350983689557
Eband   =    -9.033789704565
E1      =    21.250695071619
E2      =    -8.160715890404
E3      =   -11.940145519840
Exc     =   -10.455596451015
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 2.957e-07, dEband = 2.459e-05
rank = 0, Calculating/Estimating energy took 2.952 ms, Etot = -30.350983690, dEtot = 2.957e-07, dEband = 2.459e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0353437092273, which took 0.077 ms

iter_count = 108, r_2norm = 1.004e-06, tol*||rhs|| = 1.414e-06

Anderson update took 63.285 ms, out of which F'*F took 31.346 ms; b-Ax took 213.035 ms, out of which Lap took 190.111 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.079 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492754, int_b + int_rho = -2.037e-13, checking this took 0.119 ms
2-norm of RHS = 712.9240107858119, which took 0.161 ms

iter_count = 96, r_2norm = 6.740e-04, tol*||rhs|| = 7.129e-04

Anderson update took 56.849 ms, out of which F'*F took 26.711 ms; b-Ax took 181.545 ms, out of which Lap took 160.752 ms
Solving Poisson took 402.047 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.169321 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.163691 
Total time for convolution: 	 convolve: 5.177405 
Total time for convolution: 	 convolve: 5.162173 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.899 ms
---Transfer Veff_loc: D2D took 0.993 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 27556.020 ms, scf error = 1.997e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.139680, lowerbound = -0.827957, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.978 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.996 ms
rank =  0, finding HY took 25.810 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.916 ms
Rank 0, Project_Hamiltonian used 32.743 ms
Total time for projection: 32.764 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.106 ms
    first calculated eigval = -0.827917886806053
    last  calculated eigval = 0.038846668349892
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82791788680605
lambda[   2] =  -0.75617600399433
lambda[   3] =  -0.57384076024069
lambda[   4] =  -0.46209868687943
lambda[   5] =  -0.40819563476594
lambda[   6] =  -0.40437497566783
lambda[   7] =  -0.35967827288669
lambda[   8] =  -0.30616564219497
lambda[   9] =  -0.23469037761772
lambda[  10] =  -0.18343927942486
lambda[  11] =  -0.02693512306194
lambda[  12] =   0.01286195276116
lambda[  13] =   0.01421921010498
lambda[  14] =   0.01844859218489
lambda[  15] =   0.02372589782379
lambda[  16] =   0.03484699520031
lambda[  17] =   0.03884666834989
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.129 ms
rank =  0, subspace rotation using ScaLAPACK took 4.439 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.446 ms

Total time for subspace rotation: 4.447 ms
rank = 0, Efermi =  -0.055902814528 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 2.287 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1690.244 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
rank = 0, D2D took 0.422 ms
rank = 0, Transfering density took 0.428 ms
Etot    =   -30.350990108579
Eband   =    -9.033155041628
E1      =    21.250263832226
E2      =    -8.160465153427
E3      =   -11.940292117947
Exc     =   -10.455702154711
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 7.132e-07, dEband = 7.052e-05
rank = 0, Calculating/Estimating energy took 3.760 ms, Etot = -30.350990109, dEtot = 7.132e-07, dEband = 7.052e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0358364383819, which took 0.138 ms

iter_count = 108, r_2norm = 1.028e-06, tol*||rhs|| = 1.433e-06

Anderson update took 64.628 ms, out of which F'*F took 32.674 ms; b-Ax took 222.710 ms, out of which Lap took 200.031 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.003 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492756, int_b + int_rho = -1.892e-13, checking this took 0.147 ms
2-norm of RHS = 712.9240846481309, which took 0.139 ms

iter_count = 24, r_2norm = 6.427e-04, tol*||rhs|| = 7.129e-04

Anderson update took 14.151 ms, out of which F'*F took 6.461 ms; b-Ax took 45.715 ms, out of which Lap took 40.428 ms
Solving Poisson took 103.419 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.175404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.153180 
Total time for convolution: 	 convolve: 5.188512 
Total time for convolution: 	 convolve: 5.173384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.022 ms
======D2D: initiated sending and receiving took 1.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.309 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.325 ms

This SCF took 26949.892 ms, scf error = 1.640e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138847, lowerbound = -0.827918, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1643.454 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.962 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 2.983 ms
rank =  0, finding HY took 25.681 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.822 ms
Rank 0, Project_Hamiltonian used 32.508 ms
Total time for projection: 32.530 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.827922581718846
    last  calculated eigval = 0.038434748120000
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82792258171885
lambda[   2] =  -0.75618050264930
lambda[   3] =  -0.57384422992793
lambda[   4] =  -0.46210204845827
lambda[   5] =  -0.40820024982620
lambda[   6] =  -0.40437837229603
lambda[   7] =  -0.35968209465888
lambda[   8] =  -0.30616833280678
lambda[   9] =  -0.23469406281465
lambda[  10] =  -0.18344334251187
lambda[  11] =  -0.02693865324941
lambda[  12] =   0.01287431445104
lambda[  13] =   0.01424620178634
lambda[  14] =   0.01845562005840
lambda[  15] =   0.02368237016577
lambda[  16] =   0.03475007792015
lambda[  17] =   0.03843474812000
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 4.542 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 4.551 ms

Total time for subspace rotation: 4.552 ms
rank = 0, Efermi =  -0.055906344712 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 2.429 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1683.249 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
rank = 0, D2D took 0.507 ms
rank = 0, Transfering density took 0.509 ms
Etot    =   -30.350988144910
Eband   =    -9.033231636009
E1      =    21.250321387696
E2      =    -8.160489598969
E3      =   -11.940276409478
Exc     =   -10.455689889203
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 2.182e-07, dEband = 8.510e-06
rank = 0, Calculating/Estimating energy took 2.671 ms, Etot = -30.350988145, dEtot = 2.182e-07, dEband = 8.510e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0313036095407, which took 0.096 ms

iter_count = 108, r_2norm = 9.759e-07, tol*||rhs|| = 1.252e-06

Anderson update took 63.171 ms, out of which F'*F took 31.316 ms; b-Ax took 212.400 ms, out of which Lap took 189.597 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.256 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492749, int_b + int_rho = -2.619e-13, checking this took 0.133 ms
2-norm of RHS = 712.9221331878202, which took 0.169 ms

iter_count = 108, r_2norm = 6.467e-04, tol*||rhs|| = 7.129e-04

Anderson update took 63.889 ms, out of which F'*F took 29.710 ms; b-Ax took 203.826 ms, out of which Lap took 180.744 ms
Solving Poisson took 451.398 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.260436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.296597 
Total time for convolution: 	 convolve: 5.168027 
Total time for convolution: 	 convolve: 5.184204 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.312 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.329 ms

This SCF took 27503.152 ms, scf error = 1.689e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138435, lowerbound = -0.827923, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.828 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.014 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 3.036 ms
rank =  0, finding HY took 25.656 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.835 ms
Rank 0, Project_Hamiltonian used 32.553 ms
Total time for projection: 32.573 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.111 ms
    first calculated eigval = -0.827907129682935
    last  calculated eigval = 0.038728282419300
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82790712968294
lambda[   2] =  -0.75616804894275
lambda[   3] =  -0.57383602909370
lambda[   4] =  -0.46208988318551
lambda[   5] =  -0.40818792706604
lambda[   6] =  -0.40436663021875
lambda[   7] =  -0.35967347274871
lambda[   8] =  -0.30616087861625
lambda[   9] =  -0.23469465338307
lambda[  10] =  -0.18344455187415
lambda[  11] =  -0.02693239679571
lambda[  12] =   0.01276315334900
lambda[  13] =   0.01390053628264
lambda[  14] =   0.01830003899603
lambda[  15] =   0.02394553344297
lambda[  16] =   0.03568590641663
lambda[  17] =   0.03872828241930
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 4.651 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.660 ms

Total time for subspace rotation: 4.661 ms
rank = 0, Efermi =  -0.055900088279 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 2.379 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1690.726 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.192 ms
rank = 0, D2D took 1.284 ms
rank = 0, Transfering density took 1.288 ms
Etot    =   -30.350988190210
Eband   =    -9.033058410295
E1      =    21.250097875261
E2      =    -8.160534406021
E3      =   -11.940340235485
Exc     =   -10.455748280841
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 5.033e-09, dEband = 1.925e-05
rank = 0, Calculating/Estimating energy took 1.157 ms, Etot = -30.350988190, dEtot = 5.033e-09, dEband = 1.925e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0310084791113, which took 0.056 ms

iter_count = 108, r_2norm = 9.512e-07, tol*||rhs|| = 1.240e-06

Anderson update took 63.799 ms, out of which F'*F took 31.439 ms; b-Ax took 213.195 ms, out of which Lap took 190.169 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.606 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492755, int_b + int_rho = -1.965e-13, checking this took 0.129 ms
2-norm of RHS = 712.9205821521753, which took 0.116 ms

iter_count = 96, r_2norm = 6.240e-04, tol*||rhs|| = 7.129e-04

Anderson update took 56.766 ms, out of which F'*F took 26.684 ms; b-Ax took 181.334 ms, out of which Lap took 160.852 ms
Solving Poisson took 402.547 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.158695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.161339 
Total time for convolution: 	 convolve: 5.167693 
Total time for convolution: 	 convolve: 5.164886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 0.313 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.331 ms

This SCF took 27170.353 ms, scf error = 1.453e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.138728, lowerbound = -0.827907, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1640.211 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.956 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.974 ms
rank =  0, finding HY took 25.563 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.944 ms
Rank 0, Project_Hamiltonian used 32.508 ms
Total time for projection: 32.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.105 ms
    first calculated eigval = -0.827888869514600
    last  calculated eigval = 0.038287533902272
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82788886951460
lambda[   2] =  -0.75614730134657
lambda[   3] =  -0.57382329812348
lambda[   4] =  -0.46207505759291
lambda[   5] =  -0.40817056490807
lambda[   6] =  -0.40434856155203
lambda[   7] =  -0.35966089698741
lambda[   8] =  -0.30615167729126
lambda[   9] =  -0.23467781395542
lambda[  10] =  -0.18342492463749
lambda[  11] =  -0.02750440870823
lambda[  12] =   0.01255526482203
lambda[  13] =   0.01315841763202
lambda[  14] =   0.01777930397465
lambda[  15] =   0.02360139410731
lambda[  16] =   0.03529036055175
lambda[  17] =   0.03828753390227
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 4.743 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.749 ms

Total time for subspace rotation: 4.750 ms
rank = 0, Efermi =  -0.056472100161 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.756 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1681.033 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.015 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
rank = 0, D2D took 0.344 ms
rank = 0, Transfering density took 0.351 ms
Etot    =   -30.350992961096
Eband   =    -9.032737932504
E1      =    21.249841392030
E2      =    -8.160454922344
E3      =   -11.940387333982
Exc     =   -10.455784661107
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 5.301e-07, dEband = 3.561e-05
rank = 0, Calculating/Estimating energy took 1.398 ms, Etot = -30.350992961, dEtot = 5.301e-07, dEband = 3.561e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0339500861974, which took 0.051 ms

iter_count = 102, r_2norm = 1.225e-06, tol*||rhs|| = 1.358e-06

Anderson update took 59.597 ms, out of which F'*F took 29.388 ms; b-Ax took 199.445 ms, out of which Lap took 177.890 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 441.350 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492749, int_b + int_rho = -2.547e-13, checking this took 0.116 ms
2-norm of RHS = 712.9173668699084, which took 0.118 ms

iter_count = 138, r_2norm = 6.436e-04, tol*||rhs|| = 7.129e-04

Anderson update took 81.956 ms, out of which F'*F took 38.046 ms; b-Ax took 259.836 ms, out of which Lap took 230.566 ms
Solving Poisson took 575.077 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.200485 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.188175 
Total time for convolution: 	 convolve: 5.168469 
Total time for convolution: 	 convolve: 5.168939 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.559 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.349 ms

This SCF took 27420.459 ms, scf error = 1.197e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.138288, lowerbound = -0.827889, upperbound = 267.575519

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1650.349 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.979 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 3.006 ms
rank =  0, finding HY took 25.634 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 4.022 ms
Rank 0, Project_Hamiltonian used 32.689 ms
Total time for projection: 32.721 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.110 ms
    first calculated eigval = -0.827822730910734
    last  calculated eigval = 0.037341847126205
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82782273091073
lambda[   2] =  -0.75608068911042
lambda[   3] =  -0.57377372706646
lambda[   4] =  -0.46202077047466
lambda[   5] =  -0.40811004020781
lambda[   6] =  -0.40428866851664
lambda[   7] =  -0.35960999606061
lambda[   8] =  -0.30611004103855
lambda[   9] =  -0.23462829125828
lambda[  10] =  -0.18336892348474
lambda[  11] =  -0.02910602467236
lambda[  12] =   0.01157011869833
lambda[  13] =   0.01210974967541
lambda[  14] =   0.01658931093280
lambda[  15] =   0.02236906996646
lambda[  16] =   0.03269744401214
lambda[  17] =   0.03734184712620
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.134 ms
rank =  0, subspace rotation using ScaLAPACK took 4.827 ms
rank =  0, Distributing orbital back into band + domain format took 0.005 ms
rank = 0, Subspace_Rotation used 4.842 ms

Total time for subspace rotation: 4.843 ms
rank = 0, Efermi =  -0.058073716170 calculate fermi energy took 0.251 ms
rank = 0, --- Calculate rho: sum over local bands took 2.007 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1691.204 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
rank = 0, D2D took 0.503 ms
rank = 0, Transfering density took 0.512 ms
Etot    =   -30.351000063113
Eband   =    -9.031627756983
E1      =    21.249083223305
E2      =    -8.160047862155
E3      =   -11.940561942302
Exc     =   -10.455911318052
Esc     =   -52.213154015096
Entropy =    -0.000000000744
dE = 7.891e-07, dEband = 1.234e-04
rank = 0, Calculating/Estimating energy took 1.132 ms, Etot = -30.351000063, dEtot = 7.891e-07, dEband = 1.234e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0232800539137, which took 0.073 ms

iter_count = 102, r_2norm = 8.206e-07, tol*||rhs|| = 9.312e-07

Anderson update took 59.637 ms, out of which F'*F took 29.466 ms; b-Ax took 200.474 ms, out of which Lap took 178.918 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.736 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000002492775, int_rho =  20.00000002492759, int_b + int_rho = -1.528e-13, checking this took 0.118 ms
2-norm of RHS = 712.9182543044261, which took 0.127 ms

iter_count = 102, r_2norm = 7.091e-04, tol*||rhs|| = 7.129e-04

Anderson update took 62.356 ms, out of which F'*F took 31.554 ms; b-Ax took 195.529 ms, out of which Lap took 174.114 ms
Solving Poisson took 432.842 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.166868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.199532 
Total time for convolution: 	 convolve: 5.177518 
Total time for convolution: 	 convolve: 5.164603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.539 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27255.449 ms, scf error = 9.220e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.82782273091073, occ[   1] =   2.00000000000000
lambda[   2] =  -0.75608068911042, occ[   2] =   2.00000000000000
lambda[   3] =  -0.57377372706646, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46202077047466, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40811004020781, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40428866851664, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35960999606061, occ[   7] =   2.00000000000000
lambda[   8] =  -0.30611004103855, occ[   8] =   2.00000000000000
lambda[   9] =  -0.23462829125828, occ[   9] =   2.00000000000000
lambda[  10] =  -0.18336892348474, occ[  10] =   2.00000000000000
lambda[  11] =  -0.02910602467236, occ[  11] =   0.00000002492754
lambda[  12] =   0.01157011869833, occ[  12] =   0.00000000000000
lambda[  13] =   0.01210974967541, occ[  13] =   0.00000000000000
lambda[  14] =   0.01658931093280, occ[  14] =   0.00000000000000
lambda[  15] =   0.02236906996646, occ[  15] =   0.00000000000000
lambda[  16] =   0.03269744401214, occ[  16] =   0.00000000000000
lambda[  17] =   0.03734184712620, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.609 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.551 ms, time for Allreduce/Reduce: 7.913 ms 
Time for calculating local force components: 17.589 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.04073664846640  -0.00000001679122  -0.03120678815902
  0.04073662783263  -0.00000002342133  -0.03120676775512
 -0.05141980067499  -0.00427122290093   0.03763856182405
  0.05141980432971  -0.00427123574760   0.03763855913428
  0.05141999422843   0.00427121215833   0.03763871146158
 -0.05141999043699   0.00427121826600   0.03763870105799
 -0.00000020355415  -0.00000330253320  -0.10778934699949
 -0.00000073995847  -0.48826665242650  -0.44539065592588
 -0.00000039691954   0.48826753013029  -0.44539281395820
force_loc = 
  0.04362951797184  -0.00000003678235   0.03372954214950
 -0.04362979823117  -0.00000004664556   0.03372977534704
  0.05463864937363   0.00652477322132  -0.03898975759527
 -0.05463838196619   0.00652463763343  -0.03898967942227
 -0.05463763024854  -0.00652468589452  -0.03898915152934
  0.05463767547357  -0.00652460827579  -0.03898900863177
  0.00000124115682   0.00000028035603   0.10282916146892
  0.00000077810676   0.47524931699459   0.43398766593807
  0.00000052649665  -0.47524900536672   0.43398994949243
Time for calculating nonlocal force components: 28.924 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000006289481   0.00000008559933   0.00639249147325
[0m[32m  0.00000002520303   0.01343650767684   0.01088267083831
[0m[32m  0.00000002972134  -0.01343649353299   0.01088275433398
[0mTime for calculating XC forces components: 24.906 ms
 Cartesian force = 
  0.00289272035735   0.00000014290227   0.00251891237458
 -0.00289331954663   0.00000012640895   0.00251916597603
  0.00321869955056   0.00225374679623  -0.00135503738711
 -0.00321872678457   0.00225359836166  -0.00135496190389
 -0.00321778516820  -0.00225327726035  -0.00135428168366
  0.00321753588849  -0.00225319353395  -0.00135414918967
  0.00000095134940  -0.00000274010199   0.00142846432680
 -0.00000008579677   0.00041936872078  -0.00052416076539
  0.00000001015037  -0.00041777229358  -0.00052395174768
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.962 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Time for printing density: 394.435 ms
The program took 614.486 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:39:16
Job ID:        2267009
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:06:00,vmem=8444K,walltime=00:10:30,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-22-2
---------------------------------------
