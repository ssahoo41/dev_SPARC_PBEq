---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266532
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:07
Job ID:    2266532
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 16.975 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 29.406 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 36.220 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.961 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.106 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   10.752930	
   10.000000	   11.999389	    7.387906	
   10.000000	    8.000611	    7.387906	
   10.000000	   16.153339	    9.451882	
   10.000000	   14.610552	   12.612094	
   10.000000	    3.846661	    9.451882	
   10.000000	    5.389448	   12.612094	
   10.000000	   12.211463	    9.433699	
   10.000000	    7.788537	    9.433699	
   10.000000	   14.444789	   10.572737	
   10.000000	    5.555211	   10.572737	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 2.241 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.104 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.356 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.462 ms

Calculate_SplineDerivRadFun took 0.218 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.843 ms.
time spent on vectorized spline interp: 3.206 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.713 ms.
time spent on vectorized spline interp: 1.380 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.286 ms.
time spent on vectorized spline interp: 1.794 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.560 ms.

Calculating rb for all atom types took 15.793 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.043 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000242357, sum_int_rho = 27.3891092179001
PosCharge = 28.000000024236, NegCharge = -27.389109217900, scal_fac = 1.022304150218
After scaling, int_rho = 28.0000000242358, PosCharge + NegCharge - NetCharge = -1.492e-13
--Calculate Vref took 0.605 ms
--Calculate rho_guess took 3.287 ms

 integral of b = -28.0000000242357,
 int{b} + Nelectron + NetCharge = -2.424e-08,
 Esc = -74.1414186526479,
 MPI_Reduce took 10.110 ms

Calculating b & b_ref took 21.609 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.078 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.122 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.091 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.731 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.004 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.992 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423564, int_b + int_rho = 6.912e-14, checking this took 0.178 ms
2-norm of RHS = 787.1564963294825, which took 0.491 ms

iter_count = 420, r_2norm = 6.595e-04, tol*||rhs|| = 7.872e-04

Anderson update took 233.466 ms, out of which F'*F took 104.731 ms; b-Ax took 711.896 ms, out of which Lap took 639.138 ms
Solving Poisson took 1515.351 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
Total time for convolution: 	 convolve: 5.125637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.603 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.116592 
Total time for convolution: 	 convolve: 5.123487 
Total time for convolution: 	 convolve: 5.194843 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.692 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.458 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, XC calculation took 24536.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 4.915 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.970 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.980 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.158 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.633 ms
    Lanczos iter 53, eigmin  = -0.996933011, eigmax = 264.930953526, err_eigmin = 2.446e-03, err_eigmax = 9.692e-03
rank =   0, Lanczos took 122.717 ms, eigmin = -0.996933011135, eigmax = 267.580263061032

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.241665, lowerbound = -1.096933, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1459.414 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 106.259 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.799 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 109.079 ms
rank =  0, finding HY took 26.278 ms
rank =  0, distributing HY into block cyclic form took 20.012 ms
rank =  0, finding Y'*HY took 4.153 ms
Rank 0, Project_Hamiltonian used 159.584 ms
Total time for projection: 159.600 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.813 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.915 ms
    first calculated eigval = 2.712453314063589
    last  calculated eigval = 3.257400302565519
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.83548670428948
lambda[   6] =   2.85210879716165
lambda[   7] =   2.89521208875815
lambda[   8] =   2.91185986314353
lambda[   9] =   2.96222081267644
lambda[  10] =   2.97373567044118
lambda[  11] =   2.99580977480394
lambda[  12] =   3.01128023211435
lambda[  13] =   3.02788027591266
lambda[  14] =   3.03662046856709
lambda[  15] =   3.09438753758446
lambda[  16] =   3.10172252154763
lambda[  17] =   3.11605886517220
lambda[  18] =   3.14584345362111
lambda[  19] =   3.16912724401391
lambda[  20] =   3.22290952429654
lambda[  21] =   3.25740030256552
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.935 ms
rank =  0, subspace rotation using ScaLAPACK took 8.260 ms
rank =  0, Distributing orbital back into band + domain format took 18.399 ms
rank = 0, Subspace_Rotation used 26.676 ms

Total time for subspace rotation: 26.679 ms
rank = 0, Efermi =   3.065894823703 calculate fermi energy took 0.052 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.357400, lowerbound = -1.096933, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.571 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.443 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.529 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.993 ms
rank =  0, finding HY took 25.530 ms
rank =  0, distributing HY into block cyclic form took 18.452 ms
rank =  0, finding Y'*HY took 3.972 ms
Rank 0, Project_Hamiltonian used 68.974 ms
Total time for projection: 68.979 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.164 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.270 ms
    first calculated eigval = -0.890682386777887
    last  calculated eigval = 0.428101827190349
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.26624400076514
lambda[   6] =  -0.24121781295798
lambda[   7] =  -0.11261975941579
lambda[   8] =  -0.06718682195388
lambda[   9] =   0.05161662384261
lambda[  10] =   0.08492136618850
lambda[  11] =   0.12158726635614
lambda[  12] =   0.16346921041971
lambda[  13] =   0.25081029223564
lambda[  14] =   0.29004021637421
lambda[  15] =   0.30753015741421
lambda[  16] =   0.32743260478553
lambda[  17] =   0.34872448778477
lambda[  18] =   0.36429396135523
lambda[  19] =   0.38212341212438
lambda[  20] =   0.41371849610287
lambda[  21] =   0.42810182719035
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 8.245 ms
rank =  0, Distributing orbital back into band + domain format took 18.354 ms
rank = 0, Subspace_Rotation used 26.616 ms

Total time for subspace rotation: 26.620 ms
rank = 0, Efermi =   0.298785186744 calculate fermi energy took 0.026 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.528102, lowerbound = -1.096933, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1481.210 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.971 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.560 ms
rank =  0, finding HY took 25.493 ms
rank =  0, distributing HY into block cyclic form took 18.513 ms
rank =  0, finding Y'*HY took 4.034 ms
Rank 0, Project_Hamiltonian used 69.629 ms
Total time for projection: 69.633 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -1.021900197729934
    last  calculated eigval = 0.134508907218208
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60352103885182
lambda[   6] =  -0.55712330723643
lambda[   7] =  -0.51875639766983
lambda[   8] =  -0.47757682234577
lambda[   9] =  -0.46442851989323
lambda[  10] =  -0.43227720425784
lambda[  11] =  -0.39462249031045
lambda[  12] =  -0.33367071400692
lambda[  13] =  -0.32025495581240
lambda[  14] =  -0.20923458892728
lambda[  15] =  -0.02692679618388
lambda[  16] =   0.03124388217820
lambda[  17] =   0.03892267755587
lambda[  18] =   0.09597584051402
lambda[  19] =   0.10746267928053
lambda[  20] =   0.12504057834729
lambda[  21] =   0.13450890721821
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 8.275 ms
rank =  0, Distributing orbital back into band + domain format took 18.126 ms
rank = 0, Subspace_Rotation used 26.417 ms

Total time for subspace rotation: 26.421 ms
rank = 0, Efermi =  -0.055919943304 calculate fermi energy took 0.024 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.234509, lowerbound = -1.096933, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1479.423 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.412 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.471 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.904 ms
rank =  0, finding HY took 25.804 ms
rank =  0, distributing HY into block cyclic form took 18.399 ms
rank =  0, finding Y'*HY took 4.069 ms
Rank 0, Project_Hamiltonian used 69.210 ms
Total time for projection: 69.214 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.022025353278023
    last  calculated eigval = 0.089833271094827
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60992518606377
lambda[   6] =  -0.56090120655416
lambda[   7] =  -0.53849366266727
lambda[   8] =  -0.48584147832653
lambda[   9] =  -0.48186369977042
lambda[  10] =  -0.44143328965027
lambda[  11] =  -0.42029173648641
lambda[  12] =  -0.35046557434205
lambda[  13] =  -0.34086201804866
lambda[  14] =  -0.27333800747429
lambda[  15] =  -0.09457637040051
lambda[  16] =  -0.04529855885881
lambda[  17] =  -0.00878862391343
lambda[  18] =   0.03095677937943
lambda[  19] =   0.05273606086973
lambda[  20] =   0.06783095870842
lambda[  21] =   0.08983327109483
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.167 ms
rank =  0, Distributing orbital back into band + domain format took 18.637 ms
rank = 0, Subspace_Rotation used 26.841 ms

Total time for subspace rotation: 26.845 ms
rank = 0, Efermi =  -0.123569517524 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 8.047 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.151 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 6519.418 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.906 ms
rank = 0, D2D took 2.009 ms
rank = 0, Transfering density took 2.016 ms
Etot    =   -44.308995493818
Eband   =   -15.578404839782
E1      =    31.570449367114
E2      =   -12.155900939872
E3      =   -15.919133157633
Exc     =   -14.234655465283
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 4.028e+00, dEband = 1.416e+00
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -44.308995494, dEtot = 4.028e+00, dEband = 1.416e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 56.7666154734149, which took 1.249 ms

iter_count = 96, r_2norm = 1.867e-03, tol*||rhs|| = 2.271e-03

Anderson update took 51.414 ms, out of which F'*F took 23.954 ms; b-Ax took 164.236 ms, out of which Lap took 147.102 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423577, int_b + int_rho = 2.037e-13, checking this took 0.114 ms
2-norm of RHS = 783.2461207745844, which took 0.144 ms

iter_count = 276, r_2norm = 7.760e-04, tol*||rhs|| = 7.832e-04

Anderson update took 148.240 ms, out of which F'*F took 68.113 ms; b-Ax took 468.200 ms, out of which Lap took 415.345 ms
Solving Poisson took 990.196 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.414 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.227622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.257986 
Total time for convolution: 	 convolve: 5.327908 
Total time for convolution: 	 convolve: 5.216616 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.004 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.532 ms

This SCF took 33083.229 ms, scf error = 1.900e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189833, lowerbound = -1.022025, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1470.698 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 28.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.541 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 31.167 ms
rank =  0, finding HY took 25.218 ms
rank =  0, distributing HY into block cyclic form took 18.995 ms
rank =  0, finding Y'*HY took 3.949 ms
Rank 0, Project_Hamiltonian used 79.369 ms
Total time for projection: 79.395 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.241 ms
    first calculated eigval = -1.034941640024415
    last  calculated eigval = 0.066302967300893
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.58986016557942
lambda[   6] =  -0.53772482869293
lambda[   7] =  -0.50328146678324
lambda[   8] =  -0.45357069392283
lambda[   9] =  -0.44636747132939
lambda[  10] =  -0.42205673864652
lambda[  11] =  -0.41300274732436
lambda[  12] =  -0.35070662098209
lambda[  13] =  -0.31179933809536
lambda[  14] =  -0.25025577500480
lambda[  15] =  -0.07811017322873
lambda[  16] =  -0.05224067091329
lambda[  17] =  -0.02342663606087
lambda[  18] =   0.00619954820517
lambda[  19] =   0.02788922948123
lambda[  20] =   0.03629590478579
lambda[  21] =   0.06630296730089
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.769 ms
rank =  0, Distributing orbital back into band + domain format took 18.797 ms
rank = 0, Subspace_Rotation used 26.584 ms

Total time for subspace rotation: 26.587 ms
rank = 0, Efermi =  -0.107103320375 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.852 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1593.755 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.846 ms
rank = 0, D2D took 1.946 ms
rank = 0, Transfering density took 1.951 ms
Etot    =   -44.215159121810
Eband   =   -14.964673152863
E1      =    30.996736663460
E2      =   -12.177307302372
E3      =   -16.101406165786
Exc     =   -14.384517447195
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 8.531e-03, dEband = 5.579e-02
rank = 0, Calculating/Estimating energy took 1.009 ms, Etot = -44.215159122, dEtot = 8.531e-03, dEband = 5.579e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 30.8675436089963, which took 0.058 ms

iter_count = 96, r_2norm = 1.224e-03, tol*||rhs|| = 1.235e-03

Anderson update took 51.360 ms, out of which F'*F took 23.801 ms; b-Ax took 163.609 ms, out of which Lap took 145.306 ms
rank = 0, Mixing (+ precond) took 354.611 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423572, int_b + int_rho = 1.492e-13, checking this took 0.134 ms
2-norm of RHS = 777.9266636988234, which took 0.093 ms

iter_count = 288, r_2norm = 6.220e-04, tol*||rhs|| = 7.779e-04

Anderson update took 152.792 ms, out of which F'*F took 71.430 ms; b-Ax took 489.829 ms, out of which Lap took 435.886 ms
Solving Poisson took 1035.970 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.196278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.204874 
Total time for convolution: 	 convolve: 5.199098 
Total time for convolution: 	 convolve: 5.230691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.929 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.505 ms

This SCF took 27898.834 ms, scf error = 1.240e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.166303, lowerbound = -1.034942, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1499.247 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.383 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.009 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.409 ms
rank =  0, finding HY took 25.843 ms
rank =  0, distributing HY into block cyclic form took 20.314 ms
rank =  0, finding Y'*HY took 4.101 ms
Rank 0, Project_Hamiltonian used 72.704 ms
Total time for projection: 72.717 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -1.029001452430426
    last  calculated eigval = 0.048659396494749
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55942367640409
lambda[   6] =  -0.50081600018687
lambda[   7] =  -0.45533339061742
lambda[   8] =  -0.41006645628395
lambda[   9] =  -0.40533843987568
lambda[  10] =  -0.40051695316864
lambda[  11] =  -0.37060669908795
lambda[  12] =  -0.33010126653519
lambda[  13] =  -0.27612327508374
lambda[  14] =  -0.21559060292850
lambda[  15] =  -0.04653752588900
lambda[  16] =  -0.03285051556833
lambda[  17] =  -0.02609118927668
lambda[  18] =   0.00253775410540
lambda[  19] =   0.01691973604349
lambda[  20] =   0.02620199230561
lambda[  21] =   0.04865939649475
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.799 ms
rank =  0, Distributing orbital back into band + domain format took 18.996 ms
rank = 0, Subspace_Rotation used 26.811 ms

Total time for subspace rotation: 26.815 ms
rank = 0, Efermi =  -0.075530672903 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.381 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 1615.828 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.818 ms
rank = 0, D2D took 1.919 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -44.158039944866
Eband   =   -13.984900316413
E1      =    30.120675456800
E2      =   -12.070511145970
E3      =   -16.422737453481
Exc     =   -14.645645031333
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 5.193e-03, dEband = 8.907e-02
rank = 0, Calculating/Estimating energy took 0.922 ms, Etot = -44.158039945, dEtot = 5.193e-03, dEband = 8.907e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.7894119873555, which took 0.052 ms

iter_count = 102, r_2norm = 2.614e-04, tol*||rhs|| = 3.116e-04

Anderson update took 59.841 ms, out of which F'*F took 25.519 ms; b-Ax took 196.654 ms, out of which Lap took 178.680 ms
rank = 0, Mixing (+ precond) took 400.305 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423575, int_b + int_rho = 1.746e-13, checking this took 0.114 ms
2-norm of RHS = 775.9113838631005, which took 0.130 ms

iter_count = 282, r_2norm = 6.229e-04, tol*||rhs|| = 7.759e-04

Anderson update took 150.051 ms, out of which F'*F took 70.668 ms; b-Ax took 480.084 ms, out of which Lap took 428.972 ms
Solving Poisson took 1014.098 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.231988 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.711 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.190230 
Total time for convolution: 	 convolve: 5.197904 
Total time for convolution: 	 convolve: 5.186632 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.567 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.937 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.546 ms

This SCF took 28015.682 ms, scf error = 5.397e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.148659, lowerbound = -1.029001, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1496.415 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 19.011 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.619 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.652 ms
rank =  0, finding HY took 25.126 ms
rank =  0, distributing HY into block cyclic form took 18.569 ms
rank =  0, finding Y'*HY took 4.341 ms
Rank 0, Project_Hamiltonian used 69.728 ms
Total time for projection: 69.746 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.854 ms
rank = 0, Solve_Generalized_EigenProblem used 0.989 ms
    first calculated eigval = -1.011049820217713
    last  calculated eigval = 0.038991247938532
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.53824854531573
lambda[   6] =  -0.47785797601331
lambda[   7] =  -0.43259746485633
lambda[   8] =  -0.39301443354829
lambda[   9] =  -0.38128431231133
lambda[  10] =  -0.37974144266238
lambda[  11] =  -0.34916303095068
lambda[  12] =  -0.30997947718098
lambda[  13] =  -0.25909065610627
lambda[  14] =  -0.19930471073881
lambda[  15] =  -0.03152371069914
lambda[  16] =  -0.02775566791069
lambda[  17] =  -0.01980283631109
lambda[  18] =   0.00291343737323
lambda[  19] =   0.01370750853422
lambda[  20] =   0.02234460565441
lambda[  21] =   0.03899124793853
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.023 ms
rank =  0, subspace rotation using ScaLAPACK took 7.858 ms
rank =  0, Distributing orbital back into band + domain format took 19.345 ms
rank = 0, Subspace_Rotation used 27.220 ms

Total time for subspace rotation: 27.224 ms
rank = 0, Efermi =  -0.060527618533 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.321 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.612 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.696 ms
rank = 0, Calculating density took 1612.219 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.055 ms
rank = 0, D2D took 2.167 ms
rank = 0, Transfering density took 2.174 ms
Etot    =   -44.147590037306
Eband   =   -13.407793538720
E1      =    29.663356346636
E2      =   -11.920269708159
E3      =   -16.620200537810
Exc     =   -14.802204437818
Esc     =   -74.141418652648
Entropy =    -0.000000000725
dE = 9.500e-04, dEband = 5.246e-02
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -44.147590037, dEtot = 9.500e-04, dEband = 5.246e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.1540565597181, which took 0.057 ms

iter_count = 108, r_2norm = 8.787e-05, tol*||rhs|| = 1.262e-04

Anderson update took 57.940 ms, out of which F'*F took 26.881 ms; b-Ax took 186.070 ms, out of which Lap took 165.471 ms
rank = 0, Mixing (+ precond) took 397.480 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423583, int_b + int_rho = 2.583e-13, checking this took 0.098 ms
2-norm of RHS = 776.3214043148000, which took 0.136 ms

iter_count = 246, r_2norm = 7.306e-04, tol*||rhs|| = 7.763e-04

Anderson update took 131.238 ms, out of which F'*F took 61.318 ms; b-Ax took 416.230 ms, out of which Lap took 371.414 ms
Solving Poisson took 884.216 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.199329 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.260993 
Total time for convolution: 	 convolve: 5.241867 
Total time for convolution: 	 convolve: 5.246807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.541 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.103 ms

This SCF took 27928.880 ms, scf error = 1.652e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.138991, lowerbound = -1.011050, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1501.906 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.676 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.439 ms
rank =  0, finding HY took 24.864 ms
rank =  0, distributing HY into block cyclic form took 18.491 ms
rank =  0, finding Y'*HY took 4.053 ms
Rank 0, Project_Hamiltonian used 69.883 ms
Total time for projection: 69.897 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.007510525246863
    last  calculated eigval = 0.032745840847172
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.53320791586111
lambda[   6] =  -0.47238626145196
lambda[   7] =  -0.42721100171918
lambda[   8] =  -0.38971601786268
lambda[   9] =  -0.37591350688173
lambda[  10] =  -0.37401865805327
lambda[  11] =  -0.34311369533768
lambda[  12] =  -0.30612281639341
lambda[  13] =  -0.25530469607565
lambda[  14] =  -0.19586816041673
lambda[  15] =  -0.02842055321115
lambda[  16] =  -0.02792705342456
lambda[  17] =  -0.01715615599537
lambda[  18] =   0.00269283105412
lambda[  19] =   0.01293142847492
lambda[  20] =   0.02079810376942
lambda[  21] =   0.03274584084717
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.245 ms
rank =  0, subspace rotation using ScaLAPACK took 7.774 ms
rank =  0, Distributing orbital back into band + domain format took 19.408 ms
rank = 0, Subspace_Rotation used 27.198 ms

Total time for subspace rotation: 27.202 ms
rank = 0, Efermi =  -0.057820403704 calculate fermi energy took 0.608 ms
rank = 0, --- Calculate rho: sum over local bands took 5.381 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.760 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 1616.645 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.793 ms
rank = 0, D2D took 1.896 ms
rank = 0, Transfering density took 1.902 ms
Etot    =   -44.146452497403
Eband   =   -13.277063768894
E1      =    29.595422985911
E2      =   -11.847056018019
E3      =   -16.663290123805
Exc     =   -14.833739202859
Esc     =   -74.141418652648
Entropy =    -0.000000000738
dE = 1.034e-04, dEband = 1.188e-02
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -44.146452497, dEtot = 1.034e-04, dEband = 1.188e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9612524820294, which took 0.057 ms

iter_count = 114, r_2norm = 2.441e-05, tol*||rhs|| = 3.845e-05

Anderson update took 61.189 ms, out of which F'*F took 28.160 ms; b-Ax took 192.920 ms, out of which Lap took 172.827 ms
rank = 0, Mixing (+ precond) took 420.161 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423578, int_b + int_rho = 2.146e-13, checking this took 0.117 ms
2-norm of RHS = 776.9232522256697, which took 0.185 ms

iter_count = 234, r_2norm = 7.575e-04, tol*||rhs|| = 7.769e-04

Anderson update took 125.988 ms, out of which F'*F took 58.910 ms; b-Ax took 401.519 ms, out of which Lap took 359.297 ms
Solving Poisson took 842.422 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.214869 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.249586 
Total time for convolution: 	 convolve: 5.343038 
Total time for convolution: 	 convolve: 5.250031 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.938 ms

This SCF took 28045.886 ms, scf error = 7.463e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132746, lowerbound = -1.007511, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1497.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.544 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.674 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.239 ms
rank =  0, finding HY took 24.970 ms
rank =  0, distributing HY into block cyclic form took 18.497 ms
rank =  0, finding Y'*HY took 3.963 ms
Rank 0, Project_Hamiltonian used 69.703 ms
Total time for projection: 69.715 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.005814613124301
    last  calculated eigval = 0.028527369151433
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.53096615290645
lambda[   6] =  -0.46991760454878
lambda[   7] =  -0.42437674578075
lambda[   8] =  -0.38817240303063
lambda[   9] =  -0.37330775610908
lambda[  10] =  -0.37072523015796
lambda[  11] =  -0.33983297984402
lambda[  12] =  -0.30450209482042
lambda[  13] =  -0.25318126511404
lambda[  14] =  -0.19372392820450
lambda[  15] =  -0.02828180443738
lambda[  16] =  -0.02579182571658
lambda[  17] =  -0.01568154606908
lambda[  18] =   0.00275490012474
lambda[  19] =   0.01298825696385
lambda[  20] =   0.02023066521215
lambda[  21] =   0.02852736915143
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 7.823 ms
rank =  0, Distributing orbital back into band + domain format took 18.354 ms
rank = 0, Subspace_Rotation used 26.194 ms

Total time for subspace rotation: 26.199 ms
rank = 0, Efermi =  -0.057324769926 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.420 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 1610.637 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.815 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.932 ms
Etot    =   -44.146040402781
Eband   =   -13.210909193582
E1      =    29.578546310690
E2      =   -11.792738899426
E3      =   -16.677961711451
Exc     =   -14.842959477390
Esc     =   -74.141418652648
Entropy =    -0.000000000728
dE = 3.746e-05, dEband = 6.014e-03
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -44.146040403, dEtot = 3.746e-05, dEband = 6.014e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4646362101751, which took 0.079 ms

iter_count = 108, r_2norm = 1.665e-05, tol*||rhs|| = 1.859e-05

Anderson update took 59.442 ms, out of which F'*F took 26.848 ms; b-Ax took 184.069 ms, out of which Lap took 164.421 ms
rank = 0, Mixing (+ precond) took 398.823 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423586, int_b + int_rho = 2.874e-13, checking this took 0.077 ms
2-norm of RHS = 777.1747471262379, which took 0.141 ms

iter_count = 234, r_2norm = 7.585e-04, tol*||rhs|| = 7.772e-04

Anderson update took 126.209 ms, out of which F'*F took 58.960 ms; b-Ax took 402.341 ms, out of which Lap took 360.364 ms
Solving Poisson took 840.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.235959 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.194294 
Total time for convolution: 	 convolve: 5.208296 
Total time for convolution: 	 convolve: 5.196805 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 3.543 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.281 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.876 ms

This SCF took 27760.228 ms, scf error = 3.194e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128527, lowerbound = -1.005815, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1492.724 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.105 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.619 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.746 ms
rank =  0, finding HY took 25.059 ms
rank =  0, distributing HY into block cyclic form took 18.468 ms
rank =  0, finding Y'*HY took 3.952 ms
Rank 0, Project_Hamiltonian used 69.261 ms
Total time for projection: 69.273 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -1.001683637617102
    last  calculated eigval = 0.026875741332319
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52751939342556
lambda[   6] =  -0.46631316602053
lambda[   7] =  -0.42027419748176
lambda[   8] =  -0.38440092277139
lambda[   9] =  -0.36928618845618
lambda[  10] =  -0.36675548384883
lambda[  11] =  -0.33609965362562
lambda[  12] =  -0.30094015289391
lambda[  13] =  -0.24944460066835
lambda[  14] =  -0.18981450216702
lambda[  15] =  -0.02713021793347
lambda[  16] =  -0.02223492134901
lambda[  17] =  -0.01287089567547
lambda[  18] =   0.00369759257724
lambda[  19] =   0.01417610614106
lambda[  20] =   0.02057897829971
lambda[  21] =   0.02687574133232
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.809 ms
rank =  0, Distributing orbital back into band + domain format took 18.579 ms
rank = 0, Subspace_Rotation used 26.404 ms

Total time for subspace rotation: 26.409 ms
rank = 0, Efermi =  -0.056125972505 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.369 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.701 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1605.419 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -44.145789738926
Eband   =   -13.101895695081
E1      =    29.523359723979
E2      =   -11.733780174911
E3      =   -16.696426176218
Exc     =   -14.856041465582
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 2.279e-05, dEband = 9.910e-03
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -44.145789739, dEtot = 2.279e-05, dEband = 9.910e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2122869190627, which took 0.054 ms

iter_count = 114, r_2norm = 6.361e-06, tol*||rhs|| = 8.491e-06

Anderson update took 61.203 ms, out of which F'*F took 28.661 ms; b-Ax took 195.809 ms, out of which Lap took 175.589 ms
rank = 0, Mixing (+ precond) took 418.064 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423585, int_b + int_rho = 2.801e-13, checking this took 0.132 ms
2-norm of RHS = 777.2402112724046, which took 0.926 ms

iter_count = 210, r_2norm = 7.259e-04, tol*||rhs|| = 7.772e-04

Anderson update took 112.046 ms, out of which F'*F took 52.614 ms; b-Ax took 358.236 ms, out of which Lap took 320.968 ms
Solving Poisson took 754.985 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.261144 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.297525 
Total time for convolution: 	 convolve: 5.229989 
Total time for convolution: 	 convolve: 5.247294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 0.605 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.447 ms
---Transfer Veff_loc: D2D took 3.618 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.201 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.858 ms

This SCF took 27888.088 ms, scf error = 1.580e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.126876, lowerbound = -1.001684, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1471.833 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 44.063 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.671 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.758 ms
rank =  0, finding HY took 24.955 ms
rank =  0, distributing HY into block cyclic form took 18.464 ms
rank =  0, finding Y'*HY took 3.975 ms
Rank 0, Project_Hamiltonian used 94.186 ms
Total time for projection: 94.204 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -1.000430156675152
    last  calculated eigval = 0.026614811149263
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52619922707120
lambda[   6] =  -0.46493589220998
lambda[   7] =  -0.41886044405147
lambda[   8] =  -0.38311236945955
lambda[   9] =  -0.36785010203645
lambda[  10] =  -0.36543386392695
lambda[  11] =  -0.33478097821948
lambda[  12] =  -0.29976324016258
lambda[  13] =  -0.24794972269091
lambda[  14] =  -0.18848376132500
lambda[  15] =  -0.02603360274450
lambda[  16] =  -0.02076965160608
lambda[  17] =  -0.01164961369554
lambda[  18] =   0.00502442039198
lambda[  19] =   0.01556498565007
lambda[  20] =   0.02087778106549
lambda[  21] =   0.02661481114926
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.271 ms
rank =  0, subspace rotation using ScaLAPACK took 7.787 ms
rank =  0, Distributing orbital back into band + domain format took 18.319 ms
rank = 0, Subspace_Rotation used 26.121 ms

Total time for subspace rotation: 26.126 ms
rank = 0, Efermi =  -0.055028371947 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.462 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.790 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 1609.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.907 ms
rank = 0, Transfering density took 1.914 ms
Etot    =   -44.145743303980
Eband   =   -13.063625107184
E1      =    29.506024403920
E2      =   -11.711885211866
E3      =   -16.699483155626
Exc     =   -14.858092314837
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 4.221e-06, dEband = 3.479e-03
rank = 0, Calculating/Estimating energy took 1.095 ms, Etot = -44.145743304, dEtot = 4.221e-06, dEband = 3.479e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1399044465674, which took 0.057 ms

iter_count = 114, r_2norm = 3.995e-06, tol*||rhs|| = 5.596e-06

Anderson update took 61.931 ms, out of which F'*F took 28.209 ms; b-Ax took 194.199 ms, out of which Lap took 173.818 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.045 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423576, int_b + int_rho = 1.855e-13, checking this took 0.098 ms
2-norm of RHS = 777.2104626202060, which took 0.132 ms

iter_count = 204, r_2norm = 7.670e-04, tol*||rhs|| = 7.772e-04

Anderson update took 109.563 ms, out of which F'*F took 51.515 ms; b-Ax took 348.345 ms, out of which Lap took 312.808 ms
Solving Poisson took 732.492 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.206308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.200998 
Total time for convolution: 	 convolve: 5.247420 
Total time for convolution: 	 convolve: 5.256373 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.016 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.637 ms

This SCF took 27733.046 ms, scf error = 1.008e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126615, lowerbound = -1.000430, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1465.053 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 45.282 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.620 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.925 ms
rank =  0, finding HY took 25.002 ms
rank =  0, distributing HY into block cyclic form took 18.290 ms
rank =  0, finding Y'*HY took 4.125 ms
Rank 0, Project_Hamiltonian used 95.378 ms
Total time for projection: 95.392 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.109 ms
rank = 0, Solve_Generalized_EigenProblem used 0.264 ms
    first calculated eigval = -0.999032345500371
    last  calculated eigval = 0.027907373437850
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52485069936012
lambda[   6] =  -0.46351829831317
lambda[   7] =  -0.41723630488246
lambda[   8] =  -0.38171709649578
lambda[   9] =  -0.36626226060726
lambda[  10] =  -0.36380193090440
lambda[  11] =  -0.33324255559617
lambda[  12] =  -0.29836562425778
lambda[  13] =  -0.24647503417847
lambda[  14] =  -0.18692431876861
lambda[  15] =  -0.02400693580332
lambda[  16] =  -0.01928257886694
lambda[  17] =  -0.01011511244736
lambda[  18] =   0.00792719134245
lambda[  19] =   0.01801741609502
lambda[  20] =   0.02221714572211
lambda[  21] =   0.02790737343785
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 7.831 ms
rank =  0, Distributing orbital back into band + domain format took 18.457 ms
rank = 0, Subspace_Rotation used 26.306 ms

Total time for subspace rotation: 26.310 ms
rank = 0, Efermi =  -0.053003326549 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.364 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.615 ms
rank = 0, Calculating density took 1603.817 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 1.946 ms
Etot    =   -44.145706750069
Eband   =   -13.021393845598
E1      =    29.483461965847
E2      =   -11.691180660354
E3      =   -16.704069324127
Exc     =   -14.861606201426
Esc     =   -74.141418652648
Entropy =    -0.000000000724
dE = 3.323e-06, dEband = 3.839e-03
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -44.145706750, dEtot = 3.323e-06, dEband = 3.839e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0797397608199, which took 0.058 ms

iter_count = 114, r_2norm = 2.163e-06, tol*||rhs|| = 3.190e-06

Anderson update took 60.951 ms, out of which F'*F took 28.503 ms; b-Ax took 194.566 ms, out of which Lap took 174.157 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.878 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423594, int_b + int_rho = 3.711e-13, checking this took 0.108 ms
2-norm of RHS = 777.2093733822246, which took 0.125 ms

iter_count = 198, r_2norm = 6.322e-04, tol*||rhs|| = 7.772e-04

Anderson update took 105.679 ms, out of which F'*F took 50.522 ms; b-Ax took 338.656 ms, out of which Lap took 303.309 ms
Solving Poisson took 712.527 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.198359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.195583 
Total time for convolution: 	 convolve: 5.203857 
Total time for convolution: 	 convolve: 5.198064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.589 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.046 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.671 ms

This SCF took 27586.969 ms, scf error = 6.637e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127907, lowerbound = -0.999032, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1473.842 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 44.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.615 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.494 ms
rank =  0, finding HY took 24.966 ms
rank =  0, distributing HY into block cyclic form took 18.328 ms
rank =  0, finding Y'*HY took 4.079 ms
Rank 0, Project_Hamiltonian used 94.902 ms
Total time for projection: 94.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -0.998262894435603
    last  calculated eigval = 0.029935811411062
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52413949672552
lambda[   6] =  -0.46281375143780
lambda[   7] =  -0.41654048764881
lambda[   8] =  -0.38094841070302
lambda[   9] =  -0.36558159382340
lambda[  10] =  -0.36309094791800
lambda[  11] =  -0.33252912333755
lambda[  12] =  -0.29765282927192
lambda[  13] =  -0.24577329813549
lambda[  14] =  -0.18623375677629
lambda[  15] =  -0.02160267970344
lambda[  16] =  -0.01853446284976
lambda[  17] =  -0.00903726359899
lambda[  18] =   0.01108146450075
lambda[  19] =   0.02032942852967
lambda[  20] =   0.02402453161113
lambda[  21] =   0.02993581141106
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 7.699 ms
rank =  0, Distributing orbital back into band + domain format took 18.405 ms
rank = 0, Subspace_Rotation used 26.118 ms

Total time for subspace rotation: 26.123 ms
rank = 0, Efermi =  -0.050621022624 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.727 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 1612.001 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.921 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -44.145689506323
Eband   =   -13.001534904072
E1      =    29.475069994981
E2      =   -11.679640190086
E3      =   -16.704455041459
Exc     =   -14.861901175403
Esc     =   -74.141418652648
Entropy =    -0.000000000727
dE = 1.568e-06, dEband = 1.805e-03
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -44.145689506, dEtot = 1.568e-06, dEband = 1.805e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0621786236728, which took 0.058 ms

iter_count = 114, r_2norm = 1.718e-06, tol*||rhs|| = 2.487e-06

Anderson update took 60.476 ms, out of which F'*F took 28.492 ms; b-Ax took 194.860 ms, out of which Lap took 174.260 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.607 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423584, int_b + int_rho = 2.728e-13, checking this took 0.153 ms
2-norm of RHS = 777.2081643201952, which took 0.160 ms

iter_count = 168, r_2norm = 7.661e-04, tol*||rhs|| = 7.772e-04

Anderson update took 90.079 ms, out of which F'*F took 42.436 ms; b-Ax took 287.543 ms, out of which Lap took 258.102 ms
Solving Poisson took 606.387 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.233191 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.202172 
Total time for convolution: 	 convolve: 5.197427 
Total time for convolution: 	 convolve: 5.201014 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.614 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.024 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.675 ms

This SCF took 27522.684 ms, scf error = 4.242e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129936, lowerbound = -0.998263, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1489.730 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 23.791 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.484 ms
rank =  0, finding HY took 24.965 ms
rank =  0, distributing HY into block cyclic form took 18.457 ms
rank =  0, finding Y'*HY took 3.974 ms
Rank 0, Project_Hamiltonian used 73.918 ms
Total time for projection: 73.939 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -0.997654906659021
    last  calculated eigval = 0.030327749898085
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52359895419973
lambda[   6] =  -0.46225774447960
lambda[   7] =  -0.41591038079324
lambda[   8] =  -0.38037510853530
lambda[   9] =  -0.36495458835929
lambda[  10] =  -0.36248081958909
lambda[  11] =  -0.33194722656985
lambda[  12] =  -0.29710193090181
lambda[  13] =  -0.24519649046559
lambda[  14] =  -0.18564290128813
lambda[  15] =  -0.02090427296450
lambda[  16] =  -0.01803801458399
lambda[  17] =  -0.00862190733293
lambda[  18] =   0.01098122635737
lambda[  19] =   0.02029594594129
lambda[  20] =   0.02467856534649
lambda[  21] =   0.03032774989808
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 7.804 ms
rank =  0, Distributing orbital back into band + domain format took 18.616 ms
rank = 0, Subspace_Rotation used 26.456 ms

Total time for subspace rotation: 26.460 ms
rank = 0, Efermi =  -0.049929467694 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.260 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.453 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.618 ms
rank = 0, Calculating density took 1607.856 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.824 ms
rank = 0, D2D took 1.922 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -44.145765239344
Eband   =   -12.984893315762
E1      =    29.465580526821
E2      =   -11.672009532474
E3      =   -16.706505129330
Exc     =   -14.863548458832
Esc     =   -74.141418652648
Entropy =    -0.000000000727
dE = 6.885e-06, dEband = 1.513e-03
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -44.145765239, dEtot = 6.885e-06, dEband = 1.513e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0451789694524, which took 0.087 ms

iter_count = 114, r_2norm = 1.141e-06, tol*||rhs|| = 1.807e-06

Anderson update took 60.816 ms, out of which F'*F took 28.507 ms; b-Ax took 194.064 ms, out of which Lap took 173.659 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.326 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423581, int_b + int_rho = 2.365e-13, checking this took 0.075 ms
2-norm of RHS = 777.2204160196829, which took 0.131 ms

iter_count = 174, r_2norm = 6.769e-04, tol*||rhs|| = 7.772e-04

Anderson update took 93.712 ms, out of which F'*F took 43.805 ms; b-Ax took 297.560 ms, out of which Lap took 267.134 ms
Solving Poisson took 627.259 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.215861 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.207291 
Total time for convolution: 	 convolve: 5.202441 
Total time for convolution: 	 convolve: 5.224701 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.035 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.591 ms

This SCF took 27559.075 ms, scf error = 3.037e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130328, lowerbound = -0.997655, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1465.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 41.794 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.617 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 44.433 ms
rank =  0, finding HY took 24.905 ms
rank =  0, distributing HY into block cyclic form took 18.421 ms
rank =  0, finding Y'*HY took 3.928 ms
Rank 0, Project_Hamiltonian used 91.762 ms
Total time for projection: 91.783 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.997225348294438
    last  calculated eigval = 0.032936744206487
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52318330820312
lambda[   6] =  -0.46184289131893
lambda[   7] =  -0.41546922412955
lambda[   8] =  -0.37994507093425
lambda[   9] =  -0.36452184019959
lambda[  10] =  -0.36203603209749
lambda[  11] =  -0.33150753069837
lambda[  12] =  -0.29670542838861
lambda[  13] =  -0.24475799531158
lambda[  14] =  -0.18521832553099
lambda[  15] =  -0.01841276788394
lambda[  16] =  -0.01761899017206
lambda[  17] =  -0.00805623607246
lambda[  18] =   0.01276320241713
lambda[  19] =   0.02209963897304
lambda[  20] =   0.02660884184975
lambda[  21] =   0.03293674420649
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 7.731 ms
rank =  0, Distributing orbital back into band + domain format took 19.204 ms
rank = 0, Subspace_Rotation used 26.952 ms

Total time for subspace rotation: 26.958 ms
rank = 0, Efermi =  -0.047713350596 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1601.771 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.897 ms
rank = 0, D2D took 1.998 ms
rank = 0, Transfering density took 2.004 ms
Etot    =   -44.145807368807
Eband   =   -12.972914442338
E1      =    29.460271401386
E2      =   -11.665284982823
E3      =   -16.706767964496
Exc     =   -14.863798621788
Esc     =   -74.141418652648
Entropy =    -0.000000000737
dE = 3.830e-06, dEband = 1.089e-03
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -44.145807369, dEtot = 3.830e-06, dEband = 1.089e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0380495589560, which took 0.053 ms

iter_count = 114, r_2norm = 1.053e-06, tol*||rhs|| = 1.522e-06

Anderson update took 62.352 ms, out of which F'*F took 28.656 ms; b-Ax took 193.304 ms, out of which Lap took 173.414 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.651 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423579, int_b + int_rho = 2.219e-13, checking this took 0.106 ms
2-norm of RHS = 777.2222520836782, which took 0.142 ms

iter_count = 138, r_2norm = 7.048e-04, tol*||rhs|| = 7.772e-04

Anderson update took 74.330 ms, out of which F'*F took 34.953 ms; b-Ax took 234.061 ms, out of which Lap took 210.476 ms
Solving Poisson took 497.515 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.171412 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.825 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.200775 
Total time for convolution: 	 convolve: 5.197667 
Total time for convolution: 	 convolve: 5.204662 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.796 ms

This SCF took 27361.633 ms, scf error = 1.913e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132937, lowerbound = -0.997225, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1473.038 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 41.456 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.628 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 44.104 ms
rank =  0, finding HY took 24.949 ms
rank =  0, distributing HY into block cyclic form took 18.259 ms
rank =  0, finding Y'*HY took 4.092 ms
Rank 0, Project_Hamiltonian used 91.440 ms
Total time for projection: 91.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.997032828733260
    last  calculated eigval = 0.033360350266264
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52302626415270
lambda[   6] =  -0.46169015857202
lambda[   7] =  -0.41531220000926
lambda[   8] =  -0.37976402346022
lambda[   9] =  -0.36436368064979
lambda[  10] =  -0.36188672310355
lambda[  11] =  -0.33136267614525
lambda[  12] =  -0.29653695837089
lambda[  13] =  -0.24460189104355
lambda[  14] =  -0.18505953842142
lambda[  15] =  -0.01791215884043
lambda[  16] =  -0.01748948040306
lambda[  17] =  -0.00793693584459
lambda[  18] =   0.01281533309247
lambda[  19] =   0.02238795471770
lambda[  20] =   0.02709376725765
lambda[  21] =   0.03336035026626
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 7.751 ms
rank =  0, Distributing orbital back into band + domain format took 18.865 ms
rank = 0, Subspace_Rotation used 26.632 ms

Total time for subspace rotation: 26.637 ms
rank = 0, Efermi =  -0.047338703932 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.283 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1608.210 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.799 ms
rank = 0, D2D took 1.891 ms
rank = 0, Transfering density took 1.894 ms
Etot    =   -44.145833966379
Eband   =   -12.968371640741
E1      =    29.457956435452
E2      =   -11.662965467555
E3      =   -16.707088035464
Exc     =   -14.864053610723
Esc     =   -74.141418652648
Entropy =    -0.000000000738
dE = 2.418e-06, dEband = 4.130e-04
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -44.145833966, dEtot = 2.418e-06, dEband = 4.130e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0277019845467, which took 0.050 ms

iter_count = 114, r_2norm = 7.565e-07, tol*||rhs|| = 1.108e-06

Anderson update took 62.067 ms, out of which F'*F took 28.322 ms; b-Ax took 193.682 ms, out of which Lap took 173.698 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.475 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423576, int_b + int_rho = 1.855e-13, checking this took 0.100 ms
2-norm of RHS = 777.2242000239301, which took 0.137 ms

iter_count = 150, r_2norm = 7.088e-04, tol*||rhs|| = 7.772e-04

Anderson update took 81.612 ms, out of which F'*F took 37.753 ms; b-Ax took 256.415 ms, out of which Lap took 229.968 ms
Solving Poisson took 539.806 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.195379 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.202250 
Total time for convolution: 	 convolve: 5.220540 
Total time for convolution: 	 convolve: 5.192463 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.622 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.039 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.697 ms

This SCF took 27467.712 ms, scf error = 1.559e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133360, lowerbound = -0.997033, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.300 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 31.193 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 33.778 ms
rank =  0, finding HY took 25.121 ms
rank =  0, distributing HY into block cyclic form took 18.252 ms
rank =  0, finding Y'*HY took 4.065 ms
Rank 0, Project_Hamiltonian used 81.248 ms
Total time for projection: 81.284 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.193 ms
rank = 0, Solve_Generalized_EigenProblem used 1.330 ms
    first calculated eigval = -0.996834149641709
    last  calculated eigval = 0.033371427079341
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52285329644319
lambda[   6] =  -0.46152563572527
lambda[   7] =  -0.41515119826340
lambda[   8] =  -0.37957058997666
lambda[   9] =  -0.36419891727851
lambda[  10] =  -0.36173253903703
lambda[  11] =  -0.33121079918189
lambda[  12] =  -0.29635357016956
lambda[  13] =  -0.24443616234578
lambda[  14] =  -0.18489586646049
lambda[  15] =  -0.01767578814841
lambda[  16] =  -0.01737555952397
lambda[  17] =  -0.00791258963325
lambda[  18] =   0.01257048628162
lambda[  19] =   0.02233477860996
lambda[  20] =   0.02773218976951
lambda[  21] =   0.03337142707934
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.348 ms
rank =  0, subspace rotation using ScaLAPACK took 7.843 ms
rank =  0, Distributing orbital back into band + domain format took 18.310 ms
rank = 0, Subspace_Rotation used 26.169 ms

Total time for subspace rotation: 26.175 ms
rank = 0, Efermi =  -0.047151580551 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.457 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.719 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 1603.053 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.822 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.930 ms
Etot    =   -44.145882096342
Eband   =   -12.963591293630
E1      =    29.455688006639
E2      =   -11.660381889224
E3      =   -16.707208270090
Exc     =   -14.864150315279
Esc     =   -74.141418652648
Entropy =    -0.000000000738
dE = 4.375e-06, dEband = 4.346e-04
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -44.145882096, dEtot = 4.375e-06, dEband = 4.346e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0162385742320, which took 0.057 ms

iter_count = 114, r_2norm = 4.370e-07, tol*||rhs|| = 6.495e-07

Anderson update took 62.762 ms, out of which F'*F took 28.691 ms; b-Ax took 194.149 ms, out of which Lap took 173.811 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.884 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423575, int_b + int_rho = 1.819e-13, checking this took 0.108 ms
2-norm of RHS = 777.2229570126914, which took 0.127 ms

iter_count = 126, r_2norm = 7.604e-04, tol*||rhs|| = 7.772e-04

Anderson update took 68.268 ms, out of which F'*F took 31.765 ms; b-Ax took 214.829 ms, out of which Lap took 192.625 ms
Solving Poisson took 454.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.236681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.197246 
Total time for convolution: 	 convolve: 5.313041 
Total time for convolution: 	 convolve: 5.188997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.567 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.246 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.848 ms

This SCF took 27462.479 ms, scf error = 1.057e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133371, lowerbound = -0.996834, upperbound = 267.580263

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1476.853 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 31.872 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.605 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.527 ms
rank =  0, finding HY took 25.049 ms
rank =  0, distributing HY into block cyclic form took 18.375 ms
rank =  0, finding Y'*HY took 3.966 ms
Rank 0, Project_Hamiltonian used 81.951 ms
Total time for projection: 81.968 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.996774005512421
    last  calculated eigval = 0.033887061052144
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52277049257667
lambda[   6] =  -0.46144365322813
lambda[   7] =  -0.41506965330600
lambda[   8] =  -0.37950319208799
lambda[   9] =  -0.36411518707121
lambda[  10] =  -0.36164994599773
lambda[  11] =  -0.33112636099346
lambda[  12] =  -0.29628044127740
lambda[  13] =  -0.24436042724593
lambda[  14] =  -0.18482533366491
lambda[  15] =  -0.01732776492693
lambda[  16] =  -0.01688109903727
lambda[  17] =  -0.00793393265770
lambda[  18] =   0.01270232257896
lambda[  19] =   0.02328646789493
lambda[  20] =   0.02858124608779
lambda[  21] =   0.03388706105214
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 7.776 ms
rank =  0, Distributing orbital back into band + domain format took 18.337 ms
rank = 0, Subspace_Rotation used 26.129 ms

Total time for subspace rotation: 26.133 ms
rank = 0, Efermi =  -0.046745125402 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.230 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.804 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1601.982 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.028 ms
rank = 0, Transfering density took 2.033 ms
Etot    =   -44.145902501548
Eband   =   -12.961437147352
E1      =    29.454638115506
E2      =   -11.659256420513
E3      =   -16.707245528930
Exc     =   -14.864186765758
Esc     =   -74.141418652648
Entropy =    -0.000000000738
dE = 1.855e-06, dEband = 1.958e-04
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -44.145902502, dEtot = 1.855e-06, dEband = 1.958e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0124244058311, which took 0.051 ms

iter_count = 114, r_2norm = 3.157e-07, tol*||rhs|| = 4.970e-07

Anderson update took 61.881 ms, out of which F'*F took 28.534 ms; b-Ax took 193.971 ms, out of which Lap took 173.839 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002423557, int_rho =  28.00000002423590, int_b + int_rho = 3.311e-13, checking this took 0.103 ms
2-norm of RHS = 777.2244635226640, which took 0.094 ms

iter_count = 102, r_2norm = 7.453e-04, tol*||rhs|| = 7.772e-04

Anderson update took 54.697 ms, out of which F'*F took 25.825 ms; b-Ax took 173.815 ms, out of which Lap took 156.060 ms
Solving Poisson took 368.088 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 6.274654 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.390507 
Total time for convolution: 	 convolve: 5.186437 
Total time for convolution: 	 convolve: 5.234179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.614 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.277 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.931 ms

This SCF took 28565.826 ms, scf error = 7.698e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.52277049257667, occ[   5] =   2.00000000000000
lambda[   6] =  -0.46144365322813, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41506965330600, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37950319208799, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36411518707121, occ[   9] =   2.00000000000000
lambda[  10] =  -0.36164994599773, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33112636099346, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29628044127740, occ[  12] =   2.00000000000000
lambda[  13] =  -0.24436042724593, occ[  13] =   2.00000000000000
lambda[  14] =  -0.18482533366491, occ[  14] =   2.00000000000000
lambda[  15] =  -0.01732776492693, occ[  15] =   0.00000001511095
lambda[  16] =  -0.01688109903727, occ[  16] =   0.00000000912479
lambda[  17] =  -0.00793393265770, occ[  17] =   0.00000000000008
lambda[  18] =   0.01270232257896, occ[  18] =   0.00000000000000
lambda[  19] =   0.02328646789493, occ[  19] =   0.00000000000000
lambda[  20] =   0.02858124608779, occ[  20] =   0.00000000000000
lambda[  21] =   0.03388706105214, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.724 ms, time for Allreduce/Reduce: 11.302 ms 
Time for calculating local force components: 23.455 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000173380611  -0.00000120295078  -1.01875630798801
  0.00000003241702   0.00386395609195   0.05161327840436
  0.00000003549058  -0.00386398519190   0.05161330314476
  0.00000003508260  -0.04317070532877   0.02799634232160
  0.00000001902997  -0.00415635984809  -0.05110672874693
  0.00000009272192   0.04317067800165   0.02799633925347
  0.00000010303743   0.00415630968920  -0.05110672178801
  0.00000094661183  -0.21873372051017   0.09769689793125
  0.00000092986526   0.21873294860252   0.09769664644822
  0.00000236131089  -0.01583221495035  -0.01313495808467
 -0.00000003548053   0.01583182836131  -0.01313528875473
force_loc = 
  0.00000229584196   0.00000263651871   0.99456943314392
 -0.00000008531762  -0.00400117701259  -0.05406249301427
 -0.00000017871769   0.00400108446479  -0.05406224208938
  0.00000029758671   0.04431164672913  -0.02908031198180
 -0.00000006482576   0.00466499040300   0.05350064875746
 -0.00000003439641  -0.04431138898183  -0.02908033726852
 -0.00000044009327  -0.00466470409331   0.05350027183481
 -0.00000173819222   0.20336036495307  -0.10211917018613
 -0.00000117574112  -0.20336064652285  -0.10211852958858
 -0.00000171872478   0.02687685220308   0.01912056962491
 -0.00000436015958  -0.02687412446665   0.01911974142436
Time for calculating nonlocal force components: 40.212 ms
[32mforces_xc: 
[0m[32m  0.00000009412558   0.00000008475175   0.03167596226529
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000006958097   0.01286899330416  -0.00202008437853
[0m[32m -0.00000004063099  -0.01286901106428  -0.00202009863191
[0m[32m -0.00000006247894  -0.00453363298049  -0.00213349059770
[0m[32m -0.00000020431184   0.00453376436443  -0.00213353521209
[0mTime for calculating XC forces components: 34.624 ms
 Cartesian force = 
  0.00000423574854   0.00000122154361   0.00748643867182
  0.00000005907430  -0.00013751769670  -0.00245186335929
 -0.00000003125221   0.00013680249683  -0.00245158769400
  0.00000044464421   0.00114064462429  -0.00108661840958
  0.00000006617910   0.00050833377885   0.00239127126115
  0.00000017030041  -0.00114100775624  -0.00108664676443
 -0.00000022508094  -0.00050869118017   0.00239090129742
 -0.00000074918646  -0.00250465902901  -0.00644500538279
 -0.00000017453196   0.00250299423932  -0.00644463052164
  0.00000069208207   0.00651070749619   0.00384947219316
 -0.00000448797705  -0.00650882851697   0.00384826870817
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Time for printing density: 398.661 ms
The program took 449.813 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:38
Job ID:        2266532
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:36,vmem=8288K,walltime=00:07:48,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-16-2
---------------------------------------
