---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:52
Job ID:    2266886
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:56
Job ID:    2266886
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 10.401 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 5.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8

Reading ion file took 0.694 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 6.283 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.923 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.105 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.188048	   11.188048	   11.188048	
    8.811952	    8.811952	   11.188048	
    8.811952	   11.188048	    8.811952	
   11.188048	    8.811952	    8.811952	
   10.000000	   10.000000	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.176 ms
Set up communicators.

--set up spincomm took 2.213 ms

--set up kptcomm took 0.372 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 9, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.019 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 9 
rank =  0, my blacs rank = 0, BLCYC size (250000, 3), actual size (250000, 3)
rank = 0, mb = nb = 9, mbQ = nbQ = 64
rank = 0, nr_Hp = 9, nc_Hp = 9
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.070 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 3
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.038 ms

Calculate_SplineDerivRadFun took 0.109 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.796 ms.
time spent on vectorized spline interp: 3.165 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.561 ms.
time spent on vectorized spline interp: 1.709 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.493 ms.

Calculating rb for all atom types took 11.734 ms
----------------------
Estimated memory usage
Total: 688.18 MB
orbitals             : 411.99 MB
global sized vectors : 213.62 MB
subspace matrices : 7.59 kB
others : 62.56 MB
----------------------------------------------
Estimated memory usage per processor: 57.35 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.058 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -8.0000000119240, sum_int_rho = 7.6046701976726
PosCharge = 8.000000011924, NegCharge = -7.604670197673, scal_fac = 1.051985135972
After scaling, int_rho = 8.0000000119241, PosCharge + NegCharge - NetCharge = -9.592e-14
--Calculate Vref took 0.153 ms
--Calculate rho_guess took 0.798 ms

 integral of b = -8.0000000119240,
 int{b} + Nelectron + NetCharge = -1.192e-08,
 Esc = -16.1676879380850,
 MPI_Reduce took 1.539 ms

Calculating b & b_ref took 6.042 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.085 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.094 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.008 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.078 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.014 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 16.510 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192409, int_b + int_rho = 2.728e-14, checking this took 0.177 ms
2-norm of RHS = 516.6616763521581, which took 0.831 ms

iter_count = 420, r_2norm = 4.046e-04, tol*||rhs|| = 5.167e-04

Anderson update took 233.343 ms, out of which F'*F took 105.669 ms; b-Ax took 713.018 ms, out of which Lap took 641.420 ms
Solving Poisson took 1516.567 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
Total time for convolution: 	 convolve: 5.099308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.319 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
Total time for convolution: 	 convolve: 5.102910 
Total time for convolution: 	 convolve: 5.100218 
Total time for convolution: 	 convolve: 5.095280 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.717 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, XC calculation took 24283.893 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.562 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.166 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.852 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.133 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.728 ms
    Lanczos iter 53, eigmin  = -0.749846691, eigmax = 264.918757820, err_eigmin = 1.125e-04, err_eigmax = 9.630e-03
rank =   0, Lanczos took 122.170 ms, eigmin = -0.749846690692, eigmax = 267.567945398166

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.359049, lowerbound = -0.849847, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 684.681 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 16.550 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.316 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 18.901 ms
rank =  0, finding HY took 12.679 ms
rank =  0, distributing HY into block cyclic form took 6.796 ms
rank =  0, finding Y'*HY took 3.218 ms
Rank 0, Project_Hamiltonian used 41.636 ms
Total time for projection: 41.653 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.470 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.553 ms
    first calculated eigval = 2.853792377295148
    last  calculated eigval = 3.168806471428976
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =   2.85379237729515
lambda[   2] =   2.91114266499091
lambda[   3] =   2.96249451565536
lambda[   4] =   2.98790738513316
lambda[   5] =   3.02955084657594
lambda[   6] =   3.07216080464599
lambda[   7] =   3.09894135421918
lambda[   8] =   3.15198195655614
lambda[   9] =   3.16880647142898
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.569 ms
rank =  0, subspace rotation using ScaLAPACK took 2.311 ms
rank =  0, Distributing orbital back into band + domain format took 6.928 ms
rank = 0, Subspace_Rotation used 9.256 ms

Total time for subspace rotation: 9.260 ms
rank = 0, Efermi =   3.008729234615 calculate fermi energy took 0.057 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.268806, lowerbound = -0.849847, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 706.131 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.097 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.139 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 9.257 ms
rank =  0, finding HY took 11.934 ms
rank =  0, distributing HY into block cyclic form took 7.025 ms
rank =  0, finding Y'*HY took 2.229 ms
Rank 0, Project_Hamiltonian used 31.021 ms
Total time for projection: 31.036 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.268992802189679
    last  calculated eigval = 0.427805219604689
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.26899280218968
lambda[   2] =  -0.05983528591974
lambda[   3] =   0.23069857526689
lambda[   4] =   0.31872963643273
lambda[   5] =   0.33273990655632
lambda[   6] =   0.37456262792571
lambda[   7] =   0.38566737418321
lambda[   8] =   0.40468735410880
lambda[   9] =   0.42780521960469
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.183 ms
rank =  0, Distributing orbital back into band + domain format took 6.980 ms
rank = 0, Subspace_Rotation used 9.179 ms

Total time for subspace rotation: 9.182 ms
rank = 0, Efermi =   0.325734771591 calculate fermi energy took 0.040 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.527805, lowerbound = -0.849847, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 693.006 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.177 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.239 ms
rank =  0, finding HY took 11.980 ms
rank =  0, distributing HY into block cyclic form took 6.999 ms
rank =  0, finding Y'*HY took 2.650 ms
Rank 0, Project_Hamiltonian used 30.895 ms
Total time for projection: 30.900 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.748050939040768
    last  calculated eigval = 0.153612424628766
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.74805093904077
lambda[   2] =  -0.45445757421013
lambda[   3] =  -0.43339621265068
lambda[   4] =  -0.40476287758422
lambda[   5] =   0.08770373306572
lambda[   6] =   0.09443687990188
lambda[   7] =   0.12526170936051
lambda[   8] =   0.13916961714433
lambda[   9] =   0.15361242462877
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 2.201 ms
rank =  0, Distributing orbital back into band + domain format took 6.983 ms
rank = 0, Subspace_Rotation used 9.199 ms

Total time for subspace rotation: 9.203 ms
rank = 0, Efermi =   0.058075648068 calculate fermi energy took 0.034 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.253612, lowerbound = -0.849847, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 706.694 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.131 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.118 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.147 ms
rank =  0, Distribute data + matrix mult took 9.410 ms
rank =  0, finding HY took 12.034 ms
rank =  0, distributing HY into block cyclic form took 6.999 ms
rank =  0, finding Y'*HY took 2.627 ms
Rank 0, Project_Hamiltonian used 32.004 ms
Total time for projection: 32.011 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.051 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.750272725840775
    last  calculated eigval = 0.086059453514873
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.75027272584078
lambda[   2] =  -0.45961151249035
lambda[   3] =  -0.45937562757242
lambda[   4] =  -0.45924050842810
lambda[   5] =   0.02679968699186
lambda[   6] =   0.05874891983737
lambda[   7] =   0.06664132125399
lambda[   8] =   0.07544842573887
lambda[   9] =   0.08605945351487
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 2.212 ms
rank =  0, Distributing orbital back into band + domain format took 6.943 ms
rank = 0, Subspace_Rotation used 9.170 ms

Total time for subspace rotation: 9.173 ms
rank = 0, Efermi =  -0.002828202900 calculate fermi energy took 0.023 ms
rank = 0, --- Calculate rho: sum over local bands took 1.496 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.366 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.178 ms
rank = 0, Calculating density took 3093.676 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.706 ms
rank = 0, D2D took 0.836 ms
rank = 0, Transfering density took 0.844 ms
Etot    =    -8.475490543751
Eband   =    -4.257000748344
E1      =     8.719759835934
E2      =    -2.694942312906
E3      =    -3.876396163626
Exc     =    -3.341900169425
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.695e+00, dEband = 8.514e-01
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -8.475490544, dEtot = 1.695e+00, dEband = 8.514e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 28.3101012196468, which took 0.867 ms

iter_count = 96, r_2norm = 1.027e-03, tol*||rhs|| = 1.132e-03

Anderson update took 51.853 ms, out of which F'*F took 24.596 ms; b-Ax took 167.193 ms, out of which Lap took 149.458 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.835 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192413, int_b + int_rho = 6.730e-14, checking this took 0.117 ms
2-norm of RHS = 513.5599849341273, which took 0.131 ms

iter_count = 282, r_2norm = 4.783e-04, tol*||rhs|| = 5.136e-04

Anderson update took 155.243 ms, out of which F'*F took 70.333 ms; b-Ax took 477.262 ms, out of which Lap took 428.320 ms
Solving Poisson took 1013.954 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.094958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.224 ms
Total time for convolution: 	 convolve: 5.103114 
Total time for convolution: 	 convolve: 5.104324 
Total time for convolution: 	 convolve: 5.091588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.975 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.814 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.809 ms

This SCF took 28826.004 ms, scf error = 2.366e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186059, lowerbound = -0.750273, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 705.196 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.130 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 9.304 ms
rank =  0, finding HY took 11.817 ms
rank =  0, distributing HY into block cyclic form took 6.438 ms
rank =  0, finding Y'*HY took 3.873 ms
Rank 0, Project_Hamiltonian used 31.928 ms
Total time for projection: 31.940 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.712859036413517
    last  calculated eigval = 0.054040263991935
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.71285903641352
lambda[   2] =  -0.42653281441767
lambda[   3] =  -0.42638413886252
lambda[   4] =  -0.42628289123348
lambda[   5] =  -0.01370467002603
lambda[   6] =   0.02981279784092
lambda[   7] =   0.04685045902949
lambda[   8] =   0.05022982806030
lambda[   9] =   0.05404026399194
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 2.144 ms
rank =  0, Distributing orbital back into band + domain format took 6.965 ms
rank = 0, Subspace_Rotation used 9.124 ms

Total time for subspace rotation: 9.128 ms
rank = 0, Efermi =  -0.043332559892 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.404 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.408 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 751.493 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.680 ms
rank = 0, D2D took 0.875 ms
rank = 0, Transfering density took 0.879 ms
Etot    =    -8.447961937727
Eband   =    -3.984117762018
E1      =     8.468648880282
E2      =    -2.686498318019
E3      =    -3.954798517452
Exc     =    -3.406101953014
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 5.506e-03, dEband = 5.458e-02
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -8.447961938, dEtot = 5.506e-03, dEband = 5.458e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 10.2507852242434, which took 0.051 ms

iter_count = 102, r_2norm = 3.276e-04, tol*||rhs|| = 4.100e-04

Anderson update took 54.567 ms, out of which F'*F took 25.495 ms; b-Ax took 175.642 ms, out of which Lap took 155.860 ms
rank = 0, Mixing (+ precond) took 375.598 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192411, int_b + int_rho = 4.820e-14, checking this took 0.127 ms
2-norm of RHS = 508.7696611477456, which took 0.124 ms

iter_count = 294, r_2norm = 4.942e-04, tol*||rhs|| = 5.088e-04

Anderson update took 156.488 ms, out of which F'*F took 74.267 ms; b-Ax took 502.898 ms, out of which Lap took 449.774 ms
Solving Poisson took 1056.500 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.808 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.701 ms
Total time for convolution: 	 convolve: 5.143198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.871 ms
Total time for convolution: 	 convolve: 5.183098 
Total time for convolution: 	 convolve: 5.140578 
Total time for convolution: 	 convolve: 5.171637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.166 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.799 ms

This SCF took 26918.448 ms, scf error = 1.634e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.154040, lowerbound = -0.712859, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 683.914 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.123 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 9.691 ms
rank =  0, finding HY took 11.895 ms
rank =  0, distributing HY into block cyclic form took 7.118 ms
rank =  0, finding Y'*HY took 2.595 ms
Rank 0, Project_Hamiltonian used 31.771 ms
Total time for projection: 31.785 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.064 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.654317476509865
    last  calculated eigval = 0.041656586596868
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.65431747650986
lambda[   2] =  -0.37407106933085
lambda[   3] =  -0.37398039444784
lambda[   4] =  -0.37393413368246
lambda[   5] =  -0.02885876666237
lambda[   6] =   0.01964083948872
lambda[   7] =   0.03359414832281
lambda[   8] =   0.03694088678938
lambda[   9] =   0.04165658659687
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 2.125 ms
rank =  0, Distributing orbital back into band + domain format took 6.973 ms
rank = 0, Subspace_Rotation used 9.114 ms

Total time for subspace rotation: 9.119 ms
rank = 0, Efermi =  -0.058486656547 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.344 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.436 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 730.030 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
rank = 0, D2D took 0.862 ms
rank = 0, Transfering density took 0.867 ms
Etot    =    -8.427720327900
Eband   =    -3.552606148286
E1      =     8.077601529485
E2      =    -2.637420544532
E3      =    -4.107179968129
Exc     =    -3.529628283311
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 4.048e-03, dEband = 8.630e-02
rank = 0, Calculating/Estimating energy took 1.016 ms, Etot = -8.427720328, dEtot = 4.048e-03, dEband = 8.630e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9512638679457, which took 0.055 ms

iter_count = 108, r_2norm = 6.649e-05, tol*||rhs|| = 7.805e-05

Anderson update took 58.369 ms, out of which F'*F took 27.212 ms; b-Ax took 185.914 ms, out of which Lap took 166.250 ms
rank = 0, Mixing (+ precond) took 397.907 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192413, int_b + int_rho = 6.366e-14, checking this took 0.100 ms
2-norm of RHS = 507.6647170133426, which took 0.105 ms

iter_count = 276, r_2norm = 4.350e-04, tol*||rhs|| = 5.077e-04

Anderson update took 145.626 ms, out of which F'*F took 72.824 ms; b-Ax took 476.003 ms, out of which Lap took 427.397 ms
Solving Poisson took 991.983 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.190511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.869 ms
Total time for convolution: 	 convolve: 5.195722 
Total time for convolution: 	 convolve: 5.146136 
Total time for convolution: 	 convolve: 5.142927 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.382 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.804 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.774 ms

This SCF took 26805.377 ms, scf error = 6.413e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.141657, lowerbound = -0.654317, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 683.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.057 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.146 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 9.229 ms
rank =  0, finding HY took 11.917 ms
rank =  0, distributing HY into block cyclic form took 7.008 ms
rank =  0, finding Y'*HY took 2.623 ms
Rank 0, Project_Hamiltonian used 30.810 ms
Total time for projection: 30.822 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.056 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.640058729035869
    last  calculated eigval = 0.034629026191391
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.64005872903587
lambda[   2] =  -0.35952115666812
lambda[   3] =  -0.35948322853184
lambda[   4] =  -0.35946935135361
lambda[   5] =  -0.03374207249013
lambda[   6] =   0.01662305650794
lambda[   7] =   0.02526532161910
lambda[   8] =   0.02867963074051
lambda[   9] =   0.03462902619139
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.153 ms
rank =  0, Distributing orbital back into band + domain format took 7.011 ms
rank = 0, Subspace_Rotation used 9.176 ms

Total time for subspace rotation: 9.182 ms
rank = 0, Efermi =  -0.063369962373 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.649 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 728.761 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.629 ms
rank = 0, D2D took 0.837 ms
rank = 0, Transfering density took 0.840 ms
Etot    =    -8.424329078520
Eband   =    -3.437064931581
E1      =     7.990653988641
E2      =    -2.598600454992
E3      =    -4.165521272661
Exc     =    -3.574351924784
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 6.782e-04, dEband = 2.311e-02
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -8.424329079, dEtot = 6.782e-04, dEband = 2.311e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8771037618758, which took 0.110 ms

iter_count = 108, r_2norm = 3.349e-05, tol*||rhs|| = 3.508e-05

Anderson update took 57.411 ms, out of which F'*F took 26.752 ms; b-Ax took 181.816 ms, out of which Lap took 162.857 ms
rank = 0, Mixing (+ precond) took 393.126 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192409, int_b + int_rho = 3.183e-14, checking this took 0.103 ms
2-norm of RHS = 507.6874287743099, which took 0.103 ms

iter_count = 240, r_2norm = 4.444e-04, tol*||rhs|| = 5.077e-04

Anderson update took 128.469 ms, out of which F'*F took 59.915 ms; b-Ax took 406.576 ms, out of which Lap took 363.589 ms
Solving Poisson took 860.565 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.161475 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.996 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.164947 
Total time for convolution: 	 convolve: 5.158767 
Total time for convolution: 	 convolve: 5.149312 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.232 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.531 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.377 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.838 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.812 ms

This SCF took 26693.365 ms, scf error = 1.258e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134629, lowerbound = -0.640059, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 701.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.447 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.740 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 9.213 ms
rank =  0, finding HY took 12.028 ms
rank =  0, distributing HY into block cyclic form took 6.949 ms
rank =  0, finding Y'*HY took 2.686 ms
Rank 0, Project_Hamiltonian used 31.425 ms
Total time for projection: 31.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.061 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.636477783340199
    last  calculated eigval = 0.029619588115220
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.63647778334020
lambda[   2] =  -0.35597734892621
lambda[   3] =  -0.35594996187037
lambda[   4] =  -0.35594327142127
lambda[   5] =  -0.03522383142865
lambda[   6] =   0.01595858279666
lambda[   7] =   0.02125462085218
lambda[   8] =   0.02423708448370
lambda[   9] =   0.02961958811522
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 2.165 ms
rank =  0, Distributing orbital back into band + domain format took 7.003 ms
rank = 0, Subspace_Rotation used 9.182 ms

Total time for subspace rotation: 9.187 ms
rank = 0, Efermi =  -0.064851721263 calculate fermi energy took 1.579 ms
rank = 0, --- Calculate rho: sum over local bands took 2.043 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.858 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.155 ms
rank = 0, Calculating density took 748.398 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
rank = 0, D2D took 0.857 ms
rank = 0, Transfering density took 0.861 ms
Etot    =    -8.424039975993
Eband   =    -3.408696731536
E1      =     7.974207288998
E2      =    -2.583946531788
E3      =    -4.176659240552
Exc     =    -3.582468367346
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 5.782e-05, dEband = 5.674e-03
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -8.424039976, dEtot = 5.782e-05, dEband = 5.674e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2760092564525, which took 0.048 ms

iter_count = 108, r_2norm = 1.093e-05, tol*||rhs|| = 1.104e-05

Anderson update took 57.090 ms, out of which F'*F took 26.681 ms; b-Ax took 182.477 ms, out of which Lap took 163.427 ms
rank = 0, Mixing (+ precond) took 394.610 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192412, int_b + int_rho = 5.730e-14, checking this took 0.104 ms
2-norm of RHS = 508.1087435179796, which took 0.098 ms

iter_count = 258, r_2norm = 4.042e-04, tol*||rhs|| = 5.081e-04

Anderson update took 137.825 ms, out of which F'*F took 64.824 ms; b-Ax took 440.688 ms, out of which Lap took 395.894 ms
Solving Poisson took 923.414 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.163389 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.815 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.153171 
Total time for convolution: 	 convolve: 5.152801 
Total time for convolution: 	 convolve: 5.184639 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.301 ms

This SCF took 26771.329 ms, scf error = 7.703e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129620, lowerbound = -0.636478, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 688.272 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.926 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.139 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 12.089 ms
rank =  0, finding HY took 12.166 ms
rank =  0, distributing HY into block cyclic form took 6.958 ms
rank =  0, finding Y'*HY took 2.719 ms
Rank 0, Project_Hamiltonian used 33.963 ms
Total time for projection: 33.972 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.060 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.629676825634861
    last  calculated eigval = 0.026789855464960
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62967682563486
lambda[   2] =  -0.34955945230779
lambda[   3] =  -0.34955484053613
lambda[   4] =  -0.34954727513480
lambda[   5] =  -0.03384633955707
lambda[   6] =   0.01725553909436
lambda[   7] =   0.02045017307705
lambda[   8] =   0.02302801659823
lambda[   9] =   0.02678985546496
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.128 ms
rank =  0, Distributing orbital back into band + domain format took 6.904 ms
rank = 0, Subspace_Rotation used 9.084 ms

Total time for subspace rotation: 9.090 ms
rank = 0, Efermi =  -0.063474229439 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.842 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.017 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 737.307 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 0.844 ms
rank = 0, Transfering density took 0.852 ms
Etot    =    -8.423912014107
Eband   =    -3.356676787631
E1      =     7.949712060683
E2      =    -2.552622692579
E3      =    -4.189362797929
Exc     =    -3.591244839219
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 2.559e-05, dEband = 1.040e-02
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -8.423912014, dEtot = 2.559e-05, dEband = 1.040e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1806472641773, which took 0.053 ms

iter_count = 108, r_2norm = 5.472e-06, tol*||rhs|| = 7.226e-06

Anderson update took 58.068 ms, out of which F'*F took 26.569 ms; b-Ax took 182.039 ms, out of which Lap took 163.202 ms
rank = 0, Mixing (+ precond) took 394.862 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192408, int_b + int_rho = 1.819e-14, checking this took 0.109 ms
2-norm of RHS = 508.0729043649294, which took 0.119 ms

iter_count = 240, r_2norm = 4.002e-04, tol*||rhs|| = 5.081e-04

Anderson update took 128.492 ms, out of which F'*F took 59.383 ms; b-Ax took 407.929 ms, out of which Lap took 366.385 ms
Solving Poisson took 857.493 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.142 ms
Total time for convolution: 	 convolve: 5.158753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.163521 
Total time for convolution: 	 convolve: 5.165066 
Total time for convolution: 	 convolve: 5.161984 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.997 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.362 ms

This SCF took 26637.319 ms, scf error = 2.684e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.126790, lowerbound = -0.629677, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 691.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.084 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.142 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 9.252 ms
rank =  0, finding HY took 11.971 ms
rank =  0, distributing HY into block cyclic form took 7.015 ms
rank =  0, finding Y'*HY took 2.694 ms
Rank 0, Project_Hamiltonian used 30.967 ms
Total time for projection: 30.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.056 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.625054346695586
    last  calculated eigval = 0.027168814764870
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62505434669559
lambda[   2] =  -0.34514748398490
lambda[   3] =  -0.34514608150271
lambda[   4] =  -0.34514552960889
lambda[   5] =  -0.02903884668186
lambda[   6] =   0.02204993490238
lambda[   7] =   0.02372771752825
lambda[   8] =   0.02538522603645
lambda[   9] =   0.02716881476487
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.112 ms
rank =  0, Distributing orbital back into band + domain format took 6.974 ms
rank = 0, Subspace_Rotation used 9.099 ms

Total time for subspace rotation: 9.105 ms
rank = 0, Efermi =  -0.058666736586 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.861 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.069 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 737.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.671 ms
rank = 0, D2D took 0.848 ms
rank = 0, Transfering density took 0.851 ms
Etot    =    -8.423883817831
Eband   =    -3.320986883930
E1      =     7.929320396237
E2      =    -2.535632356036
E3      =    -4.196820512661
Exc     =    -3.596982260387
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 5.639e-06, dEband = 7.138e-03
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -8.423883818, dEtot = 5.639e-06, dEband = 7.138e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0970099691506, which took 0.049 ms

iter_count = 108, r_2norm = 3.438e-06, tol*||rhs|| = 3.880e-06

Anderson update took 57.303 ms, out of which F'*F took 26.645 ms; b-Ax took 182.051 ms, out of which Lap took 162.491 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.237 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192410, int_b + int_rho = 4.366e-14, checking this took 0.107 ms
2-norm of RHS = 508.0917451959343, which took 0.099 ms

iter_count = 204, r_2norm = 4.406e-04, tol*||rhs|| = 5.081e-04

Anderson update took 108.111 ms, out of which F'*F took 50.977 ms; b-Ax took 342.749 ms, out of which Lap took 305.948 ms
Solving Poisson took 730.255 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.132 ms
Total time for convolution: 	 convolve: 5.169338 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.331 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.159168 
Total time for convolution: 	 convolve: 5.154662 
Total time for convolution: 	 convolve: 5.159828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 0.983 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.346 ms

This SCF took 26520.694 ms, scf error = 1.956e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.127169, lowerbound = -0.625054, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 674.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.086 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.156 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.262 ms
rank =  0, finding HY took 12.564 ms
rank =  0, distributing HY into block cyclic form took 6.698 ms
rank =  0, finding Y'*HY took 2.993 ms
Rank 0, Project_Hamiltonian used 31.553 ms
Total time for projection: 31.565 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.050 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.625444578500402
    last  calculated eigval = 0.026892904885023
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62544457850040
lambda[   2] =  -0.34541611295052
lambda[   3] =  -0.34541501255875
lambda[   4] =  -0.34541182018066
lambda[   5] =  -0.02714116831780
lambda[   6] =   0.02404129990617
lambda[   7] =   0.02510350198129
lambda[   8] =   0.02633830108646
lambda[   9] =   0.02689290488502
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.048 ms
rank =  0, Distributing orbital back into band + domain format took 7.004 ms
rank = 0, Subspace_Rotation used 9.064 ms

Total time for subspace rotation: 9.069 ms
rank = 0, Efermi =  -0.056769058214 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.813 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.981 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 720.281 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.605 ms
rank = 0, D2D took 1.009 ms
rank = 0, Transfering density took 1.013 ms
Etot    =    -8.423880412399
Eband   =    -3.323375048704
E1      =     7.932816311121
E2      =    -2.535040858727
E3      =    -4.194731353194
Exc     =    -3.595405948287
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 6.811e-07, dEband = 4.776e-04
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -8.423880412, dEtot = 6.811e-07, dEband = 4.776e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0594441665709, which took 0.048 ms

iter_count = 108, r_2norm = 1.498e-06, tol*||rhs|| = 2.378e-06

Anderson update took 57.549 ms, out of which F'*F took 27.242 ms; b-Ax took 184.116 ms, out of which Lap took 165.549 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.919 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192410, int_b + int_rho = 3.729e-14, checking this took 0.098 ms
2-norm of RHS = 508.1013364695384, which took 0.117 ms

iter_count = 204, r_2norm = 4.399e-04, tol*||rhs|| = 5.081e-04

Anderson update took 108.305 ms, out of which F'*F took 51.618 ms; b-Ax took 348.748 ms, out of which Lap took 313.144 ms
Solving Poisson took 732.492 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.898 ms
Total time for convolution: 	 convolve: 5.159889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.664 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.156910 
Total time for convolution: 	 convolve: 5.152395 
Total time for convolution: 	 convolve: 5.155251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.683 ms

This SCF took 26484.646 ms, scf error = 9.893e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126893, lowerbound = -0.625445, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 707.991 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 7.253 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.205 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.481 ms
rank =  0, finding HY took 11.902 ms
rank =  0, distributing HY into block cyclic form took 6.961 ms
rank =  0, finding Y'*HY took 2.695 ms
Rank 0, Project_Hamiltonian used 31.072 ms
Total time for projection: 31.087 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.062 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.624264680162866
    last  calculated eigval = 0.032384434322451
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62426468016287
lambda[   2] =  -0.34425121596162
lambda[   3] =  -0.34424768350912
lambda[   4] =  -0.34424698217917
lambda[   5] =  -0.02129237127635
lambda[   6] =   0.02808031288806
lambda[   7] =   0.03157685548996
lambda[   8] =   0.03220853074926
lambda[   9] =   0.03238443432245
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 2.046 ms
rank =  0, Distributing orbital back into band + domain format took 7.003 ms
rank = 0, Subspace_Rotation used 9.062 ms

Total time for subspace rotation: 9.068 ms
rank = 0, Efermi =  -0.050920261123 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.917 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.884 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.183 ms
rank = 0, Calculating density took 753.516 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.662 ms
rank = 0, D2D took 0.862 ms
rank = 0, Transfering density took 0.866 ms
Etot    =    -8.423915384606
Eband   =    -3.314021123879
E1      =     7.927864855386
E2      =    -2.530289101731
E3      =    -4.196528504246
Exc     =    -3.596888783641
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 6.994e-06, dEband = 1.871e-03
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -8.423915385, dEtot = 6.994e-06, dEband = 1.871e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0530097618972, which took 0.052 ms

iter_count = 108, r_2norm = 1.328e-06, tol*||rhs|| = 2.120e-06

Anderson update took 57.214 ms, out of which F'*F took 27.202 ms; b-Ax took 184.253 ms, out of which Lap took 165.015 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192409, int_b + int_rho = 3.092e-14, checking this took 0.115 ms
2-norm of RHS = 508.1304535973767, which took 0.109 ms

iter_count = 180, r_2norm = 4.399e-04, tol*||rhs|| = 5.081e-04

Anderson update took 95.714 ms, out of which F'*F took 44.601 ms; b-Ax took 306.775 ms, out of which Lap took 275.357 ms
Solving Poisson took 647.620 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.160893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.160834 
Total time for convolution: 	 convolve: 6.874551 
Total time for convolution: 	 convolve: 5.156001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.959 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.232 ms

This SCF took 28165.197 ms, scf error = 7.607e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132384, lowerbound = -0.624265, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 716.482 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.065 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.164 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.251 ms
rank =  0, finding HY took 11.940 ms
rank =  0, distributing HY into block cyclic form took 7.017 ms
rank =  0, finding Y'*HY took 2.666 ms
Rank 0, Project_Hamiltonian used 30.905 ms
Total time for projection: 30.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.049 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.624415839155258
    last  calculated eigval = 0.033204406593795
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62441583915526
lambda[   2] =  -0.34439199300521
lambda[   3] =  -0.34438988819325
lambda[   4] =  -0.34438916545366
lambda[   5] =  -0.02127246969885
lambda[   6] =   0.02731751386623
lambda[   7] =   0.03183969371397
lambda[   8] =   0.03217608671014
lambda[   9] =   0.03320440659379
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.140 ms
rank =  0, subspace rotation using ScaLAPACK took 2.045 ms
rank =  0, Distributing orbital back into band + domain format took 6.972 ms
rank = 0, Subspace_Rotation used 9.031 ms

Total time for subspace rotation: 9.036 ms
rank = 0, Efermi =  -0.050900359535 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.804 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.013 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 761.663 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.647 ms
rank = 0, D2D took 0.855 ms
rank = 0, Transfering density took 0.860 ms
Etot    =    -8.423961541882
Eband   =    -3.315173771868
E1      =     7.929354760542
E2      =    -2.530191472311
E3      =    -4.195347598285
Exc     =    -3.595993662702
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 9.231e-06, dEband = 2.305e-04
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -8.423961542, dEtot = 9.231e-06, dEband = 2.305e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0511563972506, which took 0.051 ms

iter_count = 108, r_2norm = 1.365e-06, tol*||rhs|| = 2.046e-06

Anderson update took 57.003 ms, out of which F'*F took 26.720 ms; b-Ax took 182.151 ms, out of which Lap took 163.038 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 392.962 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192411, int_b + int_rho = 4.911e-14, checking this took 0.103 ms
2-norm of RHS = 508.1171224657624, which took 0.111 ms

iter_count = 144, r_2norm = 4.830e-04, tol*||rhs|| = 5.081e-04

Anderson update took 76.583 ms, out of which F'*F took 35.842 ms; b-Ax took 243.493 ms, out of which Lap took 218.523 ms
Solving Poisson took 518.337 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.161443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.167120 
Total time for convolution: 	 convolve: 5.160014 
Total time for convolution: 	 convolve: 5.155492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.050 ms
---Transfer Veff_loc: D2D took 1.799 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.155 ms

This SCF took 26330.544 ms, scf error = 1.037e-03
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133204, lowerbound = -0.624416, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 697.798 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.076 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.139 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.239 ms
rank =  0, finding HY took 12.264 ms
rank =  0, distributing HY into block cyclic form took 6.958 ms
rank =  0, finding Y'*HY took 2.694 ms
Rank 0, Project_Hamiltonian used 31.187 ms
Total time for projection: 31.200 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.053 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.624076662546323
    last  calculated eigval = 0.033458024788899
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62407666254632
lambda[   2] =  -0.34407434713112
lambda[   3] =  -0.34407190478477
lambda[   4] =  -0.34407120436074
lambda[   5] =  -0.02086378381902
lambda[   6] =   0.02678421516752
lambda[   7] =   0.03216709404797
lambda[   8] =   0.03233712512846
lambda[   9] =   0.03345802478890
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 2.061 ms
rank =  0, Distributing orbital back into band + domain format took 6.949 ms
rank = 0, Subspace_Rotation used 9.024 ms

Total time for subspace rotation: 9.029 ms
rank = 0, Efermi =  -0.050491673688 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.790 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.076 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 743.357 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.832 ms
rank = 0, Transfering density took 0.835 ms
Etot    =    -8.423961531850
Eband   =    -3.312588237895
E1      =     7.927473821910
E2      =    -2.529269062021
E3      =    -4.196297390433
Exc     =    -3.596725629870
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 2.007e-09, dEband = 5.171e-04
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -8.423961532, dEtot = 2.007e-09, dEband = 5.171e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0293149068395, which took 0.061 ms

iter_count = 102, r_2norm = 1.108e-06, tol*||rhs|| = 1.173e-06

Anderson update took 54.065 ms, out of which F'*F took 25.655 ms; b-Ax took 174.151 ms, out of which Lap took 155.891 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.821 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192410, int_b + int_rho = 3.638e-14, checking this took 0.103 ms
2-norm of RHS = 508.1138953573517, which took 0.063 ms

iter_count = 168, r_2norm = 4.854e-04, tol*||rhs|| = 5.081e-04

Anderson update took 89.506 ms, out of which F'*F took 41.756 ms; b-Ax took 284.329 ms, out of which Lap took 254.760 ms
Solving Poisson took 602.474 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.163791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.166330 
Total time for convolution: 	 convolve: 5.158714 
Total time for convolution: 	 convolve: 5.172470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.046 ms
---Transfer Veff_loc: D2D took 1.765 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.358 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.147 ms

This SCF took 26396.925 ms, scf error = 6.247e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133458, lowerbound = -0.624077, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 687.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.023 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.216 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.260 ms
rank =  0, finding HY took 12.012 ms
rank =  0, distributing HY into block cyclic form took 7.002 ms
rank =  0, finding Y'*HY took 2.664 ms
Rank 0, Project_Hamiltonian used 30.967 ms
Total time for projection: 30.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.059 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.623972893749465
    last  calculated eigval = 0.036117436056845
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62397289374947
lambda[   2] =  -0.34397196132117
lambda[   3] =  -0.34397095560470
lambda[   4] =  -0.34396978973826
lambda[   5] =  -0.02013668872902
lambda[   6] =   0.02687060125623
lambda[   7] =   0.03260131883183
lambda[   8] =   0.03330380135241
lambda[   9] =   0.03611743605685
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 2.043 ms
rank =  0, Distributing orbital back into band + domain format took 6.966 ms
rank = 0, Subspace_Rotation used 9.022 ms

Total time for subspace rotation: 9.027 ms
rank = 0, Efermi =  -0.049764578622 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.846 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.008 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.169 ms
rank = 0, Calculating density took 732.515 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.645 ms
rank = 0, D2D took 0.844 ms
rank = 0, Transfering density took 0.848 ms
Etot    =    -8.424015266486
Eband   =    -3.311771201067
E1      =     7.927168969177
E2      =    -2.528707971766
E3      =    -4.196220915607
Exc     =    -3.596653983519
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.075e-05, dEband = 1.634e-04
rank = 0, Calculating/Estimating energy took 0.956 ms, Etot = -8.424015266, dEtot = 1.075e-05, dEband = 1.634e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0503391742705, which took 0.072 ms

iter_count = 102, r_2norm = 1.184e-06, tol*||rhs|| = 2.014e-06

Anderson update took 53.916 ms, out of which F'*F took 25.499 ms; b-Ax took 174.871 ms, out of which Lap took 156.852 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.210 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192413, int_b + int_rho = 6.730e-14, checking this took 0.081 ms
2-norm of RHS = 508.1102170749634, which took 0.151 ms

iter_count = 162, r_2norm = 4.624e-04, tol*||rhs|| = 5.081e-04

Anderson update took 86.028 ms, out of which F'*F took 40.042 ms; b-Ax took 274.473 ms, out of which Lap took 245.751 ms
Solving Poisson took 581.160 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.162794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.170393 
Total time for convolution: 	 convolve: 5.152897 
Total time for convolution: 	 convolve: 5.162790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 0.991 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.362 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.379 ms

This SCF took 26353.292 ms, scf error = 6.145e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136117, lowerbound = -0.623973, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 698.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.011 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.171 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 9.222 ms
rank =  0, finding HY took 11.887 ms
rank =  0, distributing HY into block cyclic form took 7.046 ms
rank =  0, finding Y'*HY took 2.625 ms
Rank 0, Project_Hamiltonian used 30.812 ms
Total time for projection: 30.825 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.623532855522525
    last  calculated eigval = 0.036421111297749
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62353285552253
lambda[   2] =  -0.34356601630573
lambda[   3] =  -0.34356466969754
lambda[   4] =  -0.34356395655640
lambda[   5] =  -0.02000682764905
lambda[   6] =   0.02685675772414
lambda[   7] =   0.03298411965040
lambda[   8] =   0.03364773187924
lambda[   9] =   0.03642111129775
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.059 ms
rank =  0, Distributing orbital back into band + domain format took 6.877 ms
rank = 0, Subspace_Rotation used 8.949 ms

Total time for subspace rotation: 8.954 ms
rank = 0, Efermi =  -0.049634717496 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 1.781 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.091 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 743.404 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.632 ms
rank = 0, D2D took 0.854 ms
rank = 0, Transfering density took 0.857 ms
Etot    =    -8.424022713477
Eband   =    -3.308454996403
E1      =     7.925047974479
E2      =    -2.527313970838
E3      =    -4.197047012346
Exc     =    -3.597288736289
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.489e-06, dEband = 6.632e-04
rank = 0, Calculating/Estimating energy took 0.962 ms, Etot = -8.424022713, dEtot = 1.489e-06, dEband = 6.632e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0443452470447, which took 0.046 ms

iter_count = 102, r_2norm = 1.120e-06, tol*||rhs|| = 1.774e-06

Anderson update took 54.144 ms, out of which F'*F took 25.636 ms; b-Ax took 174.864 ms, out of which Lap took 156.670 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.160 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192412, int_b + int_rho = 5.821e-14, checking this took 0.201 ms
2-norm of RHS = 508.1129618556149, which took 0.125 ms

iter_count = 144, r_2norm = 4.787e-04, tol*||rhs|| = 5.081e-04

Anderson update took 76.425 ms, out of which F'*F took 35.840 ms; b-Ax took 243.309 ms, out of which Lap took 218.025 ms
Solving Poisson took 517.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.154967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.164253 
Total time for convolution: 	 convolve: 5.182623 
Total time for convolution: 	 convolve: 5.161672 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.323 ms

This SCF took 26311.230 ms, scf error = 2.309e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136421, lowerbound = -0.623533, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 694.939 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 6.960 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.175 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.156 ms
rank =  0, finding HY took 11.985 ms
rank =  0, distributing HY into block cyclic form took 6.955 ms
rank =  0, finding Y'*HY took 2.746 ms
Rank 0, Project_Hamiltonian used 30.873 ms
Total time for projection: 30.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.623709615227641
    last  calculated eigval = 0.036101476624518
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62370961522764
lambda[   2] =  -0.34372537623624
lambda[   3] =  -0.34372504511984
lambda[   4] =  -0.34372408127677
lambda[   5] =  -0.02037329040015
lambda[   6] =   0.02743125535686
lambda[   7] =   0.03295708910454
lambda[   8] =   0.03352846040735
lambda[   9] =   0.03610147662452
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 2.037 ms
rank =  0, Distributing orbital back into band + domain format took 6.897 ms
rank = 0, Subspace_Rotation used 8.949 ms

Total time for subspace rotation: 8.955 ms
rank = 0, Efermi =  -0.050001180268 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 1.786 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.040 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 740.044 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.621 ms
rank = 0, D2D took 0.911 ms
rank = 0, Transfering density took 0.915 ms
Etot    =    -8.424030518764
Eband   =    -3.309768235964
E1      =     7.925990144007
E2      =    -2.527784701617
E3      =    -4.196586824079
Exc     =    -3.596936014054
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.561e-06, dEband = 2.626e-04
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -8.424030519, dEtot = 1.561e-06, dEband = 2.626e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0405055757328, which took 0.052 ms

iter_count = 102, r_2norm = 1.089e-06, tol*||rhs|| = 1.620e-06

Anderson update took 54.090 ms, out of which F'*F took 25.257 ms; b-Ax took 171.828 ms, out of which Lap took 153.611 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 371.284 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192410, int_b + int_rho = 3.820e-14, checking this took 0.117 ms
2-norm of RHS = 508.1130532995681, which took 0.105 ms

iter_count = 120, r_2norm = 4.721e-04, tol*||rhs|| = 5.081e-04

Anderson update took 63.888 ms, out of which F'*F took 29.759 ms; b-Ax took 202.908 ms, out of which Lap took 182.078 ms
Solving Poisson took 431.188 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.183699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.170752 
Total time for convolution: 	 convolve: 5.180593 
Total time for convolution: 	 convolve: 5.172218 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.871 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.951 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.306 ms

This SCF took 26265.172 ms, scf error = 4.020e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136101, lowerbound = -0.623710, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 690.347 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.906 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.123 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 17.055 ms
rank =  0, finding HY took 11.981 ms
rank =  0, distributing HY into block cyclic form took 6.982 ms
rank =  0, finding Y'*HY took 2.704 ms
Rank 0, Project_Hamiltonian used 38.764 ms
Total time for projection: 38.778 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.623586295555081
    last  calculated eigval = 0.036529193636971
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62358629555508
lambda[   2] =  -0.34360950476261
lambda[   3] =  -0.34360856713965
lambda[   4] =  -0.34360791916580
lambda[   5] =  -0.01957171112884
lambda[   6] =   0.02591702435769
lambda[   7] =   0.03366535956183
lambda[   8] =   0.03415403273070
lambda[   9] =   0.03652919363697
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 2.044 ms
rank =  0, Distributing orbital back into band + domain format took 6.964 ms
rank = 0, Subspace_Rotation used 9.025 ms

Total time for subspace rotation: 9.030 ms
rank = 0, Efermi =  -0.049199600979 calculate fermi energy took 0.088 ms
rank = 0, --- Calculate rho: sum over local bands took 1.883 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.964 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.180 ms
rank = 0, Calculating density took 743.510 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.643 ms
rank = 0, D2D took 0.912 ms
rank = 0, Transfering density took 0.919 ms
Etot    =    -8.424021433841
Eband   =    -3.308824573480
E1      =     7.925409200061
E2      =    -2.527361111951
E3      =    -4.196866018823
Exc     =    -3.597145252748
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.817e-06, dEband = 1.887e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -8.424021434, dEtot = 1.817e-06, dEband = 1.887e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0396440147169, which took 2.678 ms

iter_count = 102, r_2norm = 1.095e-06, tol*||rhs|| = 1.586e-06

Anderson update took 59.039 ms, out of which F'*F took 25.516 ms; b-Ax took 177.866 ms, out of which Lap took 159.796 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 386.634 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192411, int_b + int_rho = 5.275e-14, checking this took 0.108 ms
2-norm of RHS = 508.1131523914269, which took 0.120 ms

iter_count = 36, r_2norm = 4.540e-04, tol*||rhs|| = 5.081e-04

Anderson update took 19.178 ms, out of which F'*F took 8.937 ms; b-Ax took 60.804 ms, out of which Lap took 54.458 ms
Solving Poisson took 131.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.169141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.159541 
Total time for convolution: 	 convolve: 5.163841 
Total time for convolution: 	 convolve: 5.169920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.970 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.331 ms

This SCF took 25928.221 ms, scf error = 3.332e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136529, lowerbound = -0.623586, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 695.710 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.049 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.146 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 9.240 ms
rank =  0, finding HY took 11.984 ms
rank =  0, distributing HY into block cyclic form took 6.887 ms
rank =  0, finding Y'*HY took 2.758 ms
Rank 0, Project_Hamiltonian used 30.901 ms
Total time for projection: 30.915 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.049 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.623561199880187
    last  calculated eigval = 0.036383931195805
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62356119988019
lambda[   2] =  -0.34358961787811
lambda[   3] =  -0.34358880385108
lambda[   4] =  -0.34358813295692
lambda[   5] =  -0.01972716720967
lambda[   6] =   0.02541870977008
lambda[   7] =   0.03349087551427
lambda[   8] =   0.03395945082536
lambda[   9] =   0.03638393119581
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 2.041 ms
rank =  0, Distributing orbital back into band + domain format took 6.932 ms
rank = 0, Subspace_Rotation used 8.987 ms

Total time for subspace rotation: 8.992 ms
rank = 0, Efermi =  -0.049355057042 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.817 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.260 ms
rank = 0, Calculating density took 740.976 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
rank = 0, D2D took 0.849 ms
rank = 0, Transfering density took 0.853 ms
Etot    =    -8.424023312290
Eband   =    -3.308655509368
E1      =     7.925255980838
E2      =    -2.527323835672
E3      =    -4.196950983094
Exc     =    -3.597210664079
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 3.757e-07, dEband = 3.381e-05
rank = 0, Calculating/Estimating energy took 1.374 ms, Etot = -8.424023312, dEtot = 3.757e-07, dEband = 3.381e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0359186969689, which took 0.060 ms

iter_count = 102, r_2norm = 9.715e-07, tol*||rhs|| = 1.437e-06

Anderson update took 54.020 ms, out of which F'*F took 25.269 ms; b-Ax took 171.971 ms, out of which Lap took 153.757 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 371.207 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192413, int_b + int_rho = 6.548e-14, checking this took 0.122 ms
2-norm of RHS = 508.1128095057446, which took 0.136 ms

iter_count = 96, r_2norm = 4.916e-04, tol*||rhs|| = 5.081e-04

Anderson update took 50.781 ms, out of which F'*F took 23.855 ms; b-Ax took 161.971 ms, out of which Lap took 145.239 ms
Solving Poisson took 345.790 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.173558 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.184188 
Total time for convolution: 	 convolve: 5.163086 
Total time for convolution: 	 convolve: 5.185702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.017 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
---Transfer Veff_loc: D2D took 0.981 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 26183.868 ms, scf error = 2.730e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136384, lowerbound = -0.623561, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 696.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 11.544 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.130 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.700 ms
rank =  0, finding HY took 11.963 ms
rank =  0, distributing HY into block cyclic form took 6.983 ms
rank =  0, finding Y'*HY took 2.678 ms
Rank 0, Project_Hamiltonian used 35.358 ms
Total time for projection: 35.372 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.057 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.623463839693079
    last  calculated eigval = 0.036632189499692
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62346383969308
lambda[   2] =  -0.34350200946509
lambda[   3] =  -0.34350157699719
lambda[   4] =  -0.34350070911033
lambda[   5] =  -0.01962428134893
lambda[   6] =   0.02549078150391
lambda[   7] =   0.03361788155781
lambda[   8] =   0.03407348499442
lambda[   9] =   0.03663218949969
==subpsace eigenproblem: bcast eigvals took 0.055 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 2.055 ms
rank =  0, Distributing orbital back into band + domain format took 7.004 ms
rank = 0, Subspace_Rotation used 9.071 ms

Total time for subspace rotation: 9.076 ms
rank = 0, Efermi =  -0.049252171196 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.852 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.031 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 745.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.683 ms
rank = 0, D2D took 0.852 ms
rank = 0, Transfering density took 0.855 ms
Etot    =    -8.424033634686
Eband   =    -3.307936270765
E1      =     7.924770763822
E2      =    -2.527041295569
E3      =    -4.197120086404
Exc     =    -3.597341571267
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 2.064e-06, dEband = 1.438e-04
rank = 0, Calculating/Estimating energy took 1.534 ms, Etot = -8.424033635, dEtot = 2.064e-06, dEband = 1.438e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0233435838474, which took 0.051 ms

iter_count = 96, r_2norm = 6.987e-07, tol*||rhs|| = 9.337e-07

Anderson update took 50.989 ms, out of which F'*F took 24.056 ms; b-Ax took 163.617 ms, out of which Lap took 146.662 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192409, int_b + int_rho = 2.910e-14, checking this took 0.083 ms
2-norm of RHS = 508.1104040108197, which took 0.137 ms

iter_count = 132, r_2norm = 4.443e-04, tol*||rhs|| = 5.081e-04

Anderson update took 87.039 ms, out of which F'*F took 32.697 ms; b-Ax took 224.059 ms, out of which Lap took 201.348 ms
Solving Poisson took 491.018 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.156867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.164355 
Total time for convolution: 	 convolve: 5.159585 
Total time for convolution: 	 convolve: 5.165954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.138 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.302 ms

This SCF took 26288.920 ms, scf error = 1.701e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136632, lowerbound = -0.623464, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 705.523 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.720 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 10.786 ms
rank =  0, finding HY took 12.215 ms
rank =  0, distributing HY into block cyclic form took 6.871 ms
rank =  0, finding Y'*HY took 2.800 ms
Rank 0, Project_Hamiltonian used 32.705 ms
Total time for projection: 32.717 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.056 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.623388333817532
    last  calculated eigval = 0.036807956696684
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62338833381753
lambda[   2] =  -0.34342094776396
lambda[   3] =  -0.34342044940753
lambda[   4] =  -0.34341961158002
lambda[   5] =  -0.01957422413549
lambda[   6] =   0.02709623936890
lambda[   7] =   0.03328985304615
lambda[   8] =   0.03378543011410
lambda[   9] =   0.03680795669668
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 2.018 ms
rank =  0, Distributing orbital back into band + domain format took 7.011 ms
rank = 0, Subspace_Rotation used 9.045 ms

Total time for subspace rotation: 9.050 ms
rank = 0, Efermi =  -0.049202114006 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.829 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.035 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 752.590 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.761 ms
rank = 0, D2D took 1.869 ms
rank = 0, Transfering density took 1.872 ms
Etot    =    -8.424045354957
Eband   =    -3.307298685371
E1      =     7.924531702634
E2      =    -2.526638510113
E3      =    -4.197102045909
Exc     =    -3.597330989793
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 2.344e-06, dEband = 1.275e-04
rank = 0, Calculating/Estimating energy took 0.863 ms, Etot = -8.424045355, dEtot = 2.344e-06, dEband = 1.275e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0219601808437, which took 0.098 ms

iter_count = 96, r_2norm = 5.580e-07, tol*||rhs|| = 8.784e-07

Anderson update took 50.868 ms, out of which F'*F took 23.776 ms; b-Ax took 161.649 ms, out of which Lap took 144.624 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.869 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192411, int_b + int_rho = 4.547e-14, checking this took 0.101 ms
2-norm of RHS = 508.1106145084987, which took 0.098 ms

iter_count = 48, r_2norm = 4.745e-04, tol*||rhs|| = 5.081e-04

Anderson update took 25.522 ms, out of which F'*F took 11.964 ms; b-Ax took 81.574 ms, out of which Lap took 73.233 ms
Solving Poisson took 174.744 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.163985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.486 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.175222 
Total time for convolution: 	 convolve: 5.159348 
Total time for convolution: 	 convolve: 5.160252 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.329 ms

This SCF took 25940.950 ms, scf error = 2.194e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.136808, lowerbound = -0.623388, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 707.136 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 8.303 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.682 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 10.008 ms
rank =  0, finding HY took 12.012 ms
rank =  0, distributing HY into block cyclic form took 6.951 ms
rank =  0, finding Y'*HY took 2.681 ms
Rank 0, Project_Hamiltonian used 31.687 ms
Total time for projection: 31.704 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.051 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.623397773568435
    last  calculated eigval = 0.036995704621037
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62339777356843
lambda[   2] =  -0.34343049458684
lambda[   3] =  -0.34343002989594
lambda[   4] =  -0.34342924764818
lambda[   5] =  -0.01927747883556
lambda[   6] =   0.02737139245274
lambda[   7] =   0.03355964246669
lambda[   8] =   0.03401584502123
lambda[   9] =   0.03699570462104
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 2.052 ms
rank =  0, Distributing orbital back into band + domain format took 6.959 ms
rank = 0, Subspace_Rotation used 9.024 ms

Total time for subspace rotation: 9.028 ms
rank = 0, Efermi =  -0.048905368714 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.841 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.008 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.185 ms
rank = 0, Calculating density took 753.217 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.624 ms
rank = 0, D2D took 1.719 ms
rank = 0, Transfering density took 1.722 ms
Etot    =    -8.424045855669
Eband   =    -3.307375091629
E1      =     7.924574278870
E2      =    -2.526676800885
E3      =    -4.197081533846
Exc     =    -3.597315439192
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 1.001e-07, dEband = 1.528e-05
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -8.424045856, dEtot = 1.001e-07, dEband = 1.528e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229249815877, which took 0.054 ms

iter_count = 90, r_2norm = 9.045e-07, tol*||rhs|| = 9.170e-07

Anderson update took 47.590 ms, out of which F'*F took 23.426 ms; b-Ax took 154.397 ms, out of which Lap took 138.442 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.003 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192410, int_b + int_rho = 4.275e-14, checking this took 0.104 ms
2-norm of RHS = 508.1101168106346, which took 0.090 ms

iter_count = 36, r_2norm = 4.477e-04, tol*||rhs|| = 5.081e-04

Anderson update took 19.286 ms, out of which F'*F took 8.932 ms; b-Ax took 60.889 ms, out of which Lap took 54.640 ms
Solving Poisson took 132.268 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.172507 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.665 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.158393 
Total time for convolution: 	 convolve: 5.158436 
Total time for convolution: 	 convolve: 5.155800 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.342 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.327 ms

This SCF took 25909.288 ms, scf error = 2.113e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.136996, lowerbound = -0.623398, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 704.301 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.051 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.190 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 9.262 ms
rank =  0, finding HY took 11.898 ms
rank =  0, distributing HY into block cyclic form took 6.973 ms
rank =  0, finding Y'*HY took 2.745 ms
Rank 0, Project_Hamiltonian used 30.907 ms
Total time for projection: 30.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.050 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.117 ms
    first calculated eigval = -0.623378050199615
    last  calculated eigval = 0.036182972427249
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62337805019962
lambda[   2] =  -0.34341260623805
lambda[   3] =  -0.34341209080565
lambda[   4] =  -0.34341120661082
lambda[   5] =  -0.01956171241202
lambda[   6] =   0.02654730192335
lambda[   7] =   0.03322147089764
lambda[   8] =   0.03358466862545
lambda[   9] =   0.03618297242725
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 2.048 ms
rank =  0, Distributing orbital back into band + domain format took 6.976 ms
rank = 0, Subspace_Rotation used 9.037 ms

Total time for subspace rotation: 9.041 ms
rank = 0, Efermi =  -0.049189602311 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.991 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.880 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 749.565 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.179 ms
rank = 0, D2D took 1.279 ms
rank = 0, Transfering density took 1.287 ms
Etot    =    -8.424044259819
Eband   =    -3.307227907942
E1      =     7.924463332671
E2      =    -2.526630826851
E3      =    -4.197134466116
Exc     =    -3.597357039067
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 3.192e-07, dEband = 2.944e-05
rank = 0, Calculating/Estimating energy took 0.895 ms, Etot = -8.424044260, dEtot = 3.192e-07, dEband = 2.944e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227586668970, which took 0.058 ms

iter_count = 96, r_2norm = 5.813e-07, tol*||rhs|| = 9.103e-07

Anderson update took 50.858 ms, out of which F'*F took 23.628 ms; b-Ax took 162.062 ms, out of which Lap took 144.963 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.348 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192414, int_b + int_rho = 8.185e-14, checking this took 0.102 ms
2-norm of RHS = 508.1098592026254, which took 0.112 ms

iter_count = 24, r_2norm = 4.785e-04, tol*||rhs|| = 5.081e-04

Anderson update took 13.663 ms, out of which F'*F took 6.006 ms; b-Ax took 40.621 ms, out of which Lap took 36.521 ms
Solving Poisson took 89.910 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.162032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.676 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.170583 
Total time for convolution: 	 convolve: 5.161217 
Total time for convolution: 	 convolve: 5.166969 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.983 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.349 ms

This SCF took 25879.007 ms, scf error = 1.844e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.136183, lowerbound = -0.623378, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1792.754 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 25.029 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 32.394 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 57.448 ms
rank =  0, finding HY took 10.652 ms
rank =  0, distributing HY into block cyclic form took 164.486 ms
rank =  0, finding Y'*HY took 60.084 ms
Rank 0, Project_Hamiltonian used 292.702 ms
Total time for projection: 292.718 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.059 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 23.573 ms
rank = 0, Solve_Generalized_EigenProblem used 23.637 ms
    first calculated eigval = -0.623367633145767
    last  calculated eigval = 0.035878628868570
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62336763314577
lambda[   2] =  -0.34340328788318
lambda[   3] =  -0.34340275616072
lambda[   4] =  -0.34340185642168
lambda[   5] =  -0.01957064964911
lambda[   6] =   0.02630071170571
lambda[   7] =   0.03319812189752
lambda[   8] =   0.03350830536583
lambda[   9] =   0.03587862886857
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 23.654 ms
rank =  0, subspace rotation using ScaLAPACK took 1.945 ms
rank =  0, Distributing orbital back into band + domain format took 51.839 ms
rank = 0, Subspace_Rotation used 53.798 ms

Total time for subspace rotation: 53.801 ms
rank = 0, Efermi =  -0.049198539484 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.700 ms
rank = 0, --- Calculate rho: reduce over all band groups took 94.568 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.130 ms
rank = 0, Calculating density took 2260.180 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.498 ms
rank = 0, D2D took 0.596 ms
rank = 0, Transfering density took 0.602 ms
Etot    =    -8.424042805055
Eband   =    -3.307151067456
E1      =     7.924404202863
E2      =    -2.526608325585
E3      =    -4.197163709154
Exc     =    -3.597380036752
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 2.910e-07, dEband = 1.537e-05
rank = 0, Calculating/Estimating energy took 48.514 ms, Etot = -8.424042805, dEtot = 2.910e-07, dEband = 1.537e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0117065191163, which took 39.515 ms

iter_count = 96, r_2norm = 4.331e-07, tol*||rhs|| = 4.683e-07

Anderson update took 147.707 ms, out of which F'*F took 130.367 ms; b-Ax took 641.954 ms, out of which Lap took 627.984 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1138.367 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192413, int_b + int_rho = 7.276e-14, checking this took 0.099 ms
2-norm of RHS = 508.1073850151815, which took 0.124 ms

iter_count = 108, r_2norm = 4.472e-04, tol*||rhs|| = 5.081e-04

Anderson update took 57.436 ms, out of which F'*F took 26.875 ms; b-Ax took 197.273 ms, out of which Lap took 178.523 ms
Solving Poisson took 402.821 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.168409 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.168491 
Total time for convolution: 	 convolve: 5.160595 
Total time for convolution: 	 convolve: 5.166481 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.015 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.768 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.355 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 28546.953 ms, scf error = 1.681e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.135879, lowerbound = -0.623368, upperbound = 267.567945

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 701.542 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.756 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 8.820 ms
rank =  0, finding HY took 11.937 ms
rank =  0, distributing HY into block cyclic form took 7.050 ms
rank =  0, finding Y'*HY took 2.601 ms
Rank 0, Project_Hamiltonian used 30.439 ms
Total time for projection: 30.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.048 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.623260471589849
    last  calculated eigval = 0.034262790113362
The last 9 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 8):
lambda[   1] =  -0.62326047158985
lambda[   2] =  -0.34330636643948
lambda[   3] =  -0.34330616048643
lambda[   4] =  -0.34330606621425
lambda[   5] =  -0.02063238673206
lambda[   6] =   0.02707206295508
lambda[   7] =   0.03211230092254
lambda[   8] =   0.03235876735825
lambda[   9] =   0.03426279011336
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 2.028 ms
rank =  0, Distributing orbital back into band + domain format took 6.911 ms
rank = 0, Subspace_Rotation used 8.954 ms

Total time for subspace rotation: 9.847 ms
rank = 0, Efermi =  -0.050260276634 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 2.052 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.050 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.185 ms
rank = 0, Calculating density took 746.417 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.698 ms
rank = 0, D2D took 0.875 ms
rank = 0, Transfering density took 0.879 ms
Etot    =    -8.424046092872
Eband   =    -3.306358129706
E1      =     7.923825503489
E2      =    -2.526347143243
E3      =    -4.197373143393
Exc     =    -3.597545814842
Esc     =   -16.167687938085
Entropy =    -0.000000000364
dE = 6.576e-07, dEband = 1.586e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -8.424046093, dEtot = 6.576e-07, dEband = 1.586e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0091278239491, which took 0.056 ms

iter_count = 96, r_2norm = 3.201e-07, tol*||rhs|| = 3.651e-07

Anderson update took 50.934 ms, out of which F'*F took 23.727 ms; b-Ax took 161.833 ms, out of which Lap took 144.823 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b =  -8.00000001192406, int_rho =   8.00000001192408, int_b + int_rho = 1.819e-14, checking this took 0.102 ms
2-norm of RHS = 508.1070895987317, which took 0.116 ms

iter_count = 72, r_2norm = 4.993e-04, tol*||rhs|| = 5.081e-04

Anderson update took 38.188 ms, out of which F'*F took 17.997 ms; b-Ax took 121.989 ms, out of which Lap took 109.479 ms
Solving Poisson took 260.649 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.173885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.167849 
Total time for convolution: 	 convolve: 5.174479 
Total time for convolution: 	 convolve: 5.157734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.372 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.302 ms

This SCF took 26051.587 ms, scf error = 2.925e-05
The last 9 occupations of kpoints #1 are (Nelectron = 8):
lambda[   1] =  -0.62326047158985, occ[   1] =   2.00000000000000
lambda[   2] =  -0.34330636643948, occ[   2] =   2.00000000000000
lambda[   3] =  -0.34330616048643, occ[   3] =   2.00000000000000
lambda[   4] =  -0.34330606621425, occ[   4] =   2.00000000000000
lambda[   5] =  -0.02063238673206, occ[   5] =   0.00000001192411
lambda[   6] =   0.02707206295508, occ[   6] =   0.00000000000000
lambda[   7] =   0.03211230092254, occ[   7] =   0.00000000000000
lambda[   8] =   0.03235876735825, occ[   8] =   0.00000000000000
lambda[   9] =   0.03426279011336, occ[   9] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 8 (90%) = 0.000000000000000.
Occupation of state 9 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.177 ms, time for Allreduce/Reduce: 4.707 ms 
Time for calculating local force components: 9.892 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.02851795324408  -0.02851794664272  -0.02851797715576
  0.02851793520411   0.02851793044425  -0.02851791698019
  0.02851792883744  -0.02851790505452   0.02851791933541
 -0.02851787746725   0.02851786600267   0.02851786380310
 -0.00000063249426  -0.00000174251305  -0.00000059719971
force_loc = 
  0.03022047495151   0.03022003979351   0.03022022300926
 -0.03021989896379  -0.03022024853558   0.03021955578904
 -0.03022021463447   0.03021962513407  -0.03022039229963
  0.03021970443067  -0.03021994302637  -0.03021988929043
  0.00000066485127  -0.00000108166088  -0.00000043524522
Time for calculating nonlocal force components: 17.315 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000006299349   0.00000012704689   0.00000002743364
[0mTime for calculating XC forces components: 12.055 ms
 Cartesian force = 
  0.00170248281451   0.00170274895313   0.00170256961360
 -0.00170200265261  -0.00170166228898   0.00170196256895
 -0.00170232468996   0.00170237588190  -0.00170214920412
  0.00170178807049  -0.00170142122136  -0.00170170172723
  0.00000005645757  -0.00000204132469  -0.00000068125119
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Time for printing density: 388.735 ms
The program took 613.811 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:38:11
Job ID:        2266886
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:04:12,vmem=8312K,walltime=00:10:21,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-15-2
---------------------------------------
