---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:05
Job ID:    2266910
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:12
Job ID:    2266910
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.062 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 34.323 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 16.031 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 159.251 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.975 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.094 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.808304	
   10.000000	   13.864301	   12.226113	
   10.000000	    6.135699	   12.226113	
   10.000000	   12.593111	    7.191696	
   10.000000	    7.406889	    7.191696	
   10.000000	   12.063044	   11.277418	
   10.000000	    7.936956	   11.277418	
   10.000000	   11.354871	    8.810702	
   10.000000	    8.645129	    8.810702	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.169 ms
Set up communicators.

--set up spincomm took 3.072 ms

--set up kptcomm took 0.343 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.021 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.435 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.179 ms

Calculate_SplineDerivRadFun took 0.210 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.268 ms.
time spent on vectorized spline interp: 3.191 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.992 ms.
time spent on vectorized spline interp: 1.287 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.306 ms.
time spent on vectorized spline interp: 1.630 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.492 ms.

Calculating rb for all atom types took 15.174 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.036 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000205021, sum_int_rho = 25.5831500785666
PosCharge = 26.000000020502, NegCharge = -25.583150078567, scal_fac = 1.016293925520
After scaling, int_rho = 26.0000000205023, PosCharge + NegCharge - NetCharge = -1.208e-13
--Calculate Vref took 0.503 ms
--Calculate rho_guess took 2.880 ms

 integral of b = -26.0000000205021,
 int{b} + Nelectron + NetCharge = -2.050e-08,
 Esc = -71.2329148914877,
 MPI_Reduce took 10.187 ms

Calculating b & b_ref took 20.250 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.016 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.024 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.005 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.038 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.681 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050221, int_b + int_rho = -2.074e-13, checking this took 0.089 ms
2-norm of RHS = 717.2014894087682, which took 0.791 ms

iter_count = 420, r_2norm = 6.681e-04, tol*||rhs|| = 7.172e-04

Anderson update took 234.686 ms, out of which F'*F took 106.852 ms; b-Ax took 717.667 ms, out of which Lap took 643.529 ms
Solving Poisson took 1518.923 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.116189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 101.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.184882 
Total time for convolution: 	 convolve: 5.129271 
Total time for convolution: 	 convolve: 5.217736 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.774 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.466 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, XC calculation took 24651.666 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.185 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.125 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.427 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.671 ms
    Lanczos iter 54, eigmin  = -1.063009646, eigmax = 264.935933523, err_eigmin = 1.079e-03, err_eigmax = 9.772e-03
rank =   0, Lanczos took 124.446 ms, eigmin = -1.063009646189, eigmax = 267.585292857778

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.211142, lowerbound = -1.163010, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1760.660 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 29.157 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.058 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 33.244 ms
rank =  0, finding HY took 30.238 ms
rank =  0, distributing HY into block cyclic form took 19.089 ms
rank =  0, finding Y'*HY took 6.119 ms
Rank 0, Project_Hamiltonian used 88.722 ms
Total time for projection: 89.391 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.763 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.860 ms
    first calculated eigval = 2.718914826722954
    last  calculated eigval = 3.219361417080025
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81976938319408
lambda[   5] =   2.86867327345364
lambda[   6] =   2.88450102946870
lambda[   7] =   2.90876756553161
lambda[   8] =   2.93483098686133
lambda[   9] =   2.94957468281188
lambda[  10] =   2.99060735388182
lambda[  11] =   3.00483605604391
lambda[  12] =   3.01446276015378
lambda[  13] =   3.05225337408043
lambda[  14] =   3.07311164811612
lambda[  15] =   3.10941507985734
lambda[  16] =   3.11040521974640
lambda[  17] =   3.16156061399071
lambda[  18] =   3.17142105777264
lambda[  19] =   3.19034185653124
lambda[  20] =   3.21936141708003
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.874 ms
rank =  0, subspace rotation using ScaLAPACK took 6.101 ms
rank =  0, Distributing orbital back into band + domain format took 16.904 ms
rank = 0, Subspace_Rotation used 23.017 ms

Total time for subspace rotation: 23.022 ms
rank = 0, Efermi =   3.062682511598 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.319361, lowerbound = -1.163010, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1737.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 21.427 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.080 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.535 ms
rank =  0, finding HY took 29.873 ms
rank =  0, distributing HY into block cyclic form took 17.818 ms
rank =  0, finding Y'*HY took 5.588 ms
Rank 0, Project_Hamiltonian used 78.848 ms
Total time for projection: 78.851 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -0.834360916046647
    last  calculated eigval = 0.441513608136058
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.32850327763593
lambda[   5] =  -0.27206143096173
lambda[   6] =  -0.19142064268243
lambda[   7] =  -0.06192591124782
lambda[   8] =  -0.04260101416630
lambda[   9] =   0.05191823969775
lambda[  10] =   0.07526646618698
lambda[  11] =   0.17699111856265
lambda[  12] =   0.21443648369140
lambda[  13] =   0.26833686273511
lambda[  14] =   0.31745833302871
lambda[  15] =   0.32926112991745
lambda[  16] =   0.35801951759838
lambda[  17] =   0.38721017241853
lambda[  18] =   0.39068482062667
lambda[  19] =   0.42960525581297
lambda[  20] =   0.44151360813606
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 6.109 ms
rank =  0, Distributing orbital back into band + domain format took 17.004 ms
rank = 0, Subspace_Rotation used 23.128 ms

Total time for subspace rotation: 23.132 ms
rank = 0, Efermi =   0.292902320322 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.541514, lowerbound = -1.163010, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1765.466 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 17.800 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.076 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 21.822 ms
rank =  0, finding HY took 29.844 ms
rank =  0, distributing HY into block cyclic form took 17.822 ms
rank =  0, finding Y'*HY took 5.540 ms
Rank 0, Project_Hamiltonian used 75.068 ms
Total time for projection: 75.072 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.075432182143452
    last  calculated eigval = 0.156513833878890
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63766697921598
lambda[   5] =  -0.62135489687420
lambda[   6] =  -0.58928117915355
lambda[   7] =  -0.48329953669932
lambda[   8] =  -0.47127627608424
lambda[   9] =  -0.45355588555976
lambda[  10] =  -0.44610433671872
lambda[  11] =  -0.39261492831997
lambda[  12] =  -0.30498782477287
lambda[  13] =  -0.23388665377316
lambda[  14] =  -0.01366311130044
lambda[  15] =   0.03559739102087
lambda[  16] =   0.08472606725499
lambda[  17] =   0.08922868455109
lambda[  18] =   0.10213663933781
lambda[  19] =   0.14495349066673
lambda[  20] =   0.15651383387889
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 6.097 ms
rank =  0, Distributing orbital back into band + domain format took 16.941 ms
rank = 0, Subspace_Rotation used 23.052 ms

Total time for subspace rotation: 23.056 ms
rank = 0, Efermi =  -0.042807153090 calculate fermi energy took 0.028 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.256514, lowerbound = -1.163010, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1769.751 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.804 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.025 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.857 ms
rank =  0, finding HY took 29.822 ms
rank =  0, distributing HY into block cyclic form took 17.915 ms
rank =  0, finding Y'*HY took 5.545 ms
Rank 0, Project_Hamiltonian used 75.167 ms
Total time for projection: 75.180 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -1.076003500541686
    last  calculated eigval = 0.085909544554578
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64001783533587
lambda[   5] =  -0.62572266396883
lambda[   6] =  -0.59248319758785
lambda[   7] =  -0.49449449837644
lambda[   8] =  -0.47800598721909
lambda[   9] =  -0.47643055597853
lambda[  10] =  -0.46297141626277
lambda[  11] =  -0.40279346183236
lambda[  12] =  -0.33590488983037
lambda[  13] =  -0.29255542920757
lambda[  14] =  -0.08467436609771
lambda[  15] =  -0.04700881872856
lambda[  16] =   0.02578734607257
lambda[  17] =   0.04640464903539
lambda[  18] =   0.05321237080099
lambda[  19] =   0.07912436249194
lambda[  20] =   0.08590954455458
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 6.090 ms
rank =  0, Distributing orbital back into band + domain format took 16.880 ms
rank = 0, Subspace_Rotation used 22.982 ms

Total time for subspace rotation: 23.769 ms
rank = 0, Efermi =  -0.113818407895 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 4.299 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.938 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.275 ms
rank = 0, Calculating density took 7579.986 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.668 ms
rank = 0, D2D took 1.825 ms
rank = 0, Transfering density took 1.838 ms
Etot    =   -43.101416899322
Eband   =   -15.031288357627
E1      =    29.713528647164
E2      =   -11.935901739657
E3      =   -15.127972315093
Exc     =   -13.614616351505
Esc     =   -71.232914891488
Entropy =    -0.000000000615
dE = 4.789e+00, dEband = 1.670e+00
rank = 0, Calculating/Estimating energy took 1.459 ms, Etot = -43.101416899, dEtot = 4.789e+00, dEband = 1.670e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 51.7604618779662, which took 0.109 ms

iter_count = 96, r_2norm = 1.837e-03, tol*||rhs|| = 2.070e-03

Anderson update took 51.120 ms, out of which F'*F took 24.078 ms; b-Ax took 163.232 ms, out of which Lap took 146.597 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.368 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050223, int_b + int_rho = -1.928e-13, checking this took 0.117 ms
2-norm of RHS = 713.5887210076236, which took 0.146 ms

iter_count = 288, r_2norm = 6.706e-04, tol*||rhs|| = 7.136e-04

Anderson update took 153.076 ms, out of which F'*F took 72.259 ms; b-Ax took 487.017 ms, out of which Lap took 437.443 ms
Solving Poisson took 1029.106 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.862 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.122050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.234238 
Total time for convolution: 	 convolve: 5.112369 
Total time for convolution: 	 convolve: 5.163526 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.261 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.265 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.354 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.640 ms

This SCF took 33557.388 ms, scf error = 1.699e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.185910, lowerbound = -1.076004, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1731.761 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 23.937 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.029 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 27.992 ms
rank =  0, finding HY took 29.564 ms
rank =  0, distributing HY into block cyclic form took 18.311 ms
rank =  0, finding Y'*HY took 6.011 ms
Rank 0, Project_Hamiltonian used 81.905 ms
Total time for projection: 81.917 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -1.073468232146160
    last  calculated eigval = 0.064255189126514
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61786528489062
lambda[   5] =  -0.59238150252507
lambda[   6] =  -0.56391780223317
lambda[   7] =  -0.46771403314396
lambda[   8] =  -0.45195906159890
lambda[   9] =  -0.45083067057333
lambda[  10] =  -0.43933250459600
lambda[  11] =  -0.39149619789993
lambda[  12] =  -0.31347678451576
lambda[  13] =  -0.26883785456680
lambda[  14] =  -0.08037828828243
lambda[  15] =  -0.03515178941260
lambda[  16] =  -0.00510772015048
lambda[  17] =   0.02390914812620
lambda[  18] =   0.03128414734189
lambda[  19] =   0.05660850834666
lambda[  20] =   0.06425518912651
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 6.724 ms
rank =  0, Distributing orbital back into band + domain format took 17.740 ms
rank = 0, Subspace_Rotation used 24.480 ms

Total time for subspace rotation: 24.487 ms
rank = 0, Efermi =  -0.109522330194 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.368 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.178 ms
rank = 0, Calculating density took 1847.424 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.614 ms
rank = 0, D2D took 0.763 ms
rank = 0, Transfering density took 0.770 ms
Etot    =   -43.034669473292
Eband   =   -14.400941959870
E1      =    29.153667509164
E2      =   -11.904840162430
E3      =   -15.283640642970
Exc     =   -13.742960935884
Esc     =   -71.232914891488
Entropy =    -0.000000000615
dE = 7.416e-03, dEband = 7.004e-02
rank = 0, Calculating/Estimating energy took 0.912 ms, Etot = -43.034669473, dEtot = 7.416e-03, dEband = 7.004e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.4617054060663, which took 0.114 ms

iter_count = 102, r_2norm = 6.535e-04, tol*||rhs|| = 8.985e-04

Anderson update took 54.334 ms, out of which F'*F took 25.570 ms; b-Ax took 171.583 ms, out of which Lap took 153.718 ms
rank = 0, Mixing (+ precond) took 373.133 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050223, int_b + int_rho = -1.855e-13, checking this took 0.115 ms
2-norm of RHS = 708.0291159119846, which took 0.160 ms

iter_count = 300, r_2norm = 6.992e-04, tol*||rhs|| = 7.080e-04

Anderson update took 158.889 ms, out of which F'*F took 74.789 ms; b-Ax took 507.930 ms, out of which Lap took 452.881 ms
Solving Poisson took 1068.922 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.080348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.120322 
Total time for convolution: 	 convolve: 5.116045 
Total time for convolution: 	 convolve: 5.099592 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.156 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.541 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 1.289 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.359 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.668 ms

This SCF took 27713.512 ms, scf error = 1.148e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.164255, lowerbound = -1.073468, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1741.237 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 24.979 ms
rank =  0, finding HY took 30.526 ms
rank =  0, distributing HY into block cyclic form took 19.037 ms
rank =  0, finding Y'*HY took 5.956 ms
Rank 0, Project_Hamiltonian used 80.529 ms
Total time for projection: 80.545 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.052111817720904
    last  calculated eigval = 0.054269679373759
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57047884108150
lambda[   5] =  -0.53980438497463
lambda[   6] =  -0.51492342784349
lambda[   7] =  -0.42712069733687
lambda[   8] =  -0.42697830728068
lambda[   9] =  -0.39216619738659
lambda[  10] =  -0.37840694320734
lambda[  11] =  -0.35265625533760
lambda[  12] =  -0.27083516079907
lambda[  13] =  -0.22792619345872
lambda[  14] =  -0.04831831048105
lambda[  15] =  -0.02105742527944
lambda[  16] =   0.00648668059486
lambda[  17] =   0.01600596848211
lambda[  18] =   0.02386123428710
lambda[  19] =   0.04000032878940
lambda[  20] =   0.05426967937376
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 6.047 ms
rank =  0, Distributing orbital back into band + domain format took 18.575 ms
rank = 0, Subspace_Rotation used 24.639 ms

Total time for subspace rotation: 24.646 ms
rank = 0, Efermi =  -0.077462352439 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.356 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.520 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.298 ms
rank = 0, Calculating density took 1855.666 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.030 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
rank = 0, D2D took 0.904 ms
rank = 0, Transfering density took 0.910 ms
Etot    =   -42.980577332861
Eband   =   -13.224347236902
E1      =    28.154869624658
E2      =   -11.719406090552
E3      =   -15.614609498988
Exc     =   -14.012200418054
Esc     =   -71.232914891488
Entropy =    -0.000000000615
dE = 6.010e-03, dEband = 1.307e-01
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -42.980577333, dEtot = 6.010e-03, dEband = 1.307e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.6983966868300, which took 0.077 ms

iter_count = 102, r_2norm = 2.547e-04, tol*||rhs|| = 2.679e-04

Anderson update took 54.600 ms, out of which F'*F took 25.437 ms; b-Ax took 171.641 ms, out of which Lap took 153.840 ms
rank = 0, Mixing (+ precond) took 373.132 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050217, int_b + int_rho = -2.510e-13, checking this took 0.106 ms
2-norm of RHS = 707.2309144999623, which took 0.161 ms

iter_count = 276, r_2norm = 6.468e-04, tol*||rhs|| = 7.072e-04

Anderson update took 146.542 ms, out of which F'*F took 69.296 ms; b-Ax took 467.590 ms, out of which Lap took 418.285 ms
Solving Poisson took 985.140 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.080515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.110421 
Total time for convolution: 	 convolve: 5.092754 
Total time for convolution: 	 convolve: 5.165237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.843 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.305 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.666 ms

This SCF took 27678.668 ms, scf error = 3.801e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.154270, lowerbound = -1.052112, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1740.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.981 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.082 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 28.088 ms
rank =  0, finding HY took 28.560 ms
rank =  0, distributing HY into block cyclic form took 17.918 ms
rank =  0, finding Y'*HY took 5.458 ms
Rank 0, Project_Hamiltonian used 80.055 ms
Total time for projection: 80.071 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.576 ms
rank = 0, Solve_Generalized_EigenProblem used 1.358 ms
    first calculated eigval = -1.035415226295902
    last  calculated eigval = 0.041523235191153
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55393918458669
lambda[   5] =  -0.52267191170602
lambda[   6] =  -0.49877372887747
lambda[   7] =  -0.41259241335918
lambda[   8] =  -0.40958430541834
lambda[   9] =  -0.37457183252454
lambda[  10] =  -0.36306275823029
lambda[  11] =  -0.33514645674436
lambda[  12] =  -0.25881902890650
lambda[  13] =  -0.21468642903112
lambda[  14] =  -0.03580505506620
lambda[  15] =  -0.02672310140472
lambda[  16] =   0.01322887693292
lambda[  17] =   0.01548181492722
lambda[  18] =   0.02139785623173
lambda[  19] =   0.02733453550571
lambda[  20] =   0.04152323519115
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.375 ms
rank =  0, subspace rotation using ScaLAPACK took 5.555 ms
rank =  0, Distributing orbital back into band + domain format took 18.984 ms
rank = 0, Subspace_Rotation used 24.551 ms

Total time for subspace rotation: 24.557 ms
rank = 0, Efermi =  -0.064949105298 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.304 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.962 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.432 ms
rank = 0, Calculating density took 1855.187 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.904 ms
rank = 0, D2D took 1.061 ms
rank = 0, Transfering density took 1.070 ms
Etot    =   -42.974937902973
Eband   =   -12.810125938766
E1      =    27.856036527666
E2      =   -11.583373620416
E3      =   -15.734584876053
Exc     =   -14.105892096240
Esc     =   -71.232914891488
Entropy =    -0.000000000615
dE = 6.266e-04, dEband = 4.602e-02
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -42.974937903, dEtot = 6.266e-04, dEband = 4.602e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.0405048337297, which took 0.102 ms

iter_count = 108, r_2norm = 8.408e-05, tol*||rhs|| = 1.216e-04

Anderson update took 58.038 ms, out of which F'*F took 26.904 ms; b-Ax took 180.917 ms, out of which Lap took 162.191 ms
rank = 0, Mixing (+ precond) took 395.446 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050234, int_b + int_rho = -8.367e-14, checking this took 0.139 ms
2-norm of RHS = 707.9596947527566, which took 0.129 ms

iter_count = 258, r_2norm = 6.715e-04, tol*||rhs|| = 7.080e-04

Anderson update took 136.339 ms, out of which F'*F took 64.989 ms; b-Ax took 439.988 ms, out of which Lap took 393.233 ms
Solving Poisson took 922.645 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.102711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.164 ms
Total time for convolution: 	 convolve: 5.140062 
Total time for convolution: 	 convolve: 5.103223 
Total time for convolution: 	 convolve: 5.097056 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.281 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.118 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.429 ms

This SCF took 27629.752 ms, scf error = 1.607e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.141523, lowerbound = -1.035415, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.903 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.972 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 28.111 ms
rank =  0, finding HY took 28.188 ms
rank =  0, distributing HY into block cyclic form took 17.816 ms
rank =  0, finding Y'*HY took 5.551 ms
Rank 0, Project_Hamiltonian used 80.500 ms
Total time for projection: 80.518 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.028346047680158
    last  calculated eigval = 0.030441976491283
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54777986830548
lambda[   5] =  -0.51590041625571
lambda[   6] =  -0.49236257655275
lambda[   7] =  -0.40653399675485
lambda[   8] =  -0.40208967022036
lambda[   9] =  -0.36796056315731
lambda[  10] =  -0.35757518371104
lambda[  11] =  -0.32926920669523
lambda[  12] =  -0.25448058062254
lambda[  13] =  -0.20944408028135
lambda[  14] =  -0.03090531692763
lambda[  15] =  -0.02875952208956
lambda[  16] =   0.01248651430128
lambda[  17] =   0.01854195197858
lambda[  18] =   0.02011101869108
lambda[  19] =   0.02205802198255
lambda[  20] =   0.03044197649128
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 5.527 ms
rank =  0, Distributing orbital back into band + domain format took 18.898 ms
rank = 0, Subspace_Rotation used 24.441 ms

Total time for subspace rotation: 24.446 ms
rank = 0, Efermi =  -0.060122083845 calculate fermi energy took 2.308 ms
rank = 0, --- Calculate rho: sum over local bands took 4.550 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.189 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.235 ms
rank = 0, Calculating density took 1821.410 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.850 ms
rank = 0, D2D took 0.986 ms
rank = 0, Transfering density took 0.994 ms
Etot    =   -42.973568839611
Eband   =   -12.651905047686
E1      =    27.784838999211
E2      =   -11.486387348768
E3      =   -15.772064941407
Exc     =   -14.132040189202
Esc     =   -71.232914891488
Entropy =    -0.000000000620
dE = 1.521e-04, dEband = 1.758e-02
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -42.973568840, dEtot = 1.521e-04, dEband = 1.758e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8505126778208, which took 0.102 ms

iter_count = 114, r_2norm = 2.295e-05, tol*||rhs|| = 3.402e-05

Anderson update took 60.730 ms, out of which F'*F took 28.705 ms; b-Ax took 194.168 ms, out of which Lap took 173.701 ms
rank = 0, Mixing (+ precond) took 417.064 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050225, int_b + int_rho = -1.673e-13, checking this took 0.103 ms
2-norm of RHS = 708.4994019816795, which took 0.154 ms

iter_count = 246, r_2norm = 6.350e-04, tol*||rhs|| = 7.085e-04

Anderson update took 131.100 ms, out of which F'*F took 61.762 ms; b-Ax took 417.193 ms, out of which Lap took 373.563 ms
Solving Poisson took 880.274 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.082967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.188373 
Total time for convolution: 	 convolve: 5.085735 
Total time for convolution: 	 convolve: 5.072723 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.480 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.682 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.194 ms

This SCF took 27580.145 ms, scf error = 6.621e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.130442, lowerbound = -1.028346, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1723.248 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.104 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.362 ms
rank =  0, Distribute data + matrix mult took 27.046 ms
rank =  0, finding HY took 28.648 ms
rank =  0, distributing HY into block cyclic form took 17.762 ms
rank =  0, finding Y'*HY took 5.481 ms
Rank 0, Project_Hamiltonian used 78.967 ms
Total time for projection: 78.984 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.025796067151072
    last  calculated eigval = 0.024128709444940
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54397904611495
lambda[   5] =  -0.51202189694931
lambda[   6] =  -0.48842567749195
lambda[   7] =  -0.40384874006563
lambda[   8] =  -0.39862752543976
lambda[   9] =  -0.36368261426380
lambda[  10] =  -0.35316744480850
lambda[  11] =  -0.32646070095880
lambda[  12] =  -0.25080015681372
lambda[  13] =  -0.20614554336051
lambda[  14] =  -0.02916139189784
lambda[  15] =  -0.02822563854355
lambda[  16] =   0.01192752200693
lambda[  17] =   0.01894219054004
lambda[  18] =   0.02092847045105
lambda[  19] =   0.02145218164863
lambda[  20] =   0.02412870944494
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 5.538 ms
rank =  0, Distributing orbital back into band + domain format took 19.097 ms
rank = 0, Subspace_Rotation used 24.649 ms

Total time for subspace rotation: 24.654 ms
rank = 0, Efermi =  -0.058570850978 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.218 ms
rank = 0, Calculating density took 1836.181 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
rank = 0, D2D took 0.939 ms
rank = 0, Transfering density took 0.946 ms
Etot    =   -42.973057880751
Eband   =   -12.559038580479
E1      =    27.748610052703
E2      =   -11.424974096021
E3      =   -15.787202155974
Exc     =   -14.141890712857
Esc     =   -71.232914891488
Entropy =    -0.000000000626
dE = 5.677e-05, dEband = 1.032e-02
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -42.973057881, dEtot = 5.677e-05, dEband = 1.032e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4224413571530, which took 0.108 ms

iter_count = 114, r_2norm = 1.207e-05, tol*||rhs|| = 1.690e-05

Anderson update took 60.019 ms, out of which F'*F took 28.487 ms; b-Ax took 193.542 ms, out of which Lap took 173.407 ms
rank = 0, Mixing (+ precond) took 418.124 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050228, int_b + int_rho = -1.419e-13, checking this took 0.119 ms
2-norm of RHS = 708.7322069854620, which took 0.136 ms

iter_count = 240, r_2norm = 5.999e-04, tol*||rhs|| = 7.087e-04

Anderson update took 127.589 ms, out of which F'*F took 60.192 ms; b-Ax took 405.932 ms, out of which Lap took 363.607 ms
Solving Poisson took 861.079 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.075519 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.082848 
Total time for convolution: 	 convolve: 5.082881 
Total time for convolution: 	 convolve: 5.079103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.700 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 1.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.686 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.993 ms

This SCF took 27455.400 ms, scf error = 3.095e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.124129, lowerbound = -1.025796, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1699.101 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.769 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.035 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.828 ms
rank =  0, finding HY took 28.622 ms
rank =  0, distributing HY into block cyclic form took 18.020 ms
rank =  0, finding Y'*HY took 5.456 ms
Rank 0, Project_Hamiltonian used 73.958 ms
Total time for projection: 73.969 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -1.021909590445011
    last  calculated eigval = 0.025147990459046
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54021863527383
lambda[   5] =  -0.50868226887017
lambda[   6] =  -0.48481536425316
lambda[   7] =  -0.40020042433584
lambda[   8] =  -0.39539022803224
lambda[   9] =  -0.36019305081575
lambda[  10] =  -0.34937985719870
lambda[  11] =  -0.32279063245738
lambda[  12] =  -0.24694099677471
lambda[  13] =  -0.20282323859458
lambda[  14] =  -0.02840581191098
lambda[  15] =  -0.02517005129927
lambda[  16] =   0.01199734752888
lambda[  17] =   0.01867057165497
lambda[  18] =   0.02151749989746
lambda[  19] =   0.02197741614554
lambda[  20] =   0.02514799045905
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 5.570 ms
rank =  0, Distributing orbital back into band + domain format took 18.930 ms
rank = 0, Subspace_Rotation used 24.514 ms

Total time for subspace rotation: 24.519 ms
rank = 0, Efermi =  -0.057570000707 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.370 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.673 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1806.172 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.844 ms
rank = 0, D2D took 0.972 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -42.972858132947
Eband   =   -12.464659125705
E1      =    27.704571802075
E2      =   -11.371267023199
E3      =   -15.798202491892
Exc     =   -14.149325432302
Esc     =   -71.232914891488
Entropy =    -0.000000000617
dE = 2.219e-05, dEband = 1.049e-02
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -42.972858133, dEtot = 2.219e-05, dEband = 1.049e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2612108581049, which took 0.083 ms

iter_count = 114, r_2norm = 6.614e-06, tol*||rhs|| = 1.045e-05

Anderson update took 59.916 ms, out of which F'*F took 28.294 ms; b-Ax took 191.492 ms, out of which Lap took 171.515 ms
rank = 0, Mixing (+ precond) took 415.795 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050225, int_b + int_rho = -1.673e-13, checking this took 0.133 ms
2-norm of RHS = 708.8004814215128, which took 0.113 ms

iter_count = 234, r_2norm = 6.547e-04, tol*||rhs|| = 7.088e-04

Anderson update took 124.293 ms, out of which F'*F took 58.395 ms; b-Ax took 394.173 ms, out of which Lap took 352.790 ms
Solving Poisson took 838.235 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.076505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.085119 
Total time for convolution: 	 convolve: 5.079325 
Total time for convolution: 	 convolve: 5.082875 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.991 ms
---Transfer Veff_loc: D2D took 2.190 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.713 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.934 ms

This SCF took 27473.505 ms, scf error = 1.812e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.125148, lowerbound = -1.021910, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1692.087 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 28.276 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.082 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 32.383 ms
rank =  0, finding HY took 28.636 ms
rank =  0, distributing HY into block cyclic form took 17.838 ms
rank =  0, finding Y'*HY took 6.145 ms
Rank 0, Project_Hamiltonian used 85.030 ms
Total time for projection: 85.046 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.018032512560805
    last  calculated eigval = 0.028437834627179
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53626019430342
lambda[   5] =  -0.50485400677681
lambda[   6] =  -0.48105118503772
lambda[   7] =  -0.39642469187867
lambda[   8] =  -0.39171665669268
lambda[   9] =  -0.35631879171382
lambda[  10] =  -0.34561915382862
lambda[  11] =  -0.31894282901477
lambda[  12] =  -0.24320112204447
lambda[  13] =  -0.19892506901754
lambda[  14] =  -0.02625899500704
lambda[  15] =  -0.02152717393268
lambda[  16] =   0.01402961561987
lambda[  17] =   0.02053489957558
lambda[  18] =   0.02307011270028
lambda[  19] =   0.02415348878058
lambda[  20] =   0.02843783462718
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 5.568 ms
rank =  0, Distributing orbital back into band + domain format took 18.956 ms
rank = 0, Subspace_Rotation used 24.541 ms

Total time for subspace rotation: 24.546 ms
rank = 0, Efermi =  -0.055406152862 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.417 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.219 ms
rank = 0, Calculating density took 1810.265 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 0.952 ms
rank = 0, Transfering density took 0.955 ms
Etot    =   -42.972743870205
Eband   =   -12.364382506723
E1      =    27.652477334178
E2      =   -11.320126225711
E3      =   -15.809770758075
Exc     =   -14.157820789344
Esc     =   -71.232914891488
Entropy =    -0.000000000616
dE = 1.270e-05, dEband = 1.114e-02
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -42.972743870, dEtot = 1.270e-05, dEband = 1.114e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1683564484077, which took 0.071 ms

iter_count = 114, r_2norm = 5.236e-06, tol*||rhs|| = 6.734e-06

Anderson update took 59.901 ms, out of which F'*F took 28.486 ms; b-Ax took 192.482 ms, out of which Lap took 172.080 ms
rank = 0, Mixing (+ precond) took 416.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050223, int_b + int_rho = -1.855e-13, checking this took 0.117 ms
2-norm of RHS = 708.8121988361745, which took 0.127 ms

iter_count = 192, r_2norm = 7.069e-04, tol*||rhs|| = 7.088e-04

Anderson update took 101.829 ms, out of which F'*F took 47.681 ms; b-Ax took 323.139 ms, out of which Lap took 289.165 ms
Solving Poisson took 687.336 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.079495 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.081339 
Total time for convolution: 	 convolve: 6.355314 
Total time for convolution: 	 convolve: 5.078037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.156 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.466 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.690 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.187 ms

This SCF took 28546.837 ms, scf error = 1.099e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128438, lowerbound = -1.018033, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1696.211 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 28.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.078 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 32.629 ms
rank =  0, finding HY took 28.646 ms
rank =  0, distributing HY into block cyclic form took 17.779 ms
rank =  0, finding Y'*HY took 5.493 ms
Rank 0, Project_Hamiltonian used 84.579 ms
Total time for projection: 84.593 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.017607394433536
    last  calculated eigval = 0.028919879427980
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53587039020961
lambda[   5] =  -0.50453347872682
lambda[   6] =  -0.48065682919678
lambda[   7] =  -0.39597652761816
lambda[   8] =  -0.39139486600054
lambda[   9] =  -0.35597891143219
lambda[  10] =  -0.34519635410068
lambda[  11] =  -0.31856943292240
lambda[  12] =  -0.24268617613430
lambda[  13] =  -0.19852958771884
lambda[  14] =  -0.02537152536570
lambda[  15] =  -0.02104891106576
lambda[  16] =   0.01470729002079
lambda[  17] =   0.02108978004331
lambda[  18] =   0.02356174483808
lambda[  19] =   0.02490992422057
lambda[  20] =   0.02891987942798
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 5.561 ms
rank =  0, Distributing orbital back into band + domain format took 18.890 ms
rank = 0, Subspace_Rotation used 24.463 ms

Total time for subspace rotation: 24.468 ms
rank = 0, Efermi =  -0.054520809895 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.421 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.474 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.245 ms
rank = 0, Calculating density took 1813.767 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 0.969 ms
rank = 0, Transfering density took 0.972 ms
Etot    =   -42.972736449275
Eband   =   -12.354182109465
E1      =    27.649350726736
E2      =   -11.313273752948
E3      =   -15.808731657658
Exc     =   -14.156995585049
Esc     =   -71.232914891488
Entropy =    -0.000000000616
dE = 8.245e-07, dEband = 1.133e-03
rank = 0, Calculating/Estimating energy took 1.800 ms, Etot = -42.972736449, dEtot = 8.245e-07, dEband = 1.133e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0774833936369, which took 0.065 ms

iter_count = 114, r_2norm = 2.180e-06, tol*||rhs|| = 3.099e-06

Anderson update took 59.975 ms, out of which F'*F took 28.319 ms; b-Ax took 192.220 ms, out of which Lap took 171.889 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.445 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050233, int_b + int_rho = -9.095e-14, checking this took 0.102 ms
2-norm of RHS = 708.7747397899816, which took 0.133 ms

iter_count = 222, r_2norm = 5.658e-04, tol*||rhs|| = 7.088e-04

Anderson update took 118.051 ms, out of which F'*F took 55.359 ms; b-Ax took 374.993 ms, out of which Lap took 335.469 ms
Solving Poisson took 795.364 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.109366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.087484 
Total time for convolution: 	 convolve: 5.085525 
Total time for convolution: 	 convolve: 5.079646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.142 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.194 ms

This SCF took 27411.023 ms, scf error = 8.483e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128920, lowerbound = -1.017607, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1699.827 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 24.867 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.042 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 28.933 ms
rank =  0, finding HY took 28.668 ms
rank =  0, distributing HY into block cyclic form took 17.944 ms
rank =  0, finding Y'*HY took 5.454 ms
Rank 0, Project_Hamiltonian used 81.026 ms
Total time for projection: 81.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.015493482937299
    last  calculated eigval = 0.031539137447415
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53371752654168
lambda[   5] =  -0.50243267348762
lambda[   6] =  -0.47852214283615
lambda[   7] =  -0.39385539211583
lambda[   8] =  -0.38931920989344
lambda[   9] =  -0.35382258241045
lambda[  10] =  -0.34305966135484
lambda[  11] =  -0.31648252551059
lambda[  12] =  -0.24052817189930
lambda[  13] =  -0.19641261581763
lambda[  14] =  -0.02062102365852
lambda[  15] =  -0.01867172724378
lambda[  16] =   0.02038336970188
lambda[  17] =   0.02617055600448
lambda[  18] =   0.02792985080200
lambda[  19] =   0.02969549631204
lambda[  20] =   0.03153913744741
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 5.552 ms
rank =  0, Distributing orbital back into band + domain format took 18.699 ms
rank = 0, Subspace_Rotation used 24.266 ms

Total time for subspace rotation: 24.271 ms
rank = 0, Efermi =  -0.049855836750 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.168 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.892 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1813.784 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.786 ms
rank = 0, D2D took 1.898 ms
rank = 0, Transfering density took 1.901 ms
Etot    =   -42.972714223509
Eband   =   -12.298880862819
E1      =    27.621182044077
E2      =   -11.285305499750
E3      =   -15.813025017781
Exc     =   -14.160431030189
Esc     =   -71.232914891488
Entropy =    -0.000000000621
dE = 2.470e-06, dEband = 6.145e-03
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -42.972714224, dEtot = 2.470e-06, dEband = 6.145e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0785824195835, which took 0.067 ms

iter_count = 108, r_2norm = 2.613e-06, tol*||rhs|| = 3.143e-06

Anderson update took 56.725 ms, out of which F'*F took 27.071 ms; b-Ax took 182.739 ms, out of which Lap took 163.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.766 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050228, int_b + int_rho = -1.419e-13, checking this took 0.116 ms
2-norm of RHS = 708.7953712698949, which took 0.081 ms

iter_count = 186, r_2norm = 6.212e-04, tol*||rhs|| = 7.088e-04

Anderson update took 98.505 ms, out of which F'*F took 46.460 ms; b-Ax took 312.986 ms, out of which Lap took 280.047 ms
Solving Poisson took 666.235 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.096102 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.086689 
Total time for convolution: 	 convolve: 5.084981 
Total time for convolution: 	 convolve: 5.082262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.770 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.180 ms

This SCF took 27234.097 ms, scf error = 4.059e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131539, lowerbound = -1.015493, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1692.308 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 28.365 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.083 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 32.475 ms
rank =  0, finding HY took 28.645 ms
rank =  0, distributing HY into block cyclic form took 17.768 ms
rank =  0, finding Y'*HY took 5.625 ms
Rank 0, Project_Hamiltonian used 84.542 ms
Total time for projection: 84.552 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.166 ms
    first calculated eigval = -1.014671316646764
    last  calculated eigval = 0.032874059875467
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53285596957442
lambda[   5] =  -0.50157717440410
lambda[   6] =  -0.47767256332481
lambda[   7] =  -0.39300810094953
lambda[   8] =  -0.38849999470617
lambda[   9] =  -0.35296119920540
lambda[  10] =  -0.34220711188964
lambda[  11] =  -0.31568180370921
lambda[  12] =  -0.23965950047716
lambda[  13] =  -0.19552228282096
lambda[  14] =  -0.01783333553970
lambda[  15] =  -0.01682492039659
lambda[  16] =   0.02384899018946
lambda[  17] =   0.02985219008299
lambda[  18] =   0.03100278159378
lambda[  19] =   0.03282989556355
lambda[  20] =   0.03287405987547
==subpsace eigenproblem: bcast eigvals took 0.064 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 5.554 ms
rank =  0, Distributing orbital back into band + domain format took 18.939 ms
rank = 0, Subspace_Rotation used 24.507 ms

Total time for subspace rotation: 24.513 ms
rank = 0, Efermi =  -0.047224311952 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.325 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.789 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.233 ms
rank = 0, Calculating density took 1809.924 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
rank = 0, D2D took 0.960 ms
rank = 0, Transfering density took 0.964 ms
Etot    =   -42.972825249052
Eband   =   -12.276726252813
E1      =    27.610463974281
E2      =   -11.273542352602
E3      =   -15.814296425745
Exc     =   -14.161486856753
Esc     =   -71.232914891488
Entropy =    -0.000000000625
dE = 1.234e-05, dEband = 2.462e-03
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -42.972825249, dEtot = 1.234e-05, dEband = 2.462e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0490946336989, which took 0.062 ms

iter_count = 108, r_2norm = 1.947e-06, tol*||rhs|| = 1.964e-06

Anderson update took 56.996 ms, out of which F'*F took 26.759 ms; b-Ax took 181.747 ms, out of which Lap took 162.739 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.103 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050224, int_b + int_rho = -1.783e-13, checking this took 0.149 ms
2-norm of RHS = 708.7986899846094, which took 0.118 ms

iter_count = 156, r_2norm = 6.516e-04, tol*||rhs|| = 7.088e-04

Anderson update took 86.390 ms, out of which F'*F took 38.941 ms; b-Ax took 263.527 ms, out of which Lap took 235.645 ms
Solving Poisson took 563.223 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.080351 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.110704 
Total time for convolution: 	 convolve: 5.084546 
Total time for convolution: 	 convolve: 5.083014 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.731 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.451 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.690 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.175 ms

This SCF took 27130.103 ms, scf error = 2.591e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132874, lowerbound = -1.014671, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1694.593 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.384 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.164 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 32.570 ms
rank =  0, finding HY took 29.737 ms
rank =  0, distributing HY into block cyclic form took 17.364 ms
rank =  0, finding Y'*HY took 6.677 ms
Rank 0, Project_Hamiltonian used 86.377 ms
Total time for projection: 86.392 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -1.014490758765003
    last  calculated eigval = 0.034434267814601
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53268040499783
lambda[   5] =  -0.50141069211971
lambda[   6] =  -0.47749575541427
lambda[   7] =  -0.39282691689063
lambda[   8] =  -0.38833156853685
lambda[   9] =  -0.35279306945302
lambda[  10] =  -0.34203246942495
lambda[  11] =  -0.31550618517776
lambda[  12] =  -0.23947825197023
lambda[  13] =  -0.19536205065519
lambda[  14] =  -0.01767655255705
lambda[  15] =  -0.01512606486702
lambda[  16] =   0.02538513060453
lambda[  17] =   0.03112100550346
lambda[  18] =   0.03202134680630
lambda[  19] =   0.03336953280985
lambda[  20] =   0.03443426781460
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 6.088 ms
rank =  0, Distributing orbital back into band + domain format took 18.481 ms
rank = 0, Subspace_Rotation used 24.585 ms

Total time for subspace rotation: 24.591 ms
rank = 0, Efermi =  -0.046866187436 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 4.404 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.555 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1814.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.839 ms
rank = 0, D2D took 0.958 ms
rank = 0, Transfering density took 0.965 ms
Etot    =   -42.972876488779
Eband   =   -12.272232284938
E1      =    27.608226305592
E2      =   -11.271211134235
E3      =   -15.814542318262
Exc     =   -14.161709069823
Esc     =   -71.232914891488
Entropy =    -0.000000000619
dE = 5.693e-06, dEband = 4.993e-04
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -42.972876489, dEtot = 5.693e-06, dEband = 4.993e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0388726207915, which took 0.051 ms

iter_count = 114, r_2norm = 9.271e-07, tol*||rhs|| = 1.555e-06

Anderson update took 59.873 ms, out of which F'*F took 28.365 ms; b-Ax took 192.598 ms, out of which Lap took 172.239 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.809 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050224, int_b + int_rho = -1.783e-13, checking this took 0.124 ms
2-norm of RHS = 708.7997997908617, which took 0.130 ms

iter_count = 144, r_2norm = 6.617e-04, tol*||rhs|| = 7.088e-04

Anderson update took 76.414 ms, out of which F'*F took 35.888 ms; b-Ax took 242.361 ms, out of which Lap took 216.956 ms
Solving Poisson took 516.432 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.079484 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.105330 
Total time for convolution: 	 convolve: 5.082525 
Total time for convolution: 	 convolve: 5.077099 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.389 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.019 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.402 ms
---Transfer Veff_loc: D2D took 1.452 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.698 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.180 ms

This SCF took 27109.780 ms, scf error = 1.965e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134434, lowerbound = -1.014491, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1692.842 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 28.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.038 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 32.585 ms
rank =  0, finding HY took 28.580 ms
rank =  0, distributing HY into block cyclic form took 17.922 ms
rank =  0, finding Y'*HY took 5.447 ms
Rank 0, Project_Hamiltonian used 84.562 ms
Total time for projection: 84.578 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -1.014348139589546
    last  calculated eigval = 0.034388862083170
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53254095797028
lambda[   5] =  -0.50127738403151
lambda[   6] =  -0.47735893226573
lambda[   7] =  -0.39268385861607
lambda[   8] =  -0.38819422563646
lambda[   9] =  -0.35266147818539
lambda[  10] =  -0.34190472486823
lambda[  11] =  -0.31536219292086
lambda[  12] =  -0.23934581924691
lambda[  13] =  -0.19523492087907
lambda[  14] =  -0.01759801160616
lambda[  15] =  -0.01520180118737
lambda[  16] =   0.02510688883816
lambda[  17] =   0.03037885323342
lambda[  18] =   0.03178810807093
lambda[  19] =   0.03328459885037
lambda[  20] =   0.03438886208317
==subpsace eigenproblem: bcast eigvals took 0.064 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 5.609 ms
rank =  0, Distributing orbital back into band + domain format took 18.911 ms
rank = 0, Subspace_Rotation used 24.533 ms

Total time for subspace rotation: 24.540 ms
rank = 0, Efermi =  -0.046796612836 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.425 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.658 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.314 ms
rank = 0, Calculating density took 1811.520 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.754 ms
rank = 0, D2D took 0.849 ms
rank = 0, Transfering density took 0.852 ms
Etot    =   -42.972926184130
Eband   =   -12.268705512997
E1      =    27.606549052457
E2      =   -11.269297700257
E3      =   -15.814641814494
Exc     =   -14.161794346233
Esc     =   -71.232914891488
Entropy =    -0.000000000619
dE = 5.522e-06, dEband = 3.919e-04
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -42.972926184, dEtot = 5.522e-06, dEband = 3.919e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0318380459951, which took 0.058 ms

iter_count = 114, r_2norm = 8.370e-07, tol*||rhs|| = 1.274e-06

Anderson update took 60.119 ms, out of which F'*F took 28.301 ms; b-Ax took 192.039 ms, out of which Lap took 171.881 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.203 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050223, int_b + int_rho = -1.855e-13, checking this took 0.114 ms
2-norm of RHS = 708.7995699182217, which took 0.159 ms

iter_count = 120, r_2norm = 6.036e-04, tol*||rhs|| = 7.088e-04

Anderson update took 63.655 ms, out of which F'*F took 29.947 ms; b-Ax took 202.942 ms, out of which Lap took 181.493 ms
Solving Poisson took 431.462 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.081143 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.086910 
Total time for convolution: 	 convolve: 5.111551 
Total time for convolution: 	 convolve: 5.077996 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.567 ms
---Transfer Veff_loc: D2D took 1.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.715 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.212 ms

This SCF took 27028.989 ms, scf error = 1.570e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134389, lowerbound = -1.014348, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1699.117 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 24.095 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.068 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 28.187 ms
rank =  0, finding HY took 28.685 ms
rank =  0, distributing HY into block cyclic form took 17.856 ms
rank =  0, finding Y'*HY took 5.516 ms
Rank 0, Project_Hamiltonian used 80.272 ms
Total time for projection: 80.287 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.594 ms
rank = 0, Solve_Generalized_EigenProblem used 1.416 ms
    first calculated eigval = -1.014228539790787
    last  calculated eigval = 0.034614039429537
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53243936973387
lambda[   5] =  -0.50118464249792
lambda[   6] =  -0.47726262935583
lambda[   7] =  -0.39257705801219
lambda[   8] =  -0.38809993279978
lambda[   9] =  -0.35256738209364
lambda[  10] =  -0.34180897600343
lambda[  11] =  -0.31525822896672
lambda[  12] =  -0.23924830733440
lambda[  13] =  -0.19514133436755
lambda[  14] =  -0.01753028703405
lambda[  15] =  -0.01498621515239
lambda[  16] =   0.02502206740240
lambda[  17] =   0.03039360535894
lambda[  18] =   0.03179037782168
lambda[  19] =   0.03335446030070
lambda[  20] =   0.03461403942954
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.435 ms
rank =  0, subspace rotation using ScaLAPACK took 5.670 ms
rank =  0, Distributing orbital back into band + domain format took 19.007 ms
rank = 0, Subspace_Rotation used 24.696 ms

Total time for subspace rotation: 24.702 ms
rank = 0, Efermi =  -0.046720265325 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.341 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.591 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.248 ms
rank = 0, Calculating density took 1813.845 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
rank = 0, D2D took 0.978 ms
rank = 0, Transfering density took 0.985 ms
Etot    =   -42.972943880827
Eband   =   -12.266091906462
E1      =    27.605160351993
E2      =   -11.268011519336
E3      =   -15.814833010148
Exc     =   -14.161941963736
Esc     =   -71.232914891488
Entropy =    -0.000000000619
dE = 1.966e-06, dEband = 2.904e-04
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -42.972943881, dEtot = 1.966e-06, dEband = 2.904e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0166412308644, which took 0.052 ms

iter_count = 108, r_2norm = 6.653e-07, tol*||rhs|| = 6.656e-07

Anderson update took 56.647 ms, out of which F'*F took 27.042 ms; b-Ax took 182.654 ms, out of which Lap took 163.260 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.770 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050221, int_b + int_rho = -2.074e-13, checking this took 0.147 ms
2-norm of RHS = 708.7986848431524, which took 0.124 ms

iter_count = 144, r_2norm = 6.381e-04, tol*||rhs|| = 7.088e-04

Anderson update took 76.549 ms, out of which F'*F took 35.836 ms; b-Ax took 242.446 ms, out of which Lap took 217.072 ms
Solving Poisson took 516.511 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.079428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.322 ms
Total time for convolution: 	 convolve: 5.087138 
Total time for convolution: 	 convolve: 5.093379 
Total time for convolution: 	 convolve: 5.084023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.704 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.234 ms

This SCF took 27083.036 ms, scf error = 1.242e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134614, lowerbound = -1.014229, upperbound = 267.585293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1696.335 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.962 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.011 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 28.001 ms
rank =  0, finding HY took 28.703 ms
rank =  0, distributing HY into block cyclic form took 17.713 ms
rank =  0, finding Y'*HY took 5.531 ms
Rank 0, Project_Hamiltonian used 80.434 ms
Total time for projection: 80.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -1.013950529951464
    last  calculated eigval = 0.035921012110023
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53220059360474
lambda[   5] =  -0.50096382782209
lambda[   6] =  -0.47703245878034
lambda[   7] =  -0.39232488479438
lambda[   8] =  -0.38787810913178
lambda[   9] =  -0.35234162654282
lambda[  10] =  -0.34157476151037
lambda[  11] =  -0.31502052270705
lambda[  12] =  -0.23900930705059
lambda[  13] =  -0.19491258941508
lambda[  14] =  -0.01733327697513
lambda[  15] =  -0.01374771115060
lambda[  16] =   0.02549329711504
lambda[  17] =   0.03139664549416
lambda[  18] =   0.03249633296324
lambda[  19] =   0.03398855924210
lambda[  20] =   0.03592101211002
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 5.533 ms
rank =  0, Distributing orbital back into band + domain format took 19.033 ms
rank = 0, Subspace_Rotation used 24.580 ms

Total time for subspace rotation: 24.584 ms
rank = 0, Efermi =  -0.046490461465 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.422 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.572 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.226 ms
rank = 0, Calculating density took 1809.892 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.832 ms
rank = 0, D2D took 0.967 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -42.972970196240
Eband   =   -12.259877812844
E1      =    27.601998140136
E2      =   -11.264851177861
E3      =   -15.815187625074
Exc     =   -14.162214434362
Esc     =   -71.232914891488
Entropy =    -0.000000000617
dE = 2.924e-06, dEband = 6.905e-04
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -42.972970196, dEtot = 2.924e-06, dEband = 6.905e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0139690364435, which took 0.100 ms

iter_count = 114, r_2norm = 3.349e-07, tol*||rhs|| = 5.588e-07

Anderson update took 60.829 ms, out of which F'*F took 28.176 ms; b-Ax took 191.776 ms, out of which Lap took 171.711 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.125 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002050242, int_rho =  26.00000002050224, int_b + int_rho = -1.783e-13, checking this took 0.138 ms
2-norm of RHS = 708.7987450472256, which took 0.138 ms

iter_count = 102, r_2norm = 6.021e-04, tol*||rhs|| = 7.088e-04

Anderson update took 54.622 ms, out of which F'*F took 28.569 ms; b-Ax took 175.743 ms, out of which Lap took 157.866 ms
Solving Poisson took 369.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.126 ms
Total time for convolution: 	 convolve: 5.087313 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.104247 
Total time for convolution: 	 convolve: 5.092861 
Total time for convolution: 	 convolve: 5.100879 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 1.446 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.435 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.908 ms

This SCF took 26995.517 ms, scf error = 7.020e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.53220059360474, occ[   4] =   2.00000000000000
lambda[   5] =  -0.50096382782209, occ[   5] =   2.00000000000000
lambda[   6] =  -0.47703245878034, occ[   6] =   2.00000000000000
lambda[   7] =  -0.39232488479438, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38787810913178, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35234162654282, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34157476151037, occ[  10] =   2.00000000000000
lambda[  11] =  -0.31502052270705, occ[  11] =   2.00000000000000
lambda[  12] =  -0.23900930705059, occ[  12] =   2.00000000000000
lambda[  13] =  -0.19491258941508, occ[  13] =   2.00000000000000
lambda[  14] =  -0.01733327697513, occ[  14] =   0.00000002020490
lambda[  15] =  -0.01374771115060, occ[  15] =   0.00000000029736
lambda[  16] =   0.02549329711504, occ[  16] =   0.00000000000000
lambda[  17] =   0.03139664549416, occ[  17] =   0.00000000000000
lambda[  18] =   0.03249633296324, occ[  18] =   0.00000000000000
lambda[  19] =   0.03398855924210, occ[  19] =   0.00000000000000
lambda[  20] =   0.03592101211002, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.640 ms, time for Allreduce/Reduce: 11.085 ms 
Time for calculating local force components: 21.452 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000054268472   0.00000617061048  -1.05979654573630
  0.00000004673601  -0.04781129753687  -0.02458344909611
  0.00000001420736   0.04781107982666  -0.02458336356376
 -0.00000013660458  -0.03173118569509   0.04152379573594
 -0.00000009984003   0.03173129939288   0.04152387679453
 -0.00000186962344  -0.17948436297363   0.15653780996481
  0.00000056110123   0.17948461041760   0.15653644800723
 -0.00000113239133  -0.02471992032241   0.02552428791168
 -0.00000008296599   0.02472317481378   0.02552081573737
force_loc = 
  0.00000148132245  -0.00000253515143   1.03800236563857
 -0.00000017179686   0.05026595723974   0.02564941456840
  0.00000078218831  -0.05026341469265   0.02564650026268
 -0.00000103762879   0.03312749643187  -0.04349258531071
 -0.00000043111995  -0.03312818859855  -0.04349232924372
 -0.00000391806423   0.18079499494537  -0.14576012442059
  0.00000403098074  -0.18079714788041  -0.14576328091994
  0.00000151927530   0.02213646496811  -0.03465442187679
  0.00000016081563  -0.02214115228933  -0.03465352922415
Time for calculating nonlocal force components: 41.561 ms
[32mforces_xc: 
[0m[32m  0.00000006028409   0.00000026733758   0.03115654681107
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000021146984   0.00443610686283  -0.00934035174460
[0m[32m  0.00000018443214  -0.00443611463454  -0.00934049317326
[0m[32m  0.00000019839905   0.00027742921465   0.00429385278689
[0m[32m  0.00000006295860  -0.00027759819510   0.00429351242586
[0mTime for calculating XC forces components: 29.996 ms
 Cartesian force = 
  0.00000105797613   0.00000366567534   0.00927917200944
 -0.00000006600653   0.00245442258159   0.00098277076838
  0.00000085544999  -0.00245257198727   0.00097994199502
 -0.00000111517906   0.00139607361550  -0.00205198427866
 -0.00000047190567  -0.00139712632695  -0.00205164715308
 -0.00000594010319   0.00574650171329   0.00135413909573
  0.00000483556843  -0.00574888921863   0.00134947921013
  0.00000064433734  -0.00230626326094  -0.00491947588213
  0.00000019986255   0.00230418720807  -0.00492239576482
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 384.564 ms
The program took 445.750 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:35:39
Job ID:        2266910
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:31:24,vmem=8296K,walltime=00:07:37,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-13-1
---------------------------------------
