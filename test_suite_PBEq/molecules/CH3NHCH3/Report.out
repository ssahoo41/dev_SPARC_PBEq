---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:44
Job ID:    2266473
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:50
Job ID:    2266473
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 20.212 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 4.664 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 112.348 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.950 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.121 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.352822	   12.028688	   10.000000	
    8.332683	    7.971312	   12.402182	
    8.332683	    7.971312	    7.597818	
   11.667317	    8.307129	   12.417910	
   11.667317	    8.307129	    7.582090	
    9.771971	   10.594250	   13.948777	
    9.771971	   10.594250	    6.051223	
    9.888718	    9.362730	   12.291960	
    9.888718	    9.362730	    7.708040	
    9.888718	   10.882327	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.208 ms
Set up communicators.

--set up spincomm took 2.200 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 17, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 17 
rank =  0, my blacs rank = 0, BLCYC size (85000, 17), actual size (85000, 17)
rank = 0, mb = nb = 17, mbQ = nbQ = 64
rank = 0, nr_Hp = 17, nc_Hp = 17
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.041 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 17
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.308 ms

Calculate_SplineDerivRadFun took 0.200 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.261 ms.
time spent on vectorized spline interp: 2.634 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.006 ms.
time spent on vectorized spline interp: 1.616 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.499 ms.
time spent on vectorized spline interp: 1.615 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.374 ms.

Calculating rb for all atom types took 16.015 ms
----------------------
Estimated memory usage
Total: 663.08 MB
orbitals             : 389.10 MB
global sized vectors : 213.62 MB
subspace matrices : 81.28 kB
others : 60.28 MB
----------------------------------------------
Estimated memory usage per processor: 55.26 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.917 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -20.0000000336782, sum_int_rho = 19.3054161804632
PosCharge = 20.000000033678, NegCharge = -19.305416180463, scal_fac = 1.035978703941
After scaling, int_rho = 20.0000000336781, PosCharge + NegCharge - NetCharge = 3.553e-14
--Calculate Vref took 0.456 ms
--Calculate rho_guess took 2.712 ms

 integral of b = -20.0000000336782,
 int{b} + Nelectron + NetCharge = -3.368e-08,
 Esc = -47.4489591739868,
 MPI_Reduce took 6.807 ms

Calculating b & b_ref took 16.383 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.020 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.030 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.004 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.058 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.007 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.010 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 33.046 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367813, int_b + int_rho = -3.092e-13, checking this took 0.090 ms
2-norm of RHS = 745.4295844168781, which took 0.832 ms

iter_count = 414, r_2norm = 7.316e-04, tol*||rhs|| = 7.454e-04

Anderson update took 230.567 ms, out of which F'*F took 103.536 ms; b-Ax took 702.889 ms, out of which Lap took 629.623 ms
Solving Poisson took 1496.804 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.361 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.257002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
Total time for convolution: 	 convolve: 5.187670 
Total time for convolution: 	 convolve: 5.237569 
Total time for convolution: 	 convolve: 5.178009 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.183 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
rank = 0, XC calculation took 24708.424 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.687 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.140 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.667 ms
    Lanczos iter 54, eigmin  = -0.893111000, eigmax = 264.929635434, err_eigmin = 1.096e-03, err_eigmax = 9.975e-03
rank =   0, Lanczos took 122.636 ms, eigmin = -0.893111000480, eigmax = 267.578931788301

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.292910, lowerbound = -0.993111, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1423.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.961 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.073 ms
rank =  0, Distribute data + matrix mult took 3.041 ms
rank =  0, finding HY took 23.688 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.433 ms
Rank 0, Project_Hamiltonian used 30.199 ms
Total time for projection: 30.217 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.736 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.805 ms
    first calculated eigval = 2.763110302374693
    last  calculated eigval = 3.251451812302571
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =   2.76311030237469
lambda[   2] =   2.81935333053072
lambda[   3] =   2.85655014102848
lambda[   4] =   2.90086561448638
lambda[   5] =   2.91826564106179
lambda[   6] =   2.94744890122875
lambda[   7] =   2.97545644824054
lambda[   8] =   2.99003789184361
lambda[   9] =   3.02727607082836
lambda[  10] =   3.04536283616253
lambda[  11] =   3.05777602736342
lambda[  12] =   3.09455701729990
lambda[  13] =   3.11750962023666
lambda[  14] =   3.13530519970611
lambda[  15] =   3.14164370525833
lambda[  16] =   3.23202236792521
lambda[  17] =   3.25145181230257
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.841 ms
rank =  0, subspace rotation using ScaLAPACK took 3.586 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.593 ms

Total time for subspace rotation: 3.595 ms
rank = 0, Efermi =   3.051569451579 calculate fermi energy took 0.056 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351452, lowerbound = -0.993111, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1425.677 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.905 ms
rank =  0, finding HY took 23.634 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.366 ms
Rank 0, Project_Hamiltonian used 29.930 ms
Total time for projection: 29.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.029 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.684932340001381
    last  calculated eigval = 0.474619974924414
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.68493234000138
lambda[   2] =  -0.39163992772819
lambda[   3] =  -0.26912493847208
lambda[   4] =  -0.15573105392520
lambda[   5] =  -0.12603886973410
lambda[   6] =   0.01772917703220
lambda[   7] =   0.07315500914787
lambda[   8] =   0.16153712762664
lambda[   9] =   0.23309791470994
lambda[  10] =   0.32085564867939
lambda[  11] =   0.33190270090141
lambda[  12] =   0.35199065736182
lambda[  13] =   0.37781804096110
lambda[  14] =   0.39902373806713
lambda[  15] =   0.40432962590867
lambda[  16] =   0.42089523223109
lambda[  17] =   0.47461997492441
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.452 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.460 ms

Total time for subspace rotation: 3.461 ms
rank = 0, Efermi =   0.326379170224 calculate fermi energy took 0.034 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.574620, lowerbound = -0.993111, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1421.513 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.804 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.018 ms
rank =  0, Distribute data + matrix mult took 3.797 ms
rank =  0, finding HY took 23.554 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.327 ms
Rank 0, Project_Hamiltonian used 30.705 ms
Total time for projection: 30.712 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.901887463659645
    last  calculated eigval = 0.160121141519275
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.90188746365965
lambda[   2] =  -0.73427021886715
lambda[   3] =  -0.66305824908900
lambda[   4] =  -0.52050200179326
lambda[   5] =  -0.48146274702231
lambda[   6] =  -0.47267647958103
lambda[   7] =  -0.42334979407418
lambda[   8] =  -0.40918397340544
lambda[   9] =  -0.38317078527796
lambda[  10] =  -0.17970896530116
lambda[  11] =   0.06157229870330
lambda[  12] =   0.06938299361009
lambda[  13] =   0.10088937036106
lambda[  14] =   0.11493194225297
lambda[  15] =   0.13188189110377
lambda[  16] =   0.14054342878652
lambda[  17] =   0.16012114151928
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 3.721 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.734 ms

Total time for subspace rotation: 3.735 ms
rank = 0, Efermi =   0.032878037620 calculate fermi energy took 0.029 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.260121, lowerbound = -0.993111, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1418.781 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.889 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 2.930 ms
rank =  0, finding HY took 23.639 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.412 ms
Rank 0, Project_Hamiltonian used 30.004 ms
Total time for projection: 30.008 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.114 ms
    first calculated eigval = -0.902545772013111
    last  calculated eigval = 0.094436692456157
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.90254577201311
lambda[   2] =  -0.73723873633591
lambda[   3] =  -0.66730315169355
lambda[   4] =  -0.52546052293936
lambda[   5] =  -0.48734196676312
lambda[   6] =  -0.48548011341439
lambda[   7] =  -0.44056025341519
lambda[   8] =  -0.41627166660988
lambda[   9] =  -0.41030828359251
lambda[  10] =  -0.26701177727100
lambda[  11] =   0.01476738856974
lambda[  12] =   0.03705344098529
lambda[  13] =   0.04733088646488
lambda[  14] =   0.06037761030559
lambda[  15] =   0.07257770955879
lambda[  16] =   0.07692821782347
lambda[  17] =   0.09443669245616
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.125 ms
rank =  0, subspace rotation using ScaLAPACK took 3.649 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.658 ms

Total time for subspace rotation: 3.659 ms
rank = 0, Efermi =  -0.013926814032 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 1.887 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 5954.950 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
rank = 0, D2D took 0.431 ms
rank = 0, Transfering density took 0.437 ms
Etot    =   -26.676483315506
Eband   =   -10.679044487599
E1      =    22.306201427474
E2      =    -7.831492136007
E3      =   -10.698240467884
Exc     =    -9.384413684290
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 2.668e+00, dEband = 1.068e+00
rank = 0, Calculating/Estimating energy took 0.975 ms, Etot = -26.676483316, dEtot = 2.668e+00, dEband = 1.068e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 47.6596953189982, which took 0.043 ms

iter_count = 96, r_2norm = 1.509e-03, tol*||rhs|| = 1.906e-03

Anderson update took 51.707 ms, out of which F'*F took 24.458 ms; b-Ax took 163.054 ms, out of which Lap took 146.596 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.337 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367812, int_b + int_rho = -3.201e-13, checking this took 0.125 ms
2-norm of RHS = 741.1995218598339, which took 0.104 ms

iter_count = 282, r_2norm = 6.882e-04, tol*||rhs|| = 7.412e-04

Anderson update took 153.192 ms, out of which F'*F took 72.104 ms; b-Ax took 479.359 ms, out of which Lap took 431.235 ms
Solving Poisson took 1018.952 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.803 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.117263 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.729 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.184157 
Total time for convolution: 	 convolve: 5.167296 
Total time for convolution: 	 convolve: 5.105592 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.368 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.313 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 31957.229 ms, scf error = 1.983e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194437, lowerbound = -0.902546, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1425.435 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.889 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 2.939 ms
rank =  0, finding HY took 23.657 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.353 ms
Rank 0, Project_Hamiltonian used 29.981 ms
Total time for projection: 29.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.879111149084004
    last  calculated eigval = 0.069086037070836
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.87911114908400
lambda[   2] =  -0.70678301947067
lambda[   3] =  -0.63755094023445
lambda[   4] =  -0.50117058475399
lambda[   5] =  -0.45931079518913
lambda[   6] =  -0.45901161613029
lambda[   7] =  -0.41259197655812
lambda[   8] =  -0.38863687351341
lambda[   9] =  -0.38550309257452
lambda[  10] =  -0.24430062364846
lambda[  11] =  -0.01471510671100
lambda[  12] =   0.01613498604314
lambda[  13] =   0.02132131724435
lambda[  14] =   0.02951790209426
lambda[  15] =   0.04272404078572
lambda[  16] =   0.04871280833907
lambda[  17] =   0.06908603707084
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 3.799 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.832 ms

Total time for subspace rotation: 3.833 ms
rank = 0, Efermi =  -0.043409309332 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.873 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1461.875 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
rank = 0, D2D took 0.429 ms
rank = 0, Transfering density took 0.437 ms
Etot    =   -26.636155612123
Eband   =   -10.147941342810
E1      =    21.810467663654
E2      =    -7.807638283027
E3      =   -10.854916673685
Exc     =    -9.512277714697
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.033e-03, dEband = 5.311e-02
rank = 0, Calculating/Estimating energy took 1.484 ms, Etot = -26.636155612, dEtot = 4.033e-03, dEband = 5.311e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 12.6464271717189, which took 1.137 ms

iter_count = 102, r_2norm = 4.731e-04, tol*||rhs|| = 5.059e-04

Anderson update took 54.476 ms, out of which F'*F took 25.823 ms; b-Ax took 173.896 ms, out of which Lap took 156.226 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.549 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367810, int_b + int_rho = -3.347e-13, checking this took 0.110 ms
2-norm of RHS = 733.8950450037504, which took 0.120 ms

iter_count = 300, r_2norm = 6.645e-04, tol*||rhs|| = 7.339e-04

Anderson update took 159.740 ms, out of which F'*F took 74.122 ms; b-Ax took 504.278 ms, out of which Lap took 451.416 ms
Solving Poisson took 1078.720 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Total time for convolution: 	 convolve: 5.177178 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.201303 
Total time for convolution: 	 convolve: 5.195449 
Total time for convolution: 	 convolve: 5.174055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.245 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.159 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.335 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 27908.247 ms, scf error = 1.391e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169086, lowerbound = -0.879111, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1417.339 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.870 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 2.920 ms
rank =  0, finding HY took 23.693 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.474 ms
Rank 0, Project_Hamiltonian used 30.114 ms
Total time for projection: 30.127 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.018 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.831549918856865
    last  calculated eigval = 0.059141508047590
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83154991885686
lambda[   2] =  -0.64622757482754
lambda[   3] =  -0.57798674893278
lambda[   4] =  -0.45124889920415
lambda[   5] =  -0.40537800375845
lambda[   6] =  -0.40297647511401
lambda[   7] =  -0.35536667542772
lambda[   8] =  -0.33409722141963
lambda[   9] =  -0.33267668743429
lambda[  10] =  -0.19340542805889
lambda[  11] =  -0.02734796795963
lambda[  12] =   0.00579148637434
lambda[  13] =   0.01693104732845
lambda[  14] =   0.02115253634243
lambda[  15] =   0.02316558725257
lambda[  16] =   0.03868873721248
lambda[  17] =   0.05914150804759
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.914 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.923 ms

Total time for subspace rotation: 3.925 ms
rank = 0, Efermi =  -0.056042170548 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.665 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1453.824 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
rank = 0, D2D took 0.418 ms
rank = 0, Transfering density took 0.425 ms
Etot    =   -26.595211378782
Eband   =    -9.061827266990
E1      =    20.849263179260
E2      =    -7.653120408044
E3      =   -11.229076391894
Exc     =    -9.815884916007
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.094e-03, dEband = 1.086e-01
rank = 0, Calculating/Estimating energy took 2.303 ms, Etot = -26.595211379, dEtot = 4.094e-03, dEband = 1.086e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.9643750262618, which took 0.051 ms

iter_count = 102, r_2norm = 1.920e-04, tol*||rhs|| = 2.786e-04

Anderson update took 54.718 ms, out of which F'*F took 25.654 ms; b-Ax took 173.296 ms, out of which Lap took 155.806 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.692 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367807, int_b + int_rho = -3.674e-13, checking this took 0.102 ms
2-norm of RHS = 734.3451310599777, which took 0.112 ms

iter_count = 264, r_2norm = 6.085e-04, tol*||rhs|| = 7.343e-04

Anderson update took 140.889 ms, out of which F'*F took 66.439 ms; b-Ax took 449.957 ms, out of which Lap took 402.593 ms
Solving Poisson took 952.215 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.225288 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.174106 
Total time for convolution: 	 convolve: 5.206465 
Total time for convolution: 	 convolve: 5.181585 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.765 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.034 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.308 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.324 ms

This SCF took 27581.125 ms, scf error = 4.132e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.159142, lowerbound = -0.831550, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1418.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.890 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.909 ms
rank =  0, finding HY took 23.629 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.353 ms
Rank 0, Project_Hamiltonian used 29.919 ms
Total time for projection: 29.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.036 ms
rank = 0, Solve_Generalized_EigenProblem used 0.567 ms
    first calculated eigval = -0.830674499024643
    last  calculated eigval = 0.053036505318037
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.83067449902464
lambda[   2] =  -0.64297848585358
lambda[   3] =  -0.57403148682104
lambda[   4] =  -0.44814455594445
lambda[   5] =  -0.40074671659985
lambda[   6] =  -0.40070345343710
lambda[   7] =  -0.34990048496030
lambda[   8] =  -0.32975958982921
lambda[   9] =  -0.32835172198587
lambda[  10] =  -0.19193077297730
lambda[  11] =  -0.03213501542198
lambda[  12] =   0.00180530508880
lambda[  13] =   0.01367853518110
lambda[  14] =   0.01464911547663
lambda[  15] =   0.01853347626574
lambda[  16] =   0.03166548319485
lambda[  17] =   0.05303650531804
==subpsace eigenproblem: bcast eigvals took 0.520 ms
Total time for solving subspace eigenvalue problem: 1.091 ms
rank =  0, subspace rotation using ScaLAPACK took 3.624 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.632 ms

Total time for subspace rotation: 3.633 ms
rank = 0, Efermi =  -0.060829218047 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 1.817 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.028 ms
rank = 0, Calculating density took 1455.600 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.394 ms
rank = 0, Transfering density took 0.400 ms
Etot    =   -26.592510251348
Eband   =    -8.994443535949
E1      =    20.835683809617
E2      =    -7.590718385042
E3      =   -11.268426361280
Exc     =    -9.843936096355
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 2.701e-04, dEband = 6.738e-03
rank = 0, Calculating/Estimating energy took 1.791 ms, Etot = -26.592510251, dEtot = 2.701e-04, dEband = 6.738e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4045790810988, which took 0.059 ms

iter_count = 114, r_2norm = 3.704e-05, tol*||rhs|| = 5.618e-05

Anderson update took 61.159 ms, out of which F'*F took 28.769 ms; b-Ax took 193.077 ms, out of which Lap took 173.712 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.977 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367811, int_b + int_rho = -3.274e-13, checking this took 0.202 ms
2-norm of RHS = 734.2643467496084, which took 0.083 ms

iter_count = 252, r_2norm = 6.426e-04, tol*||rhs|| = 7.343e-04

Anderson update took 134.577 ms, out of which F'*F took 62.895 ms; b-Ax took 426.775 ms, out of which Lap took 382.056 ms
Solving Poisson took 906.574 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.178987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.115 ms
Total time for convolution: 	 convolve: 5.176576 
Total time for convolution: 	 convolve: 5.181952 
Total time for convolution: 	 convolve: 5.198419 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 27518.389 ms, scf error = 1.324e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.153037, lowerbound = -0.830674, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1420.666 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.891 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 3.373 ms
rank =  0, finding HY took 23.346 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.503 ms
Rank 0, Project_Hamiltonian used 30.263 ms
Total time for projection: 30.282 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.825797190474134
    last  calculated eigval = 0.047590865787687
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.82579719047413
lambda[   2] =  -0.63718512975263
lambda[   3] =  -0.56828080287781
lambda[   4] =  -0.44293859955325
lambda[   5] =  -0.39535228609016
lambda[   6] =  -0.39500049643629
lambda[   7] =  -0.34389997659836
lambda[   8] =  -0.32433887912744
lambda[   9] =  -0.32261207474019
lambda[  10] =  -0.18705635444011
lambda[  11] =  -0.03372615944924
lambda[  12] =   0.00007101475025
lambda[  13] =   0.01145612170922
lambda[  14] =   0.01257724079881
lambda[  15] =   0.01781061154112
lambda[  16] =   0.02770306154040
lambda[  17] =   0.04759086578769
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.652 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.661 ms

Total time for subspace rotation: 3.662 ms
rank = 0, Efermi =  -0.062420362145 calculate fermi energy took 1.664 ms
rank = 0, --- Calculate rho: sum over local bands took 1.857 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1458.372 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.447 ms
rank = 0, Transfering density took 0.455 ms
Etot    =   -26.591602671061
Eband   =    -8.884923581317
E1      =    20.765249244288
E2      =    -7.543221935932
E3      =   -11.307461880432
Exc     =    -9.873652975413
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 9.076e-05, dEband = 1.095e-02
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -26.591602671, dEtot = 9.076e-05, dEband = 1.095e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4888525795221, which took 0.060 ms

iter_count = 114, r_2norm = 1.333e-05, tol*||rhs|| = 1.955e-05

Anderson update took 61.631 ms, out of which F'*F took 30.376 ms; b-Ax took 194.873 ms, out of which Lap took 175.527 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.540 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367814, int_b + int_rho = -2.983e-13, checking this took 0.139 ms
2-norm of RHS = 734.6914533303062, which took 0.124 ms

iter_count = 258, r_2norm = 6.061e-04, tol*||rhs|| = 7.347e-04

Anderson update took 138.718 ms, out of which F'*F took 65.119 ms; b-Ax took 438.894 ms, out of which Lap took 394.086 ms
Solving Poisson took 928.067 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.103 ms
Total time for convolution: 	 convolve: 5.170075 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.137 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.182394 
Total time for convolution: 	 convolve: 5.193641 
Total time for convolution: 	 convolve: 5.166454 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.350 ms

This SCF took 27566.715 ms, scf error = 6.264e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147591, lowerbound = -0.825797, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1419.186 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.884 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 2.909 ms
rank =  0, finding HY took 23.635 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.299 ms
Rank 0, Project_Hamiltonian used 29.865 ms
Total time for projection: 29.879 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -0.818352346907316
    last  calculated eigval = 0.043129622577863
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81835234690732
lambda[   2] =  -0.63041272764955
lambda[   3] =  -0.56214934319809
lambda[   4] =  -0.43653397296677
lambda[   5] =  -0.38860774990559
lambda[   6] =  -0.38852139412899
lambda[   7] =  -0.33777812580997
lambda[   8] =  -0.31841899255526
lambda[   9] =  -0.31632373026763
lambda[  10] =  -0.18056330228642
lambda[  11] =  -0.03321241553419
lambda[  12] =   0.00011649659794
lambda[  13] =   0.01182960267396
lambda[  14] =   0.01305845905909
lambda[  15] =   0.01927083925690
lambda[  16] =   0.02535791215469
lambda[  17] =   0.04312962257786
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.547 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.554 ms

Total time for subspace rotation: 3.555 ms
rank = 0, Efermi =  -0.061906618226 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.966 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1455.202 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
rank = 0, D2D took 0.369 ms
rank = 0, Transfering density took 0.375 ms
Etot    =   -26.591156935460
Eband   =    -8.755323372470
E1      =    20.698962718489
E2      =    -7.473288905747
E3      =   -11.331892113253
Exc     =    -9.891018125497
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.457e-05, dEband = 1.296e-02
rank = 0, Calculating/Estimating energy took 2.650 ms, Etot = -26.591156935, dEtot = 4.457e-05, dEband = 1.296e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3210273231466, which took 0.124 ms

iter_count = 114, r_2norm = 8.797e-06, tol*||rhs|| = 1.284e-05

Anderson update took 61.040 ms, out of which F'*F took 28.711 ms; b-Ax took 192.771 ms, out of which Lap took 173.405 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.810 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367811, int_b + int_rho = -3.311e-13, checking this took 0.117 ms
2-norm of RHS = 734.7331368181955, which took 0.107 ms

iter_count = 222, r_2norm = 5.948e-04, tol*||rhs|| = 7.347e-04

Anderson update took 118.245 ms, out of which F'*F took 55.326 ms; b-Ax took 375.884 ms, out of which Lap took 336.780 ms
Solving Poisson took 799.085 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.176437 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.193353 
Total time for convolution: 	 convolve: 5.164955 
Total time for convolution: 	 convolve: 5.199769 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.334 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.680 ms

This SCF took 27385.583 ms, scf error = 2.631e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.143130, lowerbound = -0.818352, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1419.992 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.880 ms
rank =  0, finding HY took 23.672 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.384 ms
Rank 0, Project_Hamiltonian used 29.957 ms
Total time for projection: 30.028 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.817462633235694
    last  calculated eigval = 0.038550910472717
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81746263323569
lambda[   2] =  -0.62911157626514
lambda[   3] =  -0.56084589939959
lambda[   4] =  -0.43542864956162
lambda[   5] =  -0.38735434937785
lambda[   6] =  -0.38728131552971
lambda[   7] =  -0.33636916349106
lambda[   8] =  -0.31717665206428
lambda[   9] =  -0.31502372497885
lambda[  10] =  -0.17950092143051
lambda[  11] =  -0.03256286728812
lambda[  12] =   0.00040943290439
lambda[  13] =   0.01235980525460
lambda[  14] =   0.01336514291025
lambda[  15] =   0.02020260821257
lambda[  16] =   0.02465703432511
lambda[  17] =   0.03855091047272
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.691 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.698 ms

Total time for subspace rotation: 3.699 ms
rank = 0, Efermi =  -0.061257069931 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 2.020 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1456.071 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
rank = 0, D2D took 0.385 ms
rank = 0, Transfering density took 0.391 ms
Etot    =   -26.591119952025
Eband   =    -8.731109771765
E1      =    20.688660178250
E2      =    -7.458365827130
E3      =   -11.335283656089
Exc     =    -9.893360666745
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 3.698e-06, dEband = 2.421e-03
rank = 0, Calculating/Estimating energy took 1.662 ms, Etot = -26.591119952, dEtot = 3.698e-06, dEband = 2.421e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1840186616366, which took 0.069 ms

iter_count = 114, r_2norm = 5.058e-06, tol*||rhs|| = 7.361e-06

Anderson update took 61.090 ms, out of which F'*F took 28.785 ms; b-Ax took 192.825 ms, out of which Lap took 173.368 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.394 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367817, int_b + int_rho = -2.692e-13, checking this took 0.078 ms
2-norm of RHS = 734.7582140081371, which took 0.106 ms

iter_count = 228, r_2norm = 6.254e-04, tol*||rhs|| = 7.348e-04

Anderson update took 120.878 ms, out of which F'*F took 57.108 ms; b-Ax took 387.948 ms, out of which Lap took 348.332 ms
Solving Poisson took 819.638 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.171777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.188479 
Total time for convolution: 	 convolve: 5.182063 
Total time for convolution: 	 convolve: 5.186165 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.333 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 27398.041 ms, scf error = 1.817e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.138551, lowerbound = -0.817463, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1416.085 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.877 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 2.895 ms
rank =  0, finding HY took 23.530 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.427 ms
Rank 0, Project_Hamiltonian used 29.874 ms
Total time for projection: 29.890 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.815562716853941
    last  calculated eigval = 0.036148210429283
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81556271685394
lambda[   2] =  -0.62704296327927
lambda[   3] =  -0.55882022928065
lambda[   4] =  -0.43354060888214
lambda[   5] =  -0.38531455660564
lambda[   6] =  -0.38526045771369
lambda[   7] =  -0.33435526337429
lambda[   8] =  -0.31525521906189
lambda[   9] =  -0.31304199728465
lambda[  10] =  -0.17743968941875
lambda[  11] =  -0.03026756035155
lambda[  12] =   0.00274329598197
lambda[  13] =   0.01501028498461
lambda[  14] =   0.01600991589591
lambda[  15] =   0.02298393248376
lambda[  16] =   0.02620963095767
lambda[  17] =   0.03614821042928
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.464 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.469 ms

Total time for subspace rotation: 3.470 ms
rank = 0, Efermi =  -0.058961763044 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 2.020 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1451.793 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
rank = 0, D2D took 0.380 ms
rank = 0, Transfering density took 0.385 ms
Etot    =   -26.591088262183
Eband   =    -8.691267404529
E1      =    20.669707048942
E2      =    -7.436725642802
E3      =   -11.337984760387
Exc     =    -9.895279134802
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 3.169e-06, dEband = 3.984e-03
rank = 0, Calculating/Estimating energy took 2.477 ms, Etot = -26.591088262, dEtot = 3.169e-06, dEband = 3.984e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1078513667253, which took 0.095 ms

iter_count = 114, r_2norm = 3.097e-06, tol*||rhs|| = 4.314e-06

Anderson update took 60.946 ms, out of which F'*F took 28.781 ms; b-Ax took 193.029 ms, out of which Lap took 173.679 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.686 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367810, int_b + int_rho = -3.383e-13, checking this took 0.108 ms
2-norm of RHS = 734.7309671857623, which took 0.092 ms

iter_count = 210, r_2norm = 7.137e-04, tol*||rhs|| = 7.347e-04

Anderson update took 111.659 ms, out of which F'*F took 52.437 ms; b-Ax took 355.517 ms, out of which Lap took 318.599 ms
Solving Poisson took 755.460 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 5.196411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.176576 
Total time for convolution: 	 convolve: 5.183873 
Total time for convolution: 	 convolve: 5.192917 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.534 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.313 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.330 ms

This SCF took 27350.689 ms, scf error = 1.118e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.136148, lowerbound = -0.815563, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1420.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 2.921 ms
rank =  0, finding HY took 23.653 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.514 ms
Rank 0, Project_Hamiltonian used 30.111 ms
Total time for projection: 30.126 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.025 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.814106714460729
    last  calculated eigval = 0.034095939363124
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81410671446073
lambda[   2] =  -0.62561519146109
lambda[   3] =  -0.55737316119339
lambda[   4] =  -0.43213131836075
lambda[   5] =  -0.38387761742177
lambda[   6] =  -0.38380859242821
lambda[   7] =  -0.33290544328357
lambda[   8] =  -0.31383597067393
lambda[   9] =  -0.31161616815806
lambda[  10] =  -0.17594933150595
lambda[  11] =  -0.02784312412553
lambda[  12] =   0.00600345343490
lambda[  13] =   0.01767062004084
lambda[  14] =   0.01833471489541
lambda[  15] =   0.02514273413687
lambda[  16] =   0.02782433017333
lambda[  17] =   0.03409593936312
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.612 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.619 ms

Total time for subspace rotation: 3.620 ms
rank = 0, Efermi =  -0.056537326763 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.048 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1456.843 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
rank = 0, D2D took 1.391 ms
rank = 0, Transfering density took 1.400 ms
Etot    =   -26.591091831814
Eband   =    -8.662439018833
E1      =    20.654418964466
E2      =    -7.422263248367
E3      =   -11.342106283146
Exc     =    -9.898482133978
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 3.570e-07, dEband = 2.883e-03
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -26.591091832, dEtot = 3.570e-07, dEband = 2.883e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0623301381922, which took 0.065 ms

iter_count = 114, r_2norm = 1.740e-06, tol*||rhs|| = 2.493e-06

Anderson update took 61.221 ms, out of which F'*F took 28.842 ms; b-Ax took 193.092 ms, out of which Lap took 173.649 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.861 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367813, int_b + int_rho = -3.092e-13, checking this took 0.115 ms
2-norm of RHS = 734.7322735951376, which took 0.096 ms

iter_count = 198, r_2norm = 6.555e-04, tol*||rhs|| = 7.347e-04

Anderson update took 105.436 ms, out of which F'*F took 49.908 ms; b-Ax took 335.750 ms, out of which Lap took 300.827 ms
Solving Poisson took 712.368 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.172769 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.182184 
Total time for convolution: 	 convolve: 5.165281 
Total time for convolution: 	 convolve: 5.172107 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.318 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.335 ms

This SCF took 27256.853 ms, scf error = 6.940e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.134096, lowerbound = -0.814107, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1417.497 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.050 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.860 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 2.882 ms
rank =  0, finding HY took 23.610 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.455 ms
Rank 0, Project_Hamiltonian used 30.013 ms
Total time for projection: 30.024 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.813364735836073
    last  calculated eigval = 0.033327512514950
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81336473583607
lambda[   2] =  -0.62486153920429
lambda[   3] =  -0.55667602074273
lambda[   4] =  -0.43141797921561
lambda[   5] =  -0.38314605652045
lambda[   6] =  -0.38306638929235
lambda[   7] =  -0.33215249129681
lambda[   8] =  -0.31311857273456
lambda[   9] =  -0.31088629782562
lambda[  10] =  -0.17530407345004
lambda[  11] =  -0.02509771788332
lambda[  12] =   0.00983833930477
lambda[  13] =   0.02012834239715
lambda[  14] =   0.02096136360170
lambda[  15] =   0.02747414562431
lambda[  16] =   0.02878625622663
lambda[  17] =   0.03332751251495
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.652 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.659 ms

Total time for subspace rotation: 3.659 ms
rank = 0, Efermi =  -0.053791920482 calculate fermi energy took 0.094 ms
rank = 0, --- Calculate rho: sum over local bands took 1.927 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1454.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.954 ms
rank = 0, D2D took 1.050 ms
rank = 0, Transfering density took 1.056 ms
Etot    =   -26.591151097017
Eband   =    -8.647988313082
E1      =    20.647552887990
E2      =    -7.414662950167
E3      =   -11.342364799236
Exc     =    -9.898784246344
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 5.927e-06, dEband = 1.445e-03
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -26.591151097, dEtot = 5.927e-06, dEband = 1.445e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0451732077416, which took 0.057 ms

iter_count = 114, r_2norm = 1.344e-06, tol*||rhs|| = 1.807e-06

Anderson update took 61.137 ms, out of which F'*F took 28.805 ms; b-Ax took 192.941 ms, out of which Lap took 173.674 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.698 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367810, int_b + int_rho = -3.383e-13, checking this took 0.106 ms
2-norm of RHS = 734.7402915337624, which took 0.100 ms

iter_count = 168, r_2norm = 7.081e-04, tol*||rhs|| = 7.347e-04

Anderson update took 89.362 ms, out of which F'*F took 41.793 ms; b-Ax took 284.241 ms, out of which Lap took 254.752 ms
Solving Poisson took 604.858 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.207331 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.180740 
Total time for convolution: 	 convolve: 5.198139 
Total time for convolution: 	 convolve: 5.197876 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.419 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.315 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.332 ms

This SCF took 27230.092 ms, scf error = 3.988e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133328, lowerbound = -0.813365, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1419.763 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.877 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.895 ms
rank =  0, finding HY took 23.600 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.446 ms
Rank 0, Project_Hamiltonian used 29.964 ms
Total time for projection: 29.979 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.812765389638235
    last  calculated eigval = 0.032770134363942
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81276538963824
lambda[   2] =  -0.62427968421058
lambda[   3] =  -0.55612198641991
lambda[   4] =  -0.43086403209010
lambda[   5] =  -0.38256481887926
lambda[   6] =  -0.38250820764055
lambda[   7] =  -0.33159852883324
lambda[   8] =  -0.31257903777450
lambda[   9] =  -0.31033487239726
lambda[  10] =  -0.17475249849257
lambda[  11] =  -0.02379895205885
lambda[  12] =   0.01140617580178
lambda[  13] =   0.02075913875580
lambda[  14] =   0.02240805775330
lambda[  15] =   0.02796802900438
lambda[  16] =   0.02911065000734
lambda[  17] =   0.03277013436394
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.649 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 4.400 ms

Total time for subspace rotation: 4.401 ms
rank = 0, Efermi =  -0.052493154700 calculate fermi energy took 0.706 ms
rank = 0, --- Calculate rho: sum over local bands took 1.842 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1456.919 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, D2D took 0.458 ms
rank = 0, Transfering density took 0.465 ms
Etot    =   -26.591191451874
Eband   =    -8.636738113554
E1      =    20.641428139997
E2      =    -7.409152801586
E3      =   -11.343933008357
Exc     =    -9.900008113276
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.035e-06, dEband = 1.125e-03
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -26.591191452, dEtot = 4.035e-06, dEband = 1.125e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0346989722930, which took 0.106 ms

iter_count = 108, r_2norm = 1.198e-06, tol*||rhs|| = 1.388e-06

Anderson update took 57.824 ms, out of which F'*F took 27.200 ms; b-Ax took 183.002 ms, out of which Lap took 164.642 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.327 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367814, int_b + int_rho = -2.947e-13, checking this took 0.124 ms
2-norm of RHS = 734.7540694320047, which took 0.117 ms

iter_count = 180, r_2norm = 6.436e-04, tol*||rhs|| = 7.348e-04

Anderson update took 96.078 ms, out of which F'*F took 45.143 ms; b-Ax took 304.774 ms, out of which Lap took 273.101 ms
Solving Poisson took 647.732 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.166703 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.183437 
Total time for convolution: 	 convolve: 5.181098 
Total time for convolution: 	 convolve: 5.183947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.327 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.344 ms

This SCF took 27181.663 ms, scf error = 2.970e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132770, lowerbound = -0.812765, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1414.792 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.896 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.913 ms
rank =  0, finding HY took 23.624 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.363 ms
Rank 0, Project_Hamiltonian used 29.924 ms
Total time for projection: 29.940 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.812692503217427
    last  calculated eigval = 0.035803904868489
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81269250321743
lambda[   2] =  -0.62414218086847
lambda[   3] =  -0.55596512173224
lambda[   4] =  -0.43073676940799
lambda[   5] =  -0.38244023272300
lambda[   6] =  -0.38235523251811
lambda[   7] =  -0.33142515418735
lambda[   8] =  -0.31241709185592
lambda[   9] =  -0.31019063968977
lambda[  10] =  -0.17464603851039
lambda[  11] =  -0.02134303255308
lambda[  12] =   0.01337841486123
lambda[  13] =   0.02195221250492
lambda[  14] =   0.02470689113375
lambda[  15] =   0.02818204833957
lambda[  16] =   0.02930159391917
lambda[  17] =   0.03580390486849
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 4.086 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 4.095 ms

Total time for subspace rotation: 4.096 ms
rank = 0, Efermi =  -0.050037235179 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.869 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1451.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, D2D took 0.419 ms
rank = 0, Transfering density took 0.425 ms
Etot    =   -26.591267723302
Eband   =    -8.634021930140
E1      =    20.640920942968
E2      =    -7.407047959816
E3      =   -11.343320096862
Exc     =    -9.899575617825
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 7.627e-06, dEband = 2.716e-04
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -26.591267723, dEtot = 7.627e-06, dEband = 2.716e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0327135607938, which took 0.091 ms

iter_count = 108, r_2norm = 1.159e-06, tol*||rhs|| = 1.309e-06

Anderson update took 57.707 ms, out of which F'*F took 27.209 ms; b-Ax took 182.692 ms, out of which Lap took 164.280 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.202 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367811, int_b + int_rho = -3.238e-13, checking this took 0.107 ms
2-norm of RHS = 734.7524587187330, which took 0.108 ms

iter_count = 114, r_2norm = 7.253e-04, tol*||rhs|| = 7.348e-04

Anderson update took 60.725 ms, out of which F'*F took 28.517 ms; b-Ax took 192.786 ms, out of which Lap took 172.883 ms
Solving Poisson took 411.646 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.179967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.178183 
Total time for convolution: 	 convolve: 5.205899 
Total time for convolution: 	 convolve: 5.164240 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.728 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.310 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.328 ms

This SCF took 26966.896 ms, scf error = 2.388e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135804, lowerbound = -0.812693, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1416.802 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.883 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.900 ms
rank =  0, finding HY took 23.662 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.405 ms
Rank 0, Project_Hamiltonian used 29.991 ms
Total time for projection: 30.007 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.812550135840062
    last  calculated eigval = 0.036110364858219
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81255013584006
lambda[   2] =  -0.62401669444214
lambda[   3] =  -0.55584444969423
lambda[   4] =  -0.43061375202807
lambda[   5] =  -0.38230976033796
lambda[   6] =  -0.38223783549893
lambda[   7] =  -0.33131276674112
lambda[   8] =  -0.31230338961729
lambda[   9] =  -0.31007433700542
lambda[  10] =  -0.17451518647449
lambda[  11] =  -0.02102202688302
lambda[  12] =   0.01355404074133
lambda[  13] =   0.02208943951513
lambda[  14] =   0.02494894979505
lambda[  15] =   0.02828546008112
lambda[  16] =   0.02933060002308
lambda[  17] =   0.03611036485822
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.991 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.999 ms

Total time for subspace rotation: 3.999 ms
rank = 0, Efermi =  -0.049716229566 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 1.886 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1453.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.269 ms
rank = 0, D2D took 0.433 ms
rank = 0, Transfering density took 0.440 ms
Etot    =   -26.591272574521
Eband   =    -8.631556616067
E1      =    20.639402395429
E2      =    -7.406005144460
E3      =   -11.343741026608
Exc     =    -9.899905349968
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.851e-07, dEband = 2.465e-04
rank = 0, Calculating/Estimating energy took 1.127 ms, Etot = -26.591272575, dEtot = 4.851e-07, dEband = 2.465e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0237437881361, which took 0.107 ms

iter_count = 108, r_2norm = 9.388e-07, tol*||rhs|| = 9.498e-07

Anderson update took 57.585 ms, out of which F'*F took 27.271 ms; b-Ax took 183.154 ms, out of which Lap took 164.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.301 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367814, int_b + int_rho = -2.947e-13, checking this took 0.105 ms
2-norm of RHS = 734.7498827520798, which took 0.102 ms

iter_count = 126, r_2norm = 7.325e-04, tol*||rhs|| = 7.347e-04

Anderson update took 66.931 ms, out of which F'*F took 31.614 ms; b-Ax took 213.208 ms, out of which Lap took 191.179 ms
Solving Poisson took 454.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.180207 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.170851 
Total time for convolution: 	 convolve: 5.173260 
Total time for convolution: 	 convolve: 5.181913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.830 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.338 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.358 ms

This SCF took 26982.054 ms, scf error = 1.585e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136110, lowerbound = -0.812550, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1415.379 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.887 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 2.905 ms
rank =  0, finding HY took 23.458 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.471 ms
Rank 0, Project_Hamiltonian used 30.299 ms
Total time for projection: 30.314 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.028 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.812457266553771
    last  calculated eigval = 0.036047080636602
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81245726655377
lambda[   2] =  -0.62392133018214
lambda[   3] =  -0.55574727251160
lambda[   4] =  -0.43052157800065
lambda[   5] =  -0.38221542722319
lambda[   6] =  -0.38214414989958
lambda[   7] =  -0.33121804977938
lambda[   8] =  -0.31221109621220
lambda[   9] =  -0.30998235463708
lambda[  10] =  -0.17443048228731
lambda[  11] =  -0.02154904922279
lambda[  12] =   0.01217158909419
lambda[  13] =   0.02159020928370
lambda[  14] =   0.02447435058861
lambda[  15] =   0.02757186135718
lambda[  16] =   0.02967270590960
lambda[  17] =   0.03604708063660
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.778 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.784 ms

Total time for subspace rotation: 3.784 ms
rank = 0, Efermi =  -0.050243251806 calculate fermi energy took 0.086 ms
rank = 0, --- Calculate rho: sum over local bands took 1.961 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1451.779 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
rank = 0, D2D took 0.384 ms
rank = 0, Transfering density took 0.386 ms
Etot    =   -26.591305337589
Eband   =    -8.629698015300
E1      =    20.638431259146
E2      =    -7.405073184808
E3      =   -11.343810539411
Exc     =    -9.899963130671
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 3.276e-06, dEband = 1.859e-04
rank = 0, Calculating/Estimating energy took 1.653 ms, Etot = -26.591305338, dEtot = 3.276e-06, dEband = 1.859e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0207133761311, which took 0.059 ms

iter_count = 108, r_2norm = 7.797e-07, tol*||rhs|| = 8.285e-07

Anderson update took 57.692 ms, out of which F'*F took 27.152 ms; b-Ax took 183.279 ms, out of which Lap took 164.833 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.513 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367812, int_b + int_rho = -3.165e-13, checking this took 0.111 ms
2-norm of RHS = 734.7503191101300, which took 0.087 ms

iter_count = 120, r_2norm = 6.758e-04, tol*||rhs|| = 7.348e-04

Anderson update took 63.615 ms, out of which F'*F took 29.958 ms; b-Ax took 202.992 ms, out of which Lap took 181.689 ms
Solving Poisson took 432.861 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.180424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.869 ms
Total time for convolution: 	 convolve: 5.187886 
Total time for convolution: 	 convolve: 5.278150 
Total time for convolution: 	 convolve: 5.179370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.351 ms

This SCF took 27085.786 ms, scf error = 1.202e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136047, lowerbound = -0.812457, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1415.124 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.360 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 3.396 ms
rank =  0, finding HY took 23.897 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.369 ms
Rank 0, Project_Hamiltonian used 31.435 ms
Total time for projection: 31.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.124 ms
    first calculated eigval = -0.812402019794460
    last  calculated eigval = 0.036901996973858
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81240201979446
lambda[   2] =  -0.62386278680206
lambda[   3] =  -0.55568897361720
lambda[   4] =  -0.43046555050973
lambda[   5] =  -0.38215828094343
lambda[   6] =  -0.38208592429530
lambda[   7] =  -0.33115822367747
lambda[   8] =  -0.31215399621711
lambda[   9] =  -0.30992596418727
lambda[  10] =  -0.17438307805810
lambda[  11] =  -0.02128305975934
lambda[  12] =   0.01195692510993
lambda[  13] =   0.02171297583442
lambda[  14] =   0.02457732968942
lambda[  15] =   0.02768906428242
lambda[  16] =   0.03109882976598
lambda[  17] =   0.03690199697386
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.546 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.552 ms

Total time for subspace rotation: 3.553 ms
rank = 0, Efermi =  -0.049977262425 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.031 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1452.467 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
rank = 0, D2D took 0.397 ms
rank = 0, Transfering density took 0.403 ms
Etot    =   -26.591317799170
Eband   =    -8.628569596921
E1      =    20.637931112308
E2      =    -7.404424901465
E3      =   -11.343816108803
Exc     =    -9.899961149841
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 1.246e-06, dEband = 1.128e-04
rank = 0, Calculating/Estimating energy took 2.229 ms, Etot = -26.591317799, dEtot = 1.246e-06, dEband = 1.128e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0192206715039, which took 0.090 ms

iter_count = 108, r_2norm = 6.285e-07, tol*||rhs|| = 7.688e-07

Anderson update took 57.752 ms, out of which F'*F took 27.156 ms; b-Ax took 183.098 ms, out of which Lap took 164.696 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.660 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367822, int_b + int_rho = -2.219e-13, checking this took 0.116 ms
2-norm of RHS = 734.7528971968377, which took 0.106 ms

iter_count = 108, r_2norm = 5.991e-04, tol*||rhs|| = 7.348e-04

Anderson update took 57.327 ms, out of which F'*F took 27.078 ms; b-Ax took 182.748 ms, out of which Lap took 163.901 ms
Solving Poisson took 390.174 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Total time for convolution: 	 convolve: 5.194019 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.162355 
Total time for convolution: 	 convolve: 5.176351 
Total time for convolution: 	 convolve: 5.203644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.703 ms

This SCF took 26945.681 ms, scf error = 1.014e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136902, lowerbound = -0.812402, upperbound = 267.578932

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (17 columns, degree = 45): 1413.022 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.895 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 2.927 ms
rank =  0, finding HY took 23.526 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 3.393 ms
Rank 0, Project_Hamiltonian used 29.868 ms
Total time for projection: 29.884 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.812320136954437
    last  calculated eigval = 0.037686141590429
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 20):
lambda[   1] =  -0.81232013695444
lambda[   2] =  -0.62378430718996
lambda[   3] =  -0.55561352406320
lambda[   4] =  -0.43038881225019
lambda[   5] =  -0.38207915184122
lambda[   6] =  -0.38200776784000
lambda[   7] =  -0.33108014257376
lambda[   8] =  -0.31207821774761
lambda[   9] =  -0.30985028051231
lambda[  10] =  -0.17430986865899
lambda[  11] =  -0.02083996937214
lambda[  12] =   0.01233973564545
lambda[  13] =   0.02190756054651
lambda[  14] =   0.02483527604788
lambda[  15] =   0.02787553971890
lambda[  16] =   0.03301997466503
lambda[  17] =   0.03768614159043
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.541 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.548 ms

Total time for subspace rotation: 3.549 ms
rank = 0, Efermi =  -0.049534172030 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.029 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1448.787 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, D2D took 0.368 ms
rank = 0, Transfering density took 0.374 ms
Etot    =   -26.591321866890
Eband   =    -8.627024419965
E1      =    20.637237077136
E2      =    -7.403542765071
E3      =   -11.343900182806
Exc     =    -9.900018296954
Esc     =   -47.448959173987
Entropy =    -0.000000000996
dE = 4.068e-07, dEband = 1.545e-04
rank = 0, Calculating/Estimating energy took 2.227 ms, Etot = -26.591321867, dEtot = 4.068e-07, dEband = 1.545e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0163373029756, which took 0.072 ms

iter_count = 108, r_2norm = 5.808e-07, tol*||rhs|| = 6.535e-07

Anderson update took 58.227 ms, out of which F'*F took 27.369 ms; b-Ax took 183.457 ms, out of which Lap took 164.856 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.441 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -20.00000003367844, int_rho =  20.00000003367811, int_b + int_rho = -3.311e-13, checking this took 0.101 ms
2-norm of RHS = 734.7523667899862, which took 0.099 ms

iter_count = 78, r_2norm = 6.381e-04, tol*||rhs|| = 7.348e-04

Anderson update took 42.950 ms, out of which F'*F took 19.444 ms; b-Ax took 131.474 ms, out of which Lap took 117.629 ms
Solving Poisson took 284.230 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.178844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1373.778 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.182588 
Total time for convolution: 	 convolve: 5.185530 
Total time for convolution: 	 convolve: 5.167406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.595 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.721 ms

This SCF took 28211.402 ms, scf error = 9.141e-05
The last 17 occupations of kpoints #1 are (Nelectron = 20):
lambda[   1] =  -0.81232013695444, occ[   1] =   2.00000000000000
lambda[   2] =  -0.62378430718996, occ[   2] =   2.00000000000000
lambda[   3] =  -0.55561352406320, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43038881225019, occ[   4] =   2.00000000000000
lambda[   5] =  -0.38207915184122, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38200776784000, occ[   6] =   2.00000000000000
lambda[   7] =  -0.33108014257376, occ[   7] =   2.00000000000000
lambda[   8] =  -0.31207821774761, occ[   8] =   2.00000000000000
lambda[   9] =  -0.30985028051231, occ[   9] =   2.00000000000000
lambda[  10] =  -0.17430986865899, occ[  10] =   2.00000000000000
lambda[  11] =  -0.02083996937214, occ[  11] =   0.00000003367812
lambda[  12] =   0.01233973564545, occ[  12] =   0.00000000000000
lambda[  13] =   0.02190756054651, occ[  13] =   0.00000000000000
lambda[  14] =   0.02483527604788, occ[  14] =   0.00000000000000
lambda[  15] =   0.02787553971890, occ[  15] =   0.00000000000000
lambda[  16] =   0.03301997466503, occ[  16] =   0.00000000000000
lambda[  17] =   0.03768614159043, occ[  17] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 15 (90%) = 0.000000000000000.
Occupation of state 17 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.152 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.664 ms, time for Allreduce/Reduce: 7.309 ms 
Time for calculating local force components: 17.114 ms
Start Calculating nonlocal forces
force_nloc = 
  0.04996723850592  -0.04016245634277  -0.00000001667408
  0.03500845348439   0.03161528955265  -0.00288002846483
  0.03500843387994   0.03161532368735   0.00288001225236
 -0.04251376328390   0.02504065703251  -0.00344623373642
 -0.04251379462465   0.02504067075092   0.00344622975315
  0.00251296230127  -0.02939102427995  -0.04002848701513
  0.00251296126345  -0.02939101398351   0.04002848291825
  0.00252855762387   0.05102852029574  -0.06853074380362
  0.00252783836562   0.05102878622632   0.06852985100658
 -0.54321660518674  -0.37829188951026  -0.00000022513365
force_loc = 
 -0.05102486041856   0.04237830296663   0.00000038326672
 -0.03641429116223  -0.03263760782119   0.00258817107995
 -0.03641357546588  -0.03263792725088  -0.00258754533832
  0.04333799395417  -0.02544003674264   0.00371961847412
  0.04333949145861  -0.02544030411875  -0.00371998867594
 -0.00242410020131   0.02996563407090   0.04098188265267
 -0.00242458581982   0.02996456968737  -0.04098142410539
 -0.00132580187195  -0.04933973782283   0.06764024515862
 -0.00132801805671  -0.04934185410559  -0.06764179868763
  0.52793430142080   0.36704048134893   0.00000628929205
Time for calculating nonlocal force components: 26.000 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00020710536020  -0.00253309138394   0.00381985724778
[0m[32m  0.00020703101931  -0.00253314638659  -0.00381989615505
[0m[32m  0.01445161636359   0.01226072117070   0.00000023003774
[0mTime for calculating XC forces components: 26.285 ms
 Cartesian force = 
 -0.00105208080357   0.00223195991975  -0.00000011994236
 -0.00140029656878  -0.00100620497266  -0.00029234391987
 -0.00139960047688  -0.00100649026764   0.00029198037905
  0.00082977177933  -0.00038326641424   0.00027289820271
  0.00083123794302  -0.00038352007194  -0.00027424545778
  0.00009440320902   0.00059072308683   0.00095290910254
  0.00009391655270   0.00058966899975  -0.00095342772213
  0.00141540222117  -0.00082819561514   0.00292887206778
  0.00141239243729  -0.00083010096997  -0.00293233037109
 -0.00082514629330   0.00102542630526   0.00000580766115
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 382.361 ms
The program took 470.547 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:42
Job ID:        2266473
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:00,vmem=8340K,walltime=00:08:05,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-15-2
---------------------------------------
