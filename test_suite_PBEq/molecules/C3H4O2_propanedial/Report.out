---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:34
Job ID:    2266437
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:40
Job ID:    2266437
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.081 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 15.841 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 4.870 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 78.880 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.974 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.091 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    6.170163	    9.364129	    9.163707	
   13.804681	    8.373325	    9.650091	
   10.439311	   11.539986	   12.099563	
    9.553867	   12.870266	    9.150685	
    9.082898	    7.129734	   10.247155	
   13.829837	   11.765020	    7.900437	
   10.251151	   11.156132	   10.064587	
    8.323419	    9.030125	    9.798270	
   12.849426	   10.371663	    9.127718	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.169 ms
Set up communicators.

--set up spincomm took 2.269 ms

--set up kptcomm took 0.350 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.770 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.168 ms

Calculate_SplineDerivRadFun took 0.299 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 2.006 ms.
time spent on vectorized spline interp: 3.140 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.712 ms.
time spent on vectorized spline interp: 1.413 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.323 ms.
time spent on vectorized spline interp: 1.631 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.293 ms.

Calculating rb for all atom types took 16.530 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.064 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000380319, sum_int_rho = 27.5905276122407
PosCharge = 28.000000038032, NegCharge = -27.590527612241, scal_fac = 1.014841050941
After scaling, int_rho = 28.0000000380318, PosCharge + NegCharge - NetCharge = 2.132e-14
--Calculate Vref took 0.591 ms
--Calculate rho_guess took 3.403 ms

 integral of b = -28.0000000380319,
 int{b} + Nelectron + NetCharge = -3.803e-08,
 Esc = -84.8968933953076,
 MPI_Reduce took 8.922 ms

Calculating b & b_ref took 20.668 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.077 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.086 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.102 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.674 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.555 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803205, int_b + int_rho = 2.292e-13, checking this took 0.612 ms
2-norm of RHS = 735.6560271154709, which took 0.500 ms

iter_count = 420, r_2norm = 6.811e-04, tol*||rhs|| = 7.357e-04

Anderson update took 233.188 ms, out of which F'*F took 105.923 ms; b-Ax took 717.744 ms, out of which Lap took 640.925 ms
Solving Poisson took 1519.636 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.169983 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.162177 
Total time for convolution: 	 convolve: 5.146056 
Total time for convolution: 	 convolve: 5.188488 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.018 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.447 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
rank = 0, XC calculation took 24554.747 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 4.822 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.142 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.107 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.153 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.637 ms
    Lanczos iter 53, eigmin  = -1.059337189, eigmax = 264.934348383, err_eigmin = 1.142e-03, err_eigmax = 9.790e-03
rank =   0, Lanczos took 120.422 ms, eigmin = -1.059337189140, eigmax = 267.583691866606

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.212177, lowerbound = -1.159337, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1469.218 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 50.686 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.810 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 53.519 ms
rank =  0, finding HY took 26.005 ms
rank =  0, distributing HY into block cyclic form took 19.928 ms
rank =  0, finding Y'*HY took 4.128 ms
Rank 0, Project_Hamiltonian used 103.621 ms
Total time for projection: 104.058 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.416 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 1.522 ms
    first calculated eigval = 2.722964328617185
    last  calculated eigval = 3.262833599015224
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.84806331030444
lambda[   6] =   2.86980353258851
lambda[   7] =   2.90354014975961
lambda[   8] =   2.92710139067316
lambda[   9] =   2.97885067564917
lambda[  10] =   2.98353574984871
lambda[  11] =   2.99917901777659
lambda[  12] =   3.00120343802545
lambda[  13] =   3.02719623530526
lambda[  14] =   3.04475171541509
lambda[  15] =   3.08933027484365
lambda[  16] =   3.12971011084480
lambda[  17] =   3.14524948608804
lambda[  18] =   3.15065842672691
lambda[  19] =   3.18107852932559
lambda[  20] =   3.20666207834064
lambda[  21] =   3.26283359901522
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.540 ms
rank =  0, subspace rotation using ScaLAPACK took 8.193 ms
rank =  0, Distributing orbital back into band + domain format took 18.283 ms
rank = 0, Subspace_Rotation used 26.493 ms

Total time for subspace rotation: 26.496 ms
rank = 0, Efermi =   3.067042217015 calculate fermi energy took 0.050 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.362834, lowerbound = -1.159337, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1498.916 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.368 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.597 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.978 ms
rank =  0, finding HY took 25.434 ms
rank =  0, distributing HY into block cyclic form took 18.296 ms
rank =  0, finding Y'*HY took 4.045 ms
Rank 0, Project_Hamiltonian used 68.780 ms
Total time for projection: 68.784 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -0.937238565696278
    last  calculated eigval = 0.422514303670735
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.21383918606543
lambda[   6] =  -0.19824680762321
lambda[   7] =  -0.11901354799318
lambda[   8] =  -0.07599083621048
lambda[   9] =   0.02254209894990
lambda[  10] =   0.07877461616473
lambda[  11] =   0.12273048547497
lambda[  12] =   0.15648695999974
lambda[  13] =   0.20278680822436
lambda[  14] =   0.28037156545418
lambda[  15] =   0.29779534196707
lambda[  16] =   0.33580252930172
lambda[  17] =   0.36575150555450
lambda[  18] =   0.37446339829420
lambda[  19] =   0.38913497992717
lambda[  20] =   0.39282787737395
lambda[  21] =   0.42251430367073
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 8.178 ms
rank =  0, Distributing orbital back into band + domain format took 18.157 ms
rank = 0, Subspace_Rotation used 26.349 ms

Total time for subspace rotation: 26.353 ms
rank = 0, Efermi =   0.289083454215 calculate fermi energy took 0.019 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.522514, lowerbound = -1.159337, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1496.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.697 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.560 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.279 ms
rank =  0, finding HY took 25.504 ms
rank =  0, distributing HY into block cyclic form took 18.291 ms
rank =  0, finding Y'*HY took 4.086 ms
Rank 0, Project_Hamiltonian used 69.650 ms
Total time for projection: 69.655 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -1.070712689492666
    last  calculated eigval = 0.123380748294221
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.59687881797436
lambda[   6] =  -0.53686265423294
lambda[   7] =  -0.50824146104338
lambda[   8] =  -0.48150051336198
lambda[   9] =  -0.47325213609852
lambda[  10] =  -0.45158839175639
lambda[  11] =  -0.41351122481042
lambda[  12] =  -0.40704860219973
lambda[  13] =  -0.29828191568210
lambda[  14] =  -0.24621422252137
lambda[  15] =  -0.07382078803758
lambda[  16] =  -0.04593171926722
lambda[  17] =   0.07533635914087
lambda[  18] =   0.08797467526465
lambda[  19] =   0.09584611494047
lambda[  20] =   0.11365598870248
lambda[  21] =   0.12338074829422
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 8.144 ms
rank =  0, Distributing orbital back into band + domain format took 18.146 ms
rank = 0, Subspace_Rotation used 26.312 ms

Total time for subspace rotation: 26.316 ms
rank = 0, Efermi =  -0.102403781446 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.223381, lowerbound = -1.159337, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1523.341 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.397 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.490 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.912 ms
rank =  0, finding HY took 25.491 ms
rank =  0, distributing HY into block cyclic form took 18.330 ms
rank =  0, finding Y'*HY took 4.031 ms
Rank 0, Project_Hamiltonian used 68.797 ms
Total time for projection: 68.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.071231756005736
    last  calculated eigval = 0.074390963226346
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60267864966624
lambda[   6] =  -0.54457400880998
lambda[   7] =  -0.51536539987731
lambda[   8] =  -0.50824227065432
lambda[   9] =  -0.48704744773519
lambda[  10] =  -0.46799846079290
lambda[  11] =  -0.42267779658331
lambda[  12] =  -0.41354139450670
lambda[  13] =  -0.32723896817057
lambda[  14] =  -0.30661613738517
lambda[  15] =  -0.13940636463329
lambda[  16] =  -0.12635395283144
lambda[  17] =   0.00720941483913
lambda[  18] =   0.03724672798428
lambda[  19] =   0.04824274570854
lambda[  20] =   0.06551120313505
lambda[  21] =   0.07439096322635
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 8.204 ms
rank =  0, Distributing orbital back into band + domain format took 18.147 ms
rank = 0, Subspace_Rotation used 26.367 ms

Total time for subspace rotation: 27.251 ms
rank = 0, Efermi =  -0.167989358097 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 5.301 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.119 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 6548.375 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.809 ms
rank = 0, D2D took 1.905 ms
rank = 0, Transfering density took 1.907 ms
Etot    =   -53.596719257603
Eband   =   -16.405331481948
E1      =    32.140395921040
E2      =   -13.803459617759
E3      =   -17.346613064162
Exc     =   -15.584962982188
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 5.955e+00, dEband = 1.823e+00
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -53.596719258, dEtot = 5.955e+00, dEband = 1.823e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 67.6600656952898, which took 1.316 ms

iter_count = 90, r_2norm = 2.536e-03, tol*||rhs|| = 2.706e-03

Anderson update took 48.232 ms, out of which F'*F took 22.658 ms; b-Ax took 153.952 ms, out of which Lap took 137.427 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.633 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803184, int_b + int_rho = 1.819e-14, checking this took 0.115 ms
2-norm of RHS = 731.1712960675048, which took 0.111 ms

iter_count = 282, r_2norm = 6.660e-04, tol*||rhs|| = 7.312e-04

Anderson update took 151.298 ms, out of which F'*F took 70.480 ms; b-Ax took 478.966 ms, out of which Lap took 428.554 ms
Solving Poisson took 1015.038 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.432 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.234190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.752 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.181602 
Total time for convolution: 	 convolve: 5.170270 
Total time for convolution: 	 convolve: 5.163362 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.120 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.518 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 8.189 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 11.744 ms

This SCF took 32655.538 ms, scf error = 1.497e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.174391, lowerbound = -1.071232, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1484.441 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 32.349 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.591 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.965 ms
rank =  0, finding HY took 25.287 ms
rank =  0, distributing HY into block cyclic form took 18.866 ms
rank =  0, finding Y'*HY took 4.020 ms
Rank 0, Project_Hamiltonian used 83.181 ms
Total time for projection: 83.199 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.040164314321172
    last  calculated eigval = 0.047898661310828
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57893001081915
lambda[   6] =  -0.51790039902064
lambda[   7] =  -0.49014409412484
lambda[   8] =  -0.47797249611453
lambda[   9] =  -0.45567037633209
lambda[  10] =  -0.43791688024554
lambda[  11] =  -0.40031812328456
lambda[  12] =  -0.38842784705368
lambda[  13] =  -0.29653846805118
lambda[  14] =  -0.27411181595324
lambda[  15] =  -0.12810841075993
lambda[  16] =  -0.11607135828236
lambda[  17] =  -0.01721328742465
lambda[  18] =   0.01702748395181
lambda[  19] =   0.02476557386001
lambda[  20] =   0.04127584437686
lambda[  21] =   0.04789866131083
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.265 ms
rank =  0, Distributing orbital back into band + domain format took 18.221 ms
rank = 0, Subspace_Rotation used 26.509 ms

Total time for subspace rotation: 26.515 ms
rank = 0, Efermi =  -0.156691404327 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.336 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.753 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1611.606 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.015 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.865 ms
rank = 0, D2D took 1.970 ms
rank = 0, Transfering density took 1.976 ms
Etot    =   -53.539476228885
Eband   =   -15.621544907825
E1      =    31.477052483936
E2      =   -13.697948956285
E3      =   -17.556768488017
Exc     =   -15.752807852870
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 6.360e-03, dEband = 8.709e-02
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -53.539476229, dEtot = 6.360e-03, dEband = 8.709e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 31.1988839372954, which took 0.103 ms

iter_count = 96, r_2norm = 1.045e-03, tol*||rhs|| = 1.248e-03

Anderson update took 51.302 ms, out of which F'*F took 24.042 ms; b-Ax took 162.437 ms, out of which Lap took 145.702 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.298 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803174, int_b + int_rho = -7.640e-14, checking this took 0.124 ms
2-norm of RHS = 727.1959873392934, which took 0.126 ms

iter_count = 294, r_2norm = 6.431e-04, tol*||rhs|| = 7.272e-04

Anderson update took 157.501 ms, out of which F'*F took 73.990 ms; b-Ax took 501.774 ms, out of which Lap took 449.103 ms
Solving Poisson took 1058.072 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.168771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.187841 
Total time for convolution: 	 convolve: 5.158694 
Total time for convolution: 	 convolve: 5.183231 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.521 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.057 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.612 ms

This SCF took 27798.395 ms, scf error = 1.007e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147899, lowerbound = -1.040164, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1479.659 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 23.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.011 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.508 ms
rank =  0, finding HY took 25.803 ms
rank =  0, distributing HY into block cyclic form took 18.420 ms
rank =  0, finding Y'*HY took 4.232 ms
Rank 0, Project_Hamiltonian used 75.002 ms
Total time for projection: 75.020 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.002634233185523
    last  calculated eigval = 0.036927607926788
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54098358653852
lambda[   6] =  -0.47881480357162
lambda[   7] =  -0.45319066681852
lambda[   8] =  -0.43840654945024
lambda[   9] =  -0.41739445047922
lambda[  10] =  -0.39681556460273
lambda[  11] =  -0.37479244180434
lambda[  12] =  -0.35739997943886
lambda[  13] =  -0.25999416886668
lambda[  14] =  -0.23547478346068
lambda[  15] =  -0.10485325467285
lambda[  16] =  -0.09389947427907
lambda[  17] =  -0.02426921355345
lambda[  18] =   0.01018046470586
lambda[  19] =   0.01644033626109
lambda[  20] =   0.03011610134162
lambda[  21] =   0.03692760792679
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.731 ms
rank =  0, Distributing orbital back into band + domain format took 18.783 ms
rank = 0, Subspace_Rotation used 26.534 ms

Total time for subspace rotation: 26.540 ms
rank = 0, Efermi =  -0.133436248810 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.332 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.714 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1598.583 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.811 ms
rank = 0, D2D took 1.923 ms
rank = 0, Transfering density took 1.929 ms
Etot    =   -53.499599322539
Eband   =   -14.581049312156
E1      =    30.626335953341
E2      =   -13.487711766161
E3      =   -17.858934688720
Exc     =   -15.994639022177
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 4.431e-03, dEband = 1.156e-01
rank = 0, Calculating/Estimating energy took 0.948 ms, Etot = -53.499599323, dEtot = 4.431e-03, dEband = 1.156e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.6234664458194, which took 0.107 ms

iter_count = 108, r_2norm = 1.424e-04, tol*||rhs|| = 2.249e-04

Anderson update took 57.501 ms, out of which F'*F took 26.888 ms; b-Ax took 183.434 ms, out of which Lap took 163.847 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.223 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803194, int_b + int_rho = 1.201e-13, checking this took 0.109 ms
2-norm of RHS = 727.3784541750359, which took 0.119 ms

iter_count = 282, r_2norm = 5.698e-04, tol*||rhs|| = 7.274e-04

Anderson update took 154.413 ms, out of which F'*F took 70.896 ms; b-Ax took 481.848 ms, out of which Lap took 431.720 ms
Solving Poisson took 1019.531 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.171649 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.342 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.162026 
Total time for convolution: 	 convolve: 5.152424 
Total time for convolution: 	 convolve: 5.175216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.056 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.563 ms

This SCF took 27735.576 ms, scf error = 4.008e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.136928, lowerbound = -1.002634, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1458.512 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 44.062 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.648 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.729 ms
rank =  0, finding HY took 24.994 ms
rank =  0, distributing HY into block cyclic form took 19.259 ms
rank =  0, finding Y'*HY took 3.950 ms
Rank 0, Project_Hamiltonian used 94.977 ms
Total time for projection: 94.990 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.708 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.806 ms
    first calculated eigval = -0.989595244896787
    last  calculated eigval = 0.033262821537975
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.52218940465561
lambda[   6] =  -0.46164607944772
lambda[   7] =  -0.43728242604507
lambda[   8] =  -0.42358060208909
lambda[   9] =  -0.40369272046466
lambda[  10] =  -0.38010863565180
lambda[  11] =  -0.36603130718036
lambda[  12] =  -0.34560279347452
lambda[  13] =  -0.24811628485764
lambda[  14] =  -0.22271457163777
lambda[  15] =  -0.09403903268495
lambda[  16] =  -0.08325317108981
lambda[  17] =  -0.02576598994204
lambda[  18] =   0.00732996061010
lambda[  19] =   0.01413522087537
lambda[  20] =   0.02492923528447
lambda[  21] =   0.03326282153797
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.844 ms
rank =  0, subspace rotation using ScaLAPACK took 7.722 ms
rank =  0, Distributing orbital back into band + domain format took 18.671 ms
rank = 0, Subspace_Rotation used 26.409 ms

Total time for subspace rotation: 26.414 ms
rank = 0, Efermi =  -0.122622027034 calculate fermi energy took 0.123 ms
rank = 0, --- Calculate rho: sum over local bands took 5.355 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.591 ms
rank = 0, Calculating density took 1598.883 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.029 ms
rank = 0, D2D took 2.136 ms
rank = 0, Transfering density took 2.144 ms
Etot    =   -53.492981639227
Eband   =   -14.170696718209
E1      =    30.335136740066
E2      =   -13.347572093098
E3      =   -17.988332257341
Exc     =   -16.096432615095
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 7.353e-04, dEband = 4.559e-02
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -53.492981639, dEtot = 7.353e-04, dEband = 4.559e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9810035358062, which took 0.054 ms

iter_count = 108, r_2norm = 6.690e-05, tol*||rhs|| = 7.924e-05

Anderson update took 57.621 ms, out of which F'*F took 26.423 ms; b-Ax took 181.786 ms, out of which Lap took 161.837 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.586 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803173, int_b + int_rho = -9.459e-14, checking this took 0.112 ms
2-norm of RHS = 728.2990990156159, which took 0.071 ms

iter_count = 258, r_2norm = 6.868e-04, tol*||rhs|| = 7.283e-04

Anderson update took 138.397 ms, out of which F'*F took 64.464 ms; b-Ax took 437.249 ms, out of which Lap took 392.235 ms
Solving Poisson took 925.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.160142 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.767 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
Total time for convolution: 	 convolve: 5.173858 
Total time for convolution: 	 convolve: 5.201122 
Total time for convolution: 	 convolve: 5.219531 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.658 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.202 ms

This SCF took 27962.435 ms, scf error = 1.272e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.133263, lowerbound = -0.989595, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1454.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 46.046 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.221 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.764 ms
rank =  0, finding HY took 24.253 ms
rank =  0, distributing HY into block cyclic form took 18.447 ms
rank =  0, finding Y'*HY took 4.062 ms
Rank 0, Project_Hamiltonian used 96.566 ms
Total time for projection: 96.583 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.984200956802136
    last  calculated eigval = 0.031320762016709
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51765984159881
lambda[   6] =  -0.45734108618254
lambda[   7] =  -0.43386051399206
lambda[   8] =  -0.41857504886913
lambda[   9] =  -0.39796774879817
lambda[  10] =  -0.37516520930173
lambda[  11] =  -0.36144676379509
lambda[  12] =  -0.34121430991648
lambda[  13] =  -0.24280232738182
lambda[  14] =  -0.21741905715508
lambda[  15] =  -0.09048419313683
lambda[  16] =  -0.07975051390038
lambda[  17] =  -0.02629567885076
lambda[  18] =   0.00497344686403
lambda[  19] =   0.01328982673705
lambda[  20] =   0.02277868117074
lambda[  21] =   0.03132076201671
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 7.713 ms
rank =  0, Distributing orbital back into band + domain format took 18.663 ms
rank = 0, Subspace_Rotation used 26.392 ms

Total time for subspace rotation: 26.397 ms
rank = 0, Efermi =  -0.119067187505 calculate fermi energy took 0.535 ms
rank = 0, --- Calculate rho: sum over local bands took 6.188 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.686 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1594.363 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.910 ms
rank = 0, D2D took 2.014 ms
rank = 0, Transfering density took 2.021 ms
Etot    =   -53.491658456687
Eband   =   -14.040644697611
E1      =    30.282024163937
E2      =   -13.261095239037
E3      =   -18.026132469340
Exc     =   -16.123372234963
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 1.470e-04, dEband = 1.445e-02
rank = 0, Calculating/Estimating energy took 0.969 ms, Etot = -53.491658457, dEtot = 1.470e-04, dEband = 1.445e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0918099550434, which took 0.549 ms

iter_count = 108, r_2norm = 4.277e-05, tol*||rhs|| = 4.367e-05

Anderson update took 57.693 ms, out of which F'*F took 27.242 ms; b-Ax took 183.950 ms, out of which Lap took 164.659 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.616 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803180, int_b + int_rho = -1.819e-14, checking this took 0.111 ms
2-norm of RHS = 728.5336083948748, which took 0.140 ms

iter_count = 222, r_2norm = 5.981e-04, tol*||rhs|| = 7.285e-04

Anderson update took 119.675 ms, out of which F'*F took 55.540 ms; b-Ax took 377.571 ms, out of which Lap took 338.074 ms
Solving Poisson took 795.667 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.221 ms
Total time for convolution: 	 convolve: 5.301190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 6.628146 
Total time for convolution: 	 convolve: 5.160316 
Total time for convolution: 	 convolve: 5.187742 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.104 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.650 ms

This SCF took 29193.490 ms, scf error = 4.577e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131321, lowerbound = -0.984201, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1478.791 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 32.177 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.642 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.839 ms
rank =  0, finding HY took 24.967 ms
rank =  0, distributing HY into block cyclic form took 18.337 ms
rank =  0, finding Y'*HY took 4.037 ms
Rank 0, Project_Hamiltonian used 82.218 ms
Total time for projection: 82.239 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.983732989149738
    last  calculated eigval = 0.029600526962743
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51701854670192
lambda[   6] =  -0.45656652130708
lambda[   7] =  -0.43314533418301
lambda[   8] =  -0.41791663013038
lambda[   9] =  -0.39737957280047
lambda[  10] =  -0.37450334237984
lambda[  11] =  -0.36088298624003
lambda[  12] =  -0.34062194909490
lambda[  13] =  -0.24225360918079
lambda[  14] =  -0.21687719879596
lambda[  15] =  -0.08994695077043
lambda[  16] =  -0.07919514371218
lambda[  17] =  -0.02645756396014
lambda[  18] =   0.00344842106044
lambda[  19] =   0.01274934792569
lambda[  20] =   0.02186509107514
lambda[  21] =   0.02960052696274
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 7.732 ms
rank =  0, Distributing orbital back into band + domain format took 18.588 ms
rank = 0, Subspace_Rotation used 26.346 ms

Total time for subspace rotation: 26.350 ms
rank = 0, Efermi =  -0.118529945105 calculate fermi energy took 0.145 ms
rank = 0, --- Calculate rho: sum over local bands took 5.373 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.586 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1604.391 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.876 ms
rank = 0, D2D took 1.969 ms
rank = 0, Transfering density took 1.972 ms
Etot    =   -53.491549186243
Eband   =   -14.022913847029
E1      =    30.280231132835
E2      =   -13.244671340498
E3      =   -18.026346542218
Exc     =   -16.122990958337
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 1.214e-05, dEband = 1.970e-03
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -53.491549186, dEtot = 1.214e-05, dEband = 1.970e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5826532560300, which took 0.110 ms

iter_count = 108, r_2norm = 2.083e-05, tol*||rhs|| = 2.331e-05

Anderson update took 58.383 ms, out of which F'*F took 26.961 ms; b-Ax took 183.775 ms, out of which Lap took 164.557 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.499 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803182, int_b + int_rho = 0.000e+00, checking this took 0.116 ms
2-norm of RHS = 728.8762073067884, which took 0.121 ms

iter_count = 240, r_2norm = 6.757e-04, tol*||rhs|| = 7.289e-04

Anderson update took 128.344 ms, out of which F'*F took 61.794 ms; b-Ax took 411.841 ms, out of which Lap took 368.599 ms
Solving Poisson took 863.755 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.161916 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 90.363 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.159745 
Total time for convolution: 	 convolve: 5.154985 
Total time for convolution: 	 convolve: 5.154943 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.005 ms
---Transfer Veff_loc: D2D took 4.288 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.085 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.409 ms

This SCF took 27617.663 ms, scf error = 3.263e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129601, lowerbound = -0.983733, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1454.112 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 46.404 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.623 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.045 ms
rank =  0, finding HY took 25.019 ms
rank =  0, distributing HY into block cyclic form took 18.389 ms
rank =  0, finding Y'*HY took 4.032 ms
Rank 0, Project_Hamiltonian used 96.521 ms
Total time for projection: 96.542 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.236 ms
    first calculated eigval = -0.980825994181743
    last  calculated eigval = 0.029201832972469
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51434857235624
lambda[   6] =  -0.45353326492912
lambda[   7] =  -0.43041229862267
lambda[   8] =  -0.41485192788271
lambda[   9] =  -0.39423194734548
lambda[  10] =  -0.37150074089175
lambda[  11] =  -0.35819427035639
lambda[  12] =  -0.33788530809058
lambda[  13] =  -0.23931732441031
lambda[  14] =  -0.21388906165790
lambda[  15] =  -0.08778146696526
lambda[  16] =  -0.07693559945815
lambda[  17] =  -0.02617619652587
lambda[  18] =   0.00306713886393
lambda[  19] =   0.01285932400913
lambda[  20] =   0.02191177823877
lambda[  21] =   0.02920183297247
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 7.672 ms
rank =  0, Distributing orbital back into band + domain format took 18.663 ms
rank = 0, Subspace_Rotation used 26.354 ms

Total time for subspace rotation: 26.358 ms
rank = 0, Efermi =  -0.116364461199 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.284 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.683 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1593.967 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.882 ms
rank = 0, D2D took 1.977 ms
rank = 0, Transfering density took 1.980 ms
Etot    =   -53.491293009643
Eband   =   -13.941279042967
E1      =    30.243519690869
E2      =   -13.196036352659
E3      =   -18.039303528651
Exc     =   -16.131980142427
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 2.846e-05, dEband = 9.071e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -53.491293010, dEtot = 2.846e-05, dEband = 9.071e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2474749191965, which took 0.077 ms

iter_count = 114, r_2norm = 6.405e-06, tol*||rhs|| = 9.899e-06

Anderson update took 61.282 ms, out of which F'*F took 28.681 ms; b-Ax took 196.086 ms, out of which Lap took 176.776 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.758 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803187, int_b + int_rho = 5.457e-14, checking this took 0.107 ms
2-norm of RHS = 728.9049323337225, which took 0.129 ms

iter_count = 234, r_2norm = 6.403e-04, tol*||rhs|| = 7.289e-04

Anderson update took 126.199 ms, out of which F'*F took 58.978 ms; b-Ax took 397.558 ms, out of which Lap took 355.814 ms
Solving Poisson took 840.844 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.161807 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 98.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.163941 
Total time for convolution: 	 convolve: 5.230770 
Total time for convolution: 	 convolve: 5.195192 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.604 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.091 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
---Transfer Veff_loc: D2D took 3.589 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.103 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.728 ms

This SCF took 27864.770 ms, scf error = 1.662e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129202, lowerbound = -0.980826, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1453.891 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 44.724 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.638 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.383 ms
rank =  0, finding HY took 24.853 ms
rank =  0, distributing HY into block cyclic form took 18.368 ms
rank =  0, finding Y'*HY took 4.022 ms
Rank 0, Project_Hamiltonian used 94.659 ms
Total time for projection: 94.678 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.978128634452674
    last  calculated eigval = 0.029531177591606
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51221794035128
lambda[   6] =  -0.45121174146557
lambda[   7] =  -0.42828720663325
lambda[   8] =  -0.41237965381545
lambda[   9] =  -0.39152646064777
lambda[  10] =  -0.36916932807579
lambda[  11] =  -0.35573308242298
lambda[  12] =  -0.33568205764061
lambda[  13] =  -0.23689549451629
lambda[  14] =  -0.21142700259419
lambda[  15] =  -0.08576642998969
lambda[  16] =  -0.07476049082717
lambda[  17] =  -0.02536615057284
lambda[  18] =   0.00382317627052
lambda[  19] =   0.01374243224020
lambda[  20] =   0.02233848350091
lambda[  21] =   0.02953117759161
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.288 ms
rank =  0, subspace rotation using ScaLAPACK took 7.722 ms
rank =  0, Distributing orbital back into band + domain format took 18.574 ms
rank = 0, Subspace_Rotation used 26.317 ms

Total time for subspace rotation: 26.322 ms
rank = 0, Efermi =  -0.114349424081 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.362 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.593 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1591.903 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.932 ms
Etot    =   -53.491334221338
Eband   =   -13.874249626423
E1      =    30.208408058420
E2      =   -13.161907879235
E3      =   -18.047312275652
Exc     =   -16.137819411794
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 4.579e-06, dEband = 7.448e-03
rank = 0, Calculating/Estimating energy took 1.812 ms, Etot = -53.491334221, dEtot = 4.579e-06, dEband = 7.448e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1902395986518, which took 0.067 ms

iter_count = 114, r_2norm = 5.034e-06, tol*||rhs|| = 7.610e-06

Anderson update took 79.562 ms, out of which F'*F took 29.852 ms; b-Ax took 195.316 ms, out of which Lap took 175.384 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.160 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803185, int_b + int_rho = 2.547e-14, checking this took 0.113 ms
2-norm of RHS = 728.9033115169044, which took 0.105 ms

iter_count = 210, r_2norm = 5.790e-04, tol*||rhs|| = 7.289e-04

Anderson update took 113.682 ms, out of which F'*F took 53.039 ms; b-Ax took 354.582 ms, out of which Lap took 317.561 ms
Solving Poisson took 755.836 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.173465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.584 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.215896 
Total time for convolution: 	 convolve: 5.199244 
Total time for convolution: 	 convolve: 5.207103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.547 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.090 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.675 ms

This SCF took 27768.129 ms, scf error = 8.835e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129531, lowerbound = -0.978129, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1456.265 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 42.717 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.622 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 45.357 ms
rank =  0, finding HY took 24.950 ms
rank =  0, distributing HY into block cyclic form took 18.326 ms
rank =  0, finding Y'*HY took 4.055 ms
Rank 0, Project_Hamiltonian used 92.725 ms
Total time for projection: 92.741 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.977101847414141
    last  calculated eigval = 0.029805732000812
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51129316476661
lambda[   6] =  -0.45031283897939
lambda[   7] =  -0.42743104065493
lambda[   8] =  -0.41143153747733
lambda[   9] =  -0.39050284507134
lambda[  10] =  -0.36824480453420
lambda[  11] =  -0.35476419567805
lambda[  12] =  -0.33478429833768
lambda[  13] =  -0.23593335359235
lambda[  14] =  -0.21046302805029
lambda[  15] =  -0.08485899064268
lambda[  16] =  -0.07380540702329
lambda[  17] =  -0.02434320090792
lambda[  18] =   0.00498954597754
lambda[  19] =   0.01496878145172
lambda[  20] =   0.02297563277175
lambda[  21] =   0.02980573200081
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 7.678 ms
rank =  0, Distributing orbital back into band + domain format took 18.620 ms
rank = 0, Subspace_Rotation used 26.314 ms

Total time for subspace rotation: 26.320 ms
rank = 0, Efermi =  -0.113441984735 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.335 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.681 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1592.340 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.771 ms
rank = 0, D2D took 2.881 ms
rank = 0, Transfering density took 2.890 ms
Etot    =   -53.491390546323
Eband   =   -13.847961763818
E1      =    30.195384153522
E2      =   -13.148001175318
E3      =   -18.049662623001
Exc     =   -16.139583337917
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 6.258e-06, dEband = 2.921e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -53.491390546, dEtot = 6.258e-06, dEband = 2.921e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1033153754498, which took 0.054 ms

iter_count = 114, r_2norm = 2.539e-06, tol*||rhs|| = 4.133e-06

Anderson update took 61.439 ms, out of which F'*F took 29.135 ms; b-Ax took 194.585 ms, out of which Lap took 174.659 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.456 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803184, int_b + int_rho = 1.819e-14, checking this took 0.115 ms
2-norm of RHS = 728.8864750652538, which took 0.108 ms

iter_count = 210, r_2norm = 5.971e-04, tol*||rhs|| = 7.289e-04

Anderson update took 113.094 ms, out of which F'*F took 53.240 ms; b-Ax took 357.018 ms, out of which Lap took 320.059 ms
Solving Poisson took 756.344 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.183626 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 94.954 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.152980 
Total time for convolution: 	 convolve: 5.165218 
Total time for convolution: 	 convolve: 5.168162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.557 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.113 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.706 ms

This SCF took 27554.501 ms, scf error = 6.390e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129806, lowerbound = -0.977102, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1457.755 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 44.261 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.609 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.888 ms
rank =  0, finding HY took 25.063 ms
rank =  0, distributing HY into block cyclic form took 18.537 ms
rank =  0, finding Y'*HY took 4.273 ms
Rank 0, Project_Hamiltonian used 94.797 ms
Total time for projection: 94.812 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -0.976106429803054
    last  calculated eigval = 0.031218195222036
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.51028157407488
lambda[   6] =  -0.44930013766465
lambda[   7] =  -0.42641943920572
lambda[   8] =  -0.41043181676998
lambda[   9] =  -0.38948451069202
lambda[  10] =  -0.36724486762818
lambda[  11] =  -0.35376440639874
lambda[  12] =  -0.33378059580674
lambda[  13] =  -0.23491443414977
lambda[  14] =  -0.20944381401982
lambda[  15] =  -0.08379098490955
lambda[  16] =  -0.07270999730916
lambda[  17] =  -0.02178994450553
lambda[  18] =   0.00797274592752
lambda[  19] =   0.01813598855631
lambda[  20] =   0.02551213473559
lambda[  21] =   0.03121819522204
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.249 ms
rank =  0, subspace rotation using ScaLAPACK took 8.349 ms
rank =  0, Distributing orbital back into band + domain format took 18.978 ms
rank = 0, Subspace_Rotation used 27.354 ms

Total time for subspace rotation: 27.359 ms
rank = 0, Efermi =  -0.112373978896 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.780 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.734 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.629 ms
rank = 0, Calculating density took 1596.990 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.882 ms
rank = 0, D2D took 1.986 ms
rank = 0, Transfering density took 1.992 ms
Etot    =   -53.491458421926
Eband   =   -13.819650543674
E1      =    30.181467979956
E2      =   -13.133315809716
E3      =   -18.050928918290
Exc     =   -16.140627189785
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 7.542e-06, dEband = 3.146e-03
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -53.491458422, dEtot = 7.542e-06, dEband = 3.146e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1052655197118, which took 0.082 ms

iter_count = 102, r_2norm = 4.189e-06, tol*||rhs|| = 4.211e-06

Anderson update took 54.915 ms, out of which F'*F took 25.514 ms; b-Ax took 173.298 ms, out of which Lap took 155.251 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.978 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803181, int_b + int_rho = -1.091e-14, checking this took 0.111 ms
2-norm of RHS = 728.9063472568122, which took 0.092 ms

iter_count = 192, r_2norm = 6.970e-04, tol*||rhs|| = 7.289e-04

Anderson update took 104.115 ms, out of which F'*F took 48.581 ms; b-Ax took 324.019 ms, out of which Lap took 290.308 ms
Solving Poisson took 691.237 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.177095 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.939 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.216822 
Total time for convolution: 	 convolve: 5.161783 
Total time for convolution: 	 convolve: 5.161290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.537 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.568 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.083 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.690 ms

This SCF took 27442.790 ms, scf error = 3.738e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131218, lowerbound = -0.976106, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1451.016 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 46.784 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.671 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.476 ms
rank =  0, finding HY took 24.887 ms
rank =  0, distributing HY into block cyclic form took 18.316 ms
rank =  0, finding Y'*HY took 4.023 ms
Rank 0, Project_Hamiltonian used 96.741 ms
Total time for projection: 96.767 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -0.975142235426720
    last  calculated eigval = 0.033128221178893
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50934200746848
lambda[   6] =  -0.44835235701345
lambda[   7] =  -0.42548850983204
lambda[   8] =  -0.40949961103872
lambda[   9] =  -0.38851896836440
lambda[  10] =  -0.36631950803793
lambda[  11] =  -0.35280277976362
lambda[  12] =  -0.33285602256766
lambda[  13] =  -0.23397419234187
lambda[  14] =  -0.20850030977023
lambda[  15] =  -0.08277395670677
lambda[  16] =  -0.07168750271613
lambda[  17] =  -0.01845914904347
lambda[  18] =   0.01096957745602
lambda[  19] =   0.02139355865976
lambda[  20] =   0.02979162787133
lambda[  21] =   0.03312822117889
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 7.744 ms
rank =  0, Distributing orbital back into band + domain format took 18.822 ms
rank = 0, Subspace_Rotation used 26.591 ms

Total time for subspace rotation: 26.596 ms
rank = 0, Efermi =  -0.111356950736 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.266 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.670 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1591.329 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.851 ms
rank = 0, D2D took 1.952 ms
rank = 0, Transfering density took 1.957 ms
Etot    =   -53.491537846104
Eband   =   -13.793084520236
E1      =    30.168197003416
E2      =   -13.119507793253
E3      =   -18.052979190006
Exc     =   -16.142243916115
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 8.825e-06, dEband = 2.952e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -53.491537846, dEtot = 8.825e-06, dEband = 2.952e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1001261958124, which took 0.057 ms

iter_count = 102, r_2norm = 3.591e-06, tol*||rhs|| = 4.005e-06

Anderson update took 54.655 ms, out of which F'*F took 26.189 ms; b-Ax took 174.248 ms, out of which Lap took 156.227 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.816 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803172, int_b + int_rho = -9.823e-14, checking this took 0.097 ms
2-norm of RHS = 728.9118445300287, which took 0.119 ms

iter_count = 162, r_2norm = 5.978e-04, tol*||rhs|| = 7.289e-04

Anderson update took 87.471 ms, out of which F'*F took 41.031 ms; b-Ax took 275.215 ms, out of which Lap took 246.880 ms
Solving Poisson took 584.114 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.155548 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 101.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.175196 
Total time for convolution: 	 convolve: 5.158864 
Total time for convolution: 	 convolve: 5.160388 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.543 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
---Transfer Veff_loc: D2D took 3.582 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.159 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.778 ms

This SCF took 27322.021 ms, scf error = 2.130e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133128, lowerbound = -0.975142, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1458.651 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 44.788 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.648 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.459 ms
rank =  0, finding HY took 24.999 ms
rank =  0, distributing HY into block cyclic form took 18.305 ms
rank =  0, finding Y'*HY took 4.077 ms
Rank 0, Project_Hamiltonian used 94.874 ms
Total time for projection: 94.888 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.974889188589537
    last  calculated eigval = 0.034299746691515
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50906821459965
lambda[   6] =  -0.44808651808119
lambda[   7] =  -0.42521677042814
lambda[   8] =  -0.40924428308286
lambda[   9] =  -0.38827347486725
lambda[  10] =  -0.36606479120700
lambda[  11] =  -0.35254060523687
lambda[  12] =  -0.33259843775748
lambda[  13] =  -0.23372582524198
lambda[  14] =  -0.20825252633535
lambda[  15] =  -0.08249935197948
lambda[  16] =  -0.07140201797909
lambda[  17] =  -0.01690059782126
lambda[  18] =   0.01203242020003
lambda[  19] =   0.02209637856203
lambda[  20] =   0.03220376377418
lambda[  21] =   0.03429974669152
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 7.770 ms
rank =  0, Distributing orbital back into band + domain format took 19.103 ms
rank = 0, Subspace_Rotation used 26.898 ms

Total time for subspace rotation: 26.902 ms
rank = 0, Efermi =  -0.111082345972 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.328 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.623 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1597.408 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.844 ms
rank = 0, D2D took 1.951 ms
rank = 0, Transfering density took 1.959 ms
Etot    =   -53.491578590698
Eband   =   -13.785783210647
E1      =    30.164675339982
E2      =   -13.115659284201
E3      =   -18.053211972800
Exc     =   -16.142448580605
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 4.527e-06, dEband = 8.113e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -53.491578591, dEtot = 4.527e-06, dEband = 8.113e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0562555194877, which took 0.123 ms

iter_count = 108, r_2norm = 1.656e-06, tol*||rhs|| = 2.250e-06

Anderson update took 57.935 ms, out of which F'*F took 26.919 ms; b-Ax took 187.785 ms, out of which Lap took 168.763 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.684 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803187, int_b + int_rho = 4.729e-14, checking this took 0.125 ms
2-norm of RHS = 728.9140114358577, which took 0.099 ms

iter_count = 156, r_2norm = 6.713e-04, tol*||rhs|| = 7.289e-04

Anderson update took 83.931 ms, out of which F'*F took 39.252 ms; b-Ax took 265.195 ms, out of which Lap took 237.209 ms
Solving Poisson took 562.487 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.158461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 89.667 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.174149 
Total time for convolution: 	 convolve: 5.163871 
Total time for convolution: 	 convolve: 5.158885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.756 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.545 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.156 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.737 ms

This SCF took 27331.059 ms, scf error = 1.680e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134300, lowerbound = -0.974889, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1464.751 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 45.269 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.627 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.923 ms
rank =  0, finding HY took 24.957 ms
rank =  0, distributing HY into block cyclic form took 18.437 ms
rank =  0, finding Y'*HY took 4.006 ms
Rank 0, Project_Hamiltonian used 95.357 ms
Total time for projection: 95.372 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.638 ms
rank = 0, Solve_Generalized_EigenProblem used 1.654 ms
    first calculated eigval = -0.974683914913750
    last  calculated eigval = 0.035527840038552
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50884673995803
lambda[   6] =  -0.44787614628564
lambda[   7] =  -0.42500420624705
lambda[   8] =  -0.40903354004716
lambda[   9] =  -0.38807144285089
lambda[  10] =  -0.36585434138582
lambda[  11] =  -0.35233819181111
lambda[  12] =  -0.33239013812517
lambda[  13] =  -0.23352507692162
lambda[  14] =  -0.20804869279545
lambda[  15] =  -0.08234087652972
lambda[  16] =  -0.07124866753973
lambda[  17] =  -0.01597626536651
lambda[  18] =   0.01203287943110
lambda[  19] =   0.02170282723914
lambda[  20] =   0.03350369607775
lambda[  21] =   0.03552784003855
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 1.678 ms
rank =  0, subspace rotation using ScaLAPACK took 7.715 ms
rank =  0, Distributing orbital back into band + domain format took 18.447 ms
rank = 0, Subspace_Rotation used 26.180 ms

Total time for subspace rotation: 26.185 ms
rank = 0, Efermi =  -0.110923870535 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.259 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.749 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1604.719 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.937 ms
rank = 0, Transfering density took 1.944 ms
Etot    =   -53.491634718044
Eband   =   -13.779935593286
E1      =    30.161813724406
E2      =   -13.112575390513
E3      =   -18.053453017022
Exc     =   -16.142647860270
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 6.236e-06, dEband = 6.497e-04
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -53.491634718, dEtot = 6.236e-06, dEband = 6.497e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0424152955299, which took 0.069 ms

iter_count = 108, r_2norm = 1.251e-06, tol*||rhs|| = 1.697e-06

Anderson update took 58.278 ms, out of which F'*F took 27.208 ms; b-Ax took 183.935 ms, out of which Lap took 165.160 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.971 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803180, int_b + int_rho = -1.455e-14, checking this took 0.124 ms
2-norm of RHS = 728.9142213284131, which took 0.109 ms

iter_count = 144, r_2norm = 6.343e-04, tol*||rhs|| = 7.289e-04

Anderson update took 77.538 ms, out of which F'*F took 36.539 ms; b-Ax took 244.789 ms, out of which Lap took 219.594 ms
Solving Poisson took 520.589 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.180023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 89.655 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.120 ms
Total time for convolution: 	 convolve: 5.162664 
Total time for convolution: 	 convolve: 5.186778 
Total time for convolution: 	 convolve: 5.157897 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.867 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.101 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.003 ms

This SCF took 27336.493 ms, scf error = 1.275e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135528, lowerbound = -0.974684, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1458.179 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 44.541 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.523 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 48.205 ms
rank =  0, finding HY took 24.682 ms
rank =  0, distributing HY into block cyclic form took 18.367 ms
rank =  0, finding Y'*HY took 4.050 ms
Rank 0, Project_Hamiltonian used 95.350 ms
Total time for projection: 95.367 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.974570145533502
    last  calculated eigval = 0.037408540279645
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50872366440368
lambda[   6] =  -0.44775813172771
lambda[   7] =  -0.42488494379323
lambda[   8] =  -0.40891579822160
lambda[   9] =  -0.38795453046756
lambda[  10] =  -0.36573553316793
lambda[  11] =  -0.35222373365706
lambda[  12] =  -0.33227029417304
lambda[  13] =  -0.23341161991316
lambda[  14] =  -0.20793216714038
lambda[  15] =  -0.08224390051142
lambda[  16] =  -0.07116366624473
lambda[  17] =  -0.01499413661384
lambda[  18] =   0.01208777492305
lambda[  19] =   0.02175913498649
lambda[  20] =   0.03385743018567
lambda[  21] =   0.03740854027965
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 7.707 ms
rank =  0, Distributing orbital back into band + domain format took 18.843 ms
rank = 0, Subspace_Rotation used 26.574 ms

Total time for subspace rotation: 26.578 ms
rank = 0, Efermi =  -0.110826894479 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.309 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1597.095 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.951 ms
rank = 0, Transfering density took 1.958 ms
Etot    =   -53.491661812856
Eband   =   -13.776649710057
E1      =    30.160272637302
E2      =   -13.110801932345
E3      =   -18.053492793425
Exc     =   -16.142686069442
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 3.011e-06, dEband = 3.651e-04
rank = 0, Calculating/Estimating energy took 0.944 ms, Etot = -53.491661813, dEtot = 3.011e-06, dEband = 3.651e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0308782060826, which took 0.079 ms

iter_count = 108, r_2norm = 1.060e-06, tol*||rhs|| = 1.235e-06

Anderson update took 58.620 ms, out of which F'*F took 27.014 ms; b-Ax took 183.473 ms, out of which Lap took 164.236 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.925 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803198, int_b + int_rho = 1.601e-13, checking this took 0.113 ms
2-norm of RHS = 728.9160762506436, which took 0.094 ms

iter_count = 114, r_2norm = 7.063e-04, tol*||rhs|| = 7.289e-04

Anderson update took 61.506 ms, out of which F'*F took 28.734 ms; b-Ax took 192.872 ms, out of which Lap took 172.779 ms
Solving Poisson took 411.677 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.259 ms
Total time for convolution: 	 convolve: 5.165165 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 98.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.155450 
Total time for convolution: 	 convolve: 5.203254 
Total time for convolution: 	 convolve: 5.156332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.104 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.661 ms

This SCF took 27204.782 ms, scf error = 1.044e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.137409, lowerbound = -0.974570, upperbound = 267.583692

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1456.713 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 42.950 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.621 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 45.589 ms
rank =  0, finding HY took 24.968 ms
rank =  0, distributing HY into block cyclic form took 18.527 ms
rank =  0, finding Y'*HY took 3.986 ms
Rank 0, Project_Hamiltonian used 93.114 ms
Total time for projection: 93.128 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.974479635815138
    last  calculated eigval = 0.037829345161085
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.50864329086924
lambda[   6] =  -0.44767250331861
lambda[   7] =  -0.42480186049120
lambda[   8] =  -0.40882961377383
lambda[   9] =  -0.38786458806565
lambda[  10] =  -0.36565058325409
lambda[  11] =  -0.35213424152166
lambda[  12] =  -0.33218397035365
lambda[  13] =  -0.23332542824295
lambda[  14] =  -0.20784501013871
lambda[  15] =  -0.08216340424492
lambda[  16] =  -0.07108548607261
lambda[  17] =  -0.01456704568594
lambda[  18] =   0.01214026456502
lambda[  19] =   0.02176566509697
lambda[  20] =   0.03398851747061
lambda[  21] =   0.03782934516109
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.238 ms
rank =  0, subspace rotation using ScaLAPACK took 7.699 ms
rank =  0, Distributing orbital back into band + domain format took 18.601 ms
rank = 0, Subspace_Rotation used 26.318 ms

Total time for subspace rotation: 26.323 ms
rank = 0, Efermi =  -0.110746398262 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.238 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.735 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1593.524 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.841 ms
rank = 0, D2D took 1.944 ms
rank = 0, Transfering density took 1.950 ms
Etot    =   -53.491671273336
Eband   =   -13.774235078651
E1      =    30.159158169738
E2      =   -13.109471244534
E3      =   -18.053576721780
Exc     =   -16.142748934309
Esc     =   -84.896893395308
Entropy =    -0.000000001121
dE = 1.051e-06, dEband = 2.683e-04
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -53.491671273, dEtot = 1.051e-06, dEband = 2.683e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0196734960236, which took 0.062 ms

iter_count = 114, r_2norm = 5.410e-07, tol*||rhs|| = 7.869e-07

Anderson update took 61.210 ms, out of which F'*F took 28.764 ms; b-Ax took 195.129 ms, out of which Lap took 175.280 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.700 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003803182, int_rho =  28.00000003803198, int_b + int_rho = 1.637e-13, checking this took 0.117 ms
2-norm of RHS = 728.9187406569481, which took 0.106 ms

iter_count = 108, r_2norm = 7.104e-04, tol*||rhs|| = 7.289e-04

Anderson update took 58.297 ms, out of which F'*F took 27.604 ms; b-Ax took 183.073 ms, out of which Lap took 164.399 ms
Solving Poisson took 390.795 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.159806 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 103.511 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.176391 
Total time for convolution: 	 convolve: 5.158131 
Total time for convolution: 	 convolve: 5.179912 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.553 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.680 ms

This SCF took 27202.482 ms, scf error = 8.833e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.50864329086924, occ[   5] =   2.00000000000000
lambda[   6] =  -0.44767250331861, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42480186049120, occ[   7] =   2.00000000000000
lambda[   8] =  -0.40882961377383, occ[   8] =   2.00000000000000
lambda[   9] =  -0.38786458806565, occ[   9] =   2.00000000000000
lambda[  10] =  -0.36565058325409, occ[  10] =   2.00000000000000
lambda[  11] =  -0.35213424152166, occ[  11] =   2.00000000000000
lambda[  12] =  -0.33218397035365, occ[  12] =   2.00000000000000
lambda[  13] =  -0.23332542824295, occ[  13] =   2.00000000000000
lambda[  14] =  -0.20784501013871, occ[  14] =   2.00000000000000
lambda[  15] =  -0.08216340424492, occ[  15] =   0.00000003803181
lambda[  16] =  -0.07108548607261, occ[  16] =   0.00000000000002
lambda[  17] =  -0.01456704568594, occ[  17] =   0.00000000000000
lambda[  18] =   0.01214026456502, occ[  18] =   0.00000000000000
lambda[  19] =   0.02176566509697, occ[  19] =   0.00000000000000
lambda[  20] =   0.03398851747061, occ[  20] =   0.00000000000000
lambda[  21] =   0.03782934516109, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.755 ms, time for Allreduce/Reduce: 10.538 ms 
Time for calculating local force components: 23.124 ms
Start Calculating nonlocal forces
force_nloc = 
  1.15162569965470  -0.15951908473790   0.33866626598227
 -0.53246479456045   1.04787085100568  -0.26877110572193
 -0.00424050792261  -0.00948822055426  -0.04723734571158
  0.01778151530455  -0.04193510269174   0.02211512144760
 -0.01783195335176   0.04527721332414  -0.01050711681512
 -0.02355381641587  -0.03181035531021   0.02846482347782
  0.01548265009281  -0.02164000393688   0.02448079703848
 -0.10560743820087   0.06477711088214  -0.03495803283598
  0.02019277275284  -0.11207190709129   0.04447607743227
force_loc = 
 -1.13573838328333   0.15748544623511  -0.33440518055523
  0.52567407942421  -1.03294562499703   0.26497497078984
  0.00425100917595   0.00915313653884   0.04842990003706
 -0.01802207736458   0.04361101533377  -0.02261369506721
  0.01783494238694  -0.04830923534288   0.01068072792586
  0.02490314760043   0.03334032629560  -0.03083582322256
 -0.01490528282836   0.02103093823964  -0.02487376193484
  0.12129715758788  -0.06324999241196   0.04046350994117
 -0.02941005735237   0.12508525747285  -0.04530236934603
Time for calculating nonlocal force components: 39.160 ms
[32mforces_xc: 
[0m[32m -0.02671181116282   0.00345859281727  -0.00777274112534
[0m[32m  0.01269433798431  -0.02431688319750   0.00623813821420
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00063883493654   0.00131719330366  -0.00039567490081
[0m[32m -0.00703057759286  -0.00163065342517  -0.00184200019145
[0m[32m  0.00436945571145  -0.00560567007088   0.00057414136590
[0mTime for calculating XC forces components: 34.515 ms
 Cartesian force = 
 -0.01081907620298   0.00143780457215  -0.00351716972323
  0.00590904143656  -0.00937880693118   0.00243648925717
  0.00001591984183  -0.00032223375775   0.00118704030055
 -0.00023514347155   0.00168876289969  -0.00050408764453
  0.00000840762367  -0.00301917176108   0.00016809708581
  0.00135474977304   0.00154282124306  -0.00237651376968
 -0.00005604908361   0.00072097786409  -0.00079415382210
  0.00866456038264  -0.00009068469733   0.00365796288881
 -0.00484241029959   0.00742053056835  -0.00025766457280
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.314 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Time for printing density: 395.066 ms
The program took 447.938 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:10
Job ID:        2266437
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:32:12,vmem=8348K,walltime=00:07:41,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-3-2
---------------------------------------
