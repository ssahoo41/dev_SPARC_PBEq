---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:20
Job ID:    2266628
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:24
Job ID:    2266628
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.063 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 16.740 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 13.705 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 64.769 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.952 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.099 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   12.840845	
   10.000000	   11.774623	    7.159155	
   10.000000	    8.225377	    7.159155	
   10.000000	   10.000000	    8.169484	
   10.000000	   10.000000	   10.642580	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.175 ms
Set up communicators.

--set up spincomm took 2.243 ms

--set up kptcomm took 0.336 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.021 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.084 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.010 ms

Calculate_SplineDerivRadFun took 0.205 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.312 ms.
time spent on vectorized spline interp: 2.991 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.043 ms.
time spent on vectorized spline interp: 1.651 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.322 ms.
time spent on vectorized spline interp: 1.941 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.514 ms.

Calculating rb for all atom types took 16.559 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.042 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000070570, sum_int_rho = 15.7910602218364
PosCharge = 16.000000007057, NegCharge = -15.791060221836, scal_fac = 1.013231523551
After scaling, int_rho = 16.0000000070572, PosCharge + NegCharge - NetCharge = -2.593e-13
--Calculate Vref took 0.348 ms
--Calculate rho_guess took 2.027 ms

 integral of b = -16.0000000070570,
 int{b} + Nelectron + NetCharge = -7.057e-09,
 Esc = -47.6241201451491,
 MPI_Reduce took 3.091 ms

Calculating b & b_ref took 10.909 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.018 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.026 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.008 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.052 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.879 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705694, int_b + int_rho = -4.566e-13, checking this took 0.087 ms
2-norm of RHS = 544.5692745581061, which took 0.470 ms

iter_count = 420, r_2norm = 5.233e-04, tol*||rhs|| = 5.446e-04

Anderson update took 267.874 ms, out of which F'*F took 132.183 ms; b-Ax took 895.693 ms, out of which Lap took 796.117 ms
Solving Poisson took 2028.986 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.462 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.096640 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.743 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.102229 
Total time for convolution: 	 convolve: 5.115626 
Total time for convolution: 	 convolve: 5.096914 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
rank = 0, XC calculation took 24335.954 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 1.139 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.757 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.017 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.978 ms
    Lanczos iter 54, eigmin  = -1.073097900, eigmax = 264.926035821, err_eigmin = 2.564e-03, err_eigmax = 9.814e-03
rank =   0, Lanczos took 142.367 ms, eigmin = -1.073097899553, eigmax = 267.575296178769

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.201099, lowerbound = -1.173098, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1459.208 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.400 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.634 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.223 ms
rank =  0, Distribute data + matrix mult took 23.274 ms
rank =  0, finding HY took 21.267 ms
rank =  0, distributing HY into block cyclic form took 16.325 ms
rank =  0, finding Y'*HY took 2.331 ms
Rank 0, Project_Hamiltonian used 63.233 ms
Total time for projection: 63.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.332 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.573 ms
rank = 0, Solve_Generalized_EigenProblem used 1.263 ms
    first calculated eigval = 2.792848559303986
    last  calculated eigval = 3.190068370121626
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79284855930399
lambda[   2] =   2.82883656361944
lambda[   3] =   2.84691768975117
lambda[   4] =   2.90213770950420
lambda[   5] =   2.94896037470048
lambda[   6] =   2.97512388827350
lambda[   7] =   3.02087551977443
lambda[   8] =   3.05185055479752
lambda[   9] =   3.06767500373527
lambda[  10] =   3.08999046112319
lambda[  11] =   3.11400479985553
lambda[  12] =   3.13127390779714
lambda[  13] =   3.16095317492911
lambda[  14] =   3.19006837012163
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.283 ms
rank =  0, subspace rotation using ScaLAPACK took 3.918 ms
rank =  0, Distributing orbital back into band + domain format took 14.860 ms
rank = 0, Subspace_Rotation used 18.792 ms

Total time for subspace rotation: 18.796 ms
rank = 0, Efermi =   3.059762779277 calculate fermi energy took 0.049 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.290068, lowerbound = -1.173098, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1395.653 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.449 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.548 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 17.039 ms
rank =  0, finding HY took 20.468 ms
rank =  0, distributing HY into block cyclic form took 15.519 ms
rank =  0, finding Y'*HY took 2.346 ms
Rank 0, Project_Hamiltonian used 55.407 ms
Total time for projection: 55.432 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.946037561211180
    last  calculated eigval = 0.421598836649867
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.94603756121118
lambda[   2] =  -0.65607258409195
lambda[   3] =  -0.19799199105262
lambda[   4] =  -0.17692751356727
lambda[   5] =  -0.07470088958425
lambda[   6] =   0.12116640201521
lambda[   7] =   0.18118250652197
lambda[   8] =   0.24277105510772
lambda[   9] =   0.30861097670251
lambda[  10] =   0.31807252118013
lambda[  11] =   0.33289227106335
lambda[  12] =   0.37937802609059
lambda[  13] =   0.40045647798512
lambda[  14] =   0.42159883664987
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.971 ms
rank =  0, Distributing orbital back into band + domain format took 14.916 ms
rank = 0, Subspace_Rotation used 18.905 ms

Total time for subspace rotation: 18.909 ms
rank = 0, Efermi =   0.278522584055 calculate fermi energy took 0.040 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.521599, lowerbound = -1.173098, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1402.163 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.774 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.527 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 17.338 ms
rank =  0, finding HY took 20.453 ms
rank =  0, distributing HY into block cyclic form took 15.582 ms
rank =  0, finding Y'*HY took 2.523 ms
Rank 0, Project_Hamiltonian used 56.401 ms
Total time for projection: 56.407 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.093444192534440
    last  calculated eigval = 0.120189967933177
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09344419253444
lambda[   2] =  -0.84307889178206
lambda[   3] =  -0.59435385766860
lambda[   4] =  -0.54518295870215
lambda[   5] =  -0.50795366806882
lambda[   6] =  -0.45495462409682
lambda[   7] =  -0.41958365771861
lambda[   8] =  -0.28223396777634
lambda[   9] =  -0.07017622909292
lambda[  10] =   0.03070207980503
lambda[  11] =   0.07034750302634
lambda[  12] =   0.09708685885735
lambda[  13] =   0.10803354240622
lambda[  14] =   0.12018996793318
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.949 ms
rank =  0, Distributing orbital back into band + domain format took 14.871 ms
rank = 0, Subspace_Rotation used 18.834 ms

Total time for subspace rotation: 18.837 ms
rank = 0, Efermi =  -0.100265363008 calculate fermi energy took 0.026 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.220190, lowerbound = -1.173098, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1402.232 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.870 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.543 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 17.459 ms
rank =  0, finding HY took 20.529 ms
rank =  0, distributing HY into block cyclic form took 15.601 ms
rank =  0, finding Y'*HY took 2.332 ms
Rank 0, Project_Hamiltonian used 55.950 ms
Total time for projection: 55.957 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.091 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.093616898422440
    last  calculated eigval = 0.071871411890366
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.09361689842244
lambda[   2] =  -0.84332861145219
lambda[   3] =  -0.60163277558853
lambda[   4] =  -0.54940676474228
lambda[   5] =  -0.52227588723414
lambda[   6] =  -0.46075161817248
lambda[   7] =  -0.43090316213762
lambda[   8] =  -0.31838794322965
lambda[   9] =  -0.12594067996580
lambda[  10] =  -0.03589900978386
lambda[  11] =   0.02883442508962
lambda[  12] =   0.03401878357699
lambda[  13] =   0.05801726638461
lambda[  14] =   0.07187141189037
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.966 ms
rank =  0, Distributing orbital back into band + domain format took 14.797 ms
rank = 0, Subspace_Rotation used 18.777 ms

Total time for subspace rotation: 18.780 ms
rank = 0, Efermi =  -0.156029813762 calculate fermi energy took 0.027 ms
rank = 0, --- Calculate rho: sum over local bands took 2.697 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.881 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.115 ms
rank = 0, Calculating density took 6115.931 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.549 ms
rank = 0, D2D took 1.648 ms
rank = 0, Transfering density took 1.656 ms
Etot    =   -29.835269014842
Eband   =    -9.640607322847
E1      =    18.582124720946
E2      =    -7.904121714890
E3      =    -9.716346617587
Exc     =    -8.773134600049
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 5.967e+00, dEband = 1.928e+00
rank = 0, Calculating/Estimating energy took 1.025 ms, Etot = -29.835269015, dEtot = 5.967e+00, dEband = 1.928e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.7520544920848, which took 0.055 ms

iter_count = 96, r_2norm = 1.405e-03, tol*||rhs|| = 1.710e-03

Anderson update took 56.296 ms, out of which F'*F took 26.393 ms; b-Ax took 182.595 ms, out of which Lap took 160.170 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.366 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705723, int_b + int_rho = -1.601e-13, checking this took 0.213 ms
2-norm of RHS = 541.5260539524389, which took 0.161 ms

iter_count = 288, r_2norm = 5.152e-04, tol*||rhs|| = 5.415e-04

Anderson update took 178.654 ms, out of which F'*F took 83.600 ms; b-Ax took 563.711 ms, out of which Lap took 498.173 ms
Solving Poisson took 1296.768 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.265 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.083611 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.101652 
Total time for convolution: 	 convolve: 5.089323 
Total time for convolution: 	 convolve: 5.080205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.349 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.540 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.705 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.006 ms

This SCF took 32201.851 ms, scf error = 1.642e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.171871, lowerbound = -1.093617, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1389.415 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 15.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.596 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 17.227 ms
rank =  0, finding HY took 21.001 ms
rank =  0, distributing HY into block cyclic form took 15.226 ms
rank =  0, finding Y'*HY took 3.199 ms
Rank 0, Project_Hamiltonian used 56.688 ms
Total time for projection: 56.703 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -1.081114977100482
    last  calculated eigval = 0.038384480713431
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.08111497710048
lambda[   2] =  -0.79888171174864
lambda[   3] =  -0.56027479168521
lambda[   4] =  -0.51098344572665
lambda[   5] =  -0.50235340883968
lambda[   6] =  -0.44825987804654
lambda[   7] =  -0.41743253252692
lambda[   8] =  -0.28101178001401
lambda[   9] =  -0.12079590308861
lambda[  10] =  -0.03377128509139
lambda[  11] =   0.00858087319470
lambda[  12] =   0.02032989875035
lambda[  13] =   0.03443377653655
lambda[  14] =   0.03838448071343
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.895 ms
rank =  0, Distributing orbital back into band + domain format took 14.842 ms
rank = 0, Subspace_Rotation used 18.751 ms

Total time for subspace rotation: 18.755 ms
rank = 0, Efermi =  -0.150885036978 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.518 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.784 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.845 ms
rank = 0, Calculating density took 1469.685 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
rank = 0, D2D took 0.530 ms
rank = 0, Transfering density took 0.532 ms
Etot    =   -29.775450970520
Eband   =    -9.200625052229
E1      =    18.210527411843
E2      =    -7.874024696331
E3      =    -9.828745597198
Exc     =    -8.864003478295
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.196e-02, dEband = 8.800e-02
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -29.775450971, dEtot = 1.196e-02, dEband = 8.800e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.5328473429677, which took 0.149 ms

iter_count = 102, r_2norm = 5.059e-04, tol*||rhs|| = 7.413e-04

Anderson update took 62.932 ms, out of which F'*F took 28.092 ms; b-Ax took 190.180 ms, out of which Lap took 169.341 ms
rank = 0, Mixing (+ precond) took 435.315 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705720, int_b + int_rho = -1.946e-13, checking this took 0.189 ms
2-norm of RHS = 538.3653532618441, which took 0.237 ms

iter_count = 300, r_2norm = 4.392e-04, tol*||rhs|| = 5.384e-04

Anderson update took 185.005 ms, out of which F'*F took 85.688 ms; b-Ax took 574.346 ms, out of which Lap took 511.320 ms
Solving Poisson took 1285.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.081302 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.088159 
Total time for convolution: 	 convolve: 5.084569 
Total time for convolution: 	 convolve: 5.079745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.303 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.086 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.382 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.021 ms

This SCF took 27606.828 ms, scf error = 1.031e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.138384, lowerbound = -1.081115, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1398.027 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.930 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.667 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 20.622 ms
rank =  0, finding HY took 22.491 ms
rank =  0, distributing HY into block cyclic form took 15.564 ms
rank =  0, finding Y'*HY took 2.287 ms
Rank 0, Project_Hamiltonian used 60.999 ms
Total time for projection: 61.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.058186254753070
    last  calculated eigval = 0.030746261123133
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05818625475307
lambda[   2] =  -0.74049339428400
lambda[   3] =  -0.51338414488987
lambda[   4] =  -0.46798473732059
lambda[   5] =  -0.46673481315484
lambda[   6] =  -0.42746430911699
lambda[   7] =  -0.39097507098587
lambda[   8] =  -0.23710021227178
lambda[   9] =  -0.10115354540496
lambda[  10] =  -0.02542747989765
lambda[  11] =  -0.00046955166711
lambda[  12] =   0.01581083261386
lambda[  13] =   0.02073950788198
lambda[  14] =   0.03074626112313
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.000 ms
rank =  0, Distributing orbital back into band + domain format took 14.868 ms
rank = 0, Subspace_Rotation used 19.511 ms

Total time for subspace rotation: 19.517 ms
rank = 0, Efermi =  -0.131242679552 calculate fermi energy took 0.586 ms
rank = 0, --- Calculate rho: sum over local bands took 2.523 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.841 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 1482.832 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.581 ms
rank = 0, D2D took 0.884 ms
rank = 0, Transfering density took 0.896 ms
Etot    =   -29.743176083597
Eband   =    -8.604645874268
E1      =    17.712384144677
E2      =    -7.774284606666
E3      =   -10.000413654806
Exc     =    -9.001492470111
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 6.455e-03, dEband = 1.192e-01
rank = 0, Calculating/Estimating energy took 1.241 ms, Etot = -29.743176084, dEtot = 6.455e-03, dEband = 1.192e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.5680158771783, which took 0.062 ms

iter_count = 102, r_2norm = 1.662e-04, tol*||rhs|| = 1.827e-04

Anderson update took 62.349 ms, out of which F'*F took 27.511 ms; b-Ax took 187.789 ms, out of which Lap took 167.750 ms
rank = 0, Mixing (+ precond) took 445.079 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705728, int_b + int_rho = -1.164e-13, checking this took 0.168 ms
2-norm of RHS = 538.0887515269258, which took 0.129 ms

iter_count = 282, r_2norm = 4.890e-04, tol*||rhs|| = 5.381e-04

Anderson update took 174.727 ms, out of which F'*F took 79.280 ms; b-Ax took 544.590 ms, out of which Lap took 485.663 ms
Solving Poisson took 1210.526 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.071203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.861 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.078668 
Total time for convolution: 	 convolve: 5.082839 
Total time for convolution: 	 convolve: 5.073753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 497.694 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.684 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.016 ms

This SCF took 28574.225 ms, scf error = 4.372e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.130746, lowerbound = -1.058186, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1426.608 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.416 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.539 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 17.000 ms
rank =  0, finding HY took 21.223 ms
rank =  0, distributing HY into block cyclic form took 15.317 ms
rank =  0, finding Y'*HY took 2.437 ms
Rank 0, Project_Hamiltonian used 56.008 ms
Total time for projection: 56.025 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -1.036343995302956
    last  calculated eigval = 0.028762833240035
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03634399530296
lambda[   2] =  -0.71785412395530
lambda[   3] =  -0.49434864110470
lambda[   4] =  -0.45027795233641
lambda[   5] =  -0.44578790137996
lambda[   6] =  -0.40860749642076
lambda[   7] =  -0.37473530679361
lambda[   8] =  -0.22288461220519
lambda[   9] =  -0.08267866763382
lambda[  10] =  -0.03214868430992
lambda[  11] =   0.00653311666314
lambda[  12] =   0.01385538980002
lambda[  13] =   0.01738290568156
lambda[  14] =   0.02876283324003
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.796 ms
rank =  0, Distributing orbital back into band + domain format took 13.363 ms
rank = 0, Subspace_Rotation used 18.180 ms

Total time for subspace rotation: 18.192 ms
rank = 0, Efermi =  -0.112767801542 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.947 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.106 ms
rank = 0, Calculating density took 1505.992 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.704 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.978 ms
Etot    =   -29.738116142640
Eband   =    -8.301680059581
E1      =    17.496409112392
E2      =    -7.671664587194
E3      =   -10.090248167816
Exc     =    -9.070637805094
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.012e-03, dEband = 6.059e-02
rank = 0, Calculating/Estimating energy took 1.202 ms, Etot = -29.738116143, dEtot = 1.012e-03, dEband = 6.059e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.2621824698796, which took 0.120 ms

iter_count = 108, r_2norm = 6.290e-05, tol*||rhs|| = 9.049e-05

Anderson update took 66.721 ms, out of which F'*F took 30.347 ms; b-Ax took 205.544 ms, out of which Lap took 182.739 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.153 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705725, int_b + int_rho = -1.455e-13, checking this took 0.168 ms
2-norm of RHS = 538.3319618432338, which took 0.161 ms

iter_count = 240, r_2norm = 4.446e-04, tol*||rhs|| = 5.383e-04

Anderson update took 147.709 ms, out of which F'*F took 69.059 ms; b-Ax took 478.393 ms, out of which Lap took 420.142 ms
Solving Poisson took 1066.691 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.073574 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.073496 
Total time for convolution: 	 convolve: 5.082649 
Total time for convolution: 	 convolve: 5.070601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.530 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.016 ms

This SCF took 27356.501 ms, scf error = 1.062e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.128763, lowerbound = -1.036344, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1404.139 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.359 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.559 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.161 ms
rank =  0, Distribute data + matrix mult took 17.092 ms
rank =  0, finding HY took 21.393 ms
rank =  0, distributing HY into block cyclic form took 15.498 ms
rank =  0, finding Y'*HY took 2.282 ms
Rank 0, Project_Hamiltonian used 56.296 ms
Total time for projection: 56.311 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.042 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.034374553595742
    last  calculated eigval = 0.027674054589623
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03437455359574
lambda[   2] =  -0.71436252656405
lambda[   3] =  -0.49116091617051
lambda[   4] =  -0.44738495365376
lambda[   5] =  -0.44271895546107
lambda[   6] =  -0.40665077932787
lambda[   7] =  -0.37199107259892
lambda[   8] =  -0.22000744396130
lambda[   9] =  -0.08072774092878
lambda[  10] =  -0.03448131431970
lambda[  11] =   0.00634924254536
lambda[  12] =   0.01341991782029
lambda[  13] =   0.01643999903333
lambda[  14] =   0.02767405458962
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.830 ms
rank =  0, Distributing orbital back into band + domain format took 13.820 ms
rank = 0, Subspace_Rotation used 18.670 ms

Total time for subspace rotation: 18.679 ms
rank = 0, Efermi =  -0.110816875095 calculate fermi energy took 0.141 ms
rank = 0, --- Calculate rho: sum over local bands took 2.541 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1483.389 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.513 ms
rank = 0, D2D took 1.042 ms
rank = 0, Transfering density took 1.045 ms
Etot    =   -29.737747510243
Eband   =    -8.257302403236
E1      =    17.472754325142
E2      =    -7.647943829218
E3      =   -10.102478825539
Exc     =    -9.079501941540
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 7.373e-05, dEband = 8.876e-03
rank = 0, Calculating/Estimating energy took 1.188 ms, Etot = -29.737747510, dEtot = 7.373e-05, dEband = 8.876e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6340699345864, which took 0.055 ms

iter_count = 114, r_2norm = 1.675e-05, tol*||rhs|| = 2.536e-05

Anderson update took 68.255 ms, out of which F'*F took 32.008 ms; b-Ax took 217.506 ms, out of which Lap took 193.260 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 493.871 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705725, int_b + int_rho = -1.455e-13, checking this took 0.178 ms
2-norm of RHS = 539.1554806597527, which took 0.158 ms

iter_count = 258, r_2norm = 4.612e-04, tol*||rhs|| = 5.392e-04

Anderson update took 159.083 ms, out of which F'*F took 72.915 ms; b-Ax took 502.733 ms, out of which Lap took 442.816 ms
Solving Poisson took 1102.403 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.484 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.073710 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.220 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.074141 
Total time for convolution: 	 convolve: 5.075882 
Total time for convolution: 	 convolve: 5.075424 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.626 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 27393.013 ms, scf error = 7.660e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.127674, lowerbound = -1.034375, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1408.902 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.320 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.560 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 16.927 ms
rank =  0, finding HY took 21.461 ms
rank =  0, distributing HY into block cyclic form took 15.640 ms
rank =  0, finding Y'*HY took 2.225 ms
Rank 0, Project_Hamiltonian used 56.286 ms
Total time for projection: 56.302 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.515 ms
    first calculated eigval = -1.032144093631608
    last  calculated eigval = 0.027867908159041
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.03214409363161
lambda[   2] =  -0.71063414122118
lambda[   3] =  -0.48700395645997
lambda[   4] =  -0.44366897650637
lambda[   5] =  -0.43897871543606
lambda[   6] =  -0.40400605485521
lambda[   7] =  -0.36812075583202
lambda[   8] =  -0.21619180030722
lambda[   9] =  -0.07804605766776
lambda[  10] =  -0.03406412810398
lambda[  11] =   0.00859911758266
lambda[  12] =   0.01441059845437
lambda[  13] =   0.01621400458788
lambda[  14] =   0.02786790815904
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.530 ms
rank =  0, subspace rotation using ScaLAPACK took 4.736 ms
rank =  0, Distributing orbital back into band + domain format took 14.279 ms
rank = 0, Subspace_Rotation used 19.036 ms

Total time for subspace rotation: 19.041 ms
rank = 0, Efermi =  -0.108135191768 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.823 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1488.360 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.647 ms
rank = 0, D2D took 1.005 ms
rank = 0, Transfering density took 1.009 ms
Etot    =   -29.737367505968
Eband   =    -8.201496989050
E1      =    17.459843714419
E2      =    -7.601027597533
E3      =   -10.113720826882
Exc     =    -9.086342510385
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 7.600e-05, dEband = 1.116e-02
rank = 0, Calculating/Estimating energy took 1.194 ms, Etot = -29.737367506, dEtot = 7.600e-05, dEband = 1.116e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3332436986094, which took 0.091 ms

iter_count = 108, r_2norm = 1.172e-05, tol*||rhs|| = 1.333e-05

Anderson update took 65.032 ms, out of which F'*F took 30.692 ms; b-Ax took 209.049 ms, out of which Lap took 185.250 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.760 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705722, int_b + int_rho = -1.728e-13, checking this took 0.159 ms
2-norm of RHS = 539.3015275877426, which took 0.106 ms

iter_count = 246, r_2norm = 4.542e-04, tol*||rhs|| = 5.393e-04

Anderson update took 148.530 ms, out of which F'*F took 67.584 ms; b-Ax took 467.125 ms, out of which Lap took 412.886 ms
Solving Poisson took 1047.101 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.073310 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.257 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.077692 
Total time for convolution: 	 convolve: 5.076785 
Total time for convolution: 	 convolve: 5.071783 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.633 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 27313.453 ms, scf error = 2.696e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127868, lowerbound = -1.032144, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1369.391 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.336 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 16.937 ms
rank =  0, finding HY took 21.509 ms
rank =  0, distributing HY into block cyclic form took 15.570 ms
rank =  0, finding Y'*HY took 2.270 ms
Rank 0, Project_Hamiltonian used 57.008 ms
Total time for projection: 57.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.544 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.623 ms
    first calculated eigval = -1.028789022869107
    last  calculated eigval = 0.029023241383569
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02878902286911
lambda[   2] =  -0.70607629700609
lambda[   3] =  -0.48327861477800
lambda[   4] =  -0.44014620871050
lambda[   5] =  -0.43516390603906
lambda[   6] =  -0.40062786884211
lambda[   7] =  -0.36483155948998
lambda[   8] =  -0.21229644030150
lambda[   9] =  -0.07468308491379
lambda[  10] =  -0.03223114793234
lambda[  11] =   0.01170145422773
lambda[  12] =   0.01653854815566
lambda[  13] =   0.01724503699993
lambda[  14] =   0.02902324138357
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.635 ms
rank =  0, subspace rotation using ScaLAPACK took 4.072 ms
rank =  0, Distributing orbital back into band + domain format took 14.880 ms
rank = 0, Subspace_Rotation used 18.967 ms

Total time for subspace rotation: 18.971 ms
rank = 0, Efermi =  -0.104772219009 calculate fermi energy took 0.087 ms
rank = 0, --- Calculate rho: sum over local bands took 2.563 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.866 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1449.678 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.699 ms
rank = 0, D2D took 1.008 ms
rank = 0, Transfering density took 1.020 ms
Etot    =   -29.737281722587
Eband   =    -8.142419836600
E1      =    17.428736101699
E2      =    -7.570311667976
E3      =   -10.123999412032
Exc     =    -9.093788922327
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.716e-05, dEband = 1.182e-02
rank = 0, Calculating/Estimating energy took 1.194 ms, Etot = -29.737281723, dEtot = 1.716e-05, dEband = 1.182e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1892570929842, which took 0.058 ms

iter_count = 114, r_2norm = 4.854e-06, tol*||rhs|| = 7.570e-06

Anderson update took 68.091 ms, out of which F'*F took 31.824 ms; b-Ax took 217.953 ms, out of which Lap took 194.025 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.070 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705725, int_b + int_rho = -1.437e-13, checking this took 0.131 ms
2-norm of RHS = 539.3196646534547, which took 0.121 ms

iter_count = 210, r_2norm = 4.565e-04, tol*||rhs|| = 5.393e-04

Anderson update took 124.489 ms, out of which F'*F took 58.007 ms; b-Ax took 400.910 ms, out of which Lap took 353.094 ms
Solving Poisson took 886.696 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.070525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.423 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.077026 
Total time for convolution: 	 convolve: 5.087706 
Total time for convolution: 	 convolve: 5.081774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 27137.948 ms, scf error = 1.434e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129023, lowerbound = -1.028789, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1401.852 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.502 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.888 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 18.281 ms
rank =  0, finding HY took 21.830 ms
rank =  0, distributing HY into block cyclic form took 15.600 ms
rank =  0, finding Y'*HY took 2.263 ms
Rank 0, Project_Hamiltonian used 58.017 ms
Total time for projection: 58.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.028066207885313
    last  calculated eigval = 0.029005607996997
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02806620788531
lambda[   2] =  -0.70573927152680
lambda[   3] =  -0.48273254048853
lambda[   4] =  -0.43966416908594
lambda[   5] =  -0.43463703772264
lambda[   6] =  -0.39993492577729
lambda[   7] =  -0.36426684131856
lambda[   8] =  -0.21177959620168
lambda[   9] =  -0.07406628149990
lambda[  10] =  -0.03124792288068
lambda[  11] =   0.01239621764953
lambda[  12] =   0.01737607030108
lambda[  13] =   0.01816152510290
lambda[  14] =   0.02900560799700
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.243 ms
rank =  0, Distributing orbital back into band + domain format took 14.646 ms
rank = 0, Subspace_Rotation used 18.907 ms

Total time for subspace rotation: 18.912 ms
rank = 0, Efermi =  -0.104155415484 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.595 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.781 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1482.578 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.761 ms
rank = 0, D2D took 1.034 ms
rank = 0, Transfering density took 1.045 ms
Etot    =   -29.737305487989
Eband   =    -8.133641180536
E1      =    17.425750649413
E2      =    -7.564374592171
E3      =   -10.124161068068
Exc     =    -9.093830471738
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 4.753e-06, dEband = 1.756e-03
rank = 0, Calculating/Estimating energy took 1.182 ms, Etot = -29.737305488, dEtot = 4.753e-06, dEband = 1.756e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1539521832657, which took 0.129 ms

iter_count = 108, r_2norm = 5.953e-06, tol*||rhs|| = 6.158e-06

Anderson update took 64.059 ms, out of which F'*F took 30.183 ms; b-Ax took 206.219 ms, out of which Lap took 183.921 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.823 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705725, int_b + int_rho = -1.437e-13, checking this took 0.178 ms
2-norm of RHS = 539.2886944670106, which took 0.125 ms

iter_count = 210, r_2norm = 4.451e-04, tol*||rhs|| = 5.393e-04

Anderson update took 123.868 ms, out of which F'*F took 58.788 ms; b-Ax took 455.663 ms, out of which Lap took 408.921 ms
Solving Poisson took 964.249 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.256 ms
Total time for convolution: 	 convolve: 5.070117 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.074007 
Total time for convolution: 	 convolve: 5.083795 
Total time for convolution: 	 convolve: 5.076990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 0.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 27210.634 ms, scf error = 9.555e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129006, lowerbound = -1.028066, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1400.813 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.373 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.545 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 16.965 ms
rank =  0, finding HY took 21.518 ms
rank =  0, distributing HY into block cyclic form took 15.554 ms
rank =  0, finding Y'*HY took 2.275 ms
Rank 0, Project_Hamiltonian used 56.342 ms
Total time for projection: 56.355 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.152 ms
    first calculated eigval = -1.026928037591903
    last  calculated eigval = 0.029884215130383
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02692803759190
lambda[   2] =  -0.70463006376937
lambda[   3] =  -0.48166387019229
lambda[   4] =  -0.43864350433519
lambda[   5] =  -0.43355037592748
lambda[   6] =  -0.39884636661079
lambda[   7] =  -0.36325968181044
lambda[   8] =  -0.21074316375715
lambda[   9] =  -0.07297970098075
lambda[  10] =  -0.02937061215710
lambda[  11] =   0.01373960302246
lambda[  12] =   0.01904429078087
lambda[  13] =   0.02025483631533
lambda[  14] =   0.02988421513038
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.131 ms
rank =  0, Distributing orbital back into band + domain format took 14.802 ms
rank = 0, Subspace_Rotation used 18.945 ms

Total time for subspace rotation: 18.949 ms
rank = 0, Efermi =  -0.103068835339 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.555 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.847 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1480.221 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.684 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.969 ms
Etot    =   -29.737334675885
Eband   =    -8.116530128504
E1      =    17.416251751638
E2      =    -7.556288512013
E3      =   -10.126272643380
Exc     =    -9.095497309045
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 5.838e-06, dEband = 3.422e-03
rank = 0, Calculating/Estimating energy took 1.226 ms, Etot = -29.737334676, dEtot = 5.838e-06, dEband = 3.422e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0798834665963, which took 0.050 ms

iter_count = 108, r_2norm = 2.990e-06, tol*||rhs|| = 3.195e-06

Anderson update took 64.018 ms, out of which F'*F took 30.280 ms; b-Ax took 206.409 ms, out of which Lap took 183.970 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.881 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705720, int_b + int_rho = -1.965e-13, checking this took 0.149 ms
2-norm of RHS = 539.2893784728952, which took 0.128 ms

iter_count = 210, r_2norm = 4.423e-04, tol*||rhs|| = 5.393e-04

Anderson update took 124.075 ms, out of which F'*F took 58.301 ms; b-Ax took 401.076 ms, out of which Lap took 353.837 ms
Solving Poisson took 884.754 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.132579 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.074161 
Total time for convolution: 	 convolve: 5.082254 
Total time for convolution: 	 convolve: 5.070372 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.449 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.487 ms

This SCF took 27175.677 ms, scf error = 6.440e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129884, lowerbound = -1.026928, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1370.325 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.414 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.547 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.998 ms
rank =  0, finding HY took 21.431 ms
rank =  0, distributing HY into block cyclic form took 15.680 ms
rank =  0, finding Y'*HY took 2.202 ms
Rank 0, Project_Hamiltonian used 56.343 ms
Total time for projection: 56.360 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -1.026258003478648
    last  calculated eigval = 0.032008060799618
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02625800347865
lambda[   2] =  -0.70382324277297
lambda[   3] =  -0.48083162501296
lambda[   4] =  -0.43782031021701
lambda[   5] =  -0.43276545159520
lambda[   6] =  -0.39812581840559
lambda[   7] =  -0.36244318414152
lambda[   8] =  -0.20990476091009
lambda[   9] =  -0.07216407314062
lambda[  10] =  -0.02602218316203
lambda[  11] =   0.01497155442772
lambda[  12] =   0.02215003144827
lambda[  13] =   0.02450016856120
lambda[  14] =   0.03200806079962
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.201 ms
rank =  0, Distributing orbital back into band + domain format took 14.707 ms
rank = 0, Subspace_Rotation used 18.926 ms

Total time for subspace rotation: 18.929 ms
rank = 0, Efermi =  -0.102253207493 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.672 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.742 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1449.427 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.795 ms
rank = 0, D2D took 1.088 ms
rank = 0, Transfering density took 1.092 ms
Etot    =   -29.737365827851
Eband   =    -8.103944793577
E1      =    17.410645879486
E2      =    -7.549132771310
E3      =   -10.127096587365
Exc     =    -9.096176127067
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 6.230e-06, dEband = 2.517e-03
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -29.737365828, dEtot = 6.230e-06, dEband = 2.517e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569107329153, which took 0.065 ms

iter_count = 114, r_2norm = 1.575e-06, tol*||rhs|| = 2.276e-06

Anderson update took 67.641 ms, out of which F'*F took 31.664 ms; b-Ax took 218.013 ms, out of which Lap took 194.457 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.989 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705728, int_b + int_rho = -1.146e-13, checking this took 0.113 ms
2-norm of RHS = 539.2883098917346, which took 0.068 ms

iter_count = 180, r_2norm = 5.101e-04, tol*||rhs|| = 5.393e-04

Anderson update took 106.018 ms, out of which F'*F took 51.407 ms; b-Ax took 345.343 ms, out of which Lap took 305.163 ms
Solving Poisson took 759.179 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.070337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.374 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.070700 
Total time for convolution: 	 convolve: 5.085615 
Total time for convolution: 	 convolve: 5.082097 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.035 ms
---Transfer Veff_loc: D2D took 1.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.793 ms

This SCF took 27020.705 ms, scf error = 4.083e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132008, lowerbound = -1.026258, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1396.765 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.338 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.605 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 16.982 ms
rank =  0, finding HY took 21.656 ms
rank =  0, distributing HY into block cyclic form took 15.574 ms
rank =  0, finding Y'*HY took 2.351 ms
Rank 0, Project_Hamiltonian used 56.598 ms
Total time for projection: 56.619 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.025874219229410
    last  calculated eigval = 0.032165003892253
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02587421922941
lambda[   2] =  -0.70343052145292
lambda[   3] =  -0.48046287012292
lambda[   4] =  -0.43746983810800
lambda[   5] =  -0.43238672901826
lambda[   6] =  -0.39775275284902
lambda[   7] =  -0.36209209361601
lambda[   8] =  -0.20955637006884
lambda[   9] =  -0.07182433148773
lambda[  10] =  -0.02552889152656
lambda[  11] =   0.01456566933164
lambda[  12] =   0.02327131015076
lambda[  13] =   0.02528660371880
lambda[  14] =   0.03216500389225
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.156 ms
rank =  0, Distributing orbital back into band + domain format took 14.694 ms
rank = 0, Subspace_Rotation used 18.865 ms

Total time for subspace rotation: 18.869 ms
rank = 0, Efermi =  -0.101913465642 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.535 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.907 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1476.024 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.775 ms
rank = 0, D2D took 1.068 ms
rank = 0, Transfering density took 1.071 ms
Etot    =   -29.737430824601
Eband   =    -8.098050789438
E1      =    17.407337299380
E2      =    -7.546366756639
E3      =   -10.127771015375
Exc     =    -9.096734961190
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.300e-05, dEband = 1.179e-03
rank = 0, Calculating/Estimating energy took 1.134 ms, Etot = -29.737430825, dEtot = 1.300e-05, dEband = 1.179e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0517188706042, which took 0.082 ms

iter_count = 114, r_2norm = 1.274e-06, tol*||rhs|| = 2.069e-06

Anderson update took 70.365 ms, out of which F'*F took 31.747 ms; b-Ax took 217.840 ms, out of which Lap took 193.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.213 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705723, int_b + int_rho = -1.655e-13, checking this took 0.180 ms
2-norm of RHS = 539.2997405601001, which took 0.126 ms

iter_count = 168, r_2norm = 5.273e-04, tol*||rhs|| = 5.393e-04

Anderson update took 99.151 ms, out of which F'*F took 46.721 ms; b-Ax took 320.699 ms, out of which Lap took 282.710 ms
Solving Poisson took 708.148 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.074226 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.492 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.072082 
Total time for convolution: 	 convolve: 5.075194 
Total time for convolution: 	 convolve: 5.069855 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 26958.907 ms, scf error = 3.049e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132165, lowerbound = -1.025874, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1399.036 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.366 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 16.992 ms
rank =  0, finding HY took 21.425 ms
rank =  0, distributing HY into block cyclic form took 15.622 ms
rank =  0, finding Y'*HY took 2.252 ms
Rank 0, Project_Hamiltonian used 56.323 ms
Total time for projection: 56.344 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.025727451633988
    last  calculated eigval = 0.033473789023786
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02572745163399
lambda[   2] =  -0.70316964069658
lambda[   3] =  -0.48024160317797
lambda[   4] =  -0.43723605871345
lambda[   5] =  -0.43217817653921
lambda[   6] =  -0.39757637686670
lambda[   7] =  -0.36187611492451
lambda[   8] =  -0.20931341130422
lambda[   9] =  -0.07162174922534
lambda[  10] =  -0.02379123719145
lambda[  11] =   0.01465913297100
lambda[  12] =   0.02465288110149
lambda[  13] =   0.02750198643133
lambda[  14] =   0.03347378902379
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 4.167 ms
rank =  0, Distributing orbital back into band + domain format took 14.724 ms
rank = 0, Subspace_Rotation used 18.905 ms

Total time for subspace rotation: 18.909 ms
rank = 0, Efermi =  -0.101710883254 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.552 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.819 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.075 ms
rank = 0, Calculating density took 1478.075 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.689 ms
rank = 0, D2D took 0.993 ms
rank = 0, Transfering density took 0.996 ms
Etot    =   -29.737453824488
Eband   =    -8.094637668219
E1      =    17.405897141940
E2      =    -7.544356937129
E3      =   -10.127913666975
Exc     =    -9.096863756946
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 4.600e-06, dEband = 6.826e-04
rank = 0, Calculating/Estimating energy took 1.187 ms, Etot = -29.737453824, dEtot = 4.600e-06, dEband = 6.826e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0367118099317, which took 0.052 ms

iter_count = 114, r_2norm = 1.058e-06, tol*||rhs|| = 1.468e-06

Anderson update took 67.734 ms, out of which F'*F took 31.591 ms; b-Ax took 217.951 ms, out of which Lap took 194.002 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.121 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705722, int_b + int_rho = -1.746e-13, checking this took 0.102 ms
2-norm of RHS = 539.3035024507955, which took 0.130 ms

iter_count = 156, r_2norm = 5.235e-04, tol*||rhs|| = 5.393e-04

Anderson update took 92.068 ms, out of which F'*F took 43.734 ms; b-Ax took 298.835 ms, out of which Lap took 263.780 ms
Solving Poisson took 658.981 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.069845 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.487 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.070888 
Total time for convolution: 	 convolve: 5.078125 
Total time for convolution: 	 convolve: 5.074309 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.351 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.692 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26900.501 ms, scf error = 2.369e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133474, lowerbound = -1.025727, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1364.169 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.483 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 17.089 ms
rank =  0, finding HY took 21.450 ms
rank =  0, distributing HY into block cyclic form took 15.528 ms
rank =  0, finding Y'*HY took 2.276 ms
Rank 0, Project_Hamiltonian used 56.375 ms
Total time for projection: 56.389 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.025461136884730
    last  calculated eigval = 0.033278089573139
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02546113688473
lambda[   2] =  -0.70295874816294
lambda[   3] =  -0.48002593559709
lambda[   4] =  -0.43701704178433
lambda[   5] =  -0.43196133701393
lambda[   6] =  -0.39733311992962
lambda[   7] =  -0.36165537504948
lambda[   8] =  -0.20911007343394
lambda[   9] =  -0.07141716479612
lambda[  10] =  -0.02333931610462
lambda[  11] =   0.01446790120832
lambda[  12] =   0.02503004874883
lambda[  13] =   0.02755406459190
lambda[  14] =   0.03327808957314
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 4.148 ms
rank =  0, Distributing orbital back into band + domain format took 14.739 ms
rank = 0, Subspace_Rotation used 18.901 ms

Total time for subspace rotation: 18.905 ms
rank = 0, Efermi =  -0.101506298958 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.574 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.851 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1443.224 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.738 ms
rank = 0, D2D took 1.030 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -29.737490856618
Eband   =    -8.091045536216
E1      =    17.404124253254
E2      =    -7.542445783835
E3      =   -10.128174080171
Exc     =    -9.097069292295
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 7.406e-06, dEband = 7.184e-04
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -29.737490857, dEtot = 7.406e-06, dEband = 7.184e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0314122714936, which took 0.118 ms

iter_count = 114, r_2norm = 8.711e-07, tol*||rhs|| = 1.256e-06

Anderson update took 67.435 ms, out of which F'*F took 32.079 ms; b-Ax took 218.638 ms, out of which Lap took 194.988 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.546 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705719, int_b + int_rho = -2.055e-13, checking this took 0.151 ms
2-norm of RHS = 539.3076574962635, which took 0.118 ms

iter_count = 150, r_2norm = 5.311e-04, tol*||rhs|| = 5.393e-04

Anderson update took 88.478 ms, out of which F'*F took 41.548 ms; b-Ax took 287.876 ms, out of which Lap took 254.133 ms
Solving Poisson took 633.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.069313 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.786 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
Total time for convolution: 	 convolve: 5.070066 
Total time for convolution: 	 convolve: 5.077828 
Total time for convolution: 	 convolve: 5.071388 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.777 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 26837.379 ms, scf error = 1.884e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133278, lowerbound = -1.025461, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1397.415 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.309 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.547 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.039 ms
rank =  0, Distribute data + matrix mult took 16.911 ms
rank =  0, finding HY took 21.417 ms
rank =  0, distributing HY into block cyclic form took 15.572 ms
rank =  0, finding Y'*HY took 2.267 ms
Rank 0, Project_Hamiltonian used 56.201 ms
Total time for projection: 56.225 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.025278345912575
    last  calculated eigval = 0.032937141221767
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02527834591258
lambda[   2] =  -0.70279329679471
lambda[   3] =  -0.47985960651325
lambda[   4] =  -0.43684758453359
lambda[   5] =  -0.43179722422155
lambda[   6] =  -0.39716324828041
lambda[   7] =  -0.36148555626829
lambda[   8] =  -0.20894974552571
lambda[   9] =  -0.07127087517672
lambda[  10] =  -0.02286646674876
lambda[  11] =   0.01448555676246
lambda[  12] =   0.02525387070186
lambda[  13] =   0.02770296095737
lambda[  14] =   0.03293714122177
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 4.140 ms
rank =  0, Distributing orbital back into band + domain format took 14.775 ms
rank = 0, Subspace_Rotation used 18.930 ms

Total time for subspace rotation: 18.934 ms
rank = 0, Efermi =  -0.101360009085 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.528 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.913 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1476.363 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
rank = 0, D2D took 0.659 ms
rank = 0, Transfering density took 0.663 ms
Etot    =   -29.737512627316
Eband   =    -8.088349216603
E1      =    17.402828802978
E2      =    -7.540971581805
E3      =   -10.128384535848
Exc     =    -9.097228185976
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 4.354e-06, dEband = 5.393e-04
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -29.737512627, dEtot = 4.354e-06, dEband = 5.393e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0206738606450, which took 0.064 ms

iter_count = 114, r_2norm = 5.277e-07, tol*||rhs|| = 8.270e-07

Anderson update took 67.653 ms, out of which F'*F took 31.734 ms; b-Ax took 218.918 ms, out of which Lap took 195.286 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 511.876 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705718, int_b + int_rho = -2.183e-13, checking this took 0.686 ms
2-norm of RHS = 539.3139015715556, which took 0.072 ms

iter_count = 150, r_2norm = 4.907e-04, tol*||rhs|| = 5.393e-04

Anderson update took 88.367 ms, out of which F'*F took 42.155 ms; b-Ax took 286.811 ms, out of which Lap took 253.048 ms
Solving Poisson took 632.922 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.073235 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.003 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.068750 
Total time for convolution: 	 convolve: 5.084399 
Total time for convolution: 	 convolve: 6.284295 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 28412.711 ms, scf error = 1.488e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132937, lowerbound = -1.025278, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1395.058 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.429 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.550 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 17.015 ms
rank =  0, finding HY took 21.600 ms
rank =  0, distributing HY into block cyclic form took 15.726 ms
rank =  0, finding Y'*HY took 2.187 ms
Rank 0, Project_Hamiltonian used 56.563 ms
Total time for projection: 56.576 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -1.025174867716632
    last  calculated eigval = 0.032337938003718
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02517486771663
lambda[   2] =  -0.70265822882579
lambda[   3] =  -0.47972663722016
lambda[   4] =  -0.43671466844588
lambda[   5] =  -0.43167161620268
lambda[   6] =  -0.39704788517303
lambda[   7] =  -0.36135729097533
lambda[   8] =  -0.20881838011710
lambda[   9] =  -0.07116396887537
lambda[  10] =  -0.02247065438699
lambda[  11] =   0.01451314355054
lambda[  12] =   0.02548036571627
lambda[  13] =   0.02799969540379
lambda[  14] =   0.03233793800372
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 4.130 ms
rank =  0, Distributing orbital back into band + domain format took 14.874 ms
rank = 0, Subspace_Rotation used 19.021 ms

Total time for subspace rotation: 19.025 ms
rank = 0, Efermi =  -0.101253103201 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.267 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.182 ms
rank = 0, Calculating density took 1475.194 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.665 ms
rank = 0, Transfering density took 0.671 ms
Etot    =   -29.737530791680
Eband   =    -8.086339149855
E1      =    17.402057026080
E2      =    -7.539693288010
E3      =   -10.128438867016
Exc     =    -9.097260677563
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 3.633e-06, dEband = 4.020e-04
rank = 0, Calculating/Estimating energy took 1.043 ms, Etot = -29.737530792, dEtot = 3.633e-06, dEband = 4.020e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0258642571780, which took 0.061 ms

iter_count = 108, r_2norm = 9.080e-07, tol*||rhs|| = 1.035e-06

Anderson update took 63.898 ms, out of which F'*F took 30.337 ms; b-Ax took 206.438 ms, out of which Lap took 183.877 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.406 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705724, int_b + int_rho = -1.528e-13, checking this took 0.160 ms
2-norm of RHS = 539.3100984169727, which took 0.112 ms

iter_count = 96, r_2norm = 4.895e-04, tol*||rhs|| = 5.393e-04

Anderson update took 56.288 ms, out of which F'*F took 28.696 ms; b-Ax took 185.763 ms, out of which Lap took 164.172 ms
Solving Poisson took 407.962 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.079500 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.072967 
Total time for convolution: 	 convolve: 5.073907 
Total time for convolution: 	 convolve: 5.069473 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 26617.485 ms, scf error = 1.689e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.132338, lowerbound = -1.025175, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1396.007 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.203 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.529 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 16.767 ms
rank =  0, finding HY took 21.505 ms
rank =  0, distributing HY into block cyclic form took 15.542 ms
rank =  0, finding Y'*HY took 2.252 ms
Rank 0, Project_Hamiltonian used 56.098 ms
Total time for projection: 56.124 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -1.025162446620159
    last  calculated eigval = 0.031377749865462
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02516244662016
lambda[   2] =  -0.70266426035267
lambda[   3] =  -0.47973291792377
lambda[   4] =  -0.43671998826991
lambda[   5] =  -0.43167412269762
lambda[   6] =  -0.39704688885783
lambda[   7] =  -0.36136059979264
lambda[   8] =  -0.20882804245938
lambda[   9] =  -0.07116843086810
lambda[  10] =  -0.02276361283203
lambda[  11] =   0.01446994890979
lambda[  12] =   0.02497072378914
lambda[  13] =   0.02768150222546
lambda[  14] =   0.03137774986546
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 4.004 ms
rank =  0, Distributing orbital back into band + domain format took 14.737 ms
rank = 0, Subspace_Rotation used 18.760 ms

Total time for subspace rotation: 18.764 ms
rank = 0, Efermi =  -0.101257565036 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.470 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.828 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1474.609 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.597 ms
rank = 0, D2D took 0.896 ms
rank = 0, Transfering density took 0.906 ms
Etot    =   -29.737530566541
Eband   =    -8.086378534450
E1      =    17.401911897235
E2      =    -7.539871071593
E3      =   -10.128497017003
Exc     =    -9.097311872554
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 4.503e-08, dEband = 7.877e-06
rank = 0, Calculating/Estimating energy took 1.308 ms, Etot = -29.737530567, dEtot = 4.503e-08, dEband = 7.877e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0245710582772, which took 0.097 ms

iter_count = 108, r_2norm = 9.270e-07, tol*||rhs|| = 9.828e-07

Anderson update took 64.006 ms, out of which F'*F took 29.797 ms; b-Ax took 206.799 ms, out of which Lap took 184.014 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.813 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705719, int_b + int_rho = -2.092e-13, checking this took 0.153 ms
2-norm of RHS = 539.3097925624550, which took 0.124 ms

iter_count = 42, r_2norm = 5.296e-04, tol*||rhs|| = 5.393e-04

Anderson update took 24.761 ms, out of which F'*F took 11.776 ms; b-Ax took 80.271 ms, out of which Lap took 70.852 ms
Solving Poisson took 179.986 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.070246 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.250 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.384 ms
Total time for convolution: 	 convolve: 5.096112 
Total time for convolution: 	 convolve: 5.082018 
Total time for convolution: 	 convolve: 5.070540 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 26431.166 ms, scf error = 1.413e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.131378, lowerbound = -1.025162, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1398.351 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.289 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 16.870 ms
rank =  0, finding HY took 21.611 ms
rank =  0, distributing HY into block cyclic form took 15.564 ms
rank =  0, finding Y'*HY took 2.267 ms
Rank 0, Project_Hamiltonian used 56.346 ms
Total time for projection: 56.373 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.025167673911433
    last  calculated eigval = 0.030713572915609
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02516767391143
lambda[   2] =  -0.70267392151860
lambda[   3] =  -0.47974005593096
lambda[   4] =  -0.43672699208896
lambda[   5] =  -0.43168127874550
lambda[   6] =  -0.39705338419487
lambda[   7] =  -0.36136643141552
lambda[   8] =  -0.20883689768592
lambda[   9] =  -0.07117764465819
lambda[  10] =  -0.02283153730406
lambda[  11] =   0.01441939057095
lambda[  12] =   0.02478625382375
lambda[  13] =   0.02759142333196
lambda[  14] =   0.03071357291561
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 4.046 ms
rank =  0, Distributing orbital back into band + domain format took 14.654 ms
rank = 0, Subspace_Rotation used 18.723 ms

Total time for subspace rotation: 18.727 ms
rank = 0, Efermi =  -0.101266778708 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.568 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1477.371 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.752 ms
rank = 0, D2D took 1.004 ms
rank = 0, Transfering density took 1.012 ms
Etot    =   -29.737533782487
Eband   =    -8.086493271486
E1      =    17.401961456155
E2      =    -7.539938579481
E3      =   -10.128477444584
Exc     =    -9.097297845854
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 6.432e-07, dEband = 2.295e-05
rank = 0, Calculating/Estimating energy took 1.123 ms, Etot = -29.737533782, dEtot = 6.432e-07, dEband = 2.295e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226489177078, which took 0.089 ms

iter_count = 108, r_2norm = 9.034e-07, tol*||rhs|| = 9.060e-07

Anderson update took 63.845 ms, out of which F'*F took 30.599 ms; b-Ax took 207.240 ms, out of which Lap took 184.747 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.949 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705721, int_b + int_rho = -1.892e-13, checking this took 0.110 ms
2-norm of RHS = 539.3096337103640, which took 0.126 ms

iter_count = 60, r_2norm = 5.368e-04, tol*||rhs|| = 5.393e-04

Anderson update took 35.214 ms, out of which F'*F took 16.696 ms; b-Ax took 114.831 ms, out of which Lap took 100.994 ms
Solving Poisson took 255.518 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.112013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.075192 
Total time for convolution: 	 convolve: 5.078072 
Total time for convolution: 	 convolve: 5.072485 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.836 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.690 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.291 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.003 ms

This SCF took 26517.547 ms, scf error = 1.368e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.130714, lowerbound = -1.025168, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1403.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.392 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.545 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 16.978 ms
rank =  0, finding HY took 21.482 ms
rank =  0, distributing HY into block cyclic form took 15.456 ms
rank =  0, finding Y'*HY took 2.291 ms
Rank 0, Project_Hamiltonian used 56.241 ms
Total time for projection: 56.264 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.025174488632790
    last  calculated eigval = 0.030036091473337
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02517448863279
lambda[   2] =  -0.70269241609616
lambda[   3] =  -0.47975296379750
lambda[   4] =  -0.43673990989547
lambda[   5] =  -0.43169392903971
lambda[   6] =  -0.39706209053570
lambda[   7] =  -0.36137688269381
lambda[   8] =  -0.20885242195718
lambda[   9] =  -0.07119177689512
lambda[  10] =  -0.02294307944521
lambda[  11] =   0.01435414637739
lambda[  12] =   0.02467329790766
lambda[  13] =   0.02745201303202
lambda[  14] =   0.03003609147334
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.872 ms
rank =  0, subspace rotation using ScaLAPACK took 4.762 ms
rank =  0, Distributing orbital back into band + domain format took 14.186 ms
rank = 0, Subspace_Rotation used 18.968 ms

Total time for subspace rotation: 18.973 ms
rank = 0, Efermi =  -0.101280910940 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.516 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.894 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1482.742 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.842 ms
rank = 0, D2D took 1.090 ms
rank = 0, Transfering density took 1.098 ms
Etot    =   -29.737530987971
Eband   =    -8.086690205799
E1      =    17.402062839758
E2      =    -7.540043213343
E3      =   -10.128452596130
Exc     =    -9.097279286036
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 5.589e-07, dEband = 3.939e-05
rank = 0, Calculating/Estimating energy took 1.113 ms, Etot = -29.737530988, dEtot = 5.589e-07, dEband = 3.939e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0352403820239, which took 0.051 ms

iter_count = 102, r_2norm = 1.179e-06, tol*||rhs|| = 1.410e-06

Anderson update took 60.668 ms, out of which F'*F took 28.335 ms; b-Ax took 195.183 ms, out of which Lap took 173.651 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 436.033 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705717, int_b + int_rho = -2.219e-13, checking this took 0.114 ms
2-norm of RHS = 539.3116268118437, which took 0.135 ms

iter_count = 144, r_2norm = 4.926e-04, tol*||rhs|| = 5.393e-04

Anderson update took 84.840 ms, out of which F'*F took 40.344 ms; b-Ax took 275.668 ms, out of which Lap took 243.188 ms
Solving Poisson took 608.182 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.073921 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.071327 
Total time for convolution: 	 convolve: 5.085657 
Total time for convolution: 	 convolve: 5.081431 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.004 ms

This SCF took 26828.645 ms, scf error = 1.301e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.130036, lowerbound = -1.025174, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1406.402 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.301 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 16.890 ms
rank =  0, finding HY took 21.485 ms
rank =  0, distributing HY into block cyclic form took 15.603 ms
rank =  0, finding Y'*HY took 2.251 ms
Rank 0, Project_Hamiltonian used 56.260 ms
Total time for projection: 56.988 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.567 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.660 ms
    first calculated eigval = -1.025164123705520
    last  calculated eigval = 0.029523327088978
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02516412370552
lambda[   2] =  -0.70260748585238
lambda[   3] =  -0.47971249752263
lambda[   4] =  -0.43668160385064
lambda[   5] =  -0.43165665005848
lambda[   6] =  -0.39703337408710
lambda[   7] =  -0.36134011529018
lambda[   8] =  -0.20879105964365
lambda[   9] =  -0.07115248008961
lambda[  10] =  -0.02280928326988
lambda[  11] =   0.01430539717162
lambda[  12] =   0.02593362604333
lambda[  13] =   0.02772144338021
lambda[  14] =   0.02952332708898
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.672 ms
rank =  0, subspace rotation using ScaLAPACK took 4.035 ms
rank =  0, Distributing orbital back into band + domain format took 14.925 ms
rank = 0, Subspace_Rotation used 18.972 ms

Total time for subspace rotation: 18.977 ms
rank = 0, Efermi =  -0.101241614234 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.565 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.839 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1486.675 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 1.043 ms
rank = 0, Transfering density took 1.052 ms
Etot    =   -29.737538169615
Eband   =    -8.085973820523
E1      =    17.401776579736
E2      =    -7.539627281561
E3      =   -10.128373900447
Exc     =    -9.097221965468
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.436e-06, dEband = 1.433e-04
rank = 0, Calculating/Estimating energy took 1.165 ms, Etot = -29.737538170, dEtot = 1.436e-06, dEband = 1.433e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0315712723123, which took 0.090 ms

iter_count = 102, r_2norm = 1.219e-06, tol*||rhs|| = 1.263e-06

Anderson update took 60.652 ms, out of which F'*F took 28.391 ms; b-Ax took 195.075 ms, out of which Lap took 173.629 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.801 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705726, int_b + int_rho = -1.382e-13, checking this took 0.146 ms
2-norm of RHS = 539.3080099339095, which took 0.130 ms

iter_count = 108, r_2norm = 5.117e-04, tol*||rhs|| = 5.393e-04

Anderson update took 63.965 ms, out of which F'*F took 29.831 ms; b-Ax took 205.456 ms, out of which Lap took 181.232 ms
Solving Poisson took 456.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.070724 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.541 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.133 ms
Total time for convolution: 	 convolve: 5.076559 
Total time for convolution: 	 convolve: 5.088003 
Total time for convolution: 	 convolve: 5.071908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.313 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 26684.976 ms, scf error = 2.069e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.129523, lowerbound = -1.025164, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1395.626 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.472 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.550 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 17.649 ms
rank =  0, finding HY took 22.046 ms
rank =  0, distributing HY into block cyclic form took 15.604 ms
rank =  0, finding Y'*HY took 2.282 ms
Rank 0, Project_Hamiltonian used 57.613 ms
Total time for projection: 57.630 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.025087113780190
    last  calculated eigval = 0.028433767422851
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02508711378019
lambda[   2] =  -0.70258512710828
lambda[   3] =  -0.47968038718953
lambda[   4] =  -0.43665358849580
lambda[   5] =  -0.43161774533039
lambda[   6] =  -0.39697991821708
lambda[   7] =  -0.36130358465319
lambda[   8] =  -0.20876753781635
lambda[   9] =  -0.07111885095777
lambda[  10] =  -0.02326470235051
lambda[  11] =   0.01428028705225
lambda[  12] =   0.02531759653995
lambda[  13] =   0.02707946861851
lambda[  14] =   0.02843376742285
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 4.116 ms
rank =  0, Distributing orbital back into band + domain format took 14.893 ms
rank = 0, Subspace_Rotation used 19.020 ms

Total time for subspace rotation: 19.024 ms
rank = 0, Efermi =  -0.101207984901 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.541 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.875 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1476.031 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.801 ms
rank = 0, D2D took 1.051 ms
rank = 0, Transfering density took 1.060 ms
Etot    =   -29.737537415875
Eband   =    -8.085350005684
E1      =    17.401263665186
E2      =    -7.539474338297
E3      =   -10.128545337070
Exc     =    -9.097350605377
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 1.507e-07, dEband = 1.248e-04
rank = 0, Calculating/Estimating energy took 1.120 ms, Etot = -29.737537416, dEtot = 1.507e-07, dEband = 1.248e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0218552568765, which took 0.052 ms

iter_count = 108, r_2norm = 6.756e-07, tol*||rhs|| = 8.742e-07

Anderson update took 64.928 ms, out of which F'*F took 29.978 ms; b-Ax took 218.711 ms, out of which Lap took 196.268 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 472.943 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705721, int_b + int_rho = -1.892e-13, checking this took 0.149 ms
2-norm of RHS = 539.3069535123129, which took 0.128 ms

iter_count = 102, r_2norm = 5.019e-04, tol*||rhs|| = 5.393e-04

Anderson update took 60.049 ms, out of which F'*F took 28.579 ms; b-Ax took 195.218 ms, out of which Lap took 172.342 ms
Solving Poisson took 431.493 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.137 ms
Total time for convolution: 	 convolve: 5.064290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.608 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.384 ms
Total time for convolution: 	 convolve: 5.063018 
Total time for convolution: 	 convolve: 5.067449 
Total time for convolution: 	 convolve: 5.069254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.850 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.979 ms

This SCF took 26641.363 ms, scf error = 1.441e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.128434, lowerbound = -1.025087, upperbound = 267.575296

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1392.628 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 15.268 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 16.844 ms
rank =  0, finding HY took 21.333 ms
rank =  0, distributing HY into block cyclic form took 15.553 ms
rank =  0, finding Y'*HY took 2.265 ms
Rank 0, Project_Hamiltonian used 56.026 ms
Total time for projection: 56.044 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.025006714870595
    last  calculated eigval = 0.027767841599707
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02500671487060
lambda[   2] =  -0.70256916360964
lambda[   3] =  -0.47964178594042
lambda[   4] =  -0.43662315442297
lambda[   5] =  -0.43157448489062
lambda[   6] =  -0.39691904816135
lambda[   7] =  -0.36125974397232
lambda[   8] =  -0.20874087600519
lambda[   9] =  -0.07107724505447
lambda[  10] =  -0.02353180228624
lambda[  11] =   0.01429915653506
lambda[  12] =   0.02487520937700
lambda[  13] =   0.02660993113258
lambda[  14] =   0.02776784159971
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 4.165 ms
rank =  0, Distributing orbital back into band + domain format took 14.661 ms
rank = 0, Subspace_Rotation used 18.838 ms

Total time for subspace rotation: 18.842 ms
rank = 0, Efermi =  -0.101166379157 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.532 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.817 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1471.610 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.771 ms
rank = 0, D2D took 1.027 ms
rank = 0, Transfering density took 1.029 ms
Etot    =   -29.737538883664
Eband   =    -8.084669944248
E1      =    17.400837314443
E2      =    -7.539178470581
E3      =   -10.128694266244
Exc     =    -9.097458845317
Esc     =   -47.624120145149
Entropy =    -0.000000000218
dE = 2.936e-07, dEband = 1.360e-04
rank = 0, Calculating/Estimating energy took 1.123 ms, Etot = -29.737538884, dEtot = 2.936e-07, dEband = 1.360e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0292277419960, which took 0.053 ms

iter_count = 96, r_2norm = 8.972e-07, tol*||rhs|| = 1.169e-06

Anderson update took 56.655 ms, out of which F'*F took 27.010 ms; b-Ax took 183.768 ms, out of which Lap took 163.912 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000705739, int_rho =  16.00000000705725, int_b + int_rho = -1.419e-13, checking this took 0.133 ms
2-norm of RHS = 539.3140864779012, which took 0.129 ms

iter_count = 150, r_2norm = 5.221e-04, tol*||rhs|| = 5.393e-04

Anderson update took 89.819 ms, out of which F'*F took 41.877 ms; b-Ax took 286.961 ms, out of which Lap took 253.261 ms
Solving Poisson took 635.104 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.067078 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.065805 
Total time for convolution: 	 convolve: 5.065409 
Total time for convolution: 	 convolve: 5.068617 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.687 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.573 ms

This SCF took 26778.141 ms, scf error = 7.964e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.02500671487060, occ[   1] =   2.00000000000000
lambda[   2] =  -0.70256916360964, occ[   2] =   2.00000000000000
lambda[   3] =  -0.47964178594042, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43662315442297, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43157448489062, occ[   5] =   2.00000000000000
lambda[   6] =  -0.39691904816135, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36125974397232, occ[   7] =   2.00000000000000
lambda[   8] =  -0.20874087600519, occ[   8] =   2.00000000000000
lambda[   9] =  -0.07107724505447, occ[   9] =   0.00000000705722
lambda[  10] =  -0.02353180228624, occ[  10] =   0.00000000000000
lambda[  11] =   0.01429915653506, occ[  11] =   0.00000000000000
lambda[  12] =   0.02487520937700, occ[  12] =   0.00000000000000
lambda[  13] =   0.02660993113258, occ[  13] =   0.00000000000000
lambda[  14] =   0.02776784159971, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.495 ms, time for Allreduce/Reduce: 5.998 ms 
Time for calculating local force components: 14.580 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000096585025   0.00000004472908  -1.34267199352486
 -0.00000001147742  -0.04385822824306   0.02561062133374
 -0.00000000224340   0.04385823336636   0.02561062956602
  0.00000209693222   0.00000005800678   0.15108907872985
 -0.00000047501570  -0.00000004757118   0.21696288130556
force_loc = 
 -0.00000706410371  -0.00000089332240   1.32266652748680
 -0.00000046698826   0.04576072075407  -0.02722100307969
  0.00000005518105  -0.04576052289402  -0.02722078154463
 -0.00000666493463  -0.00000092129833  -0.15698614906192
  0.00000125341593  -0.00000014469237  -0.21945791057665
Time for calculating nonlocal force components: 28.657 ms
[32mforces_xc: 
[0m[32m -0.00000027994969  -0.00000005697808   0.03015437108876
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000035353002  -0.00000005384134   0.00075115352046
[0m[32m  0.00000010848580   0.00000000510263   0.00091132030516
[0mTime for calculating XC forces components: 18.158 ms
 Cartesian force = 
 -0.00000575588803  -0.00000054419502   0.01010915594098
  0.00000207554993   0.00190285388738  -0.00165013085567
  0.00000260695326  -0.00190192815129  -0.00164990108833
 -0.00000236751681  -0.00000055575653  -0.00518566592133
  0.00000344090165   0.00000017421546  -0.00162345807566
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 405.276 ms
The program took 602.767 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:27
Job ID:        2266628
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:04:00,vmem=8360K,walltime=00:10:20,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-34-2
---------------------------------------
