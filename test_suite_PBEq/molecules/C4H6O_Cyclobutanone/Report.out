---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:45
Job ID:    2266483
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:51
Job ID:    2266483
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.091 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 7.757 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 11.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 8.285 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 74.183 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.974 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.090 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.191685	   13.855736	   10.000000	
    8.552605	    6.144264	   10.000000	
   11.880233	    6.510949	   10.000000	
   11.450184	    9.677532	   13.472653	
   11.450184	    9.677532	    6.527347	
    8.119767	    9.623250	   13.133105	
    8.119767	    9.623250	    6.866895	
   10.016695	   11.603188	   10.000000	
    9.910445	    9.587959	   12.097413	
    9.910445	    9.587959	    7.902587	
   10.083776	    7.523689	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.170 ms
Set up communicators.

--set up spincomm took 2.268 ms

--set up kptcomm took 0.340 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.037 ms

Calculate_SplineDerivRadFun took 0.216 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.796 ms.
time spent on vectorized spline interp: 3.146 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.743 ms.
time spent on vectorized spline interp: 1.357 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.292 ms.
time spent on vectorized spline interp: 1.709 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.393 ms.

Calculating rb for all atom types took 16.465 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.061 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000341848, sum_int_rho = 27.3905488797812
PosCharge = 28.000000034185, NegCharge = -27.390548879781, scal_fac = 1.022250417729
After scaling, int_rho = 28.0000000341849, PosCharge + NegCharge - NetCharge = -7.461e-14
--Calculate Vref took 0.639 ms
--Calculate rho_guess took 3.622 ms

 integral of b = -28.0000000341848,
 int{b} + Nelectron + NetCharge = -3.418e-08,
 Esc = -74.1401686448318,
 MPI_Reduce took 8.909 ms

Calculating b & b_ref took 21.014 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.109 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.119 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.088 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.676 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.011 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.690 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418501, int_b + int_rho = 0.000e+00, checking this took 0.441 ms
2-norm of RHS = 787.5372490810736, which took 0.515 ms

iter_count = 420, r_2norm = 6.977e-04, tol*||rhs|| = 7.875e-04

Anderson update took 232.993 ms, out of which F'*F took 107.978 ms; b-Ax took 712.696 ms, out of which Lap took 640.413 ms
Solving Poisson took 1516.970 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
Total time for convolution: 	 convolve: 5.139253 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
Total time for convolution: 	 convolve: 5.130902 
Total time for convolution: 	 convolve: 5.121721 
Total time for convolution: 	 convolve: 5.226175 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.626 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.450 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
rank = 0, XC calculation took 24502.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 4.840 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.302 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.283 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.149 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.662 ms
    Lanczos iter 54, eigmin  = -0.973708838, eigmax = 264.940071850, err_eigmin = 2.036e-03, err_eigmax = 9.874e-03
rank =   0, Lanczos took 122.011 ms, eigmin = -0.973708837548, eigmax = 267.589472568325

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.257882, lowerbound = -1.073709, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1502.831 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 19.569 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.871 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.467 ms
rank =  0, finding HY took 25.302 ms
rank =  0, distributing HY into block cyclic form took 20.119 ms
rank =  0, finding Y'*HY took 4.498 ms
Rank 0, Project_Hamiltonian used 72.870 ms
Total time for projection: 72.884 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.728 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.824 ms
    first calculated eigval = 2.707494532073190
    last  calculated eigval = 3.260192472254158
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.81781677351650
lambda[   6] =   2.85544586831791
lambda[   7] =   2.88703170508045
lambda[   8] =   2.92931548347254
lambda[   9] =   2.94436565925631
lambda[  10] =   2.95524947041901
lambda[  11] =   2.96873327425125
lambda[  12] =   3.01053909831789
lambda[  13] =   3.01109075607655
lambda[  14] =   3.03125027455123
lambda[  15] =   3.08970049374138
lambda[  16] =   3.12535507997152
lambda[  17] =   3.14131551616858
lambda[  18] =   3.16308968972910
lambda[  19] =   3.18054706933593
lambda[  20] =   3.21448132028265
lambda[  21] =   3.26019247225416
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.840 ms
rank =  0, subspace rotation using ScaLAPACK took 8.248 ms
rank =  0, Distributing orbital back into band + domain format took 36.647 ms
rank = 0, Subspace_Rotation used 44.912 ms

Total time for subspace rotation: 44.915 ms
rank = 0, Efermi =   3.061215484043 calculate fermi energy took 0.062 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.360192, lowerbound = -1.073709, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1441.940 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.020 ms
rank =  0, Distribute orbital to block cyclic format took 56.273 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.559 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.843 ms
rank =  0, finding HY took 24.776 ms
rank =  0, distributing HY into block cyclic form took 18.569 ms
rank =  0, finding Y'*HY took 4.026 ms
Rank 0, Project_Hamiltonian used 106.265 ms
Total time for projection: 106.271 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.803409684658190
    last  calculated eigval = 0.429261462675527
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.30415076110904
lambda[   6] =  -0.21084085870968
lambda[   7] =  -0.14610947711672
lambda[   8] =  -0.05644529772926
lambda[   9] =  -0.01103196293783
lambda[  10] =   0.03838040360113
lambda[  11] =   0.13227771493151
lambda[  12] =   0.22247384302144
lambda[  13] =   0.25270016263537
lambda[  14] =   0.26764912358381
lambda[  15] =   0.27729913231756
lambda[  16] =   0.32262682577130
lambda[  17] =   0.34039095291834
lambda[  18] =   0.37333553846316
lambda[  19] =   0.38829940200024
lambda[  20] =   0.40340990150150
lambda[  21] =   0.42926146267553
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 8.201 ms
rank =  0, Distributing orbital back into band + domain format took 18.098 ms
rank = 0, Subspace_Rotation used 26.315 ms

Total time for subspace rotation: 26.319 ms
rank = 0, Efermi =   0.272474838999 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.529261, lowerbound = -1.073709, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1442.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 55.774 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.349 ms
rank =  0, finding HY took 24.839 ms
rank =  0, distributing HY into block cyclic form took 36.262 ms
rank =  0, finding Y'*HY took 4.015 ms
Rank 0, Project_Hamiltonian used 123.500 ms
Total time for projection: 123.506 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.018747172011536
    last  calculated eigval = 0.132589177369043
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57947638326848
lambda[   6] =  -0.54015654637951
lambda[   7] =  -0.48735276941513
lambda[   8] =  -0.45850613203540
lambda[   9] =  -0.45146337382409
lambda[  10] =  -0.41977301581937
lambda[  11] =  -0.41285923561594
lambda[  12] =  -0.39480287152936
lambda[  13] =  -0.34605091380671
lambda[  14] =  -0.24008213149492
lambda[  15] =  -0.04146448267909
lambda[  16] =   0.04394845831280
lambda[  17] =   0.06613450127874
lambda[  18] =   0.09110178545791
lambda[  19] =   0.09295541045934
lambda[  20] =   0.12155020744995
lambda[  21] =   0.13258917736904
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 8.176 ms
rank =  0, Distributing orbital back into band + domain format took 18.032 ms
rank = 0, Subspace_Rotation used 26.230 ms

Total time for subspace rotation: 26.233 ms
rank = 0, Efermi =  -0.070145044563 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.232589, lowerbound = -1.073709, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1436.658 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 55.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.639 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.469 ms
rank =  0, finding HY took 24.772 ms
rank =  0, distributing HY into block cyclic form took 18.166 ms
rank =  0, finding Y'*HY took 4.032 ms
Rank 0, Project_Hamiltonian used 105.465 ms
Total time for projection: 105.470 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.214 ms
    first calculated eigval = -1.018996938305089
    last  calculated eigval = 0.088961695045443
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.58208967955521
lambda[   6] =  -0.54444546563261
lambda[   7] =  -0.49151743843194
lambda[   8] =  -0.46613486352366
lambda[   9] =  -0.46394723582771
lambda[  10] =  -0.43588303067047
lambda[  11] =  -0.41838842834714
lambda[  12] =  -0.41537144238123
lambda[  13] =  -0.36644752639789
lambda[  14] =  -0.28048404917881
lambda[  15] =  -0.09002720888296
lambda[  16] =  -0.00228078793382
lambda[  17] =   0.01094130398175
lambda[  18] =   0.03608478070502
lambda[  19] =   0.04706641475770
lambda[  20] =   0.06455264810057
lambda[  21] =   0.08896169504544
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 8.214 ms
rank =  0, Distributing orbital back into band + domain format took 18.169 ms
rank = 0, Subspace_Rotation used 27.325 ms

Total time for subspace rotation: 27.329 ms
rank = 0, Efermi =  -0.118707770759 calculate fermi energy took 0.030 ms
rank = 0, --- Calculate rho: sum over local bands took 5.324 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 6501.140 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.799 ms
rank = 0, D2D took 1.903 ms
rank = 0, Transfering density took 1.909 ms
Etot    =   -44.315485514964
Eband   =   -15.557694093516
E1      =    31.519269820515
E2      =   -12.166103173439
E3      =   -15.958710121031
Exc     =   -14.261705890590
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 4.029e+00, dEband = 1.414e+00
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -44.315485515, dEtot = 4.029e+00, dEband = 1.414e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 55.2751878202119, which took 1.491 ms

iter_count = 96, r_2norm = 1.804e-03, tol*||rhs|| = 2.211e-03

Anderson update took 52.003 ms, out of which F'*F took 24.422 ms; b-Ax took 163.680 ms, out of which Lap took 147.370 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.068 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418486, int_b + int_rho = -1.528e-13, checking this took 0.152 ms
2-norm of RHS = 783.2074604378611, which took 0.100 ms

iter_count = 288, r_2norm = 6.730e-04, tol*||rhs|| = 7.832e-04

Anderson update took 155.659 ms, out of which F'*F took 71.995 ms; b-Ax took 486.234 ms, out of which Lap took 434.904 ms
Solving Poisson took 1034.251 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.378 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.192907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.663 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.156924 
Total time for convolution: 	 convolve: 5.149312 
Total time for convolution: 	 convolve: 5.143748 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.208 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.559 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.007 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.600 ms

This SCF took 32773.920 ms, scf error = 1.722e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188962, lowerbound = -1.018997, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1484.582 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.262 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.604 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.884 ms
rank =  0, finding HY took 25.386 ms
rank =  0, distributing HY into block cyclic form took 18.622 ms
rank =  0, finding Y'*HY took 4.080 ms
Rank 0, Project_Hamiltonian used 69.013 ms
Total time for projection: 69.024 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.248 ms
    first calculated eigval = -1.002789486138945
    last  calculated eigval = 0.064105765480641
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55219799390282
lambda[   6] =  -0.51534392806457
lambda[   7] =  -0.46635646200477
lambda[   8] =  -0.44243923358839
lambda[   9] =  -0.43437178258149
lambda[  10] =  -0.40985682019628
lambda[  11] =  -0.38694538212806
lambda[  12] =  -0.38516526788817
lambda[  13] =  -0.35134862128831
lambda[  14] =  -0.25677130837783
lambda[  15] =  -0.09299414676260
lambda[  16] =  -0.02435709317617
lambda[  17] =   0.00335165009481
lambda[  18] =   0.02020564647926
lambda[  19] =   0.02716483219747
lambda[  20] =   0.03529399169836
lambda[  21] =   0.06410576548064
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 8.626 ms
rank =  0, Distributing orbital back into band + domain format took 18.126 ms
rank = 0, Subspace_Rotation used 26.780 ms

Total time for subspace rotation: 26.787 ms
rank = 0, Efermi =  -0.121674708629 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.589 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 1598.282 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.844 ms
rank = 0, D2D took 1.948 ms
rank = 0, Transfering density took 1.955 ms
Etot    =   -44.244922437742
Eband   =   -14.804139290198
E1      =    30.859210319054
E2      =   -12.106271960969
E3      =   -16.157218899652
Exc     =   -14.423315681377
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 6.415e-03, dEband = 6.850e-02
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -44.244922438, dEtot = 6.415e-03, dEband = 6.850e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.9924846890078, which took 0.057 ms

iter_count = 102, r_2norm = 6.857e-04, tol*||rhs|| = 9.197e-04

Anderson update took 53.935 ms, out of which F'*F took 25.321 ms; b-Ax took 171.448 ms, out of which Lap took 153.145 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.752 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418486, int_b + int_rho = -1.528e-13, checking this took 0.109 ms
2-norm of RHS = 777.4410582233137, which took 0.095 ms

iter_count = 300, r_2norm = 7.729e-04, tol*||rhs|| = 7.774e-04

Anderson update took 159.928 ms, out of which F'*F took 74.881 ms; b-Ax took 507.587 ms, out of which Lap took 452.622 ms
Solving Poisson took 1072.166 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.161551 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.559 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.160581 
Total time for convolution: 	 convolve: 5.141238 
Total time for convolution: 	 convolve: 5.177747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.583 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.987 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.605 ms

This SCF took 27852.910 ms, scf error = 1.187e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.164106, lowerbound = -1.002789, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1489.443 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.646 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.017 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.682 ms
rank =  0, finding HY took 25.765 ms
rank =  0, distributing HY into block cyclic form took 18.360 ms
rank =  0, finding Y'*HY took 4.202 ms
Rank 0, Project_Hamiltonian used 70.048 ms
Total time for projection: 70.063 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -0.980679024830009
    last  calculated eigval = 0.054963036461537
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.49909920570401
lambda[   6] =  -0.46515729844254
lambda[   7] =  -0.43091954680330
lambda[   8] =  -0.40442491420455
lambda[   9] =  -0.38249184784682
lambda[  10] =  -0.37045438105729
lambda[  11] =  -0.33694049175841
lambda[  12] =  -0.32536482590880
lambda[  13] =  -0.32053436730986
lambda[  14] =  -0.22219052667577
lambda[  15] =  -0.07922189498079
lambda[  16] =  -0.02954837623898
lambda[  17] =   0.00585704564858
lambda[  18] =   0.01315793358015
lambda[  19] =   0.02272231627467
lambda[  20] =   0.02951967454820
lambda[  21] =   0.05496303646154
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.216 ms
rank =  0, Distributing orbital back into band + domain format took 18.078 ms
rank = 0, Subspace_Rotation used 26.318 ms

Total time for subspace rotation: 26.324 ms
rank = 0, Efermi =  -0.107902456845 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.328 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.701 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.624 ms
rank = 0, Calculating density took 1603.353 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.952 ms
rank = 0, Transfering density took 1.959 ms
Etot    =   -44.186839667330
Eband   =   -13.534664970167
E1      =    29.785370068877
E2      =   -11.896981170475
E3      =   -16.538347426472
Exc     =   -14.732704717144
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 5.280e-03, dEband = 1.154e-01
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -44.186839667, dEtot = 5.280e-03, dEband = 1.154e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.8549081384717, which took 0.049 ms

iter_count = 102, r_2norm = 2.746e-04, tol*||rhs|| = 3.142e-04

Anderson update took 54.462 ms, out of which F'*F took 25.595 ms; b-Ax took 172.956 ms, out of which Lap took 154.646 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.709 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418493, int_b + int_rho = -8.004e-14, checking this took 0.139 ms
2-norm of RHS = 777.0161269897396, which took 0.115 ms

iter_count = 276, r_2norm = 6.300e-04, tol*||rhs|| = 7.770e-04

Anderson update took 150.935 ms, out of which F'*F took 68.738 ms; b-Ax took 466.326 ms, out of which Lap took 416.182 ms
Solving Poisson took 991.310 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.181249 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.144914 
Total time for convolution: 	 convolve: 5.145602 
Total time for convolution: 	 convolve: 5.146571 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.563 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.999 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.592 ms

This SCF took 27719.229 ms, scf error = 4.046e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.154963, lowerbound = -0.980679, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1498.928 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.265 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.656 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.938 ms
rank =  0, finding HY took 25.097 ms
rank =  0, distributing HY into block cyclic form took 18.498 ms
rank =  0, finding Y'*HY took 4.052 ms
Rank 0, Project_Hamiltonian used 69.042 ms
Total time for projection: 69.054 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.651 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.760 ms
    first calculated eigval = -0.972008707010391
    last  calculated eigval = 0.050180537606203
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.48563833466074
lambda[   6] =  -0.45217657112136
lambda[   7] =  -0.42163536519654
lambda[   8] =  -0.39305806552815
lambda[   9] =  -0.36968844567239
lambda[  10] =  -0.35973989094528
lambda[  11] =  -0.32365663285438
lambda[  12] =  -0.31232773460499
lambda[  13] =  -0.30918240365979
lambda[  14] =  -0.21393242810038
lambda[  15] =  -0.07083665240107
lambda[  16] =  -0.03153711916271
lambda[  17] =   0.00611828285316
lambda[  18] =   0.01130705383499
lambda[  19] =   0.01630477135605
lambda[  20] =   0.02062142195975
lambda[  21] =   0.05018053760620
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.777 ms
rank =  0, subspace rotation using ScaLAPACK took 8.101 ms
rank =  0, Distributing orbital back into band + domain format took 17.994 ms
rank = 0, Subspace_Rotation used 26.122 ms

Total time for subspace rotation: 26.127 ms
rank = 0, Efermi =  -0.099517214275 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 5.363 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.536 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.682 ms
rank = 0, Calculating density took 1612.645 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.965 ms
rank = 0, D2D took 2.073 ms
rank = 0, Transfering density took 2.080 ms
Etot    =   -44.180824129260
Eband   =   -13.200047411191
E1      =    29.550418421109
E2      =   -11.779008733960
E3      =   -16.649366206134
Exc     =   -14.819401433429
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 5.469e-04, dEband = 3.042e-02
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -44.180824129, dEtot = 5.469e-04, dEband = 3.042e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.5458902984672, which took 0.113 ms

iter_count = 108, r_2norm = 8.329e-05, tol*||rhs|| = 1.018e-04

Anderson update took 57.711 ms, out of which F'*F took 26.886 ms; b-Ax took 186.895 ms, out of which Lap took 167.228 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.171 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418486, int_b + int_rho = -1.455e-13, checking this took 0.111 ms
2-norm of RHS = 777.3881266016137, which took 0.124 ms

iter_count = 258, r_2norm = 7.607e-04, tol*||rhs|| = 7.774e-04

Anderson update took 140.208 ms, out of which F'*F took 63.910 ms; b-Ax took 435.632 ms, out of which Lap took 388.228 ms
Solving Poisson took 926.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.145335 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.152253 
Total time for convolution: 	 convolve: 5.215185 
Total time for convolution: 	 convolve: 5.146975 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.481 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 11.353 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 58.689 ms

This SCF took 28853.826 ms, scf error = 1.763e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.150181, lowerbound = -0.972009, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1469.536 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 497.133 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.274 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 501.440 ms
rank =  0, finding HY took 36.048 ms
rank =  0, distributing HY into block cyclic form took 21.241 ms
rank =  0, finding Y'*HY took 69.412 ms
Rank 0, Project_Hamiltonian used 628.209 ms
Total time for projection: 628.228 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.225 ms
    first calculated eigval = -0.964054476100726
    last  calculated eigval = 0.046137261029119
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47896204183667
lambda[   6] =  -0.44541197419413
lambda[   7] =  -0.41400994528679
lambda[   8] =  -0.38617275990856
lambda[   9] =  -0.36328762198492
lambda[  10] =  -0.35235222546138
lambda[  11] =  -0.31652304425403
lambda[  12] =  -0.30631347551812
lambda[  13] =  -0.30166320803702
lambda[  14] =  -0.20744677659034
lambda[  15] =  -0.06451402721259
lambda[  16] =  -0.03186920072065
lambda[  17] =   0.00636628108123
lambda[  18] =   0.01112311396256
lambda[  19] =   0.01321313284422
lambda[  20] =   0.01684404006745
lambda[  21] =   0.04613726102912
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 8.360 ms
rank =  0, Distributing orbital back into band + domain format took 80.801 ms
rank = 0, Subspace_Rotation used 89.183 ms

Total time for subspace rotation: 89.187 ms
rank = 0, Efermi =  -0.093194589094 calculate fermi energy took 0.957 ms
rank = 0, --- Calculate rho: sum over local bands took 8.383 ms
rank = 0, --- Calculate rho: reduce over all band groups took 8.767 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 2205.969 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.832 ms
rank = 0, D2D took 1.936 ms
rank = 0, Transfering density took 1.944 ms
Etot    =   -44.178894472167
Eband   =   -13.005345760674
E1      =    29.444643114473
E2      =   -11.676339931830
E3      =   -16.709019119795
Exc     =   -14.863382231749
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 1.754e-04, dEband = 1.770e-02
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -44.178894472, dEtot = 1.754e-04, dEband = 1.770e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5652639890116, which took 0.055 ms

iter_count = 108, r_2norm = 4.392e-05, tol*||rhs|| = 6.261e-05

Anderson update took 57.885 ms, out of which F'*F took 26.938 ms; b-Ax took 182.552 ms, out of which Lap took 163.187 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.307 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418489, int_b + int_rho = -1.201e-13, checking this took 0.116 ms
2-norm of RHS = 777.8100071319549, which took 0.132 ms

iter_count = 240, r_2norm = 6.705e-04, tol*||rhs|| = 7.778e-04

Anderson update took 128.622 ms, out of which F'*F took 59.628 ms; b-Ax took 407.521 ms, out of which Lap took 363.328 ms
Solving Poisson took 863.648 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.157623 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.596 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.179455 
Total time for convolution: 	 convolve: 5.167279 
Total time for convolution: 	 convolve: 5.173958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.356 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.080 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.663 ms

This SCF took 28366.419 ms, scf error = 6.315e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.146137, lowerbound = -0.964054, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1499.671 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.255 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.651 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.922 ms
rank =  0, finding HY took 25.057 ms
rank =  0, distributing HY into block cyclic form took 18.213 ms
rank =  0, finding Y'*HY took 4.066 ms
Rank 0, Project_Hamiltonian used 68.288 ms
Total time for projection: 68.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.961629636165142
    last  calculated eigval = 0.042540920524346
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47608398923361
lambda[   6] =  -0.44245937998689
lambda[   7] =  -0.41106714956479
lambda[   8] =  -0.38347140068414
lambda[   9] =  -0.36038616817785
lambda[  10] =  -0.34957998420611
lambda[  11] =  -0.31339014868001
lambda[  12] =  -0.30305844991063
lambda[  13] =  -0.29863070309395
lambda[  14] =  -0.20460742111725
lambda[  15] =  -0.06240075996107
lambda[  16] =  -0.03164129847238
lambda[  17] =   0.00669784070990
lambda[  18] =   0.01111103688639
lambda[  19] =   0.01191453467625
lambda[  20] =   0.01546765175497
lambda[  21] =   0.04254092052435
==subpsace eigenproblem: bcast eigvals took 0.065 ms
Total time for solving subspace eigenvalue problem: 0.321 ms
rank =  0, subspace rotation using ScaLAPACK took 8.202 ms
rank =  0, Distributing orbital back into band + domain format took 17.960 ms
rank = 0, Subspace_Rotation used 26.180 ms

Total time for subspace rotation: 26.184 ms
rank = 0, Efermi =  -0.091081321842 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.286 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.620 ms
rank = 0, Calculating density took 1611.308 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.921 ms
rank = 0, Transfering density took 1.924 ms
Etot    =   -44.178439853026
Eband   =   -12.922658427262
E1      =    29.411540875368
E2      =   -11.622423678804
E3      =   -16.723061126595
Exc     =   -14.872638460688
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 4.133e-05, dEband = 7.517e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -44.178439853, dEtot = 4.133e-05, dEband = 7.517e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5771124346718, which took 0.149 ms

iter_count = 108, r_2norm = 2.190e-05, tol*||rhs|| = 2.308e-05

Anderson update took 57.973 ms, out of which F'*F took 26.986 ms; b-Ax took 184.424 ms, out of which Lap took 164.921 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.944 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418502, int_b + int_rho = 1.091e-14, checking this took 0.115 ms
2-norm of RHS = 778.1159546079248, which took 0.070 ms

iter_count = 240, r_2norm = 6.646e-04, tol*||rhs|| = 7.781e-04

Anderson update took 127.680 ms, out of which F'*F took 60.375 ms; b-Ax took 409.036 ms, out of which Lap took 364.953 ms
Solving Poisson took 862.198 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.171391 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.160257 
Total time for convolution: 	 convolve: 5.154575 
Total time for convolution: 	 convolve: 5.160322 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.241 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.627 ms
---Transfer Veff_loc: D2D took 3.902 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.044 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.982 ms

This SCF took 27597.877 ms, scf error = 3.552e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142541, lowerbound = -0.961630, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1502.671 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.254 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.231 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.503 ms
rank =  0, finding HY took 24.159 ms
rank =  0, distributing HY into block cyclic form took 18.114 ms
rank =  0, finding Y'*HY took 4.020 ms
Rank 0, Project_Hamiltonian used 68.825 ms
Total time for projection: 68.836 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.959224359472929
    last  calculated eigval = 0.039722086147412
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.47250430654135
lambda[   6] =  -0.43884832429900
lambda[   7] =  -0.40809849355325
lambda[   8] =  -0.38019174177831
lambda[   9] =  -0.35690341774980
lambda[  10] =  -0.34651694449674
lambda[  11] =  -0.30949679210091
lambda[  12] =  -0.29895275346575
lambda[  13] =  -0.29522955354966
lambda[  14] =  -0.20170834715204
lambda[  15] =  -0.05989821748571
lambda[  16] =  -0.03079399811804
lambda[  17] =   0.00811057042715
lambda[  18] =   0.01182109029802
lambda[  19] =   0.01233432166864
lambda[  20] =   0.01528786918125
lambda[  21] =   0.03972208614741
==subpsace eigenproblem: bcast eigvals took 0.092 ms
Total time for solving subspace eigenvalue problem: 0.310 ms
rank =  0, subspace rotation using ScaLAPACK took 8.126 ms
rank =  0, Distributing orbital back into band + domain format took 18.120 ms
rank = 0, Subspace_Rotation used 26.264 ms

Total time for subspace rotation: 26.269 ms
rank = 0, Efermi =  -0.088578779376 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.289 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.705 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 1614.818 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.942 ms
Etot    =   -44.178135370276
Eband   =   -12.825049237701
E1      =    29.364963538105
E2      =   -11.566824179743
E3      =   -16.739266319473
Exc     =   -14.883971524054
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 2.768e-05, dEband = 8.874e-03
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -44.178135370, dEtot = 2.768e-05, dEband = 8.874e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2241335798808, which took 0.066 ms

iter_count = 114, r_2norm = 7.009e-06, tol*||rhs|| = 8.965e-06

Anderson update took 60.969 ms, out of which F'*F took 28.318 ms; b-Ax took 194.832 ms, out of which Lap took 173.791 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.810 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418491, int_b + int_rho = -9.459e-14, checking this took 0.118 ms
2-norm of RHS = 778.1754114456592, which took 0.095 ms

iter_count = 228, r_2norm = 6.919e-04, tol*||rhs|| = 7.782e-04

Anderson update took 122.202 ms, out of which F'*F took 57.094 ms; b-Ax took 390.596 ms, out of which Lap took 349.739 ms
Solving Poisson took 822.756 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.185009 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.163621 
Total time for convolution: 	 convolve: 5.309252 
Total time for convolution: 	 convolve: 5.153275 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.602 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.134 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.437 ms
---Transfer Veff_loc: D2D took 3.573 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.069 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.676 ms

This SCF took 27746.976 ms, scf error = 1.905e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.139722, lowerbound = -0.959224, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1500.261 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.251 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.625 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.893 ms
rank =  0, finding HY took 25.063 ms
rank =  0, distributing HY into block cyclic form took 18.188 ms
rank =  0, finding Y'*HY took 4.014 ms
Rank 0, Project_Hamiltonian used 68.192 ms
Total time for projection: 68.203 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.134 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.956392116524767
    last  calculated eigval = 0.038128761367369
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46987190293490
lambda[   6] =  -0.43615206349108
lambda[   7] =  -0.40519608319958
lambda[   8] =  -0.37733127605975
lambda[   9] =  -0.35447387351027
lambda[  10] =  -0.34370474893851
lambda[  11] =  -0.30640126595072
lambda[  12] =  -0.29596577620868
lambda[  13] =  -0.29250813972966
lambda[  14] =  -0.19900201946494
lambda[  15] =  -0.05738058624981
lambda[  16] =  -0.02917803360507
lambda[  17] =   0.01089177126483
lambda[  18] =   0.01381090346075
lambda[  19] =   0.01457482309863
lambda[  20] =   0.01592278570532
lambda[  21] =   0.03812876136737
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 8.223 ms
rank =  0, Distributing orbital back into band + domain format took 17.986 ms
rank = 0, Subspace_Rotation used 26.225 ms

Total time for subspace rotation: 26.229 ms
rank = 0, Efermi =  -0.086061148136 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.324 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.654 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1611.678 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.926 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -44.178028482813
Eband   =   -12.745732891101
E1      =    29.323980597172
E2      =   -11.525994796840
E3      =   -16.748763363644
Exc     =   -14.890865703526
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 9.717e-06, dEband = 7.211e-03
rank = 0, Calculating/Estimating energy took 1.797 ms, Etot = -44.178028483, dEtot = 9.717e-06, dEband = 7.211e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1712289792918, which took 0.053 ms

iter_count = 114, r_2norm = 4.581e-06, tol*||rhs|| = 6.849e-06

Anderson update took 61.073 ms, out of which F'*F took 28.676 ms; b-Ax took 194.912 ms, out of which Lap took 173.857 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.948 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418481, int_b + int_rho = -1.965e-13, checking this took 0.103 ms
2-norm of RHS = 778.1687362156081, which took 0.120 ms

iter_count = 210, r_2norm = 6.623e-04, tol*||rhs|| = 7.782e-04

Anderson update took 112.694 ms, out of which F'*F took 52.770 ms; b-Ax took 355.596 ms, out of which Lap took 318.071 ms
Solving Poisson took 754.388 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.182644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.765 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.181359 
Total time for convolution: 	 convolve: 5.206686 
Total time for convolution: 	 convolve: 5.186770 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 1.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.530 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.237 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.801 ms

This SCF took 27593.979 ms, scf error = 1.076e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.138129, lowerbound = -0.956392, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1498.975 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.203 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.952 ms
rank =  0, finding HY took 28.018 ms
rank =  0, distributing HY into block cyclic form took 18.276 ms
rank =  0, finding Y'*HY took 4.101 ms
Rank 0, Project_Hamiltonian used 71.395 ms
Total time for projection: 71.407 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -0.954874212433433
    last  calculated eigval = 0.036581837897067
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46855126874965
lambda[   6] =  -0.43485485981729
lambda[   7] =  -0.40372437999252
lambda[   8] =  -0.37592613008993
lambda[   9] =  -0.35319779757378
lambda[  10] =  -0.34229749333997
lambda[  11] =  -0.30504008193212
lambda[  12] =  -0.29469497969543
lambda[  13] =  -0.29113724001935
lambda[  14] =  -0.19756383372154
lambda[  15] =  -0.05594763910866
lambda[  16] =  -0.02701063853208
lambda[  17] =   0.01373140402742
lambda[  18] =   0.01658127405111
lambda[  19] =   0.01733011123284
lambda[  20] =   0.01800323455272
lambda[  21] =   0.03658183789707
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.266 ms
rank =  0, subspace rotation using ScaLAPACK took 8.157 ms
rank =  0, Distributing orbital back into band + domain format took 18.037 ms
rank = 0, Subspace_Rotation used 26.211 ms

Total time for subspace rotation: 26.216 ms
rank = 0, Efermi =  -0.084628201005 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.581 ms
rank = 0, Calculating density took 1613.569 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 3.427 ms
rank = 0, D2D took 3.527 ms
rank = 0, Transfering density took 3.532 ms
Etot    =   -44.178018603743
Eband   =   -12.707497826865
E1      =    29.305460929099
E2      =   -11.505596977361
E3      =   -16.751554501281
Exc     =   -14.892964538776
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 8.981e-07, dEband = 3.476e-03
rank = 0, Calculating/Estimating energy took 1.366 ms, Etot = -44.178018604, dEtot = 8.981e-07, dEband = 3.476e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1108809327568, which took 0.064 ms

iter_count = 114, r_2norm = 2.982e-06, tol*||rhs|| = 4.435e-06

Anderson update took 61.800 ms, out of which F'*F took 29.085 ms; b-Ax took 194.036 ms, out of which Lap took 173.522 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.700 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418497, int_b + int_rho = -4.002e-14, checking this took 0.100 ms
2-norm of RHS = 778.1494849436367, which took 0.089 ms

iter_count = 198, r_2norm = 6.297e-04, tol*||rhs|| = 7.781e-04

Anderson update took 106.200 ms, out of which F'*F took 49.444 ms; b-Ax took 336.527 ms, out of which Lap took 300.795 ms
Solving Poisson took 711.906 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.155298 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.779 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.174078 
Total time for convolution: 	 convolve: 5.157230 
Total time for convolution: 	 convolve: 5.152474 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.111 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.535 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.013 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.581 ms

This SCF took 27440.875 ms, scf error = 6.863e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.136582, lowerbound = -0.954874, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1503.278 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.247 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.668 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.941 ms
rank =  0, finding HY took 24.974 ms
rank =  0, distributing HY into block cyclic form took 18.375 ms
rank =  0, finding Y'*HY took 4.427 ms
Rank 0, Project_Hamiltonian used 68.750 ms
Total time for projection: 68.761 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.954096610495367
    last  calculated eigval = 0.035140508189223
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46761716734362
lambda[   6] =  -0.43392892285309
lambda[   7] =  -0.40289487022886
lambda[   8] =  -0.37503747818013
lambda[   9] =  -0.35227958039150
lambda[  10] =  -0.34144618412549
lambda[  11] =  -0.30408460921525
lambda[  12] =  -0.29371570500637
lambda[  13] =  -0.29024195647795
lambda[  14] =  -0.19671672370643
lambda[  15] =  -0.05508641325931
lambda[  16] =  -0.02472570512600
lambda[  17] =   0.01602691364820
lambda[  18] =   0.01930461421343
lambda[  19] =   0.01971433325784
lambda[  20] =   0.02067103688643
lambda[  21] =   0.03514050818922
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.134 ms
rank =  0, Distributing orbital back into band + domain format took 18.011 ms
rank = 0, Subspace_Rotation used 26.164 ms

Total time for subspace rotation: 26.589 ms
rank = 0, Efermi =  -0.083766975157 calculate fermi energy took 0.618 ms
rank = 0, --- Calculate rho: sum over local bands took 5.236 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.144 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1615.559 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.850 ms
rank = 0, D2D took 1.957 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -44.178042391942
Eband   =   -12.682018734404
E1      =    29.291922180786
E2      =   -11.493260269522
E3      =   -16.753621655240
Exc     =   -14.894659117243
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 2.163e-06, dEband = 2.316e-03
rank = 0, Calculating/Estimating energy took 0.955 ms, Etot = -44.178042392, dEtot = 2.163e-06, dEband = 2.316e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569258006278, which took 0.089 ms

iter_count = 114, r_2norm = 1.878e-06, tol*||rhs|| = 2.277e-06

Anderson update took 61.239 ms, out of which F'*F took 28.730 ms; b-Ax took 194.498 ms, out of which Lap took 173.591 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.512 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418499, int_b + int_rho = -2.183e-14, checking this took 0.115 ms
2-norm of RHS = 778.1577392452011, which took 0.117 ms

iter_count = 186, r_2norm = 7.418e-04, tol*||rhs|| = 7.782e-04

Anderson update took 99.373 ms, out of which F'*F took 46.379 ms; b-Ax took 314.196 ms, out of which Lap took 280.443 ms
Solving Poisson took 668.088 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.161336 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.148705 
Total time for convolution: 	 convolve: 5.172260 
Total time for convolution: 	 convolve: 5.160536 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.334 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.523 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.998 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.554 ms

This SCF took 27772.399 ms, scf error = 4.797e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.135141, lowerbound = -0.954097, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1501.189 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.089 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.862 ms
rank =  0, finding HY took 24.379 ms
rank =  0, distributing HY into block cyclic form took 18.291 ms
rank =  0, finding Y'*HY took 4.009 ms
Rank 0, Project_Hamiltonian used 68.579 ms
Total time for projection: 68.592 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.953351158138955
    last  calculated eigval = 0.034062677529753
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46688583285027
lambda[   6] =  -0.43315813328122
lambda[   7] =  -0.40213405189419
lambda[   8] =  -0.37428166862821
lambda[   9] =  -0.35154991827382
lambda[  10] =  -0.34065884028644
lambda[  11] =  -0.30329281981934
lambda[  12] =  -0.29292903846373
lambda[  13] =  -0.28946840254501
lambda[  14] =  -0.19596665597464
lambda[  15] =  -0.05431384556774
lambda[  16] =  -0.02226909994711
lambda[  17] =   0.01756805668156
lambda[  18] =   0.02158555850627
lambda[  19] =   0.02223120893343
lambda[  20] =   0.02344669478657
lambda[  21] =   0.03406267752975
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.291 ms
rank =  0, subspace rotation using ScaLAPACK took 8.696 ms
rank =  0, Distributing orbital back into band + domain format took 18.035 ms
rank = 0, Subspace_Rotation used 26.764 ms

Total time for subspace rotation: 26.770 ms
rank = 0, Efermi =  -0.082994407472 calculate fermi energy took 0.138 ms
rank = 0, --- Calculate rho: sum over local bands took 5.315 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 1613.957 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.949 ms
rank = 0, Transfering density took 1.955 ms
Etot    =   -44.178122961928
Eband   =   -12.660511948620
E1      =    29.281515142229
E2      =   -11.481829219357
E3      =   -16.754968108633
Exc     =   -14.895754837683
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 7.325e-06, dEband = 1.955e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -44.178122962, dEtot = 7.325e-06, dEband = 1.955e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0458477068899, which took 0.055 ms

iter_count = 114, r_2norm = 1.555e-06, tol*||rhs|| = 1.834e-06

Anderson update took 61.216 ms, out of which F'*F took 28.942 ms; b-Ax took 194.067 ms, out of which Lap took 173.813 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.974 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418490, int_b + int_rho = -1.091e-13, checking this took 0.109 ms
2-norm of RHS = 778.1640653987577, which took 0.116 ms

iter_count = 156, r_2norm = 7.408e-04, tol*||rhs|| = 7.782e-04

Anderson update took 83.444 ms, out of which F'*F took 38.473 ms; b-Ax took 263.946 ms, out of which Lap took 235.710 ms
Solving Poisson took 560.298 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.160032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.233 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.155385 
Total time for convolution: 	 convolve: 5.169642 
Total time for convolution: 	 convolve: 5.166370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 3.551 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.223 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.809 ms

This SCF took 27277.275 ms, scf error = 3.076e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134063, lowerbound = -0.953351, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1498.929 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 18.138 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.690 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.845 ms
rank =  0, finding HY took 24.948 ms
rank =  0, distributing HY into block cyclic form took 18.252 ms
rank =  0, finding Y'*HY took 3.953 ms
Rank 0, Project_Hamiltonian used 68.034 ms
Total time for projection: 68.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.953032312476918
    last  calculated eigval = 0.033875676601295
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46659317148937
lambda[   6] =  -0.43285536059680
lambda[   7] =  -0.40183429212867
lambda[   8] =  -0.37396554152655
lambda[   9] =  -0.35126243207691
lambda[  10] =  -0.34034731001736
lambda[  11] =  -0.30298630777317
lambda[  12] =  -0.29262736787204
lambda[  13] =  -0.28917481543245
lambda[  14] =  -0.19566519404133
lambda[  15] =  -0.05400283171282
lambda[  16] =  -0.02096175396955
lambda[  17] =   0.01819873366502
lambda[  18] =   0.02212380580117
lambda[  19] =   0.02339404710120
lambda[  20] =   0.02537654949013
lambda[  21] =   0.03387567660130
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 8.666 ms
rank =  0, Distributing orbital back into band + domain format took 17.978 ms
rank = 0, Subspace_Rotation used 26.672 ms

Total time for subspace rotation: 26.679 ms
rank = 0, Efermi =  -0.082683393614 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.368 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.681 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 1611.556 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.847 ms
rank = 0, D2D took 1.971 ms
rank = 0, Transfering density took 1.977 ms
Etot    =   -44.178173073681
Eband   =   -12.651988627044
E1      =    29.277396435981
E2      =   -11.477298947007
E3      =   -16.755400631276
Exc     =   -14.896111815059
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 4.556e-06, dEband = 7.748e-04
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -44.178173074, dEtot = 4.556e-06, dEband = 7.748e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0407077730241, which took 0.066 ms

iter_count = 108, r_2norm = 1.584e-06, tol*||rhs|| = 1.628e-06

Anderson update took 57.876 ms, out of which F'*F took 27.050 ms; b-Ax took 184.096 ms, out of which Lap took 164.401 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.573 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418501, int_b + int_rho = -3.638e-15, checking this took 0.132 ms
2-norm of RHS = 778.1764224648701, which took 0.103 ms

iter_count = 168, r_2norm = 7.035e-04, tol*||rhs|| = 7.782e-04

Anderson update took 89.015 ms, out of which F'*F took 41.873 ms; b-Ax took 285.123 ms, out of which Lap took 254.427 ms
Solving Poisson took 602.761 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.158519 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 38.658 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.155113 
Total time for convolution: 	 convolve: 5.153262 
Total time for convolution: 	 convolve: 5.165659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.732 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.028 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.796 ms

This SCF took 27309.143 ms, scf error = 2.407e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133876, lowerbound = -0.953032, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1484.362 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.250 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.666 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.937 ms
rank =  0, finding HY took 24.957 ms
rank =  0, distributing HY into block cyclic form took 18.189 ms
rank =  0, finding Y'*HY took 4.057 ms
Rank 0, Project_Hamiltonian used 68.172 ms
Total time for projection: 68.185 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.661 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.762 ms
    first calculated eigval = -0.952620079327873
    last  calculated eigval = 0.034993859715668
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46619325096574
lambda[   6] =  -0.43246739298762
lambda[   7] =  -0.40144927459760
lambda[   8] =  -0.37355178741341
lambda[   9] =  -0.35086796905336
lambda[  10] =  -0.33995923125368
lambda[  11] =  -0.30261168128586
lambda[  12] =  -0.29225057135235
lambda[  13] =  -0.28879873392499
lambda[  14] =  -0.19527342701690
lambda[  15] =  -0.05359039526087
lambda[  16] =  -0.01873979248986
lambda[  17] =   0.01922109845739
lambda[  18] =   0.02321118900451
lambda[  19] =   0.02502685621076
lambda[  20] =   0.02781849136258
lambda[  21] =   0.03499385971567
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.800 ms
rank =  0, subspace rotation using ScaLAPACK took 8.109 ms
rank =  0, Distributing orbital back into band + domain format took 18.046 ms
rank = 0, Subspace_Rotation used 26.173 ms

Total time for subspace rotation: 26.178 ms
rank = 0, Efermi =  -0.082270957153 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.309 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1596.603 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.828 ms
rank = 0, D2D took 1.930 ms
rank = 0, Transfering density took 1.935 ms
Etot    =   -44.178246388806
Eband   =   -12.641050974518
E1      =    29.272351212111
E2      =   -11.471279213795
E3      =   -16.755733945645
Exc     =   -14.896391139996
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 6.665e-06, dEband = 9.943e-04
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -44.178246389, dEtot = 6.665e-06, dEband = 9.943e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0368450907343, which took 0.065 ms

iter_count = 114, r_2norm = 9.515e-07, tol*||rhs|| = 1.474e-06

Anderson update took 61.842 ms, out of which F'*F took 28.661 ms; b-Ax took 197.343 ms, out of which Lap took 177.223 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.568 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418496, int_b + int_rho = -4.366e-14, checking this took 0.116 ms
2-norm of RHS = 778.1740209639377, which took 0.098 ms

iter_count = 114, r_2norm = 7.147e-04, tol*||rhs|| = 7.782e-04

Anderson update took 61.263 ms, out of which F'*F took 28.877 ms; b-Ax took 192.481 ms, out of which Lap took 172.333 ms
Solving Poisson took 411.506 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.159169 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.488 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.155509 
Total time for convolution: 	 convolve: 5.156555 
Total time for convolution: 	 convolve: 5.177311 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.987 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.528 ms

This SCF took 27098.315 ms, scf error = 1.714e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134994, lowerbound = -0.952620, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1500.164 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.287 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.807 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 22.115 ms
rank =  0, finding HY took 24.441 ms
rank =  0, distributing HY into block cyclic form took 18.251 ms
rank =  0, finding Y'*HY took 4.021 ms
Rank 0, Project_Hamiltonian used 68.864 ms
Total time for projection: 68.876 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.217 ms
    first calculated eigval = -0.952491240187439
    last  calculated eigval = 0.034864003257676
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46609353015687
lambda[   6] =  -0.43236920449270
lambda[   7] =  -0.40133290646006
lambda[   8] =  -0.37343891186222
lambda[   9] =  -0.35077521942271
lambda[  10] =  -0.33985194318380
lambda[  11] =  -0.30250349977520
lambda[  12] =  -0.29214567626706
lambda[  13] =  -0.28870021370547
lambda[  14] =  -0.19516252178866
lambda[  15] =  -0.05349759604659
lambda[  16] =  -0.01865222809865
lambda[  17] =   0.01912540494307
lambda[  18] =   0.02312428601886
lambda[  19] =   0.02483938290976
lambda[  20] =   0.02787842998586
lambda[  21] =   0.03486400325768
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 8.101 ms
rank =  0, Distributing orbital back into band + domain format took 18.042 ms
rank = 0, Subspace_Rotation used 26.165 ms

Total time for subspace rotation: 26.170 ms
rank = 0, Efermi =  -0.082178157927 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.280 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.677 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1612.128 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.819 ms
rank = 0, D2D took 1.916 ms
rank = 0, Transfering density took 1.919 ms
Etot    =   -44.178266757002
Eband   =   -12.638059400795
E1      =    29.270633628619
E2      =   -11.469929307642
E3      =   -16.756009871791
Exc     =   -14.896611518416
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 1.852e-06, dEband = 2.720e-04
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -44.178266757, dEtot = 1.852e-06, dEband = 2.720e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0257759633562, which took 0.058 ms

iter_count = 114, r_2norm = 6.751e-07, tol*||rhs|| = 1.031e-06

Anderson update took 61.234 ms, out of which F'*F took 28.788 ms; b-Ax took 194.560 ms, out of which Lap took 173.816 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.251 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418495, int_b + int_rho = -6.185e-14, checking this took 0.101 ms
2-norm of RHS = 778.1727311929952, which took 0.104 ms

iter_count = 126, r_2norm = 6.995e-04, tol*||rhs|| = 7.782e-04

Anderson update took 67.248 ms, out of which F'*F took 31.305 ms; b-Ax took 215.608 ms, out of which Lap took 192.635 ms
Solving Poisson took 454.374 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.137 ms
Total time for convolution: 	 convolve: 5.161319 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.778 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.147909 
Total time for convolution: 	 convolve: 5.164129 
Total time for convolution: 	 convolve: 5.146706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 1.999 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.544 ms

This SCF took 27190.283 ms, scf error = 1.292e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134864, lowerbound = -0.952491, upperbound = 267.589473

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1504.443 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.197 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.689 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.907 ms
rank =  0, finding HY took 24.990 ms
rank =  0, distributing HY into block cyclic form took 18.181 ms
rank =  0, finding Y'*HY took 4.063 ms
Rank 0, Project_Hamiltonian used 68.178 ms
Total time for projection: 68.190 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.188 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.288 ms
    first calculated eigval = -0.952369080221213
    last  calculated eigval = 0.035306903698140
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.46597319503286
lambda[   6] =  -0.43225402957892
lambda[   7] =  -0.40121554885448
lambda[   8] =  -0.37332049566267
lambda[   9] =  -0.35065576018787
lambda[  10] =  -0.33973821993691
lambda[  11] =  -0.30239212978220
lambda[  12] =  -0.29203250081281
lambda[  13] =  -0.28858552796631
lambda[  14] =  -0.19504901816311
lambda[  15] =  -0.05339835762151
lambda[  16] =  -0.01815893222885
lambda[  17] =   0.01909458653136
lambda[  18] =   0.02332584645252
lambda[  19] =   0.02470895241601
lambda[  20] =   0.02832716816168
lambda[  21] =   0.03530690369814
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.329 ms
rank =  0, subspace rotation using ScaLAPACK took 8.156 ms
rank =  0, Distributing orbital back into band + domain format took 18.026 ms
rank = 0, Subspace_Rotation used 26.201 ms

Total time for subspace rotation: 26.206 ms
rank = 0, Efermi =  -0.082078919487 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.346 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.557 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1615.869 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.854 ms
rank = 0, D2D took 1.949 ms
rank = 0, Transfering density took 1.951 ms
Etot    =   -44.178292558195
Eband   =   -12.634808367802
E1      =    29.268976757753
E2      =   -11.468288479968
E3      =   -16.756144220061
Exc     =   -14.896725002333
Esc     =   -74.140168644832
Entropy =    -0.000000001011
dE = 2.346e-06, dEband = 2.955e-04
rank = 0, Calculating/Estimating energy took 0.949 ms, Etot = -44.178292558, dEtot = 2.346e-06, dEband = 2.955e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0151483253303, which took 0.115 ms

iter_count = 114, r_2norm = 4.332e-07, tol*||rhs|| = 6.059e-07

Anderson update took 61.122 ms, out of which F'*F took 28.694 ms; b-Ax took 195.177 ms, out of which Lap took 174.574 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.655 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000003418501, int_rho =  28.00000003418489, int_b + int_rho = -1.164e-13, checking this took 0.127 ms
2-norm of RHS = 778.1718186361794, which took 0.125 ms

iter_count = 132, r_2norm = 6.989e-04, tol*||rhs|| = 7.782e-04

Anderson update took 70.875 ms, out of which F'*F took 33.054 ms; b-Ax took 222.267 ms, out of which Lap took 198.852 ms
Solving Poisson took 476.403 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.159959 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.804 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.147701 
Total time for convolution: 	 convolve: 5.156934 
Total time for convolution: 	 convolve: 5.155188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.756 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.050 ms
---Transfer Veff_loc: D2D took 4.353 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.209 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.598 ms

This SCF took 27180.117 ms, scf error = 9.806e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.46597319503286, occ[   5] =   2.00000000000000
lambda[   6] =  -0.43225402957892, occ[   6] =   2.00000000000000
lambda[   7] =  -0.40121554885448, occ[   7] =   2.00000000000000
lambda[   8] =  -0.37332049566267, occ[   8] =   2.00000000000000
lambda[   9] =  -0.35065576018787, occ[   9] =   2.00000000000000
lambda[  10] =  -0.33973821993691, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30239212978220, occ[  11] =   2.00000000000000
lambda[  12] =  -0.29203250081281, occ[  12] =   2.00000000000000
lambda[  13] =  -0.28858552796631, occ[  13] =   2.00000000000000
lambda[  14] =  -0.19504901816311, occ[  14] =   2.00000000000000
lambda[  15] =  -0.05339835762151, occ[  15] =   0.00000003418492
lambda[  16] =  -0.01815893222885, occ[  16] =   0.00000000000000
lambda[  17] =   0.01909458653136, occ[  17] =   0.00000000000000
lambda[  18] =   0.02332584645252, occ[  18] =   0.00000000000000
lambda[  19] =   0.02470895241601, occ[  19] =   0.00000000000000
lambda[  20] =   0.02832716816168, occ[  20] =   0.00000000000000
lambda[  21] =   0.03530690369814, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.830 ms, time for Allreduce/Reduce: 11.058 ms 
Time for calculating local force components: 23.538 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.09226348276031  -1.19975370434098   0.00000048767600
  0.03691095139513   0.03395202004113   0.00000002553680
 -0.04334200781215   0.02510668930985   0.00000001456861
 -0.03672963669796  -0.00227133927318  -0.03313668686165
 -0.03672964948673  -0.00227133679841   0.03313672069005
  0.04234647615563  -0.00088605828949  -0.02492063641803
  0.04234648744993  -0.00088605433345   0.02492066754766
  0.01284041427044   0.10402197786242   0.00000037886532
 -0.00838879624067  -0.00800032811285  -0.00683349052134
 -0.00838897688092  -0.00800110457581   0.00683433194840
 -0.00192215818020   0.05575527698647   0.00000049011837
force_loc = 
  0.09135813634516   1.18632894053913   0.00000111798971
 -0.03808215176095  -0.03486111808386   0.00000024851508
  0.04443097196442  -0.02562117019347  -0.00000001342136
  0.03794513621439   0.00255933427427   0.03422652910834
  0.03794455484053   0.00255853005942  -0.03422674069841
 -0.04367999499495   0.00109347437690   0.02565722574979
 -0.04367969500226   0.00109322336237  -0.02565738859086
 -0.01486749246103  -0.12358389640628   0.00000263153870
  0.00863493297617   0.00571035995083   0.00622106285521
  0.00863542538740   0.00570735736166  -0.00622701211096
  0.00150039207013  -0.05195957869130  -0.00000140673000
Time for calculating nonlocal force components: 39.519 ms
[32mforces_xc: 
[0m[32m  0.00211053802735   0.02731257651956   0.00000001982679
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00051959976720   0.00724540887795   0.00000012782342
[0m[32m  0.00010616526221   0.00140423705899   0.00005184353896
[0m[32m  0.00010613802536   0.00140422062085  -0.00005210914985
[0m[32m  0.00033307849821  -0.00296958104493  -0.00000008641400
[0mTime for calculating XC forces components: 36.282 ms
 Cartesian force = 
  0.00120561376024   0.01387068934882   0.00000177522152
 -0.00117077821778  -0.00092622141162   0.00000042378090
  0.00108938630031  -0.00053160425252   0.00000015087627
  0.00121592166447   0.00027087163221   0.00108999197571
  0.00121532750185   0.00027006989212  -0.00108987027933
 -0.00133309669128   0.00019029271853   0.00073673906079
 -0.00133278540429   0.00019004566003  -0.00073657131419
 -0.00150705627536  -0.01233363303480   0.00000328795646
  0.00035272414575  -0.00090285447192  -0.00056043439815
  0.00035300867988  -0.00090664996220   0.00055536041662
 -0.00008826546381   0.00080899388136  -0.00000085329660
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 394.886 ms
The program took 447.670 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:22
Job ID:        2266483
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:32:36,vmem=8312K,walltime=00:07:43,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-21-2
---------------------------------------
