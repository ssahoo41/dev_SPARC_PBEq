---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:05
Job ID:    2267035
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:14
Job ID:    2267035
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 13.434 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 3.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 6.926 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 73.437 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.082 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	    7.895872	
   10.000000	   10.000000	    9.911919	
   10.000000	   10.000000	   12.104128	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.161 ms
Set up communicators.

--set up spincomm took 2.458 ms

--set up kptcomm took 0.365 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 11, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 11, ScaLAPACK topology Dims = (11, 1)
nproc = 12, size_blacscomm = 11 = dims[0] * dims[1] = (11, 1)
Nd_blacscomm 1000000, Nstates 11 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 11, mbQ = nbQ = 64
rank = 0, nr_Hp = 11, nc_Hp = 11
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.058 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.973 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 11
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 11
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.181 ms

Calculate_SplineDerivRadFun took 0.195 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.825 ms.
time spent on vectorized spline interp: 2.945 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.662 ms.
time spent on vectorized spline interp: 1.911 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.515 ms.
time spent on vectorized spline interp: 1.842 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.510 ms.

Calculating rb for all atom types took 16.220 ms
----------------------
Estimated memory usage
Total: 788.88 MB
orbitals             : 503.54 MB
global sized vectors : 213.62 MB
subspace matrices : 2.84 kB
others : 71.72 MB
----------------------------------------------
Estimated memory usage per processor: 65.74 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.016 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -10.0000000031272, sum_int_rho = 9.8935859938623
PosCharge = 10.000000003127, NegCharge = -9.893585993862, scal_fac = 1.010755858324
After scaling, int_rho = 10.0000000031272, PosCharge + NegCharge - NetCharge = 7.283e-14
--Calculate Vref took 0.216 ms
--Calculate rho_guess took 1.081 ms

 integral of b = -10.0000000031272,
 int{b} + Nelectron + NetCharge = -3.127e-09,
 Esc = -28.3732575224734,
 MPI_Reduce took 2.174 ms

Calculating b & b_ref took 7.463 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.032 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.100 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.027 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.246 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.821 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312722, int_b + int_rho = -1.655e-13, checking this took 0.113 ms
2-norm of RHS = 425.0417094736515, which took 0.080 ms

iter_count = 426, r_2norm = 3.320e-04, tol*||rhs|| = 4.250e-04

Anderson update took 255.538 ms, out of which F'*F took 118.297 ms; b-Ax took 795.587 ms, out of which Lap took 706.995 ms
Solving Poisson took 1742.914 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.105814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.581 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.141426 
Total time for convolution: 	 convolve: 5.102577 
Total time for convolution: 	 convolve: 5.119171 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
rank = 0, XC calculation took 24313.093 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 4.840 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.365 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.297 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.166 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.857 ms
    Lanczos iter 53, eigmin  = -0.992104284, eigmax = 264.916766357, err_eigmin = 8.148e-04, err_eigmax = 9.702e-03
rank =   0, Lanczos took 136.052 ms, eigmin = -0.992104284401, eigmax = 267.565934020188

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.236915, lowerbound = -1.092104, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 873.972 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.025 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.920 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 12.973 ms
rank =  0, finding HY took 15.868 ms
rank =  0, distributing HY into block cyclic form took 8.062 ms
rank =  0, finding Y'*HY took 2.636 ms
Rank 0, Project_Hamiltonian used 39.583 ms
Total time for projection: 39.598 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.364 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.136 ms
rank = 0, Solve_Generalized_EigenProblem used 0.528 ms
    first calculated eigval = 2.835996472027799
    last  calculated eigval = 3.191801658713887
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =   2.83599647202780
lambda[   2] =   2.87404675181291
lambda[   3] =   2.88400818163940
lambda[   4] =   2.94293717836759
lambda[   5] =   2.97643716508815
lambda[   6] =   2.99096205349120
lambda[   7] =   3.04602243545795
lambda[   8] =   3.06952445759455
lambda[   9] =   3.12401633358321
lambda[  10] =   3.13018457536511
lambda[  11] =   3.19180165871389
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.544 ms
rank =  0, subspace rotation using ScaLAPACK took 3.009 ms
rank =  0, Distributing orbital back into band + domain format took 8.765 ms
rank = 0, Subspace_Rotation used 11.801 ms

Total time for subspace rotation: 11.805 ms
rank = 0, Efermi =   2.983699609317 calculate fermi energy took 0.091 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.291802, lowerbound = -1.092104, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.092 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 8.233 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.917 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.172 ms
rank =  0, finding HY took 14.118 ms
rank =  0, distributing HY into block cyclic form took 8.067 ms
rank =  0, finding Y'*HY took 2.561 ms
Rank 0, Project_Hamiltonian used 34.971 ms
Total time for projection: 34.986 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.107 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -0.698898998537704
    last  calculated eigval = 0.435041232719810
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.69889899853770
lambda[   2] =  -0.31224370241684
lambda[   3] =  -0.04443464975028
lambda[   4] =   0.13800709767815
lambda[   5] =   0.26601607082975
lambda[   6] =   0.31718995778607
lambda[   7] =   0.33635763431402
lambda[   8] =   0.36243216295047
lambda[   9] =   0.39184039240610
lambda[  10] =   0.42128144125352
lambda[  11] =   0.43504123271981
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 3.069 ms
rank =  0, Distributing orbital back into band + domain format took 8.049 ms
rank = 0, Subspace_Rotation used 11.139 ms

Total time for subspace rotation: 11.143 ms
rank = 0, Efermi =   0.291604881974 calculate fermi energy took 0.035 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.535041, lowerbound = -1.092104, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.603 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 8.073 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.891 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.978 ms
rank =  0, finding HY took 14.098 ms
rank =  0, distributing HY into block cyclic form took 11.448 ms
rank =  0, finding Y'*HY took 1.980 ms
Rank 0, Project_Hamiltonian used 37.532 ms
Total time for projection: 37.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.997260367389133
    last  calculated eigval = 0.147635140811029
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.99726036738913
lambda[   2] =  -0.61994437449796
lambda[   3] =  -0.44860920599607
lambda[   4] =  -0.41288319726904
lambda[   5] =  -0.38845146547825
lambda[   6] =  -0.04181211062001
lambda[   7] =   0.03574606621722
lambda[   8] =   0.06687529481138
lambda[   9] =   0.10203139127120
lambda[  10] =   0.12639416266521
lambda[  11] =   0.14763514081103
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 2.943 ms
rank =  0, Distributing orbital back into band + domain format took 8.368 ms
rank = 0, Subspace_Rotation used 11.324 ms

Total time for subspace rotation: 11.329 ms
rank = 0, Efermi =  -0.072604010399 calculate fermi energy took 0.028 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.247635, lowerbound = -1.092104, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 864.059 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.907 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.951 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.872 ms
rank =  0, finding HY took 14.058 ms
rank =  0, distributing HY into block cyclic form took 8.093 ms
rank =  0, finding Y'*HY took 2.540 ms
Rank 0, Project_Hamiltonian used 34.588 ms
Total time for projection: 34.592 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.997604048301767
    last  calculated eigval = 0.086051250605505
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.99760404830177
lambda[   2] =  -0.62267198848668
lambda[   3] =  -0.45394750766012
lambda[   4] =  -0.42963070402312
lambda[   5] =  -0.42887248162558
lambda[   6] =  -0.10634886410283
lambda[   7] =  -0.07825070417329
lambda[   8] =   0.02532710776188
lambda[   9] =   0.04713701483012
lambda[  10] =   0.07720635457876
lambda[  11] =   0.08605125060550
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.036 ms
rank =  0, Distributing orbital back into band + domain format took 8.014 ms
rank = 0, Subspace_Rotation used 11.063 ms

Total time for subspace rotation: 11.068 ms
rank = 0, Efermi =  -0.137140763869 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 2.796 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.156 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.579 ms
rank = 0, Calculating density took 3820.056 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.956 ms
rank = 0, Transfering density took 1.962 ms
Etot    =   -17.011165042536
Eband   =    -5.865453460527
E1      =    11.944612752417
E2      =    -4.774385081583
E3      =    -5.701879677522
Exc     =    -5.193331570958
Esc     =   -28.373257522473
Entropy =    -0.000000000099
dE = 5.670e+00, dEband = 1.955e+00
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -17.011165043, dEtot = 5.670e+00, dEband = 1.955e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 34.4280588522043, which took 0.144 ms

iter_count = 96, r_2norm = 1.125e-03, tol*||rhs|| = 1.377e-03

Anderson update took 56.264 ms, out of which F'*F took 26.746 ms; b-Ax took 179.616 ms, out of which Lap took 159.282 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.025 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312719, int_b + int_rho = -1.928e-13, checking this took 0.129 ms
2-norm of RHS = 422.1601050693894, which took 0.185 ms

iter_count = 288, r_2norm = 3.969e-04, tol*||rhs|| = 4.222e-04

Anderson update took 170.614 ms, out of which F'*F took 80.282 ms; b-Ax took 535.674 ms, out of which Lap took 480.682 ms
Solving Poisson took 1178.692 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.345 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.085225 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.086105 
Total time for convolution: 	 convolve: 5.097436 
Total time for convolution: 	 convolve: 5.085667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 3.450 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.227 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.708 ms

This SCF took 29694.973 ms, scf error = 1.866e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186051, lowerbound = -0.997604, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 858.652 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 12.742 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.916 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 14.673 ms
rank =  0, finding HY took 14.405 ms
rank =  0, distributing HY into block cyclic form took 7.898 ms
rank =  0, finding Y'*HY took 2.646 ms
Rank 0, Project_Hamiltonian used 39.649 ms
Total time for projection: 39.667 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.946236318343225
    last  calculated eigval = 0.051273879013969
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.94623631834323
lambda[   2] =  -0.60744287889616
lambda[   3] =  -0.41354288514139
lambda[   4] =  -0.39706967150626
lambda[   5] =  -0.39696680031207
lambda[   6] =  -0.08934923228211
lambda[   7] =  -0.08231756950979
lambda[   8] =  -0.00348309005297
lambda[   9] =   0.01412581884778
lambda[  10] =   0.05073917517207
lambda[  11] =   0.05127387901397
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.045 ms
rank =  0, Distributing orbital back into band + domain format took 8.045 ms
rank = 0, Subspace_Rotation used 11.102 ms

Total time for subspace rotation: 11.107 ms
rank = 0, Efermi =  -0.120141224887 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.898 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.865 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.524 ms
rank = 0, Calculating density took 926.032 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.848 ms
rank = 0, D2D took 1.951 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -16.978810445453
Eband   =    -5.522517108678
E1      =    11.652440114466
E2      =    -4.738960385538
E3      =    -5.786992039748
Exc     =    -5.261428353954
Esc     =   -28.373257522473
Entropy =    -0.000000000099
dE = 1.078e-02, dEband = 1.143e-01
rank = 0, Calculating/Estimating energy took 1.824 ms, Etot = -16.978810445, dEtot = 1.078e-02, dEband = 1.143e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 14.1859337002525, which took 0.136 ms

iter_count = 102, r_2norm = 4.130e-04, tol*||rhs|| = 5.674e-04

Anderson update took 60.302 ms, out of which F'*F took 28.683 ms; b-Ax took 191.585 ms, out of which Lap took 171.999 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 426.365 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312716, int_b + int_rho = -2.292e-13, checking this took 0.113 ms
2-norm of RHS = 419.2302089690798, which took 0.216 ms

iter_count = 300, r_2norm = 4.154e-04, tol*||rhs|| = 4.192e-04

Anderson update took 177.206 ms, out of which F'*F took 83.178 ms; b-Ax took 551.342 ms, out of which Lap took 497.162 ms
Solving Poisson took 1225.984 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.083042 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.090316 
Total time for convolution: 	 convolve: 5.098980 
Total time for convolution: 	 convolve: 5.087459 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.304 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.492 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.251 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.781 ms

This SCF took 26903.529 ms, scf error = 1.258e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.151274, lowerbound = -0.946236, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 859.972 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 11.786 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.464 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 14.266 ms
rank =  0, finding HY took 14.515 ms
rank =  0, distributing HY into block cyclic form took 7.997 ms
rank =  0, finding Y'*HY took 2.607 ms
Rank 0, Project_Hamiltonian used 39.438 ms
Total time for projection: 39.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.869020789942310
    last  calculated eigval = 0.036932983406014
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.86902078994231
lambda[   2] =  -0.57459952596788
lambda[   3] =  -0.35638938441101
lambda[   4] =  -0.34824583986220
lambda[   5] =  -0.34820084491485
lambda[   6] =  -0.05445460950627
lambda[   7] =  -0.05244629665886
lambda[   8] =  -0.01884173636306
lambda[   9] =   0.00346367430668
lambda[  10] =   0.03492428323765
lambda[  11] =   0.03693298340601
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.067 ms
rank =  0, Distributing orbital back into band + domain format took 8.007 ms
rank = 0, Subspace_Rotation used 11.086 ms

Total time for subspace rotation: 11.091 ms
rank = 0, Efermi =  -0.085318522095 calculate fermi energy took 0.292 ms
rank = 0, --- Calculate rho: sum over local bands took 2.947 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.517 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.553 ms
rank = 0, Calculating density took 927.099 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.808 ms
rank = 0, D2D took 2.912 ms
rank = 0, Transfering density took 2.914 ms
Etot    =   -16.953944619991
Eband   =    -4.992912770366
E1      =    11.217867587571
E2      =    -4.639915676372
E3      =    -5.929435148833
Exc     =    -5.374992739828
Esc     =   -28.373257522473
Entropy =    -0.000000000100
dE = 8.289e-03, dEband = 1.765e-01
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -16.953944620, dEtot = 8.289e-03, dEband = 1.765e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.0997535509275, which took 0.113 ms

iter_count = 102, r_2norm = 1.771e-04, tol*||rhs|| = 2.040e-04

Anderson update took 60.512 ms, out of which F'*F took 28.786 ms; b-Ax took 190.705 ms, out of which Lap took 171.302 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 424.463 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312716, int_b + int_rho = -2.292e-13, checking this took 0.129 ms
2-norm of RHS = 420.1029986992945, which took 0.192 ms

iter_count = 276, r_2norm = 3.796e-04, tol*||rhs|| = 4.201e-04

Anderson update took 164.339 ms, out of which F'*F took 76.874 ms; b-Ax took 509.528 ms, out of which Lap took 459.787 ms
Solving Poisson took 1128.162 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.085997 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.090132 
Total time for convolution: 	 convolve: 5.085574 
Total time for convolution: 	 convolve: 5.096742 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.736 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.242 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.017 ms

This SCF took 26817.586 ms, scf error = 4.254e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.136933, lowerbound = -0.869021, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.767 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.981 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.926 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.920 ms
rank =  0, finding HY took 14.268 ms
rank =  0, distributing HY into block cyclic form took 7.952 ms
rank =  0, finding Y'*HY took 2.613 ms
Rank 0, Project_Hamiltonian used 34.793 ms
Total time for projection: 34.806 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.858205860992564
    last  calculated eigval = 0.031438006023042
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.85820586099256
lambda[   2] =  -0.56264372348536
lambda[   3] =  -0.35007016256641
lambda[   4] =  -0.34072950309193
lambda[   5] =  -0.34071460490324
lambda[   6] =  -0.04875847930984
lambda[   7] =  -0.04787438306628
lambda[   8] =  -0.02475705054387
lambda[   9] =   0.00126420158013
lambda[  10] =   0.02954053867291
lambda[  11] =   0.03143800602304
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.070 ms
rank =  0, Distributing orbital back into band + domain format took 8.024 ms
rank = 0, Subspace_Rotation used 11.106 ms

Total time for subspace rotation: 11.112 ms
rank = 0, Efermi =  -0.079804032373 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 2.885 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.821 ms
rank = 0, Calculating density took 928.038 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 3.037 ms
rank = 0, D2D took 3.145 ms
rank = 0, Transfering density took 3.150 ms
Etot    =   -16.951857701929
Eband   =    -4.904727710231
E1      =    11.170490635213
E2      =    -4.595296214627
E3      =    -5.952787886269
Exc     =    -5.392447205234
Esc     =   -28.373257522473
Entropy =    -0.000000000100
dE = 6.956e-04, dEband = 2.940e-02
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -16.951857702, dEtot = 6.956e-04, dEband = 2.940e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1712186422833, which took 0.086 ms

iter_count = 108, r_2norm = 7.374e-05, tol*||rhs|| = 8.685e-05

Anderson update took 63.743 ms, out of which F'*F took 29.515 ms; b-Ax took 203.601 ms, out of which Lap took 182.565 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.830 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312719, int_b + int_rho = -1.965e-13, checking this took 0.126 ms
2-norm of RHS = 420.3308270786403, which took 0.131 ms

iter_count = 258, r_2norm = 3.641e-04, tol*||rhs|| = 4.203e-04

Anderson update took 151.964 ms, out of which F'*F took 72.721 ms; b-Ax took 485.734 ms, out of which Lap took 438.086 ms
Solving Poisson took 1058.624 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.087717 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.084536 
Total time for convolution: 	 convolve: 5.081670 
Total time for convolution: 	 convolve: 5.102755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.502 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.597 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.931 ms

This SCF took 26785.593 ms, scf error = 1.683e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.131438, lowerbound = -0.858206, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 865.033 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.969 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.934 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.922 ms
rank =  0, finding HY took 14.457 ms
rank =  0, distributing HY into block cyclic form took 7.953 ms
rank =  0, finding Y'*HY took 2.712 ms
Rank 0, Project_Hamiltonian used 35.080 ms
Total time for projection: 35.094 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.853167862956245
    last  calculated eigval = 0.028864384817331
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.85316786295625
lambda[   2] =  -0.56110239982175
lambda[   3] =  -0.34387410682699
lambda[   4] =  -0.33708876234229
lambda[   5] =  -0.33708274026181
lambda[   6] =  -0.04638717706003
lambda[   7] =  -0.04600924897694
lambda[   8] =  -0.02752177429295
lambda[   9] =   0.00043873339907
lambda[  10] =   0.02740478585236
lambda[  11] =   0.02886438481733
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 3.078 ms
rank =  0, Distributing orbital back into band + domain format took 8.046 ms
rank = 0, Subspace_Rotation used 11.136 ms

Total time for subspace rotation: 11.142 ms
rank = 0, Efermi =  -0.077597387681 calculate fermi energy took 0.872 ms
rank = 0, --- Calculate rho: sum over local bands took 2.963 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.864 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.561 ms
rank = 0, Calculating density took 928.504 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.952 ms
rank = 0, Transfering density took 1.960 ms
Etot    =   -16.951164443597
Eband   =    -4.864631744563
E1      =    11.149328616589
E2      =    -4.574127558514
E3      =    -5.963571984047
Exc     =    -5.400303335609
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 2.311e-04, dEband = 1.337e-02
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -16.951164444, dEtot = 2.311e-04, dEband = 1.337e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5914947392892, which took 0.061 ms

iter_count = 114, r_2norm = 1.701e-05, tol*||rhs|| = 2.366e-05

Anderson update took 65.909 ms, out of which F'*F took 31.556 ms; b-Ax took 216.034 ms, out of which Lap took 191.575 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.445 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312719, int_b + int_rho = -1.983e-13, checking this took 0.125 ms
2-norm of RHS = 421.0505347078613, which took 0.168 ms

iter_count = 258, r_2norm = 4.176e-04, tol*||rhs|| = 4.211e-04

Anderson update took 150.928 ms, out of which F'*F took 71.939 ms; b-Ax took 483.871 ms, out of which Lap took 435.288 ms
Solving Poisson took 1059.303 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.086754 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.090648 
Total time for convolution: 	 convolve: 5.090929 
Total time for convolution: 	 convolve: 5.085992 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.690 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.897 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.478 ms

This SCF took 26811.535 ms, scf error = 1.125e-02
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.128864, lowerbound = -0.853168, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.844 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.105 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.851 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.979 ms
rank =  0, finding HY took 14.436 ms
rank =  0, distributing HY into block cyclic form took 7.983 ms
rank =  0, finding Y'*HY took 2.630 ms
Rank 0, Project_Hamiltonian used 35.079 ms
Total time for projection: 35.094 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.852328372886664
    last  calculated eigval = 0.027749164711807
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.85232837288666
lambda[   2] =  -0.55967164027140
lambda[   3] =  -0.34104411569150
lambda[   4] =  -0.33570791484595
lambda[   5] =  -0.33570399289405
lambda[   6] =  -0.04548580320741
lambda[   7] =  -0.04531769392046
lambda[   8] =  -0.02914412867638
lambda[   9] =   0.00060996708199
lambda[  10] =   0.02659729583898
lambda[  11] =   0.02774916471181
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 3.085 ms
rank =  0, Distributing orbital back into band + domain format took 8.095 ms
rank = 0, Subspace_Rotation used 12.190 ms

Total time for subspace rotation: 12.198 ms
rank = 0, Efermi =  -0.076784437921 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.682 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.541 ms
rank = 0, Calculating density took 927.710 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.954 ms
rank = 0, Transfering density took 1.957 ms
Etot    =   -16.950581113202
Eband   =    -4.848912073321
E1      =    11.156698624448
E2      =    -4.549891272835
E3      =    -5.966171413978
Exc     =    -5.401172828568
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.944e-04, dEband = 5.240e-03
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -16.950581113, dEtot = 1.944e-04, dEband = 5.240e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5086512551630, which took 1.041 ms

iter_count = 108, r_2norm = 1.622e-05, tol*||rhs|| = 2.035e-05

Anderson update took 62.776 ms, out of which F'*F took 30.454 ms; b-Ax took 201.849 ms, out of which Lap took 181.118 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.584 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312719, int_b + int_rho = -1.928e-13, checking this took 0.160 ms
2-norm of RHS = 421.0604275510323, which took 0.221 ms

iter_count = 264, r_2norm = 4.134e-04, tol*||rhs|| = 4.211e-04

Anderson update took 152.993 ms, out of which F'*F took 73.520 ms; b-Ax took 494.426 ms, out of which Lap took 444.260 ms
Solving Poisson took 1076.226 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.628 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.092731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.077736 
Total time for convolution: 	 convolve: 5.089463 
Total time for convolution: 	 convolve: 5.085968 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.094 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.894 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.440 ms

This SCF took 26823.781 ms, scf error = 4.833e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.127749, lowerbound = -0.852328, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 865.336 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.043 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.892 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.971 ms
rank =  0, finding HY took 14.368 ms
rank =  0, distributing HY into block cyclic form took 8.005 ms
rank =  0, finding Y'*HY took 2.596 ms
Rank 0, Project_Hamiltonian used 34.991 ms
Total time for projection: 35.007 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -0.846967007914337
    last  calculated eigval = 0.026632929173179
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84696700791434
lambda[   2] =  -0.55796027525791
lambda[   3] =  -0.33519912049434
lambda[   4] =  -0.33102736562468
lambda[   5] =  -0.33102705103706
lambda[   6] =  -0.04263302110619
lambda[   7] =  -0.04255765447713
lambda[   8] =  -0.03044508375035
lambda[   9] =   0.00017115326403
lambda[  10] =   0.02620566369687
lambda[  11] =   0.02663292917318
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 3.085 ms
rank =  0, Distributing orbital back into band + domain format took 8.568 ms
rank = 0, Subspace_Rotation used 11.680 ms

Total time for subspace rotation: 11.687 ms
rank = 0, Efermi =  -0.073974753901 calculate fermi energy took 0.084 ms
rank = 0, --- Calculate rho: sum over local bands took 2.953 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.745 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.546 ms
rank = 0, Calculating density took 928.756 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.870 ms
rank = 0, D2D took 1.976 ms
rank = 0, Transfering density took 1.984 ms
Etot    =   -16.950409019877
Eband   =    -4.804361640790
E1      =    11.132424951955
E2      =    -4.527594669011
E3      =    -5.974011616525
Exc     =    -5.406821094004
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 5.736e-05, dEband = 1.485e-02
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -16.950409020, dEtot = 5.736e-05, dEband = 1.485e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2554490914649, which took 0.063 ms

iter_count = 114, r_2norm = 7.059e-06, tol*||rhs|| = 1.022e-05

Anderson update took 66.486 ms, out of which F'*F took 31.821 ms; b-Ax took 213.905 ms, out of which Lap took 191.095 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.946 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.110e-13, checking this took 0.135 ms
2-norm of RHS = 421.1514120810310, which took 0.099 ms

iter_count = 222, r_2norm = 3.797e-04, tol*||rhs|| = 4.212e-04

Anderson update took 132.394 ms, out of which F'*F took 61.693 ms; b-Ax took 409.110 ms, out of which Lap took 368.678 ms
Solving Poisson took 904.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.091761 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.094180 
Total time for convolution: 	 convolve: 5.083732 
Total time for convolution: 	 convolve: 5.084567 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.736 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.426 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.883 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.410 ms

This SCF took 26966.850 ms, scf error = 2.615e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.126633, lowerbound = -0.846967, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 869.173 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.940 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.956 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.915 ms
rank =  0, finding HY took 14.304 ms
rank =  0, distributing HY into block cyclic form took 8.088 ms
rank =  0, finding Y'*HY took 2.599 ms
Rank 0, Project_Hamiltonian used 34.963 ms
Total time for projection: 34.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.847253416469420
    last  calculated eigval = 0.026292502617360
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84725341646942
lambda[   2] =  -0.55777300092734
lambda[   3] =  -0.33514472818013
lambda[   4] =  -0.33092314382143
lambda[   5] =  -0.33092311948335
lambda[   6] =  -0.04238966045561
lambda[   7] =  -0.04236529622732
lambda[   8] =  -0.03022786116049
lambda[   9] =   0.00018625269211
lambda[  10] =   0.02589756884613
lambda[  11] =   0.02629250261736
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 2.982 ms
rank =  0, Distributing orbital back into band + domain format took 8.449 ms
rank = 0, Subspace_Rotation used 11.451 ms

Total time for subspace rotation: 11.457 ms
rank = 0, Efermi =  -0.073756156127 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 2.928 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.825 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.564 ms
rank = 0, Calculating density took 932.363 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.891 ms
rank = 0, D2D took 1.988 ms
rank = 0, Transfering density took 1.990 ms
Etot    =   -16.950499991118
Eband   =    -4.804034817896
E1      =    11.135922130172
E2      =    -4.523794278183
E3      =    -5.972836997165
Exc     =    -5.405761056168
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 3.032e-05, dEband = 1.089e-04
rank = 0, Calculating/Estimating energy took 1.009 ms, Etot = -16.950499991, dEtot = 3.032e-05, dEband = 1.089e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1574716931043, which took 0.059 ms

iter_count = 108, r_2norm = 4.773e-06, tol*||rhs|| = 6.299e-06

Anderson update took 63.561 ms, out of which F'*F took 29.636 ms; b-Ax took 201.207 ms, out of which Lap took 179.344 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 450.928 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312715, int_b + int_rho = -2.401e-13, checking this took 0.111 ms
2-norm of RHS = 421.0943002886185, which took 0.142 ms

iter_count = 240, r_2norm = 4.153e-04, tol*||rhs|| = 4.211e-04

Anderson update took 141.888 ms, out of which F'*F took 71.907 ms; b-Ax took 447.038 ms, out of which Lap took 401.053 ms
Solving Poisson took 987.774 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.096345 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
Total time for convolution: 	 convolve: 5.090358 
Total time for convolution: 	 convolve: 5.085077 
Total time for convolution: 	 convolve: 5.091044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.027 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
---Transfer Veff_loc: D2D took 3.421 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.827 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.279 ms

This SCF took 26730.654 ms, scf error = 1.962e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.126293, lowerbound = -0.847253, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.682 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.981 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.917 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.928 ms
rank =  0, finding HY took 14.324 ms
rank =  0, distributing HY into block cyclic form took 8.002 ms
rank =  0, finding Y'*HY took 2.603 ms
Rank 0, Project_Hamiltonian used 34.914 ms
Total time for projection: 34.932 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.844422328582083
    last  calculated eigval = 0.028656914005187
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84442232858208
lambda[   2] =  -0.55582883419203
lambda[   3] =  -0.33271773281468
lambda[   4] =  -0.32842768235606
lambda[   5] =  -0.32842727818053
lambda[   6] =  -0.03946791572840
lambda[   7] =  -0.03946572404839
lambda[   8] =  -0.02610959250471
lambda[   9] =   0.00437112811626
lambda[  10] =   0.02832839384839
lambda[  11] =   0.02865691400519
==subpsace eigenproblem: bcast eigvals took 0.040 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 2.992 ms
rank =  0, Distributing orbital back into band + domain format took 8.505 ms
rank = 0, Subspace_Rotation used 11.514 ms

Total time for subspace rotation: 11.521 ms
rank = 0, Efermi =  -0.070845412256 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 2.953 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.811 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.540 ms
rank = 0, Calculating density took 930.892 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.878 ms
rank = 0, D2D took 1.984 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -16.950529472505
Eband   =    -4.779647712374
E1      =    11.122215979514
E2      =    -4.512395540176
E3      =    -5.976277004707
Exc     =    -5.408512761954
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 9.827e-06, dEband = 8.129e-03
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -16.950529473, dEtot = 9.827e-06, dEband = 8.129e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1322314978653, which took 2.021 ms

iter_count = 108, r_2norm = 4.926e-06, tol*||rhs|| = 5.289e-06

Anderson update took 64.762 ms, out of which F'*F took 30.629 ms; b-Ax took 219.270 ms, out of which Lap took 198.571 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.854 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312715, int_b + int_rho = -2.346e-13, checking this took 0.118 ms
2-norm of RHS = 421.0918495047171, which took 0.206 ms

iter_count = 174, r_2norm = 3.574e-04, tol*||rhs|| = 4.211e-04

Anderson update took 103.319 ms, out of which F'*F took 48.814 ms; b-Ax took 324.656 ms, out of which Lap took 291.105 ms
Solving Poisson took 713.112 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.086671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.094631 
Total time for convolution: 	 convolve: 5.101289 
Total time for convolution: 	 convolve: 5.080776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.865 ms
---Transfer Veff_loc: D2D took 3.484 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.043 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.560 ms

This SCF took 26467.802 ms, scf error = 1.057e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128657, lowerbound = -0.844422, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 866.861 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.939 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.920 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.885 ms
rank =  0, finding HY took 14.344 ms
rank =  0, distributing HY into block cyclic form took 7.974 ms
rank =  0, finding Y'*HY took 2.604 ms
Rank 0, Project_Hamiltonian used 34.861 ms
Total time for projection: 34.879 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.260 ms
    first calculated eigval = -0.844040566027600
    last  calculated eigval = 0.028680927301051
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84404056602760
lambda[   2] =  -0.55555759469213
lambda[   3] =  -0.33233683521972
lambda[   4] =  -0.32808467921171
lambda[   5] =  -0.32808430418090
lambda[   6] =  -0.03910831145921
lambda[   7] =  -0.03910818811399
lambda[   8] =  -0.02554174480186
lambda[   9] =   0.00479543136085
lambda[  10] =   0.02833720738110
lambda[  11] =   0.02868092730105
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.282 ms
rank =  0, subspace rotation using ScaLAPACK took 3.020 ms
rank =  0, Distributing orbital back into band + domain format took 8.500 ms
rank = 0, Subspace_Rotation used 11.541 ms

Total time for subspace rotation: 11.548 ms
rank = 0, Efermi =  -0.070486841591 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 2.906 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.891 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 930.074 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.860 ms
rank = 0, D2D took 1.959 ms
rank = 0, Transfering density took 1.961 ms
Etot    =   -16.950562980487
Eband   =    -4.776207958786
E1      =    11.120177921292
E2      =    -4.510839069964
E3      =    -5.976853002512
Exc     =    -5.408967492894
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.117e-05, dEband = 1.147e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -16.950562980, dEtot = 1.117e-05, dEband = 1.147e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0618132921862, which took 0.070 ms

iter_count = 108, r_2norm = 2.241e-06, tol*||rhs|| = 2.473e-06

Anderson update took 63.398 ms, out of which F'*F took 30.004 ms; b-Ax took 201.437 ms, out of which Lap took 178.827 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 451.231 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312716, int_b + int_rho = -2.274e-13, checking this took 0.119 ms
2-norm of RHS = 421.1262335926357, which took 0.140 ms

iter_count = 222, r_2norm = 3.779e-04, tol*||rhs|| = 4.211e-04

Anderson update took 130.805 ms, out of which F'*F took 61.281 ms; b-Ax took 410.037 ms, out of which Lap took 367.225 ms
Solving Poisson took 905.887 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.085644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.110988 
Total time for convolution: 	 convolve: 5.109097 
Total time for convolution: 	 convolve: 5.096510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.896 ms
---Transfer Veff_loc: D2D took 3.512 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.354 ms

This SCF took 26677.775 ms, scf error = 8.795e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128681, lowerbound = -0.844041, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.355 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.886 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.887 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.794 ms
rank =  0, finding HY took 14.397 ms
rank =  0, distributing HY into block cyclic form took 8.021 ms
rank =  0, finding Y'*HY took 2.609 ms
Rank 0, Project_Hamiltonian used 35.371 ms
Total time for projection: 35.387 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.598 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.701 ms
    first calculated eigval = -0.842853434716379
    last  calculated eigval = 0.032829549146582
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84285343471638
lambda[   2] =  -0.55419592555508
lambda[   3] =  -0.33113335085932
lambda[   4] =  -0.32682727616267
lambda[   5] =  -0.32682708023737
lambda[   6] =  -0.03718143233158
lambda[   7] =  -0.03717729881560
lambda[   8] =  -0.01883329094384
lambda[   9] =   0.00975685375744
lambda[  10] =   0.03189957965240
lambda[  11] =   0.03282954914658
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.727 ms
rank =  0, subspace rotation using ScaLAPACK took 3.070 ms
rank =  0, Distributing orbital back into band + domain format took 8.074 ms
rank = 0, Subspace_Rotation used 11.162 ms

Total time for subspace rotation: 11.168 ms
rank = 0, Efermi =  -0.068557959520 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 2.961 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.712 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 931.018 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.874 ms
rank = 0, D2D took 1.971 ms
rank = 0, Transfering density took 1.974 ms
Etot    =   -16.950661942049
Eband   =    -4.763674135178
E1      =    11.114358849909
E2      =    -4.503764709628
E3      =    -5.978199806270
Exc     =    -5.410053650104
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 3.299e-05, dEband = 4.178e-03
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -16.950661942, dEtot = 3.299e-05, dEband = 4.178e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0576237721489, which took 0.117 ms

iter_count = 114, r_2norm = 1.502e-06, tol*||rhs|| = 2.305e-06

Anderson update took 67.497 ms, out of which F'*F took 31.723 ms; b-Ax took 212.276 ms, out of which Lap took 190.149 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.644 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.055e-13, checking this took 0.106 ms
2-norm of RHS = 421.1264322047724, which took 0.154 ms

iter_count = 162, r_2norm = 3.448e-04, tol*||rhs|| = 4.211e-04

Anderson update took 96.939 ms, out of which F'*F took 47.026 ms; b-Ax took 301.306 ms, out of which Lap took 270.477 ms
Solving Poisson took 666.442 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.092260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.191 ms
Total time for convolution: 	 convolve: 5.091593 
Total time for convolution: 	 convolve: 5.098093 
Total time for convolution: 	 convolve: 5.086960 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.012 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.467 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.811 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.311 ms

This SCF took 26420.021 ms, scf error = 6.126e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132830, lowerbound = -0.842853, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.376 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.849 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.898 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.758 ms
rank =  0, finding HY took 14.506 ms
rank =  0, distributing HY into block cyclic form took 7.988 ms
rank =  0, finding Y'*HY took 2.608 ms
Rank 0, Project_Hamiltonian used 35.489 ms
Total time for projection: 35.501 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.842673743577282
    last  calculated eigval = 0.033457992303783
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84267374357728
lambda[   2] =  -0.55408963184680
lambda[   3] =  -0.33093800065656
lambda[   4] =  -0.32666473750951
lambda[   5] =  -0.32666455630234
lambda[   6] =  -0.03700651278675
lambda[   7] =  -0.03700341224026
lambda[   8] =  -0.01787058867017
lambda[   9] =   0.01047393199007
lambda[  10] =   0.03228826155171
lambda[  11] =   0.03345799230378
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 3.033 ms
rank =  0, Distributing orbital back into band + domain format took 8.046 ms
rank = 0, Subspace_Rotation used 11.089 ms

Total time for subspace rotation: 11.095 ms
rank = 0, Efermi =  -0.068383555434 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.927 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.843 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 926.621 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.889 ms
rank = 0, D2D took 1.994 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -16.950678019386
Eband   =    -4.762061339901
E1      =    11.113602746212
E2      =    -4.502871126934
E3      =    -5.978321900930
Exc     =    -5.410154930986
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 5.359e-06, dEband = 5.376e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -16.950678019, dEtot = 5.359e-06, dEband = 5.376e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0578673554102, which took 0.158 ms

iter_count = 114, r_2norm = 1.488e-06, tol*||rhs|| = 2.315e-06

Anderson update took 67.329 ms, out of which F'*F took 32.182 ms; b-Ax took 214.363 ms, out of which Lap took 191.736 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.134 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.055e-13, checking this took 0.128 ms
2-norm of RHS = 421.1267481448583, which took 0.154 ms

iter_count = 156, r_2norm = 4.062e-04, tol*||rhs|| = 4.211e-04

Anderson update took 91.405 ms, out of which F'*F took 43.777 ms; b-Ax took 291.807 ms, out of which Lap took 261.161 ms
Solving Poisson took 640.489 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.100821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.606 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.083630 
Total time for convolution: 	 convolve: 5.089112 
Total time for convolution: 	 convolve: 5.096721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.805 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.315 ms

This SCF took 26394.943 ms, scf error = 4.963e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133458, lowerbound = -0.842674, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 865.114 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 8.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.834 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.413 ms
rank =  0, finding HY took 14.386 ms
rank =  0, distributing HY into block cyclic form took 7.961 ms
rank =  0, finding Y'*HY took 2.618 ms
Rank 0, Project_Hamiltonian used 35.817 ms
Total time for projection: 35.831 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.842499333341480
    last  calculated eigval = 0.034248694183137
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84249933334148
lambda[   2] =  -0.55396506153914
lambda[   3] =  -0.33077548089758
lambda[   4] =  -0.32650571830345
lambda[   5] =  -0.32650560543949
lambda[   6] =  -0.03689805066157
lambda[   7] =  -0.03689597089152
lambda[   8] =  -0.01694572736817
lambda[   9] =   0.01090585376733
lambda[  10] =   0.03268688378747
lambda[  11] =   0.03424869418314
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 3.064 ms
rank =  0, Distributing orbital back into band + domain format took 8.178 ms
rank = 0, Subspace_Rotation used 11.252 ms

Total time for subspace rotation: 11.258 ms
rank = 0, Efermi =  -0.068275603304 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 2.959 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 928.743 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.878 ms
rank = 0, D2D took 1.974 ms
rank = 0, Transfering density took 1.976 ms
Etot    =   -16.950704223647
Eband   =    -4.760502399158
E1      =    11.112879152385
E2      =    -4.502001541322
E3      =    -5.978393196213
Exc     =    -5.410218191835
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 8.735e-06, dEband = 5.196e-04
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -16.950704224, dEtot = 8.735e-06, dEband = 5.196e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0670387978095, which took 0.068 ms

iter_count = 102, r_2norm = 2.584e-06, tol*||rhs|| = 2.682e-06

Anderson update took 60.421 ms, out of which F'*F took 28.543 ms; b-Ax took 188.769 ms, out of which Lap took 168.917 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 425.385 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.146e-13, checking this took 0.155 ms
2-norm of RHS = 421.1300131018591, which took 0.106 ms

iter_count = 192, r_2norm = 4.045e-04, tol*||rhs|| = 4.211e-04

Anderson update took 113.471 ms, out of which F'*F took 53.427 ms; b-Ax took 355.692 ms, out of which Lap took 318.985 ms
Solving Poisson took 785.803 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.265 ms
Total time for convolution: 	 convolve: 5.090007 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.120701 
Total time for convolution: 	 convolve: 5.108731 
Total time for convolution: 	 convolve: 5.099618 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.837 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.856 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.345 ms

This SCF took 26530.646 ms, scf error = 4.534e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134249, lowerbound = -0.842499, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 863.607 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.836 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.951 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.800 ms
rank =  0, finding HY took 14.352 ms
rank =  0, distributing HY into block cyclic form took 7.998 ms
rank =  0, finding Y'*HY took 2.588 ms
Rank 0, Project_Hamiltonian used 34.762 ms
Total time for projection: 34.776 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.842515558081183
    last  calculated eigval = 0.036537029216253
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84251555808118
lambda[   2] =  -0.55384108891469
lambda[   3] =  -0.33081902046435
lambda[   4] =  -0.32646664476572
lambda[   5] =  -0.32646654478466
lambda[   6] =  -0.03706860018470
lambda[   7] =  -0.03706699181970
lambda[   8] =  -0.01530317826311
lambda[   9] =   0.00968738540363
lambda[  10] =   0.03365000699472
lambda[  11] =   0.03653702921625
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 3.073 ms
rank =  0, Distributing orbital back into band + domain format took 8.009 ms
rank = 0, Subspace_Rotation used 11.093 ms

Total time for subspace rotation: 11.100 ms
rank = 0, Efermi =  -0.068446387770 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 2.945 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.550 ms
rank = 0, Calculating density took 926.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.865 ms
rank = 0, D2D took 1.971 ms
rank = 0, Transfering density took 1.974 ms
Etot    =   -16.950763915897
Eband   =    -4.760217714137
E1      =    11.113234283726
E2      =    -4.501438211959
E3      =    -5.977856354502
Exc     =    -5.409817529372
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.990e-05, dEband = 9.490e-05
rank = 0, Calculating/Estimating energy took 1.005 ms, Etot = -16.950763916, dEtot = 1.990e-05, dEband = 9.490e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0662736958381, which took 0.123 ms

iter_count = 108, r_2norm = 1.758e-06, tol*||rhs|| = 2.651e-06

Anderson update took 63.344 ms, out of which F'*F took 29.602 ms; b-Ax took 201.158 ms, out of which Lap took 179.215 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 451.112 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312719, int_b + int_rho = -2.019e-13, checking this took 0.132 ms
2-norm of RHS = 421.1248210637950, which took 0.129 ms

iter_count = 156, r_2norm = 4.042e-04, tol*||rhs|| = 4.211e-04

Anderson update took 91.634 ms, out of which F'*F took 43.147 ms; b-Ax took 290.090 ms, out of which Lap took 259.888 ms
Solving Poisson took 639.041 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Total time for convolution: 	 convolve: 5.094938 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.109374 
Total time for convolution: 	 convolve: 5.092500 
Total time for convolution: 	 convolve: 5.089768 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.026 ms
======D2D: initiated sending and receiving took 8.389 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.843 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.944 ms

This SCF took 26706.499 ms, scf error = 5.855e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136537, lowerbound = -0.842516, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 859.918 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.958 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.894 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.867 ms
rank =  0, finding HY took 14.371 ms
rank =  0, distributing HY into block cyclic form took 7.953 ms
rank =  0, finding Y'*HY took 2.567 ms
Rank 0, Project_Hamiltonian used 34.798 ms
Total time for projection: 34.810 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.842226875791520
    last  calculated eigval = 0.035958424124749
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84222687579152
lambda[   2] =  -0.55370104347847
lambda[   3] =  -0.33053557342635
lambda[   4] =  -0.32622709094999
lambda[   5] =  -0.32622696709320
lambda[   6] =  -0.03684203231462
lambda[   7] =  -0.03684064734806
lambda[   8] =  -0.01561053579433
lambda[   9] =   0.00993212333096
lambda[  10] =   0.03325881173073
lambda[  11] =   0.03595842412475
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.072 ms
rank =  0, Distributing orbital back into band + domain format took 8.000 ms
rank = 0, Subspace_Rotation used 11.085 ms

Total time for subspace rotation: 11.091 ms
rank = 0, Efermi =  -0.068219931905 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 2.936 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.778 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.542 ms
rank = 0, Calculating density took 922.410 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.865 ms
rank = 0, D2D took 1.969 ms
rank = 0, Transfering density took 1.971 ms
Etot    =   -16.950759455426
Eband   =    -4.757835101594
E1      =    11.111694444140
E2      =    -4.500480699090
E3      =    -5.978377365341
Exc     =    -5.410219339829
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.487e-06, dEband = 7.942e-04
rank = 0, Calculating/Estimating energy took 1.000 ms, Etot = -16.950759455, dEtot = 1.487e-06, dEband = 7.942e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0660702185292, which took 0.083 ms

iter_count = 108, r_2norm = 1.792e-06, tol*||rhs|| = 2.643e-06

Anderson update took 63.896 ms, out of which F'*F took 30.743 ms; b-Ax took 203.444 ms, out of which Lap took 182.242 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 452.724 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312720, int_b + int_rho = -1.910e-13, checking this took 0.138 ms
2-norm of RHS = 421.1233688291733, which took 0.181 ms

iter_count = 156, r_2norm = 3.515e-04, tol*||rhs|| = 4.211e-04

Anderson update took 92.111 ms, out of which F'*F took 44.063 ms; b-Ax took 291.511 ms, out of which Lap took 261.187 ms
Solving Poisson took 639.760 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.090683 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.008 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.083870 
Total time for convolution: 	 convolve: 5.097207 
Total time for convolution: 	 convolve: 5.099064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 4.708 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.852 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.597 ms

This SCF took 26349.030 ms, scf error = 4.212e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135958, lowerbound = -0.842227, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 865.107 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.906 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.925 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.849 ms
rank =  0, finding HY took 14.387 ms
rank =  0, distributing HY into block cyclic form took 8.077 ms
rank =  0, finding Y'*HY took 2.585 ms
Rank 0, Project_Hamiltonian used 34.951 ms
Total time for projection: 34.965 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.841898875426031
    last  calculated eigval = 0.036754269033474
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84189887542603
lambda[   2] =  -0.55348063715825
lambda[   3] =  -0.33022334615273
lambda[   4] =  -0.32594080658383
lambda[   5] =  -0.32594067331805
lambda[   6] =  -0.03667019283061
lambda[   7] =  -0.03666915866145
lambda[   8] =  -0.01481720572047
lambda[   9] =   0.00989219639191
lambda[  10] =   0.03355560541027
lambda[  11] =   0.03675426903347
==subpsace eigenproblem: bcast eigvals took 0.090 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 3.068 ms
rank =  0, Distributing orbital back into band + domain format took 8.030 ms
rank = 0, Subspace_Rotation used 11.119 ms

Total time for subspace rotation: 11.126 ms
rank = 0, Efermi =  -0.068048267454 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 12.031 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.270 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.797 ms
rank = 0, Calculating density took 938.742 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.265 ms
rank = 0, D2D took 2.364 ms
rank = 0, Transfering density took 2.386 ms
Etot    =   -16.950776641598
Eband   =    -4.754968677392
E1      =    11.110014601610
E2      =    -4.499159770450
E3      =    -5.978884001770
Exc     =    -5.410608815461
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 5.729e-06, dEband = 9.555e-04
rank = 0, Calculating/Estimating energy took 0.979 ms, Etot = -16.950776642, dEtot = 5.729e-06, dEband = 9.555e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569975229396, which took 0.068 ms

iter_count = 96, r_2norm = 2.216e-06, tol*||rhs|| = 2.280e-06

Anderson update took 56.124 ms, out of which F'*F took 27.019 ms; b-Ax took 179.285 ms, out of which Lap took 159.710 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.044 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.037e-13, checking this took 0.103 ms
2-norm of RHS = 421.1393678408789, which took 0.067 ms

iter_count = 186, r_2norm = 3.821e-04, tol*||rhs|| = 4.211e-04

Anderson update took 108.949 ms, out of which F'*F took 51.816 ms; b-Ax took 345.239 ms, out of which Lap took 309.371 ms
Solving Poisson took 758.720 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.102497 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.116497 
Total time for convolution: 	 convolve: 5.087468 
Total time for convolution: 	 convolve: 5.091665 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.128 ms
---Transfer Veff_loc: D2D took 4.341 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.854 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.228 ms

This SCF took 26632.554 ms, scf error = 2.931e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136754, lowerbound = -0.841899, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 864.856 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.996 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.879 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.898 ms
rank =  0, finding HY took 14.442 ms
rank =  0, distributing HY into block cyclic form took 7.981 ms
rank =  0, finding Y'*HY took 2.589 ms
Rank 0, Project_Hamiltonian used 34.956 ms
Total time for projection: 34.969 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.841914500716164
    last  calculated eigval = 0.038113910218970
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84191450071616
lambda[   2] =  -0.55332666857176
lambda[   3] =  -0.33027013644140
lambda[   4] =  -0.32592237888704
lambda[   5] =  -0.32592234602276
lambda[   6] =  -0.03694950570791
lambda[   7] =  -0.03694873983329
lambda[   8] =  -0.01416800038072
lambda[   9] =   0.00796346868584
lambda[  10] =   0.03416826790311
lambda[  11] =   0.03811391021897
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 3.013 ms
rank =  0, Distributing orbital back into band + domain format took 8.034 ms
rank = 0, Subspace_Rotation used 11.065 ms

Total time for subspace rotation: 11.071 ms
rank = 0, Efermi =  -0.068327714946 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.934 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.548 ms
rank = 0, Calculating density took 927.532 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.849 ms
rank = 0, D2D took 1.964 ms
rank = 0, Transfering density took 1.970 ms
Etot    =   -16.950813146267
Eband   =    -4.754712061394
E1      =    11.110312356292
E2      =    -4.498603921720
E3      =    -5.978669044396
Exc     =    -5.410428884707
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.217e-05, dEband = 8.554e-05
rank = 0, Calculating/Estimating energy took 1.003 ms, Etot = -16.950813146, dEtot = 1.217e-05, dEband = 8.554e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0509745709835, which took 0.103 ms

iter_count = 102, r_2norm = 1.240e-06, tol*||rhs|| = 2.039e-06

Anderson update took 60.183 ms, out of which F'*F took 28.140 ms; b-Ax took 190.285 ms, out of which Lap took 170.110 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 428.577 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.183e-13, checking this took 0.122 ms
2-norm of RHS = 421.1457833525363, which took 0.189 ms

iter_count = 132, r_2norm = 3.667e-04, tol*||rhs|| = 4.211e-04

Anderson update took 78.090 ms, out of which F'*F took 36.607 ms; b-Ax took 245.472 ms, out of which Lap took 219.259 ms
Solving Poisson took 541.373 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.109581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.093332 
Total time for convolution: 	 convolve: 5.134731 
Total time for convolution: 	 convolve: 5.084866 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.803 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.296 ms

This SCF took 26302.999 ms, scf error = 3.847e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138114, lowerbound = -0.841915, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 896.586 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.879 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.849 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.740 ms
rank =  0, finding HY took 14.915 ms
rank =  0, distributing HY into block cyclic form took 7.966 ms
rank =  0, finding Y'*HY took 2.600 ms
Rank 0, Project_Hamiltonian used 35.260 ms
Total time for projection: 35.275 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.842014694188049
    last  calculated eigval = 0.038217879299715
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84201469418805
lambda[   2] =  -0.55338661702567
lambda[   3] =  -0.33032037740327
lambda[   4] =  -0.32598893353947
lambda[   5] =  -0.32598892309274
lambda[   6] =  -0.03705332680651
lambda[   7] =  -0.03705277228340
lambda[   8] =  -0.01391782607645
lambda[   9] =   0.00774317979647
lambda[  10] =   0.03435177831025
lambda[  11] =   0.03821787929971
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 3.049 ms
rank =  0, Distributing orbital back into band + domain format took 7.988 ms
rank = 0, Subspace_Rotation used 11.047 ms

Total time for subspace rotation: 11.053 ms
rank = 0, Efermi =  -0.068431641403 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.925 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.750 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.532 ms
rank = 0, Calculating density took 959.446 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.877 ms
rank = 0, D2D took 1.981 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -16.950817853202
Eband   =    -4.755399090614
E1      =    11.110998823780
E2      =    -4.498652594535
E3      =    -5.978411458324
Exc     =    -5.410224116653
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.569e-06, dEband = 2.290e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -16.950817853, dEtot = 1.569e-06, dEband = 2.290e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0545103205391, which took 0.077 ms

iter_count = 96, r_2norm = 1.921e-06, tol*||rhs|| = 2.180e-06

Anderson update took 56.042 ms, out of which F'*F took 26.988 ms; b-Ax took 181.565 ms, out of which Lap took 161.602 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.679 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.092e-13, checking this took 0.139 ms
2-norm of RHS = 421.1458470448393, which took 0.159 ms

iter_count = 132, r_2norm = 3.926e-04, tol*||rhs|| = 4.211e-04

Anderson update took 76.622 ms, out of which F'*F took 36.792 ms; b-Ax took 246.938 ms, out of which Lap took 220.513 ms
Solving Poisson took 539.944 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.092813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.097088 
Total time for convolution: 	 convolve: 5.111690 
Total time for convolution: 	 convolve: 5.082728 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.455 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.818 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.305 ms

This SCF took 26240.825 ms, scf error = 5.163e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.138218, lowerbound = -0.842015, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.125 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.855 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.948 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.815 ms
rank =  0, finding HY took 14.360 ms
rank =  0, distributing HY into block cyclic form took 7.863 ms
rank =  0, finding Y'*HY took 2.600 ms
Rank 0, Project_Hamiltonian used 34.661 ms
Total time for projection: 34.672 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.842071990580801
    last  calculated eigval = 0.038607334373994
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84207199058080
lambda[   2] =  -0.55339959013817
lambda[   3] =  -0.33039608165048
lambda[   4] =  -0.32604124066499
lambda[   5] =  -0.32604116138665
lambda[   6] =  -0.03700340573387
lambda[   7] =  -0.03700247149671
lambda[   8] =  -0.01320529683118
lambda[   9] =   0.00818022769612
lambda[  10] =   0.03448111549764
lambda[  11] =   0.03860733437399
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.073 ms
rank =  0, Distributing orbital back into band + domain format took 11.652 ms
rank = 0, Subspace_Rotation used 14.738 ms

Total time for subspace rotation: 14.744 ms
rank = 0, Efermi =  -0.068381530687 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.962 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.539 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 932.913 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.859 ms
rank = 0, D2D took 1.963 ms
rank = 0, Transfering density took 1.966 ms
Etot    =   -16.950814087022
Eband   =    -4.755900128958
E1      =    11.111248388116
E2      =    -4.498932037476
E3      =    -5.978323461822
Exc     =    -5.410160322903
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.255e-06, dEband = 1.670e-04
rank = 0, Calculating/Estimating energy took 1.378 ms, Etot = -16.950814087, dEtot = 1.255e-06, dEband = 1.670e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0563377156610, which took 0.068 ms

iter_count = 96, r_2norm = 1.940e-06, tol*||rhs|| = 2.254e-06

Anderson update took 57.479 ms, out of which F'*F took 27.410 ms; b-Ax took 178.008 ms, out of which Lap took 159.785 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.994 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.146e-13, checking this took 0.128 ms
2-norm of RHS = 421.1455928150943, which took 0.147 ms

iter_count = 60, r_2norm = 3.949e-04, tol*||rhs|| = 4.211e-04

Anderson update took 35.325 ms, out of which F'*F took 16.799 ms; b-Ax took 111.318 ms, out of which Lap took 99.787 ms
Solving Poisson took 247.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.087430 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.092179 
Total time for convolution: 	 convolve: 5.109524 
Total time for convolution: 	 convolve: 5.087409 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.337 ms

This SCF took 25914.554 ms, scf error = 5.264e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.138607, lowerbound = -0.842072, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 872.576 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.874 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.934 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.822 ms
rank =  0, finding HY took 14.353 ms
rank =  0, distributing HY into block cyclic form took 7.982 ms
rank =  0, finding Y'*HY took 2.576 ms
Rank 0, Project_Hamiltonian used 34.769 ms
Total time for projection: 34.781 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.842067006134080
    last  calculated eigval = 0.038214841932474
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84206700613408
lambda[   2] =  -0.55339286319093
lambda[   3] =  -0.33039584288203
lambda[   4] =  -0.32603711295080
lambda[   5] =  -0.32603703700786
lambda[   6] =  -0.03701314601389
lambda[   7] =  -0.03701233606567
lambda[   8] =  -0.01349216881763
lambda[   9] =   0.00807844204251
lambda[  10] =   0.03406283679795
lambda[  11] =   0.03821484193247
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 3.070 ms
rank =  0, Distributing orbital back into band + domain format took 8.004 ms
rank = 0, Subspace_Rotation used 11.087 ms

Total time for subspace rotation: 11.093 ms
rank = 0, Efermi =  -0.068391333094 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 2.949 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.720 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.555 ms
rank = 0, Calculating density took 934.993 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.878 ms
rank = 0, D2D took 1.975 ms
rank = 0, Transfering density took 1.977 ms
Etot    =   -16.950817216804
Eband   =    -4.755859724447
E1      =    11.111214578566
E2      =    -4.498920200202
E3      =    -5.978333358943
Exc     =    -5.410168107494
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.043e-06, dEband = 1.347e-05
rank = 0, Calculating/Estimating energy took 1.753 ms, Etot = -16.950817217, dEtot = 1.043e-06, dEband = 1.347e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0506935310050, which took 0.051 ms

iter_count = 96, r_2norm = 1.948e-06, tol*||rhs|| = 2.028e-06

Anderson update took 55.840 ms, out of which F'*F took 26.059 ms; b-Ax took 179.310 ms, out of which Lap took 159.097 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 401.901 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312715, int_b + int_rho = -2.401e-13, checking this took 0.115 ms
2-norm of RHS = 421.1414299342611, which took 0.151 ms

iter_count = 120, r_2norm = 3.867e-04, tol*||rhs|| = 4.211e-04

Anderson update took 70.241 ms, out of which F'*F took 33.474 ms; b-Ax took 222.565 ms, out of which Lap took 199.211 ms
Solving Poisson took 491.611 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.093958 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.088633 
Total time for convolution: 	 convolve: 5.093618 
Total time for convolution: 	 convolve: 5.098740 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.479 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.484 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.993 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.512 ms

This SCF took 26173.807 ms, scf error = 5.321e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.138215, lowerbound = -0.842067, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 869.636 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.961 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.873 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.848 ms
rank =  0, finding HY took 14.439 ms
rank =  0, distributing HY into block cyclic form took 7.840 ms
rank =  0, finding Y'*HY took 2.594 ms
Rank 0, Project_Hamiltonian used 34.746 ms
Total time for projection: 34.757 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -0.841892837416989
    last  calculated eigval = 0.037740602531492
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84189283741699
lambda[   2] =  -0.55329026425533
lambda[   3] =  -0.33025055050512
lambda[   4] =  -0.32589901976643
lambda[   5] =  -0.32589896616012
lambda[   6] =  -0.03695586446877
lambda[   7] =  -0.03695506853474
lambda[   8] =  -0.01399616030556
lambda[   9] =   0.00775182492585
lambda[  10] =   0.03386337832725
lambda[  11] =   0.03774060253149
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 3.058 ms
rank =  0, Distributing orbital back into band + domain format took 8.028 ms
rank = 0, Subspace_Rotation used 11.108 ms

Total time for subspace rotation: 11.114 ms
rank = 0, Efermi =  -0.068334058330 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.881 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.820 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.563 ms
rank = 0, Calculating density took 932.121 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.788 ms
rank = 0, D2D took 2.886 ms
rank = 0, Transfering density took 2.889 ms
Etot    =   -16.950816195219
Eband   =    -4.754463276324
E1      =    11.110220221074
E2      =    -4.498438036143
E3      =    -5.978682964383
Exc     =    -5.410436617921
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 3.405e-07, dEband = 4.655e-04
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -16.950816195, dEtot = 3.405e-07, dEband = 4.655e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0365645125936, which took 0.134 ms

iter_count = 102, r_2norm = 1.121e-06, tol*||rhs|| = 1.463e-06

Anderson update took 60.652 ms, out of which F'*F took 28.819 ms; b-Ax took 191.963 ms, out of which Lap took 171.880 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 428.076 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.201e-13, checking this took 0.138 ms
2-norm of RHS = 421.1407652005490, which took 0.158 ms

iter_count = 126, r_2norm = 3.876e-04, tol*||rhs|| = 4.211e-04

Anderson update took 73.508 ms, out of which F'*F took 35.360 ms; b-Ax took 235.275 ms, out of which Lap took 210.642 ms
Solving Poisson took 515.690 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.086942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.092487 
Total time for convolution: 	 convolve: 5.088744 
Total time for convolution: 	 convolve: 5.125808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.459 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.047 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.539 ms

This SCF took 26384.029 ms, scf error = 3.786e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.137741, lowerbound = -0.841893, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.548 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.825 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.949 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.786 ms
rank =  0, finding HY took 14.390 ms
rank =  0, distributing HY into block cyclic form took 7.966 ms
rank =  0, finding Y'*HY took 2.599 ms
Rank 0, Project_Hamiltonian used 34.766 ms
Total time for projection: 34.778 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.841766631305278
    last  calculated eigval = 0.038113837229573
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84176663130528
lambda[   2] =  -0.55319200464010
lambda[   3] =  -0.33013682357373
lambda[   4] =  -0.32578806192850
lambda[   5] =  -0.32578801997989
lambda[   6] =  -0.03683270754311
lambda[   7] =  -0.03683184530350
lambda[   8] =  -0.01337253188601
lambda[   9] =   0.00809240967179
lambda[  10] =   0.03425774048464
lambda[  11] =   0.03811383722957
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.076 ms
rank =  0, Distributing orbital back into band + domain format took 7.987 ms
rank = 0, Subspace_Rotation used 11.074 ms

Total time for subspace rotation: 11.081 ms
rank = 0, Efermi =  -0.068210868579 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 2.922 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.541 ms
rank = 0, Calculating density took 929.960 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.415 ms
rank = 0, D2D took 2.512 ms
rank = 0, Transfering density took 2.515 ms
Etot    =   -16.950816993661
Eband   =    -4.753343082970
E1      =    11.109550374427
E2      =    -4.497938605947
E3      =    -5.978891092115
Exc     =    -5.410596460605
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 2.661e-07, dEband = 3.734e-04
rank = 0, Calculating/Estimating energy took 0.999 ms, Etot = -16.950816994, dEtot = 2.661e-07, dEband = 3.734e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0297231607383, which took 0.077 ms

iter_count = 102, r_2norm = 8.729e-07, tol*||rhs|| = 1.189e-06

Anderson update took 65.320 ms, out of which F'*F took 28.642 ms; b-Ax took 204.318 ms, out of which Lap took 183.392 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 444.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312718, int_b + int_rho = -2.037e-13, checking this took 0.119 ms
2-norm of RHS = 421.1374335414928, which took 0.175 ms

iter_count = 144, r_2norm = 4.014e-04, tol*||rhs|| = 4.211e-04

Anderson update took 84.078 ms, out of which F'*F took 39.534 ms; b-Ax took 268.906 ms, out of which Lap took 240.577 ms
Solving Poisson took 589.192 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.090586 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.091595 
Total time for convolution: 	 convolve: 5.082376 
Total time for convolution: 	 convolve: 5.088040 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.812 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.354 ms

This SCF took 26316.570 ms, scf error = 2.987e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.138114, lowerbound = -0.841767, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 867.328 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.930 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.877 ms
rank =  0, finding HY took 14.400 ms
rank =  0, distributing HY into block cyclic form took 8.083 ms
rank =  0, finding Y'*HY took 2.561 ms
Rank 0, Project_Hamiltonian used 34.959 ms
Total time for projection: 34.972 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.841546516390960
    last  calculated eigval = 0.036401600788630
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84154651639096
lambda[   2] =  -0.55301737581325
lambda[   3] =  -0.32998174640241
lambda[   4] =  -0.32560809330171
lambda[   5] =  -0.32560806983141
lambda[   6] =  -0.03682947685497
lambda[   7] =  -0.03682866697158
lambda[   8] =  -0.01542847916254
lambda[   9] =   0.00714266293214
lambda[  10] =   0.03322578482332
lambda[  11] =   0.03640160078863
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 3.061 ms
rank =  0, Distributing orbital back into band + domain format took 8.006 ms
rank = 0, Subspace_Rotation used 11.079 ms

Total time for subspace rotation: 11.085 ms
rank = 0, Efermi =  -0.068207663540 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 3.063 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.165 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.540 ms
rank = 0, Calculating density took 930.140 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.856 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -16.950824242977
Eband   =    -4.751523603595
E1      =    11.108338565751
E2      =    -4.497232097060
E3      =    -5.979285924774
Exc     =    -5.410899704393
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 2.416e-06, dEband = 6.065e-04
rank = 0, Calculating/Estimating energy took 1.142 ms, Etot = -16.950824243, dEtot = 2.416e-06, dEband = 6.065e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0453529205796, which took 0.067 ms

iter_count = 90, r_2norm = 1.673e-06, tol*||rhs|| = 1.814e-06

Anderson update took 52.872 ms, out of which F'*F took 24.570 ms; b-Ax took 168.378 ms, out of which Lap took 149.611 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 378.171 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.183e-13, checking this took 0.145 ms
2-norm of RHS = 421.1363533866058, which took 0.196 ms

iter_count = 144, r_2norm = 3.956e-04, tol*||rhs|| = 4.211e-04

Anderson update took 84.514 ms, out of which F'*F took 40.044 ms; b-Ax took 267.090 ms, out of which Lap took 239.003 ms
Solving Poisson took 588.945 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.085426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.087035 
Total time for convolution: 	 convolve: 5.097682 
Total time for convolution: 	 convolve: 5.084800 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.523 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 3.471 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.996 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.502 ms

This SCF took 26231.576 ms, scf error = 1.798e-04
-------------
SCF iter 24  
-------------

 Chebfilt 27, in Chebyshev filtering, lambda_cutoff = 0.136402, lowerbound = -0.841547, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 868.687 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.882 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.907 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.802 ms
rank =  0, finding HY took 14.417 ms
rank =  0, distributing HY into block cyclic form took 7.931 ms
rank =  0, finding Y'*HY took 2.574 ms
Rank 0, Project_Hamiltonian used 34.757 ms
Total time for projection: 34.768 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.841402194733782
    last  calculated eigval = 0.036360128760576
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84140219473378
lambda[   2] =  -0.55289445216690
lambda[   3] =  -0.32987882194315
lambda[   4] =  -0.32548804408104
lambda[   5] =  -0.32548803273955
lambda[   6] =  -0.03679902088491
lambda[   7] =  -0.03679837483807
lambda[   8] =  -0.01567263683803
lambda[   9] =   0.00693731275436
lambda[  10] =   0.03405832421471
lambda[  11] =   0.03636012876058
==subpsace eigenproblem: bcast eigvals took 0.072 ms
Total time for solving subspace eigenvalue problem: 0.254 ms
rank =  0, subspace rotation using ScaLAPACK took 3.067 ms
rank =  0, Distributing orbital back into band + domain format took 8.576 ms
rank = 0, Subspace_Rotation used 12.047 ms

Total time for subspace rotation: 12.052 ms
rank = 0, Efermi =  -0.068177289587 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 2.945 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.556 ms
rank = 0, Calculating density took 932.163 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.884 ms
rank = 0, D2D took 1.979 ms
rank = 0, Transfering density took 1.981 ms
Etot    =   -16.950825779592
Eband   =    -4.750303091444
E1      =    11.107605903731
E2      =    -4.496694650683
E3      =    -5.979494474924
Exc     =    -5.411060194911
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 5.122e-07, dEband = 4.068e-04
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -16.950825780, dEtot = 5.122e-07, dEband = 4.068e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0381426206334, which took 0.170 ms

iter_count = 90, r_2norm = 1.105e-06, tol*||rhs|| = 1.526e-06

Anderson update took 52.800 ms, out of which F'*F took 25.571 ms; b-Ax took 170.530 ms, out of which Lap took 152.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 379.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.165e-13, checking this took 0.133 ms
2-norm of RHS = 421.1357060078995, which took 0.110 ms

iter_count = 138, r_2norm = 3.790e-04, tol*||rhs|| = 4.211e-04

Anderson update took 80.333 ms, out of which F'*F took 38.284 ms; b-Ax took 257.467 ms, out of which Lap took 230.100 ms
Solving Poisson took 564.144 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.097158 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.095945 
Total time for convolution: 	 convolve: 5.086676 
Total time for convolution: 	 convolve: 5.092008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 3.484 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.005 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.523 ms

This SCF took 26228.114 ms, scf error = 1.165e-04
-------------
SCF iter 25  
-------------

 Chebfilt 28, in Chebyshev filtering, lambda_cutoff = 0.136360, lowerbound = -0.841402, upperbound = 267.565934

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 870.330 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.873 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.905 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.792 ms
rank =  0, finding HY took 14.610 ms
rank =  0, distributing HY into block cyclic form took 8.034 ms
rank =  0, finding Y'*HY took 2.573 ms
Rank 0, Project_Hamiltonian used 35.038 ms
Total time for projection: 35.050 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.841252659609145
    last  calculated eigval = 0.036511885645111
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 10):
lambda[   1] =  -0.84125265960914
lambda[   2] =  -0.55278686979311
lambda[   3] =  -0.32973335157792
lambda[   4] =  -0.32535607066665
lambda[   5] =  -0.32535604123539
lambda[   6] =  -0.03669203683507
lambda[   7] =  -0.03669182250239
lambda[   8] =  -0.01554327479445
lambda[   9] =   0.00711214839413
lambda[  10] =   0.03482018993001
lambda[  11] =   0.03651188564511
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 3.023 ms
rank =  0, Distributing orbital back into band + domain format took 8.411 ms
rank = 0, Subspace_Rotation used 11.447 ms

Total time for subspace rotation: 11.453 ms
rank = 0, Efermi =  -0.068070521241 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 2.943 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.672 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.538 ms
rank = 0, Calculating density took 933.356 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.858 ms
rank = 0, D2D took 1.953 ms
rank = 0, Transfering density took 1.956 ms
Etot    =   -16.950828865646
Eband   =    -4.748969985879
E1      =    11.106848918011
E2      =    -4.496066758945
E3      =    -5.979714547006
Exc     =    -5.411231581155
Esc     =   -28.373257522473
Entropy =    -0.000000000101
dE = 1.029e-06, dEband = 4.444e-04
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -16.950828866, dEtot = 1.029e-06, dEband = 4.444e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0145607194746, which took 0.062 ms

iter_count = 96, r_2norm = 4.666e-07, tol*||rhs|| = 5.824e-07

Anderson update took 56.780 ms, out of which F'*F took 27.370 ms; b-Ax took 178.316 ms, out of which Lap took 159.934 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.367 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -10.00000000312739, int_rho =  10.00000000312717, int_b + int_rho = -2.146e-13, checking this took 0.137 ms
2-norm of RHS = 421.1349220027687, which took 0.155 ms

iter_count = 66, r_2norm = 4.176e-04, tol*||rhs|| = 4.211e-04

Anderson update took 38.862 ms, out of which F'*F took 18.414 ms; b-Ax took 122.407 ms, out of which Lap took 109.791 ms
Solving Poisson took 271.579 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.090955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.385 ms
Total time for convolution: 	 convolve: 5.088583 
Total time for convolution: 	 convolve: 5.089175 
Total time for convolution: 	 convolve: 5.084163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.431 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.811 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.273 ms

This SCF took 25967.443 ms, scf error = 3.955e-05
The last 11 occupations of kpoints #1 are (Nelectron = 10):
lambda[   1] =  -0.84125265960914, occ[   1] =   2.00000000000000
lambda[   2] =  -0.55278686979311, occ[   2] =   2.00000000000000
lambda[   3] =  -0.32973335157792, occ[   3] =   2.00000000000000
lambda[   4] =  -0.32535607066665, occ[   4] =   2.00000000000000
lambda[   5] =  -0.32535604123539, occ[   5] =   2.00000000000000
lambda[   6] =  -0.03669203683507, occ[   6] =   0.00000000156379
lambda[   7] =  -0.03669182250239, occ[   7] =   0.00000000156339
lambda[   8] =  -0.01554327479445, occ[   8] =   0.00000000000000
lambda[   9] =   0.00711214839413, occ[   9] =   0.00000000000000
lambda[  10] =   0.03482018993001, occ[  10] =   0.00000000000000
lambda[  11] =   0.03651188564511, occ[  11] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 10 (90%) = 0.000000000000000.
Occupation of state 11 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.225 ms, time for Allreduce/Reduce: 4.436 ms 
Time for calculating local force components: 11.374 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000000539367  -0.00000000060812   0.05569455578504
  0.00000022058448   0.00000027959106   0.00537640544915
 -0.00000061310414  -0.00000139970798  -0.93954715128186
force_loc = 
 -0.00000003212325   0.00000000900608  -0.05960084053351
  0.00000013441087   0.00000040424197  -0.01413851068928
  0.00000013159066  -0.00000077249945   0.92077063350802
Time for calculating nonlocal force components: 23.776 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000388909   0.00000000334396   0.01765262193338
[0m[32m  0.00000000580998  -0.00000003760211   0.01375436620894
[0mTime for calculating XC forces components: 11.861 ms
 Cartesian force = 
  0.00000002111997   0.00000051314282  -0.00389364487509
  0.00000040673399   0.00000119192185   0.00890315656662
 -0.00000042785395  -0.00000170506468  -0.00500951169153
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.018 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 390.374 ms
The program took 693.300 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:40:49
Job ID:        2267035
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:21:48,vmem=8308K,walltime=00:11:49,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-16-1
---------------------------------------
