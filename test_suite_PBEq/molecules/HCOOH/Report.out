---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:12
Job ID:    2266634
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:18
Job ID:    2266634
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.052 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 7.978 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 13.525 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 100.376 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.952 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.096 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.926609	    9.050312	   10.000000	
   12.073391	   10.093824	   10.000000	
    9.166267	   12.624857	   10.000000	
    8.664567	    7.375143	   10.000000	
    9.879491	   10.683502	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.179 ms
Set up communicators.

--set up spincomm took 2.248 ms

--set up kptcomm took 0.338 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.096 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.015 ms

Calculate_SplineDerivRadFun took 0.221 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.796 ms.
time spent on vectorized spline interp: 3.664 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.685 ms.
time spent on vectorized spline interp: 1.716 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.324 ms.
time spent on vectorized spline interp: 1.976 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.512 ms.

Calculating rb for all atom types took 17.525 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.831 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.017 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000139275, sum_int_rho = 17.7972079656520
PosCharge = 18.000000013928, NegCharge = -17.797207965652, scal_fac = 1.011394599011
After scaling, int_rho = 18.0000000139274, PosCharge + NegCharge - NetCharge = 6.750e-14
--Calculate Vref took 0.355 ms
--Calculate rho_guess took 1.927 ms

 integral of b = -18.0000000139275,
 int{b} + Nelectron + NetCharge = -1.393e-08,
 Esc = -61.2882263408061,
 MPI_Reduce took 3.026 ms

Calculating b & b_ref took 10.615 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.029 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.038 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.024 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.161 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.948 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392748, int_b + int_rho = -1.128e-13, checking this took 0.096 ms
2-norm of RHS = 570.3333559106014, which took 0.071 ms

iter_count = 420, r_2norm = 5.046e-04, tol*||rhs|| = 5.703e-04

Anderson update took 285.442 ms, out of which F'*F took 123.572 ms; b-Ax took 855.189 ms, out of which Lap took 760.882 ms
Solving Poisson took 1935.697 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.857 ms
Total time for convolution: 	 convolve: 5.097553 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
Total time for convolution: 	 convolve: 5.112346 
Total time for convolution: 	 convolve: 5.099313 
Total time for convolution: 	 convolve: 5.102105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.263 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.347 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
rank = 0, XC calculation took 24280.623 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.165 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.822 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.133 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.851 ms
    Lanczos iter 53, eigmin  = -1.112299930, eigmax = 264.925866307, err_eigmin = 2.095e-04, err_eigmax = 9.680e-03
rank =   0, Lanczos took 134.121 ms, eigmin = -1.112299929761, eigmax = 267.575124970535

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.181413, lowerbound = -1.212300, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1487.025 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 20.176 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.067 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.334 ms
rank =  0, Distribute data + matrix mult took 25.602 ms
rank =  0, finding HY took 23.319 ms
rank =  0, distributing HY into block cyclic form took 14.858 ms
rank =  0, finding Y'*HY took 5.755 ms
Rank 0, Project_Hamiltonian used 69.586 ms
Total time for projection: 69.628 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.379 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.632 ms
rank = 0, Solve_Generalized_EigenProblem used 1.357 ms
    first calculated eigval = 2.804031468347746
    last  calculated eigval = 3.214251087260104
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.80403146834775
lambda[   2] =   2.83227267132318
lambda[   3] =   2.89228664830229
lambda[   4] =   2.93140830430755
lambda[   5] =   2.94299790406643
lambda[   6] =   2.94804356357778
lambda[   7] =   2.99319874021322
lambda[   8] =   3.01298587061692
lambda[   9] =   3.03705682433375
lambda[  10] =   3.07122474066839
lambda[  11] =   3.09809544564116
lambda[  12] =   3.11256772126419
lambda[  13] =   3.15054137761985
lambda[  14] =   3.15804077557348
lambda[  15] =   3.21425108726010
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 1.377 ms
rank =  0, subspace rotation using ScaLAPACK took 4.515 ms
rank =  0, Distributing orbital back into band + domain format took 15.448 ms
rank = 0, Subspace_Rotation used 19.989 ms

Total time for subspace rotation: 19.994 ms
rank = 0, Efermi =   3.054140792572 calculate fermi energy took 0.059 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.314251, lowerbound = -1.212300, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1426.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 19.614 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.855 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 23.507 ms
rank =  0, finding HY took 21.824 ms
rank =  0, distributing HY into block cyclic form took 14.946 ms
rank =  0, finding Y'*HY took 4.697 ms
Rank 0, Project_Hamiltonian used 65.023 ms
Total time for projection: 65.077 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.927687113744478
    last  calculated eigval = 0.445740379708281
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92768711374448
lambda[   2] =  -0.82169937373457
lambda[   3] =  -0.31321166985777
lambda[   4] =  -0.08923104021380
lambda[   5] =  -0.05791834568125
lambda[   6] =   0.06859431066202
lambda[   7] =   0.14528091051596
lambda[   8] =   0.19955492116554
lambda[   9] =   0.29011307970066
lambda[  10] =   0.33549335257320
lambda[  11] =   0.36366455231269
lambda[  12] =   0.39578388144050
lambda[  13] =   0.40921481511600
lambda[  14] =   0.42824213787694
lambda[  15] =   0.44574037970828
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.343 ms
rank =  0, Distributing orbital back into band + domain format took 14.961 ms
rank = 0, Subspace_Rotation used 19.323 ms

Total time for subspace rotation: 19.326 ms
rank = 0, Efermi =   0.312803840889 calculate fermi energy took 0.050 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.545740, lowerbound = -1.212300, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1401.983 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 32.238 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.853 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 36.278 ms
rank =  0, finding HY took 21.799 ms
rank =  0, distributing HY into block cyclic form took 14.470 ms
rank =  0, finding Y'*HY took 4.088 ms
Rank 0, Project_Hamiltonian used 77.838 ms
Total time for projection: 77.883 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.113553639168178
    last  calculated eigval = 0.165992307460653
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11355363916818
lambda[   2] =  -1.04487177108469
lambda[   3] =  -0.67335808261800
lambda[   4] =  -0.54237479968121
lambda[   5] =  -0.53132998909105
lambda[   6] =  -0.46466646917603
lambda[   7] =  -0.43327007856503
lambda[   8] =  -0.36275937471512
lambda[   9] =  -0.31796080619641
lambda[  10] =  -0.00222222167991
lambda[  11] =   0.07736007227225
lambda[  12] =   0.11337320201654
lambda[  13] =   0.12193652886829
lambda[  14] =   0.14193481553145
lambda[  15] =   0.16599230746065
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 4.335 ms
rank =  0, Distributing orbital back into band + domain format took 14.960 ms
rank = 0, Subspace_Rotation used 19.317 ms

Total time for subspace rotation: 19.322 ms
rank = 0, Efermi =  -0.031712235814 calculate fermi energy took 0.032 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.265992, lowerbound = -1.212300, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1383.535 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 37.697 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.816 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 41.546 ms
rank =  0, finding HY took 21.836 ms
rank =  0, distributing HY into block cyclic form took 14.476 ms
rank =  0, finding Y'*HY took 5.109 ms
Rank 0, Project_Hamiltonian used 83.003 ms
Total time for projection: 83.010 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.113753720061041
    last  calculated eigval = 0.086885807172853
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.11375372006104
lambda[   2] =  -1.04504997363234
lambda[   3] =  -0.67726952367073
lambda[   4] =  -0.55069281612009
lambda[   5] =  -0.53832473723924
lambda[   6] =  -0.47481885878289
lambda[   7] =  -0.45298829119591
lambda[   8] =  -0.38194316391124
lambda[   9] =  -0.35138212819827
lambda[  10] =  -0.09512879234242
lambda[  11] =   0.03350969408023
lambda[  12] =   0.04917698756111
lambda[  13] =   0.06413552184995
lambda[  14] =   0.07204848720603
lambda[  15] =   0.08688580717285
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 4.363 ms
rank =  0, Distributing orbital back into band + domain format took 14.899 ms
rank = 0, Subspace_Rotation used 19.283 ms

Total time for subspace rotation: 19.287 ms
rank = 0, Efermi =  -0.124618806521 calculate fermi energy took 0.034 ms
rank = 0, --- Calculate rho: sum over local bands took 3.281 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.305 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 6219.534 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.632 ms
rank = 0, D2D took 1.760 ms
rank = 0, Transfering density took 1.767 ms
Etot    =   -40.351167553629
Eband   =   -11.172446426948
E1      =    20.951457902242
E2      =    -9.908701645508
E3      =   -12.125023706988
Exc     =   -10.875678040189
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 8.070e+00, dEband = 2.234e+00
rank = 0, Calculating/Estimating energy took 1.058 ms, Etot = -40.351167554, dEtot = 8.070e+00, dEband = 2.234e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 55.5933381119874, which took 0.063 ms

iter_count = 90, r_2norm = 1.884e-03, tol*||rhs|| = 2.224e-03

Anderson update took 57.145 ms, out of which F'*F took 26.167 ms; b-Ax took 175.039 ms, out of which Lap took 155.356 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.513 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392752, int_b + int_rho = -7.640e-14, checking this took 0.141 ms
2-norm of RHS = 566.2929861877484, which took 0.238 ms

iter_count = 282, r_2norm = 4.572e-04, tol*||rhs|| = 5.663e-04

Anderson update took 179.395 ms, out of which F'*F took 78.258 ms; b-Ax took 531.939 ms, out of which Lap took 470.536 ms
Solving Poisson took 1248.043 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.346 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.115613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.121556 
Total time for convolution: 	 convolve: 5.117523 
Total time for convolution: 	 convolve: 5.117237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.444 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 0.991 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.814 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.828 ms

This SCF took 32414.932 ms, scf error = 1.274e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186886, lowerbound = -1.113754, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1428.319 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.672 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.819 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 18.537 ms
rank =  0, finding HY took 22.858 ms
rank =  0, distributing HY into block cyclic form took 14.583 ms
rank =  0, finding Y'*HY took 5.017 ms
Rank 0, Project_Hamiltonian used 61.034 ms
Total time for projection: 61.105 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.082688115901103
    last  calculated eigval = 0.054254849372722
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08268811590110
lambda[   2] =  -1.00863156363333
lambda[   3] =  -0.65767058759225
lambda[   4] =  -0.52606815671591
lambda[   5] =  -0.50042426254597
lambda[   6] =  -0.45080868306508
lambda[   7] =  -0.41990717701475
lambda[   8] =  -0.34618263259568
lambda[   9] =  -0.31220678421223
lambda[  10] =  -0.09365593292072
lambda[  11] =   0.00175215184130
lambda[  12] =   0.01433881667310
lambda[  13] =   0.03402052384489
lambda[  14] =   0.04568341289286
lambda[  15] =   0.05425484937272
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 4.376 ms
rank =  0, Distributing orbital back into band + domain format took 15.118 ms
rank = 0, Subspace_Rotation used 19.521 ms

Total time for subspace rotation: 19.526 ms
rank = 0, Efermi =  -0.123145947046 calculate fermi energy took 0.745 ms
rank = 0, --- Calculate rho: sum over local bands took 3.873 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.429 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1516.967 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.792 ms
rank = 0, D2D took 1.018 ms
rank = 0, Transfering density took 1.026 ms
Etot    =   -40.315185484626
Eband   =   -10.609175927857
E1      =    20.500888455477
E2      =    -9.798845244061
E3      =   -12.276612453953
Exc     =   -10.994129369031
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 7.196e-03, dEband = 1.127e-01
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -40.315185485, dEtot = 7.196e-03, dEband = 1.127e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 26.5683166042195, which took 0.073 ms

iter_count = 96, r_2norm = 8.133e-04, tol*||rhs|| = 1.063e-03

Anderson update took 57.967 ms, out of which F'*F took 26.531 ms; b-Ax took 179.152 ms, out of which Lap took 158.798 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.680 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392743, int_b + int_rho = -1.637e-13, checking this took 0.132 ms
2-norm of RHS = 564.0437150982505, which took 0.152 ms

iter_count = 288, r_2norm = 4.796e-04, tol*||rhs|| = 5.640e-04

Anderson update took 173.006 ms, out of which F'*F took 80.705 ms; b-Ax took 538.281 ms, out of which Lap took 479.924 ms
Solving Poisson took 1200.231 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.892 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.248794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.275066 
Total time for convolution: 	 convolve: 5.270118 
Total time for convolution: 	 convolve: 5.266157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.399 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.154 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.259 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.794 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.776 ms

This SCF took 28220.155 ms, scf error = 7.895e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.154255, lowerbound = -1.082688, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1415.684 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.732 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.060 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.044 ms
rank =  0, Distribute data + matrix mult took 18.852 ms
rank =  0, finding HY took 22.841 ms
rank =  0, distributing HY into block cyclic form took 15.014 ms
rank =  0, finding Y'*HY took 4.931 ms
Rank 0, Project_Hamiltonian used 61.682 ms
Total time for projection: 61.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -1.052315987536085
    last  calculated eigval = 0.042802171480756
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.05231598753609
lambda[   2] =  -0.97202581705707
lambda[   3] =  -0.63342780754133
lambda[   4] =  -0.49800644316759
lambda[   5] =  -0.46293169792428
lambda[   6] =  -0.42660936032256
lambda[   7] =  -0.38602903213812
lambda[   8] =  -0.31456228888563
lambda[   9] =  -0.27425659303647
lambda[  10] =  -0.07319178686135
lambda[  11] =  -0.01981890864116
lambda[  12] =   0.00117689905289
lambda[  13] =   0.02880191921052
lambda[  14] =   0.03283022411819
lambda[  15] =   0.04280217148076
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 4.794 ms
rank =  0, Distributing orbital back into band + domain format took 14.351 ms
rank = 0, Subspace_Rotation used 19.174 ms

Total time for subspace rotation: 19.186 ms
rank = 0, Efermi =  -0.102681800960 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.838 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.288 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.214 ms
rank = 0, Calculating density took 1505.113 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.665 ms
rank = 0, Transfering density took 0.670 ms
Etot    =   -40.298521583841
Eband   =   -10.040330056238
E1      =    20.064598256395
E2      =    -9.648521075626
E3      =   -12.432788762547
Exc     =   -11.115873280943
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 3.333e-03, dEband = 1.138e-01
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -40.298521584, dEtot = 3.333e-03, dEband = 1.138e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.8466019180386, which took 0.089 ms

iter_count = 102, r_2norm = 1.820e-04, tol*||rhs|| = 2.739e-04

Anderson update took 62.868 ms, out of which F'*F took 28.588 ms; b-Ax took 193.821 ms, out of which Lap took 172.398 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392743, int_b + int_rho = -1.673e-13, checking this took 0.129 ms
2-norm of RHS = 565.7519639204706, which took 0.129 ms

iter_count = 282, r_2norm = 5.079e-04, tol*||rhs|| = 5.658e-04

Anderson update took 175.208 ms, out of which F'*F took 77.630 ms; b-Ax took 531.766 ms, out of which Lap took 474.856 ms
Solving Poisson took 1186.186 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.014 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.104317 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.352 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.103806 
Total time for convolution: 	 convolve: 5.106360 
Total time for convolution: 	 convolve: 5.137527 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.572 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.440 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.972 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.804 ms

This SCF took 27601.610 ms, scf error = 3.921e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.142802, lowerbound = -1.052316, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1537.745 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.738 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.568 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.118 ms
rank =  0, Distribute data + matrix mult took 18.442 ms
rank =  0, finding HY took 22.096 ms
rank =  0, distributing HY into block cyclic form took 14.594 ms
rank =  0, finding Y'*HY took 5.933 ms
Rank 0, Project_Hamiltonian used 61.104 ms
Total time for projection: 61.124 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.040607543577766
    last  calculated eigval = 0.036714009186829
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.04060754357777
lambda[   2] =  -0.95944842534983
lambda[   3] =  -0.61838252485976
lambda[   4] =  -0.47993282185628
lambda[   5] =  -0.45062577985101
lambda[   6] =  -0.41608082303903
lambda[   7] =  -0.37275413989319
lambda[   8] =  -0.30729856185074
lambda[   9] =  -0.26322813204063
lambda[  10] =  -0.06082929590030
lambda[  11] =  -0.02853714673177
lambda[  12] =  -0.00313781100105
lambda[  13] =   0.02368012996500
lambda[  14] =   0.03000363569100
lambda[  15] =   0.03671400918683
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.176 ms
rank =  0, subspace rotation using ScaLAPACK took 4.930 ms
rank =  0, Distributing orbital back into band + domain format took 14.280 ms
rank = 0, Subspace_Rotation used 19.237 ms

Total time for subspace rotation: 19.250 ms
rank = 0, Efermi =  -0.090319310075 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.627 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.691 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.227 ms
rank = 0, Calculating density took 1627.033 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
rank = 0, D2D took 0.655 ms
rank = 0, Transfering density took 0.661 ms
Etot    =   -40.294398576485
Eband   =    -9.816717505484
E1      =    19.933187465507
E2      =    -9.546147509762
E3      =   -12.491919235574
Exc     =   -11.160708940616
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 8.246e-04, dEband = 4.472e-02
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -40.294398576, dEtot = 8.246e-04, dEband = 4.472e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7686877711251, which took 0.064 ms

iter_count = 108, r_2norm = 7.200e-05, tol*||rhs|| = 1.107e-04

Anderson update took 68.384 ms, out of which F'*F took 31.504 ms; b-Ax took 207.430 ms, out of which Lap took 186.792 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.213 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392738, int_b + int_rho = -2.110e-13, checking this took 0.155 ms
2-norm of RHS = 565.9344255826251, which took 0.135 ms

iter_count = 246, r_2norm = 5.353e-04, tol*||rhs|| = 5.659e-04

Anderson update took 168.004 ms, out of which F'*F took 71.622 ms; b-Ax took 464.368 ms, out of which Lap took 421.528 ms
Solving Poisson took 1057.759 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.248796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.083797 
Total time for convolution: 	 convolve: 5.113630 
Total time for convolution: 	 convolve: 5.095432 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.403 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.965 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.853 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.845 ms

This SCF took 27725.444 ms, scf error = 1.009e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.136714, lowerbound = -1.040608, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.120 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 36.427 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.666 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 40.174 ms
rank =  0, finding HY took 22.737 ms
rank =  0, distributing HY into block cyclic form took 14.768 ms
rank =  0, finding Y'*HY took 4.737 ms
Rank 0, Project_Hamiltonian used 82.460 ms
Total time for projection: 82.494 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.497 ms
    first calculated eigval = -1.037663505841824
    last  calculated eigval = 0.033061577866177
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03766350584182
lambda[   2] =  -0.95473185128899
lambda[   3] =  -0.61622798271661
lambda[   4] =  -0.47693707889235
lambda[   5] =  -0.44559145740599
lambda[   6] =  -0.41340508924706
lambda[   7] =  -0.36876610512441
lambda[   8] =  -0.30346110287206
lambda[   9] =  -0.25757606414310
lambda[  10] =  -0.05838377700868
lambda[  11] =  -0.03134196049156
lambda[  12] =  -0.00523030982436
lambda[  13] =   0.02120193083585
lambda[  14] =   0.02758429859964
lambda[  15] =   0.03306157786618
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.521 ms
rank =  0, subspace rotation using ScaLAPACK took 5.081 ms
rank =  0, Distributing orbital back into band + domain format took 14.537 ms
rank = 0, Subspace_Rotation used 19.650 ms

Total time for subspace rotation: 19.658 ms
rank = 0, Efermi =  -0.087873791181 calculate fermi energy took 1.961 ms
rank = 0, --- Calculate rho: sum over local bands took 4.183 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.033 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.212 ms
rank = 0, Calculating density took 1501.275 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.675 ms
rank = 0, D2D took 1.097 ms
rank = 0, Transfering density took 1.105 ms
Etot    =   -40.293814137168
Eband   =    -9.748720475878
E1      =    19.893264054948
E2      =    -9.513947178164
E3      =   -12.510667812845
Exc     =   -11.174746366019
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.169e-04, dEband = 1.360e-02
rank = 0, Calculating/Estimating energy took 1.112 ms, Etot = -40.293814137, dEtot = 1.169e-04, dEband = 1.360e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2182634868611, which took 0.061 ms

iter_count = 108, r_2norm = 4.214e-05, tol*||rhs|| = 4.873e-05

Anderson update took 64.983 ms, out of which F'*F took 30.067 ms; b-Ax took 204.918 ms, out of which Lap took 182.184 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.619 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392747, int_b + int_rho = -1.310e-13, checking this took 0.129 ms
2-norm of RHS = 566.4324273215358, which took 0.208 ms

iter_count = 246, r_2norm = 4.994e-04, tol*||rhs|| = 5.664e-04

Anderson update took 149.085 ms, out of which F'*F took 68.543 ms; b-Ax took 465.262 ms, out of which Lap took 413.131 ms
Solving Poisson took 1063.594 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.094151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.086026 
Total time for convolution: 	 convolve: 5.094097 
Total time for convolution: 	 convolve: 5.089131 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.642 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 0.982 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.403 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.410 ms

This SCF took 27422.943 ms, scf error = 6.304e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.133062, lowerbound = -1.037664, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1431.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.753 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.597 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.132 ms
rank =  0, Distribute data + matrix mult took 18.506 ms
rank =  0, finding HY took 22.769 ms
rank =  0, distributing HY into block cyclic form took 14.833 ms
rank =  0, finding Y'*HY took 4.049 ms
Rank 0, Project_Hamiltonian used 60.740 ms
Total time for projection: 60.755 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -1.036575900896218
    last  calculated eigval = 0.030772934697739
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03657590089622
lambda[   2] =  -0.95318866677341
lambda[   3] =  -0.61545032485666
lambda[   4] =  -0.47579591731999
lambda[   5] =  -0.44358080868827
lambda[   6] =  -0.41231458023899
lambda[   7] =  -0.36730618754573
lambda[   8] =  -0.30202613868847
lambda[   9] =  -0.25543370056881
lambda[  10] =  -0.05745149515665
lambda[  11] =  -0.03241903231114
lambda[  12] =  -0.00641357884413
lambda[  13] =   0.02008452900728
lambda[  14] =   0.02558195389049
lambda[  15] =   0.03077293469774
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.361 ms
rank =  0, Distributing orbital back into band + domain format took 14.907 ms
rank = 0, Subspace_Rotation used 19.290 ms

Total time for subspace rotation: 19.296 ms
rank = 0, Efermi =  -0.086941509289 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 3.860 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.517 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.231 ms
rank = 0, Calculating density took 1519.038 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.676 ms
rank = 0, D2D took 0.919 ms
rank = 0, Transfering density took 0.924 ms
Etot    =   -40.293594415300
Eband   =    -9.723344451953
E1      =    19.891086132732
E2      =    -9.489285448718
E3      =   -12.514441382569
Exc     =   -11.176836586136
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 4.394e-05, dEband = 5.075e-03
rank = 0, Calculating/Estimating energy took 1.242 ms, Etot = -40.293594415, dEtot = 4.394e-05, dEband = 5.075e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6411175435948, which took 0.095 ms

iter_count = 108, r_2norm = 2.011e-05, tol*||rhs|| = 2.564e-05

Anderson update took 65.974 ms, out of which F'*F took 29.978 ms; b-Ax took 206.149 ms, out of which Lap took 182.730 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 471.414 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392751, int_b + int_rho = -8.367e-14, checking this took 0.120 ms
2-norm of RHS = 566.6350673551883, which took 0.176 ms

iter_count = 240, r_2norm = 5.185e-04, tol*||rhs|| = 5.666e-04

Anderson update took 151.657 ms, out of which F'*F took 69.029 ms; b-Ax took 461.859 ms, out of which Lap took 414.543 ms
Solving Poisson took 1035.627 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.093891 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.345 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.096374 
Total time for convolution: 	 convolve: 5.092195 
Total time for convolution: 	 convolve: 5.092884 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 212.574 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.021 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.393 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.381 ms

This SCF took 27644.629 ms, scf error = 3.387e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.130773, lowerbound = -1.036576, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1419.810 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.243 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 18.153 ms
rank =  0, finding HY took 22.559 ms
rank =  0, distributing HY into block cyclic form took 14.853 ms
rank =  0, finding Y'*HY took 4.630 ms
Rank 0, Project_Hamiltonian used 60.796 ms
Total time for projection: 60.813 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.034900746363039
    last  calculated eigval = 0.029409090278607
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03490074636304
lambda[   2] =  -0.95181465320759
lambda[   3] =  -0.61412044498618
lambda[   4] =  -0.47446375014490
lambda[   5] =  -0.44193621406671
lambda[   6] =  -0.41079608373704
lambda[   7] =  -0.36583442173014
lambda[   8] =  -0.30051989309215
lambda[   9] =  -0.25420260092857
lambda[  10] =  -0.05623012014829
lambda[  11] =  -0.03286361879606
lambda[  12] =  -0.00694058839345
lambda[  13] =   0.01974685189499
lambda[  14] =   0.02401931663927
lambda[  15] =   0.02940909027861
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 4.379 ms
rank =  0, Distributing orbital back into band + domain format took 14.976 ms
rank = 0, Subspace_Rotation used 19.371 ms

Total time for subspace rotation: 19.376 ms
rank = 0, Efermi =  -0.085720134246 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.782 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.472 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.195 ms
rank = 0, Calculating density took 1507.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
rank = 0, D2D took 1.623 ms
rank = 0, Transfering density took 1.632 ms
Etot    =   -40.293538589984
Eband   =    -9.697177617296
E1      =    19.883177262233
E2      =    -9.470158571141
E3      =   -12.516481796123
Exc     =   -11.177952260956
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.117e-05, dEband = 5.233e-03
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -40.293538590, dEtot = 1.117e-05, dEband = 5.233e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2716186671934, which took 0.057 ms

iter_count = 108, r_2norm = 9.938e-06, tol*||rhs|| = 1.086e-05

Anderson update took 67.303 ms, out of which F'*F took 30.132 ms; b-Ax took 203.011 ms, out of which Lap took 180.156 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.288 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392749, int_b + int_rho = -1.055e-13, checking this took 0.119 ms
2-norm of RHS = 566.6200510147087, which took 0.141 ms

iter_count = 240, r_2norm = 4.881e-04, tol*||rhs|| = 5.666e-04

Anderson update took 151.499 ms, out of which F'*F took 68.570 ms; b-Ax took 464.557 ms, out of which Lap took 416.432 ms
Solving Poisson took 1041.343 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.201 ms
Total time for convolution: 	 convolve: 5.090287 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.094913 
Total time for convolution: 	 convolve: 5.099875 
Total time for convolution: 	 convolve: 5.094784 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.260 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.403 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.386 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.360 ms

This SCF took 27463.872 ms, scf error = 1.850e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129409, lowerbound = -1.034901, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1424.626 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 24.772 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.177 ms
rank =  0, Distribute data + matrix mult took 28.415 ms
rank =  0, finding HY took 22.487 ms
rank =  0, distributing HY into block cyclic form took 14.845 ms
rank =  0, finding Y'*HY took 4.695 ms
Rank 0, Project_Hamiltonian used 70.487 ms
Total time for projection: 70.527 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.032605967730372
    last  calculated eigval = 0.028891901335514
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03260596773037
lambda[   2] =  -0.94901460433885
lambda[   3] =  -0.61234852542073
lambda[   4] =  -0.47240966659870
lambda[   5] =  -0.43912095164438
lambda[   6] =  -0.40847411450674
lambda[   7] =  -0.36347840041142
lambda[   8] =  -0.29812520005793
lambda[   9] =  -0.25141160559431
lambda[  10] =  -0.05392680449118
lambda[  11] =  -0.03264847077476
lambda[  12] =  -0.00628687120083
lambda[  13] =   0.02028478356540
lambda[  14] =   0.02343485915763
lambda[  15] =   0.02889190133551
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.166 ms
rank =  0, subspace rotation using ScaLAPACK took 4.354 ms
rank =  0, Distributing orbital back into band + domain format took 15.228 ms
rank = 0, Subspace_Rotation used 19.607 ms

Total time for subspace rotation: 19.614 ms
rank = 0, Efermi =  -0.083416818662 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 4.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 1522.660 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.800 ms
rank = 0, Transfering density took 0.812 ms
Etot    =   -40.293644949323
Eband   =    -9.653978073358
E1      =    19.860162041417
E2      =    -9.448420783327
E3      =   -12.522034463111
Exc     =   -11.182057822591
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 2.127e-05, dEband = 8.640e-03
rank = 0, Calculating/Estimating energy took 1.473 ms, Etot = -40.293644949, dEtot = 2.127e-05, dEband = 8.640e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2092314357508, which took 0.058 ms

iter_count = 108, r_2norm = 7.772e-06, tol*||rhs|| = 8.369e-06

Anderson update took 67.271 ms, out of which F'*F took 30.017 ms; b-Ax took 202.615 ms, out of which Lap took 179.898 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.138 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392745, int_b + int_rho = -1.419e-13, checking this took 0.109 ms
2-norm of RHS = 566.6185527299652, which took 0.118 ms

iter_count = 210, r_2norm = 5.255e-04, tol*||rhs|| = 5.666e-04

Anderson update took 132.130 ms, out of which F'*F took 59.994 ms; b-Ax took 407.830 ms, out of which Lap took 364.892 ms
Solving Poisson took 913.332 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.511 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.098352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.384 ms
Total time for convolution: 	 convolve: 5.089012 
Total time for convolution: 	 convolve: 5.096440 
Total time for convolution: 	 convolve: 5.086356 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 2.077 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.502 ms

This SCF took 27714.437 ms, scf error = 9.231e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128892, lowerbound = -1.032606, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.113 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 38.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.613 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.182 ms
rank =  0, Distribute data + matrix mult took 42.589 ms
rank =  0, finding HY took 22.567 ms
rank =  0, distributing HY into block cyclic form took 14.644 ms
rank =  0, finding Y'*HY took 4.846 ms
Rank 0, Project_Hamiltonian used 84.696 ms
Total time for projection: 84.739 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.031648832479867
    last  calculated eigval = 0.028915579713281
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03164883247987
lambda[   2] =  -0.94796163306258
lambda[   3] =  -0.61144170012076
lambda[   4] =  -0.47140613361450
lambda[   5] =  -0.43809437006057
lambda[   6] =  -0.40749466829936
lambda[   7] =  -0.36251000504006
lambda[   8] =  -0.29720813030180
lambda[   9] =  -0.25040550596844
lambda[  10] =  -0.05284702379299
lambda[  11] =  -0.03177299050095
lambda[  12] =  -0.00509027226695
lambda[  13] =   0.02085785185907
lambda[  14] =   0.02387088378960
lambda[  15] =   0.02891557971328
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.394 ms
rank =  0, Distributing orbital back into band + domain format took 14.814 ms
rank = 0, Subspace_Rotation used 19.229 ms

Total time for subspace rotation: 19.236 ms
rank = 0, Efermi =  -0.082337037984 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.883 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.459 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.228 ms
rank = 0, Calculating density took 1502.032 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.751 ms
rank = 0, D2D took 0.993 ms
rank = 0, Transfering density took 1.002 ms
Etot    =   -40.293705518147
Eband   =    -9.636341958632
E1      =    19.851001411062
E2      =    -9.439522499856
E3      =   -12.523642496477
Exc     =   -11.183303625681
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.211e-05, dEband = 3.527e-03
rank = 0, Calculating/Estimating energy took 1.105 ms, Etot = -40.293705518, dEtot = 1.211e-05, dEband = 3.527e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1025906135141, which took 0.054 ms

iter_count = 108, r_2norm = 3.891e-06, tol*||rhs|| = 4.104e-06

Anderson update took 67.006 ms, out of which F'*F took 29.874 ms; b-Ax took 202.521 ms, out of which Lap took 179.631 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.828 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392747, int_b + int_rho = -1.237e-13, checking this took 0.078 ms
2-norm of RHS = 566.6209679411048, which took 0.113 ms

iter_count = 216, r_2norm = 4.875e-04, tol*||rhs|| = 5.666e-04

Anderson update took 136.009 ms, out of which F'*F took 61.681 ms; b-Ax took 418.105 ms, out of which Lap took 375.162 ms
Solving Poisson took 936.910 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.090732 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.518 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.086472 
Total time for convolution: 	 convolve: 5.107839 
Total time for convolution: 	 convolve: 5.089055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.384 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.354 ms

This SCF took 27313.773 ms, scf error = 6.789e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128916, lowerbound = -1.031649, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1426.069 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 18.719 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.671 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.070 ms
rank =  0, Distribute data + matrix mult took 22.480 ms
rank =  0, finding HY took 22.524 ms
rank =  0, distributing HY into block cyclic form took 15.032 ms
rank =  0, finding Y'*HY took 4.417 ms
Rank 0, Project_Hamiltonian used 64.506 ms
Total time for projection: 64.534 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -1.030598973447697
    last  calculated eigval = 0.029700205399721
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.03059897344770
lambda[   2] =  -0.94691612705432
lambda[   3] =  -0.61045068862899
lambda[   4] =  -0.47040185924460
lambda[   5] =  -0.43704796178065
lambda[   6] =  -0.40645496595697
lambda[   7] =  -0.36149052340190
lambda[   8] =  -0.29614554836569
lambda[   9] =  -0.24935712645172
lambda[  10] =  -0.05167226286544
lambda[  11] =  -0.02895188595070
lambda[  12] =  -0.00177247689732
lambda[  13] =   0.02258533051024
lambda[  14] =   0.02608891228130
lambda[  15] =   0.02970020539972
==subpsace eigenproblem: bcast eigvals took 0.039 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.436 ms
rank =  0, Distributing orbital back into band + domain format took 14.715 ms
rank = 0, Subspace_Rotation used 19.175 ms

Total time for subspace rotation: 19.181 ms
rank = 0, Efermi =  -0.081162276981 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.926 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.597 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.208 ms
rank = 0, Calculating density took 1517.842 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.825 ms
rank = 0, D2D took 1.080 ms
rank = 0, Transfering density took 1.090 ms
Etot    =   -40.293768114340
Eband   =    -9.617727549385
E1      =    19.842207607852
E2      =    -9.429444942352
E3      =   -12.524640790382
Exc     =   -11.184107564313
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.252e-05, dEband = 3.723e-03
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -40.293768114, dEtot = 1.252e-05, dEband = 3.723e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0910721582023, which took 0.052 ms

iter_count = 108, r_2norm = 2.327e-06, tol*||rhs|| = 3.643e-06

Anderson update took 67.008 ms, out of which F'*F took 30.084 ms; b-Ax took 202.644 ms, out of which Lap took 179.848 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.692 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392746, int_b + int_rho = -1.382e-13, checking this took 0.131 ms
2-norm of RHS = 566.6480454424195, which took 0.147 ms

iter_count = 204, r_2norm = 5.285e-04, tol*||rhs|| = 5.666e-04

Anderson update took 128.513 ms, out of which F'*F took 58.696 ms; b-Ax took 394.747 ms, out of which Lap took 353.954 ms
Solving Poisson took 884.195 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.088085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.087772 
Total time for convolution: 	 convolve: 5.096455 
Total time for convolution: 	 convolve: 5.089583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.766 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.386 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.361 ms

This SCF took 27256.035 ms, scf error = 4.001e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129700, lowerbound = -1.030599, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1389.214 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 36.804 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.672 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.120 ms
rank =  0, Distribute data + matrix mult took 40.619 ms
rank =  0, finding HY took 22.571 ms
rank =  0, distributing HY into block cyclic form took 14.700 ms
rank =  0, finding Y'*HY took 4.808 ms
Rank 0, Project_Hamiltonian used 82.742 ms
Total time for projection: 82.773 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -1.029455875194232
    last  calculated eigval = 0.030857848338702
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02945587519423
lambda[   2] =  -0.94581069881703
lambda[   3] =  -0.60932483629891
lambda[   4] =  -0.46927981513954
lambda[   5] =  -0.43598794695970
lambda[   6] =  -0.40534301486195
lambda[   7] =  -0.36044773197851
lambda[   8] =  -0.29508027873681
lambda[   9] =  -0.24828430097393
lambda[  10] =  -0.05046855635269
lambda[  11] =  -0.02444299050348
lambda[  12] =   0.00175262567122
lambda[  13] =   0.02448135197796
lambda[  14] =   0.03030310925423
lambda[  15] =   0.03085784833870
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 4.538 ms
rank =  0, Distributing orbital back into band + domain format took 14.641 ms
rank = 0, Subspace_Rotation used 19.206 ms

Total time for subspace rotation: 19.211 ms
rank = 0, Efermi =  -0.079958570536 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.981 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.557 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.215 ms
rank = 0, Calculating density took 1499.301 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.829 ms
rank = 0, D2D took 1.019 ms
rank = 0, Transfering density took 1.027 ms
Etot    =   -40.293832433817
Eband   =    -9.598028998624
E1      =    19.832491258377
E2      =    -9.419066831272
E3      =   -12.526226159590
Exc     =   -11.185361343203
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.286e-05, dEband = 3.940e-03
rank = 0, Calculating/Estimating energy took 1.433 ms, Etot = -40.293832434, dEtot = 1.286e-05, dEband = 3.940e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0659002140846, which took 0.057 ms

iter_count = 108, r_2norm = 1.931e-06, tol*||rhs|| = 2.636e-06

Anderson update took 67.203 ms, out of which F'*F took 29.928 ms; b-Ax took 202.537 ms, out of which Lap took 179.822 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.070 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392739, int_b + int_rho = -2.074e-13, checking this took 0.135 ms
2-norm of RHS = 566.6465703685348, which took 0.195 ms

iter_count = 156, r_2norm = 5.039e-04, tol*||rhs|| = 5.666e-04

Anderson update took 98.614 ms, out of which F'*F took 58.271 ms; b-Ax took 315.406 ms, out of which Lap took 283.469 ms
Solving Poisson took 691.597 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.090630 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.083647 
Total time for convolution: 	 convolve: 5.093376 
Total time for convolution: 	 convolve: 5.091935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.352 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.381 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.353 ms

This SCF took 27047.750 ms, scf error = 2.424e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130858, lowerbound = -1.029456, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1404.230 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 22.367 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.702 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.094 ms
rank =  0, Distribute data + matrix mult took 26.184 ms
rank =  0, finding HY took 22.635 ms
rank =  0, distributing HY into block cyclic form took 14.736 ms
rank =  0, finding Y'*HY took 4.727 ms
Rank 0, Project_Hamiltonian used 68.326 ms
Total time for projection: 68.355 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.029267612091170
    last  calculated eigval = 0.031288759398268
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02926761209117
lambda[   2] =  -0.94560858597504
lambda[   3] =  -0.60914198360403
lambda[   4] =  -0.46909839286952
lambda[   5] =  -0.43579445156793
lambda[   6] =  -0.40515309026713
lambda[   7] =  -0.36026261924815
lambda[   8] =  -0.29488423332339
lambda[   9] =  -0.24807991845893
lambda[  10] =  -0.05030656083165
lambda[  11] =  -0.02338411383258
lambda[  12] =   0.00210449390786
lambda[  13] =   0.02465036898064
lambda[  14] =   0.03085362395011
lambda[  15] =   0.03128875939827
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 4.343 ms
rank =  0, Distributing orbital back into band + domain format took 14.858 ms
rank = 0, Subspace_Rotation used 19.219 ms

Total time for subspace rotation: 19.224 ms
rank = 0, Efermi =  -0.079796574992 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.922 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.200 ms
rank = 0, Calculating density took 1499.930 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.796 ms
rank = 0, D2D took 1.909 ms
rank = 0, Transfering density took 1.915 ms
Etot    =   -40.293855688095
Eband   =    -9.594581775511
E1      =    19.830712365307
E2      =    -9.417333917913
E3      =   -12.526455683142
Exc     =   -11.185549537718
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 4.651e-06, dEband = 6.894e-04
rank = 0, Calculating/Estimating energy took 1.019 ms, Etot = -40.293855688, dEtot = 4.651e-06, dEband = 6.894e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0438122970463, which took 0.061 ms

iter_count = 108, r_2norm = 1.389e-06, tol*||rhs|| = 1.752e-06

Anderson update took 67.046 ms, out of which F'*F took 30.080 ms; b-Ax took 202.549 ms, out of which Lap took 179.930 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.895 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392747, int_b + int_rho = -1.273e-13, checking this took 0.116 ms
2-norm of RHS = 566.6556738655847, which took 0.208 ms

iter_count = 180, r_2norm = 4.720e-04, tol*||rhs|| = 5.667e-04

Anderson update took 113.273 ms, out of which F'*F took 51.805 ms; b-Ax took 348.729 ms, out of which Lap took 312.404 ms
Solving Poisson took 781.907 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.087991 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.084075 
Total time for convolution: 	 convolve: 5.087625 
Total time for convolution: 	 convolve: 5.086583 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.571 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.158 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.957 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.391 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.371 ms

This SCF took 27134.957 ms, scf error = 1.869e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131289, lowerbound = -1.029268, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1436.494 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.990 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.575 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.250 ms
rank =  0, Distribute data + matrix mult took 18.840 ms
rank =  0, finding HY took 22.496 ms
rank =  0, distributing HY into block cyclic form took 14.694 ms
rank =  0, finding Y'*HY took 4.844 ms
Rank 0, Project_Hamiltonian used 60.914 ms
Total time for projection: 60.940 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -1.029078357248312
    last  calculated eigval = 0.032922157820304
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02907835724831
lambda[   2] =  -0.94543215228564
lambda[   3] =  -0.60891545402092
lambda[   4] =  -0.46888036523709
lambda[   5] =  -0.43559970734240
lambda[   6] =  -0.40493974571155
lambda[   7] =  -0.36005737485295
lambda[   8] =  -0.29468211487601
lambda[   9] =  -0.24790178142136
lambda[  10] =  -0.05019347333456
lambda[  11] =  -0.02253979967441
lambda[  12] =   0.00190215880267
lambda[  13] =   0.02518464581368
lambda[  14] =   0.03156410891287
lambda[  15] =   0.03292215782030
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.347 ms
rank =  0, Distributing orbital back into band + domain format took 14.869 ms
rank = 0, Subspace_Rotation used 19.235 ms

Total time for subspace rotation: 19.242 ms
rank = 0, Efermi =  -0.079683487498 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 4.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.706 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1524.658 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.661 ms
rank = 0, D2D took 0.911 ms
rank = 0, Transfering density took 0.923 ms
Etot    =   -40.293916073575
Eband   =    -9.590974106692
E1      =    19.829443813739
E2      =    -9.414999232683
E3      =   -12.526219366814
Exc     =   -11.185378038891
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.208e-05, dEband = 7.215e-04
rank = 0, Calculating/Estimating energy took 1.263 ms, Etot = -40.293916074, dEtot = 1.208e-05, dEband = 7.215e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0461417516036, which took 0.050 ms

iter_count = 108, r_2norm = 1.348e-06, tol*||rhs|| = 1.846e-06

Anderson update took 66.801 ms, out of which F'*F took 29.878 ms; b-Ax took 203.944 ms, out of which Lap took 180.948 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 468.479 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392739, int_b + int_rho = -2.074e-13, checking this took 0.119 ms
2-norm of RHS = 566.6585663823614, which took 0.179 ms

iter_count = 84, r_2norm = 5.355e-04, tol*||rhs|| = 5.667e-04

Anderson update took 52.611 ms, out of which F'*F took 27.068 ms; b-Ax took 165.431 ms, out of which Lap took 148.698 ms
Solving Poisson took 368.677 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.097326 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Total time for convolution: 	 convolve: 5.101232 
Total time for convolution: 	 convolve: 5.119462 
Total time for convolution: 	 convolve: 5.088353 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.366 ms

This SCF took 26787.904 ms, scf error = 1.910e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132922, lowerbound = -1.029078, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1430.541 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.599 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.753 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.087 ms
rank =  0, Distribute data + matrix mult took 18.460 ms
rank =  0, finding HY took 22.617 ms
rank =  0, distributing HY into block cyclic form took 14.843 ms
rank =  0, finding Y'*HY took 4.542 ms
Rank 0, Project_Hamiltonian used 60.509 ms
Total time for projection: 60.560 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -1.029136339793678
    last  calculated eigval = 0.032558805411689
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02913633979368
lambda[   2] =  -0.94549666996340
lambda[   3] =  -0.60896216742262
lambda[   4] =  -0.46892834294504
lambda[   5] =  -0.43565886615326
lambda[   6] =  -0.40499326816473
lambda[   7] =  -0.36011116017859
lambda[   8] =  -0.29473885021258
lambda[   9] =  -0.24796165496974
lambda[  10] =  -0.05024323810989
lambda[  11] =  -0.02279074464880
lambda[  12] =   0.00174006550456
lambda[  13] =   0.02504651247797
lambda[  14] =   0.03132263988936
lambda[  15] =   0.03255880541169
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 5.053 ms
rank =  0, Distributing orbital back into band + domain format took 14.313 ms
rank = 0, Subspace_Rotation used 19.389 ms

Total time for subspace rotation: 19.401 ms
rank = 0, Efermi =  -0.079733252249 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.965 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.349 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.318 ms
rank = 0, Calculating density took 1518.955 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.652 ms
rank = 0, D2D took 0.775 ms
rank = 0, Transfering density took 0.780 ms
Etot    =   -40.293914285870
Eband   =    -9.591974640307
E1      =    19.830069200659
E2      =    -9.415407924216
E3      =   -12.526064902126
Exc     =   -11.185255331335
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 3.575e-07, dEband = 2.001e-04
rank = 0, Calculating/Estimating energy took 1.037 ms, Etot = -40.293914286, dEtot = 3.575e-07, dEband = 2.001e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0402498839877, which took 0.058 ms

iter_count = 108, r_2norm = 1.130e-06, tol*||rhs|| = 1.610e-06

Anderson update took 66.894 ms, out of which F'*F took 30.143 ms; b-Ax took 202.630 ms, out of which Lap took 179.610 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 467.875 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392747, int_b + int_rho = -1.237e-13, checking this took 0.120 ms
2-norm of RHS = 566.6451549945152, which took 0.174 ms

iter_count = 156, r_2norm = 4.575e-04, tol*||rhs|| = 5.666e-04

Anderson update took 97.971 ms, out of which F'*F took 44.814 ms; b-Ax took 302.088 ms, out of which Lap took 270.888 ms
Solving Poisson took 677.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.088141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.084355 
Total time for convolution: 	 convolve: 5.091086 
Total time for convolution: 	 convolve: 5.087030 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.061 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 19.330 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 19.737 ms

This SCF took 27574.926 ms, scf error = 2.196e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132559, lowerbound = -1.029136, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1583.224 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 64.551 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 40.209 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 104.789 ms
rank =  0, finding HY took 19.574 ms
rank =  0, distributing HY into block cyclic form took 104.348 ms
rank =  0, finding Y'*HY took 47.006 ms
Rank 0, Project_Hamiltonian used 275.765 ms
Total time for projection: 275.782 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.028829697630459
    last  calculated eigval = 0.033794782095912
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02882969763046
lambda[   2] =  -0.94516800438834
lambda[   3] =  -0.60870208221595
lambda[   4] =  -0.46866446554293
lambda[   5] =  -0.43535700948403
lambda[   6] =  -0.40470759615119
lambda[   7] =  -0.35982801954583
lambda[   8] =  -0.29444466844951
lambda[   9] =  -0.24766261214916
lambda[  10] =  -0.04999296391722
lambda[  11] =  -0.02208113583767
lambda[  12] =   0.00227345487683
lambda[  13] =   0.02548065928812
lambda[  14] =   0.03221773405053
lambda[  15] =   0.03379478209591
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 4.089 ms
rank =  0, Distributing orbital back into band + domain format took 13.154 ms
rank = 0, Subspace_Rotation used 17.261 ms

Total time for subspace rotation: 17.266 ms
rank = 0, Efermi =  -0.079482978054 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.637 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.309 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.173 ms
rank = 0, Calculating density took 1882.792 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.447 ms
rank = 0, D2D took 39.691 ms
rank = 0, Transfering density took 39.700 ms
Etot    =   -40.293933905314
Eband   =    -9.586728311811
E1      =    19.826887673744
E2      =    -9.413202447164
E3      =   -12.526684899337
Exc     =   -11.185754272520
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 3.924e-06, dEband = 1.049e-03
rank = 0, Calculating/Estimating energy took 8.425 ms, Etot = -40.293933905, dEtot = 3.924e-06, dEband = 1.049e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0268673412909, which took 47.428 ms

iter_count = 108, r_2norm = 9.690e-07, tol*||rhs|| = 1.075e-06

Anderson update took 217.464 ms, out of which F'*F took 49.661 ms; b-Ax took 356.392 ms, out of which Lap took 325.112 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1043.135 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392740, int_b + int_rho = -1.928e-13, checking this took 0.126 ms
2-norm of RHS = 566.6514419526575, which took 0.188 ms

iter_count = 138, r_2norm = 5.421e-04, tol*||rhs|| = 5.667e-04

Anderson update took 86.778 ms, out of which F'*F took 39.412 ms; b-Ax took 267.576 ms, out of which Lap took 240.186 ms
Solving Poisson took 601.156 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.093878 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.375 ms
Total time for convolution: 	 convolve: 5.091493 
Total time for convolution: 	 convolve: 5.100944 
Total time for convolution: 	 convolve: 5.084622 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.071 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 0.952 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.408 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.386 ms

This SCF took 27988.107 ms, scf error = 1.028e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133795, lowerbound = -1.028830, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1426.704 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 15.340 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.343 ms
rank =  0, Distribute data + matrix mult took 19.146 ms
rank =  0, finding HY took 22.491 ms
rank =  0, distributing HY into block cyclic form took 14.873 ms
rank =  0, finding Y'*HY took 4.849 ms
Rank 0, Project_Hamiltonian used 61.397 ms
Total time for projection: 61.420 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 1.122 ms
    first calculated eigval = -1.028868961697989
    last  calculated eigval = 0.034906011306191
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02886896169799
lambda[   2] =  -0.94522814722623
lambda[   3] =  -0.60871679258512
lambda[   4] =  -0.46868585857454
lambda[   5] =  -0.43540384323934
lambda[   6] =  -0.40473862494458
lambda[   7] =  -0.35986232993284
lambda[   8] =  -0.29448456326161
lambda[   9] =  -0.24771816450283
lambda[  10] =  -0.05004084494395
lambda[  11] =  -0.02145728052424
lambda[  12] =   0.00267866769122
lambda[  13] =   0.02581475037155
lambda[  14] =   0.03328689902069
lambda[  15] =   0.03490601130619
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 1.153 ms
rank =  0, subspace rotation using ScaLAPACK took 5.030 ms
rank =  0, Distributing orbital back into band + domain format took 14.369 ms
rank = 0, Subspace_Rotation used 19.428 ms

Total time for subspace rotation: 19.437 ms
rank = 0, Efermi =  -0.079530859093 calculate fermi energy took 0.094 ms
rank = 0, --- Calculate rho: sum over local bands took 3.927 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.433 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.251 ms
rank = 0, Calculating density took 1516.511 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.839 ms
rank = 0, D2D took 1.003 ms
rank = 0, Transfering density took 1.010 ms
Etot    =   -40.293940360139
Eband   =    -9.587414572627
E1      =    19.827569818633
E2      =    -9.413278661348
E3      =   -12.526349429263
Exc     =   -11.185497355527
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.291e-06, dEband = 1.373e-04
rank = 0, Calculating/Estimating energy took 1.048 ms, Etot = -40.293940360, dEtot = 1.291e-06, dEband = 1.373e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281853929392, which took 0.050 ms

iter_count = 108, r_2norm = 9.642e-07, tol*||rhs|| = 1.127e-06

Anderson update took 66.374 ms, out of which F'*F took 30.016 ms; b-Ax took 202.621 ms, out of which Lap took 180.248 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.240 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392745, int_b + int_rho = -1.419e-13, checking this took 0.127 ms
2-norm of RHS = 566.6508939993936, which took 0.148 ms

iter_count = 78, r_2norm = 5.113e-04, tol*||rhs|| = 5.667e-04

Anderson update took 48.851 ms, out of which F'*F took 22.190 ms; b-Ax took 150.929 ms, out of which Lap took 135.262 ms
Solving Poisson took 339.972 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.095724 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.084192 
Total time for convolution: 	 convolve: 5.090081 
Total time for convolution: 	 convolve: 5.086652 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.398 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.365 ms

This SCF took 26718.474 ms, scf error = 1.395e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134906, lowerbound = -1.028869, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1369.114 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 36.377 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 40.164 ms
rank =  0, finding HY took 22.353 ms
rank =  0, distributing HY into block cyclic form took 15.144 ms
rank =  0, finding Y'*HY took 3.435 ms
Rank 0, Project_Hamiltonian used 82.452 ms
Total time for projection: 82.481 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.028841641356136
    last  calculated eigval = 0.034982438832185
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02884164135614
lambda[   2] =  -0.94519619508084
lambda[   3] =  -0.60869280679985
lambda[   4] =  -0.46865904091336
lambda[   5] =  -0.43537296004409
lambda[   6] =  -0.40471099262097
lambda[   7] =  -0.35983421387253
lambda[   8] =  -0.29445709034034
lambda[   9] =  -0.24768662208992
lambda[  10] =  -0.05000764029251
lambda[  11] =  -0.02120490013761
lambda[  12] =   0.00284776586238
lambda[  13] =   0.02589770980151
lambda[  14] =   0.03345207420342
lambda[  15] =   0.03498243883218
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 4.387 ms
rank =  0, Distributing orbital back into band + domain format took 14.887 ms
rank = 0, Subspace_Rotation used 19.297 ms

Total time for subspace rotation: 19.311 ms
rank = 0, Efermi =  -0.079497654403 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 4.034 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.510 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1479.013 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.803 ms
rank = 0, D2D took 1.003 ms
rank = 0, Transfering density took 1.013 ms
Etot    =   -40.293939519322
Eband   =    -9.586903126933
E1      =    19.827284396002
E2      =    -9.413040386542
E3      =   -12.526411957231
Exc     =   -11.185546790935
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.682e-07, dEband = 1.023e-04
rank = 0, Calculating/Estimating energy took 1.095 ms, Etot = -40.293939519, dEtot = 1.682e-07, dEband = 1.023e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0285301268849, which took 0.056 ms

iter_count = 108, r_2norm = 9.748e-07, tol*||rhs|| = 1.141e-06

Anderson update took 66.353 ms, out of which F'*F took 30.023 ms; b-Ax took 203.307 ms, out of which Lap took 180.668 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.672 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392744, int_b + int_rho = -1.528e-13, checking this took 0.120 ms
2-norm of RHS = 566.6505266178507, which took 0.136 ms

iter_count = 54, r_2norm = 5.581e-04, tol*||rhs|| = 5.667e-04

Anderson update took 33.584 ms, out of which F'*F took 15.325 ms; b-Ax took 104.531 ms, out of which Lap took 93.668 ms
Solving Poisson took 236.626 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.095482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.090689 
Total time for convolution: 	 convolve: 5.086322 
Total time for convolution: 	 convolve: 5.091564 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.967 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.407 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.400 ms

This SCF took 26587.108 ms, scf error = 1.338e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134982, lowerbound = -1.028842, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1409.634 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 40.696 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.634 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 44.363 ms
rank =  0, finding HY took 22.599 ms
rank =  0, distributing HY into block cyclic form took 14.906 ms
rank =  0, finding Y'*HY took 4.523 ms
Rank 0, Project_Hamiltonian used 87.221 ms
Total time for projection: 87.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.028843847637830
    last  calculated eigval = 0.034590450701021
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02884384763783
lambda[   2] =  -0.94519675334784
lambda[   3] =  -0.60869739435810
lambda[   4] =  -0.46866345970119
lambda[   5] =  -0.43537582661853
lambda[   6] =  -0.40471410392446
lambda[   7] =  -0.35983842386378
lambda[   8] =  -0.29445976789179
lambda[   9] =  -0.24768824003911
lambda[  10] =  -0.05001884085713
lambda[  11] =  -0.02155787113552
lambda[  12] =   0.00259371716985
lambda[  13] =   0.02575466330845
lambda[  14] =   0.03311884329532
lambda[  15] =   0.03459045070102
==subpsace eigenproblem: bcast eigvals took 0.056 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 3.419 ms
rank =  0, Distributing orbital back into band + domain format took 10.200 ms
rank = 0, Subspace_Rotation used 13.634 ms

Total time for subspace rotation: 13.639 ms
rank = 0, Efermi =  -0.079508854971 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.887 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.449 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1516.424 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.518 ms
rank = 0, D2D took 17.312 ms
rank = 0, Transfering density took 17.323 ms
Etot    =   -40.293944846934
Eband   =    -9.586955635462
E1      =    19.827276122767
E2      =    -9.413096120321
E3      =   -12.526406126090
Exc     =   -11.185541239420
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 1.066e-06, dEband = 1.050e-05
rank = 0, Calculating/Estimating energy took 1.124 ms, Etot = -40.293944847, dEtot = 1.066e-06, dEband = 1.050e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0277705040182, which took 0.136 ms

iter_count = 108, r_2norm = 9.771e-07, tol*||rhs|| = 1.111e-06

Anderson update took 66.360 ms, out of which F'*F took 29.760 ms; b-Ax took 203.010 ms, out of which Lap took 180.343 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.053 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392742, int_b + int_rho = -1.746e-13, checking this took 0.139 ms
2-norm of RHS = 566.6472541812708, which took 0.168 ms

iter_count = 84, r_2norm = 5.471e-04, tol*||rhs|| = 5.666e-04

Anderson update took 52.435 ms, out of which F'*F took 24.026 ms; b-Ax took 162.488 ms, out of which Lap took 145.701 ms
Solving Poisson took 366.098 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.204 ms
Total time for convolution: 	 convolve: 5.092627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.089635 
Total time for convolution: 	 convolve: 5.085508 
Total time for convolution: 	 convolve: 5.093976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.388 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.363 ms

This SCF took 26779.292 ms, scf error = 1.250e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.134590, lowerbound = -1.028844, upperbound = 267.575125

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1380.687 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 31.696 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.690 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.083 ms
rank =  0, Distribute data + matrix mult took 35.491 ms
rank =  0, finding HY took 22.669 ms
rank =  0, distributing HY into block cyclic form took 15.035 ms
rank =  0, finding Y'*HY took 4.482 ms
Rank 0, Project_Hamiltonian used 77.722 ms
Total time for projection: 77.753 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -1.028801378721930
    last  calculated eigval = 0.033864225060553
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02880137872193
lambda[   2] =  -0.94515266028397
lambda[   3] =  -0.60866835595511
lambda[   4] =  -0.46863652178391
lambda[   5] =  -0.43534047337873
lambda[   6] =  -0.40468221153939
lambda[   7] =  -0.35980495130534
lambda[   8] =  -0.29442308617075
lambda[   9] =  -0.24765636625069
lambda[  10] =  -0.05000852563781
lambda[  11] =  -0.02231279634540
lambda[  12] =   0.00204293909845
lambda[  13] =   0.02544355523967
lambda[  14] =   0.03240069106977
lambda[  15] =   0.03386422506055
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 4.358 ms
rank =  0, Distributing orbital back into band + domain format took 14.819 ms
rank = 0, Subspace_Rotation used 19.201 ms

Total time for subspace rotation: 19.208 ms
rank = 0, Efermi =  -0.079498539743 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 3.971 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.498 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.232 ms
rank = 0, Calculating density took 1485.712 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.765 ms
rank = 0, D2D took 0.972 ms
rank = 0, Transfering density took 0.980 ms
Etot    =   -40.293946576738
Eband   =    -9.586332011476
E1      =    19.826782281295
E2      =    -9.412923875223
E3      =   -12.526578587343
Exc     =   -11.185672967893
Esc     =   -61.288226340806
Entropy =    -0.000000000423
dE = 3.460e-07, dEband = 1.247e-04
rank = 0, Calculating/Estimating energy took 1.118 ms, Etot = -40.293946577, dEtot = 3.460e-07, dEband = 1.247e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0189911198059, which took 0.056 ms

iter_count = 108, r_2norm = 6.715e-07, tol*||rhs|| = 7.596e-07

Anderson update took 66.466 ms, out of which F'*F took 30.002 ms; b-Ax took 202.577 ms, out of which Lap took 179.934 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.451 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001392759, int_rho =  18.00000001392750, int_b + int_rho = -9.823e-14, checking this took 0.130 ms
2-norm of RHS = 566.6494405363472, which took 0.151 ms

iter_count = 132, r_2norm = 5.549e-04, tol*||rhs|| = 5.666e-04

Anderson update took 81.993 ms, out of which F'*F took 37.740 ms; b-Ax took 259.953 ms, out of which Lap took 233.358 ms
Solving Poisson took 576.004 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.086896 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.175 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.085971 
Total time for convolution: 	 convolve: 5.088213 
Total time for convolution: 	 convolve: 5.086617 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.589 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.794 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.387 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.210 ms

This SCF took 26916.998 ms, scf error = 9.120e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.02880137872193, occ[   1] =   2.00000000000000
lambda[   2] =  -0.94515266028397, occ[   2] =   2.00000000000000
lambda[   3] =  -0.60866835595511, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46863652178391, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43534047337873, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40468221153939, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35980495130534, occ[   7] =   2.00000000000000
lambda[   8] =  -0.29442308617075, occ[   8] =   2.00000000000000
lambda[   9] =  -0.24765636625069, occ[   9] =   2.00000000000000
lambda[  10] =  -0.05000852563781, occ[  10] =   0.00000001392744
lambda[  11] =  -0.02231279634540, occ[  11] =   0.00000000000000
lambda[  12] =   0.00204293909845, occ[  12] =   0.00000000000000
lambda[  13] =   0.02544355523967, occ[  13] =   0.00000000000000
lambda[  14] =   0.03240069106977, occ[  14] =   0.00000000000000
lambda[  15] =   0.03386422506055, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.429 ms, time for Allreduce/Reduce: 6.440 ms 
Time for calculating local force components: 15.099 ms
Start Calculating nonlocal forces
force_nloc = 
  1.03249456285369  -0.23890714522094  -0.00000031571676
 -1.20055075735829   0.26850274584907  -0.00000168627175
  0.01721807824539  -0.04930586758386  -0.00000003050021
 -0.02806349548326   0.06818386057756  -0.00000002375074
 -0.02699259937408  -0.18059697572151   0.00000041731723
force_loc = 
 -1.00978892739930   0.23164469657849  -0.00000217213852
  1.17934237943399  -0.26449656427645   0.00000181633641
 -0.01963459665761   0.05511681075523   0.00000024309450
  0.02902955050236  -0.07380875009226   0.00000006447880
  0.01687508354150   0.17660807140333   0.00000057085363
Time for calculating nonlocal force components: 32.964 ms
[32mforces_xc: 
[0m[32m -0.02874166341411   0.00790976500601  -0.00000013069798
[0m[32m  0.02825539781860  -0.00561405566265   0.00000008776042
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01057300640472   0.00487771041622  -0.00000000975093
[0mTime for calculating XC forces components: 18.104 ms
 Cartesian force = 
 -0.00603923178244   0.00062445595792  -0.00000238475608
  0.00704381607158  -0.00163073449568   0.00000045162227
 -0.00241972223494   0.00578808276572   0.00000044639147
  0.00096285119638  -0.00564774992035   0.00000027452523
  0.00045228674943   0.00086594569239   0.00000121221711
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.367 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 391.062 ms
The program took 552.454 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:31
Job ID:        2266634
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:52:48,vmem=8488K,walltime=00:09:24,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-36-1
---------------------------------------
