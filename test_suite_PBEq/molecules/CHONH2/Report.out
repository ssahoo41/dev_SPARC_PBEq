---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:20
Job ID:    2266632
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:26
Job ID:    2266632
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.085 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 19.561 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 6.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 1.063 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 97.924 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.009 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.124 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.920410	    9.219186	    9.930440	
   10.913699	   12.499435	    9.923123	
    8.438664	    7.500565	   10.054140	
    7.079590	   10.471836	   10.142435	
   10.964540	   10.416768	    9.923709	
    8.605332	    9.383447	    9.857565	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.200 ms
Set up communicators.

--set up spincomm took 3.194 ms

--set up kptcomm took 0.356 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.063 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.984 ms

Calculate_SplineDerivRadFun took 0.315 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.795 ms.
time spent on vectorized spline interp: 3.652 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.668 ms.
time spent on vectorized spline interp: 1.604 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.329 ms.
time spent on vectorized spline interp: 1.864 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.473 ms.
time spent on vectorized spline interp: 1.670 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.541 ms.

Calculating rb for all atom types took 21.609 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.896 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.018 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000263990, sum_int_rho = 17.6994874376365
PosCharge = 18.000000026399, NegCharge = -17.699487437636, scal_fac = 1.016978604031
After scaling, int_rho = 18.0000000263989, PosCharge + NegCharge - NetCharge = 2.842e-14
--Calculate Vref took 0.342 ms
--Calculate rho_guess took 1.796 ms

 integral of b = -18.0000000263990,
 int{b} + Nelectron + NetCharge = -2.640e-08,
 Esc = -55.2960529475887,
 MPI_Reduce took 5.016 ms

Calculating b & b_ref took 12.367 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.031 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.111 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.026 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.167 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.125 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639903, int_rho =  18.00000002639893, int_b + int_rho = -1.019e-13, checking this took 0.090 ms
2-norm of RHS = 607.7515209123553, which took 0.147 ms

iter_count = 420, r_2norm = 5.232e-04, tol*||rhs|| = 6.078e-04

Anderson update took 263.784 ms, out of which F'*F took 121.958 ms; b-Ax took 819.096 ms, out of which Lap took 729.867 ms
Solving Poisson took 1827.399 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.826 ms
Total time for convolution: 	 convolve: 5.212613 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.092397 
Total time for convolution: 	 convolve: 5.114726 
Total time for convolution: 	 convolve: 5.092974 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.727 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
rank = 0, XC calculation took 24395.344 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.542 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.238 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 5.241 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.137 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.845 ms
    Lanczos iter 53, eigmin  = -1.041998077, eigmax = 264.925391684, err_eigmin = 7.083e-04, err_eigmax = 9.685e-03
rank =   0, Lanczos took 133.546 ms, eigmin = -1.041998077235, eigmax = 267.574645601243

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.216324, lowerbound = -1.141998, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1385.583 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 48.820 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.267 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.924 ms
rank =  0, Distribute data + matrix mult took 54.029 ms
rank =  0, finding HY took 22.857 ms
rank =  0, distributing HY into block cyclic form took 14.149 ms
rank =  0, finding Y'*HY took 6.353 ms
Rank 0, Project_Hamiltonian used 97.427 ms
Total time for projection: 97.445 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.357 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.431 ms
    first calculated eigval = 2.789032246713972
    last  calculated eigval = 3.219667753898666
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.78903224671397
lambda[   2] =   2.85226213534265
lambda[   3] =   2.88790098829087
lambda[   4] =   2.93551889910661
lambda[   5] =   2.94072541155502
lambda[   6] =   2.96512266032113
lambda[   7] =   2.99885484414257
lambda[   8] =   3.00589290957900
lambda[   9] =   3.04489392430350
lambda[  10] =   3.06899335905069
lambda[  11] =   3.10094269464173
lambda[  12] =   3.11723569263397
lambda[  13] =   3.15162698544203
lambda[  14] =   3.16493236919332
lambda[  15] =   3.21966775389867
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.450 ms
rank =  0, subspace rotation using ScaLAPACK took 4.258 ms
rank =  0, Distributing orbital back into band + domain format took 14.199 ms
rank = 0, Subspace_Rotation used 18.478 ms

Total time for subspace rotation: 18.481 ms
rank = 0, Efermi =   3.056943642941 calculate fermi energy took 0.069 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.319668, lowerbound = -1.141998, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1380.405 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 41.439 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.680 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 45.254 ms
rank =  0, finding HY took 25.058 ms
rank =  0, distributing HY into block cyclic form took 14.306 ms
rank =  0, finding Y'*HY took 4.711 ms
Rank 0, Project_Hamiltonian used 89.360 ms
Total time for projection: 89.369 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.198 ms
    first calculated eigval = -0.839202421302536
    last  calculated eigval = 0.441960521486687
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83920242130254
lambda[   2] =  -0.69922333314296
lambda[   3] =  -0.30440660119294
lambda[   4] =  -0.05463105530555
lambda[   5] =   0.02571890835674
lambda[   6] =   0.06554619944868
lambda[   7] =   0.22672392090727
lambda[   8] =   0.29530876123012
lambda[   9] =   0.30920883665472
lambda[  10] =   0.34733441912463
lambda[  11] =   0.36485842336589
lambda[  12] =   0.38361602187952
lambda[  13] =   0.40542619789515
lambda[  14] =   0.41618304463808
lambda[  15] =   0.44196052148669
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 4.642 ms
rank =  0, Distributing orbital back into band + domain format took 13.996 ms
rank = 0, Subspace_Rotation used 18.660 ms

Total time for subspace rotation: 18.668 ms
rank = 0, Efermi =   0.328271700251 calculate fermi energy took 0.036 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.541961, lowerbound = -1.141998, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1442.083 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.823 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.632 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.091 ms
rank =  0, Distribute data + matrix mult took 19.576 ms
rank =  0, finding HY took 21.841 ms
rank =  0, distributing HY into block cyclic form took 14.305 ms
rank =  0, finding Y'*HY took 4.690 ms
Rank 0, Project_Hamiltonian used 60.472 ms
Total time for projection: 60.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -1.060269459452271
    last  calculated eigval = 0.150240261226095
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.06026945945227
lambda[   2] =  -0.94402649251660
lambda[   3] =  -0.65970220367851
lambda[   4] =  -0.60059215355371
lambda[   5] =  -0.52007559914349
lambda[   6] =  -0.46593674969239
lambda[   7] =  -0.38971149952240
lambda[   8] =  -0.27701883365744
lambda[   9] =  -0.25662928355872
lambda[  10] =  -0.03148694808563
lambda[  11] =   0.04227655260681
lambda[  12] =   0.10172591826014
lambda[  13] =   0.11194906182398
lambda[  14] =   0.12518022397095
lambda[  15] =   0.15024026122610
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.269 ms
rank =  0, Distributing orbital back into band + domain format took 14.294 ms
rank = 0, Subspace_Rotation used 18.588 ms

Total time for subspace rotation: 18.592 ms
rank = 0, Efermi =  -0.060402697473 calculate fermi energy took 0.027 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.250240, lowerbound = -1.141998, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1388.437 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.048 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.734 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.079 ms
rank =  0, Distribute data + matrix mult took 30.891 ms
rank =  0, finding HY took 21.924 ms
rank =  0, distributing HY into block cyclic form took 14.154 ms
rank =  0, finding Y'*HY took 4.937 ms
Rank 0, Project_Hamiltonian used 71.960 ms
Total time for projection: 71.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 1.144 ms
    first calculated eigval = -1.060512750363545
    last  calculated eigval = 0.095118975692584
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.06051275036354
lambda[   2] =  -0.94432050180540
lambda[   3] =  -0.66463430109668
lambda[   4] =  -0.60282475361779
lambda[   5] =  -0.53118864482315
lambda[   6] =  -0.47642047628636
lambda[   7] =  -0.44676669787683
lambda[   8] =  -0.34557577208691
lambda[   9] =  -0.32317702900678
lambda[  10] =  -0.09123929984012
lambda[  11] =  -0.00943285889971
lambda[  12] =   0.04237668249852
lambda[  13] =   0.04995137804155
lambda[  14] =   0.06677043230049
lambda[  15] =   0.09511897569258
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.163 ms
rank =  0, subspace rotation using ScaLAPACK took 4.236 ms
rank =  0, Distributing orbital back into band + domain format took 14.311 ms
rank = 0, Subspace_Rotation used 18.579 ms

Total time for subspace rotation: 18.584 ms
rank = 0, Efermi =  -0.120155049196 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.137 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.094 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.195 ms
rank = 0, Calculating density took 6136.124 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.622 ms
rank = 0, D2D took 1.094 ms
rank = 0, Transfering density took 1.104 ms
Etot    =   -34.804285224937
Eband   =   -10.790841856336
E1      =    20.962361409234
E2      =    -9.117902469193
E3      =   -11.291465839067
Exc     =   -10.089120137720
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 5.801e+00, dEband = 1.798e+00
rank = 0, Calculating/Estimating energy took 1.225 ms, Etot = -34.804285225, dEtot = 5.801e+00, dEband = 1.798e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 53.8704196673455, which took 0.051 ms

iter_count = 96, r_2norm = 1.313e-03, tol*||rhs|| = 2.155e-03

Anderson update took 57.981 ms, out of which F'*F took 27.402 ms; b-Ax took 183.007 ms, out of which Lap took 163.656 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.927 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639893, int_b + int_rho = -9.095e-14, checking this took 0.122 ms
2-norm of RHS = 603.5453458685689, which took 0.172 ms

iter_count = 282, r_2norm = 5.923e-04, tol*||rhs|| = 6.035e-04

Anderson update took 172.898 ms, out of which F'*F took 77.729 ms; b-Ax took 530.586 ms, out of which Lap took 467.926 ms
Solving Poisson took 1203.828 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.789 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.152767 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.416 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.235 ms
Total time for convolution: 	 convolve: 5.150596 
Total time for convolution: 	 convolve: 5.165550 
Total time for convolution: 	 convolve: 5.157628 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.397 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.950 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.810 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.780 ms

This SCF took 32399.964 ms, scf error = 1.495e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.195119, lowerbound = -1.060513, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1433.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 24.873 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.569 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.253 ms
rank =  0, Distribute data + matrix mult took 28.712 ms
rank =  0, finding HY took 21.408 ms
rank =  0, distributing HY into block cyclic form took 14.158 ms
rank =  0, finding Y'*HY took 5.243 ms
Rank 0, Project_Hamiltonian used 70.481 ms
Total time for projection: 70.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -1.026038958881375
    last  calculated eigval = 0.076480761778348
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.02603895888137
lambda[   2] =  -0.90393047275908
lambda[   3] =  -0.63526649355245
lambda[   4] =  -0.56932353124758
lambda[   5] =  -0.50051110740484
lambda[   6] =  -0.44173529182663
lambda[   7] =  -0.42087376024031
lambda[   8] =  -0.30652827916954
lambda[   9] =  -0.28736190031924
lambda[  10] =  -0.07876559436999
lambda[  11] =  -0.02924279515033
lambda[  12] =   0.01089962117918
lambda[  13] =   0.02763541785348
lambda[  14] =   0.04193325449841
lambda[  15] =   0.07648076177835
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 4.275 ms
rank =  0, Distributing orbital back into band + domain format took 14.235 ms
rank = 0, Subspace_Rotation used 18.526 ms

Total time for subspace rotation: 18.530 ms
rank = 0, Efermi =  -0.107681343738 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.049 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.005 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.203 ms
rank = 0, Calculating density took 1529.767 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.662 ms
rank = 0, D2D took 0.923 ms
rank = 0, Transfering density took 0.933 ms
Etot    =   -34.762726841139
Eband   =   -10.183139592881
E1      =    20.460454693964
E2      =    -9.020967368774
E3      =   -11.447830749675
Exc     =   -10.212787112295
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 6.926e-03, dEband = 1.013e-01
rank = 0, Calculating/Estimating energy took 1.197 ms, Etot = -34.762726841, dEtot = 6.926e-03, dEband = 1.013e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 21.6678281864931, which took 0.083 ms

iter_count = 102, r_2norm = 5.618e-04, tol*||rhs|| = 8.667e-04

Anderson update took 61.843 ms, out of which F'*F took 28.295 ms; b-Ax took 192.010 ms, out of which Lap took 170.301 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.736 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639888, int_b + int_rho = -1.455e-13, checking this took 0.116 ms
2-norm of RHS = 600.2647351912734, which took 0.215 ms

iter_count = 294, r_2norm = 4.815e-04, tol*||rhs|| = 6.003e-04

Anderson update took 175.256 ms, out of which F'*F took 79.969 ms; b-Ax took 549.816 ms, out of which Lap took 488.358 ms
Solving Poisson took 1253.546 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.745 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.195695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.727 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
Total time for convolution: 	 convolve: 5.188845 
Total time for convolution: 	 convolve: 5.190812 
Total time for convolution: 	 convolve: 5.201816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.804 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.759 ms

This SCF took 28030.081 ms, scf error = 9.316e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.176481, lowerbound = -1.026039, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1361.543 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 30.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.083 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 34.743 ms
rank =  0, finding HY took 22.609 ms
rank =  0, distributing HY into block cyclic form took 14.506 ms
rank =  0, finding Y'*HY took 4.886 ms
Rank 0, Project_Hamiltonian used 76.778 ms
Total time for projection: 76.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -0.984704184859215
    last  calculated eigval = 0.069132286239355
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.98470418485921
lambda[   2] =  -0.86031947686657
lambda[   3] =  -0.59900985641225
lambda[   4] =  -0.53160991796547
lambda[   5] =  -0.46292862921236
lambda[   6] =  -0.39999171628963
lambda[   7] =  -0.39015704857908
lambda[   8] =  -0.26667266132553
lambda[   9] =  -0.24644648581426
lambda[  10] =  -0.05225290072706
lambda[  11] =  -0.03406242077926
lambda[  12] =   0.00065919104964
lambda[  13] =   0.01990886131510
lambda[  14] =   0.03523776653707
lambda[  15] =   0.06913228623935
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 4.187 ms
rank =  0, Distributing orbital back into band + domain format took 14.454 ms
rank = 0, Subspace_Rotation used 18.659 ms

Total time for subspace rotation: 18.663 ms
rank = 0, Efermi =  -0.081168650099 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.148 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.695 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1464.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
rank = 0, D2D took 1.086 ms
rank = 0, Transfering density took 1.096 ms
Etot    =   -34.740750365050
Eband   =    -9.483679956028
E1      =    19.905931139832
E2      =    -8.858004053171
E3      =   -11.637864022945
Exc     =   -10.362816676595
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 3.663e-03, dEband = 1.166e-01
rank = 0, Calculating/Estimating energy took 1.233 ms, Etot = -34.740750365, dEtot = 3.663e-03, dEband = 1.166e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.2509973324255, which took 0.148 ms

iter_count = 102, r_2norm = 1.977e-04, tol*||rhs|| = 2.100e-04

Anderson update took 61.578 ms, out of which F'*F took 27.339 ms; b-Ax took 187.571 ms, out of which Lap took 166.118 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.771 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639888, int_b + int_rho = -1.455e-13, checking this took 0.132 ms
2-norm of RHS = 601.1712999227974, which took 0.141 ms

iter_count = 282, r_2norm = 5.904e-04, tol*||rhs|| = 6.012e-04

Anderson update took 174.792 ms, out of which F'*F took 80.068 ms; b-Ax took 542.634 ms, out of which Lap took 487.182 ms
Solving Poisson took 1191.924 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.627 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.101221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.932 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.099216 
Total time for convolution: 	 convolve: 5.097449 
Total time for convolution: 	 convolve: 5.111738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 706.396 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.399 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.005 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.931 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.600 ms

This SCF took 28227.837 ms, scf error = 4.323e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.169132, lowerbound = -0.984704, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1416.763 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.624 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.038 ms
rank =  0, Distribute data + matrix mult took 18.287 ms
rank =  0, finding HY took 21.821 ms
rank =  0, distributing HY into block cyclic form took 15.132 ms
rank =  0, finding Y'*HY took 5.120 ms
Rank 0, Project_Hamiltonian used 60.398 ms
Total time for projection: 60.411 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.966926941762735
    last  calculated eigval = 0.064147152931119
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96692694176274
lambda[   2] =  -0.84623770626774
lambda[   3] =  -0.57980093954615
lambda[   4] =  -0.51651180718768
lambda[   5] =  -0.44360082277404
lambda[   6] =  -0.38222903265275
lambda[   7] =  -0.37614837472269
lambda[   8] =  -0.25766172706030
lambda[   9] =  -0.23207423667870
lambda[  10] =  -0.03791014297205
lambda[  11] =  -0.03534766708776
lambda[  12] =  -0.00157255322404
lambda[  13] =   0.01640006383975
lambda[  14] =   0.03148785215681
lambda[  15] =   0.06414715293112
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.368 ms
rank =  0, Distributing orbital back into band + domain format took 14.419 ms
rank = 0, Subspace_Rotation used 18.801 ms

Total time for subspace rotation: 18.807 ms
rank = 0, Efermi =  -0.066872121277 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.937 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.296 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.286 ms
rank = 0, Calculating density took 1503.788 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.919 ms
rank = 0, Transfering density took 0.926 ms
Etot    =   -34.735870527147
Eband   =    -9.202383178303
E1      =    19.729990674393
E2      =    -8.739260961378
E3      =   -11.716565759909
Exc     =   -10.423251796145
Esc     =   -55.296052947589
Entropy =    -0.000000000791
dE = 8.133e-04, dEband = 4.688e-02
rank = 0, Calculating/Estimating energy took 1.342 ms, Etot = -34.735870527, dEtot = 8.133e-04, dEband = 4.688e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3878243403149, which took 0.057 ms

iter_count = 108, r_2norm = 7.527e-05, tol*||rhs|| = 9.551e-05

Anderson update took 66.843 ms, out of which F'*F took 30.597 ms; b-Ax took 206.179 ms, out of which Lap took 183.766 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.588 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639895, int_b + int_rho = -7.640e-14, checking this took 0.102 ms
2-norm of RHS = 601.3110050991889, which took 0.135 ms

iter_count = 246, r_2norm = 5.657e-04, tol*||rhs|| = 6.013e-04

Anderson update took 150.513 ms, out of which F'*F took 67.559 ms; b-Ax took 461.332 ms, out of which Lap took 409.993 ms
Solving Poisson took 1044.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.101282 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.097587 
Total time for convolution: 	 convolve: 5.098434 
Total time for convolution: 	 convolve: 5.101186 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.022 ms
---Transfer Veff_loc: D2D took 1.740 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.825 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.590 ms

This SCF took 27558.935 ms, scf error = 1.070e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.164147, lowerbound = -0.966927, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1427.788 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.592 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.537 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.101 ms
rank =  0, Distribute data + matrix mult took 18.253 ms
rank =  0, finding HY took 22.096 ms
rank =  0, distributing HY into block cyclic form took 14.365 ms
rank =  0, finding Y'*HY took 4.727 ms
Rank 0, Project_Hamiltonian used 59.482 ms
Total time for projection: 59.496 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.962511032853554
    last  calculated eigval = 0.059032792651921
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96251103285355
lambda[   2] =  -0.84333929223599
lambda[   3] =  -0.57734679863004
lambda[   4] =  -0.51381987819050
lambda[   5] =  -0.44045985444528
lambda[   6] =  -0.37734621715135
lambda[   7] =  -0.37305945456571
lambda[   8] =  -0.25413583837287
lambda[   9] =  -0.22700742556517
lambda[  10] =  -0.03727113641066
lambda[  11] =  -0.03470440077343
lambda[  12] =  -0.00264017519904
lambda[  13] =   0.01464372170641
lambda[  14] =   0.02817414736766
lambda[  15] =   0.05903279265192
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 4.381 ms
rank =  0, Distributing orbital back into band + domain format took 14.413 ms
rank = 0, Subspace_Rotation used 18.814 ms

Total time for subspace rotation: 18.818 ms
rank = 0, Efermi =  -0.066232886457 calculate fermi energy took 2.279 ms
rank = 0, --- Calculate rho: sum over local bands took 4.169 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.012 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.207 ms
rank = 0, Calculating density took 1515.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.689 ms
rank = 0, D2D took 0.992 ms
rank = 0, Transfering density took 0.996 ms
Etot    =   -34.735247371356
Eband   =    -9.138051585001
E1      =    19.694183572821
E2      =    -8.706945668816
E3      =   -11.733574806731
Exc     =   -10.435846886343
Esc     =   -55.296052947589
Entropy =    -0.000000000791
dE = 1.039e-04, dEband = 1.072e-02
rank = 0, Calculating/Estimating energy took 1.194 ms, Etot = -34.735247371, dEtot = 1.039e-04, dEband = 1.072e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0859275365660, which took 0.055 ms

iter_count = 114, r_2norm = 2.666e-05, tol*||rhs|| = 4.344e-05

Anderson update took 69.799 ms, out of which F'*F took 32.542 ms; b-Ax took 216.923 ms, out of which Lap took 194.206 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.375 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639891, int_b + int_rho = -1.128e-13, checking this took 0.122 ms
2-norm of RHS = 601.7389720798079, which took 0.087 ms

iter_count = 246, r_2norm = 5.911e-04, tol*||rhs|| = 6.017e-04

Anderson update took 149.645 ms, out of which F'*F took 69.747 ms; b-Ax took 467.724 ms, out of which Lap took 417.691 ms
Solving Poisson took 1040.661 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.101213 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.849 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.099508 
Total time for convolution: 	 convolve: 5.110710 
Total time for convolution: 	 convolve: 5.090588 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.626 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.593 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.393 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.382 ms

This SCF took 27480.579 ms, scf error = 6.907e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.159033, lowerbound = -0.962511, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1451.657 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.621 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.534 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.287 ms
rank =  0, Distribute data + matrix mult took 18.460 ms
rank =  0, finding HY took 22.009 ms
rank =  0, distributing HY into block cyclic form took 14.342 ms
rank =  0, finding Y'*HY took 4.737 ms
Rank 0, Project_Hamiltonian used 59.587 ms
Total time for projection: 59.604 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.960057500475521
    last  calculated eigval = 0.053075233813691
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.96005750047552
lambda[   2] =  -0.84193893410239
lambda[   3] =  -0.57606746014033
lambda[   4] =  -0.51238884824847
lambda[   5] =  -0.43865144280328
lambda[   6] =  -0.37448543359687
lambda[   7] =  -0.37099820428949
lambda[   8] =  -0.25217303179839
lambda[   9] =  -0.22403900946123
lambda[  10] =  -0.03772745797140
lambda[  11] =  -0.03352457185708
lambda[  12] =  -0.00307465883233
lambda[  13] =   0.01310680776381
lambda[  14] =   0.02581165295414
lambda[  15] =   0.05307523381369
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.380 ms
rank =  0, Distributing orbital back into band + domain format took 14.374 ms
rank = 0, Subspace_Rotation used 18.771 ms

Total time for subspace rotation: 18.777 ms
rank = 0, Efermi =  -0.066649564940 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.073 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.204 ms
rank = 0, Calculating density took 1538.014 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.743 ms
rank = 0, D2D took 0.955 ms
rank = 0, Transfering density took 0.959 ms
Etot    =   -34.734932881669
Eband   =    -9.101599730827
E1      =    19.686239152170
E2      =    -8.676351589083
E3      =   -11.739710021900
Exc     =   -10.439580965618
Esc     =   -55.296052947589
Entropy =    -0.000000000788
dE = 5.241e-05, dEband = 6.075e-03
rank = 0, Calculating/Estimating energy took 2.080 ms, Etot = -34.734932882, dEtot = 5.241e-05, dEband = 6.075e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6012731422275, which took 0.063 ms

iter_count = 108, r_2norm = 2.076e-05, tol*||rhs|| = 2.405e-05

Anderson update took 65.379 ms, out of which F'*F took 30.363 ms; b-Ax took 203.643 ms, out of which Lap took 182.575 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.900 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639892, int_b + int_rho = -1.055e-13, checking this took 0.139 ms
2-norm of RHS = 601.9495316984139, which took 0.132 ms

iter_count = 246, r_2norm = 4.870e-04, tol*||rhs|| = 6.019e-04

Anderson update took 148.747 ms, out of which F'*F took 69.273 ms; b-Ax took 462.535 ms, out of which Lap took 414.446 ms
Solving Poisson took 1035.684 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.110204 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.108582 
Total time for convolution: 	 convolve: 5.106302 
Total time for convolution: 	 convolve: 5.099880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.382 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 27474.658 ms, scf error = 3.914e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.153075, lowerbound = -0.960058, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.359 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.726 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.638 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 18.406 ms
rank =  0, finding HY took 21.991 ms
rank =  0, distributing HY into block cyclic form took 14.237 ms
rank =  0, finding Y'*HY took 4.843 ms
Rank 0, Project_Hamiltonian used 59.518 ms
Total time for projection: 59.538 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.958052591634287
    last  calculated eigval = 0.046449235770590
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95805259163429
lambda[   2] =  -0.83995655070056
lambda[   3] =  -0.57430900370825
lambda[   4] =  -0.51065854187424
lambda[   5] =  -0.43680842896019
lambda[   6] =  -0.37243980088817
lambda[   7] =  -0.36891799249451
lambda[   8] =  -0.25022141851468
lambda[   9] =  -0.22222274988288
lambda[  10] =  -0.03793735261476
lambda[  11] =  -0.03184498204892
lambda[  12] =  -0.00297994958904
lambda[  13] =   0.01202057425760
lambda[  14] =   0.02438080280960
lambda[  15] =   0.04644923577059
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.364 ms
rank =  0, Distributing orbital back into band + domain format took 14.407 ms
rank = 0, Subspace_Rotation used 18.792 ms

Total time for subspace rotation: 18.797 ms
rank = 0, Efermi =  -0.066853660629 calculate fermi energy took 0.101 ms
rank = 0, --- Calculate rho: sum over local bands took 4.181 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.363 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.222 ms
rank = 0, Calculating density took 1476.812 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.694 ms
rank = 0, D2D took 2.233 ms
rank = 0, Transfering density took 2.240 ms
Etot    =   -34.734809600822
Eband   =    -9.067174158317
E1      =    19.674459580014
E2      =    -8.652634512951
E3      =   -11.742450027775
Exc     =   -10.441126614869
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 2.055e-05, dEband = 5.738e-03
rank = 0, Calculating/Estimating energy took 1.071 ms, Etot = -34.734809601, dEtot = 2.055e-05, dEband = 5.738e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2723610299210, which took 0.056 ms

iter_count = 114, r_2norm = 6.966e-06, tol*||rhs|| = 1.089e-05

Anderson update took 69.017 ms, out of which F'*F took 31.730 ms; b-Ax took 213.783 ms, out of which Lap took 191.120 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.916 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639901, int_b + int_rho = -7.276e-15, checking this took 0.124 ms
2-norm of RHS = 601.9976676222327, which took 0.181 ms

iter_count = 240, r_2norm = 5.793e-04, tol*||rhs|| = 6.020e-04

Anderson update took 145.565 ms, out of which F'*F took 67.856 ms; b-Ax took 455.068 ms, out of which Lap took 409.679 ms
Solving Poisson took 1010.877 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.104665 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.659 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 6.352294 
Total time for convolution: 	 convolve: 5.102448 
Total time for convolution: 	 convolve: 5.219404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.576 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.384 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.340 ms

This SCF took 28785.617 ms, scf error = 2.160e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.146449, lowerbound = -0.958053, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1392.556 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.434 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.586 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.055 ms
rank =  0, finding HY took 22.043 ms
rank =  0, distributing HY into block cyclic form took 14.434 ms
rank =  0, finding Y'*HY took 4.619 ms
Rank 0, Project_Hamiltonian used 59.196 ms
Total time for projection: 59.211 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.954389982183642
    last  calculated eigval = 0.040142018531297
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95438998218364
lambda[   2] =  -0.83769776992107
lambda[   3] =  -0.57207731206999
lambda[   4] =  -0.50873903333969
lambda[   5] =  -0.43425237114017
lambda[   6] =  -0.36893608005280
lambda[   7] =  -0.36573647317136
lambda[   8] =  -0.24760114130918
lambda[   9] =  -0.21881219635157
lambda[  10] =  -0.03746553019667
lambda[  11] =  -0.02911821280345
lambda[  12] =  -0.00184199903384
lambda[  13] =   0.01170745169998
lambda[  14] =   0.02432968049726
lambda[  15] =   0.04014201853130
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 4.426 ms
rank =  0, Distributing orbital back into band + domain format took 14.344 ms
rank = 0, Subspace_Rotation used 18.789 ms

Total time for subspace rotation: 18.794 ms
rank = 0, Efermi =  -0.066381305275 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.098 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.399 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.217 ms
rank = 0, Calculating density took 1478.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.315 ms
rank = 0, D2D took 1.428 ms
rank = 0, Transfering density took 1.431 ms
Etot    =   -34.734842684723
Eband   =    -9.016484720068
E1      =    19.649543364832
E2      =    -8.625193477559
E3      =   -11.748174361331
Exc     =   -10.445216220002
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 5.514e-06, dEband = 8.448e-03
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -34.734842685, dEtot = 5.514e-06, dEband = 8.448e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2260456825228, which took 0.057 ms

iter_count = 108, r_2norm = 8.714e-06, tol*||rhs|| = 9.042e-06

Anderson update took 65.174 ms, out of which F'*F took 32.461 ms; b-Ax took 204.969 ms, out of which Lap took 183.612 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.623 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639907, int_b + int_rho = 4.366e-14, checking this took 0.128 ms
2-norm of RHS = 601.9781764820133, which took 0.129 ms

iter_count = 216, r_2norm = 5.249e-04, tol*||rhs|| = 6.020e-04

Anderson update took 130.932 ms, out of which F'*F took 61.145 ms; b-Ax took 409.195 ms, out of which Lap took 368.110 ms
Solving Poisson took 910.271 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.103221 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.911 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.100690 
Total time for convolution: 	 convolve: 5.121205 
Total time for convolution: 	 convolve: 5.100594 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.928 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.390 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.341 ms

This SCF took 27306.248 ms, scf error = 1.163e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.140142, lowerbound = -0.954390, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1384.727 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.896 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.783 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 18.711 ms
rank =  0, finding HY took 22.076 ms
rank =  0, distributing HY into block cyclic form took 14.335 ms
rank =  0, finding Y'*HY took 4.750 ms
Rank 0, Project_Hamiltonian used 59.911 ms
Total time for projection: 59.932 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.952954446894758
    last  calculated eigval = 0.034442651970572
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95295444689476
lambda[   2] =  -0.83653381470164
lambda[   3] =  -0.57090082450129
lambda[   4] =  -0.50767954370558
lambda[   5] =  -0.43300096118108
lambda[   6] =  -0.36755487805731
lambda[   7] =  -0.36440520730629
lambda[   8] =  -0.24642704280082
lambda[   9] =  -0.21748824561178
lambda[  10] =  -0.03652528898901
lambda[  11] =  -0.02781012139578
lambda[  12] =  -0.00042566246462
lambda[  13] =   0.01179891603484
lambda[  14] =   0.02434724021198
lambda[  15] =   0.03444265197057
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.450 ms
rank =  0, Distributing orbital back into band + domain format took 14.190 ms
rank = 0, Subspace_Rotation used 19.143 ms

Total time for subspace rotation: 19.152 ms
rank = 0, Efermi =  -0.065441053681 calculate fermi energy took 0.682 ms
rank = 0, --- Calculate rho: sum over local bands took 4.274 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.586 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.221 ms
rank = 0, Calculating density took 1471.821 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.742 ms
rank = 0, D2D took 0.962 ms
rank = 0, Transfering density took 0.967 ms
Etot    =   -34.734887853417
Eband   =    -8.993889930485
E1      =    19.637368114403
E2      =    -8.614209749828
E3      =   -11.750502658241
Exc     =   -10.447025497030
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 7.528e-06, dEband = 3.766e-03
rank = 0, Calculating/Estimating energy took 1.198 ms, Etot = -34.734887853, dEtot = 7.528e-06, dEband = 3.766e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1143291169648, which took 0.057 ms

iter_count = 108, r_2norm = 4.219e-06, tol*||rhs|| = 4.573e-06

Anderson update took 65.103 ms, out of which F'*F took 30.200 ms; b-Ax took 202.590 ms, out of which Lap took 181.041 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.852 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639893, int_b + int_rho = -9.823e-14, checking this took 0.134 ms
2-norm of RHS = 601.9665442370870, which took 0.188 ms

iter_count = 222, r_2norm = 4.990e-04, tol*||rhs|| = 6.020e-04

Anderson update took 135.146 ms, out of which F'*F took 62.552 ms; b-Ax took 421.557 ms, out of which Lap took 379.720 ms
Solving Poisson took 935.638 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.106765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.632 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.103900 
Total time for convolution: 	 convolve: 5.102001 
Total time for convolution: 	 convolve: 5.099614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.323 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.954 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.391 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 27356.682 ms, scf error = 8.553e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.134443, lowerbound = -0.952954, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1388.926 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.741 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.065 ms
rank =  0, Distribute data + matrix mult took 18.108 ms
rank =  0, finding HY took 21.922 ms
rank =  0, distributing HY into block cyclic form took 14.364 ms
rank =  0, finding Y'*HY took 4.604 ms
Rank 0, Project_Hamiltonian used 59.036 ms
Total time for projection: 59.053 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.951769088975379
    last  calculated eigval = 0.031380479304742
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95176908897538
lambda[   2] =  -0.83552953258078
lambda[   3] =  -0.56985006916214
lambda[   4] =  -0.50668257054295
lambda[   5] =  -0.43185660305812
lambda[   6] =  -0.36634761659968
lambda[   7] =  -0.36322014261302
lambda[   8] =  -0.24532110341485
lambda[   9] =  -0.21624818659087
lambda[  10] =  -0.03316352175022
lambda[  11] =  -0.02643530464127
lambda[  12] =   0.00400905998641
lambda[  13] =   0.01369126175280
lambda[  14] =   0.02622865652602
lambda[  15] =   0.03138047930474
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 4.282 ms
rank =  0, Distributing orbital back into band + domain format took 15.190 ms
rank = 0, Subspace_Rotation used 19.500 ms

Total time for subspace rotation: 19.505 ms
rank = 0, Efermi =  -0.062079510209 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.886 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.520 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.262 ms
rank = 0, Calculating density took 1475.479 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.593 ms
rank = 0, D2D took 0.724 ms
rank = 0, Transfering density took 0.731 ms
Etot    =   -34.734965296492
Eband   =    -8.973649827951
E1      =    19.628185001298
E2      =    -8.603051320200
E3      =   -11.750987437078
Exc     =   -10.447486278741
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 1.291e-05, dEband = 3.373e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -34.734965296, dEtot = 1.291e-05, dEband = 3.373e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1201669834662, which took 0.051 ms

iter_count = 108, r_2norm = 3.455e-06, tol*||rhs|| = 4.807e-06

Anderson update took 64.874 ms, out of which F'*F took 30.485 ms; b-Ax took 202.869 ms, out of which Lap took 181.379 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.195 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639899, int_b + int_rho = -2.910e-14, checking this took 0.125 ms
2-norm of RHS = 601.9767995012614, which took 0.190 ms

iter_count = 198, r_2norm = 5.408e-04, tol*||rhs|| = 6.020e-04

Anderson update took 120.301 ms, out of which F'*F took 56.170 ms; b-Ax took 375.359 ms, out of which Lap took 338.008 ms
Solving Poisson took 834.569 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.104014 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.461 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.104669 
Total time for convolution: 	 convolve: 5.097551 
Total time for convolution: 	 convolve: 5.102411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 2.061 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.932 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.383 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.338 ms

This SCF took 27265.445 ms, scf error = 5.072e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131380, lowerbound = -0.951769, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1406.858 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.656 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.625 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 18.316 ms
rank =  0, finding HY took 21.967 ms
rank =  0, distributing HY into block cyclic form took 14.347 ms
rank =  0, finding Y'*HY took 4.742 ms
Rank 0, Project_Hamiltonian used 59.416 ms
Total time for projection: 59.446 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.950719734503734
    last  calculated eigval = 0.029514570490845
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95071973450373
lambda[   2] =  -0.83459210826630
lambda[   3] =  -0.56892195878190
lambda[   4] =  -0.50581320916882
lambda[   5] =  -0.43090689709973
lambda[   6] =  -0.36535715982561
lambda[   7] =  -0.36224084457451
lambda[   8] =  -0.24438724766954
lambda[   9] =  -0.21523088890486
lambda[  10] =  -0.03043397949967
lambda[  11] =  -0.02549943388604
lambda[  12] =   0.00649069489948
lambda[  13] =   0.01466259436699
lambda[  14] =   0.02752536301012
lambda[  15] =   0.02951457049084
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 4.276 ms
rank =  0, Distributing orbital back into band + domain format took 15.146 ms
rank = 0, Subspace_Rotation used 19.446 ms

Total time for subspace rotation: 19.450 ms
rank = 0, Efermi =  -0.059352249230 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.027 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.223 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.242 ms
rank = 0, Calculating density took 1493.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.778 ms
rank = 0, D2D took 0.903 ms
rank = 0, Transfering density took 0.909 ms
Etot    =   -34.735047688207
Eband   =    -8.956340098393
E1      =    19.619091809287
E2      =    -8.594375871258
E3      =   -11.752810622994
Exc     =   -10.448932944977
Esc     =   -55.296052947589
Entropy =    -0.000000000787
dE = 1.373e-05, dEband = 2.885e-03
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -34.735047688, dEtot = 1.373e-05, dEband = 2.885e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1049619334909, which took 0.055 ms

iter_count = 102, r_2norm = 4.091e-06, tol*||rhs|| = 4.198e-06

Anderson update took 61.523 ms, out of which F'*F took 28.522 ms; b-Ax took 191.225 ms, out of which Lap took 171.101 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.329 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639899, int_b + int_rho = -2.910e-14, checking this took 0.129 ms
2-norm of RHS = 601.9903400422917, which took 0.157 ms

iter_count = 180, r_2norm = 5.269e-04, tol*||rhs|| = 6.020e-04

Anderson update took 109.163 ms, out of which F'*F took 51.083 ms; b-Ax took 341.223 ms, out of which Lap took 307.107 ms
Solving Poisson took 759.127 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.110267 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.103159 
Total time for convolution: 	 convolve: 5.106271 
Total time for convolution: 	 convolve: 5.108448 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.416 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.395 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.354 ms

This SCF took 27171.005 ms, scf error = 3.185e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.129515, lowerbound = -0.950720, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1423.587 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.747 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.515 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.128 ms
rank =  0, Distribute data + matrix mult took 18.410 ms
rank =  0, finding HY took 22.112 ms
rank =  0, distributing HY into block cyclic form took 14.376 ms
rank =  0, finding Y'*HY took 4.742 ms
Rank 0, Project_Hamiltonian used 59.681 ms
Total time for projection: 59.701 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.583 ms
rank = 0, Solve_Generalized_EigenProblem used 1.076 ms
    first calculated eigval = -0.950462744785936
    last  calculated eigval = 0.029788671805451
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95046274478594
lambda[   2] =  -0.83428458069564
lambda[   3] =  -0.56860279569857
lambda[   4] =  -0.50550185286241
lambda[   5] =  -0.43059922003825
lambda[   6] =  -0.36510081747164
lambda[   7] =  -0.36195545477939
lambda[   8] =  -0.24409581217954
lambda[   9] =  -0.21497053846278
lambda[  10] =  -0.02762910606515
lambda[  11] =  -0.02499207425310
lambda[  12] =   0.00875345183054
lambda[  13] =   0.01519610254735
lambda[  14] =   0.02944618871145
lambda[  15] =   0.02978867180545
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.093 ms
rank =  0, subspace rotation using ScaLAPACK took 4.424 ms
rank =  0, Distributing orbital back into band + domain format took 14.308 ms
rank = 0, Subspace_Rotation used 18.753 ms

Total time for subspace rotation: 18.759 ms
rank = 0, Efermi =  -0.056587240908 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.027 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.554 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.217 ms
rank = 0, Calculating density took 1511.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.820 ms
rank = 0, D2D took 0.979 ms
rank = 0, Transfering density took 0.983 ms
Etot    =   -34.735073366587
Eband   =    -8.951147634675
E1      =    19.616988622099
E2      =    -8.591282795723
E3      =   -11.752820994346
Exc     =   -10.448965195700
Esc     =   -55.296052947589
Entropy =    -0.000000000791
dE = 4.280e-06, dEband = 8.654e-04
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -34.735073367, dEtot = 4.280e-06, dEband = 8.654e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0863709659504, which took 0.059 ms

iter_count = 108, r_2norm = 2.311e-06, tol*||rhs|| = 3.455e-06

Anderson update took 65.161 ms, out of which F'*F took 30.086 ms; b-Ax took 202.422 ms, out of which Lap took 181.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.803 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639895, int_b + int_rho = -6.912e-14, checking this took 0.129 ms
2-norm of RHS = 601.9904082345296, which took 0.167 ms

iter_count = 144, r_2norm = 5.121e-04, tol*||rhs|| = 6.020e-04

Anderson update took 87.400 ms, out of which F'*F took 40.757 ms; b-Ax took 273.239 ms, out of which Lap took 245.968 ms
Solving Poisson took 607.876 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.105344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.272 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.506 ms
Total time for convolution: 	 convolve: 5.104338 
Total time for convolution: 	 convolve: 5.109900 
Total time for convolution: 	 convolve: 5.095631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.407 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.369 ms

This SCF took 27359.426 ms, scf error = 2.640e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.129789, lowerbound = -0.950463, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1390.245 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.502 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.613 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.144 ms
rank =  0, finding HY took 21.183 ms
rank =  0, distributing HY into block cyclic form took 14.356 ms
rank =  0, finding Y'*HY took 4.644 ms
Rank 0, Project_Hamiltonian used 59.305 ms
Total time for projection: 59.320 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.950265762267432
    last  calculated eigval = 0.029869740481524
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95026576226743
lambda[   2] =  -0.83410350672397
lambda[   3] =  -0.56842360787872
lambda[   4] =  -0.50532772922313
lambda[   5] =  -0.43042013167739
lambda[   6] =  -0.36491664190171
lambda[   7] =  -0.36177216880007
lambda[   8] =  -0.24391975907231
lambda[   9] =  -0.21478959699644
lambda[  10] =  -0.02703293854535
lambda[  11] =  -0.02474415191179
lambda[  12] =   0.00894813075490
lambda[  13] =   0.01473914136752
lambda[  14] =   0.02946021070650
lambda[  15] =   0.02986974048152
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 4.400 ms
rank =  0, Distributing orbital back into band + domain format took 14.269 ms
rank = 0, Subspace_Rotation used 18.689 ms

Total time for subspace rotation: 18.694 ms
rank = 0, Efermi =  -0.056012039169 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.978 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.559 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.193 ms
rank = 0, Calculating density took 1476.304 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.731 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.973 ms
Etot    =   -34.735094611611
Eband   =    -8.947877809792
E1      =    19.615255843693
E2      =    -8.589660777025
E3      =   -11.753124228686
Exc     =   -10.449204702842
Esc     =   -55.296052947589
Entropy =    -0.000000000792
dE = 3.541e-06, dEband = 5.450e-04
rank = 0, Calculating/Estimating energy took 1.203 ms, Etot = -34.735094612, dEtot = 3.541e-06, dEband = 5.450e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0584414440326, which took 0.056 ms

iter_count = 102, r_2norm = 2.137e-06, tol*||rhs|| = 2.338e-06

Anderson update took 61.648 ms, out of which F'*F took 28.380 ms; b-Ax took 191.103 ms, out of which Lap took 171.092 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.508 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639890, int_b + int_rho = -1.201e-13, checking this took 0.128 ms
2-norm of RHS = 602.0027256928058, which took 0.163 ms

iter_count = 180, r_2norm = 5.654e-04, tol*||rhs|| = 6.020e-04

Anderson update took 109.321 ms, out of which F'*F took 50.958 ms; b-Ax took 341.274 ms, out of which Lap took 307.368 ms
Solving Poisson took 758.912 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.096872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.860 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.381 ms
Total time for convolution: 	 convolve: 5.113818 
Total time for convolution: 	 convolve: 5.111615 
Total time for convolution: 	 convolve: 5.101829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.822 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.945 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.374 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 27130.954 ms, scf error = 2.248e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.129870, lowerbound = -0.950266, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.650 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.576 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.665 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.271 ms
rank =  0, finding HY took 21.977 ms
rank =  0, distributing HY into block cyclic form took 14.248 ms
rank =  0, finding Y'*HY took 4.766 ms
Rank 0, Project_Hamiltonian used 59.302 ms
Total time for projection: 59.319 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.950156587638872
    last  calculated eigval = 0.031088212576443
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95015658763887
lambda[   2] =  -0.83389466123407
lambda[   3] =  -0.56821109155563
lambda[   4] =  -0.50508627935035
lambda[   5] =  -0.43022654256749
lambda[   6] =  -0.36477994621735
lambda[   7] =  -0.36161670629537
lambda[   8] =  -0.24373958717485
lambda[   9] =  -0.21468191301766
lambda[  10] =  -0.02674736100473
lambda[  11] =  -0.02451531887915
lambda[  12] =   0.00834769718832
lambda[  13] =   0.01415212282305
lambda[  14] =   0.03074624599354
lambda[  15] =   0.03108821257644
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 4.392 ms
rank =  0, Distributing orbital back into band + domain format took 14.353 ms
rank = 0, Subspace_Rotation used 18.764 ms

Total time for subspace rotation: 18.769 ms
rank = 0, Efermi =  -0.055730688136 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.086 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.261 ms
rank = 0, Calculating density took 1481.812 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.737 ms
rank = 0, D2D took 0.987 ms
rank = 0, Transfering density took 0.991 ms
Etot    =   -34.735159343252
Eband   =    -8.944786630805
E1      =    19.614350112932
E2      =    -8.587464342437
E3      =   -11.752854473584
Exc     =   -10.448988693018
Esc     =   -55.296052947589
Entropy =    -0.000000000792
dE = 1.079e-05, dEband = 5.152e-04
rank = 0, Calculating/Estimating energy took 1.165 ms, Etot = -34.735159343, dEtot = 1.079e-05, dEband = 5.152e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0544246582859, which took 0.059 ms

iter_count = 108, r_2norm = 1.444e-06, tol*||rhs|| = 2.177e-06

Anderson update took 65.233 ms, out of which F'*F took 30.156 ms; b-Ax took 202.241 ms, out of which Lap took 180.775 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.926 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639893, int_b + int_rho = -9.459e-14, checking this took 0.117 ms
2-norm of RHS = 601.9966334026193, which took 0.138 ms

iter_count = 90, r_2norm = 5.962e-04, tol*||rhs|| = 6.020e-04

Anderson update took 54.309 ms, out of which F'*F took 25.234 ms; b-Ax took 169.894 ms, out of which Lap took 152.735 ms
Solving Poisson took 380.346 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.144548 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.118174 
Total time for convolution: 	 convolve: 5.115322 
Total time for convolution: 	 convolve: 5.255544 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.849 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.264 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.917 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.401 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.066 ms

This SCF took 27010.183 ms, scf error = 2.764e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.131088, lowerbound = -0.950157, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1387.134 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.598 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.658 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.899 ms
rank =  0, Distribute data + matrix mult took 29.176 ms
rank =  0, finding HY took 21.160 ms
rank =  0, distributing HY into block cyclic form took 14.332 ms
rank =  0, finding Y'*HY took 4.721 ms
Rank 0, Project_Hamiltonian used 69.432 ms
Total time for projection: 69.449 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.950048704011473
    last  calculated eigval = 0.030986575209515
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95004870401147
lambda[   2] =  -0.83382331374236
lambda[   3] =  -0.56814396811067
lambda[   4] =  -0.50502902636673
lambda[   5] =  -0.43015644679437
lambda[   6] =  -0.36469050084497
lambda[   7] =  -0.36153368344612
lambda[   8] =  -0.24366708872989
lambda[   9] =  -0.21458982155971
lambda[  10] =  -0.02672151202794
lambda[  11] =  -0.02447293464585
lambda[  12] =   0.00830784195149
lambda[  13] =   0.01379183716027
lambda[  14] =   0.03039788715349
lambda[  15] =   0.03098657520951
==subpsace eigenproblem: bcast eigvals took 0.066 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 4.369 ms
rank =  0, Distributing orbital back into band + domain format took 14.331 ms
rank = 0, Subspace_Rotation used 18.717 ms

Total time for subspace rotation: 18.722 ms
rank = 0, Efermi =  -0.055703581110 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.128 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.399 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.246 ms
rank = 0, Calculating density took 1483.425 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.743 ms
rank = 0, D2D took 0.984 ms
rank = 0, Transfering density took 0.988 ms
Etot    =   -34.735159035368
Eband   =    -8.943365107914
E1      =    19.613305671037
E2      =    -8.587025409004
E3      =   -11.753164411781
Exc     =   -10.449236470895
Esc     =   -55.296052947589
Entropy =    -0.000000000792
dE = 5.131e-08, dEband = 2.369e-04
rank = 0, Calculating/Estimating energy took 1.158 ms, Etot = -34.735159035, dEtot = 5.131e-08, dEband = 2.369e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0454669623825, which took 0.052 ms

iter_count = 108, r_2norm = 1.274e-06, tol*||rhs|| = 1.819e-06

Anderson update took 64.920 ms, out of which F'*F took 30.101 ms; b-Ax took 202.604 ms, out of which Lap took 181.199 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.736 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639889, int_b + int_rho = -1.310e-13, checking this took 0.150 ms
2-norm of RHS = 601.9933300527366, which took 0.153 ms

iter_count = 150, r_2norm = 5.628e-04, tol*||rhs|| = 6.020e-04

Anderson update took 89.819 ms, out of which F'*F took 45.242 ms; b-Ax took 285.939 ms, out of which Lap took 256.978 ms
Solving Poisson took 632.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.106776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.104219 
Total time for convolution: 	 convolve: 5.108244 
Total time for convolution: 	 convolve: 5.092482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.052 ms
---Transfer Veff_loc: D2D took 1.749 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.409 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.185 ms

This SCF took 26994.821 ms, scf error = 1.912e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.130987, lowerbound = -0.950049, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1398.090 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.448 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.665 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.049 ms
rank =  0, Distribute data + matrix mult took 18.182 ms
rank =  0, finding HY took 21.919 ms
rank =  0, distributing HY into block cyclic form took 14.258 ms
rank =  0, finding Y'*HY took 4.730 ms
Rank 0, Project_Hamiltonian used 59.131 ms
Total time for projection: 59.145 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.949987105510245
    last  calculated eigval = 0.031055158309277
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94998710551024
lambda[   2] =  -0.83374854697181
lambda[   3] =  -0.56806736073848
lambda[   4] =  -0.50495048108443
lambda[   5] =  -0.43008698429980
lambda[   6] =  -0.36463447344270
lambda[   7] =  -0.36147088575131
lambda[   8] =  -0.24360097586032
lambda[   9] =  -0.21453870796540
lambda[  10] =  -0.02672603910893
lambda[  11] =  -0.02441472932323
lambda[  12] =   0.00802295933924
lambda[  13] =   0.01394798337950
lambda[  14] =   0.03040083822879
lambda[  15] =   0.03105515830928
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.165 ms
rank =  0, subspace rotation using ScaLAPACK took 4.349 ms
rank =  0, Distributing orbital back into band + domain format took 14.269 ms
rank = 0, Subspace_Rotation used 18.635 ms

Total time for subspace rotation: 18.642 ms
rank = 0, Efermi =  -0.055703531838 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 4.097 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.429 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.310 ms
rank = 0, Calculating density took 1484.004 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.718 ms
rank = 0, D2D took 0.965 ms
rank = 0, Transfering density took 0.968 ms
Etot    =   -34.735175123259
Eband   =    -8.942171043951
E1      =    19.612648068163
E2      =    -8.586493985028
E3      =   -11.753129206514
Exc     =   -10.449222390633
Esc     =   -55.296052947589
Entropy =    -0.000000000792
dE = 2.681e-06, dEband = 1.990e-04
rank = 0, Calculating/Estimating energy took 1.297 ms, Etot = -34.735175123, dEtot = 2.681e-06, dEband = 1.990e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0413239784221, which took 0.052 ms

iter_count = 108, r_2norm = 1.257e-06, tol*||rhs|| = 1.653e-06

Anderson update took 66.228 ms, out of which F'*F took 30.154 ms; b-Ax took 202.113 ms, out of which Lap took 181.240 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.070 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639898, int_b + int_rho = -4.729e-14, checking this took 0.148 ms
2-norm of RHS = 601.9928581638957, which took 0.128 ms

iter_count = 96, r_2norm = 5.369e-04, tol*||rhs|| = 6.020e-04

Anderson update took 58.009 ms, out of which F'*F took 26.815 ms; b-Ax took 181.338 ms, out of which Lap took 162.864 ms
Solving Poisson took 404.702 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.108840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.101705 
Total time for convolution: 	 convolve: 5.097586 
Total time for convolution: 	 convolve: 5.101733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.145 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.536 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.388 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.357 ms

This SCF took 26779.464 ms, scf error = 1.633e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.131055, lowerbound = -0.949987, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1382.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.699 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.515 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.080 ms
rank =  0, Distribute data + matrix mult took 18.316 ms
rank =  0, finding HY took 21.840 ms
rank =  0, distributing HY into block cyclic form took 17.826 ms
rank =  0, finding Y'*HY took 4.390 ms
Rank 0, Project_Hamiltonian used 62.433 ms
Total time for projection: 62.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.949926449380125
    last  calculated eigval = 0.031490570710682
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94992644938013
lambda[   2] =  -0.83368619661322
lambda[   3] =  -0.56800834660878
lambda[   4] =  -0.50489130108540
lambda[   5] =  -0.43002949095376
lambda[   6] =  -0.36457771917694
lambda[   7] =  -0.36141359796171
lambda[   8] =  -0.24354274365727
lambda[   9] =  -0.21448390256838
lambda[  10] =  -0.02644985080490
lambda[  11] =  -0.02425256013152
lambda[  12] =   0.00820740459836
lambda[  13] =   0.01414734748980
lambda[  14] =   0.03065225042905
lambda[  15] =   0.03149057071068
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 4.373 ms
rank =  0, Distributing orbital back into band + domain format took 14.256 ms
rank = 0, Subspace_Rotation used 18.662 ms

Total time for subspace rotation: 18.667 ms
rank = 0, Efermi =  -0.055435894883 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 4.004 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.405 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.202 ms
rank = 0, Calculating density took 1471.175 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.715 ms
rank = 0, D2D took 0.942 ms
rank = 0, Transfering density took 0.952 ms
Etot    =   -34.735175916091
Eband   =    -8.941119496705
E1      =    19.612068904148
E2      =    -8.585998170770
E3      =   -11.753237734832
Exc     =   -10.449308280755
Esc     =   -55.296052947589
Entropy =    -0.000000000793
dE = 1.321e-07, dEband = 1.753e-04
rank = 0, Calculating/Estimating energy took 2.806 ms, Etot = -34.735175916, dEtot = 1.321e-07, dEband = 1.753e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0347674259095, which took 0.088 ms

iter_count = 108, r_2norm = 1.031e-06, tol*||rhs|| = 1.391e-06

Anderson update took 65.268 ms, out of which F'*F took 30.192 ms; b-Ax took 202.409 ms, out of which Lap took 181.424 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.171 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639901, int_b + int_rho = -1.091e-14, checking this took 0.130 ms
2-norm of RHS = 602.0024513820617, which took 0.133 ms

iter_count = 144, r_2norm = 5.890e-04, tol*||rhs|| = 6.020e-04

Anderson update took 87.417 ms, out of which F'*F took 40.434 ms; b-Ax took 273.003 ms, out of which Lap took 245.440 ms
Solving Poisson took 606.747 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.113545 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.217 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.104475 
Total time for convolution: 	 convolve: 5.103234 
Total time for convolution: 	 convolve: 5.105749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.842 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.402 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.374 ms

This SCF took 27043.538 ms, scf error = 1.479e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.131491, lowerbound = -0.949926, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1386.937 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.600 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.536 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 18.181 ms
rank =  0, finding HY took 22.195 ms
rank =  0, distributing HY into block cyclic form took 14.137 ms
rank =  0, finding Y'*HY took 4.786 ms
Rank 0, Project_Hamiltonian used 59.364 ms
Total time for projection: 59.384 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.949952494198822
    last  calculated eigval = 0.032167311412777
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94995249419882
lambda[   2] =  -0.83366430539074
lambda[   3] =  -0.56798085135376
lambda[   4] =  -0.50485307905061
lambda[   5] =  -0.43000954382443
lambda[   6] =  -0.36458244566135
lambda[   7] =  -0.36140971280106
lambda[   8] =  -0.24352920137686
lambda[   9] =  -0.21450029760720
lambda[  10] =  -0.02669336804479
lambda[  11] =  -0.02434503151045
lambda[  12] =   0.00787932949670
lambda[  13] =   0.01527475989564
lambda[  14] =   0.03074956042782
lambda[  15] =   0.03216731141278
==subpsace eigenproblem: bcast eigvals took 0.080 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 4.362 ms
rank =  0, Distributing orbital back into band + domain format took 14.229 ms
rank = 0, Subspace_Rotation used 18.623 ms

Total time for subspace rotation: 18.630 ms
rank = 0, Efermi =  -0.055668300373 calculate fermi energy took 0.123 ms
rank = 0, --- Calculate rho: sum over local bands took 4.064 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.300 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.236 ms
rank = 0, Calculating density took 1473.027 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.773 ms
rank = 0, D2D took 2.599 ms
rank = 0, Transfering density took 2.607 ms
Etot    =   -34.735185072940
Eband   =    -8.940963863230
E1      =    19.612426245005
E2      =    -8.585524520909
E3      =   -11.752991801363
Exc     =   -10.449110828605
Esc     =   -55.296052947589
Entropy =    -0.000000000792
dE = 1.526e-06, dEband = 2.594e-05
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -34.735185073, dEtot = 1.526e-06, dEband = 2.594e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0330807474695, which took 0.072 ms

iter_count = 108, r_2norm = 1.062e-06, tol*||rhs|| = 1.323e-06

Anderson update took 65.616 ms, out of which F'*F took 30.085 ms; b-Ax took 202.046 ms, out of which Lap took 181.030 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.189 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639891, int_b + int_rho = -1.128e-13, checking this took 0.117 ms
2-norm of RHS = 602.0001935708557, which took 0.120 ms

iter_count = 114, r_2norm = 5.876e-04, tol*||rhs|| = 6.020e-04

Anderson update took 69.096 ms, out of which F'*F took 32.089 ms; b-Ax took 215.910 ms, out of which Lap took 193.874 ms
Solving Poisson took 480.534 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.115509 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.748 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.111343 
Total time for convolution: 	 convolve: 5.105266 
Total time for convolution: 	 convolve: 5.116466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.376 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.352 ms

This SCF took 26868.957 ms, scf error = 2.325e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.132167, lowerbound = -0.949952, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1418.704 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.488 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.649 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 18.211 ms
rank =  0, finding HY took 21.959 ms
rank =  0, distributing HY into block cyclic form took 14.290 ms
rank =  0, finding Y'*HY took 4.741 ms
Rank 0, Project_Hamiltonian used 59.242 ms
Total time for projection: 59.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.949852430311768
    last  calculated eigval = 0.032812368407521
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94985243031177
lambda[   2] =  -0.83358557693624
lambda[   3] =  -0.56790665764506
lambda[   4] =  -0.50478457795055
lambda[   5] =  -0.42993100799761
lambda[   6] =  -0.36449368501377
lambda[   7] =  -0.36132497332484
lambda[   8] =  -0.24344871678740
lambda[   9] =  -0.21440545877151
lambda[  10] =  -0.02598877713835
lambda[  11] =  -0.02388204930797
lambda[  12] =   0.00869066589290
lambda[  13] =   0.01515994864828
lambda[  14] =   0.03142443394840
lambda[  15] =   0.03281236840752
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 4.369 ms
rank =  0, Distributing orbital back into band + domain format took 14.188 ms
rank = 0, Subspace_Rotation used 18.576 ms

Total time for subspace rotation: 18.582 ms
rank = 0, Efermi =  -0.054982387587 calculate fermi energy took 0.120 ms
rank = 0, --- Calculate rho: sum over local bands took 4.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.198 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 1505.235 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.225 ms
rank = 0, D2D took 1.339 ms
rank = 0, Transfering density took 1.348 ms
Etot    =   -34.735183226030
Eband   =    -8.939466170159
E1      =    19.611500640235
E2      =    -8.584901444751
E3      =   -11.753242779068
Exc     =   -10.449308971543
Esc     =   -55.296052947589
Entropy =    -0.000000000793
dE = 3.078e-07, dEband = 2.496e-04
rank = 0, Calculating/Estimating energy took 1.183 ms, Etot = -34.735183226, dEtot = 3.078e-07, dEband = 2.496e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0425147552911, which took 0.053 ms

iter_count = 108, r_2norm = 1.071e-06, tol*||rhs|| = 1.701e-06

Anderson update took 65.113 ms, out of which F'*F took 30.137 ms; b-Ax took 201.857 ms, out of which Lap took 180.713 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.308 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639895, int_b + int_rho = -7.276e-14, checking this took 0.124 ms
2-norm of RHS = 602.0023809232011, which took 0.165 ms

iter_count = 108, r_2norm = 5.604e-04, tol*||rhs|| = 6.020e-04

Anderson update took 65.097 ms, out of which F'*F took 30.415 ms; b-Ax took 203.683 ms, out of which Lap took 183.188 ms
Solving Poisson took 454.610 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.105037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.630 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.107877 
Total time for convolution: 	 convolve: 5.108793 
Total time for convolution: 	 convolve: 5.107621 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.155 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.922 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.324 ms

This SCF took 26865.229 ms, scf error = 1.894e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.132812, lowerbound = -0.949852, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1394.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.297 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.766 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 18.108 ms
rank =  0, finding HY took 22.066 ms
rank =  0, distributing HY into block cyclic form took 14.239 ms
rank =  0, finding Y'*HY took 4.750 ms
Rank 0, Project_Hamiltonian used 59.199 ms
Total time for projection: 59.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.950004905387394
    last  calculated eigval = 0.032177206908952
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.95000490538739
lambda[   2] =  -0.83370916375918
lambda[   3] =  -0.56801922229669
lambda[   4] =  -0.50489424553336
lambda[   5] =  -0.43004800427413
lambda[   6] =  -0.36462851975894
lambda[   7] =  -0.36145211070162
lambda[   8] =  -0.24357075285635
lambda[   9] =  -0.21454266263378
lambda[  10] =  -0.02629537563835
lambda[  11] =  -0.02415564119604
lambda[  12] =   0.00841452484368
lambda[  13] =   0.01475285103255
lambda[  14] =   0.03100273935396
lambda[  15] =   0.03217720690895
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 4.354 ms
rank =  0, Distributing orbital back into band + domain format took 14.260 ms
rank = 0, Subspace_Rotation used 19.501 ms

Total time for subspace rotation: 19.511 ms
rank = 0, Efermi =  -0.055286144767 calculate fermi energy took 0.663 ms
rank = 0, --- Calculate rho: sum over local bands took 4.063 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.203 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.190 ms
rank = 0, Calculating density took 1480.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.689 ms
rank = 0, D2D took 0.888 ms
rank = 0, Transfering density took 0.896 ms
Etot    =   -34.735182696403
Eband   =    -8.941739175093
E1      =    19.612892458969
E2      =    -8.585883473408
E3      =   -11.752812978070
Exc     =   -10.448979483377
Esc     =   -55.296052947589
Entropy =    -0.000000000793
dE = 8.827e-08, dEband = 3.788e-04
rank = 0, Calculating/Estimating energy took 1.268 ms, Etot = -34.735182696, dEtot = 8.827e-08, dEband = 3.788e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0417879628424, which took 0.057 ms

iter_count = 102, r_2norm = 1.628e-06, tol*||rhs|| = 1.672e-06

Anderson update took 61.608 ms, out of which F'*F took 28.487 ms; b-Ax took 191.432 ms, out of which Lap took 171.299 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 430.085 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639893, int_b + int_rho = -9.823e-14, checking this took 0.132 ms
2-norm of RHS = 601.9933922060994, which took 0.160 ms

iter_count = 144, r_2norm = 5.409e-04, tol*||rhs|| = 6.020e-04

Anderson update took 87.008 ms, out of which F'*F took 40.835 ms; b-Ax took 272.275 ms, out of which Lap took 244.797 ms
Solving Poisson took 605.517 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.109342 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.108835 
Total time for convolution: 	 convolve: 5.105415 
Total time for convolution: 	 convolve: 5.109246 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.926 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 26957.132 ms, scf error = 2.616e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.132177, lowerbound = -0.950005, upperbound = 267.574646

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1412.151 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.380 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.716 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 18.126 ms
rank =  0, finding HY took 21.977 ms
rank =  0, distributing HY into block cyclic form took 14.077 ms
rank =  0, finding Y'*HY took 4.874 ms
Rank 0, Project_Hamiltonian used 59.093 ms
Total time for projection: 59.117 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.949761369586436
    last  calculated eigval = 0.029918409437010
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94976136958644
lambda[   2] =  -0.83352700844846
lambda[   3] =  -0.56786521783900
lambda[   4] =  -0.50473974333119
lambda[   5] =  -0.42989071855000
lambda[   6] =  -0.36443191388899
lambda[   7] =  -0.36126799851228
lambda[   8] =  -0.24339594249759
lambda[   9] =  -0.21434924515734
lambda[  10] =  -0.02787778754991
lambda[  11] =  -0.02454138684987
lambda[  12] =   0.00678066941666
lambda[  13] =   0.01422406817982
lambda[  14] =   0.02886509894149
lambda[  15] =   0.02991840943701
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 4.259 ms
rank =  0, Distributing orbital back into band + domain format took 15.040 ms
rank = 0, Subspace_Rotation used 19.323 ms

Total time for subspace rotation: 19.329 ms
rank = 0, Efermi =  -0.056811992399 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.978 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.188 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.237 ms
rank = 0, Calculating density took 1498.331 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.767 ms
rank = 0, D2D took 0.892 ms
rank = 0, Transfering density took 0.899 ms
Etot    =   -34.735190379530
Eband   =    -8.938458316357
E1      =    19.610598875807
E2      =    -8.584708132586
E3      =   -11.753555803176
Exc     =   -10.449541926365
Esc     =   -55.296052947589
Entropy =    -0.000000000789
dE = 1.281e-06, dEband = 5.468e-04
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -34.735190380, dEtot = 1.281e-06, dEband = 5.468e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0239747809359, which took 0.074 ms

iter_count = 108, r_2norm = 6.040e-07, tol*||rhs|| = 9.590e-07

Anderson update took 65.143 ms, out of which F'*F took 30.174 ms; b-Ax took 202.497 ms, out of which Lap took 181.472 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.660 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002639902, int_rho =  18.00000002639895, int_b + int_rho = -7.640e-14, checking this took 0.133 ms
2-norm of RHS = 601.9979276350118, which took 0.131 ms

iter_count = 126, r_2norm = 5.753e-04, tol*||rhs|| = 6.020e-04

Anderson update took 75.869 ms, out of which F'*F took 35.210 ms; b-Ax took 238.159 ms, out of which Lap took 213.791 ms
Solving Poisson took 530.041 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.105637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.368 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.111305 
Total time for convolution: 	 convolve: 5.103524 
Total time for convolution: 	 convolve: 5.128911 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 3.114 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.335 ms

This SCF took 26976.598 ms, scf error = 9.567e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.94976136958644, occ[   1] =   2.00000000000000
lambda[   2] =  -0.83352700844846, occ[   2] =   2.00000000000000
lambda[   3] =  -0.56786521783900, occ[   3] =   2.00000000000000
lambda[   4] =  -0.50473974333119, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42989071855000, occ[   5] =   2.00000000000000
lambda[   6] =  -0.36443191388899, occ[   6] =   2.00000000000000
lambda[   7] =  -0.36126799851228, occ[   7] =   2.00000000000000
lambda[   8] =  -0.24339594249759, occ[   8] =   2.00000000000000
lambda[   9] =  -0.21434924515734, occ[   9] =   2.00000000000000
lambda[  10] =  -0.02787778754991, occ[  10] =   0.00000002586674
lambda[  11] =  -0.02454138684987, occ[  11] =   0.00000000053220
lambda[  12] =   0.00678066941666, occ[  12] =   0.00000000000000
lambda[  13] =   0.01422406817982, occ[  13] =   0.00000000000000
lambda[  14] =   0.02886509894149, occ[  14] =   0.00000000000000
lambda[  15] =   0.02991840943701, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.382 ms, time for Allreduce/Reduce: 7.835 ms 
Time for calculating local force components: 16.001 ms
Start Calculating nonlocal forces
force_nloc = 
 -1.04863775494422   0.59398142861351  -0.00387656115902
 -0.00037664565219  -0.05012249048832   0.00006404430756
  0.00519971170054   0.06683166062162  -0.00652242822534
  0.05466167950985  -0.03886969143429  -0.00977020145893
 -0.04773649307440  -0.11886258334583  -0.01119018925915
 -0.00183001816397   0.00443343944941   0.16437181694889
force_loc = 
  1.02989538331937  -0.58418059887106   0.00367927575898
  0.00029334751477   0.05610082135059   0.00003580047776
 -0.00674435995855  -0.07171513487213   0.00640919562083
 -0.05948365296986   0.04117489260598   0.00963812356355
  0.03619713378693   0.11946537057529   0.01002139020877
  0.00285861475211  -0.00396413366920  -0.15967120588117
Time for calculating nonlocal force components: 31.898 ms
[32mforces_xc: 
[0m[32m  0.02572995716580  -0.01381645314453   0.00021124708085
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00811378016755  -0.00099702050172   0.00045780488469
[0m[32m  0.00180962360564   0.00059633339114  -0.00381693905674
[0mTime for calculating XC forces components: 20.597 ms
 Cartesian force = 
  0.00699586774772  -0.00402493011549   0.00000709937889
 -0.00007501593065   0.00596902414886   0.00009298248340
 -0.00153636605124  -0.00489278096392  -0.00012009490644
 -0.00481369125323   0.00229589445828  -0.00013894019730
 -0.00341729691315  -0.00040353998566  -0.00071785646761
  0.00284650240055   0.00105633245794   0.00087680970906
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.371 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 391.354 ms
The program took 607.106 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:34
Job ID:        2266632
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:05:24,vmem=8380K,walltime=00:10:27,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-35-2
---------------------------------------
