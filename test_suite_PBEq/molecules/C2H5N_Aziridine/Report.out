---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:57
Job ID:    2266504
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:03
Job ID:    2266504
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.049 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 391.490 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 19.245 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 244.174 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.956 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.749642	   11.870577	   10.000000	
    8.250358	    8.320312	   12.429761	
   11.697557	    8.129423	   12.366039	
    8.250358	    8.320312	    7.570239	
   11.697557	    8.129423	    7.633961	
    9.981931	    8.717143	   11.401383	
    9.981931	    8.717143	    8.598617	
    9.981931	   11.119201	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.176 ms
Set up communicators.

--set up spincomm took 3.790 ms

--set up kptcomm took 0.356 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.549 ms

Calculate_SplineDerivRadFun took 0.196 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.788 ms.
time spent on vectorized spline interp: 3.169 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.543 ms.
time spent on vectorized spline interp: 1.635 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.483 ms.
time spent on vectorized spline interp: 1.625 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.242 ms.

Calculating rb for all atom types took 16.495 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.921 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000271015, sum_int_rho = 17.4997959642689
PosCharge = 18.000000027101, NegCharge = -17.499795964269, scal_fac = 1.028583422564
After scaling, int_rho = 18.0000000271015, PosCharge + NegCharge - NetCharge = -6.040e-14
--Calculate Vref took 0.418 ms
--Calculate rho_guess took 2.409 ms

 integral of b = -18.0000000271015,
 int{b} + Nelectron + NetCharge = -2.710e-08,
 Esc = -44.5399454541644,
 MPI_Reduce took 5.131 ms

Calculating b & b_ref took 13.934 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.035 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.044 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.018 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.181 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.004 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.862 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710145, int_b + int_rho = -4.366e-14, checking this took 0.629 ms
2-norm of RHS = 670.3956538750550, which took 0.072 ms

iter_count = 420, r_2norm = 5.746e-04, tol*||rhs|| = 6.704e-04

Anderson update took 240.114 ms, out of which F'*F took 105.334 ms; b-Ax took 710.613 ms, out of which Lap took 636.773 ms
Solving Poisson took 1521.301 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
Total time for convolution: 	 convolve: 5.128366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
Total time for convolution: 	 convolve: 5.102165 
Total time for convolution: 	 convolve: 5.112389 
Total time for convolution: 	 convolve: 5.133522 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.611 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
rank = 0, XC calculation took 24293.997 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.580 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.231 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.934 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.144 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.650 ms
    Lanczos iter 53, eigmin  = -0.968431159, eigmax = 264.919478902, err_eigmin = 8.036e-04, err_eigmax = 9.963e-03
rank =   0, Lanczos took 118.537 ms, eigmin = -0.968431159298, eigmax = 267.568673691342

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.250121, lowerbound = -1.068431, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1175.846 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.615 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.565 ms
rank =  0, Distribute data + matrix mult took 18.316 ms
rank =  0, finding HY took 20.186 ms
rank =  0, distributing HY into block cyclic form took 13.515 ms
rank =  0, finding Y'*HY took 4.263 ms
Rank 0, Project_Hamiltonian used 56.310 ms
Total time for projection: 56.324 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.240 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.312 ms
    first calculated eigval = 2.784556378002606
    last  calculated eigval = 3.218954542882880
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.78455637800261
lambda[   2] =   2.85210053410093
lambda[   3] =   2.88695272774902
lambda[   4] =   2.91697964251020
lambda[   5] =   2.94038468027606
lambda[   6] =   2.95357148589685
lambda[   7] =   2.98875321824286
lambda[   8] =   3.02599397084309
lambda[   9] =   3.05131041856461
lambda[  10] =   3.07114169057357
lambda[  11] =   3.09897958565644
lambda[  12] =   3.11631678471538
lambda[  13] =   3.14448539585069
lambda[  14] =   3.14663944191836
lambda[  15] =   3.21895454288288
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.659 ms
rank =  0, subspace rotation using ScaLAPACK took 3.372 ms
rank =  0, Distributing orbital back into band + domain format took 11.742 ms
rank = 0, Subspace_Rotation used 15.126 ms

Total time for subspace rotation: 15.130 ms
rank = 0, Efermi =   3.061226055114 calculate fermi energy took 0.053 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.318955, lowerbound = -1.068431, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1158.134 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 34.513 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.210 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 37.743 ms
rank =  0, finding HY took 19.357 ms
rank =  0, distributing HY into block cyclic form took 12.152 ms
rank =  0, finding Y'*HY took 4.191 ms
Rank 0, Project_Hamiltonian used 73.478 ms
Total time for projection: 73.497 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.148 ms
    first calculated eigval = -0.692035595180574
    last  calculated eigval = 0.423524920477921
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.69203559518057
lambda[   2] =  -0.39829188261000
lambda[   3] =  -0.25839275862454
lambda[   4] =  -0.13559723463766
lambda[   5] =  -0.04590291470091
lambda[   6] =   0.15185571391713
lambda[   7] =   0.19467937418509
lambda[   8] =   0.21713305109237
lambda[   9] =   0.31988522751671
lambda[  10] =   0.33649599607901
lambda[  11] =   0.35172992224694
lambda[  12] =   0.37710676622741
lambda[  13] =   0.38587833227203
lambda[  14] =   0.39569955522136
lambda[  15] =   0.42352492047792
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 3.519 ms
rank =  0, Distributing orbital back into band + domain format took 12.024 ms
rank = 0, Subspace_Rotation used 15.555 ms

Total time for subspace rotation: 15.558 ms
rank = 0, Efermi =   0.328190543006 calculate fermi energy took 0.042 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.523525, lowerbound = -1.068431, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1147.466 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 32.916 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.274 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 36.225 ms
rank =  0, finding HY took 18.919 ms
rank =  0, distributing HY into block cyclic form took 12.199 ms
rank =  0, finding Y'*HY took 4.100 ms
Rank 0, Project_Hamiltonian used 71.948 ms
Total time for projection: 71.954 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.100 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.973120914055023
    last  calculated eigval = 0.131217272145345
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97312091405502
lambda[   2] =  -0.69236352772602
lambda[   3] =  -0.65878723518947
lambda[   4] =  -0.56311864535246
lambda[   5] =  -0.51759359589732
lambda[   6] =  -0.42136300215282
lambda[   7] =  -0.38146603630160
lambda[   8] =  -0.37252585547575
lambda[   9] =  -0.27847741825430
lambda[  10] =   0.05896641408682
lambda[  11] =   0.08161524305843
lambda[  12] =   0.09698833618057
lambda[  13] =   0.09902381066866
lambda[  14] =   0.12182095267430
lambda[  15] =   0.13121727214535
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.525 ms
rank =  0, Distributing orbital back into band + domain format took 12.085 ms
rank = 0, Subspace_Rotation used 15.625 ms

Total time for subspace rotation: 15.629 ms
rank = 0, Efermi =   0.030074482841 calculate fermi energy took 0.041 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.231217, lowerbound = -1.068431, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1149.590 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 32.850 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.224 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.057 ms
rank =  0, Distribute data + matrix mult took 36.144 ms
rank =  0, finding HY took 19.305 ms
rank =  0, distributing HY into block cyclic form took 12.171 ms
rank =  0, finding Y'*HY took 4.146 ms
Rank 0, Project_Hamiltonian used 71.805 ms
Total time for projection: 71.809 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -0.973620629683948
    last  calculated eigval = 0.091972079984512
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.97362062968395
lambda[   2] =  -0.69639215671040
lambda[   3] =  -0.66179146660623
lambda[   4] =  -0.56769796409033
lambda[   5] =  -0.52468469802288
lambda[   6] =  -0.43276379470204
lambda[   7] =  -0.40052073541435
lambda[   8] =  -0.39455257530653
lambda[   9] =  -0.31276276604688
lambda[  10] =   0.00782933585420
lambda[  11] =   0.01592592129730
lambda[  12] =   0.02490559259603
lambda[  13] =   0.04783105046040
lambda[  14] =   0.06676334533965
lambda[  15] =   0.09197207998451
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.530 ms
rank =  0, Distributing orbital back into band + domain format took 12.036 ms
rank = 0, Subspace_Rotation used 15.578 ms

Total time for subspace rotation: 15.581 ms
rank = 0, Efermi =  -0.021062632231 calculate fermi energy took 0.028 ms
rank = 0, --- Calculate rho: sum over local bands took 2.356 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.795 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.155 ms
rank = 0, Calculating density took 5095.089 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.604 ms
rank = 0, D2D took 0.704 ms
rank = 0, Transfering density took 0.711 ms
Etot    =   -25.435602889369
Eband   =    -9.929573572955
E1      =    20.410571513506
E2      =    -7.504654323046
E3      =    -9.831600584586
Exc     =    -8.712910282580
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 3.179e+00, dEband = 1.241e+00
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -25.435602889, dEtot = 3.179e+00, dEband = 1.241e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 43.2165496600517, which took 0.060 ms

iter_count = 96, r_2norm = 1.411e-03, tol*||rhs|| = 1.729e-03

Anderson update took 51.584 ms, out of which F'*F took 23.957 ms; b-Ax took 162.111 ms, out of which Lap took 144.924 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.058 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710149, int_b + int_rho = 0.000e+00, checking this took 0.134 ms
2-norm of RHS = 666.6404479395267, which took 0.143 ms

iter_count = 282, r_2norm = 6.521e-04, tol*||rhs|| = 6.666e-04

Anderson update took 151.301 ms, out of which F'*F took 71.285 ms; b-Ax took 479.601 ms, out of which Lap took 432.242 ms
Solving Poisson took 1013.623 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.526 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.141022 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.148267 
Total time for convolution: 	 convolve: 5.147627 
Total time for convolution: 	 convolve: 5.140027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 0.729 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.862 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.827 ms

This SCF took 31007.645 ms, scf error = 1.875e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.191972, lowerbound = -0.973621, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1181.269 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 16.609 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.222 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.220 ms
rank =  0, Distribute data + matrix mult took 20.065 ms
rank =  0, finding HY took 19.563 ms
rank =  0, distributing HY into block cyclic form took 11.810 ms
rank =  0, finding Y'*HY took 4.802 ms
Rank 0, Project_Hamiltonian used 56.270 ms
Total time for projection: 56.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.162 ms
    first calculated eigval = -0.946231876814106
    last  calculated eigval = 0.065022412645221
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.94623187681411
lambda[   2] =  -0.66835975169008
lambda[   3] =  -0.63272477957266
lambda[   4] =  -0.54101636903758
lambda[   5] =  -0.49619014454058
lambda[   6] =  -0.40633460937005
lambda[   7] =  -0.37403197150356
lambda[   8] =  -0.36672441916315
lambda[   9] =  -0.28412931077944
lambda[  10] =  -0.02313692795465
lambda[  11] =  -0.00261695590120
lambda[  12] =   0.01836296489328
lambda[  13] =   0.02180255054191
lambda[  14] =   0.04145373420654
lambda[  15] =   0.06502241264522
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.512 ms
rank =  0, Distributing orbital back into band + domain format took 12.077 ms
rank = 0, Subspace_Rotation used 15.601 ms

Total time for subspace rotation: 16.036 ms
rank = 0, Efermi =  -0.052028859121 calculate fermi energy took 0.638 ms
rank = 0, --- Calculate rho: sum over local bands took 2.836 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.456 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.157 ms
rank = 0, Calculating density took 1259.991 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
rank = 0, D2D took 0.818 ms
rank = 0, Transfering density took 0.821 ms
Etot    =   -25.398026197464
Eband   =    -9.431486465569
E1      =    19.966552419742
E2      =    -7.463444171290
E3      =    -9.965394002651
Exc     =    -8.821984870606
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 4.697e-03, dEband = 6.226e-02
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -25.398026197, dEtot = 4.697e-03, dEband = 6.226e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 11.5717355564128, which took 0.097 ms

iter_count = 102, r_2norm = 4.411e-04, tol*||rhs|| = 4.629e-04

Anderson update took 54.209 ms, out of which F'*F took 25.294 ms; b-Ax took 171.527 ms, out of which Lap took 153.317 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.416 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710147, int_b + int_rho = -2.183e-14, checking this took 0.111 ms
2-norm of RHS = 660.5116126932849, which took 0.134 ms

iter_count = 300, r_2norm = 6.500e-04, tol*||rhs|| = 6.605e-04

Anderson update took 160.169 ms, out of which F'*F took 78.024 ms; b-Ax took 512.317 ms, out of which Lap took 460.741 ms
Solving Poisson took 1075.950 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.808 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.138913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 43.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.139366 
Total time for convolution: 	 convolve: 5.132987 
Total time for convolution: 	 convolve: 5.170907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.865 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.859 ms

This SCF took 27339.676 ms, scf error = 1.307e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165022, lowerbound = -0.946232, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1177.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.126 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.611 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 15.753 ms
rank =  0, finding HY took 20.115 ms
rank =  0, distributing HY into block cyclic form took 12.359 ms
rank =  0, finding Y'*HY took 4.309 ms
Rank 0, Project_Hamiltonian used 52.566 ms
Total time for projection: 52.582 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -0.893941953321944
    last  calculated eigval = 0.051694294592935
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89394195332194
lambda[   2] =  -0.61278722330436
lambda[   3] =  -0.57398790722315
lambda[   4] =  -0.48751018584331
lambda[   5] =  -0.43927287210997
lambda[   6] =  -0.35112225159392
lambda[   7] =  -0.32265061157001
lambda[   8] =  -0.31251084742224
lambda[   9] =  -0.22831247131211
lambda[  10] =  -0.03183037254665
lambda[  11] =  -0.00624100965752
lambda[  12] =   0.01200094003642
lambda[  13] =   0.03021256240006
lambda[  14] =   0.04647150454972
lambda[  15] =   0.05169429459294
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.171 ms
rank =  0, subspace rotation using ScaLAPACK took 4.114 ms
rank =  0, Distributing orbital back into band + domain format took 11.683 ms
rank = 0, Subspace_Rotation used 15.816 ms

Total time for subspace rotation: 15.822 ms
rank = 0, Efermi =  -0.060722303743 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.912 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.358 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.146 ms
rank = 0, Calculating density took 1253.289 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.490 ms
rank = 0, D2D took 0.588 ms
rank = 0, Transfering density took 0.590 ms
Etot    =   -25.361560937305
Eband   =    -8.444192648265
E1      =    19.126742597704
E2      =    -7.293577309432
E3      =   -10.274754872641
Exc     =    -9.072497613845
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 4.558e-03, dEband = 1.234e-01
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -25.361560937, dEtot = 4.558e-03, dEband = 1.234e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.1960836043515, which took 0.061 ms

iter_count = 102, r_2norm = 1.810e-04, tol*||rhs|| = 2.078e-04

Anderson update took 54.654 ms, out of which F'*F took 25.358 ms; b-Ax took 172.645 ms, out of which Lap took 154.215 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.538 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710149, int_b + int_rho = -3.638e-15, checking this took 0.101 ms
2-norm of RHS = 661.1101656425133, which took 0.125 ms

iter_count = 270, r_2norm = 5.953e-04, tol*||rhs|| = 6.611e-04

Anderson update took 145.512 ms, out of which F'*F took 67.990 ms; b-Ax took 460.396 ms, out of which Lap took 411.456 ms
Solving Poisson took 968.477 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.020 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.169440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.097630 
Total time for convolution: 	 convolve: 5.143124 
Total time for convolution: 	 convolve: 5.085223 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.537 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.602 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.865 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.822 ms

This SCF took 27119.350 ms, scf error = 3.765e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151694, lowerbound = -0.893942, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1148.552 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 25.406 ms
rank =  0, finding HY took 19.507 ms
rank =  0, distributing HY into block cyclic form took 11.805 ms
rank =  0, finding Y'*HY took 5.627 ms
Rank 0, Project_Hamiltonian used 62.376 ms
Total time for projection: 62.389 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -0.890578982049668
    last  calculated eigval = 0.049903091932935
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89057898204967
lambda[   2] =  -0.60639710876401
lambda[   3] =  -0.56521938690924
lambda[   4] =  -0.48039045773470
lambda[   5] =  -0.43146793767150
lambda[   6] =  -0.34070081592503
lambda[   7] =  -0.31855730842900
lambda[   8] =  -0.30664706563562
lambda[   9] =  -0.22464119985480
lambda[  10] =  -0.03357243962383
lambda[  11] =  -0.00704563759991
lambda[  12] =   0.00910463903090
lambda[  13] =   0.01992166879820
lambda[  14] =   0.03686898521954
lambda[  15] =   0.04990309193293
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.442 ms
rank =  0, Distributing orbital back into band + domain format took 11.631 ms
rank = 0, Subspace_Rotation used 15.090 ms

Total time for subspace rotation: 15.100 ms
rank = 0, Efermi =  -0.062464370850 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.889 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.491 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.210 ms
rank = 0, Calculating density took 1234.301 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
rank = 0, D2D took 0.655 ms
rank = 0, Transfering density took 0.659 ms
Etot    =   -25.358776477013
Eband   =    -8.329200526857
E1      =    19.081912796993
E2      =    -7.213966255671
E3      =   -10.318492772895
Exc     =    -9.104002320744
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 3.481e-04, dEband = 1.437e-02
rank = 0, Calculating/Estimating energy took 0.904 ms, Etot = -25.358776477, dEtot = 3.481e-04, dEband = 1.437e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.5152455615046, which took 0.068 ms

iter_count = 108, r_2norm = 6.007e-05, tol*||rhs|| = 6.061e-05

Anderson update took 57.690 ms, out of which F'*F took 27.007 ms; b-Ax took 182.586 ms, out of which Lap took 163.846 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.751 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710140, int_b + int_rho = -8.731e-14, checking this took 0.106 ms
2-norm of RHS = 661.2426837017533, which took 0.135 ms

iter_count = 252, r_2norm = 5.277e-04, tol*||rhs|| = 6.612e-04

Anderson update took 134.886 ms, out of which F'*F took 62.336 ms; b-Ax took 424.611 ms, out of which Lap took 379.756 ms
Solving Poisson took 899.863 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.125469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 2.808 ms
Total time for convolution: 	 convolve: 5.081339 
Total time for convolution: 	 convolve: 5.091184 
Total time for convolution: 	 convolve: 5.239895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.774 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.821 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.776 ms

This SCF took 27035.429 ms, scf error = 1.182e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.149903, lowerbound = -0.890579, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1170.395 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.178 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.306 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.504 ms
rank =  0, finding HY took 19.512 ms
rank =  0, distributing HY into block cyclic form took 12.127 ms
rank =  0, finding Y'*HY took 4.142 ms
Rank 0, Project_Hamiltonian used 51.315 ms
Total time for projection: 51.327 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.493 ms
    first calculated eigval = -0.886362141911936
    last  calculated eigval = 0.047018879173027
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.88636214191194
lambda[   2] =  -0.60193179909181
lambda[   3] =  -0.56063732916523
lambda[   4] =  -0.47602837143371
lambda[   5] =  -0.42693512504428
lambda[   6] =  -0.33593947765563
lambda[   7] =  -0.31435997186147
lambda[   8] =  -0.30257469704333
lambda[   9] =  -0.22032309231711
lambda[  10] =  -0.03388067427860
lambda[  11] =  -0.00729972772726
lambda[  12] =   0.00784387567537
lambda[  13] =   0.01437543947622
lambda[  14] =   0.03224934679692
lambda[  15] =   0.04701887917303
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.528 ms
rank =  0, subspace rotation using ScaLAPACK took 3.577 ms
rank =  0, Distributing orbital back into band + domain format took 11.765 ms
rank = 0, Subspace_Rotation used 15.358 ms

Total time for subspace rotation: 15.366 ms
rank = 0, Efermi =  -0.062772605490 calculate fermi energy took 2.107 ms
rank = 0, --- Calculate rho: sum over local bands took 3.211 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.932 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1245.659 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
rank = 0, D2D took 0.889 ms
rank = 0, Transfering density took 0.896 ms
Etot    =   -25.358040513729
Eband   =    -8.250184011967
E1      =    19.038913128320
E2      =    -7.172504836885
E3      =   -10.341775383781
Exc     =    -9.121104395776
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 9.200e-05, dEband = 9.877e-03
rank = 0, Calculating/Estimating energy took 1.063 ms, Etot = -25.358040514, dEtot = 9.200e-05, dEband = 9.877e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6827312398315, which took 0.083 ms

iter_count = 108, r_2norm = 2.701e-05, tol*||rhs|| = 2.731e-05

Anderson update took 59.496 ms, out of which F'*F took 27.123 ms; b-Ax took 183.166 ms, out of which Lap took 164.449 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.146 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710149, int_b + int_rho = 0.000e+00, checking this took 0.105 ms
2-norm of RHS = 661.5172856487482, which took 0.105 ms

iter_count = 252, r_2norm = 5.801e-04, tol*||rhs|| = 6.615e-04

Anderson update took 134.392 ms, out of which F'*F took 63.064 ms; b-Ax took 426.244 ms, out of which Lap took 381.538 ms
Solving Poisson took 901.382 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.074422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 93.916 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.580 ms
Total time for convolution: 	 convolve: 5.073647 
Total time for convolution: 	 convolve: 5.081399 
Total time for convolution: 	 convolve: 5.086710 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.173 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.300 ms

This SCF took 26911.868 ms, scf error = 6.700e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147019, lowerbound = -0.886362, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1156.740 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.373 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.276 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 17.669 ms
rank =  0, finding HY took 19.469 ms
rank =  0, distributing HY into block cyclic form took 12.415 ms
rank =  0, finding Y'*HY took 3.744 ms
Rank 0, Project_Hamiltonian used 53.760 ms
Total time for projection: 53.774 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.880128749787952
    last  calculated eigval = 0.043974397239247
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.88012874978795
lambda[   2] =  -0.59659073683327
lambda[   3] =  -0.55588859527649
lambda[   4] =  -0.47107518023346
lambda[   5] =  -0.42192892381388
lambda[   6] =  -0.33148034423072
lambda[   7] =  -0.30852623046518
lambda[   8] =  -0.29756377276067
lambda[   9] =  -0.21432793611777
lambda[  10] =  -0.03349457855258
lambda[  11] =  -0.00673688155807
lambda[  12] =   0.00811742225583
lambda[  13] =   0.01246268615357
lambda[  14] =   0.02936971086919
lambda[  15] =   0.04397439723925
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 3.568 ms
rank =  0, Distributing orbital back into band + domain format took 12.054 ms
rank = 0, Subspace_Rotation used 15.637 ms

Total time for subspace rotation: 15.640 ms
rank = 0, Efermi =  -0.062386509812 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.130 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.221 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.169 ms
rank = 0, Calculating density took 1233.003 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.612 ms
rank = 0, D2D took 0.819 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -25.357593078941
Eband   =    -8.155020939947
E1      =    18.991883146567
E2      =    -7.119446263694
E3      =   -10.359688516185
Exc     =    -9.133644610469
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 5.593e-05, dEband = 1.190e-02
rank = 0, Calculating/Estimating energy took 1.028 ms, Etot = -25.357593079, dEtot = 5.593e-05, dEband = 1.190e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2917242539070, which took 0.693 ms

iter_count = 114, r_2norm = 8.329e-06, tol*||rhs|| = 1.167e-05

Anderson update took 60.540 ms, out of which F'*F took 28.678 ms; b-Ax took 193.140 ms, out of which Lap took 173.013 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.066 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710151, int_b + int_rho = 1.455e-14, checking this took 0.109 ms
2-norm of RHS = 661.6971614285933, which took 0.131 ms

iter_count = 246, r_2norm = 5.556e-04, tol*||rhs|| = 6.617e-04

Anderson update took 131.076 ms, out of which F'*F took 61.110 ms; b-Ax took 414.028 ms, out of which Lap took 369.973 ms
Solving Poisson took 878.939 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.075985 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.523 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.078479 
Total time for convolution: 	 convolve: 5.091848 
Total time for convolution: 	 convolve: 5.074965 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.292 ms

This SCF took 26981.345 ms, scf error = 3.666e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.143974, lowerbound = -0.880129, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1153.697 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.569 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.201 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 23.793 ms
rank =  0, finding HY took 19.432 ms
rank =  0, distributing HY into block cyclic form took 12.120 ms
rank =  0, finding Y'*HY took 4.222 ms
Rank 0, Project_Hamiltonian used 59.980 ms
Total time for projection: 59.993 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.875950483135982
    last  calculated eigval = 0.041263565615203
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87595048313598
lambda[   2] =  -0.59267229151425
lambda[   3] =  -0.55168328053641
lambda[   4] =  -0.46722903147868
lambda[   5] =  -0.41781573480595
lambda[   6] =  -0.32756989146638
lambda[   7] =  -0.30453539235299
lambda[   8] =  -0.29338420611559
lambda[   9] =  -0.21040530483726
lambda[  10] =  -0.03226359721330
lambda[  11] =  -0.00515928308260
lambda[  12] =   0.01018710921824
lambda[  13] =   0.01327060538456
lambda[  14] =   0.02848868943785
lambda[  15] =   0.04126356561520
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.550 ms
rank =  0, Distributing orbital back into band + domain format took 12.008 ms
rank = 0, Subspace_Rotation used 15.570 ms

Total time for subspace rotation: 15.574 ms
rank = 0, Efermi =  -0.061155528385 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.122 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.331 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1236.164 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.595 ms
rank = 0, D2D took 0.780 ms
rank = 0, Transfering density took 0.787 ms
Etot    =   -25.357455831188
Eband   =    -8.082491233361
E1      =    18.957072453777
E2      =    -7.078946493481
E3      =   -10.369383006263
Exc     =    -9.140421096377
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 1.716e-05, dEband = 9.066e-03
rank = 0, Calculating/Estimating energy took 1.085 ms, Etot = -25.357455831, dEtot = 1.716e-05, dEband = 9.066e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2373523386891, which took 0.066 ms

iter_count = 114, r_2norm = 6.114e-06, tol*||rhs|| = 9.494e-06

Anderson update took 60.383 ms, out of which F'*F took 28.593 ms; b-Ax took 192.303 ms, out of which Lap took 172.532 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.951 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710152, int_b + int_rho = 2.547e-14, checking this took 0.119 ms
2-norm of RHS = 661.6908272763001, which took 0.115 ms

iter_count = 228, r_2norm = 5.303e-04, tol*||rhs|| = 6.617e-04

Anderson update took 121.608 ms, out of which F'*F took 57.013 ms; b-Ax took 385.102 ms, out of which Lap took 344.456 ms
Solving Poisson took 816.948 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.074 ms
Total time for convolution: 	 convolve: 5.088755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.003 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.078851 
Total time for convolution: 	 convolve: 5.094221 
Total time for convolution: 	 convolve: 5.085829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.287 ms

This SCF took 26851.757 ms, scf error = 1.857e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.141264, lowerbound = -0.875950, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1163.014 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.816 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.173 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 31.012 ms
rank =  0, finding HY took 19.524 ms
rank =  0, distributing HY into block cyclic form took 12.082 ms
rank =  0, finding Y'*HY took 4.138 ms
Rank 0, Project_Hamiltonian used 66.783 ms
Total time for projection: 66.796 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -0.874244758538994
    last  calculated eigval = 0.038794749556920
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87424475853899
lambda[   2] =  -0.59086419843397
lambda[   3] =  -0.54995585702931
lambda[   4] =  -0.46556149014021
lambda[   5] =  -0.41605118352110
lambda[   6] =  -0.32589872267658
lambda[   7] =  -0.30268532018356
lambda[   8] =  -0.29166022108413
lambda[   9] =  -0.20840958274045
lambda[  10] =  -0.03026491840546
lambda[  11] =  -0.00219608894906
lambda[  12] =   0.01302397417343
lambda[  13] =   0.01505979713874
lambda[  14] =   0.02843425798036
lambda[  15] =   0.03879474955692
==subpsace eigenproblem: bcast eigvals took 0.054 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 3.560 ms
rank =  0, Distributing orbital back into band + domain format took 12.018 ms
rank = 0, Subspace_Rotation used 15.592 ms

Total time for subspace rotation: 15.596 ms
rank = 0, Efermi =  -0.059156849598 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.134 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.317 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1252.351 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.672 ms
rank = 0, D2D took 0.845 ms
rank = 0, Transfering density took 0.849 ms
Etot    =   -25.357467467881
Eband   =    -8.050662669517
E1      =    18.942251900794
E2      =    -7.061424309507
E3      =   -10.371330701449
Exc     =    -9.141866255142
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 1.455e-06, dEband = 3.979e-03
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -25.357467468, dEtot = 1.455e-06, dEband = 3.979e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1148631966522, which took 0.060 ms

iter_count = 114, r_2norm = 3.760e-06, tol*||rhs|| = 4.595e-06

Anderson update took 60.711 ms, out of which F'*F took 28.800 ms; b-Ax took 193.787 ms, out of which Lap took 173.721 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.822 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710155, int_b + int_rho = 5.821e-14, checking this took 0.111 ms
2-norm of RHS = 661.6640774471983, which took 0.135 ms

iter_count = 210, r_2norm = 5.824e-04, tol*||rhs|| = 6.617e-04

Anderson update took 112.325 ms, out of which F'*F took 52.197 ms; b-Ax took 354.721 ms, out of which Lap took 317.715 ms
Solving Poisson took 752.308 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.076956 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.079426 
Total time for convolution: 	 convolve: 5.085376 
Total time for convolution: 	 convolve: 5.083482 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.436 ms
---Transfer Veff_loc: D2D took 2.002 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.364 ms

This SCF took 26765.265 ms, scf error = 1.160e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.138795, lowerbound = -0.874245, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.077 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 14.610 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.351 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.051 ms
rank =  0, Distribute data + matrix mult took 18.025 ms
rank =  0, finding HY took 19.465 ms
rank =  0, distributing HY into block cyclic form took 12.159 ms
rank =  0, finding Y'*HY took 4.170 ms
Rank 0, Project_Hamiltonian used 53.848 ms
Total time for projection: 53.862 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.873074355154534
    last  calculated eigval = 0.037206654874588
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87307435515453
lambda[   2] =  -0.58959900240219
lambda[   3] =  -0.54862122498978
lambda[   4] =  -0.46432450450034
lambda[   5] =  -0.41473604507316
lambda[   6] =  -0.32456711485531
lambda[   7] =  -0.30147447085432
lambda[   8] =  -0.29040820543590
lambda[   9] =  -0.20717282372783
lambda[  10] =  -0.02805772514131
lambda[  11] =   0.00070706250185
lambda[  12] =   0.01535427216248
lambda[  13] =   0.01687721862939
lambda[  14] =   0.02778637006767
lambda[  15] =   0.03720665487459
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.538 ms
rank =  0, Distributing orbital back into band + domain format took 12.103 ms
rank = 0, Subspace_Rotation used 15.655 ms

Total time for subspace rotation: 15.659 ms
rank = 0, Efermi =  -0.056949656354 calculate fermi energy took 0.091 ms
rank = 0, --- Calculate rho: sum over local bands took 3.143 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.211 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.163 ms
rank = 0, Calculating density took 1240.440 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.629 ms
rank = 0, D2D took 0.829 ms
rank = 0, Transfering density took 0.837 ms
Etot    =   -25.357468195997
Eband   =    -8.027955494747
E1      =    18.930103169469
E2      =    -7.050255030359
E3      =   -10.374258374335
Exc     =    -9.144183820441
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 9.101e-08, dEband = 2.838e-03
rank = 0, Calculating/Estimating energy took 0.967 ms, Etot = -25.357468196, dEtot = 9.101e-08, dEband = 2.838e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0634645216833, which took 0.064 ms

iter_count = 114, r_2norm = 1.834e-06, tol*||rhs|| = 2.539e-06

Anderson update took 60.585 ms, out of which F'*F took 28.712 ms; b-Ax took 192.579 ms, out of which Lap took 172.733 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.992 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710153, int_b + int_rho = 3.638e-14, checking this took 0.077 ms
2-norm of RHS = 661.6666007762780, which took 0.125 ms

iter_count = 210, r_2norm = 5.503e-04, tol*||rhs|| = 6.617e-04

Anderson update took 112.726 ms, out of which F'*F took 52.605 ms; b-Ax took 354.967 ms, out of which Lap took 317.592 ms
Solving Poisson took 752.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.079334 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.859 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.090967 
Total time for convolution: 	 convolve: 5.087923 
Total time for convolution: 	 convolve: 5.081198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.148 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.311 ms

This SCF took 26757.234 ms, scf error = 7.904e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137207, lowerbound = -0.873074, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 13.486 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.227 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.150 ms
rank =  0, Distribute data + matrix mult took 16.876 ms
rank =  0, finding HY took 19.361 ms
rank =  0, distributing HY into block cyclic form took 12.246 ms
rank =  0, finding Y'*HY took 4.086 ms
Rank 0, Project_Hamiltonian used 52.600 ms
Total time for projection: 52.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.871632812707190
    last  calculated eigval = 0.038366022182537
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87163281270719
lambda[   2] =  -0.58831035447878
lambda[   3] =  -0.54731685594641
lambda[   4] =  -0.46303913252591
lambda[   5] =  -0.41340822276716
lambda[   6] =  -0.32328284415061
lambda[   7] =  -0.30014131645986
lambda[   8] =  -0.28908813953680
lambda[   9] =  -0.20593034609242
lambda[  10] =  -0.02367363578902
lambda[  11] =   0.00592788681207
lambda[  12] =   0.01915350350452
lambda[  13] =   0.01937487327898
lambda[  14] =   0.02823131996930
lambda[  15] =   0.03836602218254
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.189 ms
rank =  0, subspace rotation using ScaLAPACK took 3.566 ms
rank =  0, Distributing orbital back into band + domain format took 12.001 ms
rank = 0, Subspace_Rotation used 15.579 ms

Total time for subspace rotation: 15.584 ms
rank = 0, Efermi =  -0.052565566985 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.086 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.340 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1247.674 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.652 ms
rank = 0, D2D took 0.832 ms
rank = 0, Transfering density took 0.836 ms
Etot    =   -25.357539132566
Eband   =    -8.004300049972
E1      =    18.918339542270
E2      =    -7.038004183194
E3      =   -10.375977975283
Exc     =    -9.145615328369
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 8.867e-06, dEband = 2.957e-03
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -25.357539133, dEtot = 8.867e-06, dEband = 2.957e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0730889211489, which took 0.066 ms

iter_count = 108, r_2norm = 2.482e-06, tol*||rhs|| = 2.924e-06

Anderson update took 57.673 ms, out of which F'*F took 27.261 ms; b-Ax took 183.391 ms, out of which Lap took 164.689 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.221 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710154, int_b + int_rho = 4.366e-14, checking this took 0.095 ms
2-norm of RHS = 661.6780493185502, which took 0.152 ms

iter_count = 174, r_2norm = 5.956e-04, tol*||rhs|| = 6.617e-04

Anderson update took 92.695 ms, out of which F'*F took 43.424 ms; b-Ax took 294.167 ms, out of which Lap took 263.115 ms
Solving Poisson took 623.116 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.079644 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.240 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.074578 
Total time for convolution: 	 convolve: 5.073880 
Total time for convolution: 	 convolve: 5.078416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.520 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.306 ms

This SCF took 26602.941 ms, scf error = 4.513e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.138366, lowerbound = -0.871633, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1198.221 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.230 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.224 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.081 ms
rank =  0, Distribute data + matrix mult took 15.547 ms
rank =  0, finding HY took 19.387 ms
rank =  0, distributing HY into block cyclic form took 12.092 ms
rank =  0, finding Y'*HY took 4.197 ms
Rank 0, Project_Hamiltonian used 51.251 ms
Total time for projection: 51.258 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.871333854658003
    last  calculated eigval = 0.037382771390703
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87133385465800
lambda[   2] =  -0.58797458720411
lambda[   3] =  -0.54699463536746
lambda[   4] =  -0.46272917056323
lambda[   5] =  -0.41308023644265
lambda[   6] =  -0.32296181042180
lambda[   7] =  -0.29981298065608
lambda[   8] =  -0.28877866628192
lambda[   9] =  -0.20558276761161
lambda[  10] =  -0.02187915053681
lambda[  11] =   0.00684781320650
lambda[  12] =   0.01899634955934
lambda[  13] =   0.01927602937349
lambda[  14] =   0.02684749676508
lambda[  15] =   0.03738277139070
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.191 ms
rank =  0, subspace rotation using ScaLAPACK took 3.536 ms
rank =  0, Distributing orbital back into band + domain format took 12.092 ms
rank = 0, Subspace_Rotation used 15.639 ms

Total time for subspace rotation: 15.642 ms
rank = 0, Efermi =  -0.050771081740 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.169 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.193 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1271.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.631 ms
rank = 0, D2D took 0.839 ms
rank = 0, Transfering density took 0.847 ms
Etot    =   -25.357641203852
Eband   =    -7.998497419007
E1      =    18.915767121376
E2      =    -7.034651136520
E3      =   -10.376204936665
Exc     =    -9.145821524436
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 1.276e-05, dEband = 7.253e-04
rank = 0, Calculating/Estimating energy took 1.467 ms, Etot = -25.357641204, dEtot = 1.276e-05, dEband = 7.253e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0700550758597, which took 0.086 ms

iter_count = 108, r_2norm = 2.105e-06, tol*||rhs|| = 2.802e-06

Anderson update took 57.428 ms, out of which F'*F took 27.145 ms; b-Ax took 182.388 ms, out of which Lap took 163.506 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.000 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710158, int_b + int_rho = 9.095e-14, checking this took 0.103 ms
2-norm of RHS = 661.6848445766827, which took 0.131 ms

iter_count = 162, r_2norm = 6.085e-04, tol*||rhs|| = 6.617e-04

Anderson update took 86.137 ms, out of which F'*F took 40.848 ms; b-Ax took 273.823 ms, out of which Lap took 245.326 ms
Solving Poisson took 580.001 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.072200 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 64.548 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.076865 
Total time for convolution: 	 convolve: 5.083357 
Total time for convolution: 	 convolve: 5.088984 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.115 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.933 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.289 ms

This SCF took 26589.530 ms, scf error = 3.525e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.137383, lowerbound = -0.871334, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1162.933 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.196 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.257 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 16.528 ms
rank =  0, finding HY took 19.439 ms
rank =  0, distributing HY into block cyclic form took 12.174 ms
rank =  0, finding Y'*HY took 4.057 ms
Rank 0, Project_Hamiltonian used 52.231 ms
Total time for projection: 52.243 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.080 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.871203641768774
    last  calculated eigval = 0.038197662172187
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87120364176877
lambda[   2] =  -0.58780930009373
lambda[   3] =  -0.54680140993942
lambda[   4] =  -0.46256335492934
lambda[   5] =  -0.41289842548699
lambda[   6] =  -0.32277256328909
lambda[   7] =  -0.29966406282167
lambda[   8] =  -0.28860430645139
lambda[   9] =  -0.20543255710561
lambda[  10] =  -0.01984071256542
lambda[  11] =   0.00780620407514
lambda[  12] =   0.01934979100230
lambda[  13] =   0.02014686672490
lambda[  14] =   0.02725216308589
lambda[  15] =   0.03819766217219
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 3.538 ms
rank =  0, Distributing orbital back into band + domain format took 12.033 ms
rank = 0, Subspace_Rotation used 15.585 ms

Total time for subspace rotation: 15.588 ms
rank = 0, Efermi =  -0.048732643774 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.201 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.264 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.161 ms
rank = 0, Calculating density took 1237.692 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
rank = 0, D2D took 1.287 ms
rank = 0, Transfering density took 1.291 ms
Etot    =   -25.357681273335
Eband   =    -7.995499244310
E1      =    18.914430725788
E2      =    -7.032966668485
E3      =   -10.376251762400
Exc     =    -9.145885730726
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 5.009e-06, dEband = 3.748e-04
rank = 0, Calculating/Estimating energy took 0.894 ms, Etot = -25.357681273, dEtot = 5.009e-06, dEband = 3.748e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0469529684010, which took 0.051 ms

iter_count = 114, r_2norm = 1.221e-06, tol*||rhs|| = 1.878e-06

Anderson update took 60.899 ms, out of which F'*F took 28.763 ms; b-Ax took 193.408 ms, out of which Lap took 173.467 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.298 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710151, int_b + int_rho = 1.455e-14, checking this took 0.103 ms
2-norm of RHS = 661.6825792266847, which took 0.092 ms

iter_count = 144, r_2norm = 6.229e-04, tol*||rhs|| = 6.617e-04

Anderson update took 76.898 ms, out of which F'*F took 35.899 ms; b-Ax took 242.779 ms, out of which Lap took 217.493 ms
Solving Poisson took 516.279 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.078387 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.659 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.075757 
Total time for convolution: 	 convolve: 5.076575 
Total time for convolution: 	 convolve: 5.073368 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.016 ms
======D2D: initiated sending and receiving took 1.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
---Transfer Veff_loc: D2D took 0.948 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.301 ms

This SCF took 26512.100 ms, scf error = 3.188e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138198, lowerbound = -0.871204, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1146.669 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.459 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.226 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 18.722 ms
rank =  0, finding HY took 19.467 ms
rank =  0, distributing HY into block cyclic form took 12.182 ms
rank =  0, finding Y'*HY took 4.027 ms
Rank 0, Project_Hamiltonian used 54.425 ms
Total time for projection: 54.436 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.870937877424877
    last  calculated eigval = 0.037133813335506
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87093787742488
lambda[   2] =  -0.58758623486370
lambda[   3] =  -0.54659587756506
lambda[   4] =  -0.46234580386121
lambda[   5] =  -0.41268917082049
lambda[   6] =  -0.32258219358895
lambda[   7] =  -0.29942893073389
lambda[   8] =  -0.28838762537052
lambda[   9] =  -0.20520886721883
lambda[  10] =  -0.02128196168411
lambda[  11] =   0.00603488577288
lambda[  12] =   0.01840026731064
lambda[  13] =   0.01894288173273
lambda[  14] =   0.02644656647641
lambda[  15] =   0.03713381333551
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 3.551 ms
rank =  0, Distributing orbital back into band + domain format took 12.116 ms
rank = 0, Subspace_Rotation used 15.679 ms

Total time for subspace rotation: 15.683 ms
rank = 0, Efermi =  -0.050173892959 calculate fermi energy took 0.667 ms
rank = 0, --- Calculate rho: sum over local bands took 3.188 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.377 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1223.847 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.657 ms
rank = 0, D2D took 0.828 ms
rank = 0, Transfering density took 0.831 ms
Etot    =   -25.357713943712
Eband   =    -7.991525163472
E1      =    18.912162909998
E2      =    -7.031103160301
E3      =   -10.376771195907
Exc     =    -9.146280591474
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 4.084e-06, dEband = 4.968e-04
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -25.357713944, dEtot = 4.084e-06, dEband = 4.968e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0488884327544, which took 0.059 ms

iter_count = 108, r_2norm = 1.662e-06, tol*||rhs|| = 1.956e-06

Anderson update took 57.157 ms, out of which F'*F took 26.976 ms; b-Ax took 183.805 ms, out of which Lap took 164.399 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.887 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710156, int_b + int_rho = 7.276e-14, checking this took 0.112 ms
2-norm of RHS = 661.6829464841771, which took 0.162 ms

iter_count = 138, r_2norm = 6.114e-04, tol*||rhs|| = 6.617e-04

Anderson update took 73.509 ms, out of which F'*F took 34.578 ms; b-Ax took 233.103 ms, out of which Lap took 208.825 ms
Solving Poisson took 494.533 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.079132 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 56.906 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.079102 
Total time for convolution: 	 convolve: 5.078814 
Total time for convolution: 	 convolve: 5.075915 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.469 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.286 ms

This SCF took 26440.394 ms, scf error = 2.391e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.137134, lowerbound = -0.870938, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1174.397 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 14.893 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.222 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.077 ms
rank =  0, Distribute data + matrix mult took 18.205 ms
rank =  0, finding HY took 19.352 ms
rank =  0, distributing HY into block cyclic form took 12.181 ms
rank =  0, finding Y'*HY took 4.075 ms
Rank 0, Project_Hamiltonian used 53.842 ms
Total time for projection: 53.856 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.870778756438271
    last  calculated eigval = 0.038531947134773
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87077875643827
lambda[   2] =  -0.58743180005562
lambda[   3] =  -0.54644334261312
lambda[   4] =  -0.46219303668371
lambda[   5] =  -0.41253849604253
lambda[   6] =  -0.32243413026862
lambda[   7] =  -0.29927726990075
lambda[   8] =  -0.28823501720911
lambda[   9] =  -0.20506547726648
lambda[  10] =  -0.02018957880850
lambda[  11] =   0.00628754023258
lambda[  12] =   0.01868873408175
lambda[  13] =   0.01942378329482
lambda[  14] =   0.02755365053261
lambda[  15] =   0.03853194713477
==subpsace eigenproblem: bcast eigvals took 0.048 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 3.297 ms
rank =  0, Distributing orbital back into band + domain format took 12.113 ms
rank = 0, Subspace_Rotation used 15.425 ms

Total time for subspace rotation: 15.428 ms
rank = 0, Efermi =  -0.049081510024 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.043 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.295 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.169 ms
rank = 0, Calculating density took 1250.534 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.558 ms
rank = 0, D2D took 0.671 ms
rank = 0, Transfering density took 0.674 ms
Etot    =   -25.357733987196
Eband   =    -7.988794653504
E1      =    18.910809058438
E2      =    -7.029669902153
E3      =   -10.376941157282
Exc     =    -9.146413996596
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 2.505e-06, dEband = 3.413e-04
rank = 0, Calculating/Estimating energy took 1.480 ms, Etot = -25.357733987, dEtot = 2.505e-06, dEband = 3.413e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0429752364663, which took 0.063 ms

iter_count = 108, r_2norm = 1.117e-06, tol*||rhs|| = 1.719e-06

Anderson update took 57.517 ms, out of which F'*F took 27.256 ms; b-Ax took 183.010 ms, out of which Lap took 164.256 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.682 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710156, int_b + int_rho = 6.912e-14, checking this took 0.133 ms
2-norm of RHS = 661.6867410754730, which took 0.138 ms

iter_count = 156, r_2norm = 6.320e-04, tol*||rhs|| = 6.617e-04

Anderson update took 83.240 ms, out of which F'*F took 38.923 ms; b-Ax took 263.418 ms, out of which Lap took 235.738 ms
Solving Poisson took 558.810 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.074118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 54.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.076028 
Total time for convolution: 	 convolve: 5.079529 
Total time for convolution: 	 convolve: 5.072795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.535 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.310 ms

This SCF took 26520.117 ms, scf error = 2.010e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138532, lowerbound = -0.870779, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1177.642 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.460 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.245 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 15.780 ms
rank =  0, finding HY took 19.380 ms
rank =  0, distributing HY into block cyclic form took 12.213 ms
rank =  0, finding Y'*HY took 4.090 ms
Rank 0, Project_Hamiltonian used 51.488 ms
Total time for projection: 51.501 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.870868580284837
    last  calculated eigval = 0.041582671589163
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87086858028484
lambda[   2] =  -0.58747024332834
lambda[   3] =  -0.54647167656144
lambda[   4] =  -0.46222439636806
lambda[   5] =  -0.41257733482854
lambda[   6] =  -0.32244364376293
lambda[   7] =  -0.29933989936002
lambda[   8] =  -0.28828278914867
lambda[   9] =  -0.20513634544662
lambda[  10] =  -0.01972849920455
lambda[  11] =   0.00622703932145
lambda[  12] =   0.01879219419003
lambda[  13] =   0.01951239517194
lambda[  14] =   0.02943043778328
lambda[  15] =   0.04158267158916
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.318 ms
rank =  0, Distributing orbital back into band + domain format took 11.962 ms
rank = 0, Subspace_Rotation used 15.296 ms

Total time for subspace rotation: 15.300 ms
rank = 0, Efermi =  -0.048620430374 calculate fermi energy took 0.089 ms
rank = 0, --- Calculate rho: sum over local bands took 3.006 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.256 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1251.215 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 1.300 ms
rank = 0, Transfering density took 1.302 ms
Etot    =   -25.357749543531
Eband   =    -7.989629818714
E1      =    18.911835870757
E2      =    -7.029588265019
E3      =   -10.376347724126
Exc     =    -9.145946129748
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 1.945e-06, dEband = 1.044e-04
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -25.357749544, dEtot = 1.945e-06, dEband = 1.044e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0359575928728, which took 0.059 ms

iter_count = 108, r_2norm = 1.013e-06, tol*||rhs|| = 1.438e-06

Anderson update took 57.443 ms, out of which F'*F took 27.128 ms; b-Ax took 182.375 ms, out of which Lap took 163.473 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.229 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710151, int_b + int_rho = 2.183e-14, checking this took 0.101 ms
2-norm of RHS = 661.6857570077177, which took 0.141 ms

iter_count = 90, r_2norm = 6.314e-04, tol*||rhs|| = 6.617e-04

Anderson update took 47.822 ms, out of which F'*F took 22.769 ms; b-Ax took 153.179 ms, out of which Lap took 137.540 ms
Solving Poisson took 324.205 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.080434 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.771 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.074465 
Total time for convolution: 	 convolve: 5.080347 
Total time for convolution: 	 convolve: 5.076795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.844 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.291 ms

This SCF took 26363.921 ms, scf error = 3.023e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.141583, lowerbound = -0.870869, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1382.840 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 10.869 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.003 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 28.892 ms
rank =  0, Distribute data + matrix mult took 42.774 ms
rank =  0, finding HY took 18.593 ms
rank =  0, distributing HY into block cyclic form took 18.633 ms
rank =  0, finding Y'*HY took 4.157 ms
Rank 0, Project_Hamiltonian used 84.187 ms
Total time for projection: 84.203 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.870799076235129
    last  calculated eigval = 0.040614541693700
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87079907623513
lambda[   2] =  -0.58740579294985
lambda[   3] =  -0.54641197312852
lambda[   4] =  -0.46216461061735
lambda[   5] =  -0.41251614378976
lambda[   6] =  -0.32238864192485
lambda[   7] =  -0.29927343646223
lambda[   8] =  -0.28821795248616
lambda[   9] =  -0.20506811653883
lambda[  10] =  -0.01943264811162
lambda[  11] =   0.00662705104034
lambda[  12] =   0.01886853667817
lambda[  13] =   0.01962598574012
lambda[  14] =   0.02898864698597
lambda[  15] =   0.04061454169370
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.520 ms
rank =  0, Distributing orbital back into band + domain format took 11.854 ms
rank = 0, Subspace_Rotation used 15.393 ms

Total time for subspace rotation: 15.397 ms
rank = 0, Efermi =  -0.048324579365 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.977 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.400 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.198 ms
rank = 0, Calculating density took 1489.321 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
rank = 0, D2D took 0.701 ms
rank = 0, Transfering density took 0.707 ms
Etot    =   -25.357753696576
Eband   =    -7.988491488792
E1      =    18.911194288671
E2      =    -7.029059358337
E3      =   -10.376482958655
Exc     =    -9.146053358476
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 5.191e-07, dEband = 1.423e-04
rank = 0, Calculating/Estimating energy took 1.466 ms, Etot = -25.357753697, dEtot = 5.191e-07, dEband = 1.423e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0369293854116, which took 0.065 ms

iter_count = 108, r_2norm = 1.007e-06, tol*||rhs|| = 1.477e-06

Anderson update took 57.497 ms, out of which F'*F took 27.272 ms; b-Ax took 183.645 ms, out of which Lap took 164.699 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.155 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710154, int_b + int_rho = 4.729e-14, checking this took 0.099 ms
2-norm of RHS = 661.6856551518598, which took 0.160 ms

iter_count = 36, r_2norm = 6.265e-04, tol*||rhs|| = 6.617e-04

Anderson update took 19.195 ms, out of which F'*F took 9.000 ms; b-Ax took 60.817 ms, out of which Lap took 54.353 ms
Solving Poisson took 131.601 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.086358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.470 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.108627 
Total time for convolution: 	 convolve: 5.090993 
Total time for convolution: 	 convolve: 5.080066 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.848 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.933 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.290 ms

This SCF took 26430.237 ms, scf error = 2.726e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.140615, lowerbound = -0.870799, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.509 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 19.501 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.213 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.092 ms
rank =  0, Distribute data + matrix mult took 22.819 ms
rank =  0, finding HY took 19.462 ms
rank =  0, distributing HY into block cyclic form took 12.125 ms
rank =  0, finding Y'*HY took 2.760 ms
Rank 0, Project_Hamiltonian used 58.572 ms
Total time for projection: 58.597 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.870801951146051
    last  calculated eigval = 0.040338321098877
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87080195114605
lambda[   2] =  -0.58741082439811
lambda[   3] =  -0.54641717347208
lambda[   4] =  -0.46216941069016
lambda[   5] =  -0.41252046814436
lambda[   6] =  -0.32239392963140
lambda[   7] =  -0.29927782003325
lambda[   8] =  -0.28822243548897
lambda[   9] =  -0.20507293606877
lambda[  10] =  -0.01959950096215
lambda[  11] =   0.00647877426204
lambda[  12] =   0.01876788958833
lambda[  13] =   0.01942220879930
lambda[  14] =   0.02880686480798
lambda[  15] =   0.04033832109888
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.584 ms
rank =  0, Distributing orbital back into band + domain format took 12.094 ms
rank = 0, Subspace_Rotation used 15.689 ms

Total time for subspace rotation: 15.694 ms
rank = 0, Efermi =  -0.048491432117 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.138 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.284 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1246.679 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.859 ms
rank = 0, Transfering density took 0.867 ms
Etot    =   -25.357758834707
Eband   =    -7.988573898677
E1      =    18.911227477778
E2      =    -7.029111135180
E3      =   -10.376451656299
Exc     =    -9.146029750315
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 6.423e-07, dEband = 1.030e-05
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -25.357758835, dEtot = 6.423e-07, dEband = 1.030e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0403466787822, which took 0.059 ms

iter_count = 108, r_2norm = 9.883e-07, tol*||rhs|| = 1.614e-06

Anderson update took 56.870 ms, out of which F'*F took 27.128 ms; b-Ax took 182.825 ms, out of which Lap took 163.814 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.043 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710151, int_b + int_rho = 1.819e-14, checking this took 0.097 ms
2-norm of RHS = 661.6855706597979, which took 0.147 ms

iter_count = 72, r_2norm = 5.877e-04, tol*||rhs|| = 6.617e-04

Anderson update took 38.119 ms, out of which F'*F took 18.167 ms; b-Ax took 121.648 ms, out of which Lap took 108.868 ms
Solving Poisson took 258.989 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.101990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.331 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.082201 
Total time for convolution: 	 convolve: 5.081656 
Total time for convolution: 	 convolve: 5.085991 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
---Transfer Veff_loc: D2D took 0.961 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.327 ms

This SCF took 26268.142 ms, scf error = 2.696e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.140338, lowerbound = -0.870802, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1150.786 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.385 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.123 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.534 ms
rank =  0, finding HY took 19.467 ms
rank =  0, distributing HY into block cyclic form took 12.211 ms
rank =  0, finding Y'*HY took 4.050 ms
Rank 0, Project_Hamiltonian used 52.042 ms
Total time for projection: 52.059 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.870845249619155
    last  calculated eigval = 0.040312896959027
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87084524961916
lambda[   2] =  -0.58745036095978
lambda[   3] =  -0.54645652185924
lambda[   4] =  -0.46220755438307
lambda[   5] =  -0.41255995829566
lambda[   6] =  -0.32243037104957
lambda[   7] =  -0.29931908394055
lambda[   8] =  -0.28826286796310
lambda[   9] =  -0.20511585912363
lambda[  10] =  -0.01967966237828
lambda[  11] =   0.00638219631898
lambda[  12] =   0.01868993901187
lambda[  13] =   0.01925786771720
lambda[  14] =   0.02879170586225
lambda[  15] =   0.04031289695903
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.551 ms
rank =  0, Distributing orbital back into band + domain format took 12.116 ms
rank = 0, Subspace_Rotation used 15.679 ms

Total time for subspace rotation: 15.683 ms
rank = 0, Efermi =  -0.048571593649 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.119 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.235 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 1225.341 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.605 ms
rank = 0, D2D took 0.772 ms
rank = 0, Transfering density took 0.779 ms
Etot    =   -25.357753954322
Eband   =    -7.989295654921
E1      =    18.911619501005
E2      =    -7.029471325663
E3      =   -10.376350016530
Exc     =    -9.145953687628
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 6.100e-07, dEband = 9.022e-05
rank = 0, Calculating/Estimating energy took 1.097 ms, Etot = -25.357753954, dEtot = 6.100e-07, dEband = 9.022e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0436019523470, which took 0.063 ms

iter_count = 102, r_2norm = 1.703e-06, tol*||rhs|| = 1.744e-06

Anderson update took 54.084 ms, out of which F'*F took 25.795 ms; b-Ax took 173.286 ms, out of which Lap took 155.645 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.669 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710145, int_b + int_rho = -4.002e-14, checking this took 0.125 ms
2-norm of RHS = 661.6845538876554, which took 0.148 ms

iter_count = 78, r_2norm = 6.090e-04, tol*||rhs|| = 6.617e-04

Anderson update took 41.533 ms, out of which F'*F took 19.506 ms; b-Ax took 131.990 ms, out of which Lap took 117.921 ms
Solving Poisson took 281.035 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.124 ms
Total time for convolution: 	 convolve: 5.084178 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.074318 
Total time for convolution: 	 convolve: 5.078331 
Total time for convolution: 	 convolve: 5.075080 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 0.949 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.348 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.320 ms

This SCF took 26241.976 ms, scf error = 2.803e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.140313, lowerbound = -0.870845, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1185.654 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.087 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.257 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.058 ms
rank =  0, Distribute data + matrix mult took 23.417 ms
rank =  0, finding HY took 19.438 ms
rank =  0, distributing HY into block cyclic form took 12.093 ms
rank =  0, finding Y'*HY took 4.267 ms
Rank 0, Project_Hamiltonian used 59.245 ms
Total time for projection: 59.262 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.870823665313815
    last  calculated eigval = 0.039967941814115
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87082366531382
lambda[   2] =  -0.58743764068810
lambda[   3] =  -0.54644607537761
lambda[   4] =  -0.46219533426212
lambda[   5] =  -0.41254866819017
lambda[   6] =  -0.32242288084410
lambda[   7] =  -0.29930397119170
lambda[   8] =  -0.28824928909885
lambda[   9] =  -0.20510287470782
lambda[  10] =  -0.02020028077296
lambda[  11] =   0.00601513875844
lambda[  12] =   0.01848992724048
lambda[  13] =   0.01893967650011
lambda[  14] =   0.02845696789539
lambda[  15] =   0.03996794181411
==subpsace eigenproblem: bcast eigvals took 0.053 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 3.567 ms
rank =  0, Distributing orbital back into band + domain format took 11.952 ms
rank = 0, Subspace_Rotation used 15.530 ms

Total time for subspace rotation: 15.534 ms
rank = 0, Efermi =  -0.049092211985 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 3.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.327 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.171 ms
rank = 0, Calculating density took 1267.356 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.608 ms
rank = 0, D2D took 0.795 ms
rank = 0, Transfering density took 0.798 ms
Etot    =   -25.357756561147
Eband   =    -7.989060799896
E1      =    18.911417457286
E2      =    -7.029414672331
E3      =   -10.376424962490
Exc     =    -9.146007398387
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 3.259e-07, dEband = 2.936e-05
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -25.357756561, dEtot = 3.259e-07, dEband = 2.936e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0410922310318, which took 0.136 ms

iter_count = 108, r_2norm = 1.004e-06, tol*||rhs|| = 1.644e-06

Anderson update took 56.942 ms, out of which F'*F took 27.375 ms; b-Ax took 183.273 ms, out of which Lap took 164.183 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 393.472 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710149, int_b + int_rho = -7.276e-15, checking this took 0.108 ms
2-norm of RHS = 661.6833978523074, which took 0.126 ms

iter_count = 84, r_2norm = 6.487e-04, tol*||rhs|| = 6.617e-04

Anderson update took 44.580 ms, out of which F'*F took 21.083 ms; b-Ax took 142.268 ms, out of which Lap took 127.286 ms
Solving Poisson took 303.199 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.122198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 35.944 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.075159 
Total time for convolution: 	 convolve: 5.076027 
Total time for convolution: 	 convolve: 5.082320 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.764 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 1.729 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.341 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.095 ms

This SCF took 26323.210 ms, scf error = 2.542e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.139968, lowerbound = -0.870824, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1147.515 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.561 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.309 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.045 ms
rank =  0, Distribute data + matrix mult took 15.927 ms
rank =  0, finding HY took 19.439 ms
rank =  0, distributing HY into block cyclic form took 12.287 ms
rank =  0, finding Y'*HY took 3.990 ms
Rank 0, Project_Hamiltonian used 51.673 ms
Total time for projection: 51.690 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.155 ms
    first calculated eigval = -0.870795114266254
    last  calculated eigval = 0.039975040416992
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87079511426625
lambda[   2] =  -0.58742091409011
lambda[   3] =  -0.54643332899386
lambda[   4] =  -0.46217809214556
lambda[   5] =  -0.41253654279780
lambda[   6] =  -0.32241397657639
lambda[   7] =  -0.29928527819427
lambda[   8] =  -0.28823190996223
lambda[   9] =  -0.20509103574759
lambda[  10] =  -0.02047311826116
lambda[  11] =   0.00577912359349
lambda[  12] =   0.01841054586132
lambda[  13] =   0.01874916729839
lambda[  14] =   0.02839891953494
lambda[  15] =   0.03997504041699
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.179 ms
rank =  0, subspace rotation using ScaLAPACK took 3.554 ms
rank =  0, Distributing orbital back into band + domain format took 12.122 ms
rank = 0, Subspace_Rotation used 15.691 ms

Total time for subspace rotation: 15.695 ms
rank = 0, Efermi =  -0.049365049393 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.121 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.288 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 1221.755 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.665 ms
rank = 0, D2D took 0.826 ms
rank = 0, Transfering density took 0.829 ms
Etot    =   -25.357754832732
Eband   =    -7.988772386103
E1      =    18.911157056912
E2      =    -7.029365751167
E3      =   -10.376517266441
Exc     =    -9.146077066178
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 2.161e-07, dEband = 3.605e-05
rank = 0, Calculating/Estimating energy took 0.943 ms, Etot = -25.357754833, dEtot = 2.161e-07, dEband = 3.605e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0376329648238, which took 0.055 ms

iter_count = 108, r_2norm = 9.786e-07, tol*||rhs|| = 1.505e-06

Anderson update took 57.354 ms, out of which F'*F took 27.332 ms; b-Ax took 183.552 ms, out of which Lap took 164.593 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.006 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710150, int_b + int_rho = 1.091e-14, checking this took 0.077 ms
2-norm of RHS = 661.6822927087602, which took 0.131 ms

iter_count = 108, r_2norm = 6.088e-04, tol*||rhs|| = 6.617e-04

Anderson update took 57.480 ms, out of which F'*F took 26.938 ms; b-Ax took 185.735 ms, out of which Lap took 166.497 ms
Solving Poisson took 390.750 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.082810 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.356 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.072847 
Total time for convolution: 	 convolve: 5.079296 
Total time for convolution: 	 convolve: 5.075150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.936 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.284 ms

This SCF took 26355.578 ms, scf error = 2.198e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.139975, lowerbound = -0.870795, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1200.934 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.349 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.298 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 15.689 ms
rank =  0, finding HY took 19.368 ms
rank =  0, distributing HY into block cyclic form took 12.224 ms
rank =  0, finding Y'*HY took 4.080 ms
Rank 0, Project_Hamiltonian used 51.389 ms
Total time for projection: 51.401 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.870691690533703
    last  calculated eigval = 0.040391059410303
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87069169053370
lambda[   2] =  -0.58733658874374
lambda[   3] =  -0.54635502872980
lambda[   4] =  -0.46209306269090
lambda[   5] =  -0.41246114289032
lambda[   6] =  -0.32234308816633
lambda[   7] =  -0.29919859876053
lambda[   8] =  -0.28814618843170
lambda[   9] =  -0.20501657175611
lambda[  10] =  -0.02040235352625
lambda[  11] =   0.00575912852282
lambda[  12] =   0.01852136588293
lambda[  13] =   0.01877953903914
lambda[  14] =   0.02869176395292
lambda[  15] =   0.04039105941030
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 3.570 ms
rank =  0, Distributing orbital back into band + domain format took 12.098 ms
rank = 0, Subspace_Rotation used 15.681 ms

Total time for subspace rotation: 15.685 ms
rank = 0, Efermi =  -0.049294284808 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.123 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.231 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.163 ms
rank = 0, Calculating density took 1274.850 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.642 ms
rank = 0, D2D took 0.803 ms
rank = 0, Transfering density took 0.806 ms
Etot    =   -25.357754233961
Eband   =    -7.987283921959
E1      =    18.910218443075
E2      =    -7.028763376374
E3      =   -10.376758666560
Exc     =    -9.146265343040
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 7.485e-08, dEband = 1.861e-04
rank = 0, Calculating/Estimating energy took 1.061 ms, Etot = -25.357754234, dEtot = 7.485e-08, dEband = 1.861e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1342576177410, which took 0.137 ms

iter_count = 84, r_2norm = 4.847e-06, tol*||rhs|| = 5.370e-06

Anderson update took 44.352 ms, out of which F'*F took 21.108 ms; b-Ax took 142.501 ms, out of which Lap took 127.798 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 309.268 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710150, int_b + int_rho = 3.638e-15, checking this took 0.098 ms
2-norm of RHS = 661.6846671924948, which took 0.135 ms

iter_count = 150, r_2norm = 6.275e-04, tol*||rhs|| = 6.617e-04

Anderson update took 79.589 ms, out of which F'*F took 37.737 ms; b-Ax took 253.820 ms, out of which Lap took 227.590 ms
Solving Poisson took 537.246 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.087924 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 59.807 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.078605 
Total time for convolution: 	 convolve: 5.081419 
Total time for convolution: 	 convolve: 5.096157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.500 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.295 ms

This SCF took 26488.488 ms, scf error = 1.636e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.140391, lowerbound = -0.870692, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1165.520 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.607 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.265 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 18.922 ms
rank =  0, finding HY took 19.409 ms
rank =  0, distributing HY into block cyclic form took 12.203 ms
rank =  0, finding Y'*HY took 4.045 ms
Rank 0, Project_Hamiltonian used 54.607 ms
Total time for projection: 54.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.870398083425771
    last  calculated eigval = 0.044138846158776
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87039808342577
lambda[   2] =  -0.58705107142811
lambda[   3] =  -0.54607527905610
lambda[   4] =  -0.46181069680183
lambda[   5] =  -0.41218352248713
lambda[   6] =  -0.32206453229323
lambda[   7] =  -0.29891795144795
lambda[   8] =  -0.28786618001010
lambda[   9] =  -0.20475034984895
lambda[  10] =  -0.01854815910112
lambda[  11] =   0.00670333236507
lambda[  12] =   0.01961193051465
lambda[  13] =   0.01970364498420
lambda[  14] =   0.03150956479490
lambda[  15] =   0.04413884615878
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.538 ms
rank =  0, Distributing orbital back into band + domain format took 12.152 ms
rank = 0, Subspace_Rotation used 15.704 ms

Total time for subspace rotation: 15.709 ms
rank = 0, Efermi =  -0.047440090288 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.238 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.164 ms
rank = 0, Calculating density took 1242.644 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.669 ms
rank = 0, D2D took 0.830 ms
rank = 0, Transfering density took 0.834 ms
Etot    =   -25.357767370663
Eband   =    -7.982235334101
E1      =    18.907670020209
E2      =    -7.026138349235
E3      =   -10.377254679522
Exc     =    -9.146649630557
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 1.642e-06, dEband = 6.311e-04
rank = 0, Calculating/Estimating energy took 1.775 ms, Etot = -25.357767371, dEtot = 1.642e-06, dEband = 6.311e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1086582855552, which took 0.117 ms

iter_count = 84, r_2norm = 3.413e-06, tol*||rhs|| = 4.346e-06

Anderson update took 44.397 ms, out of which F'*F took 21.189 ms; b-Ax took 143.001 ms, out of which Lap took 128.411 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 308.582 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710147, int_b + int_rho = -2.183e-14, checking this took 0.127 ms
2-norm of RHS = 661.6842367842149, which took 0.161 ms

iter_count = 114, r_2norm = 6.528e-04, tol*||rhs|| = 6.617e-04

Anderson update took 60.752 ms, out of which F'*F took 28.500 ms; b-Ax took 193.135 ms, out of which Lap took 172.689 ms
Solving Poisson took 409.476 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.083942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 74.590 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.078041 
Total time for convolution: 	 convolve: 5.075722 
Total time for convolution: 	 convolve: 5.076151 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.476 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.284 ms

This SCF took 26323.244 ms, scf error = 1.145e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.144139, lowerbound = -0.870398, upperbound = 267.568674

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1199.042 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.269 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.196 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.482 ms
rank =  0, finding HY took 19.354 ms
rank =  0, distributing HY into block cyclic form took 12.131 ms
rank =  0, finding Y'*HY took 4.180 ms
Rank 0, Project_Hamiltonian used 51.174 ms
Total time for projection: 51.187 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.154 ms
    first calculated eigval = -0.870251895856168
    last  calculated eigval = 0.044525906358794
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.87025189585617
lambda[   2] =  -0.58692323767541
lambda[   3] =  -0.54595464885199
lambda[   4] =  -0.46168500445839
lambda[   5] =  -0.41206352660977
lambda[   6] =  -0.32195091280971
lambda[   7] =  -0.29878788845773
lambda[   8] =  -0.28773883642010
lambda[   9] =  -0.20462926436601
lambda[  10] =  -0.01876272557706
lambda[  11] =   0.00650828701623
lambda[  12] =   0.01949101505181
lambda[  13] =   0.01976164234259
lambda[  14] =   0.03162986593137
lambda[  15] =   0.04452590635879
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.624 ms
rank =  0, Distributing orbital back into band + domain format took 12.142 ms
rank = 0, Subspace_Rotation used 15.781 ms

Total time for subspace rotation: 15.785 ms
rank = 0, Efermi =  -0.047654656740 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.207 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1272.774 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 2.039 ms
rank = 0, D2D took 2.137 ms
rank = 0, Transfering density took 2.142 ms
Etot    =   -25.357769891930
Eband   =    -7.979970431519
E1      =    18.906360715397
E2      =    -7.025099417151
E3      =   -10.377598203501
Exc     =    -9.146912341488
Esc     =   -44.539945454164
Entropy =    -0.000000000807
dE = 3.152e-07, dEband = 2.831e-04
rank = 0, Calculating/Estimating energy took 1.046 ms, Etot = -25.357769892, dEtot = 3.152e-07, dEband = 2.831e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0275913695619, which took 0.103 ms

iter_count = 96, r_2norm = 8.511e-07, tol*||rhs|| = 1.104e-06

Anderson update took 50.847 ms, out of which F'*F took 24.216 ms; b-Ax took 162.650 ms, out of which Lap took 145.604 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 350.626 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000002710149, int_rho =  18.00000002710150, int_b + int_rho = 1.091e-14, checking this took 0.101 ms
2-norm of RHS = 661.6847397218745, which took 0.122 ms

iter_count = 108, r_2norm = 5.970e-04, tol*||rhs|| = 6.617e-04

Anderson update took 57.418 ms, out of which F'*F took 27.073 ms; b-Ax took 182.926 ms, out of which Lap took 163.852 ms
Solving Poisson took 387.887 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.085699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.084440 
Total time for convolution: 	 convolve: 5.085773 
Total time for convolution: 	 convolve: 5.072633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.101 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.294 ms

This SCF took 26403.129 ms, scf error = 5.800e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.87025189585617, occ[   1] =   2.00000000000000
lambda[   2] =  -0.58692323767541, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54595464885199, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46168500445839, occ[   4] =   2.00000000000000
lambda[   5] =  -0.41206352660977, occ[   5] =   2.00000000000000
lambda[   6] =  -0.32195091280971, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29878788845773, occ[   7] =   2.00000000000000
lambda[   8] =  -0.28773883642010, occ[   8] =   2.00000000000000
lambda[   9] =  -0.20462926436601, occ[   9] =   2.00000000000000
lambda[  10] =  -0.01876272557706, occ[  10] =   0.00000002710152
lambda[  11] =   0.00650828701623, occ[  11] =   0.00000000000000
lambda[  12] =   0.01949101505181, occ[  12] =   0.00000000000000
lambda[  13] =   0.01976164234259, occ[  13] =   0.00000000000000
lambda[  14] =   0.03162986593137, occ[  14] =   0.00000000000000
lambda[  15] =   0.04452590635879, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.572 ms, time for Allreduce/Reduce: 7.766 ms 
Time for calculating local force components: 17.233 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.05770304149949  -0.02795288123246  -0.00000000030443
  0.04337085520084   0.00996013255151  -0.02608616715691
 -0.04229161697057   0.01511844732916  -0.02442153958594
  0.04337085891893   0.00996014873848   0.02608615550659
 -0.04229161029303   0.01511844792710   0.02442153132393
  0.01249083719452   0.13342797297586  -0.14405052088436
  0.01249089524395   0.13342679728718   0.14405187305310
  0.63995243798272  -0.66461398794446   0.00000052481300
force_loc = 
  0.05952666010442   0.02947087981160  -0.00000018744508
 -0.04495542675471  -0.01021139195538   0.02643579777202
  0.04390795865293  -0.01544472713941   0.02497515278615
 -0.04495620231046  -0.01021169016534  -0.02643607518544
  0.04390812856793  -0.01544455993340  -0.02497532590483
 -0.01262439221422  -0.13195512596737   0.14314766194541
 -0.01262361443577  -0.13195595643756  -0.14314382075488
 -0.62348092103276   0.65112445088745  -0.00000061635465
Time for calculating nonlocal force components: 27.411 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00029572558660  -0.00450010262171   0.00371584047918
[0m[32m -0.00029568219035  -0.00450016349430  -0.00371562397601
[0m[32m -0.01745658914189   0.01918558954289  -0.00000004204815
[0mTime for calculating XC forces components: 23.907 ms
 Cartesian force = 
  0.00181814242539   0.00151771355915  -0.00000076500935
 -0.00159004773342  -0.00025154442385   0.00034905335527
  0.00161086550281  -0.00032656483023   0.00055303594038
 -0.00159081957108  -0.00025182644684  -0.00035049693868
  0.00161104209536  -0.00032639702628  -0.00055437184074
 -0.00043475678585  -0.00302754063320   0.00281240428039
 -0.00043387756172  -0.00302960766465  -0.00280814893763
 -0.00099054837148   0.00569576746589  -0.00000071084964
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.329 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Time for printing density: 392.593 ms
The program took 644.809 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:49
Job ID:        2266504
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:13:12,vmem=8484K,walltime=00:11:06,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-8-2
---------------------------------------
