---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:54
Job ID:    2266520
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:01
Job ID:    2266520
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.070 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 2.133 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.008 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 17.161 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 77.801 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.079 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   14.954266	   10.923894	   10.000000	
   14.977158	    8.009828	   11.663687	
   14.977158	    8.009828	    8.336313	
   10.499299	    7.096414	   10.000000	
   10.795697	   12.903586	   10.000000	
   14.232073	    8.989277	   10.000000	
   11.410846	    8.942338	   10.000000	
    9.958312	   11.026230	   10.000000	
    7.254728	   10.904403	   10.000000	
    5.022842	   10.835763	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.166 ms
Set up communicators.

--set up spincomm took 2.304 ms

--set up kptcomm took 0.358 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.037 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.858 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.907 ms

Calculate_SplineDerivRadFun took 0.198 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.281 ms.
time spent on vectorized spline interp: 2.715 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.039 ms.
time spent on vectorized spline interp: 1.631 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.509 ms.
time spent on vectorized spline interp: 1.637 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.272 ms.

Calculating rb for all atom types took 16.095 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.056 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000265400, sum_int_rho = 25.4852075718585
PosCharge = 26.000000026540, NegCharge = -25.485207571859, scal_fac = 1.020199657124
After scaling, int_rho = 26.0000000265399, PosCharge + NegCharge - NetCharge = 1.137e-13
--Calculate Vref took 0.533 ms
--Calculate rho_guess took 20.305 ms

 integral of b = -26.0000000265400,
 int{b} + Nelectron + NetCharge = -2.654e-08,
 Esc = -65.2401738311412,
 MPI_Reduce took 0.045 ms

Calculating b & b_ref took 30.358 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.031 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 39.130 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002654003, int_b + int_rho = 3.638e-14, checking this took 0.090 ms
2-norm of RHS = 746.6789042459573, which took 0.842 ms

iter_count = 420, r_2norm = 6.842e-04, tol*||rhs|| = 7.467e-04

Anderson update took 241.173 ms, out of which F'*F took 113.546 ms; b-Ax took 723.243 ms, out of which Lap took 649.052 ms
Solving Poisson took 1532.512 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.390 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
Total time for convolution: 	 convolve: 5.131949 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 119.501 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
Total time for convolution: 	 convolve: 5.127575 
Total time for convolution: 	 convolve: 5.212639 
Total time for convolution: 	 convolve: 5.170916 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.674 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
rank = 0, XC calculation took 24673.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 2.209 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.190 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.517 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.673 ms
    Lanczos iter 52, eigmin  = -0.891918702, eigmax = 264.918356167, err_eigmin = 5.703e-04, err_eigmax = 9.840e-03
rank =   0, Lanczos took 118.806 ms, eigmin = -0.891918701870, eigmax = 267.567539728808

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.287811, lowerbound = -0.991919, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1714.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 26.713 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.770 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 30.515 ms
rank =  0, finding HY took 30.498 ms
rank =  0, distributing HY into block cyclic form took 19.064 ms
rank =  0, finding Y'*HY took 5.606 ms
Rank 0, Project_Hamiltonian used 85.717 ms
Total time for projection: 85.732 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.741 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.812 ms
    first calculated eigval = 2.713044300030277
    last  calculated eigval = 3.226848743097193
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81994990403345
lambda[   5] =   2.86656557616382
lambda[   6] =   2.87353789649418
lambda[   7] =   2.91208428811728
lambda[   8] =   2.93135423148027
lambda[   9] =   2.94325608874475
lambda[  10] =   2.99508021899942
lambda[  11] =   2.99973120003391
lambda[  12] =   3.03178821256083
lambda[  13] =   3.07060632724896
lambda[  14] =   3.08685164172973
lambda[  15] =   3.11479889999884
lambda[  16] =   3.12530924182362
lambda[  17] =   3.14080344548345
lambda[  18] =   3.16442338165912
lambda[  19] =   3.17219892885568
lambda[  20] =   3.22684874309719
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.828 ms
rank =  0, subspace rotation using ScaLAPACK took 3.827 ms
rank =  0, Distributing orbital back into band + domain format took 19.682 ms
rank = 0, Subspace_Rotation used 23.525 ms

Total time for subspace rotation: 23.530 ms
rank = 0, Efermi =   3.078728984782 calculate fermi energy took 0.058 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.326849, lowerbound = -0.991919, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1708.392 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 17.767 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.136 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.933 ms
rank =  0, finding HY took 30.132 ms
rank =  0, distributing HY into block cyclic form took 17.773 ms
rank =  0, finding Y'*HY took 5.385 ms
Rank 0, Project_Hamiltonian used 75.265 ms
Total time for projection: 75.269 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.713804539493838
    last  calculated eigval = 0.438738337142719
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.27235314336269
lambda[   5] =  -0.26069593656324
lambda[   6] =  -0.16574320801658
lambda[   7] =  -0.10893947778834
lambda[   8] =  -0.04471709780232
lambda[   9] =   0.01047167663308
lambda[  10] =   0.19448351213016
lambda[  11] =   0.23848088461812
lambda[  12] =   0.25234079722160
lambda[  13] =   0.28024217262629
lambda[  14] =   0.30620557704366
lambda[  15] =   0.32209422766747
lambda[  16] =   0.34103545827386
lambda[  17] =   0.35803381515706
lambda[  18] =   0.39858304763881
lambda[  19] =   0.42546686431054
lambda[  20] =   0.43873833714272
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 3.574 ms
rank =  0, Distributing orbital back into band + domain format took 19.932 ms
rank = 0, Subspace_Rotation used 23.521 ms

Total time for subspace rotation: 23.526 ms
rank = 0, Efermi =   0.293223874745 calculate fermi energy took 0.036 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.538738, lowerbound = -0.991919, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1725.050 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.702 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 21.961 ms
rank =  0, finding HY took 30.614 ms
rank =  0, distributing HY into block cyclic form took 17.761 ms
rank =  0, finding Y'*HY took 5.419 ms
Rank 0, Project_Hamiltonian used 75.808 ms
Total time for projection: 75.820 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.918931682412229
    last  calculated eigval = 0.134360971370651
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64943942966229
lambda[   5] =  -0.58046422265850
lambda[   6] =  -0.52426819190924
lambda[   7] =  -0.50093909620321
lambda[   8] =  -0.48687029689382
lambda[   9] =  -0.44121734713480
lambda[  10] =  -0.37907312264991
lambda[  11] =  -0.36074743760563
lambda[  12] =  -0.30995671515326
lambda[  13] =  -0.22202684430494
lambda[  14] =  -0.08494815882378
lambda[  15] =   0.00954629929349
lambda[  16] =   0.03819306403716
lambda[  17] =   0.07830466996633
lambda[  18] =   0.10531014836568
lambda[  19] =   0.11322734401382
lambda[  20] =   0.13436097137065
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 3.843 ms
rank =  0, Distributing orbital back into band + domain format took 19.584 ms
rank = 0, Subspace_Rotation used 23.443 ms

Total time for subspace rotation: 23.448 ms
rank = 0, Efermi =  -0.113859081588 calculate fermi energy took 0.038 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.234361, lowerbound = -0.991919, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1727.119 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.702 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.042 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 21.774 ms
rank =  0, finding HY took 30.153 ms
rank =  0, distributing HY into block cyclic form took 17.802 ms
rank =  0, finding Y'*HY took 5.421 ms
Rank 0, Project_Hamiltonian used 75.187 ms
Total time for projection: 75.192 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.919312118388249
    last  calculated eigval = 0.091856770155229
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65216920867656
lambda[   5] =  -0.58423077842254
lambda[   6] =  -0.53114179663703
lambda[   7] =  -0.51554643014871
lambda[   8] =  -0.49248188778054
lambda[   9] =  -0.44967781510183
lambda[  10] =  -0.39899401311232
lambda[  11] =  -0.39261873174210
lambda[  12] =  -0.35732330502593
lambda[  13] =  -0.32368192465271
lambda[  14] =  -0.14776076845029
lambda[  15] =  -0.05873125667481
lambda[  16] =  -0.01031960796378
lambda[  17] =   0.02641768203852
lambda[  18] =   0.04801139525138
lambda[  19] =   0.05598493458727
lambda[  20] =   0.09185677015523
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.183 ms
rank =  0, subspace rotation using ScaLAPACK took 4.158 ms
rank =  0, Distributing orbital back into band + domain format took 19.268 ms
rank = 0, Subspace_Rotation used 23.445 ms

Total time for subspace rotation: 23.450 ms
rank = 0, Efermi =  -0.176671691208 calculate fermi energy took 0.029 ms
rank = 0, --- Calculate rho: sum over local bands took 4.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.483 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.268 ms
rank = 0, Calculating density took 7412.218 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.711 ms
rank = 0, D2D took 1.006 ms
rank = 0, Transfering density took 1.016 ms
Etot    =   -37.556861432831
Eband   =   -14.549311981974
E1      =    29.825468305890
E2      =   -11.009606373951
E3      =   -14.052223895029
Exc     =   -12.654674193795
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 3.756e+00, dEband = 1.455e+00
rank = 0, Calculating/Estimating energy took 1.675 ms, Etot = -37.556861433, dEtot = 3.756e+00, dEband = 1.455e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 48.3081525782711, which took 0.123 ms

iter_count = 96, r_2norm = 1.757e-03, tol*||rhs|| = 1.932e-03

Anderson update took 52.752 ms, out of which F'*F took 24.320 ms; b-Ax took 163.471 ms, out of which Lap took 147.437 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 354.024 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653987, int_b + int_rho = -1.201e-13, checking this took 0.118 ms
2-norm of RHS = 742.2091927737384, which took 0.124 ms

iter_count = 288, r_2norm = 6.264e-04, tol*||rhs|| = 7.422e-04

Anderson update took 157.044 ms, out of which F'*F took 72.962 ms; b-Ax took 489.861 ms, out of which Lap took 440.901 ms
Solving Poisson took 1043.292 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.860 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.192085 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.167900 
Total time for convolution: 	 convolve: 5.095560 
Total time for convolution: 	 convolve: 5.112477 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.256 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.433 ms
---Transfer Veff_loc: D2D took 1.304 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.666 ms

This SCF took 33349.946 ms, scf error = 1.989e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.191857, lowerbound = -0.919312, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1743.206 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.838 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.057 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 21.931 ms
rank =  0, finding HY took 30.135 ms
rank =  0, distributing HY into block cyclic form took 18.188 ms
rank =  0, finding Y'*HY took 6.081 ms
Rank 0, Project_Hamiltonian used 76.384 ms
Total time for projection: 76.398 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -0.885673932729251
    last  calculated eigval = 0.067878583854780
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62642151164592
lambda[   5] =  -0.55807550016679
lambda[   6] =  -0.49739003671065
lambda[   7] =  -0.47822085897751
lambda[   8] =  -0.45628684016420
lambda[   9] =  -0.42053353660515
lambda[  10] =  -0.37507523288355
lambda[  11] =  -0.36696854483449
lambda[  12] =  -0.33692667258792
lambda[  13] =  -0.29996560625698
lambda[  14] =  -0.13230343052540
lambda[  15] =  -0.05230118207262
lambda[  16] =  -0.02169643823361
lambda[  17] =   0.01487991328028
lambda[  18] =   0.02150554415548
lambda[  19] =   0.04119367444089
lambda[  20] =   0.06787858385478
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 3.537 ms
rank =  0, subspace rotation using ScaLAPACK took 4.328 ms
rank =  0, Distributing orbital back into band + domain format took 20.473 ms
rank = 0, Subspace_Rotation used 24.823 ms

Total time for subspace rotation: 24.828 ms
rank = 0, Efermi =  -0.161214353279 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.627 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.453 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.230 ms
rank = 0, Calculating density took 1856.432 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.875 ms
rank = 0, D2D took 1.021 ms
rank = 0, Transfering density took 1.026 ms
Etot    =   -37.481178383222
Eband   =   -13.775402611922
E1      =    29.136305889876
E2      =   -10.963533945114
E3      =   -14.253349805382
Exc     =   -12.818791579741
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 7.568e-03, dEband = 7.739e-02
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -37.481178383, dEtot = 7.568e-03, dEband = 7.739e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.8912210696441, which took 0.062 ms

iter_count = 102, r_2norm = 6.787e-04, tol*||rhs|| = 8.356e-04

Anderson update took 55.734 ms, out of which F'*F took 26.112 ms; b-Ax took 174.600 ms, out of which Lap took 156.805 ms
rank = 0, Mixing (+ precond) took 379.950 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653990, int_b + int_rho = -8.731e-14, checking this took 0.096 ms
2-norm of RHS = 736.3443391766248, which took 0.130 ms

iter_count = 300, r_2norm = 7.214e-04, tol*||rhs|| = 7.363e-04

Anderson update took 163.140 ms, out of which F'*F took 74.525 ms; b-Ax took 506.988 ms, out of which Lap took 453.004 ms
Solving Poisson took 1079.710 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.088615 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.094811 
Total time for convolution: 	 convolve: 5.113323 
Total time for convolution: 	 convolve: 5.110956 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.538 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.413 ms
---Transfer Veff_loc: D2D took 1.277 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.359 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.660 ms

This SCF took 27729.931 ms, scf error = 1.372e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.167879, lowerbound = -0.885674, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1724.129 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 27.593 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.370 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 31.994 ms
rank =  0, finding HY took 30.702 ms
rank =  0, distributing HY into block cyclic form took 19.113 ms
rank =  0, finding Y'*HY took 5.840 ms
Rank 0, Project_Hamiltonian used 87.687 ms
Total time for projection: 87.702 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.836815907524687
    last  calculated eigval = 0.049513694473560
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57572538715181
lambda[   5] =  -0.50986846394780
lambda[   6] =  -0.44053229916396
lambda[   7] =  -0.41749982426593
lambda[   8] =  -0.39417536592795
lambda[   9] =  -0.36684114196475
lambda[  10] =  -0.34402619370417
lambda[  11] =  -0.32668707687982
lambda[  12] =  -0.30601939176895
lambda[  13] =  -0.26063084794042
lambda[  14] =  -0.09715563901510
lambda[  15] =  -0.03047126481833
lambda[  16] =  -0.02253726684387
lambda[  17] =   0.01353075929698
lambda[  18] =   0.01792435764304
lambda[  19] =   0.03787060773791
lambda[  20] =   0.04951369447356
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.863 ms
rank =  0, Distributing orbital back into band + domain format took 17.293 ms
rank = 0, Subspace_Rotation used 25.190 ms

Total time for subspace rotation: 25.196 ms
rank = 0, Efermi =  -0.126066561756 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.671 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.487 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.216 ms
rank = 0, Calculating density took 1846.179 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.685 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.828 ms
Etot    =   -37.417357773096
Eband   =   -12.490909423499
E1      =    28.036746651259
E2      =   -10.772114389834
E3      =   -14.628729379730
Exc     =   -13.123864938489
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 6.382e-03, dEband = 1.284e-01
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -37.417357773, dEtot = 6.382e-03, dEband = 1.284e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.1617588452143, which took 0.060 ms

iter_count = 102, r_2norm = 2.786e-04, tol*||rhs|| = 2.865e-04

Anderson update took 56.029 ms, out of which F'*F took 25.758 ms; b-Ax took 172.867 ms, out of which Lap took 155.666 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 383.190 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653992, int_b + int_rho = -7.640e-14, checking this took 0.112 ms
2-norm of RHS = 735.8946419586740, which took 0.141 ms

iter_count = 270, r_2norm = 7.123e-04, tol*||rhs|| = 7.359e-04

Anderson update took 147.060 ms, out of which F'*F took 67.925 ms; b-Ax took 457.399 ms, out of which Lap took 409.920 ms
Solving Poisson took 972.768 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.096858 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.130132 
Total time for convolution: 	 convolve: 5.105114 
Total time for convolution: 	 convolve: 5.130628 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.428 ms
---Transfer Veff_loc: D2D took 1.287 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.362 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.671 ms

This SCF took 27900.981 ms, scf error = 4.654e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.149514, lowerbound = -0.836816, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1696.377 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.879 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.089 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.997 ms
rank =  0, finding HY took 28.947 ms
rank =  0, distributing HY into block cyclic form took 17.967 ms
rank =  0, finding Y'*HY took 5.594 ms
Rank 0, Project_Hamiltonian used 74.548 ms
Total time for projection: 74.561 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.590 ms
rank = 0, Solve_Generalized_EigenProblem used 1.813 ms
    first calculated eigval = -0.825169552305154
    last  calculated eigval = 0.036357751918195
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56119026958686
lambda[   5] =  -0.49557394633620
lambda[   6] =  -0.42588535066661
lambda[   7] =  -0.40274559642465
lambda[   8] =  -0.37921427009562
lambda[   9] =  -0.35230088352151
lambda[  10] =  -0.33465925080047
lambda[  11] =  -0.31788234355535
lambda[  12] =  -0.29790848787472
lambda[  13] =  -0.25103698600983
lambda[  14] =  -0.08815392209002
lambda[  15] =  -0.02958450283789
lambda[  16] =  -0.02034844086083
lambda[  17] =   0.01116754322815
lambda[  18] =   0.01531786372002
lambda[  19] =   0.03260987952530
lambda[  20] =   0.03635775191819
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.832 ms
rank =  0, subspace rotation using ScaLAPACK took 7.111 ms
rank =  0, Distributing orbital back into band + domain format took 17.734 ms
rank = 0, Subspace_Rotation used 24.863 ms

Total time for subspace rotation: 24.869 ms
rank = 0, Efermi =  -0.117064844837 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.471 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.911 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.420 ms
rank = 0, Calculating density took 1806.578 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.912 ms
rank = 0, D2D took 1.071 ms
rank = 0, Transfering density took 1.081 ms
Etot    =   -37.411300470687
Eband   =   -12.162125977145
E1      =    27.800618984653
E2      =   -10.661965228525
E3      =   -14.737002358612
Exc     =   -13.208587233400
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 6.057e-04, dEband = 3.288e-02
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -37.411300471, dEtot = 6.057e-04, dEband = 3.288e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.2214692448120, which took 0.121 ms

iter_count = 108, r_2norm = 8.566e-05, tol*||rhs|| = 8.886e-05

Anderson update took 58.690 ms, out of which F'*F took 27.184 ms; b-Ax took 182.266 ms, out of which Lap took 163.637 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.769 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653988, int_b + int_rho = -1.091e-13, checking this took 0.115 ms
2-norm of RHS = 736.4784730489464, which took 0.139 ms

iter_count = 258, r_2norm = 7.289e-04, tol*||rhs|| = 7.365e-04

Anderson update took 140.013 ms, out of which F'*F took 64.527 ms; b-Ax took 438.251 ms, out of which Lap took 392.350 ms
Solving Poisson took 931.904 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.096832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.172 ms
Total time for convolution: 	 convolve: 5.137694 
Total time for convolution: 	 convolve: 5.096755 
Total time for convolution: 	 convolve: 5.190348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.185 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.289 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.134 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.450 ms

This SCF took 27871.112 ms, scf error = 2.129e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.136358, lowerbound = -0.825170, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1713.554 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.869 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.084 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.989 ms
rank =  0, finding HY took 28.776 ms
rank =  0, distributing HY into block cyclic form took 18.073 ms
rank =  0, finding Y'*HY took 5.594 ms
Rank 0, Project_Hamiltonian used 74.954 ms
Total time for projection: 74.968 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.818758544266577
    last  calculated eigval = 0.030990685299053
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55455972869175
lambda[   5] =  -0.48885468059737
lambda[   6] =  -0.41931706392449
lambda[   7] =  -0.39522929302171
lambda[   8] =  -0.37210064554378
lambda[   9] =  -0.34477312576784
lambda[  10] =  -0.32938158134359
lambda[  11] =  -0.31036999061347
lambda[  12] =  -0.29235318654631
lambda[  13] =  -0.24587860992889
lambda[  14] =  -0.08339359842097
lambda[  15] =  -0.03052686179456
lambda[  16] =  -0.01567510692073
lambda[  17] =   0.01013823813448
lambda[  18] =   0.01340336724111
lambda[  19] =   0.02922528062756
lambda[  20] =   0.03099068529905
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.051 ms
rank =  0, Distributing orbital back into band + domain format took 17.578 ms
rank = 0, Subspace_Rotation used 24.650 ms

Total time for subspace rotation: 24.654 ms
rank = 0, Efermi =  -0.112304521206 calculate fermi energy took 2.566 ms
rank = 0, --- Calculate rho: sum over local bands took 4.572 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.163 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.241 ms
rank = 0, Calculating density took 1823.015 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.855 ms
rank = 0, D2D took 0.991 ms
rank = 0, Transfering density took 0.997 ms
Etot    =   -37.409083563378
Eband   =   -11.992931422581
E1      =    27.717887207383
E2      =   -10.562411664910
E3      =   -14.792781790054
Exc     =   -13.249058971213
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 2.217e-04, dEband = 1.692e-02
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -37.409083563, dEtot = 2.217e-04, dEband = 1.692e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2626992792480, which took 0.056 ms

iter_count = 108, r_2norm = 4.469e-05, tol*||rhs|| = 5.051e-05

Anderson update took 58.194 ms, out of which F'*F took 27.334 ms; b-Ax took 184.357 ms, out of which Lap took 165.889 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.871 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653975, int_b + int_rho = -2.401e-13, checking this took 0.157 ms
2-norm of RHS = 736.8032348249001, which took 0.137 ms

iter_count = 228, r_2norm = 7.137e-04, tol*||rhs|| = 7.368e-04

Anderson update took 122.117 ms, out of which F'*F took 57.123 ms; b-Ax took 385.356 ms, out of which Lap took 345.057 ms
Solving Poisson took 818.583 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.177 ms
Total time for convolution: 	 convolve: 5.101100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.099812 
Total time for convolution: 	 convolve: 5.089499 
Total time for convolution: 	 convolve: 5.087690 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.602 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 1.494 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.723 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.250 ms

This SCF took 27483.284 ms, scf error = 6.725e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.130991, lowerbound = -0.818759, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1696.354 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.818 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.095 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.940 ms
rank =  0, finding HY took 28.983 ms
rank =  0, distributing HY into block cyclic form took 17.946 ms
rank =  0, finding Y'*HY took 5.612 ms
Rank 0, Project_Hamiltonian used 74.529 ms
Total time for projection: 74.545 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.199 ms
    first calculated eigval = -0.817465445252940
    last  calculated eigval = 0.029166373605537
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55273787085147
lambda[   5] =  -0.48735715398613
lambda[   6] =  -0.41746169631266
lambda[   7] =  -0.39240416358329
lambda[   8] =  -0.36946880320977
lambda[   9] =  -0.34245246590573
lambda[  10] =  -0.32799328868528
lambda[  11] =  -0.30824466231214
lambda[  12] =  -0.29086185556960
lambda[  13] =  -0.24429864637793
lambda[  14] =  -0.08183694635229
lambda[  15] =  -0.03125362538271
lambda[  16] =  -0.01428073411023
lambda[  17] =   0.00886817554933
lambda[  18] =   0.01249561004860
lambda[  19] =   0.02477438432997
lambda[  20] =   0.02916637360554
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 7.063 ms
rank =  0, Distributing orbital back into band + domain format took 17.742 ms
rank = 0, Subspace_Rotation used 24.823 ms

Total time for subspace rotation: 24.828 ms
rank = 0, Efermi =  -0.110747869134 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.488 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.357 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.270 ms
rank = 0, Calculating density took 1804.620 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.827 ms
rank = 0, D2D took 0.984 ms
rank = 0, Transfering density took 0.992 ms
Etot    =   -37.408677239036
Eband   =   -11.942918129574
E1      =    27.700349815274
E2      =   -10.527137709233
E3      =   -14.801660836784
Exc     =   -13.254733638821
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 4.063e-05, dEband = 5.001e-03
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -37.408677239, dEtot = 4.063e-05, dEband = 5.001e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5129385415973, which took 0.057 ms

iter_count = 114, r_2norm = 1.396e-05, tol*||rhs|| = 2.052e-05

Anderson update took 60.410 ms, out of which F'*F took 27.968 ms; b-Ax took 190.828 ms, out of which Lap took 170.802 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.527 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653984, int_b + int_rho = -1.528e-13, checking this took 0.115 ms
2-norm of RHS = 737.1460955097557, which took 0.118 ms

iter_count = 240, r_2norm = 6.792e-04, tol*||rhs|| = 7.371e-04

Anderson update took 128.014 ms, out of which F'*F took 60.343 ms; b-Ax took 407.910 ms, out of which Lap took 365.848 ms
Solving Poisson took 865.421 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.088050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.096421 
Total time for convolution: 	 convolve: 5.109939 
Total time for convolution: 	 convolve: 5.089995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.723 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.493 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.767 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.180 ms

This SCF took 27486.804 ms, scf error = 4.525e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129166, lowerbound = -0.817465, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1697.479 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.845 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.086 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.959 ms
rank =  0, finding HY took 29.099 ms
rank =  0, distributing HY into block cyclic form took 17.915 ms
rank =  0, finding Y'*HY took 5.581 ms
Rank 0, Project_Hamiltonian used 74.590 ms
Total time for projection: 74.604 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.814777768749717
    last  calculated eigval = 0.029210946336985
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54916580101747
lambda[   5] =  -0.48426470091099
lambda[   6] =  -0.41388506305470
lambda[   7] =  -0.38769866849339
lambda[   8] =  -0.36491308211386
lambda[   9] =  -0.33844895541023
lambda[  10] =  -0.32523443945459
lambda[  11] =  -0.30490979864585
lambda[  12] =  -0.28820540280365
lambda[  13] =  -0.24135588654306
lambda[  14] =  -0.07899810196356
lambda[  15] =  -0.03057797002626
lambda[  16] =  -0.01163588326262
lambda[  17] =   0.00860574507087
lambda[  18] =   0.01344087276874
lambda[  19] =   0.02310606809401
lambda[  20] =   0.02921094633698
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 7.089 ms
rank =  0, Distributing orbital back into band + domain format took 17.512 ms
rank = 0, Subspace_Rotation used 24.621 ms

Total time for subspace rotation: 24.626 ms
rank = 0, Efermi =  -0.107909024752 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 4.465 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.285 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.310 ms
rank = 0, Calculating density took 1805.115 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.831 ms
rank = 0, D2D took 0.966 ms
rank = 0, Transfering density took 0.970 ms
Etot    =   -37.408221635701
Eband   =   -11.851241571641
E1      =    27.657964679771
E2      =   -10.473113026622
E3      =   -14.818502328793
Exc     =   -13.266386267314
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 4.556e-05, dEband = 9.168e-03
rank = 0, Calculating/Estimating energy took 1.130 ms, Etot = -37.408221636, dEtot = 4.556e-05, dEband = 9.168e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2569884814688, which took 0.053 ms

iter_count = 114, r_2norm = 7.646e-06, tol*||rhs|| = 1.028e-05

Anderson update took 60.640 ms, out of which F'*F took 28.331 ms; b-Ax took 192.779 ms, out of which Lap took 172.393 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.488 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653995, int_b + int_rho = -4.002e-14, checking this took 0.077 ms
2-norm of RHS = 737.2175179648515, which took 0.096 ms

iter_count = 228, r_2norm = 6.545e-04, tol*||rhs|| = 7.372e-04

Anderson update took 121.118 ms, out of which F'*F took 57.071 ms; b-Ax took 386.927 ms, out of which Lap took 347.218 ms
Solving Poisson took 818.660 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.135881 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.245 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.138794 
Total time for convolution: 	 convolve: 5.100421 
Total time for convolution: 	 convolve: 5.091076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.550 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
---Transfer Veff_loc: D2D took 1.501 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.721 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.255 ms

This SCF took 27861.470 ms, scf error = 2.438e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129211, lowerbound = -0.814778, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1719.778 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.888 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.027 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 21.947 ms
rank =  0, finding HY took 29.205 ms
rank =  0, distributing HY into block cyclic form took 17.976 ms
rank =  0, finding Y'*HY took 5.905 ms
Rank 0, Project_Hamiltonian used 75.089 ms
Total time for projection: 75.104 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.812216542703297
    last  calculated eigval = 0.028478606241705
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54674583859792
lambda[   5] =  -0.48203050463450
lambda[   6] =  -0.41151343868888
lambda[   7] =  -0.38499637020446
lambda[   8] =  -0.36220182152635
lambda[   9] =  -0.33608751650936
lambda[  10] =  -0.32290977692403
lambda[  11] =  -0.30222103164258
lambda[  12] =  -0.28590176473123
lambda[  13] =  -0.23903625876704
lambda[  14] =  -0.07686934511146
lambda[  15] =  -0.02951344499302
lambda[  16] =  -0.00951388228366
lambda[  17] =   0.00927903510363
lambda[  18] =   0.01516915992821
lambda[  19] =   0.02300439405070
lambda[  20] =   0.02847860624171
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 7.076 ms
rank =  0, Distributing orbital back into band + domain format took 17.563 ms
rank = 0, Subspace_Rotation used 24.657 ms

Total time for subspace rotation: 24.662 ms
rank = 0, Efermi =  -0.105780267902 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.446 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.401 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.294 ms
rank = 0, Calculating density took 1828.072 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.851 ms
rank = 0, D2D took 0.985 ms
rank = 0, Transfering density took 0.993 ms
Etot    =   -37.408112609343
Eband   =   -11.786727528738
E1      =    27.624604337944
E2      =   -10.439578665991
E3      =   -14.827323789729
Exc     =   -13.272718042337
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 1.090e-05, dEband = 6.451e-03
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -37.408112609, dEtot = 1.090e-05, dEband = 6.451e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1734619002009, which took 0.073 ms

iter_count = 114, r_2norm = 5.307e-06, tol*||rhs|| = 6.938e-06

Anderson update took 60.006 ms, out of which F'*F took 28.146 ms; b-Ax took 192.660 ms, out of which Lap took 172.259 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.002 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653972, int_b + int_rho = -2.765e-13, checking this took 0.114 ms
2-norm of RHS = 737.2200082278770, which took 0.074 ms

iter_count = 210, r_2norm = 6.685e-04, tol*||rhs|| = 7.372e-04

Anderson update took 111.467 ms, out of which F'*F took 52.460 ms; b-Ax took 365.614 ms, out of which Lap took 328.050 ms
Solving Poisson took 763.051 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.105634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.102998 
Total time for convolution: 	 convolve: 5.094277 
Total time for convolution: 	 convolve: 5.096651 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.456 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.698 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.185 ms

This SCF took 27426.601 ms, scf error = 1.419e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128479, lowerbound = -0.812217, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1757.280 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.860 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.146 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.044 ms
rank =  0, finding HY took 29.022 ms
rank =  0, distributing HY into block cyclic form took 18.036 ms
rank =  0, finding Y'*HY took 5.530 ms
Rank 0, Project_Hamiltonian used 74.677 ms
Total time for projection: 74.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.810805523387809
    last  calculated eigval = 0.028169412322775
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54548436217949
lambda[   5] =  -0.48086723626224
lambda[   6] =  -0.41031973122182
lambda[   7] =  -0.38359492522294
lambda[   8] =  -0.36083762810085
lambda[   9] =  -0.33479968009757
lambda[  10] =  -0.32163417938179
lambda[  11] =  -0.30079736557327
lambda[  12] =  -0.28457784653372
lambda[  13] =  -0.23778213180248
lambda[  14] =  -0.07562705322055
lambda[  15] =  -0.02789839199390
lambda[  16] =  -0.00814579934888
lambda[  17] =   0.01094614028388
lambda[  18] =   0.01699523087527
lambda[  19] =   0.02414506982755
lambda[  20] =   0.02816941232278
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 7.071 ms
rank =  0, Distributing orbital back into band + domain format took 17.561 ms
rank = 0, Subspace_Rotation used 24.653 ms

Total time for subspace rotation: 24.659 ms
rank = 0, Efermi =  -0.104537975980 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 4.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.371 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.298 ms
rank = 0, Calculating density took 1865.096 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.838 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.074 ms
Etot    =   -37.408129267799
Eband   =   -11.752862103029
E1      =    27.608337094380
E2      =   -10.421207341345
E3      =   -14.830128656008
Exc     =   -13.274766424570
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 1.666e-06, dEband = 3.387e-03
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -37.408129268, dEtot = 1.666e-06, dEband = 3.387e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1358229878076, which took 0.051 ms

iter_count = 114, r_2norm = 3.801e-06, tol*||rhs|| = 5.433e-06

Anderson update took 68.715 ms, out of which F'*F took 29.193 ms; b-Ax took 208.213 ms, out of which Lap took 189.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 442.971 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653983, int_b + int_rho = -1.673e-13, checking this took 0.153 ms
2-norm of RHS = 737.1941048924364, which took 0.166 ms

iter_count = 198, r_2norm = 6.815e-04, tol*||rhs|| = 7.372e-04

Anderson update took 107.868 ms, out of which F'*F took 49.687 ms; b-Ax took 336.030 ms, out of which Lap took 302.029 ms
Solving Poisson took 713.499 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.103070 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.099541 
Total time for convolution: 	 convolve: 5.107557 
Total time for convolution: 	 convolve: 5.093492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.757 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.460 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.697 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.187 ms

This SCF took 27425.631 ms, scf error = 9.382e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.128169, lowerbound = -0.810806, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1705.262 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.809 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.095 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.941 ms
rank =  0, finding HY took 29.046 ms
rank =  0, distributing HY into block cyclic form took 18.090 ms
rank =  0, finding Y'*HY took 5.456 ms
Rank 0, Project_Hamiltonian used 74.572 ms
Total time for projection: 74.587 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.809743516419897
    last  calculated eigval = 0.028234439487782
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54444977264184
lambda[   5] =  -0.47991041099151
lambda[   6] =  -0.40929481457811
lambda[   7] =  -0.38241528050666
lambda[   8] =  -0.35967344395440
lambda[   9] =  -0.33373401155993
lambda[  10] =  -0.32066820662447
lambda[  11] =  -0.29971517433281
lambda[  12] =  -0.28359850223011
lambda[  13] =  -0.23679899572176
lambda[  14] =  -0.07467108492339
lambda[  15] =  -0.02616960664445
lambda[  16] =  -0.00716417627445
lambda[  17] =   0.01286168821100
lambda[  18] =   0.01856601872880
lambda[  19] =   0.02553495655600
lambda[  20] =   0.02823443948778
==subpsace eigenproblem: bcast eigvals took 0.096 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 7.097 ms
rank =  0, Distributing orbital back into band + domain format took 17.658 ms
rank = 0, Subspace_Rotation used 24.780 ms

Total time for subspace rotation: 24.785 ms
rank = 0, Efermi =  -0.103582007692 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.489 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.211 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.906 ms
rank = 0, Calculating density took 1814.135 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.736 ms
rank = 0, D2D took 0.848 ms
rank = 0, Transfering density took 0.855 ms
Etot    =   -37.408191910772
Eband   =   -11.725444191941
E1      =    27.593019806866
E2      =   -10.408438917722
E3      =   -14.833117811478
Exc     =   -13.277150422966
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 6.264e-06, dEband = 2.742e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -37.408191911, dEtot = 6.264e-06, dEband = 2.742e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0902469348284, which took 0.052 ms

iter_count = 114, r_2norm = 2.434e-06, tol*||rhs|| = 3.610e-06

Anderson update took 60.237 ms, out of which F'*F took 28.164 ms; b-Ax took 191.143 ms, out of which Lap took 170.864 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.638 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653990, int_b + int_rho = -8.731e-14, checking this took 0.106 ms
2-norm of RHS = 737.1957319109490, which took 0.093 ms

iter_count = 192, r_2norm = 6.864e-04, tol*||rhs|| = 7.372e-04

Anderson update took 101.936 ms, out of which F'*F took 47.954 ms; b-Ax took 326.159 ms, out of which Lap took 291.790 ms
Solving Poisson took 689.837 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.091908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.102386 
Total time for convolution: 	 convolve: 5.099530 
Total time for convolution: 	 convolve: 5.093647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.643 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.440 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.760 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.231 ms

This SCF took 27305.669 ms, scf error = 6.753e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.128234, lowerbound = -0.809744, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1706.672 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 17.722 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.127 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.879 ms
rank =  0, finding HY took 29.036 ms
rank =  0, distributing HY into block cyclic form took 18.015 ms
rank =  0, finding Y'*HY took 5.549 ms
Rank 0, Project_Hamiltonian used 74.523 ms
Total time for projection: 74.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.809082681990503
    last  calculated eigval = 0.029475208124119
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54373015007118
lambda[   5] =  -0.47921659127527
lambda[   6] =  -0.40859042756142
lambda[   7] =  -0.38162349869552
lambda[   8] =  -0.35890814541972
lambda[   9] =  -0.33298281908523
lambda[  10] =  -0.31996332038866
lambda[  11] =  -0.29902096004376
lambda[  12] =  -0.28290432334494
lambda[  13] =  -0.23611190089896
lambda[  14] =  -0.07396125018623
lambda[  15] =  -0.02384200005034
lambda[  16] =  -0.00637344843838
lambda[  17] =   0.01554447179078
lambda[  18] =   0.02026393120879
lambda[  19] =   0.02778251316801
lambda[  20] =   0.02947520812412
==subpsace eigenproblem: bcast eigvals took 0.081 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 7.026 ms
rank =  0, Distributing orbital back into band + domain format took 17.211 ms
rank = 0, Subspace_Rotation used 24.268 ms

Total time for subspace rotation: 24.274 ms
rank = 0, Efermi =  -0.102872172937 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 4.266 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.572 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.240 ms
rank = 0, Calculating density took 1813.976 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
rank = 0, D2D took 1.553 ms
rank = 0, Transfering density took 1.565 ms
Etot    =   -37.408269795570
Eband   =   -11.706803279424
E1      =    27.584455092969
E2      =   -10.398126823183
E3      =   -14.834021405181
Exc     =   -13.277896005547
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 7.788e-06, dEband = 1.864e-03
rank = 0, Calculating/Estimating energy took 1.309 ms, Etot = -37.408269796, dEtot = 7.788e-06, dEband = 1.864e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0695126455409, which took 0.051 ms

iter_count = 114, r_2norm = 1.949e-06, tol*||rhs|| = 2.781e-06

Anderson update took 60.416 ms, out of which F'*F took 29.236 ms; b-Ax took 192.923 ms, out of which Lap took 172.544 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.906 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653988, int_b + int_rho = -1.164e-13, checking this took 0.099 ms
2-norm of RHS = 737.2006979747769, which took 0.106 ms

iter_count = 162, r_2norm = 6.533e-04, tol*||rhs|| = 7.372e-04

Anderson update took 85.994 ms, out of which F'*F took 40.490 ms; b-Ax took 275.369 ms, out of which Lap took 247.032 ms
Solving Poisson took 582.338 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.098105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.103314 
Total time for convolution: 	 convolve: 5.104283 
Total time for convolution: 	 convolve: 5.109108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.454 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.674 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.159 ms

This SCF took 27223.342 ms, scf error = 4.366e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.129475, lowerbound = -0.809083, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1697.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.824 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.136 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 21.986 ms
rank =  0, finding HY took 29.007 ms
rank =  0, distributing HY into block cyclic form took 18.830 ms
rank =  0, finding Y'*HY took 4.656 ms
Rank 0, Project_Hamiltonian used 74.529 ms
Total time for projection: 74.545 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.808790048676265
    last  calculated eigval = 0.030002439961322
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54340566288002
lambda[   5] =  -0.47889032480142
lambda[   6] =  -0.40826950260848
lambda[   7] =  -0.38131838037612
lambda[   8] =  -0.35859433751270
lambda[   9] =  -0.33266907349830
lambda[  10] =  -0.31965375229204
lambda[  11] =  -0.29873674556157
lambda[  12] =  -0.28260556170039
lambda[  13] =  -0.23580018477857
lambda[  14] =  -0.07364796546841
lambda[  15] =  -0.02301151056309
lambda[  16] =  -0.00610796135138
lambda[  17] =   0.01631985080175
lambda[  18] =   0.02057661335525
lambda[  19] =   0.02838158192096
lambda[  20] =   0.03000243996132
==subpsace eigenproblem: bcast eigvals took 0.077 ms
Total time for solving subspace eigenvalue problem: 0.296 ms
rank =  0, subspace rotation using ScaLAPACK took 7.148 ms
rank =  0, Distributing orbital back into band + domain format took 18.133 ms
rank = 0, Subspace_Rotation used 25.308 ms

Total time for subspace rotation: 25.313 ms
rank = 0, Efermi =  -0.102558888216 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.436 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.523 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.258 ms
rank = 0, Calculating density took 1805.579 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.810 ms
rank = 0, D2D took 0.919 ms
rank = 0, Transfering density took 0.928 ms
Etot    =   -37.408323659009
Eband   =   -11.698692895829
E1      =    27.580511585758
E2      =   -10.393796144315
E3      =   -14.834578062465
Exc     =   -13.278342723787
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 5.386e-06, dEband = 8.110e-04
rank = 0, Calculating/Estimating energy took 0.930 ms, Etot = -37.408323659, dEtot = 5.386e-06, dEband = 8.110e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0405936385969, which took 0.056 ms

iter_count = 108, r_2norm = 1.548e-06, tol*||rhs|| = 1.624e-06

Anderson update took 57.077 ms, out of which F'*F took 26.583 ms; b-Ax took 181.570 ms, out of which Lap took 162.205 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.371 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653992, int_b + int_rho = -6.912e-14, checking this took 0.100 ms
2-norm of RHS = 737.2179659416391, which took 0.115 ms

iter_count = 180, r_2norm = 7.302e-04, tol*||rhs|| = 7.372e-04

Anderson update took 95.715 ms, out of which F'*F took 44.932 ms; b-Ax took 305.168 ms, out of which Lap took 272.955 ms
Solving Poisson took 646.631 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.096072 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.094704 
Total time for convolution: 	 convolve: 5.097246 
Total time for convolution: 	 convolve: 5.096809 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.250 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.430 ms
---Transfer Veff_loc: D2D took 1.446 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.705 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.180 ms

This SCF took 27216.472 ms, scf error = 3.555e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.130002, lowerbound = -0.808790, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1702.681 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.841 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.132 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.010 ms
rank =  0, finding HY took 28.996 ms
rank =  0, distributing HY into block cyclic form took 17.970 ms
rank =  0, finding Y'*HY took 5.577 ms
Rank 0, Project_Hamiltonian used 74.592 ms
Total time for projection: 74.605 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.808147296683060
    last  calculated eigval = 0.033267279774632
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54273098807376
lambda[   5] =  -0.47819852381201
lambda[   6] =  -0.40759866742874
lambda[   7] =  -0.38073584504571
lambda[   8] =  -0.35797272927084
lambda[   9] =  -0.33203739756496
lambda[  10] =  -0.31900005846544
lambda[  11] =  -0.29812826025466
lambda[  12] =  -0.28196679403030
lambda[  13] =  -0.23513130159414
lambda[  14] =  -0.07297424811509
lambda[  15] =  -0.02047886332034
lambda[  16] =  -0.00542920914326
lambda[  17] =   0.01829903279467
lambda[  18] =   0.02255312904880
lambda[  19] =   0.03087957026656
lambda[  20] =   0.03326727977463
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.123 ms
rank =  0, Distributing orbital back into band + domain format took 17.427 ms
rank = 0, Subspace_Rotation used 24.573 ms

Total time for subspace rotation: 24.578 ms
rank = 0, Efermi =  -0.101885170852 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 4.385 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.440 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.285 ms
rank = 0, Calculating density took 1810.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.828 ms
rank = 0, D2D took 0.971 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -37.408419645554
Eband   =   -11.681816788036
E1      =    27.572237040377
E2      =   -10.384837381790
E3      =   -14.835822628752
Exc     =   -13.279326076506
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 9.599e-06, dEband = 1.688e-03
rank = 0, Calculating/Estimating energy took 1.096 ms, Etot = -37.408419646, dEtot = 9.599e-06, dEband = 1.688e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0366823450980, which took 0.053 ms

iter_count = 108, r_2norm = 1.322e-06, tol*||rhs|| = 1.467e-06

Anderson update took 57.570 ms, out of which F'*F took 26.730 ms; b-Ax took 181.904 ms, out of which Lap took 162.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.476 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653991, int_b + int_rho = -8.004e-14, checking this took 0.108 ms
2-norm of RHS = 737.2213292197829, which took 0.108 ms

iter_count = 150, r_2norm = 6.600e-04, tol*||rhs|| = 7.372e-04

Anderson update took 79.488 ms, out of which F'*F took 38.283 ms; b-Ax took 255.487 ms, out of which Lap took 229.149 ms
Solving Poisson took 539.957 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.099118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.292 ms
Total time for convolution: 	 convolve: 5.089758 
Total time for convolution: 	 convolve: 5.091428 
Total time for convolution: 	 convolve: 5.093565 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.604 ms
---Transfer Veff_loc: D2D took 1.502 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.708 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.242 ms

This SCF took 27181.264 ms, scf error = 1.980e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133267, lowerbound = -0.808147, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1704.850 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.836 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.119 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 21.992 ms
rank =  0, finding HY took 29.052 ms
rank =  0, distributing HY into block cyclic form took 18.184 ms
rank =  0, finding Y'*HY took 5.238 ms
Rank 0, Project_Hamiltonian used 75.038 ms
Total time for projection: 75.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.807905252913208
    last  calculated eigval = 0.034936321461770
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54251815451962
lambda[   5] =  -0.47799056644190
lambda[   6] =  -0.40738955281499
lambda[   7] =  -0.38053017642709
lambda[   8] =  -0.35776154679438
lambda[   9] =  -0.33182965671409
lambda[  10] =  -0.31878625770106
lambda[  11] =  -0.29789841143339
lambda[  12] =  -0.28174419253108
lambda[  13] =  -0.23491721928458
lambda[  14] =  -0.07278100142336
lambda[  15] =  -0.01996227636111
lambda[  16] =  -0.00533252402804
lambda[  17] =   0.01823965204875
lambda[  18] =   0.02273114682669
lambda[  19] =   0.03041870241605
lambda[  20] =   0.03493632146177
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.054 ms
rank =  0, Distributing orbital back into band + domain format took 17.598 ms
rank = 0, Subspace_Rotation used 24.673 ms

Total time for subspace rotation: 24.678 ms
rank = 0, Efermi =  -0.101691924175 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 4.484 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.320 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.295 ms
rank = 0, Calculating density took 1813.035 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.828 ms
rank = 0, D2D took 0.982 ms
rank = 0, Transfering density took 0.989 ms
Etot    =   -37.408468368712
Eband   =   -11.676200813888
E1      =    27.569409663727
E2      =   -10.381917120662
E3      =   -14.836203837341
Exc     =   -13.279624344622
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 4.872e-06, dEband = 5.616e-04
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -37.408468369, dEtot = 4.872e-06, dEband = 5.616e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0279785793692, which took 0.049 ms

iter_count = 108, r_2norm = 9.312e-07, tol*||rhs|| = 1.119e-06

Anderson update took 56.883 ms, out of which F'*F took 26.641 ms; b-Ax took 181.665 ms, out of which Lap took 162.455 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.086 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653987, int_b + int_rho = -1.273e-13, checking this took 0.129 ms
2-norm of RHS = 737.2255948667337, which took 0.112 ms

iter_count = 132, r_2norm = 6.212e-04, tol*||rhs|| = 7.372e-04

Anderson update took 70.327 ms, out of which F'*F took 32.811 ms; b-Ax took 224.319 ms, out of which Lap took 200.861 ms
Solving Poisson took 474.893 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.093671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.098168 
Total time for convolution: 	 convolve: 5.096915 
Total time for convolution: 	 convolve: 5.090388 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 1.498 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.714 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.244 ms

This SCF took 27057.125 ms, scf error = 1.331e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134936, lowerbound = -0.807905, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1701.797 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 17.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 21.667 ms
rank =  0, finding HY took 28.980 ms
rank =  0, distributing HY into block cyclic form took 17.903 ms
rank =  0, finding Y'*HY took 5.615 ms
Rank 0, Project_Hamiltonian used 74.206 ms
Total time for projection: 74.216 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.807839095385280
    last  calculated eigval = 0.036280886339543
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54246048107322
lambda[   5] =  -0.47793110555002
lambda[   6] =  -0.40733443995973
lambda[   7] =  -0.38047545414408
lambda[   8] =  -0.35771059458206
lambda[   9] =  -0.33177201279848
lambda[  10] =  -0.31871911919994
lambda[  11] =  -0.29783343473548
lambda[  12] =  -0.28167505543355
lambda[  13] =  -0.23485920179769
lambda[  14] =  -0.07273812563517
lambda[  15] =  -0.01964278866773
lambda[  16] =  -0.00532780623158
lambda[  17] =   0.01781904874292
lambda[  18] =   0.02286798726930
lambda[  19] =   0.02989869924404
lambda[  20] =   0.03628088633954
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 7.085 ms
rank =  0, Distributing orbital back into band + domain format took 17.475 ms
rank = 0, Subspace_Rotation used 24.579 ms

Total time for subspace rotation: 24.585 ms
rank = 0, Efermi =  -0.101649048398 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 4.560 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.265 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.288 ms
rank = 0, Calculating density took 1809.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.855 ms
rank = 0, D2D took 1.001 ms
rank = 0, Transfering density took 1.009 ms
Etot    =   -37.408496544698
Eband   =   -11.674678734901
E1      =    27.568981515816
E2      =   -10.380833322434
E3      =   -14.836019993466
Exc     =   -13.279478809581
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 2.818e-06, dEband = 1.522e-04
rank = 0, Calculating/Estimating energy took 1.074 ms, Etot = -37.408496545, dEtot = 2.818e-06, dEband = 1.522e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244097764344, which took 0.049 ms

iter_count = 108, r_2norm = 7.870e-07, tol*||rhs|| = 9.764e-07

Anderson update took 57.611 ms, out of which F'*F took 26.806 ms; b-Ax took 182.877 ms, out of which Lap took 162.740 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.359 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653981, int_b + int_rho = -1.892e-13, checking this took 0.121 ms
2-norm of RHS = 737.2248482479077, which took 0.091 ms

iter_count = 102, r_2norm = 6.631e-04, tol*||rhs|| = 7.372e-04

Anderson update took 55.878 ms, out of which F'*F took 25.476 ms; b-Ax took 176.853 ms, out of which Lap took 159.041 ms
Solving Poisson took 372.870 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.099478 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.097298 
Total time for convolution: 	 convolve: 5.298239 
Total time for convolution: 	 convolve: 5.097936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 1.473 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.351 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.634 ms

This SCF took 27664.149 ms, scf error = 1.117e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136281, lowerbound = -0.807839, upperbound = 267.567540

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1707.972 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.944 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.109 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 22.083 ms
rank =  0, finding HY took 28.997 ms
rank =  0, distributing HY into block cyclic form took 17.930 ms
rank =  0, finding Y'*HY took 5.571 ms
Rank 0, Project_Hamiltonian used 74.619 ms
Total time for projection: 74.635 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.807787045592123
    last  calculated eigval = 0.036953696358104
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54240688817061
lambda[   5] =  -0.47787865374463
lambda[   6] =  -0.40728079059680
lambda[   7] =  -0.38042222811397
lambda[   8] =  -0.35765738342886
lambda[   9] =  -0.33172007793586
lambda[  10] =  -0.31866779825316
lambda[  11] =  -0.29777906306764
lambda[  12] =  -0.28162465213216
lambda[  13] =  -0.23480787419193
lambda[  14] =  -0.07268940992890
lambda[  15] =  -0.01911250384386
lambda[  16] =  -0.00521977225139
lambda[  17] =   0.01800135201028
lambda[  18] =   0.02343334927799
lambda[  19] =   0.03027819535352
lambda[  20] =   0.03695369635810
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.209 ms
rank =  0, subspace rotation using ScaLAPACK took 7.095 ms
rank =  0, Distributing orbital back into band + domain format took 17.593 ms
rank = 0, Subspace_Rotation used 24.712 ms

Total time for subspace rotation: 24.718 ms
rank = 0, Efermi =  -0.101600332698 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.333 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.364 ms
rank = 0, Calculating density took 1815.881 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.906 ms
rank = 0, D2D took 1.040 ms
rank = 0, Transfering density took 1.049 ms
Etot    =   -37.408504199755
Eband   =   -11.673308369270
E1      =    27.568279636864
E2      =   -10.380152353326
E3      =   -14.836069139961
Exc     =   -13.279523128703
Esc     =   -65.240173831141
Entropy =    -0.000000000791
dE = 7.655e-07, dEband = 1.370e-04
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -37.408504200, dEtot = 7.655e-07, dEband = 1.370e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0186772342236, which took 0.052 ms

iter_count = 108, r_2norm = 6.211e-07, tol*||rhs|| = 7.471e-07

Anderson update took 57.026 ms, out of which F'*F took 26.623 ms; b-Ax took 181.261 ms, out of which Lap took 162.087 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.201 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002653999, int_rho =  26.00000002653996, int_b + int_rho = -2.910e-14, checking this took 0.098 ms
2-norm of RHS = 737.2224232934930, which took 0.067 ms

iter_count = 132, r_2norm = 6.649e-04, tol*||rhs|| = 7.372e-04

Anderson update took 70.701 ms, out of which F'*F took 32.879 ms; b-Ax took 223.893 ms, out of which Lap took 200.625 ms
Solving Poisson took 475.729 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.107050 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.096005 
Total time for convolution: 	 convolve: 5.094815 
Total time for convolution: 	 convolve: 5.092486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.043 ms
---Transfer Veff_loc: D2D took 2.207 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.443 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.675 ms

This SCF took 27129.708 ms, scf error = 9.550e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.54240688817061, occ[   4] =   2.00000000000000
lambda[   5] =  -0.47787865374463, occ[   5] =   2.00000000000000
lambda[   6] =  -0.40728079059680, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38042222811397, occ[   7] =   2.00000000000000
lambda[   8] =  -0.35765738342886, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33172007793586, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31866779825316, occ[  10] =   2.00000000000000
lambda[  11] =  -0.29777906306764, occ[  11] =   2.00000000000000
lambda[  12] =  -0.28162465213216, occ[  12] =   2.00000000000000
lambda[  13] =  -0.23480787419193, occ[  13] =   2.00000000000000
lambda[  14] =  -0.07268940992890, occ[  14] =   0.00000002653987
lambda[  15] =  -0.01911250384386, occ[  15] =   0.00000000000000
lambda[  16] =  -0.00521977225139, occ[  16] =   0.00000000000000
lambda[  17] =   0.01800135201028, occ[  17] =   0.00000000000000
lambda[  18] =   0.02343334927799, occ[  18] =   0.00000000000000
lambda[  19] =   0.03027819535352, occ[  19] =   0.00000000000000
lambda[  20] =   0.03695369635810, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.611 ms, time for Allreduce/Reduce: 13.963 ms 
Time for calculating local force components: 25.005 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.01810803114856  -0.04643098225214  -0.00000001224823
 -0.01812885578829   0.02288975165064  -0.03947725326517
 -0.01812884267602   0.02288975576902   0.03947725885882
  0.02309610705527   0.04625962634553  -0.00000001345251
 -0.02124669452232  -0.04682619012244   0.00000003221683
 -0.04395152061389  -0.00979348831710   0.00000011983008
  0.00635600306584   0.01168723302363   0.00000038233244
 -0.14350904856690  -0.00247462707580  -0.00000048009032
  0.00796050262378   0.00745653654490  -0.00000016740852
  0.93040776185566   0.02720135630876   0.00000063502522
force_loc = 
  0.01950697484964   0.04709529756943   0.00000011158401
  0.01944197657715  -0.02453779894031   0.04055238015845
  0.01944164607999  -0.02453761001894  -0.04055243127041
 -0.02367473335536  -0.04679509957739   0.00000008108593
  0.02109677405661   0.04826510405953  -0.00000032687712
  0.03842945247879   0.01190417839356   0.00000024639116
  0.00140941917776  -0.01587490664643   0.00000040104580
  0.12591705451317   0.00502457171607  -0.00000089706598
 -0.01659995425532  -0.00635070518974  -0.00000017585107
 -0.88510879663987  -0.02574876181747   0.00000043349512
Time for calculating nonlocal force components: 41.685 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00227088210522   0.00032470278984   0.00000000388567
[0m[32m -0.00371394257497   0.00313142272652  -0.00000000753560
[0m[32m  0.00759088644113  -0.00371869504752  -0.00000005504208
[0m[32m -0.01536989374096  -0.00067223094737  -0.00000007820440
[0m[32m -0.01533572770791  -0.00038147138794   0.00000000272801
[0mTime for calculating XC forces components: 38.077 ms
 Cartesian force = 
  0.00139400377212   0.00066561836161   0.00000008030317
  0.00130818085990  -0.00164674424535   0.00107510786067
  0.00130786347501  -0.00164655120560  -0.00107519144420
 -0.00058356622906  -0.00053417018755   0.00000004860081
 -0.00015486039467   0.00144021698140  -0.00000031369290
 -0.00325612595885   0.00243669591061   0.00000035107430
  0.00404653973966  -0.00105494785196   0.00000075681003
 -0.01000604754156  -0.00116744736294  -0.00000145123100
 -0.02401428530146   0.00043490345211  -0.00000044049661
  0.02995829757892   0.00107242614767   0.00000105221574
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.313 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Time for printing density: 391.188 ms
The program took 473.387 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:27:55
Job ID:        2266520
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:37:24,vmem=8348K,walltime=00:08:07,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-13-1
---------------------------------------
