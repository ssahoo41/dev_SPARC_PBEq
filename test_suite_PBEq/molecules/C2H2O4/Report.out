---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:41
Job ID:    2266453
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:47
Job ID:    2266453
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.064 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 42.658 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 17.238 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 116.716 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.970 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.086 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.128735	   12.595085	   10.000000	
    7.871265	    7.404915	   10.000000	
    7.871265	   12.493779	   10.000000	
   12.128735	    7.506221	   10.000000	
   13.380862	   11.246344	   10.000000	
    6.619138	    8.753656	   10.000000	
    9.897889	   11.449673	   10.000000	
   10.102111	    8.550327	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.168 ms
Set up communicators.

--set up spincomm took 2.287 ms

--set up kptcomm took 0.360 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 25, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 25 
rank =  0, my blacs rank = 0, BLCYC size (170000, 13), actual size (170000, 13)
rank = 0, mb = nb = 25, mbQ = nbQ = 64
rank = 0, nr_Hp = 25, nc_Hp = 25
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.048 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.417 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 13
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.503 ms

Calculate_SplineDerivRadFun took 0.214 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.285 ms.
time spent on vectorized spline interp: 2.872 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.990 ms.
time spent on vectorized spline interp: 1.348 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.597 ms.
time spent on vectorized spline interp: 1.740 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.556 ms.

Calculating rb for all atom types took 15.396 ms
----------------------
Estimated memory usage
Total: 1.46 GB
orbitals             : 1.12 GB
global sized vectors : 213.62 MB
subspace matrices : 87.89 kB
others : 135.81 MB
----------------------------------------------
Estimated memory usage per processor: 124.49 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.840 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -34.0000000247082, sum_int_rho = 33.7882269845432
PosCharge = 34.000000024708, NegCharge = -33.788226984543, scal_fac = 1.006267657674
After scaling, int_rho = 34.0000000247081, PosCharge + NegCharge - NetCharge = 8.527e-14
--Calculate Vref took 0.619 ms
--Calculate rho_guess took 3.575 ms

 integral of b = -34.0000000247082,
 int{b} + Nelectron + NetCharge = -2.471e-08,
 Esc = -119.6683200304821,
 MPI_Reduce took 10.953 ms

Calculating b & b_ref took 23.080 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.013 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.026 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 51.741 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470802, int_rho =  34.00000002470816, int_b + int_rho = 1.310e-13, checking this took 0.103 ms
2-norm of RHS = 739.0232115530054, which took 0.405 ms

iter_count = 420, r_2norm = 6.557e-04, tol*||rhs|| = 7.390e-04

Anderson update took 258.353 ms, out of which F'*F took 105.666 ms; b-Ax took 718.775 ms, out of which Lap took 643.465 ms
Solving Poisson took 1547.703 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.437 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
Total time for convolution: 	 convolve: 5.184634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.814 ms
Total time for convolution: 	 convolve: 5.213837 
Total time for convolution: 	 convolve: 5.170083 
Total time for convolution: 	 convolve: 5.154847 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.759 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.309 ms
rank = 0, XC calculation took 24999.594 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.087 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.780 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.962 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.145 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.671 ms
    Lanczos iter 53, eigmin  = -1.135964130, eigmax = 264.932254745, err_eigmin = 1.118e-04, err_eigmax = 9.583e-03
rank =   0, Lanczos took 122.396 ms, eigmin = -1.135964129730, eigmax = 267.581577292349

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.172807, lowerbound = -1.235964, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2003.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.613 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.025 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 32.667 ms
rank =  0, finding HY took 34.076 ms
rank =  0, distributing HY into block cyclic form took 23.197 ms
rank =  0, finding Y'*HY took 6.220 ms
Rank 0, Project_Hamiltonian used 96.194 ms
Total time for projection: 96.206 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.519 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.581 ms
    first calculated eigval = 2.685541677917551
    last  calculated eigval = 3.257615199274231
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =   2.85677141345638
lambda[   9] =   2.88697416579848
lambda[  10] =   2.94779627005894
lambda[  11] =   2.96130628199655
lambda[  12] =   2.98270554861715
lambda[  13] =   3.00541448273099
lambda[  14] =   3.03233599113523
lambda[  15] =   3.04947732257525
lambda[  16] =   3.05853987464043
lambda[  17] =   3.07512616307508
lambda[  18] =   3.08804180548103
lambda[  19] =   3.11672514291538
lambda[  20] =   3.13370830945726
lambda[  21] =   3.14890535100450
lambda[  22] =   3.20275162712830
lambda[  23] =   3.22016361087167
lambda[  24] =   3.22702753519122
lambda[  25] =   3.25761519927423
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.601 ms
rank =  0, subspace rotation using ScaLAPACK took 9.535 ms
rank =  0, Distributing orbital back into band + domain format took 21.119 ms
rank = 0, Subspace_Rotation used 30.674 ms

Total time for subspace rotation: 30.679 ms
rank = 0, Efermi =   3.081584049648 calculate fermi energy took 0.045 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.357615, lowerbound = -1.235964, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2010.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 22.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.942 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 26.702 ms
rank =  0, finding HY took 48.416 ms
rank =  0, distributing HY into block cyclic form took 27.038 ms
rank =  0, finding Y'*HY took 4.852 ms
Rank 0, Project_Hamiltonian used 107.036 ms
Total time for projection: 107.039 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -1.033761801714035
    last  calculated eigval = 0.470258934479258
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.28969701529685
lambda[   9] =  -0.24522394079951
lambda[  10] =  -0.15392361090070
lambda[  11] =  -0.10618787617720
lambda[  12] =  -0.05283460166985
lambda[  13] =   0.01176304681967
lambda[  14] =   0.05408056561265
lambda[  15] =   0.20574512437226
lambda[  16] =   0.25967940672195
lambda[  17] =   0.27619569200426
lambda[  18] =   0.31119388787874
lambda[  19] =   0.32533236097270
lambda[  20] =   0.34260654509699
lambda[  21] =   0.36566655969347
lambda[  22] =   0.38358293216752
lambda[  23] =   0.40851787989066
lambda[  24] =   0.44557913616582
lambda[  25] =   0.47025893447926
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 9.679 ms
rank =  0, Distributing orbital back into band + domain format took 21.404 ms
rank = 0, Subspace_Rotation used 31.101 ms

Total time for subspace rotation: 31.106 ms
rank = 0, Efermi =   0.293694812221 calculate fermi energy took 0.026 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.570259, lowerbound = -1.235964, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2297.994 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 35.150 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.894 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 39.078 ms
rank =  0, finding HY took 34.502 ms
rank =  0, distributing HY into block cyclic form took 22.865 ms
rank =  0, finding Y'*HY took 5.132 ms
Rank 0, Project_Hamiltonian used 101.625 ms
Total time for projection: 101.635 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -1.136655771764161
    last  calculated eigval = 0.175363174659039
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.53623404817155
lambda[   9] =  -0.51778387139466
lambda[  10] =  -0.49662614521741
lambda[  11] =  -0.48920521501142
lambda[  12] =  -0.45773780998981
lambda[  13] =  -0.42623424328055
lambda[  14] =  -0.37915962890449
lambda[  15] =  -0.37416661410603
lambda[  16] =  -0.34076959513747
lambda[  17] =  -0.30472086093057
lambda[  18] =  -0.11010310971468
lambda[  19] =   0.03238143592571
lambda[  20] =   0.07468802392368
lambda[  21] =   0.10378589816328
lambda[  22] =   0.10877797285725
lambda[  23] =   0.13866569849013
lambda[  24] =   0.14475017454927
lambda[  25] =   0.17536317465904
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 9.581 ms
rank =  0, Distributing orbital back into band + domain format took 20.972 ms
rank = 0, Subspace_Rotation used 30.567 ms

Total time for subspace rotation: 30.571 ms
rank = 0, Efermi =  -0.139078802814 calculate fermi energy took 0.045 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.275363, lowerbound = -1.235964, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1988.805 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 22.726 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.843 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.594 ms
rank =  0, finding HY took 36.243 ms
rank =  0, distributing HY into block cyclic form took 22.715 ms
rank =  0, finding Y'*HY took 5.098 ms
Rank 0, Project_Hamiltonian used 90.691 ms
Total time for projection: 90.695 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -1.136729937335440
    last  calculated eigval = 0.108178919934951
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.54301890131797
lambda[   9] =  -0.52151259097258
lambda[  10] =  -0.50623807633470
lambda[  11] =  -0.49606612716493
lambda[  12] =  -0.46410405351975
lambda[  13] =  -0.43276300140133
lambda[  14] =  -0.40666071320153
lambda[  15] =  -0.39719244255093
lambda[  16] =  -0.38775975799148
lambda[  17] =  -0.33989114435272
lambda[  18] =  -0.16276908944567
lambda[  19] =  -0.01334573086235
lambda[  20] =   0.02701370781819
lambda[  21] =   0.04302957051298
lambda[  22] =   0.06965474569092
lambda[  23] =   0.07620237919534
lambda[  24] =   0.07935117949696
lambda[  25] =   0.10817891993495
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 9.494 ms
rank =  0, Distributing orbital back into band + domain format took 23.834 ms
rank = 0, Subspace_Rotation used 33.370 ms

Total time for subspace rotation: 33.375 ms
rank = 0, Efermi =  -0.191744782469 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 3.577 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.450 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 8952.739 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.441 ms
rank = 0, D2D took 0.681 ms
rank = 0, Transfering density took 0.692 ms
Etot    =   -79.510932177602
Eband   =   -21.669164363414
E1      =    40.004464343304
E2      =   -19.489737875960
E3      =   -23.451741284647
Exc     =   -21.119391286880
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 9.939e+00, dEband = 2.709e+00
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -79.510932178, dEtot = 9.939e+00, dEband = 2.709e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 79.0407514190358, which took 1.263 ms

iter_count = 90, r_2norm = 2.621e-03, tol*||rhs|| = 3.162e-03

Anderson update took 454.534 ms, out of which F'*F took 242.433 ms; b-Ax took 925.505 ms, out of which Lap took 915.100 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1784.286 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470824, int_b + int_rho = 2.037e-13, checking this took 0.102 ms
2-norm of RHS = 732.9926917468723, which took 43.992 ms

iter_count = 276, r_2norm = 6.977e-04, tol*||rhs|| = 7.330e-04

Anderson update took 851.083 ms, out of which F'*F took 493.291 ms; b-Ax took 2225.502 ms, out of which Lap took 2190.214 ms
Solving Poisson took 3893.758 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.021 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.623766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 48.312 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.101162 
Total time for convolution: 	 convolve: 5.079074 
Total time for convolution: 	 convolve: 5.110637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.056 ms

This SCF took 39676.641 ms, scf error = 1.279e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.208179, lowerbound = -1.136730, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2016.090 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.704 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.959 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 26.695 ms
rank =  0, finding HY took 35.022 ms
rank =  0, distributing HY into block cyclic form took 21.441 ms
rank =  0, finding Y'*HY took 8.291 ms
Rank 0, Project_Hamiltonian used 91.480 ms
Total time for projection: 91.492 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -1.108193646400511
    last  calculated eigval = 0.084007507338991
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.49897285570369
lambda[   9] =  -0.48816183634268
lambda[  10] =  -0.47766406995405
lambda[  11] =  -0.46253440238823
lambda[  12] =  -0.43705884740322
lambda[  13] =  -0.39861754230539
lambda[  14] =  -0.36428970783710
lambda[  15] =  -0.35967926812445
lambda[  16] =  -0.34931769532626
lambda[  17] =  -0.29992388906494
lambda[  18] =  -0.15015837593304
lambda[  19] =  -0.01647797680754
lambda[  20] =  -0.01088285200085
lambda[  21] =   0.01951449729728
lambda[  22] =   0.04451070013057
lambda[  23] =   0.05279057505834
lambda[  24] =   0.05881977876718
lambda[  25] =   0.08400750733899
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 9.398 ms
rank =  0, Distributing orbital back into band + domain format took 21.187 ms
rank = 0, Subspace_Rotation used 30.602 ms

Total time for subspace rotation: 30.606 ms
rank = 0, Efermi =  -0.179134068697 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.374 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.566 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 2142.601 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
rank = 0, D2D took 0.668 ms
rank = 0, Transfering density took 0.689 ms
Etot    =   -79.427801592871
Eband   =   -20.565099606857
E1      =    39.124014015749
E2      =   -19.281087958376
E3      =   -23.760985312028
Exc     =   -21.360469240947
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.039e-02, dEband = 1.380e-01
rank = 0, Calculating/Estimating energy took 1.199 ms, Etot = -79.427801593, dEtot = 1.039e-02, dEband = 1.380e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 39.0959542941686, which took 0.070 ms

iter_count = 96, r_2norm = 1.044e-03, tol*||rhs|| = 1.564e-03

Anderson update took 51.302 ms, out of which F'*F took 24.088 ms; b-Ax took 162.479 ms, out of which Lap took 146.502 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.878 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470809, int_b + int_rho = 5.093e-14, checking this took 0.110 ms
2-norm of RHS = 730.8978562905431, which took 0.090 ms

iter_count = 276, r_2norm = 7.113e-04, tol*||rhs|| = 7.309e-04

Anderson update took 146.721 ms, out of which F'*F took 69.814 ms; b-Ax took 470.191 ms, out of which Lap took 422.484 ms
Solving Poisson took 993.947 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.209054 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 399.956 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.144133 
Total time for convolution: 	 convolve: 5.106201 
Total time for convolution: 	 convolve: 5.138266 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.597 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.014 ms

This SCF took 28769.297 ms, scf error = 7.236e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.184008, lowerbound = -1.108194, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2008.455 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.888 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.068 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 26.984 ms
rank =  0, finding HY took 35.120 ms
rank =  0, distributing HY into block cyclic form took 25.368 ms
rank =  0, finding Y'*HY took 4.929 ms
Rank 0, Project_Hamiltonian used 92.432 ms
Total time for projection: 92.454 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -1.084264132558297
    last  calculated eigval = 0.072351737072500
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.47247651640752
lambda[   9] =  -0.46668732283517
lambda[  10] =  -0.44509526781315
lambda[  11] =  -0.43479489869506
lambda[  12] =  -0.41630361363382
lambda[  13] =  -0.37009662784800
lambda[  14] =  -0.33465322103872
lambda[  15] =  -0.33365386575885
lambda[  16] =  -0.32233572925643
lambda[  17] =  -0.26998244805160
lambda[  18] =  -0.13347180915220
lambda[  19] =  -0.02985363521006
lambda[  20] =  -0.00232987953441
lambda[  21] =   0.01229373766971
lambda[  22] =   0.03581325457786
lambda[  23] =   0.04136448061366
lambda[  24] =   0.05106941228287
lambda[  25] =   0.07235173707250
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 8.678 ms
rank =  0, Distributing orbital back into band + domain format took 21.917 ms
rank = 0, Subspace_Rotation used 30.617 ms

Total time for subspace rotation: 30.621 ms
rank = 0, Efermi =  -0.162447502088 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.382 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.468 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 2135.824 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
rank = 0, D2D took 0.845 ms
rank = 0, Transfering density took 0.857 ms
Etot    =   -79.402874393246
Eband   =   -19.688827761423
E1      =    38.453347888666
E2      =   -19.046298228615
E3      =   -24.002563543961
Exc     =   -21.547936261846
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 3.116e-03, dEband = 1.095e-01
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -79.402874393, dEtot = 3.116e-03, dEband = 1.095e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4060235534287, which took 0.055 ms

iter_count = 102, r_2norm = 2.311e-04, tol*||rhs|| = 2.962e-04

Anderson update took 53.962 ms, out of which F'*F took 25.414 ms; b-Ax took 173.774 ms, out of which Lap took 155.315 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470799, int_b + int_rho = -3.638e-14, checking this took 0.081 ms
2-norm of RHS = 733.7119042102947, which took 0.104 ms

iter_count = 282, r_2norm = 6.260e-04, tol*||rhs|| = 7.337e-04

Anderson update took 148.898 ms, out of which F'*F took 70.624 ms; b-Ax took 481.174 ms, out of which Lap took 430.813 ms
Solving Poisson took 1017.635 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.142044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 79.014 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.108964 
Total time for convolution: 	 convolve: 5.137516 
Total time for convolution: 	 convolve: 5.108401 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.740 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.579 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.000 ms

This SCF took 28271.153 ms, scf error = 3.908e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.172352, lowerbound = -1.084264, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2009.825 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.069 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.853 ms
rank =  0, finding HY took 34.103 ms
rank =  0, distributing HY into block cyclic form took 23.021 ms
rank =  0, finding Y'*HY took 5.269 ms
Rank 0, Project_Hamiltonian used 89.299 ms
Total time for projection: 89.315 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -1.068508511380726
    last  calculated eigval = 0.060502310209103
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45987205242733
lambda[   9] =  -0.44888267411055
lambda[  10] =  -0.42738229645079
lambda[  11] =  -0.41977795175225
lambda[  12] =  -0.40430308418994
lambda[  13] =  -0.35353886775018
lambda[  14] =  -0.32345451206598
lambda[  15] =  -0.32017771128864
lambda[  16] =  -0.31176145378168
lambda[  17] =  -0.25486255546888
lambda[  18] =  -0.12068587572556
lambda[  19] =  -0.03381675861450
lambda[  20] =   0.01009845069309
lambda[  21] =   0.01220723051073
lambda[  22] =   0.02994085836657
lambda[  23] =   0.03548607268004
lambda[  24] =   0.04824035172312
lambda[  25] =   0.06050231020910
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 9.446 ms
rank =  0, Distributing orbital back into band + domain format took 21.311 ms
rank = 0, Subspace_Rotation used 30.771 ms

Total time for subspace rotation: 30.776 ms
rank = 0, Efermi =  -0.149661568520 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.499 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.691 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 2134.528 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.444 ms
rank = 0, D2D took 0.643 ms
rank = 0, Transfering density took 0.652 ms
Etot    =   -79.396431499038
Eband   =   -19.179069074496
E1      =    38.136696489534
E2      =   -18.829165218941
E3      =   -24.130914714180
Exc     =   -21.645818815977
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 8.054e-04, dEband = 6.372e-02
rank = 0, Calculating/Estimating energy took 1.132 ms, Etot = -79.396431499, dEtot = 8.054e-04, dEband = 6.372e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.9245668064334, which took 0.057 ms

iter_count = 102, r_2norm = 1.165e-04, tol*||rhs|| = 1.170e-04

Anderson update took 54.301 ms, out of which F'*F took 25.899 ms; b-Ax took 174.466 ms, out of which Lap took 156.593 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.806 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470818, int_b + int_rho = 1.455e-13, checking this took 0.121 ms
2-norm of RHS = 734.6097210816896, which took 0.072 ms

iter_count = 252, r_2norm = 6.543e-04, tol*||rhs|| = 7.346e-04

Anderson update took 133.253 ms, out of which F'*F took 64.362 ms; b-Ax took 433.533 ms, out of which Lap took 388.957 ms
Solving Poisson took 911.240 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.142603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.633 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.110666 
Total time for convolution: 	 convolve: 5.124283 
Total time for convolution: 	 convolve: 5.183404 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.606 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 28348.531 ms, scf error = 8.953e-03
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.160502, lowerbound = -1.068509, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2017.248 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.808 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.853 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.690 ms
rank =  0, finding HY took 34.871 ms
rank =  0, distributing HY into block cyclic form took 22.843 ms
rank =  0, finding Y'*HY took 5.167 ms
Rank 0, Project_Hamiltonian used 89.597 ms
Total time for projection: 89.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.120 ms
rank = 0, Solve_Generalized_EigenProblem used 0.266 ms
    first calculated eigval = -1.066448008266877
    last  calculated eigval = 0.046330719968267
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45836333278362
lambda[   9] =  -0.44396616923217
lambda[  10] =  -0.42261118503209
lambda[  11] =  -0.41768532682278
lambda[  12] =  -0.40249406600622
lambda[  13] =  -0.35134624839298
lambda[  14] =  -0.32084580283774
lambda[  15] =  -0.31558367959024
lambda[  16] =  -0.30949302967832
lambda[  17] =  -0.25038999240025
lambda[  18] =  -0.11866418129450
lambda[  19] =  -0.03486427261098
lambda[  20] =   0.00859885201986
lambda[  21] =   0.01358253382928
lambda[  22] =   0.02521101385182
lambda[  23] =   0.03171104760922
lambda[  24] =   0.04459507949595
lambda[  25] =   0.04633071996827
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 9.367 ms
rank =  0, Distributing orbital back into band + domain format took 21.455 ms
rank = 0, Subspace_Rotation used 30.836 ms

Total time for subspace rotation: 30.840 ms
rank = 0, Efermi =  -0.147639874283 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 3.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.628 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.067 ms
rank = 0, Calculating density took 2142.272 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.550 ms
rank = 0, D2D took 0.740 ms
rank = 0, Transfering density took 0.748 ms
Etot    =   -79.395792775907
Eband   =   -19.084389588095
E1      =    38.094407147961
E2      =   -18.770352849900
E3      =   -24.156902215913
Exc     =   -21.664745370366
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 7.984e-05, dEband = 1.183e-02
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -79.395792776, dEtot = 7.984e-05, dEband = 1.183e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.6555328440844, which took 0.055 ms

iter_count = 108, r_2norm = 4.870e-05, tol*||rhs|| = 6.622e-05

Anderson update took 57.370 ms, out of which F'*F took 27.306 ms; b-Ax took 184.114 ms, out of which Lap took 165.223 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.052 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470813, int_b + int_rho = 9.459e-14, checking this took 0.107 ms
2-norm of RHS = 735.1636996074774, which took 0.094 ms

iter_count = 234, r_2norm = 6.887e-04, tol*||rhs|| = 7.352e-04

Anderson update took 124.199 ms, out of which F'*F took 59.275 ms; b-Ax took 402.487 ms, out of which Lap took 361.424 ms
Solving Poisson took 847.937 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.864 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.111758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.904 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.110869 
Total time for convolution: 	 convolve: 5.158548 
Total time for convolution: 	 convolve: 5.114801 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.660 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.977 ms

This SCF took 28555.861 ms, scf error = 4.892e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.146331, lowerbound = -1.066448, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2032.224 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.862 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.504 ms
rank =  0, finding HY took 34.565 ms
rank =  0, distributing HY into block cyclic form took 22.634 ms
rank =  0, finding Y'*HY took 5.187 ms
Rank 0, Project_Hamiltonian used 88.921 ms
Total time for projection: 88.936 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -1.066373780604294
    last  calculated eigval = 0.042971923789795
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45840481567768
lambda[   9] =  -0.44396319297337
lambda[  10] =  -0.42267191553924
lambda[  11] =  -0.41744748335383
lambda[  12] =  -0.40250104932990
lambda[  13] =  -0.35121635517487
lambda[  14] =  -0.32094411891587
lambda[  15] =  -0.31576404468284
lambda[  16] =  -0.30955592343667
lambda[  17] =  -0.25059021910316
lambda[  18] =  -0.11884262729947
lambda[  19] =  -0.03528884654075
lambda[  20] =   0.00732880307364
lambda[  21] =   0.01331807103005
lambda[  22] =   0.02245985921761
lambda[  23] =   0.02762995933516
lambda[  24] =   0.03479474166054
lambda[  25] =   0.04297192378980
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 9.633 ms
rank =  0, Distributing orbital back into band + domain format took 21.128 ms
rank = 0, Subspace_Rotation used 30.776 ms

Total time for subspace rotation: 30.780 ms
rank = 0, Efermi =  -0.147818320107 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.556 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 2156.319 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.014 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.521 ms
rank = 0, D2D took 0.713 ms
rank = 0, Transfering density took 0.721 ms
Etot    =   -79.395692764224
Eband   =   -19.084802816671
E1      =    38.113899824462
E2      =   -18.751296831604
E3      =   -24.153448339007
Exc     =   -21.661214911407
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.250e-05, dEband = 5.165e-05
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -79.395692764, dEtot = 1.250e-05, dEband = 5.165e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6584015848068, which took 0.100 ms

iter_count = 108, r_2norm = 2.528e-05, tol*||rhs|| = 2.634e-05

Anderson update took 57.579 ms, out of which F'*F took 27.464 ms; b-Ax took 183.650 ms, out of which Lap took 165.082 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470800, int_b + int_rho = -2.910e-14, checking this took 0.896 ms
2-norm of RHS = 735.3911738264153, which took 0.110 ms

iter_count = 234, r_2norm = 6.955e-04, tol*||rhs|| = 7.354e-04

Anderson update took 124.269 ms, out of which F'*F took 59.647 ms; b-Ax took 400.095 ms, out of which Lap took 360.380 ms
Solving Poisson took 845.180 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.083367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.961 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.107632 
Total time for convolution: 	 convolve: 5.079713 
Total time for convolution: 	 convolve: 5.119421 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.285 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.004 ms

This SCF took 27964.151 ms, scf error = 2.646e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.142972, lowerbound = -1.066374, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2018.002 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.594 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.830 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.449 ms
rank =  0, finding HY took 34.882 ms
rank =  0, distributing HY into block cyclic form took 22.876 ms
rank =  0, finding Y'*HY took 5.209 ms
Rank 0, Project_Hamiltonian used 89.443 ms
Total time for projection: 89.457 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -1.065188800011100
    last  calculated eigval = 0.041332437245943
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45762755546652
lambda[   9] =  -0.44215948796377
lambda[  10] =  -0.42090664014854
lambda[  11] =  -0.41597043821906
lambda[  12] =  -0.40143700651401
lambda[  13] =  -0.34980589554893
lambda[  14] =  -0.31960155522767
lambda[  15] =  -0.31413926913410
lambda[  16] =  -0.30819926644343
lambda[  17] =  -0.24898102456219
lambda[  18] =  -0.11801244586188
lambda[  19] =  -0.03552449559705
lambda[  20] =   0.00662434413247
lambda[  21] =   0.01391997182338
lambda[  22] =   0.02054173381739
lambda[  23] =   0.02335861627455
lambda[  24] =   0.03098381096156
lambda[  25] =   0.04133243724594
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 9.449 ms
rank =  0, Distributing orbital back into band + domain format took 21.508 ms
rank = 0, Subspace_Rotation used 30.973 ms

Total time for subspace rotation: 30.977 ms
rank = 0, Efermi =  -0.146988138768 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.406 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.552 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.063 ms
rank = 0, Calculating density took 2142.806 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.505 ms
rank = 0, D2D took 0.686 ms
rank = 0, Transfering density took 0.690 ms
Etot    =   -79.395554606227
Eband   =   -19.039952833172
E1      =    38.094888790985
E2      =   -18.722790400589
E3      =   -24.163064408386
Exc     =   -21.668025341795
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.727e-05, dEband = 5.606e-03
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -79.395554606, dEtot = 1.727e-05, dEband = 5.606e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2751055292753, which took 0.056 ms

iter_count = 108, r_2norm = 9.714e-06, tol*||rhs|| = 1.100e-05

Anderson update took 57.699 ms, out of which F'*F took 27.209 ms; b-Ax took 184.487 ms, out of which Lap took 165.453 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.428 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470801, int_b + int_rho = -2.183e-14, checking this took 0.140 ms
2-norm of RHS = 735.3228479006860, which took 0.095 ms

iter_count = 240, r_2norm = 6.429e-04, tol*||rhs|| = 7.353e-04

Anderson update took 127.021 ms, out of which F'*F took 75.305 ms; b-Ax took 427.230 ms, out of which Lap took 384.074 ms
Solving Poisson took 897.298 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.116695 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 20.019 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.128997 
Total time for convolution: 	 convolve: 5.119385 
Total time for convolution: 	 convolve: 5.115134 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.425 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.294 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.966 ms

This SCF took 27981.811 ms, scf error = 1.542e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.141332, lowerbound = -1.065189, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2014.311 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.843 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.669 ms
rank =  0, finding HY took 34.520 ms
rank =  0, distributing HY into block cyclic form took 22.975 ms
rank =  0, finding Y'*HY took 5.110 ms
Rank 0, Project_Hamiltonian used 89.307 ms
Total time for projection: 89.319 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -1.063468587343361
    last  calculated eigval = 0.039323822248137
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45606816412747
lambda[   9] =  -0.44010500889915
lambda[  10] =  -0.41889709254697
lambda[  11] =  -0.41430898706939
lambda[  12] =  -0.39985385622963
lambda[  13] =  -0.34807095623864
lambda[  14] =  -0.31808637699675
lambda[  15] =  -0.31222646172565
lambda[  16] =  -0.30668681713646
lambda[  17] =  -0.24703818176334
lambda[  18] =  -0.11641113066901
lambda[  19] =  -0.03567784049896
lambda[  20] =   0.00650100310153
lambda[  21] =   0.01557743885352
lambda[  22] =   0.01873533158776
lambda[  23] =   0.02184600953172
lambda[  24] =   0.02879230334896
lambda[  25] =   0.03932382224814
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 9.400 ms
rank =  0, Distributing orbital back into band + domain format took 21.323 ms
rank = 0, Subspace_Rotation used 30.737 ms

Total time for subspace rotation: 30.742 ms
rank = 0, Efermi =  -0.145386823545 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.507 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.516 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 2138.834 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.563 ms
rank = 0, D2D took 0.772 ms
rank = 0, Transfering density took 0.775 ms
Etot    =   -79.395642184018
Eband   =   -18.981179642843
E1      =    38.062346358454
E2      =   -18.694420241754
E3      =   -24.171145219283
Exc     =   -21.674054329447
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.095e-05, dEband = 7.347e-03
rank = 0, Calculating/Estimating energy took 1.468 ms, Etot = -79.395642184, dEtot = 1.095e-05, dEband = 7.347e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2419318032666, which took 0.055 ms

iter_count = 108, r_2norm = 7.769e-06, tol*||rhs|| = 9.677e-06

Anderson update took 57.470 ms, out of which F'*F took 27.320 ms; b-Ax took 184.199 ms, out of which Lap took 165.056 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.559 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470811, int_b + int_rho = 7.276e-14, checking this took 0.111 ms
2-norm of RHS = 735.3709862197909, which took 0.075 ms

iter_count = 210, r_2norm = 6.715e-04, tol*||rhs|| = 7.354e-04

Anderson update took 111.774 ms, out of which F'*F took 58.443 ms; b-Ax took 366.383 ms, out of which Lap took 329.512 ms
Solving Poisson took 763.497 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.119974 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.110326 
Total time for convolution: 	 convolve: 5.169989 
Total time for convolution: 	 convolve: 5.122411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.289 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.962 ms

This SCF took 27867.344 ms, scf error = 6.797e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.139324, lowerbound = -1.063469, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2014.427 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.778 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.918 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 26.721 ms
rank =  0, finding HY took 34.610 ms
rank =  0, distributing HY into block cyclic form took 22.851 ms
rank =  0, finding Y'*HY took 5.234 ms
Rank 0, Project_Hamiltonian used 89.447 ms
Total time for projection: 89.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -1.062638808969242
    last  calculated eigval = 0.038138904600004
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45525234435038
lambda[   9] =  -0.43929736923974
lambda[  10] =  -0.41810868325519
lambda[  11] =  -0.41355801086113
lambda[  12] =  -0.39907954500923
lambda[  13] =  -0.34729130655285
lambda[  14] =  -0.31737489451226
lambda[  15] =  -0.31141558675474
lambda[  16] =  -0.30598048708380
lambda[  17] =  -0.24622691282073
lambda[  18] =  -0.11560686607513
lambda[  19] =  -0.03458354584288
lambda[  20] =   0.00781509820286
lambda[  21] =   0.01638222739937
lambda[  22] =   0.01825734415302
lambda[  23] =   0.02266983523762
lambda[  24] =   0.02810997238652
lambda[  25] =   0.03813890460000
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 9.613 ms
rank =  0, Distributing orbital back into band + domain format took 21.273 ms
rank = 0, Subspace_Rotation used 30.902 ms

Total time for subspace rotation: 30.906 ms
rank = 0, Efermi =  -0.144582558962 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.535 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 2139.204 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 0.759 ms
rank = 0, Transfering density took 0.768 ms
Etot    =   -79.395762085196
Eband   =   -18.954089643380
E1      =    38.050010514307
E2      =   -18.679197662999
E3      =   -24.172181298924
Exc     =   -21.674741886827
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.499e-05, dEband = 3.386e-03
rank = 0, Calculating/Estimating energy took 1.412 ms, Etot = -79.395762085, dEtot = 1.499e-05, dEband = 3.386e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1272316809867, which took 0.123 ms

iter_count = 108, r_2norm = 4.103e-06, tol*||rhs|| = 5.089e-06

Anderson update took 57.832 ms, out of which F'*F took 27.220 ms; b-Ax took 184.339 ms, out of which Lap took 165.274 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470811, int_b + int_rho = 8.004e-14, checking this took 0.116 ms
2-norm of RHS = 735.3682348900345, which took 0.132 ms

iter_count = 204, r_2norm = 5.848e-04, tol*||rhs|| = 7.354e-04

Anderson update took 108.034 ms, out of which F'*F took 51.574 ms; b-Ax took 350.920 ms, out of which Lap took 314.269 ms
Solving Poisson took 738.653 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.108729 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.602 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.108373 
Total time for convolution: 	 convolve: 5.143179 
Total time for convolution: 	 convolve: 5.148230 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.288 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 27847.246 ms, scf error = 4.818e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.138139, lowerbound = -1.062639, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2015.331 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.659 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.850 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.535 ms
rank =  0, finding HY took 34.718 ms
rank =  0, distributing HY into block cyclic form took 22.880 ms
rank =  0, finding Y'*HY took 5.207 ms
Rank 0, Project_Hamiltonian used 89.378 ms
Total time for projection: 89.390 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -1.061883146006692
    last  calculated eigval = 0.037241130709608
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45456205860453
lambda[   9] =  -0.43854867752743
lambda[  10] =  -0.41736548165757
lambda[  11] =  -0.41280853727766
lambda[  12] =  -0.39835784896477
lambda[  13] =  -0.34654008806153
lambda[  14] =  -0.31662478381592
lambda[  15] =  -0.31064086689831
lambda[  16] =  -0.30522451738550
lambda[  17] =  -0.24545847919341
lambda[  18] =  -0.11491156941363
lambda[  19] =  -0.03248228119012
lambda[  20] =   0.01018401044492
lambda[  21] =   0.01700925331965
lambda[  22] =   0.01865670258719
lambda[  23] =   0.02525578629643
lambda[  24] =   0.02878876377145
lambda[  25] =   0.03724113070961
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 9.393 ms
rank =  0, Distributing orbital back into band + domain format took 21.880 ms
rank = 0, Subspace_Rotation used 31.291 ms

Total time for subspace rotation: 31.296 ms
rank = 0, Efermi =  -0.143887262311 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.246 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.766 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 2140.433 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.449 ms
rank = 0, D2D took 0.882 ms
rank = 0, Transfering density took 0.891 ms
Etot    =   -79.395839648388
Eband   =   -18.928736832507
E1      =    38.036860771134
E2      =   -18.666465597733
E3      =   -24.174095003848
Exc     =   -21.676204157377
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 9.695e-06, dEband = 3.169e-03
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -79.395839648, dEtot = 9.695e-06, dEband = 3.169e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0946194134896, which took 0.057 ms

iter_count = 108, r_2norm = 2.613e-06, tol*||rhs|| = 3.785e-06

Anderson update took 57.677 ms, out of which F'*F took 27.192 ms; b-Ax took 184.322 ms, out of which Lap took 164.977 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470813, int_b + int_rho = 9.459e-14, checking this took 0.141 ms
2-norm of RHS = 735.3861863505779, which took 0.127 ms

iter_count = 198, r_2norm = 6.055e-04, tol*||rhs|| = 7.354e-04

Anderson update took 104.968 ms, out of which F'*F took 49.861 ms; b-Ax took 340.111 ms, out of which Lap took 305.227 ms
Solving Poisson took 716.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.110268 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.583 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.455918 
Total time for convolution: 	 convolve: 5.075946 
Total time for convolution: 	 convolve: 5.071366 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.092 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 27990.248 ms, scf error = 2.847e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137241, lowerbound = -1.061883, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2031.360 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.635 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.847 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.509 ms
rank =  0, finding HY took 34.477 ms
rank =  0, distributing HY into block cyclic form took 22.699 ms
rank =  0, finding Y'*HY took 5.174 ms
Rank 0, Project_Hamiltonian used 88.886 ms
Total time for projection: 88.899 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -1.060943746971438
    last  calculated eigval = 0.036710921157066
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45366385130584
lambda[   9] =  -0.43768190882023
lambda[  10] =  -0.41650197328659
lambda[  11] =  -0.41194071334543
lambda[  12] =  -0.39746304883284
lambda[  13] =  -0.34566187037352
lambda[  14] =  -0.31574958681580
lambda[  15] =  -0.30974162811430
lambda[  16] =  -0.30434754322050
lambda[  17] =  -0.24456664145457
lambda[  18] =  -0.11402537592237
lambda[  19] =  -0.02989222212607
lambda[  20] =   0.01242335144372
lambda[  21] =   0.01787598369319
lambda[  22] =   0.01959477671811
lambda[  23] =   0.02909051535710
lambda[  24] =   0.03149844098979
lambda[  25] =   0.03671092115707
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 9.328 ms
rank =  0, Distributing orbital back into band + domain format took 21.679 ms
rank = 0, Subspace_Rotation used 31.025 ms

Total time for subspace rotation: 31.030 ms
rank = 0, Efermi =  -0.143001069023 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.328 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.742 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 2155.766 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.540 ms
rank = 0, D2D took 0.720 ms
rank = 0, Transfering density took 0.727 ms
Etot    =   -79.395924439341
Eband   =   -18.898215780455
E1      =    38.021338179423
E2      =   -18.650871543197
E3      =   -24.176351821853
Exc     =   -21.677950172139
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 1.060e-05, dEband = 3.815e-03
rank = 0, Calculating/Estimating energy took 0.958 ms, Etot = -79.395924439, dEtot = 1.060e-05, dEband = 3.815e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0562131711429, which took 0.099 ms

iter_count = 108, r_2norm = 1.955e-06, tol*||rhs|| = 2.249e-06

Anderson update took 57.671 ms, out of which F'*F took 27.245 ms; b-Ax took 183.195 ms, out of which Lap took 164.553 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.614 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470808, int_b + int_rho = 4.366e-14, checking this took 0.129 ms
2-norm of RHS = 735.3948420350488, which took 0.097 ms

iter_count = 156, r_2norm = 7.122e-04, tol*||rhs|| = 7.354e-04

Anderson update took 82.852 ms, out of which F'*F took 39.406 ms; b-Ax took 267.025 ms, out of which Lap took 239.781 ms
Solving Poisson took 564.425 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.081463 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.094747 
Total time for convolution: 	 convolve: 5.079127 
Total time for convolution: 	 convolve: 5.080804 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
---Transfer Veff_loc: D2D took 0.689 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.304 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 27537.675 ms, scf error = 1.595e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136711, lowerbound = -1.060944, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2015.698 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.639 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.902 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.567 ms
rank =  0, finding HY took 34.653 ms
rank =  0, distributing HY into block cyclic form took 22.846 ms
rank =  0, finding Y'*HY took 5.226 ms
Rank 0, Project_Hamiltonian used 89.322 ms
Total time for projection: 89.334 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -1.060690115156163
    last  calculated eigval = 0.036756313349680
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45340722563323
lambda[   9] =  -0.43745933318268
lambda[  10] =  -0.41628024741170
lambda[  11] =  -0.41170566251826
lambda[  12] =  -0.39721354733125
lambda[  13] =  -0.34542554340928
lambda[  14] =  -0.31551098824794
lambda[  15] =  -0.30950841813890
lambda[  16] =  -0.30410883160642
lambda[  17] =  -0.24433647343397
lambda[  18] =  -0.11377802623062
lambda[  19] =  -0.02873177615970
lambda[  20] =   0.01330573651910
lambda[  21] =   0.01812358543767
lambda[  22] =   0.02010079547210
lambda[  23] =   0.03058902350859
lambda[  24] =   0.03307662612693
lambda[  25] =   0.03675631334968
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 9.397 ms
rank =  0, Distributing orbital back into band + domain format took 21.920 ms
rank = 0, Subspace_Rotation used 31.337 ms

Total time for subspace rotation: 31.341 ms
rank = 0, Efermi =  -0.142753719104 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.316 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.777 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 2140.863 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.503 ms
rank = 0, D2D took 0.695 ms
rank = 0, Transfering density took 0.716 ms
Etot    =   -79.395950426689
Eband   =   -18.889986981441
E1      =    38.017436308589
E2      =   -18.646452132374
E3      =   -24.176660037228
Exc     =   -21.678191892220
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 3.248e-06, dEband = 1.029e-03
rank = 0, Calculating/Estimating energy took 0.945 ms, Etot = -79.395950427, dEtot = 3.248e-06, dEband = 1.029e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0421824865016, which took 0.060 ms

iter_count = 108, r_2norm = 1.249e-06, tol*||rhs|| = 1.687e-06

Anderson update took 57.463 ms, out of which F'*F took 27.126 ms; b-Ax took 184.338 ms, out of which Lap took 165.414 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.130 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470821, int_b + int_rho = 1.819e-13, checking this took 0.134 ms
2-norm of RHS = 735.3994229014788, which took 0.092 ms

iter_count = 162, r_2norm = 5.915e-04, tol*||rhs|| = 7.354e-04

Anderson update took 85.768 ms, out of which F'*F took 40.979 ms; b-Ax took 278.837 ms, out of which Lap took 250.178 ms
Solving Poisson took 587.151 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.110738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 17.914 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.114057 
Total time for convolution: 	 convolve: 5.110246 
Total time for convolution: 	 convolve: 5.107682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.286 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 27637.445 ms, scf error = 1.232e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136756, lowerbound = -1.060690, upperbound = 267.581577

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 2015.239 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.730 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.898 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 26.654 ms
rank =  0, finding HY took 34.611 ms
rank =  0, distributing HY into block cyclic form took 22.870 ms
rank =  0, finding Y'*HY took 5.145 ms
Rank 0, Project_Hamiltonian used 89.332 ms
Total time for projection: 89.347 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.212 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -1.060461898120229
    last  calculated eigval = 0.037276197812422
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 34):
lambda[   8] =  -0.45316856191201
lambda[   9] =  -0.43723160421209
lambda[  10] =  -0.41605472172847
lambda[  11] =  -0.41146550524106
lambda[  12] =  -0.39697544785437
lambda[  13] =  -0.34518896324685
lambda[  14] =  -0.31527464272696
lambda[  15] =  -0.30928025344459
lambda[  16] =  -0.30387129996267
lambda[  17] =  -0.24411140308800
lambda[  18] =  -0.11354900691142
lambda[  19] =  -0.02779733017077
lambda[  20] =   0.01397413047861
lambda[  21] =   0.01835835312277
lambda[  22] =   0.02089067723563
lambda[  23] =   0.03177550735884
lambda[  24] =   0.03473342160273
lambda[  25] =   0.03727619781242
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.276 ms
rank =  0, subspace rotation using ScaLAPACK took 9.367 ms
rank =  0, Distributing orbital back into band + domain format took 21.481 ms
rank = 0, Subspace_Rotation used 30.862 ms

Total time for subspace rotation: 30.867 ms
rank = 0, Efermi =  -0.142524699665 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.430 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.551 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 2139.937 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
rank = 0, D2D took 0.730 ms
rank = 0, Transfering density took 0.738 ms
Etot    =   -79.395994015349
Eband   =   -18.882090678261
E1      =    38.013923218476
E2      =   -18.642023154778
E3      =   -24.176710532023
Exc     =   -21.678240211145
Esc     =  -119.668320030482
Entropy =    -0.000000000738
dE = 5.449e-06, dEband = 9.870e-04
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -79.395994015, dEtot = 5.449e-06, dEband = 9.870e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0363619351156, which took 0.098 ms

iter_count = 108, r_2norm = 1.147e-06, tol*||rhs|| = 1.454e-06

Anderson update took 57.337 ms, out of which F'*F took 27.294 ms; b-Ax took 184.461 ms, out of which Lap took 165.179 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.800 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -34.00000002470803, int_rho =  34.00000002470786, int_b + int_rho = -1.746e-13, checking this took 0.109 ms
2-norm of RHS = 735.3951433271459, which took 0.114 ms

iter_count = 132, r_2norm = 6.345e-04, tol*||rhs|| = 7.354e-04

Anderson update took 69.774 ms, out of which F'*F took 33.482 ms; b-Ax took 227.579 ms, out of which Lap took 203.632 ms
Solving Poisson took 479.057 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.152711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.076332 
Total time for convolution: 	 convolve: 5.077944 
Total time for convolution: 	 convolve: 5.076146 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.284 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.964 ms

This SCF took 27456.491 ms, scf error = 9.271e-05
The last 18 occupations of kpoints #1 are (Nelectron = 34):
lambda[   8] =  -0.45316856191201, occ[   8] =   2.00000000000000
lambda[   9] =  -0.43723160421209, occ[   9] =   2.00000000000000
lambda[  10] =  -0.41605472172847, occ[  10] =   2.00000000000000
lambda[  11] =  -0.41146550524106, occ[  11] =   2.00000000000000
lambda[  12] =  -0.39697544785437, occ[  12] =   2.00000000000000
lambda[  13] =  -0.34518896324685, occ[  13] =   2.00000000000000
lambda[  14] =  -0.31527464272696, occ[  14] =   2.00000000000000
lambda[  15] =  -0.30928025344459, occ[  15] =   2.00000000000000
lambda[  16] =  -0.30387129996267, occ[  16] =   2.00000000000000
lambda[  17] =  -0.24411140308800, occ[  17] =   2.00000000000000
lambda[  18] =  -0.11354900691142, occ[  18] =   0.00000002470808
lambda[  19] =  -0.02779733017077, occ[  19] =   0.00000000000000
lambda[  20] =   0.01397413047861, occ[  20] =   0.00000000000000
lambda[  21] =   0.01835835312277, occ[  21] =   0.00000000000000
lambda[  22] =   0.02089067723563, occ[  22] =   0.00000000000000
lambda[  23] =   0.03177550735884, occ[  23] =   0.00000000000000
lambda[  24] =   0.03473342160273, occ[  24] =   0.00000000000000
lambda[  25] =   0.03727619781242, occ[  25] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 23 (90%) = 0.000000000000000.
Occupation of state 25 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.754 ms, time for Allreduce/Reduce: 10.905 ms 
Time for calculating local force components: 23.727 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.26858235337754  -1.08766472199436  -0.00000003183258
  0.26857800132462   1.08765888340533  -0.00000006955430
  1.07605287469078  -0.60381365666722  -0.00000049697595
 -1.07605123737211   0.60380033460473  -0.00000004549123
 -0.05168912427870   0.05197312936602  -0.00000000350719
  0.05168909620094  -0.05197307343623  -0.00000000084817
  0.05877388920444   0.12615338935884   0.00000025591511
 -0.05877166216020  -0.12615039188032  -0.00000009111816
force_loc = 
  0.26259110374420   1.06364617936421   0.00000072447315
 -0.26259057113478  -1.06364219023281   0.00000084059159
 -1.05754424424222   0.59512854160571  -0.00000008646657
  1.05754237077557  -0.59511929242379   0.00000021824554
  0.05639358909786  -0.05547042923010   0.00000011527308
 -0.05639213095245   0.05547025760092  -0.00000005125219
 -0.04812209379586  -0.12628484404320   0.00000213784004
  0.04812416592447   0.12628482905254   0.00000083564440
Time for calculating nonlocal force components: 43.008 ms
[32mforces_xc: 
[0m[32m  0.00672246541946   0.03055942422209  -0.00000000898943
[0m[32m -0.00672249165787  -0.03055947769148  -0.00000000391171
[0m[32m -0.02555706260120   0.01419991031883  -0.00000005704229
[0m[32m  0.02555716779851  -0.01419976837751  -0.00000000324860
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01089782165223  -0.00012572274814   0.00000011248864
[0m[32m  0.01089805886932   0.00012562334415   0.00000005618311
[0mTime for calculating XC forces components: 33.160 ms
 Cartesian force = 
  0.00073096705799   0.00654126490216   0.00000014034911
 -0.00073531019616  -0.00654240120873   0.00000022382354
 -0.00704868088077   0.00551517856754  -0.00000118378685
  0.00704805247385  -0.00551834288634  -0.00000037379633
  0.00470421609104  -0.00349691655386  -0.00000043153614
 -0.00470328347964   0.00349756747492  -0.00000059540240
 -0.00024627497178  -0.00025679412228   0.00000196294175
  0.00025031390547   0.00026044382660   0.00000025740732
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.242 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.120 ms
Time for printing density: 389.896 ms
The program took 404.414 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:26:34
Job ID:        2266453
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:24:24,vmem=8276K,walltime=00:07:02,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-9-1
---------------------------------------
