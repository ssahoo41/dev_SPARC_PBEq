---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:39
Job ID:    2266457
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:46
Job ID:    2266457
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 11.565 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 18.079 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 55.816 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.967 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.394503	    7.432754	   10.000000	
    7.566211	    7.412534	   10.000000	
    9.354824	    6.779829	   10.000000	
    9.995902	   13.220171	   10.000000	
   14.081265	   10.857805	   10.000000	
    5.918735	   10.843721	   10.000000	
    9.977317	   11.176929	   10.000000	
   12.297742	    9.771232	   10.000000	
    7.741873	    9.891418	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.177 ms
Set up communicators.

--set up spincomm took 2.278 ms

--set up kptcomm took 0.341 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 21, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 21 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 21, mbQ = nbQ = 64
rank = 0, nr_Hp = 21, nc_Hp = 21
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.072 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.147 ms

Calculate_SplineDerivRadFun took 0.213 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.812 ms.
time spent on vectorized spline interp: 3.119 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.738 ms.
time spent on vectorized spline interp: 1.342 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.285 ms.
time spent on vectorized spline interp: 1.638 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.333 ms.

Calculating rb for all atom types took 16.278 ms
----------------------
Estimated memory usage
Total: 1.26 GB
orbitals             : 961.30 MB
global sized vectors : 213.62 MB
subspace matrices : 10.34 kB
others : 117.49 MB
----------------------------------------------
Estimated memory usage per processor: 107.70 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.897 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -28.0000000233318, sum_int_rho = 27.5895800003505
PosCharge = 28.000000023332, NegCharge = -27.589580000350, scal_fac = 1.014875906881
After scaling, int_rho = 28.0000000233321, PosCharge + NegCharge - NetCharge = -2.416e-13
--Calculate Vref took 0.598 ms
--Calculate rho_guess took 3.365 ms

 integral of b = -28.0000000233318,
 int{b} + Nelectron + NetCharge = -2.333e-08,
 Esc = -84.8980160972682,
 MPI_Reduce took 9.717 ms

Calculating b & b_ref took 21.318 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.079 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.089 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.109 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.699 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.935 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333190, int_b + int_rho = 1.637e-13, checking this took 0.296 ms
2-norm of RHS = 736.1752080166810, which took 0.528 ms

iter_count = 420, r_2norm = 6.458e-04, tol*||rhs|| = 7.362e-04

Anderson update took 234.650 ms, out of which F'*F took 105.617 ms; b-Ax took 716.458 ms, out of which Lap took 640.556 ms
Solving Poisson took 1522.905 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
Total time for convolution: 	 convolve: 5.160749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
Total time for convolution: 	 convolve: 5.249288 
Total time for convolution: 	 convolve: 5.149446 
Total time for convolution: 	 convolve: 5.124603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.994 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.520 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.409 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
rank = 0, XC calculation took 24568.197 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 4.853 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.133 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.126 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.171 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.678 ms
    Lanczos iter 53, eigmin  = -1.061317490, eigmax = 264.933674411, err_eigmin = 8.731e-04, err_eigmax = 9.543e-03
rank =   0, Lanczos took 122.184 ms, eigmin = -1.061317490111, eigmax = 267.583011155165

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.210847, lowerbound = -1.161317, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1492.950 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 45.581 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.824 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 48.428 ms
rank =  0, finding HY took 25.435 ms
rank =  0, distributing HY into block cyclic form took 20.444 ms
rank =  0, finding Y'*HY took 4.160 ms
Rank 0, Project_Hamiltonian used 98.876 ms
Total time for projection: 98.914 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.273 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 1.373 ms
    first calculated eigval = 2.735220608673685
    last  calculated eigval = 3.266540342128078
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =   2.84787375890033
lambda[   6] =   2.85431921688370
lambda[   7] =   2.89217958919021
lambda[   8] =   2.91367540638049
lambda[   9] =   2.95148946874921
lambda[  10] =   2.98857908627325
lambda[  11] =   3.00702627682479
lambda[  12] =   3.01232150307124
lambda[  13] =   3.02650876380172
lambda[  14] =   3.03501823372295
lambda[  15] =   3.08542276793186
lambda[  16] =   3.13214138467809
lambda[  17] =   3.13470564752531
lambda[  18] =   3.14846186459144
lambda[  19] =   3.18065544305561
lambda[  20] =   3.21736383264306
lambda[  21] =   3.26654034212808
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 1.389 ms
rank =  0, subspace rotation using ScaLAPACK took 8.241 ms
rank =  0, Distributing orbital back into band + domain format took 18.285 ms
rank = 0, Subspace_Rotation used 26.547 ms

Total time for subspace rotation: 26.551 ms
rank = 0, Efermi =   3.060230242548 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.366540, lowerbound = -1.161317, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1440.418 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.023 ms
rank =  0, Distribute orbital to block cyclic format took 66.191 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.569 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 68.829 ms
rank =  0, finding HY took 24.876 ms
rank =  0, distributing HY into block cyclic form took 18.280 ms
rank =  0, finding Y'*HY took 4.049 ms
Rank 0, Project_Hamiltonian used 116.085 ms
Total time for projection: 116.092 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.220 ms
    first calculated eigval = -0.841021170136590
    last  calculated eigval = 0.417555236888391
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.30593337454252
lambda[   6] =  -0.26394238660487
lambda[   7] =  -0.21584866186160
lambda[   8] =  -0.10093523618519
lambda[   9] =  -0.05109054077451
lambda[  10] =   0.03655970127385
lambda[  11] =   0.11512286525715
lambda[  12] =   0.13987574269185
lambda[  13] =   0.19434486142493
lambda[  14] =   0.25129228110206
lambda[  15] =   0.28487149600650
lambda[  16] =   0.33000261607553
lambda[  17] =   0.33821408009001
lambda[  18] =   0.35395790870356
lambda[  19] =   0.35864868325704
lambda[  20] =   0.39846177895173
lambda[  21] =   0.41755523688839
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.176 ms
rank =  0, Distributing orbital back into band + domain format took 18.294 ms
rank = 0, Subspace_Rotation used 26.490 ms

Total time for subspace rotation: 26.494 ms
rank = 0, Efermi =   0.268081902582 calculate fermi energy took 0.019 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.517555, lowerbound = -1.161317, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1434.451 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 70.914 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.562 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 73.492 ms
rank =  0, finding HY took 24.995 ms
rank =  0, distributing HY into block cyclic form took 18.267 ms
rank =  0, finding Y'*HY took 4.084 ms
Rank 0, Project_Hamiltonian used 121.437 ms
Total time for projection: 121.443 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -1.071184779970359
    last  calculated eigval = 0.145953650521343
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.62587476159149
lambda[   6] =  -0.56910095705249
lambda[   7] =  -0.52718948167739
lambda[   8] =  -0.48234013377857
lambda[   9] =  -0.47520497663849
lambda[  10] =  -0.44245287025683
lambda[  11] =  -0.40687141187034
lambda[  12] =  -0.39756867964636
lambda[  13] =  -0.29632887037817
lambda[  14] =  -0.28035443465356
lambda[  15] =  -0.14072499600372
lambda[  16] =   0.03077210226514
lambda[  17] =   0.05623244781667
lambda[  18] =   0.08138394573304
lambda[  19] =   0.10669322311184
lambda[  20] =   0.11785477841309
lambda[  21] =   0.14595365052134
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 8.157 ms
rank =  0, Distributing orbital back into band + domain format took 18.242 ms
rank = 0, Subspace_Rotation used 26.421 ms

Total time for subspace rotation: 26.425 ms
rank = 0, Efermi =  -0.169752485444 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.245954, lowerbound = -1.161317, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1427.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 73.135 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.497 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 75.655 ms
rank =  0, finding HY took 24.993 ms
rank =  0, distributing HY into block cyclic form took 18.306 ms
rank =  0, finding Y'*HY took 4.046 ms
Rank 0, Project_Hamiltonian used 123.030 ms
Total time for projection: 123.036 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -1.071649111503824
    last  calculated eigval = 0.092339085511648
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.62978796143917
lambda[   6] =  -0.57055003147221
lambda[   7] =  -0.52902340101674
lambda[   8] =  -0.48750703512315
lambda[   9] =  -0.48071377507009
lambda[  10] =  -0.45112389272981
lambda[  11] =  -0.42348947667067
lambda[  12] =  -0.40984244676871
lambda[  13] =  -0.31531691958308
lambda[  14] =  -0.31469792845272
lambda[  15] =  -0.16141413553839
lambda[  16] =  -0.02993101611095
lambda[  17] =  -0.00266538704714
lambda[  18] =   0.03569948828359
lambda[  19] =   0.05255357232020
lambda[  20] =   0.07083918204363
lambda[  21] =   0.09233908551165
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 8.183 ms
rank =  0, Distributing orbital back into band + domain format took 18.335 ms
rank = 0, Subspace_Rotation used 27.410 ms

Total time for subspace rotation: 27.417 ms
rank = 0, Efermi =  -0.190441624929 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 5.276 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.208 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.587 ms
rank = 0, Calculating density took 6506.907 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.931 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -53.612817592723
Eband   =   -16.499634045049
E1      =    32.135207909335
E2      =   -13.864518088436
E3      =   -17.425334499706
Exc     =   -15.640227947186
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 5.957e+00, dEband = 1.833e+00
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -53.612817593, dEtot = 5.957e+00, dEband = 1.833e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.3418015770645, which took 1.237 ms

iter_count = 96, r_2norm = 1.558e-03, tol*||rhs|| = 2.454e-03

Anderson update took 51.551 ms, out of which F'*F took 23.965 ms; b-Ax took 163.477 ms, out of which Lap took 146.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.129 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333210, int_b + int_rho = 3.602e-13, checking this took 0.107 ms
2-norm of RHS = 731.9651694873035, which took 0.118 ms

iter_count = 282, r_2norm = 6.744e-04, tol*||rhs|| = 7.320e-04

Anderson update took 150.481 ms, out of which F'*F took 72.029 ms; b-Ax took 488.320 ms, out of which Lap took 437.802 ms
Solving Poisson took 1023.603 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.382 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.291476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.313970 
Total time for convolution: 	 convolve: 5.207557 
Total time for convolution: 	 convolve: 5.263026 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.203 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.135 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.508 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.227 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.775 ms

This SCF took 32960.569 ms, scf error = 1.449e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.192339, lowerbound = -1.071649, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1503.138 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.477 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.517 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.014 ms
rank =  0, finding HY took 25.256 ms
rank =  0, distributing HY into block cyclic form took 18.864 ms
rank =  0, finding Y'*HY took 4.053 ms
Rank 0, Project_Hamiltonian used 69.226 ms
Total time for projection: 69.237 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -1.051027185038446
    last  calculated eigval = 0.063792387218919
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.60860739199833
lambda[   6] =  -0.53944601692682
lambda[   7] =  -0.49996857090125
lambda[   8] =  -0.46403977809118
lambda[   9] =  -0.45089029533071
lambda[  10] =  -0.43108262201909
lambda[  11] =  -0.39561614028094
lambda[  12] =  -0.38894814755687
lambda[  13] =  -0.28471877968235
lambda[  14] =  -0.28361127296919
lambda[  15] =  -0.14450001841638
lambda[  16] =  -0.02628632499455
lambda[  17] =  -0.02333252442477
lambda[  18] =   0.01698484171133
lambda[  19] =   0.03091492545322
lambda[  20] =   0.04560601103806
lambda[  21] =   0.06379238721892
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 8.700 ms
rank =  0, Distributing orbital back into band + domain format took 18.301 ms
rank = 0, Subspace_Rotation used 27.033 ms

Total time for subspace rotation: 27.039 ms
rank = 0, Efermi =  -0.173527507770 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.370 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1616.840 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.819 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -53.554038245606
Eband   =   -15.743646996308
E1      =    31.492402088291
E2      =   -13.770403725061
E3      =   -17.625526396784
Exc     =   -15.800707361467
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 6.531e-03, dEband = 8.400e-02
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -53.554038246, dEtot = 6.531e-03, dEband = 8.400e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 23.7744764237820, which took 0.049 ms

iter_count = 102, r_2norm = 6.067e-04, tol*||rhs|| = 9.510e-04

Anderson update took 54.096 ms, out of which F'*F took 25.398 ms; b-Ax took 173.024 ms, out of which Lap took 154.565 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333203, int_b + int_rho = 2.910e-13, checking this took 0.134 ms
2-norm of RHS = 727.7176263210522, which took 0.124 ms

iter_count = 294, r_2norm = 6.375e-04, tol*||rhs|| = 7.277e-04

Anderson update took 155.516 ms, out of which F'*F took 72.899 ms; b-Ax took 500.328 ms, out of which Lap took 444.987 ms
Solving Poisson took 1058.757 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.184547 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
Total time for convolution: 	 convolve: 5.173517 
Total time for convolution: 	 convolve: 5.198914 
Total time for convolution: 	 convolve: 5.199332 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.168 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.246 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.793 ms

This SCF took 28000.240 ms, scf error = 9.652e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163792, lowerbound = -1.051027, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1486.222 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.712 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.010 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.743 ms
rank =  0, finding HY took 25.741 ms
rank =  0, distributing HY into block cyclic form took 18.610 ms
rank =  0, finding Y'*HY took 4.218 ms
Rank 0, Project_Hamiltonian used 70.355 ms
Total time for projection: 70.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.224 ms
    first calculated eigval = -1.021698745056867
    last  calculated eigval = 0.051468469851020
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.57156989532574
lambda[   6] =  -0.49402480553140
lambda[   7] =  -0.45391816967716
lambda[   8] =  -0.42375676970259
lambda[   9] =  -0.40943825833033
lambda[  10] =  -0.40184113481811
lambda[  11] =  -0.36089178258902
lambda[  12] =  -0.35369514638877
lambda[  13] =  -0.24468099005653
lambda[  14] =  -0.24353523060510
lambda[  15] =  -0.11459982184116
lambda[  16] =  -0.02955349311342
lambda[  17] =   0.00551048668218
lambda[  18] =   0.01175366290662
lambda[  19] =   0.02315792897787
lambda[  20] =   0.03373642496024
lambda[  21] =   0.05146846985102
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 8.661 ms
rank =  0, Distributing orbital back into band + domain format took 18.189 ms
rank = 0, Subspace_Rotation used 26.868 ms

Total time for subspace rotation: 26.874 ms
rank = 0, Efermi =  -0.143627311232 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 5.373 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.695 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.599 ms
rank = 0, Calculating density took 1600.932 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.837 ms
rank = 0, D2D took 1.946 ms
rank = 0, Transfering density took 1.953 ms
Etot    =   -53.512609108334
Eband   =   -14.634031927785
E1      =    30.580496009101
E2      =   -13.550447524150
E3      =   -17.945435250012
Exc     =   -16.056939865846
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 4.603e-03, dEband = 1.233e-01
rank = 0, Calculating/Estimating energy took 0.931 ms, Etot = -53.512609108, dEtot = 4.603e-03, dEband = 1.233e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.7183242373124, which took 0.099 ms

iter_count = 102, r_2norm = 2.189e-04, tol*||rhs|| = 2.687e-04

Anderson update took 54.648 ms, out of which F'*F took 25.558 ms; b-Ax took 173.213 ms, out of which Lap took 154.699 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.179 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333210, int_b + int_rho = 3.638e-13, checking this took 0.106 ms
2-norm of RHS = 728.1065614925891, which took 0.094 ms

iter_count = 276, r_2norm = 6.444e-04, tol*||rhs|| = 7.281e-04

Anderson update took 146.767 ms, out of which F'*F took 72.128 ms; b-Ax took 471.409 ms, out of which Lap took 421.851 ms
Solving Poisson took 994.916 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.216609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.182136 
Total time for convolution: 	 convolve: 5.179438 
Total time for convolution: 	 convolve: 5.191857 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.519 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.222 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.770 ms

This SCF took 27776.159 ms, scf error = 3.501e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151468, lowerbound = -1.021699, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1480.847 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 18.734 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.706 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.458 ms
rank =  0, finding HY took 25.009 ms
rank =  0, distributing HY into block cyclic form took 18.384 ms
rank =  0, finding Y'*HY took 4.066 ms
Rank 0, Project_Hamiltonian used 68.959 ms
Total time for projection: 68.980 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.645 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.235 ms
rank = 0, Solve_Generalized_EigenProblem used 0.889 ms
    first calculated eigval = -1.012173536198908
    last  calculated eigval = 0.043668060726006
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55668319744153
lambda[   6] =  -0.47826216073073
lambda[   7] =  -0.43845968940268
lambda[   8] =  -0.40831215211729
lambda[   9] =  -0.39538634285884
lambda[  10] =  -0.39217065380497
lambda[  11] =  -0.35232732256278
lambda[  12] =  -0.34093484714628
lambda[  13] =  -0.23495574087479
lambda[  14] =  -0.23273292237810
lambda[  15] =  -0.10290204617665
lambda[  16] =  -0.03022802471182
lambda[  17] =   0.01037007114750
lambda[  18] =   0.01539952679222
lambda[  19] =   0.01984500795981
lambda[  20] =   0.02605510337479
lambda[  21] =   0.04366806072601
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.903 ms
rank =  0, subspace rotation using ScaLAPACK took 8.084 ms
rank =  0, Distributing orbital back into band + domain format took 18.182 ms
rank = 0, Subspace_Rotation used 26.285 ms

Total time for subspace rotation: 26.290 ms
rank = 0, Efermi =  -0.131929535555 calculate fermi energy took 0.130 ms
rank = 0, --- Calculate rho: sum over local bands took 5.279 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.629 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.629 ms
rank = 0, Calculating density took 1595.600 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.000 ms
rank = 0, D2D took 2.108 ms
rank = 0, Transfering density took 2.116 ms
Etot    =   -53.507718574446
Eband   =   -14.272774614796
E1      =    30.332985148960
E2      =   -13.417627167768
E3      =   -18.053583363507
Exc     =   -16.141123541918
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 5.434e-04, dEband = 4.014e-02
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -53.507718574, dEtot = 5.434e-04, dEband = 4.014e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3128454544841, which took 0.058 ms

iter_count = 108, r_2norm = 6.788e-05, tol*||rhs|| = 9.251e-05

Anderson update took 57.253 ms, out of which F'*F took 26.878 ms; b-Ax took 181.625 ms, out of which Lap took 162.586 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.040 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333202, int_b + int_rho = 2.765e-13, checking this took 0.134 ms
2-norm of RHS = 728.9993384904094, which took 0.140 ms

iter_count = 258, r_2norm = 6.543e-04, tol*||rhs|| = 7.290e-04

Anderson update took 136.601 ms, out of which F'*F took 63.781 ms; b-Ax took 434.734 ms, out of which Lap took 387.708 ms
Solving Poisson took 923.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.177330 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.689 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.218118 
Total time for convolution: 	 convolve: 5.203837 
Total time for convolution: 	 convolve: 5.183375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.531 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.571 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.136 ms

This SCF took 27764.410 ms, scf error = 1.262e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.143668, lowerbound = -1.012174, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.316 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.377 ms
rank =  0, finding HY took 24.234 ms
rank =  0, distributing HY into block cyclic form took 18.339 ms
rank =  0, finding Y'*HY took 4.171 ms
Rank 0, Project_Hamiltonian used 70.163 ms
Total time for projection: 70.183 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -1.007833828745341
    last  calculated eigval = 0.037477922403217
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.55135083656045
lambda[   6] =  -0.47307294463957
lambda[   7] =  -0.43285394552563
lambda[   8] =  -0.40244747251489
lambda[   9] =  -0.38912610790863
lambda[  10] =  -0.38824860030585
lambda[  11] =  -0.34735326087261
lambda[  12] =  -0.33617579044198
lambda[  13] =  -0.23180140389865
lambda[  14] =  -0.22624965883252
lambda[  15] =  -0.09862525431310
lambda[  16] =  -0.03021224296913
lambda[  17] =   0.01012114524730
lambda[  18] =   0.01728449610044
lambda[  19] =   0.01857688965319
lambda[  20] =   0.02156620985178
lambda[  21] =   0.03747792240322
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 8.152 ms
rank =  0, Distributing orbital back into band + domain format took 18.301 ms
rank = 0, Subspace_Rotation used 26.472 ms

Total time for subspace rotation: 26.478 ms
rank = 0, Efermi =  -0.127652743686 calculate fermi energy took 0.607 ms
rank = 0, --- Calculate rho: sum over local bands took 5.217 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.785 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.559 ms
rank = 0, Calculating density took 1591.488 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.843 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.955 ms
Etot    =   -53.506727874502
Eband   =   -14.129600177464
E1      =    30.269751460431
E2      =   -13.328048879858
E3      =   -18.090464555112
Exc     =   -16.167376494474
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 1.101e-04, dEband = 1.591e-02
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -53.506727875, dEtot = 1.101e-04, dEband = 1.591e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.2472104486162, which took 0.058 ms

iter_count = 108, r_2norm = 3.929e-05, tol*||rhs|| = 4.989e-05

Anderson update took 57.518 ms, out of which F'*F took 26.816 ms; b-Ax took 183.076 ms, out of which Lap took 163.620 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.187 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333211, int_b + int_rho = 3.674e-13, checking this took 0.128 ms
2-norm of RHS = 729.3512413990144, which took 0.136 ms

iter_count = 234, r_2norm = 6.101e-04, tol*||rhs|| = 7.294e-04

Anderson update took 123.815 ms, out of which F'*F took 58.330 ms; b-Ax took 395.833 ms, out of which Lap took 354.000 ms
Solving Poisson took 840.061 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.125 ms
Total time for convolution: 	 convolve: 5.344510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.192575 
Total time for convolution: 	 convolve: 5.188225 
Total time for convolution: 	 convolve: 5.182885 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.189 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.042 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.631 ms

This SCF took 27756.707 ms, scf error = 4.659e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.137478, lowerbound = -1.007834, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1478.501 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 18.569 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.658 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.244 ms
rank =  0, finding HY took 25.132 ms
rank =  0, distributing HY into block cyclic form took 18.515 ms
rank =  0, finding Y'*HY took 4.393 ms
Rank 0, Project_Hamiltonian used 69.322 ms
Total time for projection: 69.340 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.221 ms
    first calculated eigval = -1.005919359783610
    last  calculated eigval = 0.033394257771284
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54998709658172
lambda[   6] =  -0.47171405877428
lambda[   7] =  -0.43150675112789
lambda[   8] =  -0.40119175211298
lambda[   9] =  -0.38788496479679
lambda[  10] =  -0.38682172883767
lambda[  11] =  -0.34591873073011
lambda[  12] =  -0.33460599837389
lambda[  13] =  -0.23041746790851
lambda[  14] =  -0.22486888119095
lambda[  15] =  -0.09764273361061
lambda[  16] =  -0.03013751488456
lambda[  17] =   0.00988587153247
lambda[  18] =   0.01714044740158
lambda[  19] =   0.01770162213876
lambda[  20] =   0.01984155768406
lambda[  21] =   0.03339425777128
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 8.096 ms
rank =  0, Distributing orbital back into band + domain format took 18.166 ms
rank = 0, Subspace_Rotation used 26.282 ms

Total time for subspace rotation: 26.286 ms
rank = 0, Efermi =  -0.126670222989 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.270 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.773 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1591.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.819 ms
rank = 0, D2D took 1.920 ms
rank = 0, Transfering density took 1.926 ms
Etot    =   -53.506563071363
Eband   =   -14.090874619619
E1      =    30.261319037910
E2      =   -13.296064512579
E3      =   -18.093842255998
Exc     =   -16.168898160265
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 1.831e-05, dEband = 4.303e-03
rank = 0, Calculating/Estimating energy took 0.954 ms, Etot = -53.506563071, dEtot = 1.831e-05, dEband = 4.303e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5988500641235, which took 0.068 ms

iter_count = 108, r_2norm = 2.185e-05, tol*||rhs|| = 2.395e-05

Anderson update took 57.251 ms, out of which F'*F took 26.987 ms; b-Ax took 185.060 ms, out of which Lap took 165.826 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.777 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333201, int_b + int_rho = 2.656e-13, checking this took 0.098 ms
2-norm of RHS = 729.5393337377669, which took 0.143 ms

iter_count = 228, r_2norm = 6.805e-04, tol*||rhs|| = 7.295e-04

Anderson update took 120.106 ms, out of which F'*F took 56.172 ms; b-Ax took 388.249 ms, out of which Lap took 345.523 ms
Solving Poisson took 819.813 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.715 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.184575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.599 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.184971 
Total time for convolution: 	 convolve: 5.174459 
Total time for convolution: 	 convolve: 5.195235 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.076 ms
---Transfer Veff_loc: D2D took 4.511 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.085 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.632 ms

This SCF took 27594.744 ms, scf error = 2.631e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.133394, lowerbound = -1.005919, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1482.171 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.316 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.609 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.946 ms
rank =  0, finding HY took 25.202 ms
rank =  0, distributing HY into block cyclic form took 18.305 ms
rank =  0, finding Y'*HY took 3.973 ms
Rank 0, Project_Hamiltonian used 68.469 ms
Total time for projection: 68.480 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.135 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -1.003737773291707
    last  calculated eigval = 0.030901808324755
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54783135820974
lambda[   6] =  -0.46952622996654
lambda[   7] =  -0.42926322135651
lambda[   8] =  -0.39909196032782
lambda[   9] =  -0.38576943625751
lambda[  10] =  -0.38485340754924
lambda[  11] =  -0.34395748989770
lambda[  12] =  -0.33237800939831
lambda[  13] =  -0.22833229824414
lambda[  14] =  -0.22271546632254
lambda[  15] =  -0.09584713978553
lambda[  16] =  -0.02971332523852
lambda[  17] =   0.01007388107774
lambda[  18] =   0.01690150132692
lambda[  19] =   0.01776826306021
lambda[  20] =   0.02079922107546
lambda[  21] =   0.03090180832476
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.292 ms
rank =  0, subspace rotation using ScaLAPACK took 8.067 ms
rank =  0, Distributing orbital back into band + domain format took 18.274 ms
rank = 0, Subspace_Rotation used 26.358 ms

Total time for subspace rotation: 26.363 ms
rank = 0, Efermi =  -0.124874629104 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 5.266 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.794 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1594.097 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.963 ms
Etot    =   -53.506443741474
Eband   =   -14.030885307431
E1      =    30.232615202252
E2      =   -13.262127795244
E3      =   -18.103221952822
Exc     =   -16.175507286395
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 1.326e-05, dEband = 6.665e-03
rank = 0, Calculating/Estimating energy took 0.927 ms, Etot = -53.506443741, dEtot = 1.326e-05, dEband = 6.665e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2629613677841, which took 0.062 ms

iter_count = 114, r_2norm = 6.987e-06, tol*||rhs|| = 1.052e-05

Anderson update took 60.848 ms, out of which F'*F took 28.191 ms; b-Ax took 194.478 ms, out of which Lap took 174.427 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.948 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333194, int_b + int_rho = 2.001e-13, checking this took 0.143 ms
2-norm of RHS = 729.6492930227314, which took 0.133 ms

iter_count = 234, r_2norm = 6.310e-04, tol*||rhs|| = 7.296e-04

Anderson update took 123.697 ms, out of which F'*F took 58.384 ms; b-Ax took 396.362 ms, out of which Lap took 354.237 ms
Solving Poisson took 840.135 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.196357 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.820 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.191550 
Total time for convolution: 	 convolve: 5.210477 
Total time for convolution: 	 convolve: 5.211461 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.523 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.615 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.517 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.418 ms
---Transfer Veff_loc: D2D took 3.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.061 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.632 ms

This SCF took 27773.331 ms, scf error = 1.674e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130902, lowerbound = -1.003738, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1482.958 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.221 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.676 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.911 ms
rank =  0, finding HY took 25.012 ms
rank =  0, distributing HY into block cyclic form took 18.301 ms
rank =  0, finding Y'*HY took 4.030 ms
Rank 0, Project_Hamiltonian used 68.281 ms
Total time for projection: 68.291 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -1.001236635795580
    last  calculated eigval = 0.029739172999744
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54529486846420
lambda[   6] =  -0.46707016317475
lambda[   7] =  -0.42669191714678
lambda[   8] =  -0.39659235469825
lambda[   9] =  -0.38325149702170
lambda[  10] =  -0.38242330229983
lambda[  11] =  -0.34145905678419
lambda[  12] =  -0.32987646480422
lambda[  13] =  -0.22587300765932
lambda[  14] =  -0.22007344948022
lambda[  15] =  -0.09346000658950
lambda[  16] =  -0.02846737063253
lambda[  17] =   0.01121298362425
lambda[  18] =   0.01777003356727
lambda[  19] =   0.01912362482249
lambda[  20] =   0.02285153138498
lambda[  21] =   0.02973917299974
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 8.095 ms
rank =  0, Distributing orbital back into band + domain format took 18.506 ms
rank = 0, Subspace_Rotation used 26.618 ms

Total time for subspace rotation: 26.625 ms
rank = 0, Efermi =  -0.122487496066 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.056 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.075 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.582 ms
rank = 0, Calculating density took 1594.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.938 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -53.506457685524
Eband   =   -13.959707717451
E1      =    30.197441974646
E2      =   -13.223827521339
E3      =   -18.111159398698
Exc     =   -16.181162764789
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 1.549e-06, dEband = 7.909e-03
rank = 0, Calculating/Estimating energy took 1.421 ms, Etot = -53.506457686, dEtot = 1.549e-06, dEband = 7.909e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1648637938364, which took 0.052 ms

iter_count = 114, r_2norm = 4.351e-06, tol*||rhs|| = 6.595e-06

Anderson update took 60.567 ms, out of which F'*F took 28.257 ms; b-Ax took 193.036 ms, out of which Lap took 172.818 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333222, int_b + int_rho = 4.839e-13, checking this took 0.099 ms
2-norm of RHS = 729.6585888074111, which took 0.137 ms

iter_count = 216, r_2norm = 6.176e-04, tol*||rhs|| = 7.297e-04

Anderson update took 114.871 ms, out of which F'*F took 54.410 ms; b-Ax took 365.787 ms, out of which Lap took 329.329 ms
Solving Poisson took 773.685 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.228092 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.310408 
Total time for convolution: 	 convolve: 5.275008 
Total time for convolution: 	 convolve: 5.248281 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.147 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.111 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.704 ms

This SCF took 27858.423 ms, scf error = 8.985e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129739, lowerbound = -1.001237, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1475.113 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.253 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.598 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.883 ms
rank =  0, finding HY took 25.041 ms
rank =  0, distributing HY into block cyclic form took 18.286 ms
rank =  0, finding Y'*HY took 4.002 ms
Rank 0, Project_Hamiltonian used 68.248 ms
Total time for projection: 68.260 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.222 ms
    first calculated eigval = -0.999648325698175
    last  calculated eigval = 0.029837605580388
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54374261150725
lambda[   6] =  -0.46561573889675
lambda[   7] =  -0.42517407158106
lambda[   8] =  -0.39505217323301
lambda[   9] =  -0.38171528852182
lambda[  10] =  -0.38093520340201
lambda[  11] =  -0.33988061940725
lambda[  12] =  -0.32835463346865
lambda[  13] =  -0.22448401048346
lambda[  14] =  -0.21847507195221
lambda[  15] =  -0.09196474637664
lambda[  16] =  -0.02684218144720
lambda[  17] =   0.01280319616020
lambda[  18] =   0.01934960407027
lambda[  19] =   0.02094044201185
lambda[  20] =   0.02422770442286
lambda[  21] =   0.02983760558039
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.250 ms
rank =  0, subspace rotation using ScaLAPACK took 8.090 ms
rank =  0, Distributing orbital back into band + domain format took 18.163 ms
rank = 0, Subspace_Rotation used 26.278 ms

Total time for subspace rotation: 26.284 ms
rank = 0, Efermi =  -0.120992235781 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.290 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.755 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1586.678 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.891 ms
rank = 0, D2D took 2.996 ms
rank = 0, Transfering density took 3.006 ms
Etot    =   -53.506503775097
Eband   =   -13.916916705153
E1      =    30.175741310061
E2      =   -13.201658481201
E3      =   -18.115227756923
Exc     =   -16.184198520163
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 5.121e-06, dEband = 4.755e-03
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -53.506503775, dEtot = 5.121e-06, dEband = 4.755e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1222330082853, which took 0.059 ms

iter_count = 108, r_2norm = 3.902e-06, tol*||rhs|| = 4.889e-06

Anderson update took 57.491 ms, out of which F'*F took 26.864 ms; b-Ax took 183.708 ms, out of which Lap took 164.525 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.092 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333206, int_b + int_rho = 3.201e-13, checking this took 0.102 ms
2-norm of RHS = 729.6376921243728, which took 0.128 ms

iter_count = 210, r_2norm = 6.247e-04, tol*||rhs|| = 7.296e-04

Anderson update took 113.796 ms, out of which F'*F took 65.528 ms; b-Ax took 369.151 ms, out of which Lap took 333.255 ms
Solving Poisson took 767.836 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.192306 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.200572 
Total time for convolution: 	 convolve: 5.193005 
Total time for convolution: 	 convolve: 5.172492 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.546 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.283 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.864 ms

This SCF took 27517.241 ms, scf error = 5.791e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129838, lowerbound = -0.999648, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1477.910 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 18.313 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.898 ms
rank =  0, finding HY took 25.013 ms
rank =  0, distributing HY into block cyclic form took 18.500 ms
rank =  0, finding Y'*HY took 4.013 ms
Rank 0, Project_Hamiltonian used 68.450 ms
Total time for projection: 68.461 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.998460492897549
    last  calculated eigval = 0.031161524761353
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54254189929552
lambda[   6] =  -0.46445551689139
lambda[   7] =  -0.42397087908694
lambda[   8] =  -0.39389323639063
lambda[   9] =  -0.38052646174494
lambda[  10] =  -0.37974903541123
lambda[  11] =  -0.33866798513054
lambda[  12] =  -0.32717849428590
lambda[  13] =  -0.22326264656263
lambda[  14] =  -0.21724022330292
lambda[  15] =  -0.09076113436918
lambda[  16] =  -0.02386299584460
lambda[  17] =   0.01593306644315
lambda[  18] =   0.02254424836014
lambda[  19] =   0.02430266647040
lambda[  20] =   0.02566101624326
lambda[  21] =   0.03116152476135
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.226 ms
rank =  0, Distributing orbital back into band + domain format took 18.224 ms
rank = 0, Subspace_Rotation used 26.468 ms

Total time for subspace rotation: 26.472 ms
rank = 0, Efermi =  -0.119788623733 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.790 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.809 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1589.884 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.857 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.964 ms
Etot    =   -53.506550231669
Eband   =   -13.883377445179
E1      =    30.158994731422
E2      =   -13.184511311306
E3      =   -18.116906818664
Exc     =   -16.185569549916
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 5.162e-06, dEband = 3.727e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -53.506550232, dEtot = 5.162e-06, dEband = 3.727e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0675833765567, which took 0.060 ms

iter_count = 114, r_2norm = 1.905e-06, tol*||rhs|| = 2.703e-06

Anderson update took 60.654 ms, out of which F'*F took 28.259 ms; b-Ax took 193.920 ms, out of which Lap took 173.187 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.909 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333211, int_b + int_rho = 3.747e-13, checking this took 0.105 ms
2-norm of RHS = 729.6471702739772, which took 0.103 ms

iter_count = 174, r_2norm = 6.357e-04, tol*||rhs|| = 7.296e-04

Anderson update took 92.592 ms, out of which F'*F took 43.556 ms; b-Ax took 295.162 ms, out of which Lap took 264.897 ms
Solving Poisson took 624.153 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.201976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.176364 
Total time for convolution: 	 convolve: 5.175895 
Total time for convolution: 	 convolve: 5.178758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.558 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.031 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.623 ms

This SCF took 27398.100 ms, scf error = 3.366e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131162, lowerbound = -0.998460, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1480.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.309 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.563 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.884 ms
rank =  0, finding HY took 25.053 ms
rank =  0, distributing HY into block cyclic form took 18.306 ms
rank =  0, finding Y'*HY took 3.997 ms
Rank 0, Project_Hamiltonian used 68.266 ms
Total time for projection: 68.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.209 ms
    first calculated eigval = -0.998046699991557
    last  calculated eigval = 0.031662924630162
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54213381560849
lambda[   6] =  -0.46406518251185
lambda[   7] =  -0.42357793970116
lambda[   8] =  -0.39349605170428
lambda[   9] =  -0.38013398229370
lambda[  10] =  -0.37935922759299
lambda[  11] =  -0.33827551437531
lambda[  12] =  -0.32679522921232
lambda[  13] =  -0.22289823408958
lambda[  14] =  -0.21685063287426
lambda[  15] =  -0.09036642502202
lambda[  16] =  -0.02252701657201
lambda[  17] =   0.01729762665007
lambda[  18] =   0.02387653445248
lambda[  19] =   0.02573855939495
lambda[  20] =   0.02619751261353
lambda[  21] =   0.03166292463016
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 8.618 ms
rank =  0, Distributing orbital back into band + domain format took 18.070 ms
rank = 0, Subspace_Rotation used 26.703 ms

Total time for subspace rotation: 26.724 ms
rank = 0, Efermi =  -0.119393914509 calculate fermi energy took 0.097 ms
rank = 0, --- Calculate rho: sum over local bands took 5.404 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.587 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1593.179 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.840 ms
rank = 0, D2D took 1.945 ms
rank = 0, Transfering density took 1.950 ms
Etot    =   -53.506566510878
Eband   =   -13.872389860820
E1      =    30.153653791951
E2      =   -13.178649224688
E3      =   -18.117805131114
Exc     =   -16.186268699844
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 1.809e-06, dEband = 1.221e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -53.506566511, dEtot = 1.809e-06, dEband = 1.221e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0548466047898, which took 0.060 ms

iter_count = 114, r_2norm = 1.429e-06, tol*||rhs|| = 2.194e-06

Anderson update took 60.408 ms, out of which F'*F took 28.199 ms; b-Ax took 194.064 ms, out of which Lap took 173.674 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.283 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333200, int_b + int_rho = 2.583e-13, checking this took 0.112 ms
2-norm of RHS = 729.6518085218347, which took 0.139 ms

iter_count = 162, r_2norm = 6.470e-04, tol*||rhs|| = 7.297e-04

Anderson update took 86.391 ms, out of which F'*F took 40.736 ms; b-Ax took 274.280 ms, out of which Lap took 246.199 ms
Solving Poisson took 581.562 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.189714 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.506 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.183497 
Total time for convolution: 	 convolve: 5.191854 
Total time for convolution: 	 convolve: 5.174636 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.554 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
---Transfer Veff_loc: D2D took 3.604 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.280 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.920 ms

This SCF took 27342.970 ms, scf error = 2.559e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131663, lowerbound = -0.998047, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1480.017 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.486 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.617 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.117 ms
rank =  0, finding HY took 25.117 ms
rank =  0, distributing HY into block cyclic form took 18.310 ms
rank =  0, finding Y'*HY took 3.983 ms
Rank 0, Project_Hamiltonian used 68.555 ms
Total time for projection: 68.566 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.997661554088630
    last  calculated eigval = 0.032271096553778
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54177244450908
lambda[   6] =  -0.46371830554681
lambda[   7] =  -0.42323097430115
lambda[   8] =  -0.39315308496653
lambda[   9] =  -0.37979584516429
lambda[  10] =  -0.37899450141603
lambda[  11] =  -0.33792007693393
lambda[  12] =  -0.32645098740037
lambda[  13] =  -0.22254391630119
lambda[  14] =  -0.21651109526709
lambda[  15] =  -0.09001590889955
lambda[  16] =  -0.02127215968581
lambda[  17] =   0.01850394277741
lambda[  18] =   0.02499956434067
lambda[  19] =   0.02645673565129
lambda[  20] =   0.02727603555552
lambda[  21] =   0.03227109655378
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.231 ms
rank =  0, subspace rotation using ScaLAPACK took 8.655 ms
rank =  0, Distributing orbital back into band + domain format took 18.123 ms
rank = 0, Subspace_Rotation used 26.800 ms

Total time for subspace rotation: 26.807 ms
rank = 0, Efermi =  -0.119043398191 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.386 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1592.725 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -53.506607763038
Eband   =   -13.862479737794
E1      =    30.148680496199
E2      =   -13.173560960409
E3      =   -18.118408871167
Exc     =   -16.186762255053
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 4.584e-06, dEband = 1.101e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -53.506607763, dEtot = 4.584e-06, dEband = 1.101e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0357722902815, which took 0.066 ms

iter_count = 108, r_2norm = 1.384e-06, tol*||rhs|| = 1.431e-06

Anderson update took 57.411 ms, out of which F'*F took 27.061 ms; b-Ax took 184.204 ms, out of which Lap took 164.593 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.958 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333209, int_b + int_rho = 3.529e-13, checking this took 0.123 ms
2-norm of RHS = 729.6637424759311, which took 0.113 ms

iter_count = 168, r_2norm = 6.139e-04, tol*||rhs|| = 7.297e-04

Anderson update took 89.570 ms, out of which F'*F took 42.547 ms; b-Ax took 284.889 ms, out of which Lap took 256.135 ms
Solving Poisson took 604.256 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.196286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.259 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.215683 
Total time for convolution: 	 convolve: 5.204162 
Total time for convolution: 	 convolve: 5.201706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.597 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.032 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.590 ms

This SCF took 27424.082 ms, scf error = 1.893e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132271, lowerbound = -0.997662, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1481.914 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 18.244 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.655 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 20.913 ms
rank =  0, finding HY took 24.966 ms
rank =  0, distributing HY into block cyclic form took 18.283 ms
rank =  0, finding Y'*HY took 4.035 ms
Rank 0, Project_Hamiltonian used 68.222 ms
Total time for projection: 68.232 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.613 ms
rank = 0, Solve_Generalized_EigenProblem used 1.126 ms
    first calculated eigval = -0.997228676803321
    last  calculated eigval = 0.033462634212535
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54135665399534
lambda[   6] =  -0.46332142023655
lambda[   7] =  -0.42283193789546
lambda[   8] =  -0.39275874902529
lambda[   9] =  -0.37940292735001
lambda[  10] =  -0.37857570040057
lambda[  11] =  -0.33750635474362
lambda[  12] =  -0.32605580557956
lambda[  13] =  -0.22213787423289
lambda[  14] =  -0.21611830152478
lambda[  15] =  -0.08961196348453
lambda[  16] =  -0.01891246775822
lambda[  17] =   0.02054975089449
lambda[  18] =   0.02689026949291
lambda[  19] =   0.02712157451477
lambda[  20] =   0.03012789293578
lambda[  21] =   0.03346263421253
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 1.156 ms
rank =  0, subspace rotation using ScaLAPACK took 8.096 ms
rank =  0, Distributing orbital back into band + domain format took 18.101 ms
rank = 0, Subspace_Rotation used 26.210 ms

Total time for subspace rotation: 26.214 ms
rank = 0, Efermi =  -0.118639452883 calculate fermi energy took 0.124 ms
rank = 0, --- Calculate rho: sum over local bands took 5.413 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.538 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1594.242 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.830 ms
rank = 0, D2D took 1.928 ms
rank = 0, Transfering density took 1.934 ms
Etot    =   -53.506657345537
Eband   =   -13.851117197431
E1      =    30.143290550279
E2      =   -13.167440790492
E3      =   -18.118941946917
Exc     =   -16.187197337828
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 5.509e-06, dEband = 1.263e-03
rank = 0, Calculating/Estimating energy took 0.946 ms, Etot = -53.506657346, dEtot = 5.509e-06, dEband = 1.263e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0341969406217, which took 0.055 ms

iter_count = 108, r_2norm = 1.242e-06, tol*||rhs|| = 1.368e-06

Anderson update took 57.401 ms, out of which F'*F took 27.136 ms; b-Ax took 183.842 ms, out of which Lap took 165.072 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.401 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333204, int_b + int_rho = 2.983e-13, checking this took 0.106 ms
2-norm of RHS = 729.6662343956539, which took 0.125 ms

iter_count = 138, r_2norm = 6.575e-04, tol*||rhs|| = 7.297e-04

Anderson update took 73.458 ms, out of which F'*F took 35.084 ms; b-Ax took 234.722 ms, out of which Lap took 211.432 ms
Solving Poisson took 497.033 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.177569 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 52.843 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.331 ms
Total time for convolution: 	 convolve: 5.189541 
Total time for convolution: 	 convolve: 5.193979 
Total time for convolution: 	 convolve: 5.195738 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.530 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.072 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.635 ms

This SCF took 27308.304 ms, scf error = 1.274e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133463, lowerbound = -0.997229, upperbound = 267.583011

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1478.345 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 18.695 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.629 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 21.786 ms
rank =  0, finding HY took 25.017 ms
rank =  0, distributing HY into block cyclic form took 18.311 ms
rank =  0, finding Y'*HY took 4.010 ms
Rank 0, Project_Hamiltonian used 69.170 ms
Total time for projection: 69.185 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.210 ms
    first calculated eigval = -0.997088759864383
    last  calculated eigval = 0.033937841073079
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 28):
lambda[   5] =  -0.54121755289779
lambda[   6] =  -0.46318961557856
lambda[   7] =  -0.42269565113000
lambda[   8] =  -0.39262413603180
lambda[   9] =  -0.37926480805838
lambda[  10] =  -0.37843662518264
lambda[  11] =  -0.33736140910710
lambda[  12] =  -0.32591968966509
lambda[  13] =  -0.22200273159998
lambda[  14] =  -0.21597789323491
lambda[  15] =  -0.08947898295055
lambda[  16] =  -0.01805771841516
lambda[  17] =   0.02113287238339
lambda[  18] =   0.02708412518603
lambda[  19] =   0.02782861256756
lambda[  20] =   0.03079326367919
lambda[  21] =   0.03393784107308
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.239 ms
rank =  0, subspace rotation using ScaLAPACK took 8.044 ms
rank =  0, Distributing orbital back into band + domain format took 18.427 ms
rank = 0, Subspace_Rotation used 26.483 ms

Total time for subspace rotation: 26.488 ms
rank = 0, Efermi =  -0.118506472305 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.291 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.726 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.575 ms
rank = 0, Calculating density took 1590.958 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.826 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.933 ms
Etot    =   -53.506682037784
Eband   =   -13.847253712393
E1      =    30.141428535236
E2      =   -13.165381284557
E3      =   -18.119113748968
Exc     =   -16.187335796186
Esc     =   -84.898016097268
Entropy =    -0.000000000698
dE = 2.744e-06, dEband = 4.293e-04
rank = 0, Calculating/Estimating energy took 0.917 ms, Etot = -53.506682038, dEtot = 2.744e-06, dEband = 4.293e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0224185055022, which took 0.057 ms

iter_count = 108, r_2norm = 7.598e-07, tol*||rhs|| = 8.967e-07

Anderson update took 57.073 ms, out of which F'*F took 26.862 ms; b-Ax took 183.555 ms, out of which Lap took 164.194 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.084 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -28.00000002333174, int_rho =  28.00000002333206, int_b + int_rho = 3.201e-13, checking this took 0.108 ms
2-norm of RHS = 729.6690170011307, which took 0.152 ms

iter_count = 138, r_2norm = 6.600e-04, tol*||rhs|| = 7.297e-04

Anderson update took 73.187 ms, out of which F'*F took 34.919 ms; b-Ax took 233.310 ms, out of which Lap took 209.858 ms
Solving Poisson took 494.787 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.192 ms
Total time for convolution: 	 convolve: 5.173008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.288 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.192144 
Total time for convolution: 	 convolve: 5.196366 
Total time for convolution: 	 convolve: 5.168531 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.040 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.591 ms

This SCF took 27231.328 ms, scf error = 9.962e-05
The last 17 occupations of kpoints #1 are (Nelectron = 28):
lambda[   5] =  -0.54121755289779, occ[   5] =   2.00000000000000
lambda[   6] =  -0.46318961557856, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42269565113000, occ[   7] =   2.00000000000000
lambda[   8] =  -0.39262413603180, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37926480805838, occ[   9] =   2.00000000000000
lambda[  10] =  -0.37843662518264, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33736140910710, occ[  11] =   2.00000000000000
lambda[  12] =  -0.32591968966509, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22200273159998, occ[  13] =   2.00000000000000
lambda[  14] =  -0.21597789323491, occ[  14] =   2.00000000000000
lambda[  15] =  -0.08947898295055, occ[  15] =   0.00000002333206
lambda[  16] =  -0.01805771841516, occ[  16] =   0.00000000000000
lambda[  17] =   0.02113287238339, occ[  17] =   0.00000000000000
lambda[  18] =   0.02708412518603, occ[  18] =   0.00000000000000
lambda[  19] =   0.02782861256756, occ[  19] =   0.00000000000000
lambda[  20] =   0.03079326367919, occ[  20] =   0.00000000000000
lambda[  21] =   0.03393784107308, occ[  21] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 19 (90%) = 0.000000000000000.
Occupation of state 21 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 1.017 ms, time for Allreduce/Reduce: 10.443 ms 
Time for calculating local force components: 23.004 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.20494130654401   1.08644068510876   0.00000243187140
  0.78671428984794   0.74387130616921   0.00000280294602
 -0.05812684139268   0.02367287568113   0.00000000837329
 -0.00044187174402  -0.05172952137452   0.00000002484563
 -0.04269086980877  -0.02537502551415   0.00000003498643
  0.04691905362642  -0.02486073617869  -0.00000002093178
 -0.01601126633171  -0.03746963194641  -0.00000215559221
 -0.01483756353664  -0.12682171562356   0.00000104155091
 -0.02260689616934  -0.20316046044762   0.00000030084891
force_loc = 
  0.19932323761158  -1.07266059233105  -0.00000151979086
 -0.77022797852544  -0.72822700404421  -0.00000156114399
  0.06374166868154  -0.02497955560427   0.00000036808112
  0.00053450771572   0.05413819054798  -0.00000033752464
  0.04517849693414   0.02678654522758  -0.00000051834130
 -0.04887205934429   0.02590947578467   0.00000049746055
  0.02304604628780   0.03910754560479  -0.00000218238710
  0.01533400206354   0.14094017176405   0.00000042192172
  0.01232694786108   0.19921124308831  -0.00000000210752
Time for calculating nonlocal force components: 39.793 ms
[32mforces_xc: 
[0m[32m  0.00596225908030  -0.02691320155348  -0.00000006828201
[0m[32m -0.02224307837142  -0.02085579817601  -0.00000024977573
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00156471644069  -0.00174786491662  -0.00000010201477
[0m[32m -0.00045478821858  -0.00219991150737  -0.00000000320906
[0m[32m  0.00377420800970   0.00715958410472  -0.00000000315271
[0mTime for calculating XC forces components: 31.969 ms
 Cartesian force = 
  0.00036247000429  -0.01315939809391   0.00000093172828
 -0.00573848719250  -0.00523778536915   0.00000107995605
  0.00563310714529  -0.00133296924127   0.00000046438416
  0.00011091582813   0.00238237985532  -0.00000022474927
  0.00250590698180   0.00138523039529  -0.00000039542512
 -0.00193472586145   0.00102245028784   0.00000056445852
  0.00548834337183  -0.00013624057638  -0.00000435206434
  0.00005993016475   0.01189225531499   0.00000154819331
 -0.00648746044214   0.00318407742727   0.00000038351842
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 392.562 ms
The program took 419.641 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:26:46
Job ID:        2266457
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:26:36,vmem=8416K,walltime=00:07:13,mem=8152K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-10-1
---------------------------------------
