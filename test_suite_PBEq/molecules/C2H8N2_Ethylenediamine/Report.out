---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:37
Job ID:    2266741
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:43
Job ID:    2266741
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 1.115 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 12.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 9.107 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 83.708 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.944 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.092 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.911668	    6.412950	   11.531736	
   11.911668	    6.412950	    8.468264	
    8.088332	   13.587050	   11.531736	
    8.088332	   13.587050	    8.468264	
    8.001265	    8.715324	    8.340888	
    8.001265	    8.715324	   11.659112	
   11.998735	   11.284676	    8.340888	
   11.998735	   11.284676	   11.659112	
   10.751589	   11.246050	   10.000000	
    9.248411	    8.753950	   10.000000	
    9.248411	   13.568848	   10.000000	
   10.751589	    6.431152	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.180 ms
Set up communicators.

--set up spincomm took 2.239 ms

--set up kptcomm took 0.350 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.007 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.068 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.870 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.829 ms

Calculate_SplineDerivRadFun took 0.211 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.279 ms.
time spent on vectorized spline interp: 2.720 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.092 ms.
time spent on vectorized spline interp: 1.756 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.532 ms.
time spent on vectorized spline interp: 1.733 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.559 ms.

Calculating rb for all atom types took 15.680 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.922 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000384254, sum_int_rho = 25.2067773109146
PosCharge = 26.000000038425, NegCharge = -25.206777310915, scal_fac = 1.031468629160
After scaling, int_rho = 26.0000000384255, PosCharge + NegCharge - NetCharge = -8.882e-14
--Calculate Vref took 0.537 ms
--Calculate rho_guess took 2.832 ms

 integral of b = -26.0000000384254,
 int{b} + Nelectron + NetCharge = -3.843e-08,
 Esc = -65.4718227932071,
 MPI_Reduce took 12.043 ms

Calculating b & b_ref took 22.316 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.059 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.771 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842538, int_b + int_rho = 5.093e-14, checking this took 0.090 ms
2-norm of RHS = 826.0760574692430, which took 0.753 ms

iter_count = 420, r_2norm = 6.631e-04, tol*||rhs|| = 8.261e-04

Anderson update took 270.816 ms, out of which F'*F took 120.059 ms; b-Ax took 807.291 ms, out of which Lap took 721.460 ms
Solving Poisson took 1798.345 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.442 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.844 ms
Total time for convolution: 	 convolve: 5.113923 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 113.533 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
Total time for convolution: 	 convolve: 5.114152 
Total time for convolution: 	 convolve: 5.131880 
Total time for convolution: 	 convolve: 5.111041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.870 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
rank = 0, XC calculation took 24417.588 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 2.193 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.172 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.474 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.168 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.884 ms
    Lanczos iter 53, eigmin  = -0.910479433, eigmax = 264.932046524, err_eigmin = 3.007e-04, err_eigmax = 9.752e-03
rank =   0, Lanczos took 140.619 ms, eigmin = -0.910479433150, eigmax = 267.581366989334

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.285444, lowerbound = -1.010479, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2031.756 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.475 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.952 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 27.460 ms
rank =  0, finding HY took 33.702 ms
rank =  0, distributing HY into block cyclic form took 21.940 ms
rank =  0, finding Y'*HY took 6.398 ms
Rank 0, Project_Hamiltonian used 90.250 ms
Total time for projection: 90.264 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.767 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.196 ms
rank = 0, Solve_Generalized_EigenProblem used 0.968 ms
    first calculated eigval = 2.735387042142941
    last  calculated eigval = 3.223596658306744
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.80890159998781
lambda[   5] =   2.85613673888839
lambda[   6] =   2.86731548136889
lambda[   7] =   2.91487353953919
lambda[   8] =   2.94204267041152
lambda[   9] =   2.96549121952861
lambda[  10] =   2.98463701410785
lambda[  11] =   2.99836058295342
lambda[  12] =   3.04824827007872
lambda[  13] =   3.05713113010836
lambda[  14] =   3.06493142017469
lambda[  15] =   3.10930434601784
lambda[  16] =   3.12245672350529
lambda[  17] =   3.15751977906916
lambda[  18] =   3.17716527321469
lambda[  19] =   3.18569129121364
lambda[  20] =   3.22359665830674
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.982 ms
rank =  0, subspace rotation using ScaLAPACK took 6.677 ms
rank =  0, Distributing orbital back into band + domain format took 19.857 ms
rank = 0, Subspace_Rotation used 26.551 ms

Total time for subspace rotation: 26.558 ms
rank = 0, Efermi =   3.061089457566 calculate fermi energy took 0.071 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.323597, lowerbound = -1.010479, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2093.368 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 21.263 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.206 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 25.509 ms
rank =  0, finding HY took 33.271 ms
rank =  0, distributing HY into block cyclic form took 20.763 ms
rank =  0, finding Y'*HY took 5.942 ms
Rank 0, Project_Hamiltonian used 85.527 ms
Total time for projection: 85.534 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.662992310526372
    last  calculated eigval = 0.452586697065704
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.35672133422982
lambda[   5] =  -0.23121205456825
lambda[   6] =  -0.08758611571329
lambda[   7] =  -0.03589752770152
lambda[   8] =   0.04480944211529
lambda[   9] =   0.08419878611189
lambda[  10] =   0.15613304781631
lambda[  11] =   0.24318743238859
lambda[  12] =   0.26569198428655
lambda[  13] =   0.29351497004766
lambda[  14] =   0.32362022502282
lambda[  15] =   0.34663446518133
lambda[  16] =   0.36487733275352
lambda[  17] =   0.37802138523572
lambda[  18] =   0.41163001773074
lambda[  19] =   0.43056306040814
lambda[  20] =   0.45258669706570
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 6.681 ms
rank =  0, Distributing orbital back into band + domain format took 19.878 ms
rank = 0, Subspace_Rotation used 26.576 ms

Total time for subspace rotation: 26.581 ms
rank = 0, Efermi =   0.308567605834 calculate fermi energy took 0.039 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.552587, lowerbound = -1.010479, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2103.195 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 18.626 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.032 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 8.843 ms
rank =  0, Distribute data + matrix mult took 31.518 ms
rank =  0, finding HY took 29.907 ms
rank =  0, distributing HY into block cyclic form took 20.502 ms
rank =  0, finding Y'*HY took 6.191 ms
Rank 0, Project_Hamiltonian used 89.023 ms
Total time for projection: 89.029 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.911762412845950
    last  calculated eigval = 0.155871445798755
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65136245782285
lambda[   5] =  -0.54292373038625
lambda[   6] =  -0.51055861043404
lambda[   7] =  -0.48687107784499
lambda[   8] =  -0.45983863049630
lambda[   9] =  -0.41910192745881
lambda[  10] =  -0.41127612621744
lambda[  11] =  -0.37049689606271
lambda[  12] =  -0.29110778888764
lambda[  13] =  -0.24387805280581
lambda[  14] =   0.07386590767487
lambda[  15] =   0.07923996024943
lambda[  16] =   0.09291712852663
lambda[  17] =   0.11506732465413
lambda[  18] =   0.12404760052513
lambda[  19] =   0.13528031861201
lambda[  20] =   0.15587144579876
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 6.622 ms
rank =  0, Distributing orbital back into band + domain format took 19.490 ms
rank = 0, Subspace_Rotation used 26.127 ms

Total time for subspace rotation: 26.132 ms
rank = 0, Efermi =   0.045290805246 calculate fermi energy took 0.062 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.255871, lowerbound = -1.010479, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2103.656 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.897 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.297 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.224 ms
rank =  0, finding HY took 33.345 ms
rank =  0, distributing HY into block cyclic form took 20.680 ms
rank =  0, finding Y'*HY took 5.878 ms
Rank 0, Project_Hamiltonian used 85.167 ms
Total time for projection: 85.172 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.912989309237647
    last  calculated eigval = 0.090242281588607
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65299039288002
lambda[   5] =  -0.54857506483297
lambda[   6] =  -0.51850302664345
lambda[   7] =  -0.49345934465761
lambda[   8] =  -0.49186583098652
lambda[   9] =  -0.43848568005730
lambda[  10] =  -0.42731229950203
lambda[  11] =  -0.38717028277150
lambda[  12] =  -0.32970947483686
lambda[  13] =  -0.28893865368847
lambda[  14] =   0.01601837825840
lambda[  15] =   0.03818650975499
lambda[  16] =   0.05112188300409
lambda[  17] =   0.05699673277426
lambda[  18] =   0.07335808677176
lambda[  19] =   0.07886828416685
lambda[  20] =   0.09024228158861
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.185 ms
rank =  0, subspace rotation using ScaLAPACK took 6.646 ms
rank =  0, Distributing orbital back into band + domain format took 19.671 ms
rank = 0, Subspace_Rotation used 27.309 ms

Total time for subspace rotation: 27.317 ms
rank = 0, Efermi =  -0.012555177548 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 4.885 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.227 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.335 ms
rank = 0, Calculating density took 8941.766 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
rank = 0, D2D took 2.785 ms
rank = 0, Transfering density took 2.797 ms
Etot    =   -37.681083009936
Eband   =   -14.232819987040
E1      =    29.433621072935
E2      =   -10.866132117902
E3      =   -14.424677780479
Exc     =   -12.700871199871
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 3.140e+00, dEband = 1.186e+00
rank = 0, Calculating/Estimating energy took 1.634 ms, Etot = -37.681083010, dEtot = 3.140e+00, dEband = 1.186e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.5715708092562, which took 0.051 ms

iter_count = 96, r_2norm = 1.784e-03, tol*||rhs|| = 2.303e-03

Anderson update took 57.278 ms, out of which F'*F took 26.359 ms; b-Ax took 179.950 ms, out of which Lap took 159.755 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 402.163 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842548, int_b + int_rho = 1.528e-13, checking this took 0.108 ms
2-norm of RHS = 821.1637609042748, which took 0.203 ms

iter_count = 282, r_2norm = 7.766e-04, tol*||rhs|| = 8.212e-04

Anderson update took 168.415 ms, out of which F'*F took 78.161 ms; b-Ax took 527.153 ms, out of which Lap took 471.518 ms
Solving Poisson took 1167.030 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.847 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
Total time for convolution: 	 convolve: 5.091987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.097872 
Total time for convolution: 	 convolve: 5.085437 
Total time for convolution: 	 convolve: 5.087432 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.231 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.293 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.478 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.793 ms

This SCF took 34998.707 ms, scf error = 1.856e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.190242, lowerbound = -0.912989, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2017.315 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.865 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.182 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.076 ms
rank =  0, finding HY took 33.762 ms
rank =  0, distributing HY into block cyclic form took 20.567 ms
rank =  0, finding Y'*HY took 6.576 ms
Rank 0, Project_Hamiltonian used 86.012 ms
Total time for projection: 86.024 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.880458376123193
    last  calculated eigval = 0.063197834669214
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62284173989933
lambda[   5] =  -0.52145821662650
lambda[   6] =  -0.48865760720285
lambda[   7] =  -0.46106016921022
lambda[   8] =  -0.46059616591440
lambda[   9] =  -0.41082242263129
lambda[  10] =  -0.39809870731398
lambda[  11] =  -0.36260970192221
lambda[  12] =  -0.29203990865247
lambda[  13] =  -0.25189564759261
lambda[  14] =  -0.00545969009435
lambda[  15] =   0.00021705279550
lambda[  16] =   0.01550517202441
lambda[  17] =   0.03346944885085
lambda[  18] =   0.04048139669675
lambda[  19] =   0.05412550078701
lambda[  20] =   0.06319783466921
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 6.422 ms
rank =  0, Distributing orbital back into band + domain format took 22.671 ms
rank = 0, Subspace_Rotation used 29.111 ms

Total time for subspace rotation: 29.115 ms
rank = 0, Efermi =  -0.034034292828 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.573 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.553 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.306 ms
rank = 0, Calculating density took 2142.248 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.022 ms
rank = 0, D2D took 1.224 ms
rank = 0, Transfering density took 1.232 ms
Etot    =   -37.619284735299
Eband   =   -13.420964372260
E1      =    28.723180187611
E2      =   -10.784515047914
E3      =   -14.642919336664
Exc     =   -12.877112140889
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 5.150e-03, dEband = 6.765e-02
rank = 0, Calculating/Estimating energy took 1.064 ms, Etot = -37.619284735, dEtot = 5.150e-03, dEband = 6.765e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.6176235226914, which took 0.081 ms

iter_count = 102, r_2norm = 6.347e-04, tol*||rhs|| = 8.247e-04

Anderson update took 60.256 ms, out of which F'*F took 28.010 ms; b-Ax took 189.680 ms, out of which Lap took 168.251 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 429.697 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842542, int_b + int_rho = 8.731e-14, checking this took 0.129 ms
2-norm of RHS = 814.9279691879826, which took 0.184 ms

iter_count = 294, r_2norm = 8.131e-04, tol*||rhs|| = 8.149e-04

Anderson update took 173.468 ms, out of which F'*F took 81.360 ms; b-Ax took 550.791 ms, out of which Lap took 490.119 ms
Solving Poisson took 1212.266 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.088987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.087931 
Total time for convolution: 	 convolve: 5.088118 
Total time for convolution: 	 convolve: 5.085057 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.381 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.267 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.530 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.818 ms

This SCF took 28245.496 ms, scf error = 1.260e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.163198, lowerbound = -0.880458, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2008.517 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.054 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.433 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 25.511 ms
rank =  0, finding HY took 34.410 ms
rank =  0, distributing HY into block cyclic form took 21.782 ms
rank =  0, finding Y'*HY took 6.405 ms
Rank 0, Project_Hamiltonian used 88.144 ms
Total time for projection: 88.157 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.832957526577915
    last  calculated eigval = 0.053411250290263
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57275480054163
lambda[   5] =  -0.47878783399700
lambda[   6] =  -0.44532403383037
lambda[   7] =  -0.41293119428653
lambda[   8] =  -0.41149231854927
lambda[   9] =  -0.36618528448834
lambda[  10] =  -0.35111336998127
lambda[  11] =  -0.31898945701546
lambda[  12] =  -0.23999358259516
lambda[  13] =  -0.19933055358503
lambda[  14] =  -0.02335593072863
lambda[  15] =  -0.00788691985661
lambda[  16] =   0.00565771687797
lambda[  17] =   0.02539371081264
lambda[  18] =   0.02801968040789
lambda[  19] =   0.03885955703092
lambda[  20] =   0.05341125029026
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 7.497 ms
rank =  0, Distributing orbital back into band + domain format took 21.563 ms
rank = 0, Subspace_Rotation used 29.080 ms

Total time for subspace rotation: 29.085 ms
rank = 0, Efermi =  -0.051929486549 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.547 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.384 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.341 ms
rank = 0, Calculating density took 2135.596 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.045 ms
rank = 0, D2D took 1.219 ms
rank = 0, Transfering density took 1.227 ms
Etot    =   -37.573274129602
Eband   =   -12.179741854459
E1      =    27.678127041231
E2      =   -10.560630239028
E3      =   -15.023674870994
Exc     =   -13.184141632055
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 3.834e-03, dEband = 1.034e-01
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -37.573274130, dEtot = 3.834e-03, dEband = 1.034e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.6170874542733, which took 0.062 ms

iter_count = 108, r_2norm = 1.474e-04, tol*||rhs|| = 2.247e-04

Anderson update took 63.300 ms, out of which F'*F took 29.169 ms; b-Ax took 201.551 ms, out of which Lap took 178.549 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 454.302 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842546, int_b + int_rho = 1.346e-13, checking this took 0.109 ms
2-norm of RHS = 814.8525505157218, which took 0.150 ms

iter_count = 276, r_2norm = 6.990e-04, tol*||rhs|| = 8.149e-04

Anderson update took 177.589 ms, out of which F'*F took 76.038 ms; b-Ax took 537.297 ms, out of which Lap took 480.735 ms
Solving Poisson took 1169.152 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.088840 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.092662 
Total time for convolution: 	 convolve: 5.091270 
Total time for convolution: 	 convolve: 5.088370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.415 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.293 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.495 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.809 ms

This SCF took 28144.783 ms, scf error = 4.948e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.153411, lowerbound = -0.832958, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2078.508 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 23.603 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 28.188 ms
rank =  0, finding HY took 32.679 ms
rank =  0, distributing HY into block cyclic form took 20.500 ms
rank =  0, finding Y'*HY took 5.997 ms
Rank 0, Project_Hamiltonian used 87.400 ms
Total time for projection: 88.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.614 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.712 ms
    first calculated eigval = -0.824048553422198
    last  calculated eigval = 0.049727380234495
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55652897608383
lambda[   5] =  -0.46673006565800
lambda[   6] =  -0.43649194367274
lambda[   7] =  -0.40146400239741
lambda[   8] =  -0.40037347068462
lambda[   9] =  -0.35235652224649
lambda[  10] =  -0.33679975326723
lambda[  11] =  -0.30142031872698
lambda[  12] =  -0.23394781168537
lambda[  13] =  -0.19197347581171
lambda[  14] =  -0.03054705162094
lambda[  15] =  -0.00952899575387
lambda[  16] =   0.00375060310341
lambda[  17] =   0.02119530878506
lambda[  18] =   0.02194359589732
lambda[  19] =   0.03182905870479
lambda[  20] =   0.04972738023450
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.727 ms
rank =  0, subspace rotation using ScaLAPACK took 7.529 ms
rank =  0, Distributing orbital back into band + domain format took 21.598 ms
rank = 0, Subspace_Rotation used 29.147 ms

Total time for subspace rotation: 29.153 ms
rank = 0, Efermi =  -0.059120607429 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.597 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.538 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.402 ms
rank = 0, Calculating density took 2206.188 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.188 ms
rank = 0, D2D took 1.377 ms
rank = 0, Transfering density took 1.384 ms
Etot    =   -37.566998631863
Eband   =   -11.880761345945
E1      =    27.492864654824
E2      =   -10.427977070991
E3      =   -15.136069066959
Exc     =   -13.271325284352
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 5.230e-04, dEband = 2.492e-02
rank = 0, Calculating/Estimating energy took 1.148 ms, Etot = -37.566998632, dEtot = 5.230e-04, dEband = 2.492e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.5533088550360, which took 0.175 ms

iter_count = 108, r_2norm = 8.402e-05, tol*||rhs|| = 1.021e-04

Anderson update took 63.673 ms, out of which F'*F took 29.775 ms; b-Ax took 202.519 ms, out of which Lap took 179.295 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 453.591 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842542, int_b + int_rho = 9.095e-14, checking this took 0.119 ms
2-norm of RHS = 814.9171223886667, which took 0.120 ms

iter_count = 246, r_2norm = 6.965e-04, tol*||rhs|| = 8.149e-04

Anderson update took 143.814 ms, out of which F'*F took 68.339 ms; b-Ax took 466.282 ms, out of which Lap took 413.557 ms
Solving Poisson took 1019.017 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.092734 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.087508 
Total time for convolution: 	 convolve: 5.102811 
Total time for convolution: 	 convolve: 5.083977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.274 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.620 ms

This SCF took 28025.026 ms, scf error = 1.364e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.149727, lowerbound = -0.824049, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2059.984 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 26.315 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.996 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 30.747 ms
rank =  0, finding HY took 32.900 ms
rank =  0, distributing HY into block cyclic form took 20.658 ms
rank =  0, finding Y'*HY took 5.938 ms
Rank 0, Project_Hamiltonian used 90.275 ms
Total time for projection: 90.291 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.819132557477904
    last  calculated eigval = 0.047027045228965
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55144195180508
lambda[   5] =  -0.46193676419807
lambda[   6] =  -0.43168718611153
lambda[   7] =  -0.39667075144913
lambda[   8] =  -0.39565660151516
lambda[   9] =  -0.34739561323561
lambda[  10] =  -0.33193085010114
lambda[  11] =  -0.29631597127844
lambda[  12] =  -0.22891417838501
lambda[  13] =  -0.18708656129056
lambda[  14] =  -0.03264123372285
lambda[  15] =  -0.01047327148202
lambda[  16] =   0.00285963473184
lambda[  17] =   0.01721978906993
lambda[  18] =   0.01924468196384
lambda[  19] =   0.02846082115208
lambda[  20] =   0.04702704522897
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 7.495 ms
rank =  0, Distributing orbital back into band + domain format took 21.473 ms
rank = 0, Subspace_Rotation used 28.985 ms

Total time for subspace rotation: 28.989 ms
rank = 0, Efermi =  -0.061214789557 calculate fermi energy took 2.076 ms
rank = 0, --- Calculate rho: sum over local bands took 5.619 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.353 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.298 ms
rank = 0, Calculating density took 2189.886 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.076 ms
rank = 0, D2D took 1.202 ms
rank = 0, Transfering density took 1.209 ms
Etot    =   -37.565999627792
Eband   =   -11.752812997761
E1      =    27.418330992976
E2      =   -10.365939211601
E3      =   -15.175113637321
Exc     =   -13.300747677589
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 8.325e-05, dEband = 1.066e-02
rank = 0, Calculating/Estimating energy took 1.008 ms, Etot = -37.565999628, dEtot = 8.325e-05, dEband = 1.066e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8435945573021, which took 0.084 ms

iter_count = 114, r_2norm = 2.300e-05, tol*||rhs|| = 3.374e-05

Anderson update took 67.372 ms, out of which F'*F took 31.033 ms; b-Ax took 211.103 ms, out of which Lap took 186.926 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.658 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842547, int_b + int_rho = 1.455e-13, checking this took 0.107 ms
2-norm of RHS = 815.2969746696824, which took 0.239 ms

iter_count = 240, r_2norm = 7.930e-04, tol*||rhs|| = 8.153e-04

Anderson update took 144.137 ms, out of which F'*F took 67.084 ms; b-Ax took 455.027 ms, out of which Lap took 403.887 ms
Solving Poisson took 1001.219 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.198 ms
Total time for convolution: 	 convolve: 5.104987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.430 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.117625 
Total time for convolution: 	 convolve: 5.176307 
Total time for convolution: 	 convolve: 5.109187 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.643 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.636 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.218 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.707 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.877 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.619 ms

This SCF took 28208.735 ms, scf error = 7.740e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.147027, lowerbound = -0.819133, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2038.725 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.758 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.349 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.137 ms
rank =  0, finding HY took 32.902 ms
rank =  0, distributing HY into block cyclic form took 20.590 ms
rank =  0, finding Y'*HY took 5.980 ms
Rank 0, Project_Hamiltonian used 84.642 ms
Total time for projection: 84.658 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.815678888456522
    last  calculated eigval = 0.044811141866930
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54883870933634
lambda[   5] =  -0.45896298248849
lambda[   6] =  -0.42842550166318
lambda[   7] =  -0.39370451277956
lambda[   8] =  -0.39263497056509
lambda[   9] =  -0.34460824181497
lambda[  10] =  -0.32917138219083
lambda[  11] =  -0.29374801850668
lambda[  12] =  -0.22520998017034
lambda[  13] =  -0.18369965254689
lambda[  14] =  -0.03300343883864
lambda[  15] =  -0.01071522859546
lambda[  16] =   0.00259507701965
lambda[  17] =   0.01540877247313
lambda[  18] =   0.01850785390290
lambda[  19] =   0.02692437889996
lambda[  20] =   0.04481114186693
==subpsace eigenproblem: bcast eigvals took 0.072 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 7.450 ms
rank =  0, Distributing orbital back into band + domain format took 21.224 ms
rank = 0, Subspace_Rotation used 28.688 ms

Total time for subspace rotation: 28.694 ms
rank = 0, Efermi =  -0.061576994664 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.321 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.618 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.488 ms
rank = 0, Calculating density took 2161.886 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.997 ms
rank = 0, D2D took 1.172 ms
rank = 0, Transfering density took 1.175 ms
Etot    =   -37.565535065061
Eband   =   -11.673179703857
E1      =    27.389387580672
E2      =   -10.310923528595
E3      =   -15.188721171166
Exc     =   -13.309564847298
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 3.871e-05, dEband = 6.636e-03
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -37.565535065, dEtot = 3.871e-05, dEband = 6.636e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4239027119584, which took 0.060 ms

iter_count = 114, r_2norm = 1.030e-05, tol*||rhs|| = 1.696e-05

Anderson update took 67.381 ms, out of which F'*F took 32.754 ms; b-Ax took 219.381 ms, out of which Lap took 193.522 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 490.252 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842549, int_b + int_rho = 1.673e-13, checking this took 0.122 ms
2-norm of RHS = 815.4787770042849, which took 0.174 ms

iter_count = 240, r_2norm = 8.090e-04, tol*||rhs|| = 8.155e-04

Anderson update took 142.318 ms, out of which F'*F took 67.006 ms; b-Ax took 454.881 ms, out of which Lap took 406.277 ms
Solving Poisson took 1011.282 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.089676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.098803 
Total time for convolution: 	 convolve: 5.088439 
Total time for convolution: 	 convolve: 5.083031 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.750 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.634 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.250 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.606 ms
---Transfer Veff_loc: D2D took 1.637 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 14.074 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 15.740 ms

This SCF took 28007.096 ms, scf error = 3.776e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.144811, lowerbound = -0.815679, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1871.963 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.596 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.467 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.088 ms
rank =  0, finding HY took 32.718 ms
rank =  0, distributing HY into block cyclic form took 20.692 ms
rank =  0, finding Y'*HY took 5.849 ms
Rank 0, Project_Hamiltonian used 84.376 ms
Total time for projection: 84.390 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.810837828653928
    last  calculated eigval = 0.043429555758153
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54400218377880
lambda[   5] =  -0.45461976629726
lambda[   6] =  -0.42428290239776
lambda[   7] =  -0.38888166718807
lambda[   8] =  -0.38749528071642
lambda[   9] =  -0.34025273403657
lambda[  10] =  -0.32429961857511
lambda[  11] =  -0.28932754582222
lambda[  12] =  -0.22042201927886
lambda[  13] =  -0.17891911294933
lambda[  14] =  -0.03236410824659
lambda[  15] =  -0.01018766472829
lambda[  16] =   0.00313086371134
lambda[  17] =   0.01472896052302
lambda[  18] =   0.02047967991082
lambda[  19] =   0.02708904334105
lambda[  20] =   0.04342955575815
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 7.459 ms
rank =  0, Distributing orbital back into band + domain format took 21.187 ms
rank = 0, Subspace_Rotation used 28.666 ms

Total time for subspace rotation: 28.672 ms
rank = 0, Efermi =  -0.060937664088 calculate fermi energy took 0.091 ms
rank = 0, --- Calculate rho: sum over local bands took 5.467 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.470 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.427 ms
rank = 0, Calculating density took 1994.757 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.987 ms
rank = 0, D2D took 1.181 ms
rank = 0, Transfering density took 1.185 ms
Etot    =   -37.565202010054
Eband   =   -11.551213820423
E1      =    27.327309348091
E2      =   -10.245911356456
E3      =   -15.207690852984
Exc     =   -13.323076952824
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 2.775e-05, dEband = 1.016e-02
rank = 0, Calculating/Estimating energy took 1.172 ms, Etot = -37.565202010, dEtot = 2.775e-05, dEband = 1.016e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2768207494528, which took 0.060 ms

iter_count = 114, r_2norm = 7.834e-06, tol*||rhs|| = 1.107e-05

Anderson update took 66.792 ms, out of which F'*F took 30.722 ms; b-Ax took 211.885 ms, out of which Lap took 187.724 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.318 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842552, int_b + int_rho = 1.892e-13, checking this took 0.113 ms
2-norm of RHS = 815.5133565169822, which took 0.121 ms

iter_count = 210, r_2norm = 7.644e-04, tol*||rhs|| = 8.155e-04

Anderson update took 123.017 ms, out of which F'*F took 56.453 ms; b-Ax took 390.159 ms, out of which Lap took 346.330 ms
Solving Poisson took 881.728 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.085808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.576 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.377 ms
Total time for convolution: 	 convolve: 5.087730 
Total time for convolution: 	 convolve: 5.091575 
Total time for convolution: 	 convolve: 5.086920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.454 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.644 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.864 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.542 ms

This SCF took 27700.446 ms, scf error = 1.814e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.143430, lowerbound = -0.810838, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2009.915 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.485 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.072 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.584 ms
rank =  0, finding HY took 32.628 ms
rank =  0, distributing HY into block cyclic form took 20.514 ms
rank =  0, finding Y'*HY took 6.738 ms
Rank 0, Project_Hamiltonian used 84.490 ms
Total time for projection: 84.510 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.810013908490953
    last  calculated eigval = 0.041810919696009
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54316946454443
lambda[   5] =  -0.45380321766407
lambda[   6] =  -0.42345173428336
lambda[   7] =  -0.38805295460524
lambda[   8] =  -0.38667370283490
lambda[   9] =  -0.33943834275863
lambda[  10] =  -0.32346275334337
lambda[  11] =  -0.28851265032849
lambda[  12] =  -0.21950042194976
lambda[  13] =  -0.17803848725974
lambda[  14] =  -0.03179143806095
lambda[  15] =  -0.00950216575090
lambda[  16] =   0.00401584843156
lambda[  17] =   0.01469510668458
lambda[  18] =   0.02114000802133
lambda[  19] =   0.02752275398106
lambda[  20] =   0.04181091969601
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 7.464 ms
rank =  0, Distributing orbital back into band + domain format took 21.393 ms
rank = 0, Subspace_Rotation used 28.871 ms

Total time for subspace rotation: 28.877 ms
rank = 0, Efermi =  -0.060364993870 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.573 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.375 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.412 ms
rank = 0, Calculating density took 2133.013 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.016 ms
rank = 0, D2D took 1.198 ms
rank = 0, Transfering density took 1.201 ms
Etot    =   -37.565284729659
Eband   =   -11.529465415252
E1      =    27.320020159761
E2      =   -10.231451429083
E3      =   -15.206344599102
Exc     =   -13.321812708014
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 6.893e-06, dEband = 1.812e-03
rank = 0, Calculating/Estimating energy took 2.030 ms, Etot = -37.565284730, dEtot = 6.893e-06, dEband = 1.812e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1450916549881, which took 0.071 ms

iter_count = 114, r_2norm = 4.291e-06, tol*||rhs|| = 5.804e-06

Anderson update took 66.567 ms, out of which F'*F took 30.938 ms; b-Ax took 213.744 ms, out of which Lap took 188.262 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.763 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842550, int_b + int_rho = 1.710e-13, checking this took 0.140 ms
2-norm of RHS = 815.4663579748104, which took 0.146 ms

iter_count = 216, r_2norm = 7.139e-04, tol*||rhs|| = 8.155e-04

Anderson update took 125.123 ms, out of which F'*F took 59.364 ms; b-Ax took 403.821 ms, out of which Lap took 359.745 ms
Solving Poisson took 896.283 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Total time for convolution: 	 convolve: 5.094584 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.092691 
Total time for convolution: 	 convolve: 5.090266 
Total time for convolution: 	 convolve: 5.086140 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.886 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.622 ms

This SCF took 27849.255 ms, scf error = 1.325e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.141811, lowerbound = -0.810014, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1997.222 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.736 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.061 ms
rank =  0, finding HY took 32.824 ms
rank =  0, distributing HY into block cyclic form took 20.645 ms
rank =  0, finding Y'*HY took 5.905 ms
Rank 0, Project_Hamiltonian used 84.465 ms
Total time for projection: 84.478 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.808256839280779
    last  calculated eigval = 0.040925825698320
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54126192355886
lambda[   5] =  -0.45203826956028
lambda[   6] =  -0.42169776998689
lambda[   7] =  -0.38625309813174
lambda[   8] =  -0.38489479669909
lambda[   9] =  -0.33761707830130
lambda[  10] =  -0.32161693486088
lambda[  11] =  -0.28664908444215
lambda[  12] =  -0.21763301172972
lambda[  13] =  -0.17619215473686
lambda[  14] =  -0.02953644353709
lambda[  15] =  -0.00656598559472
lambda[  16] =   0.00747873315420
lambda[  17] =   0.01639263409453
lambda[  18] =   0.02340918752139
lambda[  19] =   0.02889282928762
lambda[  20] =   0.04092582569832
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 7.537 ms
rank =  0, Distributing orbital back into band + domain format took 21.215 ms
rank = 0, Subspace_Rotation used 28.766 ms

Total time for subspace rotation: 28.771 ms
rank = 0, Efermi =  -0.058109999355 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 5.563 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.413 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.445 ms
rank = 0, Calculating density took 2120.268 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 2.023 ms
rank = 0, D2D took 2.122 ms
rank = 0, Transfering density took 2.126 ms
Etot    =   -37.565314339451
Eband   =   -11.482179697379
E1      =    27.295216469377
E2      =   -10.207877994099
E3      =   -15.211035737846
Exc     =   -13.325442049054
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 2.467e-06, dEband = 3.940e-03
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -37.565314339, dEtot = 2.467e-06, dEband = 3.940e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1314485504872, which took 0.062 ms

iter_count = 108, r_2norm = 4.438e-06, tol*||rhs|| = 5.258e-06

Anderson update took 63.176 ms, out of which F'*F took 29.281 ms; b-Ax took 200.891 ms, out of which Lap took 177.676 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 458.032 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842547, int_b + int_rho = 1.455e-13, checking this took 0.116 ms
2-norm of RHS = 815.4646834875498, which took 0.149 ms

iter_count = 198, r_2norm = 7.576e-04, tol*||rhs|| = 8.155e-04

Anderson update took 116.020 ms, out of which F'*F took 53.190 ms; b-Ax took 368.235 ms, out of which Lap took 327.099 ms
Solving Poisson took 830.144 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.087871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.090820 
Total time for convolution: 	 convolve: 5.092398 
Total time for convolution: 	 convolve: 5.082762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.139 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.892 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.625 ms

This SCF took 27750.161 ms, scf error = 7.631e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.140926, lowerbound = -0.808257, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2020.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.291 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.038 ms
rank =  0, finding HY took 32.727 ms
rank =  0, distributing HY into block cyclic form took 20.674 ms
rank =  0, finding Y'*HY took 5.898 ms
Rank 0, Project_Hamiltonian used 84.368 ms
Total time for projection: 84.387 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.806941439696349
    last  calculated eigval = 0.039334149278993
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54007438812684
lambda[   5] =  -0.45084145052861
lambda[   6] =  -0.42049396302652
lambda[   7] =  -0.38501078846540
lambda[   8] =  -0.38359704937777
lambda[   9] =  -0.33645052693810
lambda[  10] =  -0.32040003029619
lambda[  11] =  -0.28551570988737
lambda[  12] =  -0.21639594149597
lambda[  13] =  -0.17498305276399
lambda[  14] =  -0.02691643809884
lambda[  15] =  -0.00333118528897
lambda[  16] =   0.01100447766667
lambda[  17] =   0.01909681323126
lambda[  18] =   0.02408337355518
lambda[  19] =   0.02994392139326
lambda[  20] =   0.03933414927899
==subpsace eigenproblem: bcast eigvals took 0.052 ms
Total time for solving subspace eigenvalue problem: 0.242 ms
rank =  0, subspace rotation using ScaLAPACK took 7.452 ms
rank =  0, Distributing orbital back into band + domain format took 21.324 ms
rank = 0, Subspace_Rotation used 28.793 ms

Total time for subspace rotation: 28.799 ms
rank = 0, Efermi =  -0.055489993929 calculate fermi energy took 0.095 ms
rank = 0, --- Calculate rho: sum over local bands took 5.764 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.207 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 2143.246 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.055 ms
rank = 0, D2D took 1.240 ms
rank = 0, Transfering density took 1.247 ms
Etot    =   -37.565426369565
Eband   =   -11.450309708445
E1      =    27.278753759526
E2      =   -10.191975941314
E3      =   -15.213113219540
Exc     =   -13.327136787160
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 9.336e-06, dEband = 2.656e-03
rank = 0, Calculating/Estimating energy took 1.199 ms, Etot = -37.565426370, dEtot = 9.336e-06, dEband = 2.656e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1018516508234, which took 0.051 ms

iter_count = 108, r_2norm = 2.893e-06, tol*||rhs|| = 4.074e-06

Anderson update took 63.240 ms, out of which F'*F took 29.247 ms; b-Ax took 202.249 ms, out of which Lap took 178.138 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.552 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842545, int_b + int_rho = 1.273e-13, checking this took 0.133 ms
2-norm of RHS = 815.4801333530409, which took 0.169 ms

iter_count = 174, r_2norm = 7.857e-04, tol*||rhs|| = 8.155e-04

Anderson update took 101.199 ms, out of which F'*F took 47.751 ms; b-Ax took 325.279 ms, out of which Lap took 289.977 ms
Solving Poisson took 723.404 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.086308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.095932 
Total time for convolution: 	 convolve: 5.085772 
Total time for convolution: 	 convolve: 5.086954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.806 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 1.625 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.890 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.548 ms

This SCF took 27643.602 ms, scf error = 5.225e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.139334, lowerbound = -0.806941, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2007.905 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.773 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.261 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.060 ms
rank =  0, finding HY took 32.717 ms
rank =  0, distributing HY into block cyclic form took 20.555 ms
rank =  0, finding Y'*HY took 5.951 ms
Rank 0, Project_Hamiltonian used 84.307 ms
Total time for projection: 84.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.806513786143222
    last  calculated eigval = 0.037815527329674
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53959421099573
lambda[   5] =  -0.45037833807823
lambda[   6] =  -0.42007091334911
lambda[   7] =  -0.38456780180647
lambda[   8] =  -0.38315872050724
lambda[   9] =  -0.33597440936895
lambda[  10] =  -0.31992794812872
lambda[  11] =  -0.28500210029384
lambda[  12] =  -0.21605730390127
lambda[  13] =  -0.17463611703196
lambda[  14] =  -0.02511084556068
lambda[  15] =  -0.00134779963589
lambda[  16] =   0.01294830263877
lambda[  17] =   0.02103269324085
lambda[  18] =   0.02392143628233
lambda[  19] =   0.03074701795235
lambda[  20] =   0.03781552732967
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.212 ms
rank =  0, subspace rotation using ScaLAPACK took 8.031 ms
rank =  0, Distributing orbital back into band + domain format took 21.273 ms
rank = 0, Subspace_Rotation used 29.320 ms

Total time for subspace rotation: 29.327 ms
rank = 0, Efermi =  -0.053684401407 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.492 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.788 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.393 ms
rank = 0, Calculating density took 2131.971 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
rank = 0, D2D took 0.898 ms
rank = 0, Transfering density took 0.900 ms
Etot    =   -37.565505821789
Eband   =   -11.438931298265
E1      =    27.273982990091
E2      =   -10.185269500965
E3      =   -15.213372723883
Exc     =   -13.327376944124
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 6.621e-06, dEband = 9.482e-04
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -37.565505822, dEtot = 6.621e-06, dEband = 9.482e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0812937122117, which took 0.103 ms

iter_count = 108, r_2norm = 2.730e-06, tol*||rhs|| = 3.252e-06

Anderson update took 63.226 ms, out of which F'*F took 29.313 ms; b-Ax took 200.888 ms, out of which Lap took 178.167 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.820 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842539, int_b + int_rho = 5.821e-14, checking this took 0.116 ms
2-norm of RHS = 815.4790202283074, which took 0.147 ms

iter_count = 138, r_2norm = 6.511e-04, tol*||rhs|| = 8.155e-04

Anderson update took 80.890 ms, out of which F'*F took 37.208 ms; b-Ax took 256.971 ms, out of which Lap took 227.961 ms
Solving Poisson took 579.447 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.092059 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.087272 
Total time for convolution: 	 convolve: 5.089672 
Total time for convolution: 	 convolve: 5.080755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.530 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.603 ms

This SCF took 27484.587 ms, scf error = 3.638e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.137816, lowerbound = -0.806514, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2025.309 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.824 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.180 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.033 ms
rank =  0, finding HY took 32.845 ms
rank =  0, distributing HY into block cyclic form took 20.725 ms
rank =  0, finding Y'*HY took 5.817 ms
Rank 0, Project_Hamiltonian used 84.451 ms
Total time for projection: 84.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.806279634899835
    last  calculated eigval = 0.036401371592385
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53937041191081
lambda[   5] =  -0.45016073962976
lambda[   6] =  -0.41985261976908
lambda[   7] =  -0.38434071044756
lambda[   8] =  -0.38292466935522
lambda[   9] =  -0.33575849508626
lambda[  10] =  -0.31970728115092
lambda[  11] =  -0.28479239582221
lambda[  12] =  -0.21582789502010
lambda[  13] =  -0.17441178093197
lambda[  14] =  -0.02461664085641
lambda[  15] =  -0.00090925192617
lambda[  16] =   0.01336966202162
lambda[  17] =   0.02147194189713
lambda[  18] =   0.02380640713331
lambda[  19] =   0.03093644767487
lambda[  20] =   0.03640137159238
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.493 ms
rank =  0, Distributing orbital back into band + domain format took 21.030 ms
rank = 0, Subspace_Rotation used 28.536 ms

Total time for subspace rotation: 28.543 ms
rank = 0, Efermi =  -0.053190196685 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 5.434 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.317 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.325 ms
rank = 0, Calculating density took 2147.763 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.940 ms
rank = 0, D2D took 1.343 ms
rank = 0, Transfering density took 1.345 ms
Etot    =   -37.565531964286
Eband   =   -11.433093680715
E1      =    27.270720988649
E2      =   -10.182527179888
E3      =   -15.214050011072
Exc     =   -13.327913668842
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 2.179e-06, dEband = 4.865e-04
rank = 0, Calculating/Estimating energy took 1.782 ms, Etot = -37.565531964, dEtot = 2.179e-06, dEband = 4.865e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0402251362541, which took 0.135 ms

iter_count = 108, r_2norm = 1.524e-06, tol*||rhs|| = 1.609e-06

Anderson update took 64.014 ms, out of which F'*F took 29.340 ms; b-Ax took 202.451 ms, out of which Lap took 178.439 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.091 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842548, int_b + int_rho = 1.564e-13, checking this took 0.123 ms
2-norm of RHS = 815.4944924525141, which took 0.145 ms

iter_count = 174, r_2norm = 7.931e-04, tol*||rhs|| = 8.155e-04

Anderson update took 101.306 ms, out of which F'*F took 47.869 ms; b-Ax took 325.915 ms, out of which Lap took 290.657 ms
Solving Poisson took 723.196 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.084329 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.086328 
Total time for convolution: 	 convolve: 5.084908 
Total time for convolution: 	 convolve: 5.080061 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.772 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.427 ms
---Transfer Veff_loc: D2D took 1.637 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.874 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.546 ms

This SCF took 27624.169 ms, scf error = 2.969e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136401, lowerbound = -0.806280, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2028.181 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.856 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.227 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.110 ms
rank =  0, finding HY took 32.699 ms
rank =  0, distributing HY into block cyclic form took 20.638 ms
rank =  0, finding Y'*HY took 5.921 ms
Rank 0, Project_Hamiltonian used 84.397 ms
Total time for projection: 84.411 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.662 ms
rank = 0, Solve_Generalized_EigenProblem used 1.152 ms
    first calculated eigval = -0.805798319639473
    last  calculated eigval = 0.036394981352117
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53885955767585
lambda[   5] =  -0.44966141193344
lambda[   6] =  -0.41936065219086
lambda[   7] =  -0.38385141222587
lambda[   8] =  -0.38244477254016
lambda[   9] =  -0.33525297193128
lambda[  10] =  -0.31922103611637
lambda[  11] =  -0.28428242346085
lambda[  12] =  -0.21535448763301
lambda[  13] =  -0.17394786720588
lambda[  14] =  -0.02242020780023
lambda[  15] =   0.00049220521227
lambda[  16] =   0.01454745243764
lambda[  17] =   0.02370896186205
lambda[  18] =   0.02408577751781
lambda[  19] =   0.03431485339719
lambda[  20] =   0.03639498135212
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.170 ms
rank =  0, subspace rotation using ScaLAPACK took 7.443 ms
rank =  0, Distributing orbital back into band + domain format took 21.245 ms
rank = 0, Subspace_Rotation used 28.703 ms

Total time for subspace rotation: 28.712 ms
rank = 0, Efermi =  -0.050993763631 calculate fermi energy took 0.097 ms
rank = 0, --- Calculate rho: sum over local bands took 5.652 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.458 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.435 ms
rank = 0, Calculating density took 2152.192 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.009 ms
rank = 0, D2D took 1.193 ms
rank = 0, Transfering density took 1.200 ms
Etot    =   -37.565637608927
Eband   =   -11.420341776926
E1      =    27.264880304678
E2      =   -10.175396514011
E3      =   -15.214616326280
Exc     =   -13.328366182631
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 8.804e-06, dEband = 1.063e-03
rank = 0, Calculating/Estimating energy took 1.295 ms, Etot = -37.565637609, dEtot = 8.804e-06, dEband = 1.063e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0377843532183, which took 0.085 ms

iter_count = 108, r_2norm = 1.294e-06, tol*||rhs|| = 1.511e-06

Anderson update took 63.290 ms, out of which F'*F took 29.307 ms; b-Ax took 200.723 ms, out of which Lap took 178.065 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 457.620 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842548, int_b + int_rho = 1.564e-13, checking this took 0.121 ms
2-norm of RHS = 815.4937813694463, which took 0.149 ms

iter_count = 132, r_2norm = 7.470e-04, tol*||rhs|| = 8.155e-04

Anderson update took 77.267 ms, out of which F'*F took 35.505 ms; b-Ax took 245.913 ms, out of which Lap took 218.462 ms
Solving Poisson took 554.308 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.085358 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.239 ms
Total time for convolution: 	 convolve: 5.078146 
Total time for convolution: 	 convolve: 5.090310 
Total time for convolution: 	 convolve: 5.105525 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 1.715 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.879 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.628 ms

This SCF took 27504.547 ms, scf error = 1.996e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136395, lowerbound = -0.805798, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2020.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.973 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.256 ms
rank =  0, finding HY took 32.396 ms
rank =  0, distributing HY into block cyclic form took 20.638 ms
rank =  0, finding Y'*HY took 5.967 ms
Rank 0, Project_Hamiltonian used 85.059 ms
Total time for projection: 85.081 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.805635689851180
    last  calculated eigval = 0.036450238389561
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53869993971064
lambda[   5] =  -0.44950637227891
lambda[   6] =  -0.41920243741772
lambda[   7] =  -0.38369204736680
lambda[   8] =  -0.38228326744283
lambda[   9] =  -0.33509867661171
lambda[  10] =  -0.31906704633051
lambda[  11] =  -0.28413301113054
lambda[  12] =  -0.21518330475604
lambda[  13] =  -0.17378220755823
lambda[  14] =  -0.02163732577103
lambda[  15] =   0.00063941036427
lambda[  16] =   0.01477406074950
lambda[  17] =   0.02423630684906
lambda[  18] =   0.02464295345321
lambda[  19] =   0.03609795712099
lambda[  20] =   0.03645023838956
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 7.471 ms
rank =  0, Distributing orbital back into band + domain format took 21.190 ms
rank = 0, Subspace_Rotation used 28.673 ms

Total time for subspace rotation: 28.679 ms
rank = 0, Efermi =  -0.050210881615 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 5.660 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.301 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.431 ms
rank = 0, Calculating density took 2143.667 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.013 ms
rank = 0, D2D took 1.194 ms
rank = 0, Transfering density took 1.202 ms
Etot    =   -37.565663472795
Eband   =   -11.416187470177
E1      =    27.262609519317
E2      =   -10.173402092539
E3      =   -15.215028794254
Exc     =   -13.328693614389
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 2.155e-06, dEband = 3.462e-04
rank = 0, Calculating/Estimating energy took 1.240 ms, Etot = -37.565663473, dEtot = 2.155e-06, dEband = 3.462e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0266923841469, which took 0.065 ms

iter_count = 108, r_2norm = 9.406e-07, tol*||rhs|| = 1.068e-06

Anderson update took 63.188 ms, out of which F'*F took 29.399 ms; b-Ax took 202.657 ms, out of which Lap took 178.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 455.453 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842549, int_b + int_rho = 1.637e-13, checking this took 0.137 ms
2-norm of RHS = 815.4964769509471, which took 0.116 ms

iter_count = 132, r_2norm = 7.844e-04, tol*||rhs|| = 8.155e-04

Anderson update took 76.719 ms, out of which F'*F took 36.490 ms; b-Ax took 247.465 ms, out of which Lap took 220.817 ms
Solving Poisson took 549.131 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.165 ms
Total time for convolution: 	 convolve: 5.083586 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.086196 
Total time for convolution: 	 convolve: 5.087331 
Total time for convolution: 	 convolve: 5.093051 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.830 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 1.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.915 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.662 ms

This SCF took 27472.524 ms, scf error = 1.309e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136450, lowerbound = -0.805636, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2005.714 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.714 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.283 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.026 ms
rank =  0, finding HY took 32.749 ms
rank =  0, distributing HY into block cyclic form took 20.687 ms
rank =  0, finding Y'*HY took 5.892 ms
Rank 0, Project_Hamiltonian used 84.390 ms
Total time for projection: 84.403 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.805585447534049
    last  calculated eigval = 0.037402071905041
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53863377875269
lambda[   5] =  -0.44944373165841
lambda[   6] =  -0.41914248044841
lambda[   7] =  -0.38363557488513
lambda[   8] =  -0.38223096779285
lambda[   9] =  -0.33503341228510
lambda[  10] =  -0.31900642740304
lambda[  11] =  -0.28406215811429
lambda[  12] =  -0.21512430459995
lambda[  13] =  -0.17372857466446
lambda[  14] =  -0.02161139413495
lambda[  15] =  -0.00003296930207
lambda[  16] =   0.01411050899289
lambda[  17] =   0.02454013008310
lambda[  18] =   0.02517030080983
lambda[  19] =   0.03598713891496
lambda[  20] =   0.03740207190504
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 7.512 ms
rank =  0, Distributing orbital back into band + domain format took 21.218 ms
rank = 0, Subspace_Rotation used 28.744 ms

Total time for subspace rotation: 28.750 ms
rank = 0, Efermi =  -0.050184949964 calculate fermi energy took 0.110 ms
rank = 0, --- Calculate rho: sum over local bands took 5.587 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.371 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.419 ms
rank = 0, Calculating density took 2129.063 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.039 ms
rank = 0, D2D took 1.232 ms
rank = 0, Transfering density took 1.236 ms
Etot    =   -37.565690496685
Eband   =   -11.414656963500
E1      =    27.262131524030
E2      =   -10.172361348430
E3      =   -15.214862548372
Exc     =   -13.328566159677
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 2.252e-06, dEband = 1.275e-04
rank = 0, Calculating/Estimating energy took 1.261 ms, Etot = -37.565690497, dEtot = 2.252e-06, dEband = 1.275e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0269078772917, which took 0.059 ms

iter_count = 108, r_2norm = 8.612e-07, tol*||rhs|| = 1.076e-06

Anderson update took 63.482 ms, out of which F'*F took 29.290 ms; b-Ax took 200.098 ms, out of which Lap took 177.799 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.973 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842551, int_b + int_rho = 1.819e-13, checking this took 0.117 ms
2-norm of RHS = 815.4943599345465, which took 0.151 ms

iter_count = 90, r_2norm = 7.324e-04, tol*||rhs|| = 8.155e-04

Anderson update took 52.465 ms, out of which F'*F took 24.233 ms; b-Ax took 167.392 ms, out of which Lap took 148.789 ms
Solving Poisson took 378.618 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.088973 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.093315 
Total time for convolution: 	 convolve: 5.090108 
Total time for convolution: 	 convolve: 5.082359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.695 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.001 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.957 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.866 ms

This SCF took 27291.226 ms, scf error = 1.315e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137402, lowerbound = -0.805585, upperbound = 267.581367

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1998.909 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.749 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.257 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.033 ms
rank =  0, finding HY took 32.757 ms
rank =  0, distributing HY into block cyclic form took 20.757 ms
rank =  0, finding Y'*HY took 5.793 ms
Rank 0, Project_Hamiltonian used 84.368 ms
Total time for projection: 84.381 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -0.805485323626409
    last  calculated eigval = 0.037651365836314
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53854404197881
lambda[   5] =  -0.44935567205792
lambda[   6] =  -0.41905550486786
lambda[   7] =  -0.38353998185614
lambda[   8] =  -0.38212981305858
lambda[   9] =  -0.33494740463984
lambda[  10] =  -0.31891470892108
lambda[  11] =  -0.28398000728934
lambda[  12] =  -0.21503277127213
lambda[  13] =  -0.17363750113855
lambda[  14] =  -0.02135334643422
lambda[  15] =   0.00014844035917
lambda[  16] =   0.01427062833806
lambda[  17] =   0.02455223935960
lambda[  18] =   0.02556619786008
lambda[  19] =   0.03600110324154
lambda[  20] =   0.03765136583631
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 7.485 ms
rank =  0, Distributing orbital back into band + domain format took 21.325 ms
rank = 0, Subspace_Rotation used 28.824 ms

Total time for subspace rotation: 28.831 ms
rank = 0, Efermi =  -0.049926902280 calculate fermi energy took 0.096 ms
rank = 0, --- Calculate rho: sum over local bands took 5.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.215 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.362 ms
rank = 0, Calculating density took 2121.553 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.111 ms
rank = 0, D2D took 1.301 ms
rank = 0, Transfering density took 1.305 ms
Etot    =   -37.565700822869
Eband   =   -11.412259737751
E1      =    27.260692021316
E2      =   -10.171330345953
E3      =   -15.215159001119
Exc     =   -13.328799659167
Esc     =   -65.471822793207
Entropy =    -0.000000001132
dE = 8.605e-07, dEband = 1.998e-04
rank = 0, Calculating/Estimating energy took 1.439 ms, Etot = -37.565700823, dEtot = 8.605e-07, dEband = 1.998e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0185620823156, which took 0.057 ms

iter_count = 108, r_2norm = 5.988e-07, tol*||rhs|| = 7.425e-07

Anderson update took 64.461 ms, out of which F'*F took 29.472 ms; b-Ax took 214.071 ms, out of which Lap took 190.956 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.290 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000003842533, int_rho =  26.00000003842545, int_b + int_rho = 1.201e-13, checking this took 0.076 ms
2-norm of RHS = 815.4942989591883, which took 0.180 ms

iter_count = 126, r_2norm = 7.244e-04, tol*||rhs|| = 8.155e-04

Anderson update took 72.861 ms, out of which F'*F took 34.640 ms; b-Ax took 236.077 ms, out of which Lap took 210.263 ms
Solving Poisson took 523.712 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.095891 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.082526 
Total time for convolution: 	 convolve: 5.081831 
Total time for convolution: 	 convolve: 5.091475 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 1.537 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.455 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.015 ms

This SCF took 27896.725 ms, scf error = 8.485e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.53854404197881, occ[   4] =   2.00000000000000
lambda[   5] =  -0.44935567205792, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41905550486786, occ[   6] =   2.00000000000000
lambda[   7] =  -0.38353998185614, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38212981305858, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33494740463984, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31891470892108, occ[  10] =   2.00000000000000
lambda[  11] =  -0.28398000728934, occ[  11] =   2.00000000000000
lambda[  12] =  -0.21503277127213, occ[  12] =   2.00000000000000
lambda[  13] =  -0.17363750113855, occ[  13] =   2.00000000000000
lambda[  14] =  -0.02135334643422, occ[  14] =   0.00000003842546
lambda[  15] =   0.00014844035917, occ[  15] =   0.00000000000000
lambda[  16] =   0.01427062833806, occ[  16] =   0.00000000000000
lambda[  17] =   0.02455223935960, occ[  17] =   0.00000000000000
lambda[  18] =   0.02556619786008, occ[  18] =   0.00000000000000
lambda[  19] =   0.03600110324154, occ[  19] =   0.00000000000000
lambda[  20] =   0.03765136583631, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.571 ms, time for Allreduce/Reduce: 12.130 ms 
Time for calculating local force components: 22.931 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.03767919626040   0.00266496261109  -0.05097331540582
 -0.03767920473083   0.00266493752640   0.05097333498495
  0.03767913541659  -0.00266495085251  -0.05097327281642
  0.03767913951277  -0.00266496828903   0.05097330484460
  0.03004455451607   0.00132812987271   0.03892116882221
  0.03004453583459   0.00132811078001  -0.03892113467193
 -0.03004463467017  -0.00132809097566   0.03892126060639
 -0.03004458639795  -0.00132805728719  -0.03892112402711
 -0.04252426325014   0.09795517691804   0.00000184597175
  0.04252394550108  -0.09795525814212   0.00000032331288
 -0.42451207287050  -0.55541342983488  -0.00000056677660
  0.42451001901940   0.55541297312666   0.00000116354649
force_loc = 
  0.03813526054904  -0.00440016089098   0.05276631677425
  0.03813436305157  -0.00439994073234  -0.05276570016684
 -0.03813449666155   0.00440070374804   0.05276627286991
 -0.03813448362486   0.00440069447464  -0.05276626508648
 -0.03080972618535  -0.00142786015464  -0.03989913449168
 -0.03080966432249  -0.00142704092334   0.03989920933433
  0.03081023053224   0.00142736573449  -0.03989948418733
  0.03080929129643   0.00142663047472   0.03989761095233
  0.04129624684308  -0.09436487338992   0.00000057937866
 -0.04129650729011   0.09436493759678   0.00000048928022
  0.41222369468864   0.53927759006511  -0.00000010940017
 -0.41222435517756  -0.53927848334554  -0.00000026815792
Time for calculating nonlocal force components: 49.878 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00347092772786  -0.00417114126772   0.00000002210703
[0m[32m -0.00347099635456   0.00417121692599   0.00000003013807
[0m[32m  0.01017207170335   0.01606002052630  -0.00000000701600
[0m[32m -0.01017219949120  -0.01606004721914  -0.00000003171559
[0mTime for calculating XC forces components: 33.747 ms
 Cartesian force = 
  0.00045631187989  -0.00173512720289   0.00179279145141
  0.00045540591198  -0.00173493212894  -0.00179257509890
 -0.00045511365372   0.00173582397253   0.00179279013647
 -0.00045509652084   0.00173579726261  -0.00179317015890
 -0.00076492407803  -0.00009965920493  -0.00097817558648
 -0.00076488089665  -0.00009885906633   0.00097786474539
  0.00076584345332   0.00009934583583  -0.00097843349795
  0.00076495248973   0.00009864426454   0.00097627700820
  0.00224315891205  -0.00058076666260   0.00000223754043
 -0.00224331055234   0.00058096745766   0.00000063281415
 -0.00211605888726  -0.00007574816647  -0.00000089310978
  0.00211371194188   0.00007451363899   0.00000065375597
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.365 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 378.757 ms
The program took 480.130 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:44
Job ID:        2266741
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:39:36,vmem=8392K,walltime=00:08:18,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-28-1
---------------------------------------
