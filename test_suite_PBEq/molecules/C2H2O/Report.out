---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:20
Job ID:    2266776
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:25
Job ID:    2266776
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.071 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 31.644 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.013 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 33.334 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 116.336 ms

Freeing SPARC_INPUT_MPI datatype took 0.018 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.011 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.117 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   11.600054	
   10.000000	   13.125560	    8.399946	
   10.000000	    6.874440	    8.399946	
   10.000000	   11.204532	    9.029745	
   10.000000	    8.795468	    9.029745	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.007 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.212 ms
Set up communicators.

--set up spincomm took 3.951 ms

--set up kptcomm took 0.370 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.014 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.052 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.053 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.968 ms

Calculate_SplineDerivRadFun took 0.217 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.232 ms.
time spent on vectorized spline interp: 2.719 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.078 ms.
time spent on vectorized spline interp: 1.290 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.278 ms.
time spent on vectorized spline interp: 1.609 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.477 ms.

Calculating rb for all atom types took 14.711 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.022 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000109522, sum_int_rho = 15.7909369189021
PosCharge = 16.000000010952, NegCharge = -15.790936918902, scal_fac = 1.013239435578
After scaling, int_rho = 16.0000000109522, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.358 ms
--Calculate rho_guess took 2.050 ms

 integral of b = -16.0000000109522,
 int{b} + Nelectron + NetCharge = -1.095e-08,
 Esc = -47.6240584828136,
 MPI_Reduce took 4.464 ms

Calculating b & b_ref took 12.354 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.011 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.021 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.287 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095217, int_b + int_rho = -2.237e-13, checking this took 0.086 ms
2-norm of RHS = 546.6601079344371, which took 0.072 ms

iter_count = 420, r_2norm = 5.290e-04, tol*||rhs|| = 5.467e-04

Anderson update took 197.022 ms, out of which F'*F took 96.508 ms; b-Ax took 638.903 ms, out of which Lap took 588.232 ms
Solving Poisson took 1241.462 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.310 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
Total time for convolution: 	 convolve: 5.116682 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
Total time for convolution: 	 convolve: 5.124724 
Total time for convolution: 	 convolve: 5.213789 
Total time for convolution: 	 convolve: 5.106043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.161 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.479 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
rank = 0, XC calculation took 24422.490 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 1.072 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.788 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 2.953 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.136 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.462 ms
    Lanczos iter 54, eigmin  = -1.053052427, eigmax = 264.931333543, err_eigmin = 5.223e-04, err_eigmax = 9.610e-03
rank =   0, Lanczos took 100.913 ms, eigmin = -1.053052426539, eigmax = 267.580646878549

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.213797, lowerbound = -1.153052, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 922.789 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 11.023 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.395 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.559 ms
rank =  0, Distribute data + matrix mult took 13.993 ms
rank =  0, finding HY took 16.953 ms
rank =  0, distributing HY into block cyclic form took 10.781 ms
rank =  0, finding Y'*HY took 1.860 ms
Rank 0, Project_Hamiltonian used 43.612 ms
Total time for projection: 43.622 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.334 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.272 ms
rank = 0, Solve_Generalized_EigenProblem used 1.254 ms
    first calculated eigval = 2.785675410313220
    last  calculated eigval = 3.186964772142234
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.78567541031322
lambda[   2] =   2.85115570274030
lambda[   3] =   2.85742351150512
lambda[   4] =   2.89348799270460
lambda[   5] =   2.95416816504531
lambda[   6] =   2.99078069659917
lambda[   7] =   3.00874705665488
lambda[   8] =   3.05250645481308
lambda[   9] =   3.06619910336567
lambda[  10] =   3.09482794436454
lambda[  11] =   3.12045545959670
lambda[  12] =   3.13140486161464
lambda[  13] =   3.15944329691856
lambda[  14] =   3.18696477214223
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.272 ms
rank =  0, subspace rotation using ScaLAPACK took 2.243 ms
rank =  0, Distributing orbital back into band + domain format took 9.511 ms
rank = 0, Subspace_Rotation used 11.765 ms

Total time for subspace rotation: 11.770 ms
rank = 0, Efermi =   3.059352779174 calculate fermi energy took 0.127 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.286965, lowerbound = -1.153052, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 902.338 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.512 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.296 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 16.938 ms
rank =  0, finding HY took 16.056 ms
rank =  0, distributing HY into block cyclic form took 9.603 ms
rank =  0, finding Y'*HY took 1.851 ms
Rank 0, Project_Hamiltonian used 44.476 ms
Total time for projection: 44.488 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.906465092794582
    last  calculated eigval = 0.433057636185439
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.90646509279458
lambda[   2] =  -0.51022307582779
lambda[   3] =  -0.21791018854099
lambda[   4] =  -0.11522198624755
lambda[   5] =   0.01471475852297
lambda[   6] =   0.09754603966711
lambda[   7] =   0.19706346519833
lambda[   8] =   0.28612738257726
lambda[   9] =   0.31742737598130
lambda[  10] =   0.33548885587355
lambda[  11] =   0.35377602442121
lambda[  12] =   0.38554901204876
lambda[  13] =   0.39390909572733
lambda[  14] =   0.43305763618544
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 2.221 ms
rank =  0, Distributing orbital back into band + domain format took 9.420 ms
rank = 0, Subspace_Rotation used 11.651 ms

Total time for subspace rotation: 11.655 ms
rank = 0, Efermi =   0.301777382574 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.533058, lowerbound = -1.153052, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 906.408 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 14.096 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.303 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 15.464 ms
rank =  0, finding HY took 16.125 ms
rank =  0, distributing HY into block cyclic form took 9.602 ms
rank =  0, finding Y'*HY took 1.729 ms
Rank 0, Project_Hamiltonian used 43.903 ms
Total time for projection: 43.906 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -1.056340617744176
    last  calculated eigval = 0.129201983445020
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05634061774418
lambda[   2] =  -0.74659691862268
lambda[   3] =  -0.62540529207107
lambda[   4] =  -0.57065487740308
lambda[   5] =  -0.43073373439599
lambda[   6] =  -0.43054899849954
lambda[   7] =  -0.39540860538926
lambda[   8] =  -0.22606988065376
lambda[   9] =   0.02352877320352
lambda[  10] =   0.04537567118693
lambda[  11] =   0.08972574635537
lambda[  12] =   0.09337377319969
lambda[  13] =   0.10897902379035
lambda[  14] =   0.12920198344502
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 2.204 ms
rank =  0, Distributing orbital back into band + domain format took 9.480 ms
rank = 0, Subspace_Rotation used 11.695 ms

Total time for subspace rotation: 11.699 ms
rank = 0, Efermi =  -0.006174345986 calculate fermi energy took 0.019 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.229202, lowerbound = -1.153052, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 889.425 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 20.336 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.279 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.165 ms
rank =  0, Distribute data + matrix mult took 21.791 ms
rank =  0, finding HY took 16.026 ms
rank =  0, distributing HY into block cyclic form took 9.598 ms
rank =  0, finding Y'*HY took 1.865 ms
Rank 0, Project_Hamiltonian used 49.303 ms
Total time for projection: 49.308 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.056455252151923
    last  calculated eigval = 0.067141680820933
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.05645525215192
lambda[   2] =  -0.74744369557629
lambda[   3] =  -0.63119305283757
lambda[   4] =  -0.57741630319167
lambda[   5] =  -0.44298050779988
lambda[   6] =  -0.43634565619414
lambda[   7] =  -0.40925673802031
lambda[   8] =  -0.25595442665999
lambda[   9] =  -0.08079846961465
lambda[  10] =  -0.03956259156621
lambda[  11] =   0.01838702748668
lambda[  12] =   0.02672693502171
lambda[  13] =   0.04378912836563
lambda[  14] =   0.06714168082093
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 2.202 ms
rank =  0, Distributing orbital back into band + domain format took 9.502 ms
rank = 0, Subspace_Rotation used 11.713 ms

Total time for subspace rotation: 11.717 ms
rank = 0, Efermi =  -0.110501589016 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 1.563 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.616 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 3956.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.312 ms
rank = 0, D2D took 1.406 ms
rank = 0, Transfering density took 1.413 ms
Etot    =   -29.673820199273
Eband   =    -9.114091265748
E1      =    18.399450182922
E2      =    -7.728415070375
E3      =    -9.678546893851
Exc     =    -8.742082597524
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 5.935e+00, dEband = 1.823e+00
rank = 0, Calculating/Estimating energy took 0.781 ms, Etot = -29.673820199, dEtot = 5.935e+00, dEband = 1.823e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.8958888857450, which took 0.132 ms

iter_count = 90, r_2norm = 2.048e-03, tol*||rhs|| = 2.476e-03

Anderson update took 39.596 ms, out of which F'*F took 20.304 ms; b-Ax took 131.003 ms, out of which Lap took 121.009 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 255.410 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095216, int_b + int_rho = -2.256e-13, checking this took 0.106 ms
2-norm of RHS = 543.8487528589887, which took 0.108 ms

iter_count = 288, r_2norm = 4.214e-04, tol*||rhs|| = 5.438e-04

Anderson update took 129.060 ms, out of which F'*F took 65.352 ms; b-Ax took 416.390 ms, out of which Lap took 385.961 ms
Solving Poisson took 801.931 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.267 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.061811 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.736 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.062991 
Total time for convolution: 	 convolve: 5.077520 
Total time for convolution: 	 convolve: 5.157467 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.255 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.560 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.003 ms

This SCF took 29458.413 ms, scf error = 1.646e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.167142, lowerbound = -1.056455, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 911.650 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.748 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.345 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 11.134 ms
rank =  0, finding HY took 16.215 ms
rank =  0, distributing HY into block cyclic form took 9.679 ms
rank =  0, finding Y'*HY took 3.015 ms
Rank 0, Project_Hamiltonian used 40.077 ms
Total time for projection: 40.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -1.028075119938888
    last  calculated eigval = 0.052005095038698
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02807511993889
lambda[   2] =  -0.71252672831838
lambda[   3] =  -0.61220662171774
lambda[   4] =  -0.55309892512257
lambda[   5] =  -0.41838162021391
lambda[   6] =  -0.40631413261075
lambda[   7] =  -0.38630227761702
lambda[   8] =  -0.22887820485288
lambda[   9] =  -0.10258467189697
lambda[  10] =  -0.04009556243371
lambda[  11] =   0.00111506165016
lambda[  12] =   0.00759998325375
lambda[  13] =   0.02452162595958
lambda[  14] =   0.05200509503870
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 2.212 ms
rank =  0, Distributing orbital back into band + domain format took 9.573 ms
rank = 0, Subspace_Rotation used 11.798 ms

Total time for subspace rotation: 11.802 ms
rank = 0, Efermi =  -0.132287791227 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.682 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.520 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.708 ms
rank = 0, Calculating density took 967.125 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.391 ms
rank = 0, D2D took 0.504 ms
rank = 0, Transfering density took 0.506 ms
Etot    =   -29.643414358970
Eband   =    -8.691567261908
E1      =    18.045569720200
E2      =    -7.669735188934
E3      =    -9.784083097956
Exc     =    -8.827176621004
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 6.081e-03, dEband = 8.450e-02
rank = 0, Calculating/Estimating energy took 0.823 ms, Etot = -29.643414359, dEtot = 6.081e-03, dEband = 8.450e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.5148786633133, which took 0.068 ms

iter_count = 102, r_2norm = 4.579e-04, tol*||rhs|| = 7.406e-04

Anderson update took 43.070 ms, out of which F'*F took 23.223 ms; b-Ax took 151.717 ms, out of which Lap took 139.246 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.811 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095215, int_b + int_rho = -2.365e-13, checking this took 0.075 ms
2-norm of RHS = 540.6854542953113, which took 0.156 ms

iter_count = 300, r_2norm = 5.354e-04, tol*||rhs|| = 5.407e-04

Anderson update took 127.265 ms, out of which F'*F took 68.863 ms; b-Ax took 447.877 ms, out of which Lap took 411.897 ms
Solving Poisson took 842.430 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.511 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Total time for convolution: 	 convolve: 5.084542 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.768 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.089229 
Total time for convolution: 	 convolve: 5.089212 
Total time for convolution: 	 convolve: 5.086110 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.287 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.118 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.463 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26478.256 ms, scf error = 1.133e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.152005, lowerbound = -1.028075, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 958.793 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.955 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.660 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.080 ms
rank =  0, Distribute data + matrix mult took 11.705 ms
rank =  0, finding HY took 17.025 ms
rank =  0, distributing HY into block cyclic form took 10.010 ms
rank =  0, finding Y'*HY took 1.938 ms
Rank 0, Project_Hamiltonian used 40.707 ms
Total time for projection: 40.719 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.979611953874926
    last  calculated eigval = 0.046560034153427
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.97961195387493
lambda[   2] =  -0.65004461394396
lambda[   3] =  -0.57217945773883
lambda[   4] =  -0.50243359297978
lambda[   5] =  -0.37334339679727
lambda[   6] =  -0.35277586090775
lambda[   7] =  -0.34757005882714
lambda[   8] =  -0.18027630332125
lambda[   9] =  -0.07154505661129
lambda[  10] =  -0.02194751402467
lambda[  11] =  -0.00812110164166
lambda[  12] =   0.01659519127288
lambda[  13] =   0.03279014077155
lambda[  14] =   0.04656003415343
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 2.311 ms
rank =  0, Distributing orbital back into band + domain format took 9.954 ms
rank = 0, Subspace_Rotation used 12.681 ms

Total time for subspace rotation: 12.685 ms
rank = 0, Efermi =  -0.101248175929 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 2.082 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.393 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 1015.019 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
rank = 0, D2D took 0.501 ms
rank = 0, Transfering density took 0.507 ms
Etot    =   -29.613257254610
Eband   =    -7.916470477565
E1      =    17.432466169022
E2      =    -7.496078354102
E3      =    -9.997304783173
Exc     =    -8.998577600193
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 6.031e-03, dEband = 1.550e-01
rank = 0, Calculating/Estimating energy took 0.805 ms, Etot = -29.613257255, dEtot = 6.031e-03, dEband = 1.550e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.9770739989793, which took 0.062 ms

iter_count = 102, r_2norm = 2.145e-04, tol*||rhs|| = 2.391e-04

Anderson update took 45.293 ms, out of which F'*F took 23.740 ms; b-Ax took 151.054 ms, out of which Lap took 139.385 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 300.484 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095217, int_b + int_rho = -2.183e-13, checking this took 0.082 ms
2-norm of RHS = 541.3242279399785, which took 0.086 ms

iter_count = 264, r_2norm = 4.740e-04, tol*||rhs|| = 5.413e-04

Anderson update took 117.595 ms, out of which F'*F took 60.221 ms; b-Ax took 391.132 ms, out of which Lap took 361.286 ms
Solving Poisson took 757.136 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.144 ms
Total time for convolution: 	 convolve: 5.113552 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.124756 
Total time for convolution: 	 convolve: 5.114196 
Total time for convolution: 	 convolve: 5.112232 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 1.187 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.147 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.026 ms

This SCF took 26589.856 ms, scf error = 2.803e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.146560, lowerbound = -0.979612, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 925.332 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 10.026 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.323 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.044 ms
rank =  0, Distribute data + matrix mult took 11.407 ms
rank =  0, finding HY took 16.632 ms
rank =  0, distributing HY into block cyclic form took 9.818 ms
rank =  0, finding Y'*HY took 2.186 ms
Rank 0, Project_Hamiltonian used 40.073 ms
Total time for projection: 40.086 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.974996643715250
    last  calculated eigval = 0.040595619186863
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.97499664371525
lambda[   2] =  -0.64314325476027
lambda[   3] =  -0.56554273956171
lambda[   4] =  -0.49510683324767
lambda[   5] =  -0.36800826631882
lambda[   6] =  -0.34700813322527
lambda[   7] =  -0.34344071611649
lambda[   8] =  -0.17542078784305
lambda[   9] =  -0.06724869130394
lambda[  10] =  -0.02226847037951
lambda[  11] =  -0.01187788013416
lambda[  12] =   0.01331286006391
lambda[  13] =   0.03344110723261
lambda[  14] =   0.04059561918686
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 2.975 ms
rank =  0, Distributing orbital back into band + domain format took 9.190 ms
rank = 0, Subspace_Rotation used 12.182 ms

Total time for subspace rotation: 12.188 ms
rank = 0, Efermi =  -0.096951810521 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.555 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 980.662 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
rank = 0, D2D took 0.530 ms
rank = 0, Transfering density took 0.536 ms
Etot    =   -29.611808970945
Eband   =    -7.825334750314
E1      =    17.386329544042
E2      =    -7.446438640983
E3      =   -10.021320667433
Exc     =    -9.016504589941
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 2.897e-04, dEband = 1.823e-02
rank = 0, Calculating/Estimating energy took 0.783 ms, Etot = -29.611808971, dEtot = 2.897e-04, dEband = 1.823e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.7747283997071, which took 0.072 ms

iter_count = 108, r_2norm = 6.708e-05, tol*||rhs|| = 7.099e-05

Anderson update took 46.608 ms, out of which F'*F took 24.656 ms; b-Ax took 160.225 ms, out of which Lap took 147.410 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 317.112 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095207, int_b + int_rho = -3.183e-13, checking this took 0.086 ms
2-norm of RHS = 542.3225008570641, which took 0.106 ms

iter_count = 264, r_2norm = 4.925e-04, tol*||rhs|| = 5.423e-04

Anderson update took 115.886 ms, out of which F'*F took 60.807 ms; b-Ax took 395.161 ms, out of which Lap took 363.694 ms
Solving Poisson took 759.125 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.388 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.114662 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.113837 
Total time for convolution: 	 convolve: 5.114094 
Total time for convolution: 	 convolve: 5.115841 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.286 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 26546.188 ms, scf error = 1.610e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.140596, lowerbound = -0.974997, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 968.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.369 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 11.748 ms
rank =  0, finding HY took 16.553 ms
rank =  0, distributing HY into block cyclic form took 10.176 ms
rank =  0, finding Y'*HY took 2.098 ms
Rank 0, Project_Hamiltonian used 40.605 ms
Total time for projection: 40.619 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.042 ms
rank = 0, Solve_Generalized_EigenProblem used 0.125 ms
    first calculated eigval = -0.971271452710202
    last  calculated eigval = 0.036904646869530
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.97127145271020
lambda[   2] =  -0.63894303769045
lambda[   3] =  -0.56060848036102
lambda[   4] =  -0.49019641972886
lambda[   5] =  -0.36405904942349
lambda[   6] =  -0.34299478931037
lambda[   7] =  -0.33944770391837
lambda[   8] =  -0.17158194187994
lambda[   9] =  -0.06434081527447
lambda[  10] =  -0.02398981980729
lambda[  11] =  -0.01263797980731
lambda[  12] =   0.01113389431095
lambda[  13] =   0.03085316436756
lambda[  14] =   0.03690464686953
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 2.343 ms
rank =  0, Distributing orbital back into band + domain format took 9.329 ms
rank = 0, Subspace_Rotation used 11.689 ms

Total time for subspace rotation: 12.250 ms
rank = 0, Efermi =  -0.094043934443 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 1.567 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.643 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 1024.753 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
rank = 0, D2D took 0.660 ms
rank = 0, Transfering density took 0.667 ms
Etot    =   -29.610775778747
Eband   =    -7.758205750750
E1      =    17.371252542247
E2      =    -7.390348129643
E3      =   -10.035565637496
Exc     =    -9.025677854234
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 2.066e-04, dEband = 1.343e-02
rank = 0, Calculating/Estimating energy took 0.829 ms, Etot = -29.610775779, dEtot = 2.066e-04, dEband = 1.343e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6615272110962, which took 0.057 ms

iter_count = 114, r_2norm = 1.875e-05, tol*||rhs|| = 2.646e-05

Anderson update took 50.099 ms, out of which F'*F took 26.158 ms; b-Ax took 168.983 ms, out of which Lap took 155.377 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.947 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095223, int_b + int_rho = -1.546e-13, checking this took 0.082 ms
2-norm of RHS = 542.6278239012679, which took 0.130 ms

iter_count = 252, r_2norm = 4.332e-04, tol*||rhs|| = 5.426e-04

Anderson update took 109.142 ms, out of which F'*F took 57.880 ms; b-Ax took 376.553 ms, out of which Lap took 346.318 ms
Solving Poisson took 727.587 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Total time for convolution: 	 convolve: 5.116383 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.079101 
Total time for convolution: 	 convolve: 5.080135 
Total time for convolution: 	 convolve: 5.080058 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.517 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
---Transfer Veff_loc: D2D took 0.736 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.065 ms

This SCF took 26806.518 ms, scf error = 5.954e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.136905, lowerbound = -0.971271, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 953.506 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.219 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 11.614 ms
rank =  0, finding HY took 16.708 ms
rank =  0, distributing HY into block cyclic form took 10.122 ms
rank =  0, finding Y'*HY took 1.909 ms
Rank 0, Project_Hamiltonian used 40.385 ms
Total time for projection: 40.400 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.612 ms
rank = 0, Solve_Generalized_EigenProblem used 1.093 ms
    first calculated eigval = -0.967348137664464
    last  calculated eigval = 0.036214079675070
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.96734813766446
lambda[   2] =  -0.63576930409617
lambda[   3] =  -0.55802659467773
lambda[   4] =  -0.48750198254920
lambda[   5] =  -0.36080429247772
lambda[   6] =  -0.33952031252363
lambda[   7] =  -0.33566716411448
lambda[   8] =  -0.16795236306399
lambda[   9] =  -0.06244100942765
lambda[  10] =  -0.02608103886993
lambda[  11] =  -0.01244265697519
lambda[  12] =   0.00909498898199
lambda[  13] =   0.02551911289793
lambda[  14] =   0.03621407967507
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 1.107 ms
rank =  0, subspace rotation using ScaLAPACK took 2.483 ms
rank =  0, Distributing orbital back into band + domain format took 9.790 ms
rank = 0, Subspace_Rotation used 12.286 ms

Total time for subspace rotation: 12.291 ms
rank = 0, Efermi =  -0.092144128517 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.593 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.604 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.069 ms
rank = 0, Calculating density took 1009.745 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.413 ms
rank = 0, D2D took 0.632 ms
rank = 0, Transfering density took 0.634 ms
Etot    =   -29.610435012137
Eband   =    -7.705180303019
E1      =    17.349531024393
E2      =    -7.356351019259
E3      =   -10.044916118751
Exc     =    -9.031994388373
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 6.815e-05, dEband = 1.061e-02
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -29.610435012, dEtot = 6.815e-05, dEband = 1.061e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4488076425587, which took 0.146 ms

iter_count = 108, r_2norm = 1.730e-05, tol*||rhs|| = 1.795e-05

Anderson update took 47.503 ms, out of which F'*F took 24.570 ms; b-Ax took 160.383 ms, out of which Lap took 147.773 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 318.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095217, int_b + int_rho = -2.183e-13, checking this took 0.082 ms
2-norm of RHS = 542.8360818604648, which took 0.094 ms

iter_count = 252, r_2norm = 4.594e-04, tol*||rhs|| = 5.428e-04

Anderson update took 109.439 ms, out of which F'*F took 57.601 ms; b-Ax took 375.823 ms, out of which Lap took 345.524 ms
Solving Poisson took 729.213 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.148 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.151838 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.560 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.171 ms
Total time for convolution: 	 convolve: 5.123363 
Total time for convolution: 	 convolve: 5.136186 
Total time for convolution: 	 convolve: 5.122027 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.859 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.403 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.329 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.025 ms

This SCF took 26637.101 ms, scf error = 3.469e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.136214, lowerbound = -0.967348, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 937.279 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.970 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.314 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 11.337 ms
rank =  0, finding HY took 16.731 ms
rank =  0, distributing HY into block cyclic form took 10.100 ms
rank =  0, finding Y'*HY took 1.858 ms
Rank 0, Project_Hamiltonian used 40.512 ms
Total time for projection: 40.524 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.963190241970602
    last  calculated eigval = 0.036624056636013
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.96319024197060
lambda[   2] =  -0.63230819335712
lambda[   3] =  -0.55529168994095
lambda[   4] =  -0.48476847838407
lambda[   5] =  -0.35703014950702
lambda[   6] =  -0.33578845947974
lambda[   7] =  -0.33192705219595
lambda[   8] =  -0.16429582468635
lambda[   9] =  -0.05960835385371
lambda[  10] =  -0.02733130361649
lambda[  11] =  -0.01087638857159
lambda[  12] =   0.00727892474499
lambda[  13] =   0.02134978129073
lambda[  14] =   0.03662405663601
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.380 ms
rank =  0, Distributing orbital back into band + domain format took 9.833 ms
rank = 0, Subspace_Rotation used 12.224 ms

Total time for subspace rotation: 12.228 ms
rank = 0, Efermi =  -0.089311473269 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 1.581 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.693 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 992.610 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
rank = 0, D2D took 0.595 ms
rank = 0, Transfering density took 0.598 ms
Etot    =   -29.610283271846
Eband   =    -7.649200179696
E1      =    17.326153695983
E2      =    -7.321976299318
E3      =   -10.050220312767
Exc     =    -9.035374917070
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 3.035e-05, dEband = 1.120e-02
rank = 0, Calculating/Estimating energy took 0.867 ms, Etot = -29.610283272, dEtot = 3.035e-05, dEband = 1.120e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2817378968520, which took 0.154 ms

iter_count = 114, r_2norm = 7.109e-06, tol*||rhs|| = 1.127e-05

Anderson update took 50.286 ms, out of which F'*F took 26.107 ms; b-Ax took 169.296 ms, out of which Lap took 155.704 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 335.227 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095217, int_b + int_rho = -2.219e-13, checking this took 0.075 ms
2-norm of RHS = 542.7970075825751, which took 0.101 ms

iter_count = 234, r_2norm = 4.427e-04, tol*||rhs|| = 5.428e-04

Anderson update took 100.086 ms, out of which F'*F took 53.754 ms; b-Ax took 352.272 ms, out of which Lap took 322.979 ms
Solving Poisson took 675.548 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.120486 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.134246 
Total time for convolution: 	 convolve: 5.130010 
Total time for convolution: 	 convolve: 5.119515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.606 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.181 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.029 ms

This SCF took 26552.109 ms, scf error = 1.995e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.136624, lowerbound = -0.963190, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 927.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 10.149 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.271 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 11.470 ms
rank =  0, finding HY took 16.655 ms
rank =  0, distributing HY into block cyclic form took 10.222 ms
rank =  0, finding Y'*HY took 1.948 ms
Rank 0, Project_Hamiltonian used 40.794 ms
Total time for projection: 40.806 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.960423767995538
    last  calculated eigval = 0.036725830717122
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.96042376799554
lambda[   2] =  -0.62969438706010
lambda[   3] =  -0.55346080802028
lambda[   4] =  -0.48273636511502
lambda[   5] =  -0.35450704282306
lambda[   6] =  -0.33313140036150
lambda[   7] =  -0.32948599192105
lambda[   8] =  -0.16172601910656
lambda[   9] =  -0.05756870375810
lambda[  10] =  -0.02763876256645
lambda[  11] =  -0.00957468750373
lambda[  12] =   0.00607145955099
lambda[  13] =   0.01932908163916
lambda[  14] =   0.03672583071712
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 2.423 ms
rank =  0, Distributing orbital back into band + domain format took 9.780 ms
rank = 0, Subspace_Rotation used 12.214 ms

Total time for subspace rotation: 12.219 ms
rank = 0, Efermi =  -0.087271822908 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.631 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.651 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 982.837 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.401 ms
rank = 0, D2D took 0.600 ms
rank = 0, Transfering density took 0.602 ms
Etot    =   -29.610299514898
Eband   =    -7.610331565437
E1      =    17.304116255289
E2      =    -7.303908038999
E3      =   -10.055434514405
Exc     =    -9.039368275006
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 3.249e-06, dEband = 7.774e-03
rank = 0, Calculating/Estimating energy took 0.876 ms, Etot = -29.610299515, dEtot = 3.249e-06, dEband = 7.774e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1608067733866, which took 0.112 ms

iter_count = 108, r_2norm = 6.223e-06, tol*||rhs|| = 6.432e-06

Anderson update took 47.556 ms, out of which F'*F took 24.492 ms; b-Ax took 159.580 ms, out of which Lap took 146.910 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 317.321 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095222, int_b + int_rho = -1.746e-13, checking this took 0.083 ms
2-norm of RHS = 542.7952384228045, which took 0.082 ms

iter_count = 228, r_2norm = 4.738e-04, tol*||rhs|| = 5.428e-04

Anderson update took 97.733 ms, out of which F'*F took 52.144 ms; b-Ax took 341.057 ms, out of which Lap took 312.516 ms
Solving Poisson took 656.782 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.167 ms
Total time for convolution: 	 convolve: 5.134216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.160106 
Total time for convolution: 	 convolve: 5.116033 
Total time for convolution: 	 convolve: 5.132605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.374 ms
---Transfer Veff_loc: D2D took 0.633 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26544.647 ms, scf error = 1.305e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.136726, lowerbound = -0.960424, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 936.095 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.317 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.054 ms
rank =  0, Distribute data + matrix mult took 11.535 ms
rank =  0, finding HY took 16.701 ms
rank =  0, distributing HY into block cyclic form took 10.281 ms
rank =  0, finding Y'*HY took 1.871 ms
Rank 0, Project_Hamiltonian used 40.419 ms
Total time for projection: 40.431 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.959269930884189
    last  calculated eigval = 0.037211558861710
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95926993088419
lambda[   2] =  -0.62850423199883
lambda[   3] =  -0.55230281427657
lambda[   4] =  -0.48160636426251
lambda[   5] =  -0.35325776976964
lambda[   6] =  -0.33191264571462
lambda[   7] =  -0.32824670793928
lambda[   8] =  -0.16047714529942
lambda[   9] =  -0.05613483005930
lambda[  10] =  -0.02551469520534
lambda[  11] =  -0.00794884365118
lambda[  12] =   0.00806130272682
lambda[  13] =   0.02042335545987
lambda[  14] =   0.03721155886171
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 2.392 ms
rank =  0, Distributing orbital back into band + domain format took 10.024 ms
rank = 0, Subspace_Rotation used 12.427 ms

Total time for subspace rotation: 12.431 ms
rank = 0, Efermi =  -0.085837949264 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.710 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 991.549 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.412 ms
rank = 0, D2D took 0.590 ms
rank = 0, Transfering density took 0.592 ms
Etot    =   -29.610392610850
Eband   =    -7.591155220905
E1      =    17.296584000395
E2      =    -7.292213158887
E3      =   -10.055424521074
Exc     =    -9.039400587152
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.862e-05, dEband = 3.835e-03
rank = 0, Calculating/Estimating energy took 0.870 ms, Etot = -29.610392611, dEtot = 1.862e-05, dEband = 3.835e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1151831400961, which took 0.130 ms

iter_count = 114, r_2norm = 3.047e-06, tol*||rhs|| = 4.607e-06

Anderson update took 50.234 ms, out of which F'*F took 26.030 ms; b-Ax took 169.130 ms, out of which Lap took 155.644 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 335.718 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095212, int_b + int_rho = -2.728e-13, checking this took 0.104 ms
2-norm of RHS = 542.7888989638960, which took 0.117 ms

iter_count = 198, r_2norm = 4.823e-04, tol*||rhs|| = 5.428e-04

Anderson update took 85.983 ms, out of which F'*F took 45.388 ms; b-Ax took 304.441 ms, out of which Lap took 280.628 ms
Solving Poisson took 581.874 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.083472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.547 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.079790 
Total time for convolution: 	 convolve: 5.083474 
Total time for convolution: 	 convolve: 5.081352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
---Transfer Veff_loc: D2D took 0.637 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.640 ms

This SCF took 26349.910 ms, scf error = 7.795e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137212, lowerbound = -0.959270, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 927.188 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.305 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 11.497 ms
rank =  0, finding HY took 16.620 ms
rank =  0, distributing HY into block cyclic form took 10.211 ms
rank =  0, finding Y'*HY took 1.942 ms
Rank 0, Project_Hamiltonian used 40.300 ms
Total time for projection: 40.315 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.958315571822540
    last  calculated eigval = 0.036515550467866
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95831557182254
lambda[   2] =  -0.62764046184773
lambda[   3] =  -0.55150915266502
lambda[   4] =  -0.48080039077554
lambda[   5] =  -0.35238377103593
lambda[   6] =  -0.33104286816896
lambda[   7] =  -0.32735850170846
lambda[   8] =  -0.15959676109171
lambda[   9] =  -0.05530354443823
lambda[  10] =  -0.02388182652949
lambda[  11] =  -0.00734078677779
lambda[  12] =   0.00947872431290
lambda[  13] =   0.02135666903449
lambda[  14] =   0.03651555046787
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 2.454 ms
rank =  0, Distributing orbital back into band + domain format took 9.990 ms
rank = 0, Subspace_Rotation used 12.456 ms

Total time for subspace rotation: 12.460 ms
rank = 0, Efermi =  -0.085006663583 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.585 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.638 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.065 ms
rank = 0, Calculating density took 982.494 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.407 ms
rank = 0, D2D took 0.679 ms
rank = 0, Transfering density took 0.681 ms
Etot    =   -29.610449426860
Eband   =    -7.577294958837
E1      =    17.289219788773
E2      =    -7.285387090747
E3      =   -10.056843053144
Exc     =    -9.040545917538
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.136e-05, dEband = 2.772e-03
rank = 0, Calculating/Estimating energy took 0.846 ms, Etot = -29.610449427, dEtot = 1.136e-05, dEband = 2.772e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1027842930484, which took 0.054 ms

iter_count = 108, r_2norm = 3.488e-06, tol*||rhs|| = 4.111e-06

Anderson update took 51.816 ms, out of which F'*F took 25.818 ms; b-Ax took 161.501 ms, out of which Lap took 148.614 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 323.537 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095216, int_b + int_rho = -2.292e-13, checking this took 0.090 ms
2-norm of RHS = 542.7870051015100, which took 0.069 ms

iter_count = 192, r_2norm = 4.591e-04, tol*||rhs|| = 5.428e-04

Anderson update took 82.554 ms, out of which F'*F took 43.966 ms; b-Ax took 287.793 ms, out of which Lap took 263.582 ms
Solving Poisson took 555.254 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.122092 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.127335 
Total time for convolution: 	 convolve: 5.104293 
Total time for convolution: 	 convolve: 5.085702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.083 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.476 ms
---Transfer Veff_loc: D2D took 1.735 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.075 ms

This SCF took 26352.866 ms, scf error = 5.602e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.136516, lowerbound = -0.958316, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 926.219 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 9.923 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 11.312 ms
rank =  0, finding HY took 16.635 ms
rank =  0, distributing HY into block cyclic form took 9.885 ms
rank =  0, finding Y'*HY took 1.890 ms
Rank 0, Project_Hamiltonian used 39.750 ms
Total time for projection: 39.763 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.957367640995857
    last  calculated eigval = 0.036107598462602
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95736764099586
lambda[   2] =  -0.62676926135777
lambda[   3] =  -0.55070594446852
lambda[   4] =  -0.47998872184331
lambda[   5] =  -0.35150550387140
lambda[   6] =  -0.33017699086979
lambda[   7] =  -0.32649851774871
lambda[   8] =  -0.15874727607670
lambda[   9] =  -0.05447922530300
lambda[  10] =  -0.02179658200779
lambda[  11] =  -0.00664652277510
lambda[  12] =   0.01110994084532
lambda[  13] =   0.02297203653975
lambda[  14] =   0.03610759846260
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 2.608 ms
rank =  0, Distributing orbital back into band + domain format took 9.735 ms
rank = 0, Subspace_Rotation used 12.354 ms

Total time for subspace rotation: 12.358 ms
rank = 0, Efermi =  -0.084182344357 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.566 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.622 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.061 ms
rank = 0, Calculating density took 980.885 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.400 ms
rank = 0, D2D took 0.641 ms
rank = 0, Transfering density took 0.644 ms
Etot    =   -29.610502698327
Eband   =    -7.563519715061
E1      =    17.281715919408
E2      =    -7.278767653377
E3      =   -10.058343544553
Exc     =    -9.041751617455
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.065e-05, dEband = 2.755e-03
rank = 0, Calculating/Estimating energy took 0.941 ms, Etot = -29.610502698, dEtot = 1.065e-05, dEband = 2.755e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0561719717560, which took 0.072 ms

iter_count = 108, r_2norm = 2.225e-06, tol*||rhs|| = 2.247e-06

Anderson update took 47.302 ms, out of which F'*F took 24.623 ms; b-Ax took 159.796 ms, out of which Lap took 147.134 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 318.190 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095219, int_b + int_rho = -1.983e-13, checking this took 0.093 ms
2-norm of RHS = 542.7988375633173, which took 0.100 ms

iter_count = 192, r_2norm = 4.538e-04, tol*||rhs|| = 5.428e-04

Anderson update took 81.986 ms, out of which F'*F took 43.911 ms; b-Ax took 286.927 ms, out of which Lap took 263.026 ms
Solving Poisson took 553.427 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.125775 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.121117 
Total time for convolution: 	 convolve: 5.119113 
Total time for convolution: 	 convolve: 5.120472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.010 ms
======D2D: initiated sending and receiving took 1.418 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.211 ms
---Transfer Veff_loc: D2D took 0.630 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.962 ms

This SCF took 26377.921 ms, scf error = 3.768e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136108, lowerbound = -0.957368, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 926.155 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 10.017 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.306 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.102 ms
rank =  0, Distribute data + matrix mult took 11.439 ms
rank =  0, finding HY took 16.607 ms
rank =  0, distributing HY into block cyclic form took 10.022 ms
rank =  0, finding Y'*HY took 1.835 ms
Rank 0, Project_Hamiltonian used 39.931 ms
Total time for projection: 39.945 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.956840770383711
    last  calculated eigval = 0.036293825753125
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95684077038371
lambda[   2] =  -0.62624555090539
lambda[   3] =  -0.55014355700980
lambda[   4] =  -0.47944923250434
lambda[   5] =  -0.35097118209175
lambda[   6] =  -0.32966509115958
lambda[   7] =  -0.32597749318477
lambda[   8] =  -0.15824694870743
lambda[   9] =  -0.05394934607875
lambda[  10] =  -0.01896230280160
lambda[  11] =  -0.00630724919038
lambda[  12] =   0.01301954766399
lambda[  13] =   0.02581971752516
lambda[  14] =   0.03629382575313
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 2.386 ms
rank =  0, Distributing orbital back into band + domain format took 9.770 ms
rank = 0, Subspace_Rotation used 12.167 ms

Total time for subspace rotation: 12.172 ms
rank = 0, Efermi =  -0.083652465352 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.668 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.434 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 980.748 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.399 ms
rank = 0, D2D took 0.679 ms
rank = 0, Transfering density took 0.681 ms
Etot    =   -29.610556014545
Eband   =    -7.555079652484
E1      =    17.277702178767
E2      =    -7.274182791055
E3      =   -10.058926882418
Exc     =    -9.042229731153
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.066e-05, dEband = 1.688e-03
rank = 0, Calculating/Estimating energy took 1.769 ms, Etot = -29.610556015, dEtot = 1.066e-05, dEband = 1.688e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0423005863802, which took 0.049 ms

iter_count = 114, r_2norm = 1.021e-06, tol*||rhs|| = 1.692e-06

Anderson update took 49.975 ms, out of which F'*F took 25.895 ms; b-Ax took 168.953 ms, out of which Lap took 155.595 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.799 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095214, int_b + int_rho = -2.492e-13, checking this took 0.093 ms
2-norm of RHS = 542.8113154032418, which took 0.102 ms

iter_count = 174, r_2norm = 5.331e-04, tol*||rhs|| = 5.428e-04

Anderson update took 73.978 ms, out of which F'*F took 40.173 ms; b-Ax took 262.352 ms, out of which Lap took 240.433 ms
Solving Poisson took 502.985 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.137689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.120949 
Total time for convolution: 	 convolve: 5.122595 
Total time for convolution: 	 convolve: 5.121556 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.373 ms
---Transfer Veff_loc: D2D took 0.628 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.964 ms

This SCF took 26405.143 ms, scf error = 2.705e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136294, lowerbound = -0.956841, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 930.116 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 10.173 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.305 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 11.519 ms
rank =  0, finding HY took 16.587 ms
rank =  0, distributing HY into block cyclic form took 10.274 ms
rank =  0, finding Y'*HY took 1.868 ms
Rank 0, Project_Hamiltonian used 40.274 ms
Total time for projection: 40.323 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.956647827375408
    last  calculated eigval = 0.036627358393012
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95664782737541
lambda[   2] =  -0.62597397025791
lambda[   3] =  -0.54985712583430
lambda[   4] =  -0.47917408878850
lambda[   5] =  -0.35072041171365
lambda[   6] =  -0.32940885247921
lambda[   7] =  -0.32574924481198
lambda[   8] =  -0.15801259180743
lambda[   9] =  -0.05374126728871
lambda[  10] =  -0.01629109768153
lambda[  11] =  -0.00682931385636
lambda[  12] =   0.01388060692247
lambda[  13] =   0.02945913385340
lambda[  14] =   0.03662735839301
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 2.388 ms
rank =  0, Distributing orbital back into band + domain format took 9.856 ms
rank = 0, Subspace_Rotation used 12.256 ms

Total time for subspace rotation: 12.261 ms
rank = 0, Efermi =  -0.083444386628 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.598 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.623 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.068 ms
rank = 0, Calculating density took 985.237 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.390 ms
rank = 0, D2D took 1.995 ms
rank = 0, Transfering density took 2.002 ms
Etot    =   -29.610609141653
Eband   =    -7.551088226725
E1      =    17.276104540138
E2      =    -7.271724201496
E3      =   -10.059014825855
Exc     =    -9.042305999269
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.063e-05, dEband = 7.983e-04
rank = 0, Calculating/Estimating energy took 0.923 ms, Etot = -29.610609142, dEtot = 1.063e-05, dEband = 7.983e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0446853660648, which took 0.069 ms

iter_count = 108, r_2norm = 1.706e-06, tol*||rhs|| = 1.787e-06

Anderson update took 47.675 ms, out of which F'*F took 24.478 ms; b-Ax took 162.325 ms, out of which Lap took 149.516 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 320.167 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095217, int_b + int_rho = -2.146e-13, checking this took 0.077 ms
2-norm of RHS = 542.8087878419026, which took 0.110 ms

iter_count = 120, r_2norm = 4.965e-04, tol*||rhs|| = 5.428e-04

Anderson update took 51.603 ms, out of which F'*F took 27.535 ms; b-Ax took 181.324 ms, out of which Lap took 166.137 ms
Solving Poisson took 349.663 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.143645 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.187085 
Total time for convolution: 	 convolve: 5.122526 
Total time for convolution: 	 convolve: 5.120704 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 0.646 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26275.317 ms, scf error = 2.458e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136627, lowerbound = -0.956648, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 928.168 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.050 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.045 ms
rank =  0, Distribute data + matrix mult took 11.512 ms
rank =  0, finding HY took 16.611 ms
rank =  0, distributing HY into block cyclic form took 10.014 ms
rank =  0, finding Y'*HY took 1.930 ms
Rank 0, Project_Hamiltonian used 40.095 ms
Total time for projection: 40.110 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.956503670056772
    last  calculated eigval = 0.035651541639384
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95650367005677
lambda[   2] =  -0.62585483435907
lambda[   3] =  -0.54976280345041
lambda[   4] =  -0.47907218572627
lambda[   5] =  -0.35060262109445
lambda[   6] =  -0.32928745510921
lambda[   7] =  -0.32562413920498
lambda[   8] =  -0.15788934801507
lambda[   9] =  -0.05365885153578
lambda[  10] =  -0.01596222922228
lambda[  11] =  -0.00679906254092
lambda[  12] =   0.01387232162202
lambda[  13] =   0.02974241482125
lambda[  14] =   0.03565154163938
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 2.682 ms
rank =  0, Distributing orbital back into band + domain format took 9.753 ms
rank = 0, Subspace_Rotation used 12.448 ms

Total time for subspace rotation: 12.453 ms
rank = 0, Efermi =  -0.083361970783 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 1.571 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.663 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 983.339 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.604 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.016 ms
rank = 0, D2D took 1.121 ms
rank = 0, Transfering density took 1.123 ms
Etot    =   -29.610613709585
Eband   =    -7.549194114620
E1      =    17.274965714955
E2      =    -7.270900813518
E3      =   -10.059306540005
Exc     =    -9.042534180295
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 9.136e-07, dEband = 3.788e-04
rank = 0, Calculating/Estimating energy took 0.818 ms, Etot = -29.610613710, dEtot = 9.136e-07, dEband = 3.788e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0356301493425, which took 0.056 ms

iter_count = 108, r_2norm = 1.080e-06, tol*||rhs|| = 1.425e-06

Anderson update took 47.420 ms, out of which F'*F took 24.474 ms; b-Ax took 160.438 ms, out of which Lap took 147.511 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 318.417 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095222, int_b + int_rho = -1.710e-13, checking this took 0.091 ms
2-norm of RHS = 542.8118858791343, which took 0.100 ms

iter_count = 162, r_2norm = 5.209e-04, tol*||rhs|| = 5.428e-04

Anderson update took 69.271 ms, out of which F'*F took 37.044 ms; b-Ax took 244.485 ms, out of which Lap took 223.975 ms
Solving Poisson took 469.814 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.124686 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.125737 
Total time for convolution: 	 convolve: 5.122326 
Total time for convolution: 	 convolve: 5.138761 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.821 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.356 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.309 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.979 ms

This SCF took 26324.409 ms, scf error = 1.923e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135652, lowerbound = -0.956504, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 923.719 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 10.144 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.303 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 11.534 ms
rank =  0, finding HY took 16.648 ms
rank =  0, distributing HY into block cyclic form took 10.147 ms
rank =  0, finding Y'*HY took 1.871 ms
Rank 0, Project_Hamiltonian used 40.233 ms
Total time for projection: 40.247 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.956521379589111
    last  calculated eigval = 0.035194218271049
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95652137958911
lambda[   2] =  -0.62584318578163
lambda[   3] =  -0.54971484319680
lambda[   4] =  -0.47903847371878
lambda[   5] =  -0.35058959054899
lambda[   6] =  -0.32928301340047
lambda[   7] =  -0.32561542823595
lambda[   8] =  -0.15788912504355
lambda[   9] =  -0.05371674545362
lambda[  10] =  -0.01527441830863
lambda[  11] =  -0.00719403861508
lambda[  12] =   0.01255573530293
lambda[  13] =   0.02995072228155
lambda[  14] =   0.03519421827105
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 2.507 ms
rank =  0, Distributing orbital back into band + domain format took 9.526 ms
rank = 0, Subspace_Rotation used 12.043 ms

Total time for subspace rotation: 12.556 ms
rank = 0, Efermi =  -0.083419864872 calculate fermi energy took 0.628 ms
rank = 0, --- Calculate rho: sum over local bands took 1.599 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.609 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 979.702 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.405 ms
rank = 0, D2D took 0.587 ms
rank = 0, Transfering density took 0.589 ms
Etot    =   -29.610654006439
Eband   =    -7.548990079619
E1      =    17.275229736077
E2      =    -7.270480327508
E3      =   -10.058931669661
Exc     =    -9.042247176919
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 8.059e-06, dEband = 4.081e-05
rank = 0, Calculating/Estimating energy took 0.861 ms, Etot = -29.610654006, dEtot = 8.059e-06, dEband = 4.081e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0334895724526, which took 0.309 ms

iter_count = 108, r_2norm = 9.878e-07, tol*||rhs|| = 1.340e-06

Anderson update took 47.910 ms, out of which F'*F took 35.731 ms; b-Ax took 170.486 ms, out of which Lap took 157.833 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 335.720 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095214, int_b + int_rho = -2.510e-13, checking this took 0.083 ms
2-norm of RHS = 542.8117862906275, which took 0.089 ms

iter_count = 120, r_2norm = 5.417e-04, tol*||rhs|| = 5.428e-04

Anderson update took 51.316 ms, out of which F'*F took 27.545 ms; b-Ax took 179.682 ms, out of which Lap took 164.656 ms
Solving Poisson took 346.991 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.115110 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.741 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.128607 
Total time for convolution: 	 convolve: 5.156327 
Total time for convolution: 	 convolve: 5.116698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.436 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
---Transfer Veff_loc: D2D took 0.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.974 ms

This SCF took 26245.345 ms, scf error = 2.047e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135194, lowerbound = -0.956521, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 925.439 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.105 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.316 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 11.462 ms
rank =  0, finding HY took 16.609 ms
rank =  0, distributing HY into block cyclic form took 10.229 ms
rank =  0, finding Y'*HY took 1.856 ms
Rank 0, Project_Hamiltonian used 40.191 ms
Total time for projection: 40.243 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.130 ms
    first calculated eigval = -0.956454922413588
    last  calculated eigval = 0.034807232098035
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95645492241359
lambda[   2] =  -0.62578286736069
lambda[   3] =  -0.54965484046117
lambda[   4] =  -0.47897947338611
lambda[   5] =  -0.35052675137026
lambda[   6] =  -0.32922372505478
lambda[   7] =  -0.32555457707164
lambda[   8] =  -0.15783137153496
lambda[   9] =  -0.05368065257839
lambda[  10] =  -0.01462059484128
lambda[  11] =  -0.00723226309306
lambda[  12] =   0.01248393041619
lambda[  13] =   0.02999273659057
lambda[  14] =   0.03480723209803
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 2.949 ms
rank =  0, Distributing orbital back into band + domain format took 9.144 ms
rank = 0, Subspace_Rotation used 12.107 ms

Total time for subspace rotation: 12.113 ms
rank = 0, Efermi =  -0.083383771748 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.591 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.646 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.063 ms
rank = 0, Calculating density took 980.916 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.399 ms
rank = 0, D2D took 0.540 ms
rank = 0, Transfering density took 0.542 ms
Etot    =   -29.610661568901
Eband   =    -7.548017057894
E1      =    17.274762168615
E2      =    -7.269965461307
E3      =   -10.058949205317
Exc     =    -9.042262863098
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 1.512e-06, dEband = 1.946e-04
rank = 0, Calculating/Estimating energy took 0.893 ms, Etot = -29.610661569, dEtot = 1.512e-06, dEband = 1.946e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0372283383206, which took 0.053 ms

iter_count = 108, r_2norm = 9.579e-07, tol*||rhs|| = 1.489e-06

Anderson update took 47.266 ms, out of which F'*F took 24.634 ms; b-Ax took 159.721 ms, out of which Lap took 146.864 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 317.159 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095215, int_b + int_rho = -2.383e-13, checking this took 0.089 ms
2-norm of RHS = 542.8114066035790, which took 0.124 ms

iter_count = 108, r_2norm = 5.406e-04, tol*||rhs|| = 5.428e-04

Anderson update took 45.932 ms, out of which F'*F took 24.850 ms; b-Ax took 161.370 ms, out of which Lap took 148.021 ms
Solving Poisson took 312.873 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.147008 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.176295 
Total time for convolution: 	 convolve: 5.119042 
Total time for convolution: 	 convolve: 5.115356 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
---Transfer Veff_loc: D2D took 0.643 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.972 ms

This SCF took 26217.314 ms, scf error = 1.925e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134807, lowerbound = -0.956455, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 926.848 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.135 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.324 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 11.515 ms
rank =  0, finding HY took 16.601 ms
rank =  0, distributing HY into block cyclic form took 10.197 ms
rank =  0, finding Y'*HY took 1.863 ms
Rank 0, Project_Hamiltonian used 40.208 ms
Total time for projection: 40.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.956340615921104
    last  calculated eigval = 0.034513873066550
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95634061592110
lambda[   2] =  -0.62568971978195
lambda[   3] =  -0.54957376736401
lambda[   4] =  -0.47889487267374
lambda[   5] =  -0.35043313026809
lambda[   6] =  -0.32912863325405
lambda[   7] =  -0.32545435482219
lambda[   8] =  -0.15773660160414
lambda[   9] =  -0.05362372663401
lambda[  10] =  -0.01396544339216
lambda[  11] =  -0.00720955593726
lambda[  12] =   0.01249195981851
lambda[  13] =   0.03028859812111
lambda[  14] =   0.03451387306655
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.004 ms
rank =  0, Distributing orbital back into band + domain format took 9.253 ms
rank = 0, Subspace_Rotation used 12.269 ms

Total time for subspace rotation: 12.275 ms
rank = 0, Efermi =  -0.083326845654 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.653 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.618 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.061 ms
rank = 0, Calculating density took 982.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.423 ms
rank = 0, D2D took 0.558 ms
rank = 0, Transfering density took 0.560 ms
Etot    =   -29.610664971177
Eband   =    -7.546503391966
E1      =    17.273900440500
E2      =    -7.269262972971
E3      =   -10.059148813263
Exc     =    -9.042415322796
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 6.805e-07, dEband = 3.027e-04
rank = 0, Calculating/Estimating energy took 0.875 ms, Etot = -29.610664971, dEtot = 6.805e-07, dEband = 3.027e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0312668133801, which took 0.049 ms

iter_count = 108, r_2norm = 7.685e-07, tol*||rhs|| = 1.251e-06

Anderson update took 47.587 ms, out of which F'*F took 24.615 ms; b-Ax took 161.806 ms, out of which Lap took 149.015 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 320.040 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095212, int_b + int_rho = -2.692e-13, checking this took 0.087 ms
2-norm of RHS = 542.8119777509449, which took 0.086 ms

iter_count = 126, r_2norm = 5.236e-04, tol*||rhs|| = 5.428e-04

Anderson update took 53.709 ms, out of which F'*F took 28.979 ms; b-Ax took 188.504 ms, out of which Lap took 172.807 ms
Solving Poisson took 366.668 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.115 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.122145 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.121434 
Total time for convolution: 	 convolve: 5.163399 
Total time for convolution: 	 convolve: 5.135304 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.010 ms

This SCF took 26280.546 ms, scf error = 1.485e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134514, lowerbound = -0.956341, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 927.630 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.061 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.303 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 11.411 ms
rank =  0, finding HY took 16.677 ms
rank =  0, distributing HY into block cyclic form took 10.094 ms
rank =  0, finding Y'*HY took 1.959 ms
Rank 0, Project_Hamiltonian used 40.170 ms
Total time for projection: 40.183 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.556 ms
    first calculated eigval = -0.956247033578414
    last  calculated eigval = 0.033335038493295
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95624703357841
lambda[   2] =  -0.62560232336526
lambda[   3] =  -0.54949197210124
lambda[   4] =  -0.47881247157260
lambda[   5] =  -0.35034853293786
lambda[   6] =  -0.32904191858475
lambda[   7] =  -0.32537003711970
lambda[   8] =  -0.15765855445407
lambda[   9] =  -0.05357378552233
lambda[  10] =  -0.01438969494437
lambda[  11] =  -0.00729403155931
lambda[  12] =   0.01206579417141
lambda[  13] =   0.02930221825547
lambda[  14] =   0.03333503849329
==subpsace eigenproblem: bcast eigvals took 0.026 ms
Total time for solving subspace eigenvalue problem: 0.592 ms
rank =  0, subspace rotation using ScaLAPACK took 3.132 ms
rank =  0, Distributing orbital back into band + domain format took 9.429 ms
rank = 0, Subspace_Rotation used 12.576 ms

Total time for subspace rotation: 12.581 ms
rank = 0, Efermi =  -0.083276904708 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.557 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.735 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.073 ms
rank = 0, Calculating density took 983.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.438 ms
rank = 0, D2D took 0.616 ms
rank = 0, Transfering density took 0.619 ms
Etot    =   -29.610669950639
Eband   =    -7.545145688015
E1      =    17.273151701289
E2      =    -7.268612005833
E3      =   -10.059295049511
Exc     =    -9.042524536110
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 9.959e-07, dEband = 2.715e-04
rank = 0, Calculating/Estimating energy took 0.928 ms, Etot = -29.610669951, dEtot = 9.959e-07, dEband = 2.715e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0315252983430, which took 0.059 ms

iter_count = 102, r_2norm = 9.754e-07, tol*||rhs|| = 1.261e-06

Anderson update took 44.713 ms, out of which F'*F took 23.173 ms; b-Ax took 151.470 ms, out of which Lap took 139.084 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 300.986 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095221, int_b + int_rho = -1.783e-13, checking this took 0.094 ms
2-norm of RHS = 542.8151070789236, which took 0.117 ms

iter_count = 120, r_2norm = 5.259e-04, tol*||rhs|| = 5.428e-04

Anderson update took 51.153 ms, out of which F'*F took 28.917 ms; b-Ax took 181.113 ms, out of which Lap took 165.994 ms
Solving Poisson took 349.363 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.010 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.123745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.122075 
Total time for convolution: 	 convolve: 5.122161 
Total time for convolution: 	 convolve: 5.121381 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
---Transfer Veff_loc: D2D took 0.639 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.970 ms

This SCF took 26241.575 ms, scf error = 1.195e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133335, lowerbound = -0.956247, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 927.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.037 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.321 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 11.403 ms
rank =  0, finding HY took 16.642 ms
rank =  0, distributing HY into block cyclic form took 9.998 ms
rank =  0, finding Y'*HY took 1.867 ms
Rank 0, Project_Hamiltonian used 40.390 ms
Total time for projection: 40.418 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.602 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.663 ms
    first calculated eigval = -0.956281288881711
    last  calculated eigval = 0.032913053276223
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95628128888171
lambda[   2] =  -0.62562034567433
lambda[   3] =  -0.54949081750657
lambda[   4] =  -0.47881804618401
lambda[   5] =  -0.35036787188730
lambda[   6] =  -0.32906292426359
lambda[   7] =  -0.32539170981830
lambda[   8] =  -0.15768397819818
lambda[   9] =  -0.05359766136973
lambda[  10] =  -0.01419307142167
lambda[  11] =  -0.00733786644238
lambda[  12] =   0.01169737847688
lambda[  13] =   0.02903609232555
lambda[  14] =   0.03291305327622
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.675 ms
rank =  0, subspace rotation using ScaLAPACK took 2.385 ms
rank =  0, Distributing orbital back into band + domain format took 9.744 ms
rank = 0, Subspace_Rotation used 12.141 ms

Total time for subspace rotation: 12.146 ms
rank = 0, Efermi =  -0.083300780543 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.635 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.529 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.066 ms
rank = 0, Calculating density took 982.966 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.406 ms
rank = 0, D2D took 0.612 ms
rank = 0, Transfering density took 0.614 ms
Etot    =   -29.610673317018
Eband   =    -7.545433965415
E1      =    17.273446946920
E2      =    -7.268624347287
E3      =   -10.059173498753
Exc     =    -9.042425661414
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 6.733e-07, dEband = 5.766e-05
rank = 0, Calculating/Estimating energy took 0.852 ms, Etot = -29.610673317, dEtot = 6.733e-07, dEband = 5.766e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0347611466124, which took 0.079 ms

iter_count = 102, r_2norm = 9.093e-07, tol*||rhs|| = 1.390e-06

Anderson update took 44.473 ms, out of which F'*F took 23.221 ms; b-Ax took 151.198 ms, out of which Lap took 139.040 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 300.402 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095216, int_b + int_rho = -2.292e-13, checking this took 0.087 ms
2-norm of RHS = 542.8158993360081, which took 0.100 ms

iter_count = 90, r_2norm = 4.931e-04, tol*||rhs|| = 5.428e-04

Anderson update took 38.470 ms, out of which F'*F took 20.670 ms; b-Ax took 134.492 ms, out of which Lap took 123.095 ms
Solving Poisson took 261.991 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.133890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.581 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.127145 
Total time for convolution: 	 convolve: 5.123635 
Total time for convolution: 	 convolve: 5.121348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.110 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.648 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 26168.671 ms, scf error = 1.566e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.132913, lowerbound = -0.956281, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 923.759 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.097 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.305 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.040 ms
rank =  0, Distribute data + matrix mult took 12.460 ms
rank =  0, finding HY took 16.855 ms
rank =  0, distributing HY into block cyclic form took 10.245 ms
rank =  0, finding Y'*HY took 1.857 ms
Rank 0, Project_Hamiltonian used 41.447 ms
Total time for projection: 41.466 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.956268983798073
    last  calculated eigval = 0.032528603169535
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95626898379807
lambda[   2] =  -0.62560497110988
lambda[   3] =  -0.54947280459280
lambda[   4] =  -0.47880099035228
lambda[   5] =  -0.35035383136636
lambda[   6] =  -0.32904852189941
lambda[   7] =  -0.32537722580491
lambda[   8] =  -0.15767016120684
lambda[   9] =  -0.05359081871998
lambda[  10] =  -0.01429862089119
lambda[  11] =  -0.00729975004451
lambda[  12] =   0.01148990344108
lambda[  13] =   0.02878472270887
lambda[  14] =   0.03252860316954
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.144 ms
rank =  0, subspace rotation using ScaLAPACK took 2.357 ms
rank =  0, Distributing orbital back into band + domain format took 9.936 ms
rank = 0, Subspace_Rotation used 12.306 ms

Total time for subspace rotation: 12.311 ms
rank = 0, Efermi =  -0.083293937922 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.608 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 980.116 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.412 ms
rank = 0, D2D took 0.651 ms
rank = 0, Transfering density took 0.655 ms
Etot    =   -29.610675677899
Eband   =    -7.545194980848
E1      =    17.273357045576
E2      =    -7.268469589779
E3      =   -10.059180005356
Exc     =    -9.042428854615
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 4.722e-07, dEband = 4.780e-05
rank = 0, Calculating/Estimating energy took 0.809 ms, Etot = -29.610675678, dEtot = 4.722e-07, dEband = 4.780e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0339464302362, which took 0.051 ms

iter_count = 102, r_2norm = 8.942e-07, tol*||rhs|| = 1.358e-06

Anderson update took 44.563 ms, out of which F'*F took 23.222 ms; b-Ax took 151.392 ms, out of which Lap took 139.224 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 299.955 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095218, int_b + int_rho = -2.037e-13, checking this took 0.086 ms
2-norm of RHS = 542.8167939465292, which took 0.084 ms

iter_count = 48, r_2norm = 5.268e-04, tol*||rhs|| = 5.428e-04

Anderson update took 20.508 ms, out of which F'*F took 10.991 ms; b-Ax took 71.701 ms, out of which Lap took 65.741 ms
Solving Poisson took 140.536 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.173 ms
Total time for convolution: 	 convolve: 5.126730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.123294 
Total time for convolution: 	 convolve: 5.126696 
Total time for convolution: 	 convolve: 5.123349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
---Transfer Veff_loc: D2D took 0.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.974 ms

This SCF took 25964.364 ms, scf error = 1.601e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.132529, lowerbound = -0.956269, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 929.986 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 9.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 11.275 ms
rank =  0, finding HY took 16.814 ms
rank =  0, distributing HY into block cyclic form took 9.986 ms
rank =  0, finding Y'*HY took 1.899 ms
Rank 0, Project_Hamiltonian used 40.005 ms
Total time for projection: 40.018 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.956286972663497
    last  calculated eigval = 0.032364608033710
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95628697266350
lambda[   2] =  -0.62561531249033
lambda[   3] =  -0.54947954719637
lambda[   4] =  -0.47880902982439
lambda[   5] =  -0.35036503070049
lambda[   6] =  -0.32905963024266
lambda[   7] =  -0.32539035872619
lambda[   8] =  -0.15768222718549
lambda[   9] =  -0.05359864417359
lambda[  10] =  -0.01413466248939
lambda[  11] =  -0.00727935034394
lambda[  12] =   0.01151985075476
lambda[  13] =   0.02902772163007
lambda[  14] =   0.03236460803371
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 2.481 ms
rank =  0, Distributing orbital back into band + domain format took 9.671 ms
rank = 0, Subspace_Rotation used 12.163 ms

Total time for subspace rotation: 12.168 ms
rank = 0, Efermi =  -0.083301763283 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.665 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.070 ms
rank = 0, Calculating density took 985.227 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.417 ms
rank = 0, D2D took 0.611 ms
rank = 0, Transfering density took 0.613 ms
Etot    =   -29.610675922359
Eband   =    -7.545376218646
E1      =    17.273500101700
E2      =    -7.268517808984
E3      =   -10.059134702777
Exc     =    -9.042393834026
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 4.889e-08, dEband = 3.625e-05
rank = 0, Calculating/Estimating energy took 0.849 ms, Etot = -29.610675922, dEtot = 4.889e-08, dEband = 3.625e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304262585447, which took 0.051 ms

iter_count = 102, r_2norm = 8.072e-07, tol*||rhs|| = 1.217e-06

Anderson update took 44.791 ms, out of which F'*F took 23.323 ms; b-Ax took 151.501 ms, out of which Lap took 139.240 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 300.926 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095212, int_b + int_rho = -2.656e-13, checking this took 0.084 ms
2-norm of RHS = 542.8134705587318, which took 0.070 ms

iter_count = 102, r_2norm = 4.927e-04, tol*||rhs|| = 5.428e-04

Anderson update took 43.648 ms, out of which F'*F took 23.489 ms; b-Ax took 152.844 ms, out of which Lap took 140.188 ms
Solving Poisson took 296.685 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.131647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.125505 
Total time for convolution: 	 convolve: 5.167371 
Total time for convolution: 	 convolve: 5.122955 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 0.655 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.822 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.086 ms

This SCF took 26185.050 ms, scf error = 1.757e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.132365, lowerbound = -0.956287, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 926.493 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.195 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.306 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.048 ms
rank =  0, Distribute data + matrix mult took 11.562 ms
rank =  0, finding HY took 16.607 ms
rank =  0, distributing HY into block cyclic form took 10.288 ms
rank =  0, finding Y'*HY took 1.851 ms
Rank 0, Project_Hamiltonian used 40.336 ms
Total time for projection: 40.349 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.956230243344742
    last  calculated eigval = 0.031341342368030
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95623024334474
lambda[   2] =  -0.62558142393467
lambda[   3] =  -0.54946015853227
lambda[   4] =  -0.47878462199177
lambda[   5] =  -0.35032996689781
lambda[   6] =  -0.32902332651176
lambda[   7] =  -0.32534818699953
lambda[   8] =  -0.15764285345669
lambda[   9] =  -0.05358593329485
lambda[  10] =  -0.01536368865458
lambda[  11] =  -0.00738256141334
lambda[  12] =   0.01099442834184
lambda[  13] =   0.02760552877914
lambda[  14] =   0.03134134236803
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 2.414 ms
rank =  0, Distributing orbital back into band + domain format took 9.853 ms
rank = 0, Subspace_Rotation used 12.279 ms

Total time for subspace rotation: 12.283 ms
rank = 0, Efermi =  -0.083289052377 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.664 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.609 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.062 ms
rank = 0, Calculating density took 981.710 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.404 ms
rank = 0, D2D took 0.712 ms
rank = 0, Transfering density took 0.714 ms
Etot    =   -29.610679502949
Eband   =    -7.544801563925
E1      =    17.273050407653
E2      =    -7.268360658251
E3      =   -10.059254143912
Exc     =    -9.042484665691
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 7.161e-07, dEband = 1.149e-04
rank = 0, Calculating/Estimating energy took 0.827 ms, Etot = -29.610679503, dEtot = 7.161e-07, dEband = 1.149e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0218209690028, which took 0.056 ms

iter_count = 102, r_2norm = 7.536e-07, tol*||rhs|| = 8.728e-07

Anderson update took 44.840 ms, out of which F'*F took 23.313 ms; b-Ax took 151.924 ms, out of which Lap took 139.390 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 301.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095219, int_b + int_rho = -2.019e-13, checking this took 0.105 ms
2-norm of RHS = 542.8110553916249, which took 0.111 ms

iter_count = 102, r_2norm = 4.947e-04, tol*||rhs|| = 5.428e-04

Anderson update took 43.807 ms, out of which F'*F took 23.351 ms; b-Ax took 153.066 ms, out of which Lap took 140.289 ms
Solving Poisson took 297.090 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.141696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.994 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.137533 
Total time for convolution: 	 convolve: 5.128412 
Total time for convolution: 	 convolve: 5.117713 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.635 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.016 ms
======D2D: initiated sending and receiving took 1.079 ms
---Transfer Veff_loc: D2D took 1.513 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.843 ms

This SCF took 26164.197 ms, scf error = 1.232e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.131341, lowerbound = -0.956230, upperbound = 267.580647

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 928.935 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 10.163 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.331 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 11.539 ms
rank =  0, finding HY took 16.616 ms
rank =  0, distributing HY into block cyclic form took 10.089 ms
rank =  0, finding Y'*HY took 1.940 ms
Rank 0, Project_Hamiltonian used 40.213 ms
Total time for projection: 40.226 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.956135241175784
    last  calculated eigval = 0.030065744318314
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95613524117578
lambda[   2] =  -0.62551226101186
lambda[   3] =  -0.54941368647810
lambda[   4] =  -0.47873057778098
lambda[   5] =  -0.35026238588664
lambda[   6] =  -0.32895178733450
lambda[   7] =  -0.32527332760823
lambda[   8] =  -0.15757105072731
lambda[   9] =  -0.05355628443693
lambda[  10] =  -0.01672313812060
lambda[  11] =  -0.00754828795923
lambda[  12] =   0.01037671664142
lambda[  13] =   0.02620050419641
lambda[  14] =   0.03006574431831
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 2.409 ms
rank =  0, Distributing orbital back into band + domain format took 10.023 ms
rank = 0, Subspace_Rotation used 12.443 ms

Total time for subspace rotation: 12.448 ms
rank = 0, Efermi =  -0.083259403815 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.597 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.587 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.064 ms
rank = 0, Calculating density took 984.158 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.420 ms
rank = 0, D2D took 0.597 ms
rank = 0, Transfering density took 0.600 ms
Etot    =   -29.610681144336
Eband   =    -7.543700636593
E1      =    17.272281400398
E2      =    -7.267967817084
E3      =   -10.059503038886
Exc     =    -9.042674280962
Esc     =   -47.624058482814
Entropy =    -0.000000000335
dE = 3.283e-07, dEband = 2.202e-04
rank = 0, Calculating/Estimating energy took 0.865 ms, Etot = -29.610681144, dEtot = 3.283e-07, dEband = 2.202e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0113916989208, which took 0.059 ms

iter_count = 108, r_2norm = 3.854e-07, tol*||rhs|| = 4.557e-07

Anderson update took 47.450 ms, out of which F'*F took 24.712 ms; b-Ax took 160.830 ms, out of which Lap took 147.937 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 319.749 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001095239, int_rho =  16.00000001095212, int_b + int_rho = -2.692e-13, checking this took 0.084 ms
2-norm of RHS = 542.8108715127330, which took 0.098 ms

iter_count = 90, r_2norm = 4.968e-04, tol*||rhs|| = 5.428e-04

Anderson update took 38.630 ms, out of which F'*F took 20.618 ms; b-Ax took 135.028 ms, out of which Lap took 123.551 ms
Solving Poisson took 261.805 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.124011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.125963 
Total time for convolution: 	 convolve: 5.119376 
Total time for convolution: 	 convolve: 5.120116 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.780 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.996 ms

This SCF took 26112.501 ms, scf error = 6.212e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.95613524117578, occ[   1] =   2.00000000000000
lambda[   2] =  -0.62551226101186, occ[   2] =   2.00000000000000
lambda[   3] =  -0.54941368647810, occ[   3] =   2.00000000000000
lambda[   4] =  -0.47873057778098, occ[   4] =   2.00000000000000
lambda[   5] =  -0.35026238588664, occ[   5] =   2.00000000000000
lambda[   6] =  -0.32895178733450, occ[   6] =   2.00000000000000
lambda[   7] =  -0.32527332760823, occ[   7] =   2.00000000000000
lambda[   8] =  -0.15757105072731, occ[   8] =   2.00000000000000
lambda[   9] =  -0.05355628443693, occ[   9] =   0.00000001095217
lambda[  10] =  -0.01672313812060, occ[  10] =   0.00000000000000
lambda[  11] =  -0.00754828795923, occ[  11] =   0.00000000000000
lambda[  12] =   0.01037671664142, occ[  12] =   0.00000000000000
lambda[  13] =   0.02620050419641, occ[  13] =   0.00000000000000
lambda[  14] =   0.03006574431831, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.479 ms, time for Allreduce/Reduce: 5.744 ms 
Time for calculating local force components: 14.072 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000431992106   0.00000006875588  -1.07989172260730
  0.00000001632640  -0.05220394912398   0.01730646193272
  0.00000001760170   0.05220389833385   0.01730648308713
  0.00000020413257  -0.08865548371310   0.20388237936902
 -0.00000106903436   0.08865473762722   0.20388170412965
force_loc = 
  0.00000221063953   0.00000091209255   1.04826540471975
 -0.00000005265401   0.05582942266001  -0.01843075070220
  0.00000008578941  -0.05582849462756  -0.01843102159219
  0.00000445234884   0.08700881536535  -0.19654465066752
 -0.00000087483487  -0.08700910506105  -0.19654512103959
Time for calculating nonlocal force components: 19.721 ms
[32mforces_xc: 
[0m[32m  0.00000001116678   0.00000008585376   0.03635043497725
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000028315820  -0.00611275934689  -0.00852948751922
[0m[32m -0.00000004536551   0.00611274182997  -0.00852946715514
[0mTime for calculating XC forces components: 17.863 ms
 Cartesian force = 
  0.00000462988822   0.00000088857298   0.00470598770323
 -0.00000194816676   0.00362529540683  -0.00114241815596
 -0.00000180844804  -0.00362477442291  -0.00114266789154
  0.00000302780046  -0.00775960582384  -0.00120988820419
 -0.00000390107388   0.00775819626693  -0.00121101345155
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 403.980 ms
The program took 636.878 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:32:04
Job ID:        2266776
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:09:36,vmem=8564K,walltime=00:10:48,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-3-1
---------------------------------------
