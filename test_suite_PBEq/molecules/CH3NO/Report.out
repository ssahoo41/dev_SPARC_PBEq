---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:49
Job ID:    2266485
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:54
Job ID:    2266485
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.056 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 14.428 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 6.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 20.469 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 66.889 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.026 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.090 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.591379	   11.311716	   10.000000	
    9.612533	    8.021247	   10.000000	
    7.408621	   10.027341	   11.667498	
    7.408621	   10.027341	    8.332502	
    8.603350	    9.816706	   10.000000	
   10.398877	   11.978753	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.167 ms
Set up communicators.

--set up spincomm took 3.275 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.075 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.980 ms

Calculate_SplineDerivRadFun took 0.308 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.815 ms.
time spent on vectorized spline interp: 3.556 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.678 ms.
time spent on vectorized spline interp: 1.364 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.314 ms.
time spent on vectorized spline interp: 1.673 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.240 ms.
time spent on vectorized spline interp: 1.611 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.527 ms.

Calculating rb for all atom types took 20.799 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.060 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000186306, sum_int_rho = 17.6987118515035
PosCharge = 18.000000018631, NegCharge = -17.698711851503, scal_fac = 1.017023169237
After scaling, int_rho = 18.0000000186306, PosCharge + NegCharge - NetCharge = -3.908e-14
--Calculate Vref took 0.316 ms
--Calculate rho_guess took 1.637 ms

 integral of b = -18.0000000186306,
 int{b} + Nelectron + NetCharge = -1.863e-08,
 Esc = -55.2970244974953,
 MPI_Reduce took 6.118 ms

Calculating b & b_ref took 13.036 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.023 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.096 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.009 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.081 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.101 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863060, int_b + int_rho = 1.783e-13, checking this took 0.093 ms
2-norm of RHS = 609.4120243476898, which took 0.076 ms

iter_count = 420, r_2norm = 5.315e-04, tol*||rhs|| = 6.094e-04

Anderson update took 232.328 ms, out of which F'*F took 105.777 ms; b-Ax took 713.185 ms, out of which Lap took 640.951 ms
Solving Poisson took 1512.605 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.483 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.800 ms
Total time for convolution: 	 convolve: 5.138528 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.583 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
Total time for convolution: 	 convolve: 5.142755 
Total time for convolution: 	 convolve: 5.192048 
Total time for convolution: 	 convolve: 5.163580 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.736 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
rank = 0, XC calculation took 24482.358 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 1.586 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.279 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 5.323 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.141 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.623 ms
    Lanczos iter 53, eigmin  = -1.058603836, eigmax = 264.927321120, err_eigmin = 1.863e-03, err_eigmax = 9.834e-03
rank =   0, Lanczos took 118.280 ms, eigmin = -1.058603835659, eigmax = 267.576594331038

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.208995, lowerbound = -1.158604, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1174.031 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.887 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.106 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.091 ms
rank =  0, Distribute data + matrix mult took 21.102 ms
rank =  0, finding HY took 20.509 ms
rank =  0, distributing HY into block cyclic form took 11.958 ms
rank =  0, finding Y'*HY took 5.617 ms
Rank 0, Project_Hamiltonian used 59.224 ms
Total time for projection: 59.251 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.388 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.072 ms
rank = 0, Solve_Generalized_EigenProblem used 0.464 ms
    first calculated eigval = 2.797143118011556
    last  calculated eigval = 3.229157140960732
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79714311801156
lambda[   2] =   2.83831724529918
lambda[   3] =   2.88654147859870
lambda[   4] =   2.92418577046711
lambda[   5] =   2.93603677163939
lambda[   6] =   2.96360522441509
lambda[   7] =   2.99471056520487
lambda[   8] =   3.01867740600186
lambda[   9] =   3.04693594639527
lambda[  10] =   3.05292196683442
lambda[  11] =   3.08077303808111
lambda[  12] =   3.10783880535835
lambda[  13] =   3.14290635138849
lambda[  14] =   3.16043421452970
lambda[  15] =   3.22915714096073
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.478 ms
rank =  0, subspace rotation using ScaLAPACK took 3.545 ms
rank =  0, Distributing orbital back into band + domain format took 12.737 ms
rank = 0, Subspace_Rotation used 16.295 ms

Total time for subspace rotation: 16.298 ms
rank = 0, Efermi =   3.049928956682 calculate fermi energy took 0.061 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.329157, lowerbound = -1.158604, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1148.177 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 43.610 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.295 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.236 ms
rank =  0, Distribute data + matrix mult took 47.154 ms
rank =  0, finding HY took 19.394 ms
rank =  0, distributing HY into block cyclic form took 12.019 ms
rank =  0, finding Y'*HY took 4.453 ms
Rank 0, Project_Hamiltonian used 83.049 ms
Total time for projection: 83.053 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.694547139512082
    last  calculated eigval = 0.424468938189100
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.69454713951208
lambda[   2] =  -0.49600694725811
lambda[   3] =  -0.22403893095266
lambda[   4] =  -0.14365010322844
lambda[   5] =  -0.01895296906892
lambda[   6] =   0.10520978792876
lambda[   7] =   0.15387575825895
lambda[   8] =   0.22404601822887
lambda[   9] =   0.28184773955548
lambda[  10] =   0.32525510474317
lambda[  11] =   0.36517806397667
lambda[  12] =   0.38316405903685
lambda[  13] =   0.39987532013212
lambda[  14] =   0.40985009445683
lambda[  15] =   0.42446893818910
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.531 ms
rank =  0, Distributing orbital back into band + domain format took 11.602 ms
rank = 0, Subspace_Rotation used 15.144 ms

Total time for subspace rotation: 15.152 ms
rank = 0, Efermi =   0.303551793682 calculate fermi energy took 0.023 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.524469, lowerbound = -1.158604, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1152.799 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 31.986 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.378 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.063 ms
rank =  0, Distribute data + matrix mult took 35.441 ms
rank =  0, finding HY took 19.453 ms
rank =  0, distributing HY into block cyclic form took 12.010 ms
rank =  0, finding Y'*HY took 4.364 ms
Rank 0, Project_Hamiltonian used 71.297 ms
Total time for projection: 71.301 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -1.074576797699823
    last  calculated eigval = 0.129726528664360
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07457679769982
lambda[   2] =  -0.81183892912540
lambda[   3] =  -0.62762934197175
lambda[   4] =  -0.51656578322099
lambda[   5] =  -0.49382253520533
lambda[   6] =  -0.45703605600316
lambda[   7] =  -0.38383716331859
lambda[   8] =  -0.37337859356103
lambda[   9] =  -0.18958610358122
lambda[  10] =  -0.09027565014564
lambda[  11] =   0.05302175212315
lambda[  12] =   0.09196705367356
lambda[  13] =   0.12417020390976
lambda[  14] =   0.12800600655688
lambda[  15] =   0.12972652866436
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.519 ms
rank =  0, Distributing orbital back into band + domain format took 11.943 ms
rank = 0, Subspace_Rotation used 15.484 ms

Total time for subspace rotation: 15.488 ms
rank = 0, Efermi =  -0.119505705819 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.229727, lowerbound = -1.158604, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1152.060 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 43.199 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.361 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.121 ms
rank =  0, Distribute data + matrix mult took 46.694 ms
rank =  0, finding HY took 19.492 ms
rank =  0, distributing HY into block cyclic form took 11.833 ms
rank =  0, finding Y'*HY took 4.478 ms
Rank 0, Project_Hamiltonian used 82.523 ms
Total time for projection: 82.527 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 7.914 ms
    first calculated eigval = -1.074981948094156
    last  calculated eigval = 0.079825450153345
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07498194809416
lambda[   2] =  -0.81317795980813
lambda[   3] =  -0.63304147634265
lambda[   4] =  -0.52083525442574
lambda[   5] =  -0.51542173701152
lambda[   6] =  -0.49020646371376
lambda[   7] =  -0.39653458176673
lambda[   8] =  -0.39593955688733
lambda[   9] =  -0.23213198900727
lambda[  10] =  -0.14053865004081
lambda[  11] =   0.00470429818675
lambda[  12] =   0.04707865510011
lambda[  13] =   0.05198841948235
lambda[  14] =   0.05652731943982
lambda[  15] =   0.07982545015335
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 7.923 ms
rank =  0, subspace rotation using ScaLAPACK took 3.533 ms
rank =  0, Distributing orbital back into band + domain format took 11.991 ms
rank = 0, Subspace_Rotation used 15.537 ms

Total time for subspace rotation: 15.541 ms
rank = 0, Efermi =  -0.169768705757 calculate fermi energy took 0.022 ms
rank = 0, --- Calculate rho: sum over local bands took 2.275 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.939 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.164 ms
rank = 0, Calculating density took 5122.409 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
rank = 0, D2D took 0.805 ms
rank = 0, Transfering density took 0.808 ms
Etot    =   -34.707322193035
Eband   =   -10.144541936733
E1      =    20.721845258502
E2      =    -8.829415204790
E3      =   -11.208122379443
Exc     =   -10.025138600982
Esc     =   -55.297024497495
Entropy =    -0.000000000561
dE = 5.785e+00, dEband = 1.691e+00
rank = 0, Calculating/Estimating energy took 0.989 ms, Etot = -34.707322193, dEtot = 5.785e+00, dEband = 1.691e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 66.3407735909106, which took 0.066 ms

iter_count = 90, r_2norm = 2.134e-03, tol*||rhs|| = 2.654e-03

Anderson update took 48.331 ms, out of which F'*F took 22.685 ms; b-Ax took 153.179 ms, out of which Lap took 137.542 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 338.309 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863057, int_b + int_rho = 1.564e-13, checking this took 0.099 ms
2-norm of RHS = 607.1343574528414, which took 0.142 ms

iter_count = 282, r_2norm = 5.258e-04, tol*||rhs|| = 6.071e-04

Anderson update took 151.682 ms, out of which F'*F took 70.685 ms; b-Ax took 474.528 ms, out of which Lap took 425.738 ms
Solving Poisson took 1008.900 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.767 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.121043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.547 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.020 ms
======D2D: initiated sending and receiving took 1.236 ms
Total time for convolution: 	 convolve: 5.116205 
Total time for convolution: 	 convolve: 5.171053 
Total time for convolution: 	 convolve: 5.172084 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 0.988 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.848 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.857 ms

This SCF took 31041.489 ms, scf error = 1.676e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.179825, lowerbound = -1.074982, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1204.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.999 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.516 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.047 ms
rank =  0, Distribute data + matrix mult took 15.576 ms
rank =  0, finding HY took 19.132 ms
rank =  0, distributing HY into block cyclic form took 12.078 ms
rank =  0, finding Y'*HY took 4.266 ms
Rank 0, Project_Hamiltonian used 51.487 ms
Total time for projection: 51.501 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -1.079596545965794
    last  calculated eigval = 0.049022362704027
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07959654596579
lambda[   2] =  -0.78423240903103
lambda[   3] =  -0.61294981960881
lambda[   4] =  -0.48969287976532
lambda[   5] =  -0.48671975156334
lambda[   6] =  -0.47784341551165
lambda[   7] =  -0.39382171632061
lambda[   8] =  -0.38595211935867
lambda[   9] =  -0.22076379150425
lambda[  10] =  -0.14672300443409
lambda[  11] =  -0.01940302127461
lambda[  12] =   0.02513068636557
lambda[  13] =   0.03372441064187
lambda[  14] =   0.04332944868266
lambda[  15] =   0.04902236270403
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.504 ms
rank =  0, Distributing orbital back into band + domain format took 11.980 ms
rank = 0, Subspace_Rotation used 15.496 ms

Total time for subspace rotation: 15.501 ms
rank = 0, Efermi =  -0.175953060172 calculate fermi energy took 0.090 ms
rank = 0, --- Calculate rho: sum over local bands took 2.196 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.964 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1277.710 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, D2D took 0.923 ms
rank = 0, Transfering density took 0.926 ms
Etot    =   -34.665715871411
Eband   =    -9.863144899992
E1      =    20.464955652451
E2      =    -8.829356523430
E3      =   -11.298167276932
Exc     =   -10.098025926176
Esc     =   -55.297024497495
Entropy =    -0.000000000561
dE = 6.934e-03, dEband = 4.690e-02
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -34.665715871, dEtot = 6.934e-03, dEband = 4.690e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 21.6233857235696, which took 0.108 ms

iter_count = 96, r_2norm = 7.131e-04, tol*||rhs|| = 8.649e-04

Anderson update took 50.825 ms, out of which F'*F took 24.016 ms; b-Ax took 161.923 ms, out of which Lap took 145.208 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.587 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863052, int_b + int_rho = 1.055e-13, checking this took 0.109 ms
2-norm of RHS = 604.1713809967767, which took 0.161 ms

iter_count = 294, r_2norm = 5.737e-04, tol*||rhs|| = 6.042e-04

Anderson update took 155.103 ms, out of which F'*F took 72.574 ms; b-Ax took 509.160 ms, out of which Lap took 455.928 ms
Solving Poisson took 1065.286 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.879 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.210681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.198829 
Total time for convolution: 	 convolve: 5.253310 
Total time for convolution: 	 convolve: 5.224935 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.253 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.963 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.850 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.834 ms

This SCF took 27577.899 ms, scf error = 1.128e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.149022, lowerbound = -1.079597, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1191.677 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.040 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.805 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 15.866 ms
rank =  0, finding HY took 20.238 ms
rank =  0, distributing HY into block cyclic form took 12.535 ms
rank =  0, finding Y'*HY took 4.374 ms
Rank 0, Project_Hamiltonian used 53.044 ms
Total time for projection: 53.056 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -1.086154901306800
    last  calculated eigval = 0.043155320235296
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08615490130680
lambda[   2] =  -0.74113422694058
lambda[   3] =  -0.57653654343574
lambda[   4] =  -0.45577935855170
lambda[   5] =  -0.45358528079127
lambda[   6] =  -0.44502952767468
lambda[   7] =  -0.37561280005679
lambda[   8] =  -0.35742294279076
lambda[   9] =  -0.20028837275693
lambda[  10] =  -0.14603181594961
lambda[  11] =  -0.02681418820969
lambda[  12] =   0.01759364166782
lambda[  13] =   0.02682514443434
lambda[  14] =   0.03197272614830
lambda[  15] =   0.04315532023530
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.453 ms
rank =  0, Distributing orbital back into band + domain format took 12.143 ms
rank = 0, Subspace_Rotation used 15.609 ms

Total time for subspace rotation: 15.614 ms
rank = 0, Efermi =  -0.173110042936 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.243 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.909 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1266.914 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.630 ms
rank = 0, D2D took 0.802 ms
rank = 0, Transfering density took 0.805 ms
Etot    =   -34.634795394185
Eband   =    -9.383087902108
E1      =    20.038752347684
E2      =    -8.769828724595
E3      =   -11.485475749105
Exc     =   -10.248739805903
Esc     =   -55.297024497495
Entropy =    -0.000000010062
dE = 5.153e-03, dEband = 8.001e-02
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -34.634795394, dEtot = 5.153e-03, dEband = 8.001e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 10.9388296599833, which took 0.099 ms

iter_count = 96, r_2norm = 3.034e-04, tol*||rhs|| = 4.376e-04

Anderson update took 51.590 ms, out of which F'*F took 23.813 ms; b-Ax took 160.553 ms, out of which Lap took 143.735 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.407 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863057, int_b + int_rho = 1.564e-13, checking this took 0.102 ms
2-norm of RHS = 603.8582198754444, which took 0.107 ms

iter_count = 258, r_2norm = 4.930e-04, tol*||rhs|| = 6.039e-04

Anderson update took 137.572 ms, out of which F'*F took 65.063 ms; b-Ax took 435.172 ms, out of which Lap took 391.443 ms
Solving Poisson took 924.322 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.090882 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 78.241 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.103311 
Total time for convolution: 	 convolve: 5.093994 
Total time for convolution: 	 convolve: 5.103627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.863 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.191 ms

This SCF took 26997.295 ms, scf error = 3.608e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.143155, lowerbound = -1.086155, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1181.880 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 19.507 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.467 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.052 ms
rank =  0, Distribute data + matrix mult took 23.040 ms
rank =  0, finding HY took 19.400 ms
rank =  0, distributing HY into block cyclic form took 11.958 ms
rank =  0, finding Y'*HY took 5.436 ms
Rank 0, Project_Hamiltonian used 59.865 ms
Total time for projection: 59.884 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.157 ms
    first calculated eigval = -1.080608637458200
    last  calculated eigval = 0.038779764956812
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.08060863745820
lambda[   2] =  -0.73537183751485
lambda[   3] =  -0.56930111130598
lambda[   4] =  -0.44923169509543
lambda[   5] =  -0.44871505816326
lambda[   6] =  -0.43751502511929
lambda[   7] =  -0.36979456741741
lambda[   8] =  -0.34928747152782
lambda[   9] =  -0.19357775655627
lambda[  10] =  -0.14111996830140
lambda[  11] =  -0.02939359233038
lambda[  12] =   0.01459900835985
lambda[  13] =   0.01990006925110
lambda[  14] =   0.02705421073277
lambda[  15] =   0.03877976495681
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.498 ms
rank =  0, Distributing orbital back into band + domain format took 12.040 ms
rank = 0, Subspace_Rotation used 15.550 ms

Total time for subspace rotation: 15.555 ms
rank = 0, Efermi =  -0.167328267354 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.158 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.385 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.235 ms
rank = 0, Calculating density took 1264.386 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.607 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.824 ms
Etot    =   -34.632277837761
Eband   =    -9.266806299862
E1      =    19.953328438251
E2      =    -8.730140442370
E3      =   -11.534986041776
Exc     =   -10.286901938364
Esc     =   -55.297024497495
Entropy =    -0.000000024437
dE = 4.196e-04, dEband = 1.938e-02
rank = 0, Calculating/Estimating energy took 1.087 ms, Etot = -34.632277838, dEtot = 4.196e-04, dEband = 1.938e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1063483713858, which took 0.050 ms

iter_count = 108, r_2norm = 5.715e-05, tol*||rhs|| = 8.425e-05

Anderson update took 57.545 ms, out of which F'*F took 27.299 ms; b-Ax took 185.015 ms, out of which Lap took 165.371 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.565 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863052, int_b + int_rho = 1.055e-13, checking this took 0.103 ms
2-norm of RHS = 604.0140058686561, which took 0.110 ms

iter_count = 252, r_2norm = 4.896e-04, tol*||rhs|| = 6.040e-04

Anderson update took 134.417 ms, out of which F'*F took 63.764 ms; b-Ax took 427.413 ms, out of which Lap took 385.780 ms
Solving Poisson took 910.460 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.100824 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.112879 
Total time for convolution: 	 convolve: 5.132587 
Total time for convolution: 	 convolve: 5.124826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.994 ms
---Transfer Veff_loc: D2D took 2.406 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.807 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.235 ms

This SCF took 27042.285 ms, scf error = 1.593e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.138780, lowerbound = -1.080609, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1160.998 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.114 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.385 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.518 ms
rank =  0, finding HY took 19.539 ms
rank =  0, distributing HY into block cyclic form took 11.948 ms
rank =  0, finding Y'*HY took 4.361 ms
Rank 0, Project_Hamiltonian used 51.396 ms
Total time for projection: 51.409 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.076017414239375
    last  calculated eigval = 0.035890670339628
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07601741423938
lambda[   2] =  -0.73195754438790
lambda[   3] =  -0.56499361372020
lambda[   4] =  -0.44548280925274
lambda[   5] =  -0.44502919061607
lambda[   6] =  -0.43287338638076
lambda[   7] =  -0.36604096737501
lambda[   8] =  -0.34425871200067
lambda[   9] =  -0.18931513625260
lambda[  10] =  -0.13765150252874
lambda[  11] =  -0.03022466594427
lambda[  12] =   0.01340934067454
lambda[  13] =   0.01701344450042
lambda[  14] =   0.02359776946944
lambda[  15] =   0.03589067033963
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.532 ms
rank =  0, Distributing orbital back into band + domain format took 12.121 ms
rank = 0, Subspace_Rotation used 15.667 ms

Total time for subspace rotation: 15.671 ms
rank = 0, Efermi =  -0.163469272299 calculate fermi energy took 2.122 ms
rank = 0, --- Calculate rho: sum over local bands took 3.249 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.947 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.166 ms
rank = 0, Calculating density took 1235.771 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.620 ms
rank = 0, D2D took 0.808 ms
rank = 0, Transfering density took 0.811 ms
Etot    =   -34.631541094427
Eband   =    -9.191937516973
E1      =    19.908679007193
E2      =    -8.693209003567
E3      =   -11.564175309167
Exc     =   -10.308642364061
Esc     =   -55.297024497495
Entropy =    -0.000000035826
dE = 1.228e-04, dEband = 1.248e-02
rank = 0, Calculating/Estimating energy took 0.977 ms, Etot = -34.631541094, dEtot = 1.228e-04, dEband = 1.248e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7639842729286, which took 0.079 ms

iter_count = 108, r_2norm = 2.506e-05, tol*||rhs|| = 3.056e-05

Anderson update took 58.600 ms, out of which F'*F took 26.991 ms; b-Ax took 184.341 ms, out of which Lap took 164.833 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.535 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863070, int_b + int_rho = 2.801e-13, checking this took 0.121 ms
2-norm of RHS = 604.5047515143871, which took 0.065 ms

iter_count = 240, r_2norm = 5.746e-04, tol*||rhs|| = 6.045e-04

Anderson update took 126.685 ms, out of which F'*F took 59.299 ms; b-Ax took 408.312 ms, out of which Lap took 362.939 ms
Solving Poisson took 861.620 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.122880 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.091189 
Total time for convolution: 	 convolve: 5.103514 
Total time for convolution: 	 convolve: 5.098446 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.989 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.617 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.303 ms

This SCF took 26931.242 ms, scf error = 5.430e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.135891, lowerbound = -1.076017, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1143.173 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 21.323 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.474 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 24.831 ms
rank =  0, finding HY took 19.468 ms
rank =  0, distributing HY into block cyclic form took 11.917 ms
rank =  0, finding Y'*HY took 4.371 ms
Rank 0, Project_Hamiltonian used 60.612 ms
Total time for projection: 60.624 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.159 ms
    first calculated eigval = -1.074400899399669
    last  calculated eigval = 0.034249142206975
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07440089939967
lambda[   2] =  -0.72896753848568
lambda[   3] =  -0.56255037143631
lambda[   4] =  -0.44343692080862
lambda[   5] =  -0.44294187082168
lambda[   6] =  -0.42997753976486
lambda[   7] =  -0.36345524600552
lambda[   8] =  -0.34163784917347
lambda[   9] =  -0.18766759814874
lambda[  10] =  -0.13654320824322
lambda[  11] =  -0.03009251796520
lambda[  12] =   0.01341909988696
lambda[  13] =   0.01606679150864
lambda[  14] =   0.02134463730123
lambda[  15] =   0.03424914220698
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 3.534 ms
rank =  0, Distributing orbital back into band + domain format took 12.030 ms
rank = 0, Subspace_Rotation used 15.576 ms

Total time for subspace rotation: 15.582 ms
rank = 0, Efermi =  -0.162094534199 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.002 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.364 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1226.207 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.582 ms
rank = 0, D2D took 0.771 ms
rank = 0, Transfering density took 0.774 ms
Etot    =   -34.631383622606
Eband   =    -9.150071626524
E1      =    19.893831677330
E2      =    -8.663336369104
E3      =   -11.573288674134
Exc     =   -10.314744172855
Esc     =   -55.297024497495
Entropy =    -0.000000046300
dE = 2.625e-05, dEband = 6.978e-03
rank = 0, Calculating/Estimating energy took 1.993 ms, Etot = -34.631383623, dEtot = 2.625e-05, dEband = 6.978e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4317948428297, which took 0.053 ms

iter_count = 108, r_2norm = 1.403e-05, tol*||rhs|| = 1.727e-05

Anderson update took 58.511 ms, out of which F'*F took 27.491 ms; b-Ax took 183.014 ms, out of which Lap took 165.121 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.967 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863053, int_b + int_rho = 1.091e-13, checking this took 0.111 ms
2-norm of RHS = 604.6108339618800, which took 0.092 ms

iter_count = 216, r_2norm = 5.638e-04, tol*||rhs|| = 6.046e-04

Anderson update took 114.850 ms, out of which F'*F took 54.425 ms; b-Ax took 370.773 ms, out of which Lap took 333.155 ms
Solving Poisson took 778.476 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.105305 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.135431 
Total time for convolution: 	 convolve: 5.183748 
Total time for convolution: 	 convolve: 5.104635 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.819 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26933.587 ms, scf error = 2.068e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.134249, lowerbound = -1.074401, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1119.744 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 52.587 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.117 ms
rank =  0, Distribute data + matrix mult took 56.064 ms
rank =  0, finding HY took 19.521 ms
rank =  0, distributing HY into block cyclic form took 12.079 ms
rank =  0, finding Y'*HY took 4.172 ms
Rank 0, Project_Hamiltonian used 91.864 ms
Total time for projection: 91.879 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -1.073183751057556
    last  calculated eigval = 0.033393168490886
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07318375105756
lambda[   2] =  -0.72760699878538
lambda[   3] =  -0.56130723374959
lambda[   4] =  -0.44230877830371
lambda[   5] =  -0.44169441560806
lambda[   6] =  -0.42867735138211
lambda[   7] =  -0.36234206430719
lambda[   8] =  -0.34036082499376
lambda[   9] =  -0.18650375184330
lambda[  10] =  -0.13543959599939
lambda[  11] =  -0.02963852352709
lambda[  12] =   0.01377688304633
lambda[  13] =   0.01577798995634
lambda[  14] =   0.01978212066701
lambda[  15] =   0.03339316849089
==subpsace eigenproblem: bcast eigvals took 0.062 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 3.554 ms
rank =  0, Distributing orbital back into band + domain format took 12.085 ms
rank = 0, Subspace_Rotation used 15.652 ms

Total time for subspace rotation: 15.657 ms
rank = 0, Efermi =  -0.160961110157 calculate fermi energy took 0.104 ms
rank = 0, --- Calculate rho: sum over local bands took 3.217 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.185 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.187 ms
rank = 0, Calculating density took 1234.262 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.650 ms
rank = 0, D2D took 1.836 ms
rank = 0, Transfering density took 1.840 ms
Etot    =   -34.631371693831
Eband   =    -9.127970297191
E1      =    19.883482564030
E2      =    -8.650494423815
E3      =   -11.576903058219
Exc     =   -10.317256897570
Esc     =   -55.297024497495
Entropy =    -0.000000047638
dE = 1.988e-06, dEband = 3.684e-03
rank = 0, Calculating/Estimating energy took 0.867 ms, Etot = -34.631371694, dEtot = 1.988e-06, dEband = 3.684e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1816064285747, which took 0.094 ms

iter_count = 114, r_2norm = 4.350e-06, tol*||rhs|| = 7.264e-06

Anderson update took 60.752 ms, out of which F'*F took 29.096 ms; b-Ax took 195.030 ms, out of which Lap took 175.993 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.818 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863060, int_b + int_rho = 1.783e-13, checking this took 0.112 ms
2-norm of RHS = 604.6589886889185, which took 0.123 ms

iter_count = 216, r_2norm = 5.723e-04, tol*||rhs|| = 6.047e-04

Anderson update took 114.973 ms, out of which F'*F took 55.187 ms; b-Ax took 370.498 ms, out of which Lap took 333.567 ms
Solving Poisson took 781.191 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.197000 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.113455 
Total time for convolution: 	 convolve: 5.090312 
Total time for convolution: 	 convolve: 5.148871 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.515 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.293 ms

This SCF took 26991.003 ms, scf error = 1.331e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.133393, lowerbound = -1.073184, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1132.253 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 19.666 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.464 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.102 ms
rank =  0, Distribute data + matrix mult took 23.245 ms
rank =  0, finding HY took 19.386 ms
rank =  0, distributing HY into block cyclic form took 12.020 ms
rank =  0, finding Y'*HY took 4.235 ms
Rank 0, Project_Hamiltonian used 58.914 ms
Total time for projection: 58.929 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.071657990388272
    last  calculated eigval = 0.033475478843081
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07165799038827
lambda[   2] =  -0.72591180211767
lambda[   3] =  -0.55963558843125
lambda[   4] =  -0.44086502925324
lambda[   5] =  -0.44002335047446
lambda[   6] =  -0.42702685015755
lambda[   7] =  -0.36087072092669
lambda[   8] =  -0.33871018126930
lambda[   9] =  -0.18487865532250
lambda[  10] =  -0.13397642930166
lambda[  11] =  -0.02834760550241
lambda[  12] =   0.01512733553425
lambda[  13] =   0.01654617882064
lambda[  14] =   0.01988269354476
lambda[  15] =   0.03347547884308
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.177 ms
rank =  0, subspace rotation using ScaLAPACK took 3.531 ms
rank =  0, Distributing orbital back into band + domain format took 12.005 ms
rank = 0, Subspace_Rotation used 15.561 ms

Total time for subspace rotation: 15.567 ms
rank = 0, Efermi =  -0.159417755659 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.064 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.385 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1214.154 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
rank = 0, D2D took 0.689 ms
rank = 0, Transfering density took 1.292 ms
Etot    =   -34.631400274353
Eband   =    -9.099160290152
E1      =    19.868388700888
E2      =    -8.635568992004
E3      =   -11.581316327697
Exc     =   -10.320489455876
Esc     =   -55.297024497495
Entropy =    -0.000000051420
dE = 4.763e-06, dEband = 4.802e-03
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -34.631400274, dEtot = 4.763e-06, dEband = 4.802e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1041801391622, which took 0.084 ms

iter_count = 114, r_2norm = 2.729e-06, tol*||rhs|| = 4.167e-06

Anderson update took 61.506 ms, out of which F'*F took 29.111 ms; b-Ax took 195.026 ms, out of which Lap took 175.999 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.164 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863055, int_b + int_rho = 1.346e-13, checking this took 0.129 ms
2-norm of RHS = 604.6586357326241, which took 0.123 ms

iter_count = 204, r_2norm = 5.639e-04, tol*||rhs|| = 6.047e-04

Anderson update took 109.563 ms, out of which F'*F took 52.176 ms; b-Ax took 349.411 ms, out of which Lap took 314.733 ms
Solving Poisson took 738.786 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.120 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.150737 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.125182 
Total time for convolution: 	 convolve: 5.117568 
Total time for convolution: 	 convolve: 5.099979 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.431 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26962.899 ms, scf error = 7.472e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133475, lowerbound = -1.071658, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1154.057 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 13.910 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.092 ms
rank =  0, Distribute data + matrix mult took 17.341 ms
rank =  0, finding HY took 19.578 ms
rank =  0, distributing HY into block cyclic form took 12.030 ms
rank =  0, finding Y'*HY took 4.302 ms
Rank 0, Project_Hamiltonian used 53.291 ms
Total time for projection: 53.311 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -1.070687100461824
    last  calculated eigval = 0.033719152845636
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07068710046182
lambda[   2] =  -0.72510616415166
lambda[   3] =  -0.55874919736114
lambda[   4] =  -0.44003208486419
lambda[   5] =  -0.43910470328820
lambda[   6] =  -0.42616213971581
lambda[   7] =  -0.36007552300034
lambda[   8] =  -0.33781203853812
lambda[   9] =  -0.18391912574905
lambda[  10] =  -0.13303840840375
lambda[  11] =  -0.02673836346418
lambda[  12] =   0.01674187760497
lambda[  13] =   0.01803663115164
lambda[  14] =   0.02100979311269
lambda[  15] =   0.03371915284564
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 3.585 ms
rank =  0, Distributing orbital back into band + domain format took 11.928 ms
rank = 0, Subspace_Rotation used 16.036 ms

Total time for subspace rotation: 16.044 ms
rank = 0, Efermi =  -0.158469079073 calculate fermi energy took 0.619 ms
rank = 0, --- Calculate rho: sum over local bands took 3.237 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.418 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1230.106 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
rank = 0, D2D took 0.864 ms
rank = 0, Transfering density took 0.872 ms
Etot    =   -34.631454344444
Eband   =    -9.083296107210
E1      =    19.860748829343
E2      =    -8.626945526594
E3      =   -11.582718107987
Exc     =   -10.321546151719
Esc     =   -55.297024497495
Entropy =    -0.000000051944
dE = 9.012e-06, dEband = 2.644e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -34.631454344, dEtot = 9.012e-06, dEband = 2.644e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0628361229149, which took 0.046 ms

iter_count = 114, r_2norm = 1.662e-06, tol*||rhs|| = 2.513e-06

Anderson update took 61.268 ms, out of which F'*F took 29.025 ms; b-Ax took 195.130 ms, out of which Lap took 175.881 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.892 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863052, int_b + int_rho = 1.055e-13, checking this took 0.110 ms
2-norm of RHS = 604.6659776084623, which took 0.131 ms

iter_count = 198, r_2norm = 5.322e-04, tol*||rhs|| = 6.047e-04

Anderson update took 105.698 ms, out of which F'*F took 50.818 ms; b-Ax took 339.913 ms, out of which Lap took 306.102 ms
Solving Poisson took 717.377 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.198429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.109977 
Total time for convolution: 	 convolve: 5.092242 
Total time for convolution: 	 convolve: 5.096422 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.371 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 26853.517 ms, scf error = 4.964e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133719, lowerbound = -1.070687, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1123.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 27.480 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.422 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 30.926 ms
rank =  0, finding HY took 19.445 ms
rank =  0, distributing HY into block cyclic form took 11.975 ms
rank =  0, finding Y'*HY took 4.283 ms
Rank 0, Project_Hamiltonian used 66.656 ms
Total time for projection: 66.669 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.070117655878002
    last  calculated eigval = 0.033881373427644
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.07011765587800
lambda[   2] =  -0.72439912986198
lambda[   3] =  -0.55806869159217
lambda[   4] =  -0.43939743164596
lambda[   5] =  -0.43846581996338
lambda[   6] =  -0.42545821867969
lambda[   7] =  -0.35940208831961
lambda[   8] =  -0.33712194516906
lambda[   9] =  -0.18328361597092
lambda[  10] =  -0.13246338855377
lambda[  11] =  -0.02472169972372
lambda[  12] =   0.01862381097260
lambda[  13] =   0.02056060044959
lambda[  14] =   0.02299353177382
lambda[  15] =   0.03388137342764
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 4.123 ms
rank =  0, Distributing orbital back into band + domain format took 11.544 ms
rank = 0, Subspace_Rotation used 15.684 ms

Total time for subspace rotation: 15.693 ms
rank = 0, Efermi =  -0.157864086180 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.153 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.142 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.256 ms
rank = 0, Calculating density took 1212.988 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
rank = 0, D2D took 0.659 ms
rank = 0, Transfering density took 0.664 ms
Etot    =   -34.631484085963
Eband   =    -9.071429145660
E1      =    19.855101605482
E2      =    -8.620508111548
E3      =   -11.583662720257
Exc     =   -10.322302826651
Esc     =   -55.297024497495
Entropy =    -0.000000053444
dE = 4.957e-06, dEband = 1.978e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -34.631484086, dEtot = 4.957e-06, dEband = 1.978e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0394662941036, which took 0.069 ms

iter_count = 114, r_2norm = 1.002e-06, tol*||rhs|| = 1.579e-06

Anderson update took 60.707 ms, out of which F'*F took 28.898 ms; b-Ax took 194.774 ms, out of which Lap took 175.649 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.284 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863061, int_b + int_rho = 1.928e-13, checking this took 0.116 ms
2-norm of RHS = 604.6629990769437, which took 0.097 ms

iter_count = 186, r_2norm = 5.192e-04, tol*||rhs|| = 6.047e-04

Anderson update took 99.438 ms, out of which F'*F took 47.345 ms; b-Ax took 317.656 ms, out of which Lap took 286.110 ms
Solving Poisson took 675.330 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.096941 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.136995 
Total time for convolution: 	 convolve: 5.099879 
Total time for convolution: 	 convolve: 5.112201 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.933 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.283 ms

This SCF took 26748.575 ms, scf error = 3.030e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133881, lowerbound = -1.070118, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1129.252 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 24.475 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.480 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 27.997 ms
rank =  0, finding HY took 19.486 ms
rank =  0, distributing HY into block cyclic form took 12.117 ms
rank =  0, finding Y'*HY took 4.256 ms
Rank 0, Project_Hamiltonian used 63.886 ms
Total time for projection: 63.900 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.123 ms
    first calculated eigval = -1.069413017423439
    last  calculated eigval = 0.034214030960231
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.06941301742344
lambda[   2] =  -0.72377930694703
lambda[   3] =  -0.55747760902046
lambda[   4] =  -0.43878551053038
lambda[   5] =  -0.43784272958095
lambda[   6] =  -0.42485891674037
lambda[   7] =  -0.35882744747215
lambda[   8] =  -0.33652469758560
lambda[   9] =  -0.18265397350625
lambda[  10] =  -0.13182225825335
lambda[  11] =  -0.02207474763304
lambda[  12] =   0.02067483788961
lambda[  13] =   0.02392987667400
lambda[  14] =   0.02588707105975
lambda[  15] =   0.03421403096023
==subpsace eigenproblem: bcast eigvals took 0.077 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 3.968 ms
rank =  0, Distributing orbital back into band + domain format took 11.531 ms
rank = 0, Subspace_Rotation used 15.518 ms

Total time for subspace rotation: 15.528 ms
rank = 0, Efermi =  -0.157228648774 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.160 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.161 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1216.343 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.493 ms
rank = 0, D2D took 0.599 ms
rank = 0, Transfering density took 0.604 ms
Etot    =   -34.631510865095
Eband   =    -9.060326369376
E1      =    19.849302024027
E2      =    -8.614997578744
E3      =   -11.584644926908
Exc     =   -10.323104474748
Esc     =   -55.297024497495
Entropy =    -0.000000053156
dE = 4.463e-06, dEband = 1.850e-03
rank = 0, Calculating/Estimating energy took 0.899 ms, Etot = -34.631510865, dEtot = 4.463e-06, dEband = 1.850e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0293966044450, which took 0.046 ms

iter_count = 114, r_2norm = 7.939e-07, tol*||rhs|| = 1.176e-06

Anderson update took 60.843 ms, out of which F'*F took 29.110 ms; b-Ax took 195.042 ms, out of which Lap took 175.860 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.748 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863056, int_b + int_rho = 1.455e-13, checking this took 0.071 ms
2-norm of RHS = 604.6650447305673, which took 0.106 ms

iter_count = 144, r_2norm = 6.041e-04, tol*||rhs|| = 6.047e-04

Anderson update took 76.497 ms, out of which F'*F took 36.593 ms; b-Ax took 247.218 ms, out of which Lap took 222.426 ms
Solving Poisson took 521.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.142866 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.094761 
Total time for convolution: 	 convolve: 5.129801 
Total time for convolution: 	 convolve: 5.101920 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.608 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.317 ms

This SCF took 26607.627 ms, scf error = 1.779e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134214, lowerbound = -1.069413, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1139.342 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.426 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 24.888 ms
rank =  0, finding HY took 19.515 ms
rank =  0, distributing HY into block cyclic form took 12.028 ms
rank =  0, finding Y'*HY took 4.260 ms
Rank 0, Project_Hamiltonian used 60.732 ms
Total time for projection: 60.744 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.577 ms
rank = 0, Solve_Generalized_EigenProblem used 1.384 ms
    first calculated eigval = -1.069220867019626
    last  calculated eigval = 0.034009214305404
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.06922086701963
lambda[   2] =  -0.72361342012956
lambda[   3] =  -0.55731679544889
lambda[   4] =  -0.43861529195313
lambda[   5] =  -0.43767347663826
lambda[   6] =  -0.42469590950874
lambda[   7] =  -0.35867029749564
lambda[   8] =  -0.33636237645245
lambda[   9] =  -0.18248569544906
lambda[  10] =  -0.13164266111955
lambda[  11] =  -0.02122397002801
lambda[  12] =   0.02131719463494
lambda[  13] =   0.02484591217573
lambda[  14] =   0.02639055728461
lambda[  15] =   0.03400921430540
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.408 ms
rank =  0, subspace rotation using ScaLAPACK took 3.442 ms
rank =  0, Distributing orbital back into band + domain format took 12.137 ms
rank = 0, Subspace_Rotation used 15.595 ms

Total time for subspace rotation: 15.603 ms
rank = 0, Efermi =  -0.157054660624 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.028 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.292 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1223.685 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
rank = 0, D2D took 0.919 ms
rank = 0, Transfering density took 0.927 ms
Etot    =   -34.631526290530
Eband   =    -9.057308212222
E1      =    19.847796652066
E2      =    -8.613422569512
E3      =   -11.584890855063
Exc     =   -10.323303604579
Esc     =   -55.297024497495
Entropy =    -0.000000052873
dE = 2.571e-06, dEband = 5.030e-04
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -34.631526291, dEtot = 2.571e-06, dEband = 5.030e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0291364031191, which took 0.058 ms

iter_count = 108, r_2norm = 8.513e-07, tol*||rhs|| = 1.165e-06

Anderson update took 57.658 ms, out of which F'*F took 27.507 ms; b-Ax took 184.587 ms, out of which Lap took 166.714 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.487 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863068, int_b + int_rho = 2.583e-13, checking this took 0.105 ms
2-norm of RHS = 604.6711090210298, which took 0.092 ms

iter_count = 156, r_2norm = 4.667e-04, tol*||rhs|| = 6.047e-04

Anderson update took 83.723 ms, out of which F'*F took 39.793 ms; b-Ax took 266.462 ms, out of which Lap took 240.138 ms
Solving Poisson took 564.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.140250 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.612 ms
Total time for convolution: 	 convolve: 5.100950 
Total time for convolution: 	 convolve: 5.140706 
Total time for convolution: 	 convolve: 5.129001 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.338 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.322 ms

This SCF took 26938.543 ms, scf error = 1.398e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134009, lowerbound = -1.069221, upperbound = 267.576594

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1133.337 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 23.829 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.366 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 27.217 ms
rank =  0, finding HY took 18.633 ms
rank =  0, distributing HY into block cyclic form took 11.915 ms
rank =  0, finding Y'*HY took 4.400 ms
Rank 0, Project_Hamiltonian used 63.009 ms
Total time for projection: 63.024 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.069054831599035
    last  calculated eigval = 0.033932387861548
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -1.06905483159904
lambda[   2] =  -0.72342646682328
lambda[   3] =  -0.55712419077652
lambda[   4] =  -0.43843063804717
lambda[   5] =  -0.43748801072173
lambda[   6] =  -0.42450566267374
lambda[   7] =  -0.35848376493026
lambda[   8] =  -0.33617504502490
lambda[   9] =  -0.18230851599474
lambda[  10] =  -0.13146248156817
lambda[  11] =  -0.02023469814061
lambda[  12] =   0.02190310025523
lambda[  13] =   0.02562831427203
lambda[  14] =   0.02702322914196
lambda[  15] =   0.03393238786155
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.570 ms
rank =  0, Distributing orbital back into band + domain format took 12.108 ms
rank = 0, Subspace_Rotation used 15.692 ms

Total time for subspace rotation: 15.697 ms
rank = 0, Efermi =  -0.156875967675 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.134 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.205 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 1218.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.616 ms
rank = 0, D2D took 0.810 ms
rank = 0, Transfering density took 0.816 ms
Etot    =   -34.631552675118
Eband   =    -9.053994205282
E1      =    19.846272727504
E2      =    -8.611563395526
E3      =   -11.585106275424
Exc     =   -10.323476317996
Esc     =   -55.297024497495
Entropy =    -0.000000052799
dE = 4.397e-06, dEband = 5.523e-04
rank = 0, Calculating/Estimating energy took 0.947 ms, Etot = -34.631552675, dEtot = 4.397e-06, dEband = 5.523e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0182713981197, which took 0.103 ms

iter_count = 108, r_2norm = 6.861e-07, tol*||rhs|| = 7.309e-07

Anderson update took 57.413 ms, out of which F'*F took 27.516 ms; b-Ax took 185.149 ms, out of which Lap took 167.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.108 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000001863042, int_rho =  18.00000001863058, int_b + int_rho = 1.637e-13, checking this took 0.098 ms
2-norm of RHS = 604.6734638959452, which took 0.101 ms

iter_count = 138, r_2norm = 5.878e-04, tol*||rhs|| = 6.047e-04

Anderson update took 73.246 ms, out of which F'*F took 34.978 ms; b-Ax took 236.244 ms, out of which Lap took 212.782 ms
Solving Poisson took 502.242 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.116060 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.158095 
Total time for convolution: 	 convolve: 5.104086 
Total time for convolution: 	 convolve: 5.122168 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.477 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.298 ms

This SCF took 26734.424 ms, scf error = 9.304e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -1.06905483159904, occ[   1] =   2.00000000000000
lambda[   2] =  -0.72342646682328, occ[   2] =   2.00000000000000
lambda[   3] =  -0.55712419077652, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43843063804717, occ[   4] =   2.00000000000000
lambda[   5] =  -0.43748801072173, occ[   5] =   2.00000000000000
lambda[   6] =  -0.42450566267374, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35848376493026, occ[   7] =   2.00000000000000
lambda[   8] =  -0.33617504502490, occ[   8] =   2.00000000000000
lambda[   9] =  -0.18230851599474, occ[   9] =   1.99999900975467
lambda[  10] =  -0.13146248156817, occ[  10] =   0.00000100887592
lambda[  11] =  -0.02023469814061, occ[  11] =   0.00000000000000
lambda[  12] =   0.02190310025523, occ[  12] =   0.00000000000000
lambda[  13] =   0.02562831427203, occ[  13] =   0.00000000000000
lambda[  14] =   0.02702322914196, occ[  14] =   0.00000000000000
lambda[  15] =   0.03393238786155, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.350 ms, time for Allreduce/Reduce: 8.403 ms 
Time for calculating local force components: 15.989 ms
Start Calculating nonlocal forces
force_nloc = 
 -1.19872072689819   0.30028014437861   0.00000089075873
 -0.02527620201157   0.04429067268370   0.00000000187087
  0.02924850567300  -0.00475149133479  -0.04063134782838
  0.02924847542948  -0.00475152305250   0.04063137106898
  0.00090006705743   0.06399276663660   0.00000136167431
  0.53700080241310  -0.86162087590840   0.00000441967693
force_loc = 
  1.16906235565680  -0.28940983350300  -0.00000076563017
  0.02615000534630  -0.04790478457223  -0.00000014672460
 -0.03258017559307   0.00581250017502   0.04328032942271
 -0.03257981147675   0.00581361221069  -0.04328145961555
  0.00086905201565  -0.06223384006453  -0.00000113984094
 -0.52327871668841   0.83483438992596  -0.00000458010284
Time for calculating nonlocal force components: 27.058 ms
[32mforces_xc: 
[0m[32m  0.03139914219888  -0.00764330334425   0.00000002620939
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00017302878698  -0.00242115327684  -0.00000005859361
[0m[32m -0.01132042225353   0.02560281637925  -0.00000009623244
[0mTime for calculating XC forces components: 20.256 ms
 Cartesian force = 
  0.00174921727713   0.00324532464248   0.00000035031905
  0.00088224965438  -0.00359579477741   0.00000005412737
 -0.00332322360043   0.00107932595134   0.00264918057544
 -0.00332288972763   0.00108040626931  -0.00264988956548
  0.00160453660574  -0.00064390959365   0.00000036222086
  0.00241010979080  -0.00116535249207  -0.00000005767725
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Time for printing density: 391.509 ms
The program took 382.150 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:26:18
Job ID:        2266485
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:19:48,vmem=8372K,walltime=00:06:39,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-22-2
---------------------------------------
