---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:36
Job ID:    2266784
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:41
Job ID:    2266784
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 5.826 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 12.136 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 106.362 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.936 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.096 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.280953	    7.355188	    9.754316	
   13.874711	   10.474896	    9.695859	
    9.811892	   12.644812	    9.668097	
    7.496395	    7.589970	    9.943048	
    6.125289	   10.381201	   10.473918	
   12.128968	    9.404846	    9.735880	
    9.892903	   10.588810	    9.696993	
    7.511519	    9.461060	    9.526082	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.172 ms
Set up communicators.

--set up spincomm took 2.339 ms

--set up kptcomm took 0.356 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 15, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.011 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 15 
rank =  0, my blacs rank = 0, BLCYC size (250000, 5), actual size (250000, 5)
rank = 0, mb = nb = 15, mbQ = nbQ = 64
rank = 0, nr_Hp = 15, nc_Hp = 15
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.100 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 5
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.198 ms

Calculate_SplineDerivRadFun took 0.183 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.798 ms.
time spent on vectorized spline interp: 3.177 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.607 ms.
time spent on vectorized spline interp: 1.656 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.513 ms.
time spent on vectorized spline interp: 1.638 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.608 ms.

Calculating rb for all atom types took 16.007 ms
----------------------
Estimated memory usage
Total: 990.32 MB
orbitals             : 686.65 MB
global sized vectors : 213.62 MB
subspace matrices : 21.09 kB
others : 90.03 MB
----------------------------------------------
Estimated memory usage per processor: 82.53 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.915 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -18.0000000307481, sum_int_rho = 17.5001447390845
PosCharge = 18.000000030748, NegCharge = -17.500144739084, scal_fac = 1.028562923285
After scaling, int_rho = 18.0000000307482, PosCharge + NegCharge - NetCharge = -3.197e-14
--Calculate Vref took 0.412 ms
--Calculate rho_guess took 2.258 ms

 integral of b = -18.0000000307481,
 int{b} + Nelectron + NetCharge = -3.075e-08,
 Esc = -44.5398675663414,
 MPI_Reduce took 4.205 ms

Calculating b & b_ref took 12.643 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.039 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.047 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.018 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.158 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 28.369 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074816, int_b + int_rho = 6.185e-14, checking this took 0.088 ms
2-norm of RHS = 669.4161132028238, which took 0.117 ms

iter_count = 420, r_2norm = 5.529e-04, tol*||rhs|| = 6.694e-04

Anderson update took 237.167 ms, out of which F'*F took 104.938 ms; b-Ax took 715.794 ms, out of which Lap took 641.915 ms
Solving Poisson took 1528.670 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
Total time for convolution: 	 convolve: 5.272907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
Total time for convolution: 	 convolve: 5.156355 
Total time for convolution: 	 convolve: 5.205857 
Total time for convolution: 	 convolve: 5.232365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.743 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.385 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
rank = 0, XC calculation took 24753.863 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 1.618 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.237 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.975 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.168 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.661 ms
    Lanczos iter 53, eigmin  = -0.909775700, eigmax = 264.929338820, err_eigmin = 8.815e-04, err_eigmax = 9.671e-03
rank =   0, Lanczos took 121.616 ms, eigmin = -0.909775699817, eigmax = 267.578632208400

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.284428, lowerbound = -1.009776, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1127.503 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 244.330 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.220 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.439 ms
rank =  0, Distribute data + matrix mult took 249.009 ms
rank =  0, finding HY took 20.627 ms
rank =  0, distributing HY into block cyclic form took 12.017 ms
rank =  0, finding Y'*HY took 5.470 ms
Rank 0, Project_Hamiltonian used 287.150 ms
Total time for projection: 287.165 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.303 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.374 ms
    first calculated eigval = 2.797319628782701
    last  calculated eigval = 3.222067684728690
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =   2.79731962878270
lambda[   2] =   2.83948563739493
lambda[   3] =   2.88487821270686
lambda[   4] =   2.92089699384786
lambda[   5] =   2.93982490156178
lambda[   6] =   2.96011513136914
lambda[   7] =   2.98381853127515
lambda[   8] =   3.01962484918136
lambda[   9] =   3.04226730066324
lambda[  10] =   3.06135872512934
lambda[  11] =   3.09261270007111
lambda[  12] =   3.10682348658195
lambda[  13] =   3.14057929789454
lambda[  14] =   3.15614541456439
lambda[  15] =   3.22206768472869
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.401 ms
rank =  0, subspace rotation using ScaLAPACK took 3.396 ms
rank =  0, Distributing orbital back into band + domain format took 12.152 ms
rank = 0, Subspace_Rotation used 15.563 ms

Total time for subspace rotation: 15.567 ms
rank = 0, Efermi =   3.051813013448 calculate fermi energy took 0.063 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.322068, lowerbound = -1.009776, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1184.305 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 11.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.408 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.946 ms
rank =  0, Distribute data + matrix mult took 18.096 ms
rank =  0, finding HY took 19.647 ms
rank =  0, distributing HY into block cyclic form took 11.811 ms
rank =  0, finding Y'*HY took 4.436 ms
Rank 0, Project_Hamiltonian used 54.019 ms
Total time for projection: 54.032 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.149 ms
    first calculated eigval = -0.704083756794691
    last  calculated eigval = 0.442828442192021
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.70408375679469
lambda[   2] =  -0.43870517354814
lambda[   3] =  -0.24594264102773
lambda[   4] =  -0.16514477293197
lambda[   5] =  -0.07978697921024
lambda[   6] =   0.08022096376848
lambda[   7] =   0.22570269263925
lambda[   8] =   0.30011643813370
lambda[   9] =   0.33907996868989
lambda[  10] =   0.34823028290348
lambda[  11] =   0.36662446972288
lambda[  12] =   0.39611477426111
lambda[  13] =   0.40530180565091
lambda[  14] =   0.42842291583283
lambda[  15] =   0.44282844219202
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.163 ms
rank =  0, subspace rotation using ScaLAPACK took 3.599 ms
rank =  0, Distributing orbital back into band + domain format took 12.088 ms
rank = 0, Subspace_Rotation used 15.703 ms

Total time for subspace rotation: 15.707 ms
rank = 0, Efermi =   0.343655078503 calculate fermi energy took 0.040 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.542828, lowerbound = -1.009776, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1185.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.316 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.783 ms
rank =  0, finding HY took 19.318 ms
rank =  0, distributing HY into block cyclic form took 12.259 ms
rank =  0, finding Y'*HY took 4.196 ms
Rank 0, Project_Hamiltonian used 51.606 ms
Total time for projection: 51.618 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.071 ms
rank = 0, Solve_Generalized_EigenProblem used 0.153 ms
    first calculated eigval = -0.921976279284223
    last  calculated eigval = 0.168542752070717
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92197627928422
lambda[   2] =  -0.79233095064587
lambda[   3] =  -0.62407346126221
lambda[   4] =  -0.55827170719807
lambda[   5] =  -0.51004384661898
lambda[   6] =  -0.46397465718022
lambda[   7] =  -0.40385521580858
lambda[   8] =  -0.24689110098796
lambda[   9] =  -0.16717995600270
lambda[  10] =   0.03894696419950
lambda[  11] =   0.04788227809015
lambda[  12] =   0.09428712450355
lambda[  13] =   0.11537922582107
lambda[  14] =   0.13605343917436
lambda[  15] =   0.16854275207072
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.593 ms
rank =  0, Distributing orbital back into band + domain format took 12.217 ms
rank = 0, Subspace_Rotation used 15.824 ms

Total time for subspace rotation: 15.829 ms
rank = 0, Efermi =   0.010169758014 calculate fermi energy took 0.042 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.268543, lowerbound = -1.009776, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1975.875 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 176.374 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 25.318 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 201.712 ms
rank =  0, finding HY took 92.438 ms
rank =  0, distributing HY into block cyclic form took 32.384 ms
rank =  0, finding Y'*HY took 14.637 ms
Rank 0, Project_Hamiltonian used 341.206 ms
Total time for projection: 341.219 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.922931734793199
    last  calculated eigval = 0.098435908641809
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.92293173479320
lambda[   2] =  -0.79492594775111
lambda[   3] =  -0.62839812939039
lambda[   4] =  -0.56159845079852
lambda[   5] =  -0.53219292180973
lambda[   6] =  -0.48209670524592
lambda[   7] =  -0.42948767738277
lambda[   8] =  -0.38607424779840
lambda[   9] =  -0.28455208018336
lambda[  10] =  -0.07413490215018
lambda[  11] =   0.00238986822811
lambda[  12] =   0.04692264518822
lambda[  13] =   0.06869631632707
lambda[  14] =   0.08296867336359
lambda[  15] =   0.09843590864181
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 2.071 ms
rank =  0, Distributing orbital back into band + domain format took 10.710 ms
rank = 0, Subspace_Rotation used 12.797 ms

Total time for subspace rotation: 12.802 ms
rank = 0, Efermi =  -0.102912096619 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.441 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.801 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.122 ms
rank = 0, Calculating density took 6397.086 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
rank = 0, D2D took 65.474 ms
rank = 0, Transfering density took 65.486 ms
Etot    =   -25.476672006266
Eband   =   -10.044515792586
E1      =    20.487063596190
E2      =    -7.515195027777
E3      =    -9.789961547073
Exc     =    -8.684508817467
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 3.185e+00, dEband = 1.256e+00
rank = 0, Calculating/Estimating energy took 60.975 ms, Etot = -25.476672006, dEtot = 3.185e+00, dEband = 1.256e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 44.2731924210249, which took 38.890 ms

iter_count = 96, r_2norm = 1.549e-03, tol*||rhs|| = 1.771e-03

Anderson update took 356.488 ms, out of which F'*F took 211.342 ms; b-Ax took 962.260 ms, out of which Lap took 950.760 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1638.903 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074814, int_b + int_rho = 4.002e-14, checking this took 0.105 ms
2-norm of RHS = 665.4172240918931, which took 0.068 ms

iter_count = 288, r_2norm = 5.621e-04, tol*||rhs|| = 6.654e-04

Anderson update took 156.237 ms, out of which F'*F took 71.915 ms; b-Ax took 542.853 ms, out of which Lap took 490.105 ms
Solving Poisson took 1080.576 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.874 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.147671 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.795 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.194109 
Total time for convolution: 	 convolve: 5.158733 
Total time for convolution: 	 convolve: 5.205781 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.988 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.853 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.862 ms

This SCF took 33998.783 ms, scf error = 1.927e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.198436, lowerbound = -0.922932, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1155.146 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.352 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.449 ms
rank =  0, finding HY took 19.480 ms
rank =  0, distributing HY into block cyclic form took 12.264 ms
rank =  0, finding Y'*HY took 4.116 ms
Rank 0, Project_Hamiltonian used 51.345 ms
Total time for projection: 51.359 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.893450391625969
    last  calculated eigval = 0.069691134016545
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.89345039162597
lambda[   2] =  -0.75372953860664
lambda[   3] =  -0.59926370252283
lambda[   4] =  -0.53318315090005
lambda[   5] =  -0.49726848666406
lambda[   6] =  -0.44842422020835
lambda[   7] =  -0.40137718183022
lambda[   8] =  -0.36115151381881
lambda[   9] =  -0.25299616897999
lambda[  10] =  -0.06614996053880
lambda[  11] =  -0.02620679771283
lambda[  12] =   0.02054098865931
lambda[  13] =   0.03445405303779
lambda[  14] =   0.04402820560671
lambda[  15] =   0.06969113401655
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.576 ms
rank =  0, Distributing orbital back into band + domain format took 12.288 ms
rank = 0, Subspace_Rotation used 15.878 ms

Total time for subspace rotation: 15.905 ms
rank = 0, Efermi =  -0.094927154944 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.469 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.548 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.169 ms
rank = 0, Calculating density took 1228.871 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 1.236 ms
rank = 0, Transfering density took 1.239 ms
Etot    =   -25.432773062528
Eband   =    -9.481688712348
E1      =    19.984992601167
E2      =    -7.470759674212
E3      =    -9.937487008979
Exc     =    -8.804456067286
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.487e-03, dEband = 7.035e-02
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -25.432773063, dEtot = 5.487e-03, dEband = 7.035e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 15.5567539547950, which took 0.071 ms

iter_count = 102, r_2norm = 5.863e-04, tol*||rhs|| = 6.223e-04

Anderson update took 53.833 ms, out of which F'*F took 25.208 ms; b-Ax took 173.522 ms, out of which Lap took 154.975 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.214 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074819, int_b + int_rho = 9.095e-14, checking this took 0.141 ms
2-norm of RHS = 659.8741367040458, which took 0.134 ms

iter_count = 300, r_2norm = 6.387e-04, tol*||rhs|| = 6.599e-04

Anderson update took 158.079 ms, out of which F'*F took 73.872 ms; b-Ax took 506.896 ms, out of which Lap took 450.965 ms
Solving Poisson took 1074.405 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.831 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.262094 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.251942 
Total time for convolution: 	 convolve: 5.336822 
Total time for convolution: 	 convolve: 5.315559 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.261 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.931 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.858 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.807 ms

This SCF took 27919.856 ms, scf error = 1.314e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.169691, lowerbound = -0.893450, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1180.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.285 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.576 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.004 ms
rank =  0, Distribute data + matrix mult took 15.884 ms
rank =  0, finding HY took 20.339 ms
rank =  0, distributing HY into block cyclic form took 12.386 ms
rank =  0, finding Y'*HY took 4.205 ms
Rank 0, Project_Hamiltonian used 52.842 ms
Total time for projection: 52.855 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.127 ms
    first calculated eigval = -0.846857439917658
    last  calculated eigval = 0.051210131893344
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84685743991766
lambda[   2] =  -0.68479752897178
lambda[   3] =  -0.54871807989774
lambda[   4] =  -0.48683749243914
lambda[   5] =  -0.43987634361642
lambda[   6] =  -0.38923502606428
lambda[   7] =  -0.34850836991123
lambda[   8] =  -0.31616449184305
lambda[   9] =  -0.19957158310170
lambda[  10] =  -0.03508275737853
lambda[  11] =  -0.02532933249010
lambda[  12] =   0.01119694909271
lambda[  13] =   0.01812560825525
lambda[  14] =   0.02549128559222
lambda[  15] =   0.05121013189334
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.555 ms
rank =  0, Distributing orbital back into band + domain format took 12.107 ms
rank = 0, Subspace_Rotation used 15.677 ms

Total time for subspace rotation: 15.682 ms
rank = 0, Efermi =  -0.063859955375 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.262 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.137 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1255.604 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
rank = 0, D2D took 0.820 ms
rank = 0, Transfering density took 0.823 ms
Etot    =   -25.391800838520
Eband   =    -8.521132712605
E1      =    19.171941413488
E2      =    -7.310118071084
E3      =   -10.220127472224
Exc     =    -9.032987515457
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.122e-03, dEband = 1.201e-01
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -25.391800839, dEtot = 5.122e-03, dEband = 1.201e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.7561742823883, which took 0.437 ms

iter_count = 102, r_2norm = 2.297e-04, tol*||rhs|| = 3.102e-04

Anderson update took 54.156 ms, out of which F'*F took 24.785 ms; b-Ax took 171.553 ms, out of which Lap took 152.375 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.647 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074812, int_b + int_rho = 1.819e-14, checking this took 0.107 ms
2-norm of RHS = 659.9908966697363, which took 0.098 ms

iter_count = 276, r_2norm = 5.622e-04, tol*||rhs|| = 6.600e-04

Anderson update took 145.571 ms, out of which F'*F took 67.787 ms; b-Ax took 470.708 ms, out of which Lap took 417.034 ms
Solving Poisson took 993.884 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.128410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Total time for convolution: 	 convolve: 5.204346 
Total time for convolution: 	 convolve: 5.157719 
Total time for convolution: 	 convolve: 5.124059 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.962 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.826 ms

This SCF took 27290.999 ms, scf error = 4.976e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151210, lowerbound = -0.846857, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1146.725 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.153 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.245 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.418 ms
rank =  0, finding HY took 19.464 ms
rank =  0, distributing HY into block cyclic form took 12.964 ms
rank =  0, finding Y'*HY took 4.565 ms
Rank 0, Project_Hamiltonian used 52.444 ms
Total time for projection: 52.460 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.840429024472094
    last  calculated eigval = 0.039838988171424
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.84042902447209
lambda[   2] =  -0.67351095634190
lambda[   3] =  -0.53780222377869
lambda[   4] =  -0.47912276545924
lambda[   5] =  -0.42971342438810
lambda[   6] =  -0.37824094978977
lambda[   7] =  -0.33556327321589
lambda[   8] =  -0.30840819914745
lambda[   9] =  -0.19445715860589
lambda[  10] =  -0.03641524075287
lambda[  11] =  -0.01771196390538
lambda[  12] =   0.00619588381807
lambda[  13] =   0.01032589259031
lambda[  14] =   0.01784137944691
lambda[  15] =   0.03983898817142
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.451 ms
rank =  0, Distributing orbital back into band + domain format took 12.090 ms
rank = 0, Subspace_Rotation used 15.558 ms

Total time for subspace rotation: 15.565 ms
rank = 0, Efermi =  -0.065192435240 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.297 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.381 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.189 ms
rank = 0, Calculating density took 1221.911 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.587 ms
rank = 0, D2D took 0.989 ms
rank = 0, Transfering density took 0.992 ms
Etot    =   -25.387780261102
Eband   =    -8.354495951518
E1      =    19.077163350549
E2      =    -7.228179040242
E3      =   -10.277681187364
Exc     =    -9.076440320487
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.026e-04, dEband = 2.083e-02
rank = 0, Calculating/Estimating energy took 0.908 ms, Etot = -25.387780261, dEtot = 5.026e-04, dEband = 2.083e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.4384800192092, which took 0.088 ms

iter_count = 108, r_2norm = 8.533e-05, tol*||rhs|| = 9.754e-05

Anderson update took 56.801 ms, out of which F'*F took 26.506 ms; b-Ax took 181.612 ms, out of which Lap took 161.925 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.860 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074812, int_b + int_rho = 1.819e-14, checking this took 0.105 ms
2-norm of RHS = 659.8952784332357, which took 0.102 ms

iter_count = 258, r_2norm = 6.111e-04, tol*||rhs|| = 6.599e-04

Anderson update took 135.848 ms, out of which F'*F took 63.846 ms; b-Ax took 440.952 ms, out of which Lap took 392.593 ms
Solving Poisson took 927.402 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Total time for convolution: 	 convolve: 5.144017 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 143.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.128158 
Total time for convolution: 	 convolve: 5.220228 
Total time for convolution: 	 convolve: 5.135255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.381 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
---Transfer Veff_loc: D2D took 1.029 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.796 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.848 ms

This SCF took 27318.580 ms, scf error = 1.822e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.139839, lowerbound = -0.840429, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1161.703 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.123 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.474 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.622 ms
rank =  0, finding HY took 19.627 ms
rank =  0, distributing HY into block cyclic form took 12.111 ms
rank =  0, finding Y'*HY took 4.265 ms
Rank 0, Project_Hamiltonian used 51.659 ms
Total time for projection: 51.674 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.150 ms
    first calculated eigval = -0.834996907804937
    last  calculated eigval = 0.032615580752377
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83499690780494
lambda[   2] =  -0.66560177010279
lambda[   3] =  -0.53110309539280
lambda[   4] =  -0.47326017813386
lambda[   5] =  -0.42264903079339
lambda[   6] =  -0.37046755728880
lambda[   7] =  -0.32780487525542
lambda[   8] =  -0.30302460888788
lambda[   9] =  -0.18838077432833
lambda[  10] =  -0.03653741097734
lambda[  11] =  -0.01332533175693
lambda[  12] =   0.00372328702559
lambda[  13] =   0.00653137184807
lambda[  14] =   0.01540189729172
lambda[  15] =   0.03261558075238
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.162 ms
rank =  0, subspace rotation using ScaLAPACK took 3.083 ms
rank =  0, Distributing orbital back into band + domain format took 12.464 ms
rank = 0, Subspace_Rotation used 15.568 ms

Total time for subspace rotation: 15.573 ms
rank = 0, Efermi =  -0.065314605434 calculate fermi energy took 2.713 ms
rank = 0, --- Calculate rho: sum over local bands took 3.239 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.946 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1237.248 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.790 ms
rank = 0, D2D took 0.999 ms
rank = 0, Transfering density took 1.008 ms
Etot    =   -25.386569909575
Eband   =    -8.234577597100
E1      =    18.999581137133
E2      =    -7.177964056056
E3      =   -10.315814232255
Exc     =    -9.105484170666
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.513e-04, dEband = 1.499e-02
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -25.386569910, dEtot = 1.513e-04, dEband = 1.499e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8357308095945, which took 0.050 ms

iter_count = 114, r_2norm = 2.316e-05, tol*||rhs|| = 3.343e-05

Anderson update took 59.863 ms, out of which F'*F took 28.429 ms; b-Ax took 194.121 ms, out of which Lap took 172.830 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.848 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074815, int_b + int_rho = 4.729e-14, checking this took 0.132 ms
2-norm of RHS = 660.2829395401922, which took 0.063 ms

iter_count = 252, r_2norm = 6.075e-04, tol*||rhs|| = 6.603e-04

Anderson update took 134.051 ms, out of which F'*F took 61.666 ms; b-Ax took 426.988 ms, out of which Lap took 379.286 ms
Solving Poisson took 903.178 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.128616 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.123957 
Total time for convolution: 	 convolve: 5.133766 
Total time for convolution: 	 convolve: 5.119367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.584 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.956 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.330 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 27072.945 ms, scf error = 9.798e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.132616, lowerbound = -0.834997, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.111 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.163 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.212 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.399 ms
rank =  0, finding HY took 19.785 ms
rank =  0, distributing HY into block cyclic form took 12.011 ms
rank =  0, finding Y'*HY took 4.220 ms
Rank 0, Project_Hamiltonian used 51.470 ms
Total time for projection: 51.487 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.832010753572401
    last  calculated eigval = 0.028758226208272
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.83201075357240
lambda[   2] =  -0.66225625212328
lambda[   3] =  -0.52773436942670
lambda[   4] =  -0.47003288843799
lambda[   5] =  -0.41924053455822
lambda[   6] =  -0.36675927310347
lambda[   7] =  -0.32378239243673
lambda[   8] =  -0.30009175518148
lambda[   9] =  -0.18485589808347
lambda[  10] =  -0.03606819987214
lambda[  11] =  -0.01083998289991
lambda[  12] =   0.00291785960161
lambda[  13] =   0.00557663114809
lambda[  14] =   0.01551370416744
lambda[  15] =   0.02875822620827
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.558 ms
rank =  0, Distributing orbital back into band + domain format took 12.185 ms
rank = 0, Subspace_Rotation used 15.758 ms

Total time for subspace rotation: 15.762 ms
rank = 0, Efermi =  -0.064845394267 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.282 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.140 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 1252.223 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.699 ms
rank = 0, D2D took 0.848 ms
rank = 0, Transfering density took 0.852 ms
Etot    =   -25.386000639522
Eband   =    -8.173528234957
E1      =    18.979038718522
E2      =    -7.133423319520
E3      =   -10.329167854786
Exc     =    -9.114234730140
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 7.116e-05, dEband = 7.631e-03
rank = 0, Calculating/Estimating energy took 0.909 ms, Etot = -25.386000640, dEtot = 7.116e-05, dEband = 7.631e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4130416656541, which took 0.045 ms

iter_count = 114, r_2norm = 1.020e-05, tol*||rhs|| = 1.652e-05

Anderson update took 59.629 ms, out of which F'*F took 28.229 ms; b-Ax took 192.198 ms, out of which Lap took 171.051 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 416.991 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074821, int_b + int_rho = 1.091e-13, checking this took 0.098 ms
2-norm of RHS = 660.4922134929491, which took 0.090 ms

iter_count = 252, r_2norm = 5.903e-04, tol*||rhs|| = 6.605e-04

Anderson update took 134.148 ms, out of which F'*F took 62.679 ms; b-Ax took 429.808 ms, out of which Lap took 384.796 ms
Solving Poisson took 904.591 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.153501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.183614 
Total time for convolution: 	 convolve: 5.182987 
Total time for convolution: 	 convolve: 5.191833 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 0.964 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.320 ms

This SCF took 27291.658 ms, scf error = 4.405e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128758, lowerbound = -0.832011, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1151.165 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.339 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.034 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 15.409 ms
rank =  0, finding HY took 19.943 ms
rank =  0, distributing HY into block cyclic form took 12.200 ms
rank =  0, finding Y'*HY took 4.089 ms
Rank 0, Project_Hamiltonian used 51.673 ms
Total time for projection: 51.689 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.200 ms
rank = 0, Solve_Generalized_EigenProblem used 0.281 ms
    first calculated eigval = -0.827801807536238
    last  calculated eigval = 0.028023387635830
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82780180753624
lambda[   2] =  -0.65692880680140
lambda[   3] =  -0.52315664145623
lambda[   4] =  -0.46613934033588
lambda[   5] =  -0.41455241684816
lambda[   6] =  -0.36179636800135
lambda[   7] =  -0.31897635578323
lambda[   8] =  -0.29543606213166
lambda[   9] =  -0.18012485400160
lambda[  10] =  -0.03495482649742
lambda[  11] =  -0.00630246376090
lambda[  12] =   0.00393097020315
lambda[  13] =   0.00658124339895
lambda[  14] =   0.01809901524012
lambda[  15] =   0.02802338763583
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.297 ms
rank =  0, subspace rotation using ScaLAPACK took 3.572 ms
rank =  0, Distributing orbital back into band + domain format took 12.179 ms
rank = 0, Subspace_Rotation used 15.768 ms

Total time for subspace rotation: 15.773 ms
rank = 0, Efermi =  -0.063732020865 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 3.261 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.204 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1225.700 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.724 ms
rank = 0, D2D took 0.845 ms
rank = 0, Transfering density took 0.852 ms
Etot    =   -25.385588070539
Eband   =    -8.089825306866
E1      =    18.938450208095
E2      =    -7.086548811405
E3      =   -10.343099158977
Exc     =    -9.123993374896
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.157e-05, dEband = 1.046e-02
rank = 0, Calculating/Estimating energy took 0.903 ms, Etot = -25.385588071, dEtot = 5.157e-05, dEband = 1.046e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2312797211020, which took 0.080 ms

iter_count = 114, r_2norm = 7.278e-06, tol*||rhs|| = 9.251e-06

Anderson update took 59.839 ms, out of which F'*F took 27.908 ms; b-Ax took 191.783 ms, out of which Lap took 170.227 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.027 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074818, int_b + int_rho = 8.004e-14, checking this took 0.079 ms
2-norm of RHS = 660.5293733851166, which took 0.068 ms

iter_count = 222, r_2norm = 6.125e-04, tol*||rhs|| = 6.605e-04

Anderson update took 118.213 ms, out of which F'*F took 55.171 ms; b-Ax took 377.460 ms, out of which Lap took 337.308 ms
Solving Poisson took 797.154 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.152730 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.624 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.251166 
Total time for convolution: 	 convolve: 5.132144 
Total time for convolution: 	 convolve: 5.144948 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.024 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.323 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.370 ms

This SCF took 27174.072 ms, scf error = 2.174e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128023, lowerbound = -0.827802, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1178.643 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.211 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.185 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.421 ms
rank =  0, finding HY took 19.768 ms
rank =  0, distributing HY into block cyclic form took 12.190 ms
rank =  0, finding Y'*HY took 4.120 ms
Rank 0, Project_Hamiltonian used 51.533 ms
Total time for projection: 51.549 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.826909991890686
    last  calculated eigval = 0.027379824038001
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82690999189069
lambda[   2] =  -0.65551915097609
lambda[   3] =  -0.52206207279065
lambda[   4] =  -0.46526471079407
lambda[   5] =  -0.41340695563934
lambda[   6] =  -0.36049958887443
lambda[   7] =  -0.31775318245836
lambda[   8] =  -0.29424869403742
lambda[   9] =  -0.17874462765798
lambda[  10] =  -0.03417645656481
lambda[  11] =  -0.00497534939892
lambda[  12] =   0.00502426449362
lambda[  13] =   0.00736995903830
lambda[  14] =   0.01968531534365
lambda[  15] =   0.02737982403800
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.160 ms
rank =  0, subspace rotation using ScaLAPACK took 3.623 ms
rank =  0, Distributing orbital back into band + domain format took 12.120 ms
rank = 0, Subspace_Rotation used 15.761 ms

Total time for subspace rotation: 15.766 ms
rank = 0, Efermi =  -0.062953651053 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.264 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.200 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 1252.870 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.701 ms
rank = 0, D2D took 0.815 ms
rank = 0, Transfering density took 0.817 ms
Etot    =   -25.385547117408
Eband   =    -8.068817951289
E1      =    18.929641909376
E2      =    -7.074094696125
E3      =   -10.343659335911
Exc     =    -9.124257540279
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.119e-06, dEband = 2.626e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -25.385547117, dEtot = 5.119e-06, dEband = 2.626e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1929964409945, which took 0.046 ms

iter_count = 114, r_2norm = 5.021e-06, tol*||rhs|| = 7.720e-06

Anderson update took 59.733 ms, out of which F'*F took 27.719 ms; b-Ax took 191.917 ms, out of which Lap took 170.401 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.651 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074816, int_b + int_rho = 6.548e-14, checking this took 0.099 ms
2-norm of RHS = 660.4908133587094, which took 0.104 ms

iter_count = 222, r_2norm = 5.346e-04, tol*||rhs|| = 6.605e-04

Anderson update took 117.525 ms, out of which F'*F took 55.721 ms; b-Ax took 379.601 ms, out of which Lap took 338.871 ms
Solving Poisson took 798.445 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.132049 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.129392 
Total time for convolution: 	 convolve: 5.129730 
Total time for convolution: 	 convolve: 5.193677 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.065 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.417 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.505 ms

This SCF took 27072.201 ms, scf error = 1.582e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.127380, lowerbound = -0.826910, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1157.830 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.081 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.278 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.380 ms
rank =  0, finding HY took 19.763 ms
rank =  0, distributing HY into block cyclic form took 12.003 ms
rank =  0, finding Y'*HY took 4.355 ms
Rank 0, Project_Hamiltonian used 51.538 ms
Total time for projection: 51.555 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.825849842922110
    last  calculated eigval = 0.027646469599606
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82584984292211
lambda[   2] =  -0.65382478860282
lambda[   3] =  -0.52064857104931
lambda[   4] =  -0.46411784027206
lambda[   5] =  -0.41193508145698
lambda[   6] =  -0.35886025102997
lambda[   7] =  -0.31609087415482
lambda[   8] =  -0.29294793402748
lambda[   9] =  -0.17732426169953
lambda[  10] =  -0.03275079646973
lambda[  11] =  -0.00354001572835
lambda[  12] =   0.00707959983162
lambda[  13] =   0.00901169538875
lambda[  14] =   0.02113567329815
lambda[  15] =   0.02764646959961
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.556 ms
rank =  0, Distributing orbital back into band + domain format took 12.090 ms
rank = 0, Subspace_Rotation used 15.661 ms

Total time for subspace rotation: 15.665 ms
rank = 0, Efermi =  -0.061527990951 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.263 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.227 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 1232.054 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.711 ms
rank = 0, D2D took 0.826 ms
rank = 0, Transfering density took 0.829 ms
Etot    =   -25.385568566408
Eband   =    -8.043198891437
E1      =    18.915719647322
E2      =    -7.061580948856
E3      =   -10.347223211703
Exc     =    -9.127025915599
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 2.681e-06, dEband = 3.202e-03
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -25.385568566, dEtot = 2.681e-06, dEband = 3.202e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0965186814357, which took 0.047 ms

iter_count = 114, r_2norm = 2.651e-06, tol*||rhs|| = 3.861e-06

Anderson update took 59.711 ms, out of which F'*F took 27.847 ms; b-Ax took 191.887 ms, out of which Lap took 169.997 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.269 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074820, int_b + int_rho = 1.055e-13, checking this took 0.911 ms
2-norm of RHS = 660.4719376107473, which took 0.124 ms

iter_count = 216, r_2norm = 5.402e-04, tol*||rhs|| = 6.605e-04

Anderson update took 114.267 ms, out of which F'*F took 53.697 ms; b-Ax took 368.197 ms, out of which Lap took 328.814 ms
Solving Poisson took 775.765 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.182749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.664 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.123065 
Total time for convolution: 	 convolve: 5.151268 
Total time for convolution: 	 convolve: 5.124693 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.800 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.937 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.293 ms

This SCF took 27121.790 ms, scf error = 1.028e-03
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.127646, lowerbound = -0.825850, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1156.338 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.191 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.248 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.461 ms
rank =  0, finding HY took 19.761 ms
rank =  0, distributing HY into block cyclic form took 12.219 ms
rank =  0, finding Y'*HY took 4.171 ms
Rank 0, Project_Hamiltonian used 51.658 ms
Total time for projection: 51.676 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.825011419884054
    last  calculated eigval = 0.029301530159017
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82501141988405
lambda[   2] =  -0.65291441043855
lambda[   3] =  -0.51976044902245
lambda[   4] =  -0.46330474268087
lambda[   5] =  -0.41103879257689
lambda[   6] =  -0.35793938363289
lambda[   7] =  -0.31512695889035
lambda[   8] =  -0.29201123029074
lambda[   9] =  -0.17637400401606
lambda[  10] =  -0.02967216974697
lambda[  11] =  -0.00230523025238
lambda[  12] =   0.01095594758685
lambda[  13] =   0.01238744838312
lambda[  14] =   0.02352129630414
lambda[  15] =   0.02930153015902
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.527 ms
rank =  0, Distributing orbital back into band + domain format took 12.455 ms
rank = 0, Subspace_Rotation used 15.999 ms

Total time for subspace rotation: 16.004 ms
rank = 0, Efermi =  -0.058449364222 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.271 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.063 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.171 ms
rank = 0, Calculating density took 1230.785 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.717 ms
rank = 0, D2D took 0.825 ms
rank = 0, Transfering density took 0.827 ms
Etot    =   -25.385628357733
Eband   =    -8.026962783778
E1      =    18.908232354167
E2      =    -7.052786979029
E3      =   -10.347540586857
Exc     =    -9.127357926755
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 7.474e-06, dEband = 2.030e-03
rank = 0, Calculating/Estimating energy took 0.970 ms, Etot = -25.385628358, dEtot = 7.474e-06, dEband = 2.030e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0791286925642, which took 0.059 ms

iter_count = 108, r_2norm = 3.013e-06, tol*||rhs|| = 3.165e-06

Anderson update took 56.679 ms, out of which F'*F took 26.289 ms; b-Ax took 181.251 ms, out of which Lap took 161.274 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.282 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074817, int_b + int_rho = 7.276e-14, checking this took 0.119 ms
2-norm of RHS = 660.4872672793138, which took 0.098 ms

iter_count = 198, r_2norm = 6.034e-04, tol*||rhs|| = 6.605e-04

Anderson update took 104.926 ms, out of which F'*F took 49.337 ms; b-Ax took 337.346 ms, out of which Lap took 301.712 ms
Solving Poisson took 711.617 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.193294 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.127519 
Total time for convolution: 	 convolve: 5.149738 
Total time for convolution: 	 convolve: 5.143629 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.826 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.927 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.339 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.293 ms

This SCF took 26958.361 ms, scf error = 6.231e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.129302, lowerbound = -0.825011, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1159.067 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.794 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 20.129 ms
rank =  0, finding HY took 19.728 ms
rank =  0, distributing HY into block cyclic form took 12.167 ms
rank =  0, finding Y'*HY took 4.219 ms
Rank 0, Project_Hamiltonian used 56.277 ms
Total time for projection: 56.290 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.076 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.824354972086672
    last  calculated eigval = 0.030912064726935
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82435497208667
lambda[   2] =  -0.65217544924276
lambda[   3] =  -0.51902563472349
lambda[   4] =  -0.46266751978303
lambda[   5] =  -0.41030940910203
lambda[   6] =  -0.35719157710427
lambda[   7] =  -0.31434049903150
lambda[   8] =  -0.29133524134186
lambda[   9] =  -0.17570474694523
lambda[  10] =  -0.02695597997176
lambda[  11] =  -0.00183521547686
lambda[  12] =   0.01311165641948
lambda[  13] =   0.01394784267749
lambda[  14] =   0.02536721140339
lambda[  15] =   0.03091206472694
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.604 ms
rank =  0, Distributing orbital back into band + domain format took 12.122 ms
rank = 0, Subspace_Rotation used 15.742 ms

Total time for subspace rotation: 15.748 ms
rank = 0, Efermi =  -0.055733174348 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.214 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.248 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.174 ms
rank = 0, Calculating density took 1238.047 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.722 ms
rank = 0, D2D took 0.835 ms
rank = 0, Transfering density took 0.837 ms
Etot    =   -25.385765140817
Eband   =    -8.014210099551
E1      =    18.901964096035
E2      =    -7.045933581332
E3      =   -10.348813601577
Exc     =    -9.128398752956
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.710e-05, dEband = 1.594e-03
rank = 0, Calculating/Estimating energy took 1.639 ms, Etot = -25.385765141, dEtot = 1.710e-05, dEband = 1.594e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0664628348679, which took 0.051 ms

iter_count = 108, r_2norm = 2.489e-06, tol*||rhs|| = 2.659e-06

Anderson update took 56.772 ms, out of which F'*F took 26.417 ms; b-Ax took 180.954 ms, out of which Lap took 160.938 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.011 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074819, int_b + int_rho = 9.459e-14, checking this took 0.102 ms
2-norm of RHS = 660.4894777995631, which took 0.102 ms

iter_count = 168, r_2norm = 5.739e-04, tol*||rhs|| = 6.605e-04

Anderson update took 89.468 ms, out of which F'*F took 41.812 ms; b-Ax took 287.369 ms, out of which Lap took 257.104 ms
Solving Poisson took 605.020 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.124959 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 177.763 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.158270 
Total time for convolution: 	 convolve: 5.174417 
Total time for convolution: 	 convolve: 5.163064 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.334 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.298 ms

This SCF took 27054.663 ms, scf error = 4.266e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.130912, lowerbound = -0.824355, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1173.878 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.269 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.193 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.484 ms
rank =  0, finding HY took 19.896 ms
rank =  0, distributing HY into block cyclic form took 12.001 ms
rank =  0, finding Y'*HY took 4.363 ms
Rank 0, Project_Hamiltonian used 51.776 ms
Total time for projection: 51.840 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.824141411908999
    last  calculated eigval = 0.031998599146095
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82414141190900
lambda[   2] =  -0.65197954937614
lambda[   3] =  -0.51883263515053
lambda[   4] =  -0.46247422079459
lambda[   5] =  -0.41011571839052
lambda[   6] =  -0.35700195713446
lambda[   7] =  -0.31416159253334
lambda[   8] =  -0.29113488596086
lambda[   9] =  -0.17550157540073
lambda[  10] =  -0.02534109771185
lambda[  11] =  -0.00174997469814
lambda[  12] =   0.01372906078264
lambda[  13] =   0.01521016169178
lambda[  14] =   0.02694610825880
lambda[  15] =   0.03199859914609
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.569 ms
rank =  0, Distributing orbital back into band + domain format took 12.149 ms
rank = 0, Subspace_Rotation used 15.732 ms

Total time for subspace rotation: 15.736 ms
rank = 0, Efermi =  -0.054118292118 calculate fermi energy took 0.087 ms
rank = 0, --- Calculate rho: sum over local bands took 3.172 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.256 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.171 ms
rank = 0, Calculating density took 1248.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.730 ms
rank = 0, D2D took 0.844 ms
rank = 0, Transfering density took 0.847 ms
Etot    =   -25.385806846175
Eband   =    -8.010687094080
E1      =    18.900107553951
E2      =    -7.044237051147
E3      =   -10.348928721343
Exc     =    -9.128525511283
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 5.213e-06, dEband = 4.404e-04
rank = 0, Calculating/Estimating energy took 2.364 ms, Etot = -25.385806846, dEtot = 5.213e-06, dEband = 4.404e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0512981336951, which took 0.047 ms

iter_count = 108, r_2norm = 1.980e-06, tol*||rhs|| = 2.052e-06

Anderson update took 56.643 ms, out of which F'*F took 26.482 ms; b-Ax took 181.925 ms, out of which Lap took 161.947 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.838 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074819, int_b + int_rho = 9.459e-14, checking this took 0.103 ms
2-norm of RHS = 660.4901502804196, which took 0.074 ms

iter_count = 144, r_2norm = 6.389e-04, tol*||rhs|| = 6.605e-04

Anderson update took 103.050 ms, out of which F'*F took 38.297 ms; b-Ax took 321.678 ms, out of which Lap took 281.004 ms
Solving Poisson took 639.936 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.136091 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.137880 
Total time for convolution: 	 convolve: 5.175414 
Total time for convolution: 	 convolve: 5.154359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.337 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.306 ms

This SCF took 26897.863 ms, scf error = 3.078e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.131999, lowerbound = -0.824141, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1183.097 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.125 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.287 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.435 ms
rank =  0, finding HY took 19.798 ms
rank =  0, distributing HY into block cyclic form took 12.074 ms
rank =  0, finding Y'*HY took 4.226 ms
Rank 0, Project_Hamiltonian used 51.561 ms
Total time for projection: 51.575 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.823910287792198
    last  calculated eigval = 0.032212245145504
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82391028779220
lambda[   2] =  -0.65176824646261
lambda[   3] =  -0.51862502603344
lambda[   4] =  -0.46225860680361
lambda[   5] =  -0.40990648259723
lambda[   6] =  -0.35679946750462
lambda[   7] =  -0.31396813611984
lambda[   8] =  -0.29092165086830
lambda[   9] =  -0.17529994478525
lambda[  10] =  -0.02482151471098
lambda[  11] =  -0.00169176989612
lambda[  12] =   0.01379909388660
lambda[  13] =   0.01529908810285
lambda[  14] =   0.02746422522857
lambda[  15] =   0.03221224514550
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.169 ms
rank =  0, subspace rotation using ScaLAPACK took 3.609 ms
rank =  0, Distributing orbital back into band + domain format took 12.060 ms
rank = 0, Subspace_Rotation used 15.686 ms

Total time for subspace rotation: 15.690 ms
rank = 0, Efermi =  -0.053598709100 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 3.171 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.317 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.158 ms
rank = 0, Calculating density took 1257.314 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.579 ms
rank = 0, D2D took 1.228 ms
rank = 0, Transfering density took 1.238 ms
Etot    =   -25.385834459440
Eband   =    -8.006915698697
E1      =    18.898114105637
E2      =    -7.042335705127
E3      =   -10.349353743902
Exc     =    -9.128854748154
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 3.452e-06, dEband = 4.714e-04
rank = 0, Calculating/Estimating energy took 1.081 ms, Etot = -25.385834459, dEtot = 3.452e-06, dEband = 4.714e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0300439273171, which took 0.046 ms

iter_count = 108, r_2norm = 1.011e-06, tol*||rhs|| = 1.202e-06

Anderson update took 57.075 ms, out of which F'*F took 26.493 ms; b-Ax took 199.935 ms, out of which Lap took 180.094 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 413.383 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074815, int_b + int_rho = 5.093e-14, checking this took 0.103 ms
2-norm of RHS = 660.4968867886201, which took 0.080 ms

iter_count = 168, r_2norm = 6.411e-04, tol*||rhs|| = 6.605e-04

Anderson update took 89.441 ms, out of which F'*F took 41.504 ms; b-Ax took 285.208 ms, out of which Lap took 254.802 ms
Solving Poisson took 603.626 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.154044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.160864 
Total time for convolution: 	 convolve: 5.160912 
Total time for convolution: 	 convolve: 5.123501 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.487 ms
---Transfer Veff_loc: D2D took 0.943 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.328 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.293 ms

This SCF took 26885.841 ms, scf error = 2.517e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132212, lowerbound = -0.823910, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.865 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.167 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.285 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.475 ms
rank =  0, finding HY took 19.735 ms
rank =  0, distributing HY into block cyclic form took 12.120 ms
rank =  0, finding Y'*HY took 4.205 ms
Rank 0, Project_Hamiltonian used 51.563 ms
Total time for projection: 51.577 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.823680361544296
    last  calculated eigval = 0.034078947536593
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82368036154430
lambda[   2] =  -0.65157240758007
lambda[   3] =  -0.51841438076865
lambda[   4] =  -0.46201844038628
lambda[   5] =  -0.40970149461892
lambda[   6] =  -0.35660564975159
lambda[   7] =  -0.31377654164900
lambda[   8] =  -0.29071555744685
lambda[   9] =  -0.17510494190392
lambda[  10] =  -0.02385049308256
lambda[  11] =  -0.00162083488915
lambda[  12] =   0.01392006450474
lambda[  13] =   0.01485497437622
lambda[  14] =   0.02925196210156
lambda[  15] =   0.03407894753659
==subpsace eigenproblem: bcast eigvals took 0.075 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 3.545 ms
rank =  0, Distributing orbital back into band + domain format took 11.907 ms
rank = 0, Subspace_Rotation used 15.474 ms

Total time for subspace rotation: 15.480 ms
rank = 0, Efermi =  -0.052627687542 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.620 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1241.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 0.968 ms
rank = 0, Transfering density took 0.974 ms
Etot    =   -25.385884245639
Eband   =    -8.003179552033
E1      =    18.896649625363
E2      =    -7.039996831770
E3      =   -10.349364870808
Exc     =    -9.128848454294
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 6.223e-06, dEband = 4.670e-04
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -25.385884246, dEtot = 6.223e-06, dEband = 4.670e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0281235915282, which took 0.051 ms

iter_count = 108, r_2norm = 1.037e-06, tol*||rhs|| = 1.125e-06

Anderson update took 56.749 ms, out of which F'*F took 26.412 ms; b-Ax took 181.693 ms, out of which Lap took 161.326 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.340 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074814, int_b + int_rho = 4.366e-14, checking this took 0.108 ms
2-norm of RHS = 660.4972918928006, which took 0.110 ms

iter_count = 96, r_2norm = 6.307e-04, tol*||rhs|| = 6.605e-04

Anderson update took 50.983 ms, out of which F'*F took 24.098 ms; b-Ax took 163.456 ms, out of which Lap took 146.175 ms
Solving Poisson took 346.647 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.125837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.155571 
Total time for convolution: 	 convolve: 5.189648 
Total time for convolution: 	 convolve: 5.126286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.029 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.955 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.336 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.315 ms

This SCF took 26617.422 ms, scf error = 1.967e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.134079, lowerbound = -0.823680, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1176.595 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.132 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.288 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.444 ms
rank =  0, finding HY took 19.914 ms
rank =  0, distributing HY into block cyclic form took 12.151 ms
rank =  0, finding Y'*HY took 4.152 ms
Rank 0, Project_Hamiltonian used 51.690 ms
Total time for projection: 51.703 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.823631115375027
    last  calculated eigval = 0.034271643549292
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82363111537503
lambda[   2] =  -0.65152691376551
lambda[   3] =  -0.51836773616858
lambda[   4] =  -0.46197217476098
lambda[   5] =  -0.40965483143201
lambda[   6] =  -0.35656087412404
lambda[   7] =  -0.31373215776490
lambda[   8] =  -0.29066811892052
lambda[   9] =  -0.17506091620753
lambda[  10] =  -0.02376161281788
lambda[  11] =  -0.00159387683243
lambda[  12] =   0.01398801954772
lambda[  13] =   0.01480134850747
lambda[  14] =   0.02915716917560
lambda[  15] =   0.03427164354929
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 3.576 ms
rank =  0, Distributing orbital back into band + domain format took 12.038 ms
rank = 0, Subspace_Rotation used 15.635 ms

Total time for subspace rotation: 15.640 ms
rank = 0, Efermi =  -0.052538807289 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 3.130 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.242 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1250.797 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.680 ms
rank = 0, D2D took 1.041 ms
rank = 0, Transfering density took 1.049 ms
Etot    =   -25.385886173427
Eband   =    -8.002349677769
E1      =    18.896224286716
E2      =    -7.039569182851
E3      =   -10.349457594229
Exc     =    -9.128919992201
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 2.410e-07, dEband = 1.037e-04
rank = 0, Calculating/Estimating energy took 0.914 ms, Etot = -25.385886173, dEtot = 2.410e-07, dEband = 1.037e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0283081954688, which took 0.094 ms

iter_count = 108, r_2norm = 1.004e-06, tol*||rhs|| = 1.132e-06

Anderson update took 57.017 ms, out of which F'*F took 26.442 ms; b-Ax took 181.265 ms, out of which Lap took 160.871 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.519 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074819, int_b + int_rho = 8.731e-14, checking this took 0.097 ms
2-norm of RHS = 660.4978388077276, which took 0.107 ms

iter_count = 120, r_2norm = 6.402e-04, tol*||rhs|| = 6.605e-04

Anderson update took 64.171 ms, out of which F'*F took 29.793 ms; b-Ax took 204.633 ms, out of which Lap took 182.688 ms
Solving Poisson took 432.940 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.156536 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.377 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.133113 
Total time for convolution: 	 convolve: 5.146553 
Total time for convolution: 	 convolve: 5.146636 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.951 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
---Transfer Veff_loc: D2D took 1.014 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.370 ms

This SCF took 26751.302 ms, scf error = 1.766e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.134272, lowerbound = -0.823631, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1169.544 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.070 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.355 ms
rank =  0, finding HY took 19.741 ms
rank =  0, distributing HY into block cyclic form took 11.996 ms
rank =  0, finding Y'*HY took 4.347 ms
Rank 0, Project_Hamiltonian used 51.472 ms
Total time for projection: 51.487 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -0.823563947854979
    last  calculated eigval = 0.034999460501217
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82356394785498
lambda[   2] =  -0.65146020439613
lambda[   3] =  -0.51829986863003
lambda[   4] =  -0.46190575420991
lambda[   5] =  -0.40958773611642
lambda[   6] =  -0.35649478846729
lambda[   7] =  -0.31366713992607
lambda[   8] =  -0.29060126946148
lambda[   9] =  -0.17499698191687
lambda[  10] =  -0.02331963244918
lambda[  11] =  -0.00156805729921
lambda[  12] =   0.01410293924680
lambda[  13] =   0.01487688423744
lambda[  14] =   0.02950930759111
lambda[  15] =   0.03499946050122
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 3.492 ms
rank =  0, Distributing orbital back into band + domain format took 11.869 ms
rank = 0, Subspace_Rotation used 15.376 ms

Total time for subspace rotation: 15.381 ms
rank = 0, Efermi =  -0.052096826861 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.193 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.180 ms
rank = 0, Calculating density took 1243.366 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
rank = 0, D2D took 1.158 ms
rank = 0, Transfering density took 1.160 ms
Etot    =   -25.385896018335
Eband   =    -8.001155382675
E1      =    18.895631106443
E2      =    -7.038950571759
E3      =   -10.349507993316
Exc     =    -9.128962739924
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.231e-06, dEband = 1.493e-04
rank = 0, Calculating/Estimating energy took 0.924 ms, Etot = -25.385896018, dEtot = 1.231e-06, dEband = 1.493e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0308008491000, which took 0.048 ms

iter_count = 108, r_2norm = 9.720e-07, tol*||rhs|| = 1.232e-06

Anderson update took 56.757 ms, out of which F'*F took 26.327 ms; b-Ax took 181.209 ms, out of which Lap took 160.893 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.100 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074818, int_b + int_rho = 8.367e-14, checking this took 0.089 ms
2-norm of RHS = 660.4970900230837, which took 0.106 ms

iter_count = 96, r_2norm = 6.461e-04, tol*||rhs|| = 6.605e-04

Anderson update took 50.942 ms, out of which F'*F took 24.099 ms; b-Ax took 163.585 ms, out of which Lap took 146.268 ms
Solving Poisson took 346.953 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.164969 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.129383 
Total time for convolution: 	 convolve: 5.162194 
Total time for convolution: 	 convolve: 5.120359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.936 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.335 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.295 ms

This SCF took 26567.923 ms, scf error = 1.604e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.134999, lowerbound = -0.823564, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1177.250 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.001 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.401 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.422 ms
rank =  0, finding HY took 19.641 ms
rank =  0, distributing HY into block cyclic form took 11.994 ms
rank =  0, finding Y'*HY took 4.348 ms
Rank 0, Project_Hamiltonian used 51.464 ms
Total time for projection: 51.480 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.823591319090443
    last  calculated eigval = 0.034241928622761
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82359131909044
lambda[   2] =  -0.65148193126053
lambda[   3] =  -0.51832077282229
lambda[   4] =  -0.46192692061159
lambda[   5] =  -0.40960894502534
lambda[   6] =  -0.35651389002487
lambda[   7] =  -0.31368485958434
lambda[   8] =  -0.29062645975240
lambda[   9] =  -0.17501753635116
lambda[  10] =  -0.02393090323838
lambda[  11] =  -0.00163396377112
lambda[  12] =   0.01376536446647
lambda[  13] =   0.01434414567167
lambda[  14] =   0.02871805405771
lambda[  15] =   0.03424192862276
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 3.522 ms
rank =  0, Distributing orbital back into band + domain format took 12.082 ms
rank = 0, Subspace_Rotation used 15.618 ms

Total time for subspace rotation: 15.622 ms
rank = 0, Efermi =  -0.052708097699 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.375 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.170 ms
rank = 0, Calculating density took 1251.290 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.680 ms
rank = 0, D2D took 0.837 ms
rank = 0, Transfering density took 0.844 ms
Etot    =   -25.385897258424
Eband   =    -8.001545269782
E1      =    18.895853598515
E2      =    -7.039145783004
E3      =   -10.349399146827
Exc     =    -9.128882949733
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.550e-07, dEband = 4.874e-05
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -25.385897258, dEtot = 1.550e-07, dEband = 4.874e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0382007254823, which took 0.049 ms

iter_count = 108, r_2norm = 9.399e-07, tol*||rhs|| = 1.528e-06

Anderson update took 56.760 ms, out of which F'*F took 26.423 ms; b-Ax took 180.622 ms, out of which Lap took 160.896 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.846 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074813, int_b + int_rho = 2.910e-14, checking this took 0.101 ms
2-norm of RHS = 660.4965893022362, which took 0.091 ms

iter_count = 114, r_2norm = 6.070e-04, tol*||rhs|| = 6.605e-04

Anderson update took 60.814 ms, out of which F'*F took 28.406 ms; b-Ax took 192.659 ms, out of which Lap took 172.910 ms
Solving Poisson took 409.893 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.120745 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 97.431 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.092246 
Total time for convolution: 	 convolve: 5.091096 
Total time for convolution: 	 convolve: 5.102308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.298 ms

This SCF took 26587.554 ms, scf error = 1.619e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134242, lowerbound = -0.823591, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1184.778 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.159 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.259 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.009 ms
rank =  0, Distribute data + matrix mult took 15.445 ms
rank =  0, finding HY took 19.758 ms
rank =  0, distributing HY into block cyclic form took 12.017 ms
rank =  0, finding Y'*HY took 4.306 ms
Rank 0, Project_Hamiltonian used 51.582 ms
Total time for projection: 51.600 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.823561879052880
    last  calculated eigval = 0.034603695574100
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82356187905288
lambda[   2] =  -0.65146019642077
lambda[   3] =  -0.51829259360993
lambda[   4] =  -0.46189495018108
lambda[   5] =  -0.40958232070587
lambda[   6] =  -0.35648959145466
lambda[   7] =  -0.31365813826869
lambda[   8] =  -0.29059927227136
lambda[   9] =  -0.17499423930017
lambda[  10] =  -0.02375563181863
lambda[  11] =  -0.00162419511579
lambda[  12] =   0.01381362303087
lambda[  13] =   0.01433947837115
lambda[  14] =   0.02881176937685
lambda[  15] =   0.03460369557410
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.519 ms
rank =  0, Distributing orbital back into band + domain format took 12.072 ms
rank = 0, Subspace_Rotation used 15.607 ms

Total time for subspace rotation: 15.611 ms
rank = 0, Efermi =  -0.052532826236 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 3.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.357 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.167 ms
rank = 0, Calculating density took 1258.891 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.660 ms
rank = 0, D2D took 0.826 ms
rank = 0, Transfering density took 0.833 ms
Etot    =   -25.385903826762
Eband   =    -8.001066363261
E1      =    18.895648200038
E2      =    -7.038877132620
E3      =   -10.349368130445
Exc     =    -9.128863359350
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 8.210e-07, dEband = 5.986e-05
rank = 0, Calculating/Estimating energy took 0.935 ms, Etot = -25.385903827, dEtot = 8.210e-07, dEband = 5.986e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0366380297886, which took 0.045 ms

iter_count = 108, r_2norm = 9.422e-07, tol*||rhs|| = 1.466e-06

Anderson update took 56.736 ms, out of which F'*F took 26.352 ms; b-Ax took 179.872 ms, out of which Lap took 160.552 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.415 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074821, int_b + int_rho = 1.128e-13, checking this took 0.103 ms
2-norm of RHS = 660.4973172727485, which took 0.110 ms

iter_count = 42, r_2norm = 6.360e-04, tol*||rhs|| = 6.605e-04

Anderson update took 22.383 ms, out of which F'*F took 10.454 ms; b-Ax took 71.095 ms, out of which Lap took 63.780 ms
Solving Poisson took 153.205 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.095765 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.274 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.120613 
Total time for convolution: 	 convolve: 5.105918 
Total time for convolution: 	 convolve: 5.084826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.331 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.286 ms

This SCF took 26197.140 ms, scf error = 1.663e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.134604, lowerbound = -0.823562, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1164.643 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.162 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.394 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.577 ms
rank =  0, finding HY took 19.576 ms
rank =  0, distributing HY into block cyclic form took 12.075 ms
rank =  0, finding Y'*HY took 4.169 ms
Rank 0, Project_Hamiltonian used 51.429 ms
Total time for projection: 51.442 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.823568603211686
    last  calculated eigval = 0.034639295888171
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82356860321169
lambda[   2] =  -0.65146653649633
lambda[   3] =  -0.51829636812810
lambda[   4] =  -0.46189965131186
lambda[   5] =  -0.40958687453120
lambda[   6] =  -0.35649454521105
lambda[   7] =  -0.31366046923401
lambda[   8] =  -0.29060442051386
lambda[   9] =  -0.17499944532753
lambda[  10] =  -0.02365639488708
lambda[  11] =  -0.00162197602287
lambda[  12] =   0.01387777911092
lambda[  13] =   0.01439983969672
lambda[  14] =   0.02893521512712
lambda[  15] =   0.03463929588817
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.551 ms
rank =  0, Distributing orbital back into band + domain format took 12.070 ms
rank = 0, Subspace_Rotation used 15.633 ms

Total time for subspace rotation: 15.637 ms
rank = 0, Efermi =  -0.052433589344 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.331 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.165 ms
rank = 0, Calculating density took 1238.625 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.663 ms
rank = 0, D2D took 0.835 ms
rank = 0, Transfering density took 0.838 ms
Etot    =   -25.385902714504
Eband   =    -8.001153828659
E1      =    18.895734510313
E2      =    -7.038885624117
E3      =   -10.349339857415
Exc     =    -9.128841310437
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.390e-07, dEband = 1.093e-05
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -25.385902715, dEtot = 1.390e-07, dEband = 1.093e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0378800678879, which took 0.048 ms

iter_count = 102, r_2norm = 1.402e-06, tol*||rhs|| = 1.515e-06

Anderson update took 53.501 ms, out of which F'*F took 25.027 ms; b-Ax took 170.476 ms, out of which Lap took 152.111 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 372.714 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074821, int_b + int_rho = 1.091e-13, checking this took 0.124 ms
2-norm of RHS = 660.4934138050921, which took 0.114 ms

iter_count = 126, r_2norm = 6.099e-04, tol*||rhs|| = 6.605e-04

Anderson update took 67.095 ms, out of which F'*F took 31.435 ms; b-Ax took 213.110 ms, out of which Lap took 191.340 ms
Solving Poisson took 452.663 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.081399 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 95.871 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.089274 
Total time for convolution: 	 convolve: 5.104591 
Total time for convolution: 	 convolve: 5.086416 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.858 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 1.000 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.441 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.464 ms

This SCF took 26498.635 ms, scf error = 1.771e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.134639, lowerbound = -0.823569, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1172.189 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.160 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.270 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 15.451 ms
rank =  0, finding HY took 19.651 ms
rank =  0, distributing HY into block cyclic form took 12.037 ms
rank =  0, finding Y'*HY took 4.245 ms
Rank 0, Project_Hamiltonian used 51.412 ms
Total time for projection: 51.425 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.823414651605821
    last  calculated eigval = 0.034040435379249
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82341465160582
lambda[   2] =  -0.65134326052515
lambda[   3] =  -0.51818068607076
lambda[   4] =  -0.46176917962335
lambda[   5] =  -0.40946901511346
lambda[   6] =  -0.35638534934021
lambda[   7] =  -0.31356873717558
lambda[   8] =  -0.29047699258717
lambda[   9] =  -0.17488531686191
lambda[  10] =  -0.02415578872480
lambda[  11] =  -0.00157203204893
lambda[  12] =   0.01357746720020
lambda[  13] =   0.01415433012700
lambda[  14] =   0.02823372546850
lambda[  15] =   0.03404043537925
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 3.551 ms
rank =  0, Distributing orbital back into band + domain format took 12.112 ms
rank = 0, Subspace_Rotation used 15.676 ms

Total time for subspace rotation: 15.680 ms
rank = 0, Efermi =  -0.052932983182 calculate fermi energy took 0.090 ms
rank = 0, --- Calculate rho: sum over local bands took 3.112 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.361 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1246.287 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.749 ms
rank = 0, D2D took 0.871 ms
rank = 0, Transfering density took 0.874 ms
Etot    =   -25.385908228195
Eband   =    -7.998986378550
E1      =    18.894340917154
E2      =    -7.038025982397
E3      =   -10.349684705678
Exc     =    -9.129105887621
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 6.892e-07, dEband = 2.709e-04
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -25.385908228, dEtot = 6.892e-07, dEband = 2.709e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0191417586311, which took 0.046 ms

iter_count = 108, r_2norm = 6.326e-07, tol*||rhs|| = 7.657e-07

Anderson update took 56.973 ms, out of which F'*F took 26.412 ms; b-Ax took 180.757 ms, out of which Lap took 161.157 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.419 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074818, int_b + int_rho = 8.004e-14, checking this took 0.929 ms
2-norm of RHS = 660.4969892514414, which took 0.096 ms

iter_count = 120, r_2norm = 6.470e-04, tol*||rhs|| = 6.605e-04

Anderson update took 63.934 ms, out of which F'*F took 29.960 ms; b-Ax took 202.900 ms, out of which Lap took 182.069 ms
Solving Poisson took 431.083 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.099372 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.528 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.106607 
Total time for convolution: 	 convolve: 5.109689 
Total time for convolution: 	 convolve: 5.090185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.332 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.296 ms

This SCF took 26472.313 ms, scf error = 1.060e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.134040, lowerbound = -0.823415, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1150.738 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.280 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.194 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 15.495 ms
rank =  0, finding HY took 19.728 ms
rank =  0, distributing HY into block cyclic form took 12.092 ms
rank =  0, finding Y'*HY took 4.249 ms
Rank 0, Project_Hamiltonian used 51.598 ms
Total time for projection: 51.611 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.823357234160055
    last  calculated eigval = 0.034042530078249
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82335723416006
lambda[   2] =  -0.65128975025560
lambda[   3] =  -0.51811934540590
lambda[   4] =  -0.46170883955378
lambda[   5] =  -0.40941254209190
lambda[   6] =  -0.35633088279454
lambda[   7] =  -0.31351055976420
lambda[   8] =  -0.29042584512065
lambda[   9] =  -0.17483633721278
lambda[  10] =  -0.02426810944985
lambda[  11] =  -0.00154817538008
lambda[  12] =   0.01331997743059
lambda[  13] =   0.01422617241662
lambda[  14] =   0.02788240357972
lambda[  15] =   0.03404253007825
==subpsace eigenproblem: bcast eigvals took 0.063 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.563 ms
rank =  0, Distributing orbital back into band + domain format took 12.181 ms
rank = 0, Subspace_Rotation used 15.757 ms

Total time for subspace rotation: 15.762 ms
rank = 0, Efermi =  -0.053045303836 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 3.174 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.272 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1225.038 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.717 ms
rank = 0, D2D took 0.835 ms
rank = 0, Transfering density took 0.837 ms
Etot    =   -25.385916649232
Eband   =    -7.997982673465
E1      =    18.893972664210
E2      =    -7.037380841305
E3      =   -10.349680775905
Exc     =    -9.129100689933
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 1.053e-06, dEband = 1.255e-04
rank = 0, Calculating/Estimating energy took 0.898 ms, Etot = -25.385916649, dEtot = 1.053e-06, dEband = 1.255e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0212148509041, which took 0.048 ms

iter_count = 102, r_2norm = 6.533e-07, tol*||rhs|| = 8.486e-07

Anderson update took 53.554 ms, out of which F'*F took 24.990 ms; b-Ax took 170.953 ms, out of which Lap took 152.274 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.029 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074817, int_b + int_rho = 6.912e-14, checking this took 0.096 ms
2-norm of RHS = 660.4999260602114, which took 0.103 ms

iter_count = 114, r_2norm = 6.399e-04, tol*||rhs|| = 6.605e-04

Anderson update took 60.615 ms, out of which F'*F took 28.545 ms; b-Ax took 193.649 ms, out of which Lap took 173.371 ms
Solving Poisson took 410.673 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.141665 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 220.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.093003 
Total time for convolution: 	 convolve: 5.093523 
Total time for convolution: 	 convolve: 5.173160 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.844 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.481 ms
---Transfer Veff_loc: D2D took 0.940 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.343 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 27376.874 ms, scf error = 1.025e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.134043, lowerbound = -0.823357, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1166.086 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.214 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.291 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.528 ms
rank =  0, finding HY took 19.646 ms
rank =  0, distributing HY into block cyclic form took 12.053 ms
rank =  0, finding Y'*HY took 4.199 ms
Rank 0, Project_Hamiltonian used 51.456 ms
Total time for projection: 51.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.823287247254543
    last  calculated eigval = 0.034087336437563
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82328724725454
lambda[   2] =  -0.65124108312697
lambda[   3] =  -0.51805865509446
lambda[   4] =  -0.46163918280317
lambda[   5] =  -0.40935523151325
lambda[   6] =  -0.35628067725201
lambda[   7] =  -0.31345651700836
lambda[   8] =  -0.29036459646710
lambda[   9] =  -0.17478380512485
lambda[  10] =  -0.02415081658089
lambda[  11] =  -0.00145166629753
lambda[  12] =   0.01341285169698
lambda[  13] =   0.01483328794925
lambda[  14] =   0.02810143687062
lambda[  15] =   0.03408733643756
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.172 ms
rank =  0, subspace rotation using ScaLAPACK took 3.545 ms
rank =  0, Distributing orbital back into band + domain format took 12.085 ms
rank = 0, Subspace_Rotation used 15.641 ms

Total time for subspace rotation: 15.647 ms
rank = 0, Efermi =  -0.052928010999 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.091 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.407 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.168 ms
rank = 0, Calculating density took 1240.154 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.675 ms
rank = 0, D2D took 0.829 ms
rank = 0, Transfering density took 0.836 ms
Etot    =   -25.385920260261
Eband   =    -7.996933992032
E1      =    18.893580064970
E2      =    -7.036699246008
E3      =   -10.349738011601
Exc     =    -9.129136023555
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 4.514e-07, dEband = 1.311e-04
rank = 0, Calculating/Estimating energy took 0.939 ms, Etot = -25.385920260, dEtot = 4.514e-07, dEband = 1.311e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0177765947422, which took 0.092 ms

iter_count = 102, r_2norm = 6.439e-07, tol*||rhs|| = 7.111e-07

Anderson update took 53.420 ms, out of which F'*F took 26.826 ms; b-Ax took 173.992 ms, out of which Lap took 155.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 377.390 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074818, int_b + int_rho = 8.004e-14, checking this took 0.097 ms
2-norm of RHS = 660.4979481708814, which took 0.071 ms

iter_count = 96, r_2norm = 6.489e-04, tol*||rhs|| = 6.605e-04

Anderson update took 51.374 ms, out of which F'*F took 24.090 ms; b-Ax took 162.683 ms, out of which Lap took 145.905 ms
Solving Poisson took 346.781 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.089633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.096578 
Total time for convolution: 	 convolve: 5.099634 
Total time for convolution: 	 convolve: 5.087812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.944 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.340 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 26358.318 ms, scf error = 1.162e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.134087, lowerbound = -0.823287, upperbound = 267.578632

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1148.675 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 59.884 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.365 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 63.274 ms
rank =  0, finding HY took 19.634 ms
rank =  0, distributing HY into block cyclic form took 12.279 ms
rank =  0, finding Y'*HY took 4.057 ms
Rank 0, Project_Hamiltonian used 99.275 ms
Total time for projection: 99.287 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.077 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.823202908657780
    last  calculated eigval = 0.033790984738522
The last 15 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 18):
lambda[   1] =  -0.82320290865778
lambda[   2] =  -0.65116348564931
lambda[   3] =  -0.51799021781152
lambda[   4] =  -0.46156721921567
lambda[   5] =  -0.40928462802866
lambda[   6] =  -0.35621205588001
lambda[   7] =  -0.31339848441573
lambda[   8] =  -0.29029190951255
lambda[   9] =  -0.17471424680421
lambda[  10] =  -0.02438088211671
lambda[  11] =  -0.00140639293351
lambda[  12] =   0.01324924217431
lambda[  13] =   0.01470907814099
lambda[  14] =   0.02779039340295
lambda[  15] =   0.03379098473852
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.544 ms
rank =  0, Distributing orbital back into band + domain format took 12.219 ms
rank = 0, Subspace_Rotation used 15.778 ms

Total time for subspace rotation: 15.783 ms
rank = 0, Efermi =  -0.053158076529 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.170 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.259 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.176 ms
rank = 0, Calculating density took 1270.632 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.723 ms
rank = 0, D2D took 1.000 ms
rank = 0, Transfering density took 1.002 ms
Etot    =   -25.385919688692
Eband   =    -7.995650312701
E1      =    18.892737152744
E2      =    -7.036205140133
E3      =   -10.349972819885
Exc     =    -9.129316921500
Esc     =   -44.539867566341
Entropy =    -0.000000000912
dE = 7.145e-08, dEband = 1.605e-04
rank = 0, Calculating/Estimating energy took 1.436 ms, Etot = -25.385919689, dEtot = 7.145e-08, dEband = 1.605e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0214332845568, which took 0.071 ms

iter_count = 96, r_2norm = 7.025e-07, tol*||rhs|| = 8.573e-07

Anderson update took 50.299 ms, out of which F'*F took 23.724 ms; b-Ax took 161.831 ms, out of which Lap took 144.113 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 352.757 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -18.00000003074810, int_rho =  18.00000003074812, int_b + int_rho = 1.819e-14, checking this took 0.099 ms
2-norm of RHS = 660.4998386968612, which took 0.088 ms

iter_count = 108, r_2norm = 5.868e-04, tol*||rhs|| = 6.605e-04

Anderson update took 57.297 ms, out of which F'*F took 27.206 ms; b-Ax took 183.993 ms, out of which Lap took 164.541 ms
Solving Poisson took 389.271 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.228529 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.127259 
Total time for convolution: 	 convolve: 5.136513 
Total time for convolution: 	 convolve: 5.174793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.071 ms
======D2D: initiated sending and receiving took 0.302 ms
---Transfer Veff_loc: D2D took 1.026 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.333 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.383 ms

This SCF took 26661.398 ms, scf error = 5.870e-05
The last 15 occupations of kpoints #1 are (Nelectron = 18):
lambda[   1] =  -0.82320290865778, occ[   1] =   2.00000000000000
lambda[   2] =  -0.65116348564931, occ[   2] =   2.00000000000000
lambda[   3] =  -0.51799021781152, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46156721921567, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40928462802866, occ[   5] =   2.00000000000000
lambda[   6] =  -0.35621205588001, occ[   6] =   2.00000000000000
lambda[   7] =  -0.31339848441573, occ[   7] =   2.00000000000000
lambda[   8] =  -0.29029190951255, occ[   8] =   2.00000000000000
lambda[   9] =  -0.17471424680421, occ[   9] =   2.00000000000000
lambda[  10] =  -0.02438088211671, occ[  10] =   0.00000003074818
lambda[  11] =  -0.00140639293351, occ[  11] =   0.00000000000000
lambda[  12] =   0.01324924217431, occ[  12] =   0.00000000000000
lambda[  13] =   0.01470907814099, occ[  13] =   0.00000000000000
lambda[  14] =   0.02779039340295, occ[  14] =   0.00000000000000
lambda[  15] =   0.03379098473852, occ[  15] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 14 (90%) = 0.000000000000000.
Occupation of state 15 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.492 ms, time for Allreduce/Reduce: 8.089 ms 
Time for calculating local force components: 17.095 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00429774954201   0.04966743358270  -0.00037949675945
 -0.04350827918423  -0.02646163434780   0.00098363900366
  0.00091918074998  -0.05137769018613   0.00081979907163
  0.00091627040444   0.06338606826954  -0.01267957913625
  0.04774009642244  -0.03119724233781  -0.03092657151478
 -0.01162312492748  -0.00266824267876  -0.01256540412214
 -0.15330171408644  -0.03647262643754  -0.02063245823254
  0.13939057775833  -0.02788020511828   0.49300063234630
force_loc = 
  0.00430647999538  -0.05044904808350   0.00042184458889
  0.04360615478391   0.02699439802284  -0.00081221867530
 -0.00067400668060   0.05258150513332  -0.00062021135412
 -0.00151461033268  -0.06339769926728   0.01163210731329
 -0.04803358733285   0.03152453441097   0.02905592757421
  0.01934494966304  -0.00192684187426   0.01159983697684
  0.14011807171832   0.03899134224257   0.01910575674863
 -0.13490998980697   0.02596467849525  -0.47645847113633
Time for calculating nonlocal force components: 27.126 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00401551943882   0.00252022003708   0.00029772117879
[0m[32m  0.00937335104710  -0.00044349959550   0.00079364380647
[0m[32m -0.00384904130079   0.00063953054096  -0.01257115419340
[0mTime for calculating XC forces components: 23.519 ms
 Cartesian force = 
  0.00001029171462  -0.00078098710185   0.00003417989389
  0.00009943686093   0.00053339107399   0.00016325239281
  0.00024673533062   0.00120444234614   0.00019141978196
 -0.00059677866700  -0.00001100359879  -0.00105563975851
 -0.00029192964917   0.00032791947212  -0.00187881187612
  0.00370786655798  -0.00207423711699  -0.00067601390207
 -0.00380873005978   0.00207584360848  -0.00074122561299
  0.00063310791181  -0.00127536868311   0.00396283908102
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 381.114 ms
The program took 654.246 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:32:37
Job ID:        2266784
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:13:00,vmem=8480K,walltime=00:11:05,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-13-1
---------------------------------------
