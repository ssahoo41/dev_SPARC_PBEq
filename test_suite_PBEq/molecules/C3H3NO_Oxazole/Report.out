---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:26
Job ID:    2266704
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:32
Job ID:    2266704
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.053 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 10.185 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 16.830 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 119.476 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.984 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.136 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    7.751148	   10.216924	   10.000000	
    9.528940	   13.713765	   10.000000	
   12.638434	    6.462731	   10.000000	
    7.361566	    6.286235	   10.000000	
    9.840447	   11.703203	   10.000000	
   11.264922	    7.962410	   10.000000	
    8.708144	    7.806234	   10.000000	
   11.976697	   10.509313	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.212 ms
Set up communicators.

--set up spincomm took 1.235 ms

--set up kptcomm took 0.344 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.071 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.452 ms

Calculate_SplineDerivRadFun took 0.304 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.260 ms.
time spent on vectorized spline interp: 3.230 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.985 ms.
time spent on vectorized spline interp: 1.451 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.347 ms.
time spent on vectorized spline interp: 1.723 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.424 ms.
time spent on vectorized spline interp: 1.884 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.521 ms.

Calculating rb for all atom types took 20.847 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.031 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000216068, sum_int_rho = 25.6850138200736
PosCharge = 26.000000021607, NegCharge = -25.685013820074, scal_fac = 1.012263423479
After scaling, int_rho = 26.0000000216067, PosCharge + NegCharge - NetCharge = 1.421e-13
--Calculate Vref took 0.577 ms
--Calculate rho_guess took 3.261 ms

 integral of b = -26.0000000216068,
 int{b} + Nelectron + NetCharge = -2.161e-08,
 Esc = -75.9968317902652,
 MPI_Reduce took 10.601 ms

Calculating b & b_ref took 21.925 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.087 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.010 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.656 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160681, int_b + int_rho = 3.274e-14, checking this took 0.087 ms
2-norm of RHS = 693.7135838267448, which took 0.472 ms

iter_count = 420, r_2norm = 6.650e-04, tol*||rhs|| = 6.937e-04

Anderson update took 271.342 ms, out of which F'*F took 123.609 ms; b-Ax took 892.152 ms, out of which Lap took 797.225 ms
Solving Poisson took 1967.046 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.828 ms
Total time for convolution: 	 convolve: 5.114702 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 48.328 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.142679 
Total time for convolution: 	 convolve: 5.109180 
Total time for convolution: 	 convolve: 5.107867 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
rank = 0, XC calculation took 24382.033 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
---Transfer Veff_loc: D2D took 2.946 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.166 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 7.228 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.132 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.861 ms
    Lanczos iter 53, eigmin  = -1.094051966, eigmax = 264.933224530, err_eigmin = 6.636e-04, err_eigmax = 9.620e-03
rank =   0, Lanczos took 134.274 ms, eigmin = -1.094051966264, eigmax = 267.582556775084

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.194252, lowerbound = -1.194052, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2068.313 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 23.393 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 5.048 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 28.493 ms
rank =  0, finding HY took 33.901 ms
rank =  0, distributing HY into block cyclic form took 21.828 ms
rank =  0, finding Y'*HY took 6.550 ms
Rank 0, Project_Hamiltonian used 90.826 ms
Total time for projection: 90.854 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.442 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.508 ms
    first calculated eigval = 2.692269784242909
    last  calculated eigval = 3.228921362519076
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81266457839816
lambda[   5] =   2.85378544559189
lambda[   6] =   2.89510407302864
lambda[   7] =   2.92348745394271
lambda[   8] =   2.93437225958552
lambda[   9] =   2.93854148319058
lambda[  10] =   2.98422905927621
lambda[  11] =   2.99604851508098
lambda[  12] =   3.02263835642514
lambda[  13] =   3.06390597393124
lambda[  14] =   3.08673149153955
lambda[  15] =   3.10418009715519
lambda[  16] =   3.12889252612422
lambda[  17] =   3.13960590418138
lambda[  18] =   3.14877533023697
lambda[  19] =   3.18184419662446
lambda[  20] =   3.22892136251908
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.522 ms
rank =  0, subspace rotation using ScaLAPACK took 4.923 ms
rank =  0, Distributing orbital back into band + domain format took 18.293 ms
rank = 0, Subspace_Rotation used 23.238 ms

Total time for subspace rotation: 23.244 ms
rank = 0, Efermi =   3.075318732502 calculate fermi energy took 0.054 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.328921, lowerbound = -1.194052, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2050.778 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.000 ms
rank =  0, Distribute orbital to block cyclic format took 20.581 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.404 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 25.031 ms
rank =  0, finding HY took 33.471 ms
rank =  0, distributing HY into block cyclic form took 20.647 ms
rank =  0, finding Y'*HY took 6.060 ms
Rank 0, Project_Hamiltonian used 85.254 ms
Total time for projection: 85.261 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.569 ms
    first calculated eigval = -0.877534797650525
    last  calculated eigval = 0.450068784047629
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.41661606458655
lambda[   5] =  -0.27531527559307
lambda[   6] =  -0.22028213328801
lambda[   7] =  -0.08931452774776
lambda[   8] =  -0.03127931604229
lambda[   9] =   0.00046492362694
lambda[  10] =   0.17226667898828
lambda[  11] =   0.23037405501314
lambda[  12] =   0.23840186145740
lambda[  13] =   0.27101681412580
lambda[  14] =   0.29866876932062
lambda[  15] =   0.32272916340188
lambda[  16] =   0.34854337475926
lambda[  17] =   0.37147616324334
lambda[  18] =   0.39221277548858
lambda[  19] =   0.41097630686027
lambda[  20] =   0.45006878404763
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.581 ms
rank =  0, subspace rotation using ScaLAPACK took 6.165 ms
rank =  0, Distributing orbital back into band + domain format took 19.258 ms
rank = 0, Subspace_Rotation used 25.460 ms

Total time for subspace rotation: 25.466 ms
rank = 0, Efermi =   0.284842794145 calculate fermi energy took 0.069 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.550069, lowerbound = -1.194052, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2105.528 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 20.953 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.375 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 25.369 ms
rank =  0, finding HY took 33.489 ms
rank =  0, distributing HY into block cyclic form took 20.551 ms
rank =  0, finding Y'*HY took 6.096 ms
Rank 0, Project_Hamiltonian used 85.563 ms
Total time for projection: 85.595 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.104 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.171 ms
    first calculated eigval = -1.102555239370740
    last  calculated eigval = 0.152447329220564
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65598869953579
lambda[   5] =  -0.64670403901390
lambda[   6] =  -0.57908686999522
lambda[   7] =  -0.49382448691987
lambda[   8] =  -0.47710292683594
lambda[   9] =  -0.47356172822548
lambda[  10] =  -0.41271679486362
lambda[  11] =  -0.34288522466422
lambda[  12] =  -0.32476530652561
lambda[  13] =  -0.26873336530556
lambda[  14] =  -0.05781909609604
lambda[  15] =   0.01716054302746
lambda[  16] =   0.06050617798360
lambda[  17] =   0.08599928412096
lambda[  18] =   0.10524218485724
lambda[  19] =   0.13069960567719
lambda[  20] =   0.15244732922056
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 4.881 ms
rank =  0, Distributing orbital back into band + domain format took 18.192 ms
rank = 0, Subspace_Rotation used 23.090 ms

Total time for subspace rotation: 23.095 ms
rank = 0, Efermi =  -0.086915893705 calculate fermi energy took 0.040 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.252447, lowerbound = -1.194052, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2100.358 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.931 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.374 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 25.344 ms
rank =  0, finding HY took 33.471 ms
rank =  0, distributing HY into block cyclic form took 20.515 ms
rank =  0, finding Y'*HY took 6.105 ms
Rank 0, Project_Hamiltonian used 86.022 ms
Total time for projection: 86.050 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -1.102964132025042
    last  calculated eigval = 0.078972313955245
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.65806917317873
lambda[   5] =  -0.64784469073640
lambda[   6] =  -0.58578005765793
lambda[   7] =  -0.50390558039979
lambda[   8] =  -0.48389388761914
lambda[   9] =  -0.48183576856706
lambda[  10] =  -0.43627246231135
lambda[  11] =  -0.36605898580604
lambda[  12] =  -0.36559435456582
lambda[  13] =  -0.30694881156303
lambda[  14] =  -0.10339008373026
lambda[  15] =  -0.06179112822499
lambda[  16] =   0.00529862438253
lambda[  17] =   0.03486695075013
lambda[  18] =   0.05123597841663
lambda[  19] =   0.06083944710931
lambda[  20] =   0.07897231395524
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.271 ms
rank =  0, Distributing orbital back into band + domain format took 19.017 ms
rank = 0, Subspace_Rotation used 23.308 ms

Total time for subspace rotation: 23.312 ms
rank = 0, Efermi =  -0.132486881395 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.763 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.930 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.490 ms
rank = 0, Calculating density took 8916.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.129 ms
rank = 0, D2D took 5.213 ms
rank = 0, Transfering density took 5.224 ms
Etot    =   -46.829508316948
Eband   =   -15.385453815059
E1      =    30.255595024530
E2      =   -12.747872488381
E3      =   -15.728427229122
Exc     =   -14.179117453009
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 5.854e+00, dEband = 1.923e+00
rank = 0, Calculating/Estimating energy took 1.633 ms, Etot = -46.829508317, dEtot = 5.854e+00, dEband = 1.923e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 54.1961045349445, which took 0.138 ms

iter_count = 96, r_2norm = 1.643e-03, tol*||rhs|| = 2.168e-03

Anderson update took 57.356 ms, out of which F'*F took 26.716 ms; b-Ax took 183.250 ms, out of which Lap took 162.534 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.724 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160667, int_b + int_rho = -1.091e-13, checking this took 0.160 ms
2-norm of RHS = 689.9375992451979, which took 0.199 ms

iter_count = 288, r_2norm = 5.874e-04, tol*||rhs|| = 6.899e-04

Anderson update took 174.251 ms, out of which F'*F took 82.090 ms; b-Ax took 559.224 ms, out of which Lap took 493.983 ms
Solving Poisson took 1236.444 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.833 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.091011 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.549 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.213329 
Total time for convolution: 	 convolve: 5.090626 
Total time for convolution: 	 convolve: 5.080104 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.400 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
---Transfer Veff_loc: D2D took 1.258 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.511 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.789 ms

This SCF took 35021.494 ms, scf error = 1.548e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.178972, lowerbound = -1.102964, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2102.398 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.669 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.166 ms
rank =  0, finding HY took 33.883 ms
rank =  0, distributing HY into block cyclic form took 20.592 ms
rank =  0, finding Y'*HY took 6.721 ms
Rank 0, Project_Hamiltonian used 86.416 ms
Total time for projection: 86.434 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -1.094193223712234
    last  calculated eigval = 0.047154986743095
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.63770212865600
lambda[   5] =  -0.61824913353967
lambda[   6] =  -0.56048967608148
lambda[   7] =  -0.47998231634291
lambda[   8] =  -0.47041781825257
lambda[   9] =  -0.45721823255656
lambda[  10] =  -0.41767895739718
lambda[  11] =  -0.34395249367732
lambda[  12] =  -0.32695120483121
lambda[  13] =  -0.28501739714218
lambda[  14] =  -0.09259823240506
lambda[  15] =  -0.05008296468564
lambda[  16] =  -0.01881496876967
lambda[  17] =   0.02716924751128
lambda[  18] =   0.02852321000134
lambda[  19] =   0.03479446213288
lambda[  20] =   0.04715498674310
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 4.035 ms
rank =  0, Distributing orbital back into band + domain format took 24.463 ms
rank = 0, Subspace_Rotation used 28.513 ms

Total time for subspace rotation: 28.518 ms
rank = 0, Efermi =  -0.121695030092 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.229 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.977 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.391 ms
rank = 0, Calculating density took 2227.274 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.020 ms
rank = 0, D2D took 1.251 ms
rank = 0, Transfering density took 1.262 ms
Etot    =   -46.774790959512
Eband   =   -14.764035968494
E1      =    29.707456615124
E2      =   -12.698209195408
E3      =   -15.891700614958
Exc     =   -14.311289625595
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 6.840e-03, dEband = 7.768e-02
rank = 0, Calculating/Estimating energy took 1.363 ms, Etot = -46.774790960, dEtot = 6.840e-03, dEband = 7.768e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 22.5909629496683, which took 0.083 ms

iter_count = 102, r_2norm = 5.903e-04, tol*||rhs|| = 9.036e-04

Anderson update took 63.006 ms, out of which F'*F took 28.663 ms; b-Ax took 189.596 ms, out of which Lap took 169.839 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.186 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160661, int_b + int_rho = -1.746e-13, checking this took 0.185 ms
2-norm of RHS = 685.2489698399754, which took 0.208 ms

iter_count = 300, r_2norm = 5.892e-04, tol*||rhs|| = 6.852e-04

Anderson update took 188.359 ms, out of which F'*F took 84.355 ms; b-Ax took 565.624 ms, out of which Lap took 503.478 ms
Solving Poisson took 1286.371 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
Total time for convolution: 	 convolve: 5.077410 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.735 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.082600 
Total time for convolution: 	 convolve: 5.084946 
Total time for convolution: 	 convolve: 5.080261 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.409 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 1.288 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.718 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.378 ms

This SCF took 28284.978 ms, scf error = 1.042e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147155, lowerbound = -1.094193, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2094.059 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.055 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.700 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.008 ms
rank =  0, Distribute data + matrix mult took 25.786 ms
rank =  0, finding HY took 34.490 ms
rank =  0, distributing HY into block cyclic form took 21.730 ms
rank =  0, finding Y'*HY took 6.205 ms
Rank 0, Project_Hamiltonian used 88.265 ms
Total time for projection: 88.292 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.071549755161587
    last  calculated eigval = 0.037932836887138
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.59788779852799
lambda[   5] =  -0.57013859524266
lambda[   6] =  -0.51722821690952
lambda[   7] =  -0.44628896866805
lambda[   8] =  -0.44048855499219
lambda[   9] =  -0.40861896746741
lambda[  10] =  -0.37845934595763
lambda[  11] =  -0.30939624474883
lambda[  12] =  -0.27288361721064
lambda[  13] =  -0.24798149378176
lambda[  14] =  -0.06316573160549
lambda[  15] =  -0.02654395054987
lambda[  16] =  -0.01350044725995
lambda[  17] =   0.01738576937820
lambda[  18] =   0.02362541706061
lambda[  19] =   0.02609040450605
lambda[  20] =   0.03793283688714
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.173 ms
rank =  0, subspace rotation using ScaLAPACK took 8.377 ms
rank =  0, Distributing orbital back into band + domain format took 20.306 ms
rank = 0, Subspace_Rotation used 28.707 ms

Total time for subspace rotation: 28.712 ms
rank = 0, Efermi =  -0.092262529273 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 5.285 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.164 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.356 ms
rank = 0, Calculating density took 2221.189 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.098 ms
rank = 0, D2D took 1.260 ms
rank = 0, Transfering density took 1.267 ms
Etot    =   -46.731796374052
Eband   =   -13.708483698396
E1      =    28.819277610659
E2      =   -12.514761438424
E3      =   -16.194902561496
Exc     =   -14.555422495321
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 5.374e-03, dEband = 1.319e-01
rank = 0, Calculating/Estimating energy took 1.049 ms, Etot = -46.731796374, dEtot = 5.374e-03, dEband = 1.319e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.6828923660740, which took 0.066 ms

iter_count = 102, r_2norm = 2.254e-04, tol*||rhs|| = 2.273e-04

Anderson update took 63.325 ms, out of which F'*F took 28.648 ms; b-Ax took 189.543 ms, out of which Lap took 169.372 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.440 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160657, int_b + int_rho = -2.074e-13, checking this took 0.191 ms
2-norm of RHS = 685.2290679295422, which took 0.067 ms

iter_count = 276, r_2norm = 6.250e-04, tol*||rhs|| = 6.852e-04

Anderson update took 171.059 ms, out of which F'*F took 79.006 ms; b-Ax took 530.425 ms, out of which Lap took 471.606 ms
Solving Poisson took 1187.634 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.076041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.873 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.080447 
Total time for convolution: 	 convolve: 5.075828 
Total time for convolution: 	 convolve: 5.077827 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.401 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.219 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.678 ms
---Transfer Veff_loc: D2D took 1.731 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.476 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.831 ms

This SCF took 28247.619 ms, scf error = 3.515e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.137933, lowerbound = -1.071550, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2046.458 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.639 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.424 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.090 ms
rank =  0, finding HY took 33.582 ms
rank =  0, distributing HY into block cyclic form took 20.528 ms
rank =  0, finding Y'*HY took 5.894 ms
Rank 0, Project_Hamiltonian used 85.123 ms
Total time for projection: 85.139 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.057444411289242
    last  calculated eigval = 0.033523949139789
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.58280581938061
lambda[   5] =  -0.55442699873557
lambda[   6] =  -0.50192030680110
lambda[   7] =  -0.43461698528159
lambda[   8] =  -0.42398666983161
lambda[   9] =  -0.39353288077785
lambda[  10] =  -0.36242881956783
lambda[  11] =  -0.30034768739613
lambda[  12] =  -0.26254142891006
lambda[  13] =  -0.23577084136959
lambda[  14] =  -0.05159841195532
lambda[  15] =  -0.02814545142736
lambda[  16] =  -0.00532123228196
lambda[  17] =   0.01446851351171
lambda[  18] =   0.01552298981949
lambda[  19] =   0.02233241531679
lambda[  20] =   0.03352394913979
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 8.403 ms
rank =  0, Distributing orbital back into band + domain format took 20.170 ms
rank = 0, Subspace_Rotation used 28.588 ms

Total time for subspace rotation: 28.593 ms
rank = 0, Efermi =  -0.080695209691 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.335 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.304 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.392 ms
rank = 0, Calculating density took 2170.527 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.192 ms
rank = 0, D2D took 1.369 ms
rank = 0, Transfering density took 1.377 ms
Etot    =   -46.726924214679
Eband   =   -13.350641929239
E1      =    28.571186950899
E2      =   -12.387091555817
E3      =   -16.297057895431
Exc     =   -14.634786896673
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 6.090e-04, dEband = 4.473e-02
rank = 0, Calculating/Estimating energy took 1.233 ms, Etot = -46.726924215, dEtot = 6.090e-04, dEband = 4.473e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7120664425274, which took 0.107 ms

iter_count = 108, r_2norm = 7.117e-05, tol*||rhs|| = 1.085e-04

Anderson update took 65.457 ms, out of which F'*F took 29.686 ms; b-Ax took 201.600 ms, out of which Lap took 177.475 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160676, int_b + int_rho = -1.819e-14, checking this took 0.163 ms
2-norm of RHS = 686.2833022764479, which took 0.147 ms

iter_count = 264, r_2norm = 6.120e-04, tol*||rhs|| = 6.863e-04

Anderson update took 159.347 ms, out of which F'*F took 75.510 ms; b-Ax took 515.580 ms, out of which Lap took 455.555 ms
Solving Poisson took 1138.186 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.077633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.632 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.078220 
Total time for convolution: 	 convolve: 5.073537 
Total time for convolution: 	 convolve: 5.073921 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.162 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.267 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.272 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.569 ms

This SCF took 28193.512 ms, scf error = 1.317e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.133524, lowerbound = -1.057444, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2051.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 23.754 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.463 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 7.163 ms
rank =  0, Distribute data + matrix mult took 35.393 ms
rank =  0, finding HY took 30.833 ms
rank =  0, distributing HY into block cyclic form took 32.820 ms
rank =  0, finding Y'*HY took 6.166 ms
Rank 0, Project_Hamiltonian used 105.243 ms
Total time for projection: 105.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.174 ms
    first calculated eigval = -1.051933445857016
    last  calculated eigval = 0.030776419618552
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57701174298810
lambda[   5] =  -0.54802668659298
lambda[   6] =  -0.49576635401673
lambda[   7] =  -0.42982231430380
lambda[   8] =  -0.41731313375610
lambda[   9] =  -0.38678557790382
lambda[  10] =  -0.35737254879459
lambda[  11] =  -0.29534397600090
lambda[  12] =  -0.25583810005594
lambda[  13] =  -0.23121967270163
lambda[  14] =  -0.04710616324419
lambda[  15] =  -0.02852791390401
lambda[  16] =  -0.00148695347477
lambda[  17] =   0.01136904518430
lambda[  18] =   0.01395098305850
lambda[  19] =   0.02110595577343
lambda[  20] =   0.03077641961855
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.187 ms
rank =  0, subspace rotation using ScaLAPACK took 8.352 ms
rank =  0, Distributing orbital back into band + domain format took 20.190 ms
rank = 0, Subspace_Rotation used 28.555 ms

Total time for subspace rotation: 28.560 ms
rank = 0, Efermi =  -0.076202960941 calculate fermi energy took 2.455 ms
rank = 0, --- Calculate rho: sum over local bands took 5.562 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.542 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.283 ms
rank = 0, Calculating density took 2196.488 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.043 ms
rank = 0, D2D took 1.218 ms
rank = 0, Transfering density took 1.225 ms
Etot    =   -46.725718887796
Eband   =   -13.199884584094
E1      =    28.508671354895
E2      =   -12.289593137848
E3      =   -16.330981939424
Exc     =   -14.658248944956
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 1.507e-04, dEband = 1.884e-02
rank = 0, Calculating/Estimating energy took 1.597 ms, Etot = -46.725718888, dEtot = 1.507e-04, dEband = 1.884e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7751360958221, which took 0.073 ms

iter_count = 114, r_2norm = 2.179e-05, tol*||rhs|| = 3.101e-05

Anderson update took 70.557 ms, out of which F'*F took 32.264 ms; b-Ax took 217.183 ms, out of which Lap took 193.809 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 491.896 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160658, int_b + int_rho = -2.001e-13, checking this took 0.156 ms
2-norm of RHS = 686.6287827203826, which took 0.200 ms

iter_count = 234, r_2norm = 6.246e-04, tol*||rhs|| = 6.866e-04

Anderson update took 147.660 ms, out of which F'*F took 70.364 ms; b-Ax took 461.812 ms, out of which Lap took 413.353 ms
Solving Poisson took 1009.301 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Total time for convolution: 	 convolve: 5.074395 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.516 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.079263 
Total time for convolution: 	 convolve: 5.073497 
Total time for convolution: 	 convolve: 5.071707 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.626 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.101 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.697 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.001 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.915 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.652 ms

This SCF took 28005.239 ms, scf error = 4.655e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.130776, lowerbound = -1.051933, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2027.658 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.012 ms
rank =  0, Distribute orbital to block cyclic format took 20.430 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.517 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.975 ms
rank =  0, finding HY took 33.064 ms
rank =  0, distributing HY into block cyclic form took 20.436 ms
rank =  0, finding Y'*HY took 6.207 ms
Rank 0, Project_Hamiltonian used 84.716 ms
Total time for projection: 84.732 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -1.050400885533655
    last  calculated eigval = 0.029499128324922
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57540778091950
lambda[   5] =  -0.54645681943258
lambda[   6] =  -0.49413732854562
lambda[   7] =  -0.42834802167973
lambda[   8] =  -0.41593846997903
lambda[   9] =  -0.38499824249416
lambda[  10] =  -0.35607129149304
lambda[  11] =  -0.29334951543582
lambda[  12] =  -0.25333060785641
lambda[  13] =  -0.22986282113056
lambda[  14] =  -0.04589215384256
lambda[  15] =  -0.02854760373150
lambda[  16] =  -0.00015601621863
lambda[  17] =   0.00991835390763
lambda[  18] =   0.01368438133454
lambda[  19] =   0.02039124935842
lambda[  20] =   0.02949912832492
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.211 ms
rank =  0, subspace rotation using ScaLAPACK took 8.336 ms
rank =  0, Distributing orbital back into band + domain format took 20.107 ms
rank = 0, Subspace_Rotation used 28.454 ms

Total time for subspace rotation: 28.460 ms
rank = 0, Efermi =  -0.074988951455 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.275 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.107 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.481 ms
rank = 0, Calculating density took 2151.050 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.490 ms
rank = 0, D2D took 1.593 ms
rank = 0, Transfering density took 1.598 ms
Etot    =   -46.725486547900
Eband   =   -13.156407941987
E1      =    28.496253453703
E2      =   -12.256631647035
E3      =   -16.335571901483
Exc     =   -14.660703817222
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 2.904e-05, dEband = 5.435e-03
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -46.725486548, dEtot = 2.904e-05, dEband = 5.435e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3997694287399, which took 0.060 ms

iter_count = 114, r_2norm = 1.118e-05, tol*||rhs|| = 1.599e-05

Anderson update took 66.682 ms, out of which F'*F took 31.358 ms; b-Ax took 215.479 ms, out of which Lap took 189.909 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.122 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160668, int_b + int_rho = -9.823e-14, checking this took 0.180 ms
2-norm of RHS = 686.8454635450523, which took 0.155 ms

iter_count = 240, r_2norm = 6.706e-04, tol*||rhs|| = 6.868e-04

Anderson update took 142.769 ms, out of which F'*F took 66.578 ms; b-Ax took 450.636 ms, out of which Lap took 399.277 ms
Solving Poisson took 1016.364 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.311 ms
Total time for convolution: 	 convolve: 5.075420 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.074547 
Total time for convolution: 	 convolve: 5.080461 
Total time for convolution: 	 convolve: 5.081231 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.717 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.618 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.370 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 1.390 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 1.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.905 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.619 ms

This SCF took 27999.091 ms, scf error = 2.972e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.129499, lowerbound = -1.050401, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2104.799 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.470 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.074 ms
rank =  0, finding HY took 33.002 ms
rank =  0, distributing HY into block cyclic form took 20.418 ms
rank =  0, finding Y'*HY took 6.134 ms
Rank 0, Project_Hamiltonian used 84.658 ms
Total time for projection: 84.675 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -1.046952123240224
    last  calculated eigval = 0.029900192536432
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57188914837727
lambda[   5] =  -0.54323414880006
lambda[   6] =  -0.49073860846285
lambda[   7] =  -0.42511880969931
lambda[   8] =  -0.41307840792854
lambda[   9] =  -0.38168474528876
lambda[  10] =  -0.35268742084642
lambda[  11] =  -0.28975364939637
lambda[  12] =  -0.24928578144599
lambda[  13] =  -0.22668230300661
lambda[  14] =  -0.04306678454692
lambda[  15] =  -0.02786014837120
lambda[  16] =   0.00277043465558
lambda[  17] =   0.01004672902984
lambda[  18] =   0.01454499911714
lambda[  19] =   0.02091222880648
lambda[  20] =   0.02990019253643
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 8.348 ms
rank =  0, Distributing orbital back into band + domain format took 20.086 ms
rank = 0, Subspace_Rotation used 28.862 ms

Total time for subspace rotation: 28.869 ms
rank = 0, Efermi =  -0.072163582264 calculate fermi energy took 0.611 ms
rank = 0, --- Calculate rho: sum over local bands took 5.656 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.611 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.327 ms
rank = 0, Calculating density took 2227.818 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.973 ms
rank = 0, D2D took 1.182 ms
rank = 0, Transfering density took 1.188 ms
Etot    =   -46.725279355607
Eband   =   -13.067594766426
E1      =    28.454250993130
E2      =   -12.206684356241
E3      =   -16.346231113131
Exc     =   -14.668019260769
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 2.590e-05, dEband = 1.110e-02
rank = 0, Calculating/Estimating energy took 1.669 ms, Etot = -46.725279356, dEtot = 2.590e-05, dEband = 1.110e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2400446296921, which took 0.118 ms

iter_count = 114, r_2norm = 6.619e-06, tol*||rhs|| = 9.602e-06

Anderson update took 67.961 ms, out of which F'*F took 31.508 ms; b-Ax took 217.482 ms, out of which Lap took 190.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.847 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160667, int_b + int_rho = -1.128e-13, checking this took 0.167 ms
2-norm of RHS = 686.8863597883881, which took 0.123 ms

iter_count = 234, r_2norm = 5.826e-04, tol*||rhs|| = 6.869e-04

Anderson update took 140.008 ms, out of which F'*F took 65.816 ms; b-Ax took 443.468 ms, out of which Lap took 393.817 ms
Solving Poisson took 995.427 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.190055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1219.237 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.076292 
Total time for convolution: 	 convolve: 5.077981 
Total time for convolution: 	 convolve: 5.076152 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.354 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.053 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.217 ms
---Transfer Veff_loc: D2D took 1.647 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.894 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.578 ms

This SCF took 29651.945 ms, scf error = 1.670e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129900, lowerbound = -1.046952, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2037.377 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.645 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.521 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.203 ms
rank =  0, finding HY took 33.089 ms
rank =  0, distributing HY into block cyclic form took 20.649 ms
rank =  0, finding Y'*HY took 6.734 ms
Rank 0, Project_Hamiltonian used 85.727 ms
Total time for projection: 85.747 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.172 ms
    first calculated eigval = -1.044226493693972
    last  calculated eigval = 0.031395241201054
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56911573735395
lambda[   5] =  -0.54053690994099
lambda[   6] =  -0.48806993844271
lambda[   7] =  -0.42247847238626
lambda[   8] =  -0.41062544647813
lambda[   9] =  -0.37907362002886
lambda[  10] =  -0.35003926625706
lambda[  11] =  -0.28700914970658
lambda[  12] =  -0.24613954969540
lambda[  13] =  -0.22396432703420
lambda[  14] =  -0.04048682934832
lambda[  15] =  -0.02629974725320
lambda[  16] =   0.00527454642431
lambda[  17] =   0.01147057653334
lambda[  18] =   0.01660514255085
lambda[  19] =   0.02259367276788
lambda[  20] =   0.03139524120105
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 9.178 ms
rank =  0, Distributing orbital back into band + domain format took 19.844 ms
rank = 0, Subspace_Rotation used 29.053 ms

Total time for subspace rotation: 29.062 ms
rank = 0, Efermi =  -0.069583626922 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.716 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.943 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.224 ms
rank = 0, Calculating density took 2163.266 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.755 ms
rank = 0, D2D took 0.857 ms
rank = 0, Transfering density took 0.863 ms
Etot    =   -46.725282430500
Eband   =   -12.996383082027
E1      =    28.417990699282
E2      =   -12.169810233311
E3      =   -16.353364868396
Exc     =   -14.673233358548
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 3.844e-07, dEband = 8.901e-03
rank = 0, Calculating/Estimating energy took 1.035 ms, Etot = -46.725282430, dEtot = 3.844e-07, dEband = 8.901e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2144983318722, which took 0.054 ms

iter_count = 108, r_2norm = 7.495e-06, tol*||rhs|| = 8.580e-06

Anderson update took 63.595 ms, out of which F'*F took 29.726 ms; b-Ax took 205.466 ms, out of which Lap took 180.238 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.868 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160677, int_b + int_rho = -1.455e-14, checking this took 0.197 ms
2-norm of RHS = 686.8834974609550, which took 0.143 ms

iter_count = 216, r_2norm = 6.187e-04, tol*||rhs|| = 6.869e-04

Anderson update took 129.080 ms, out of which F'*F took 59.436 ms; b-Ax took 409.010 ms, out of which Lap took 361.667 ms
Solving Poisson took 916.225 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.083472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.175 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.098745 
Total time for convolution: 	 convolve: 5.090424 
Total time for convolution: 	 convolve: 5.087043 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.622 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 1.628 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.575 ms

This SCF took 27919.950 ms, scf error = 9.899e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131395, lowerbound = -1.044226, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1921.211 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 20.857 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 25.224 ms
rank =  0, finding HY took 33.175 ms
rank =  0, distributing HY into block cyclic form took 20.549 ms
rank =  0, finding Y'*HY took 5.907 ms
Rank 0, Project_Hamiltonian used 84.906 ms
Total time for projection: 84.923 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.042799901043984
    last  calculated eigval = 0.032403848788855
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56776235485015
lambda[   5] =  -0.53921665137471
lambda[   6] =  -0.48671223089526
lambda[   7] =  -0.42108651443542
lambda[   8] =  -0.40935754416595
lambda[   9] =  -0.37768665407531
lambda[  10] =  -0.34872747094030
lambda[  11] =  -0.28551005740655
lambda[  12] =  -0.24455508283197
lambda[  13] =  -0.22268784681007
lambda[  14] =  -0.03904145479690
lambda[  15] =  -0.02409435297331
lambda[  16] =   0.00677043302242
lambda[  17] =   0.01383003217220
lambda[  18] =   0.01931051328477
lambda[  19] =   0.02479755086638
lambda[  20] =   0.03240384878886
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 9.173 ms
rank =  0, Distributing orbital back into band + domain format took 20.047 ms
rank = 0, Subspace_Rotation used 29.249 ms

Total time for subspace rotation: 29.257 ms
rank = 0, Efermi =  -0.068138252517 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.512 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.030 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.172 ms
rank = 0, Calculating density took 2046.341 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.745 ms
rank = 0, D2D took 0.844 ms
rank = 0, Transfering density took 0.849 ms
Etot    =   -46.725338025850
Eband   =   -12.960397973532
E1      =    28.400945373136
E2      =   -12.150297654567
E3      =   -16.355528529596
Exc     =   -14.674879818705
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 6.949e-06, dEband = 4.498e-03
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -46.725338026, dEtot = 6.949e-06, dEband = 4.498e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1202030492664, which took 0.073 ms

iter_count = 108, r_2norm = 4.729e-06, tol*||rhs|| = 4.808e-06

Anderson update took 64.065 ms, out of which F'*F took 29.872 ms; b-Ax took 207.268 ms, out of which Lap took 181.441 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.770 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160665, int_b + int_rho = -1.273e-13, checking this took 6.522 ms
2-norm of RHS = 686.8568180212546, which took 0.071 ms

iter_count = 204, r_2norm = 5.427e-04, tol*||rhs|| = 6.869e-04

Anderson update took 122.384 ms, out of which F'*F took 57.717 ms; b-Ax took 387.348 ms, out of which Lap took 343.601 ms
Solving Poisson took 870.465 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.084392 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.083938 
Total time for convolution: 	 convolve: 5.082412 
Total time for convolution: 	 convolve: 5.083678 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 1.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.914 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.637 ms

This SCF took 27734.591 ms, scf error = 6.184e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132404, lowerbound = -1.042800, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2041.820 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.442 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.016 ms
rank =  0, Distribute data + matrix mult took 25.203 ms
rank =  0, finding HY took 33.051 ms
rank =  0, distributing HY into block cyclic form took 20.553 ms
rank =  0, finding Y'*HY took 5.947 ms
Rank 0, Project_Hamiltonian used 85.586 ms
Total time for projection: 85.608 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.594 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.705 ms
    first calculated eigval = -1.041835580790180
    last  calculated eigval = 0.033446347876849
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56679890504699
lambda[   5] =  -0.53829038038496
lambda[   6] =  -0.48577197722630
lambda[   7] =  -0.42013876592234
lambda[   8] =  -0.40847939073316
lambda[   9] =  -0.37676990030671
lambda[  10] =  -0.34777418283993
lambda[  11] =  -0.28456435502827
lambda[  12] =  -0.24361233058670
lambda[  13] =  -0.22171787387421
lambda[  14] =  -0.03798569566617
lambda[  15] =  -0.02174542684663
lambda[  16] =   0.00785888710722
lambda[  17] =   0.01642777244199
lambda[  18] =   0.02221797619751
lambda[  19] =   0.02710460655035
lambda[  20] =   0.03344634787685
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.719 ms
rank =  0, subspace rotation using ScaLAPACK took 8.337 ms
rank =  0, Distributing orbital back into band + domain format took 21.353 ms
rank = 0, Subspace_Rotation used 29.717 ms

Total time for subspace rotation: 29.724 ms
rank = 0, Efermi =  -0.067082493355 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.788 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.747 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.445 ms
rank = 0, Calculating density took 2168.000 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.823 ms
rank = 0, D2D took 0.930 ms
rank = 0, Transfering density took 0.937 ms
Etot    =   -46.725363396277
Eband   =   -12.935822481984
E1      =    28.387875879046
E2      =   -12.138461603077
E3      =   -16.357281394993
Exc     =   -14.676328000497
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 3.171e-06, dEband = 3.072e-03
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -46.725363396, dEtot = 3.171e-06, dEband = 3.072e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0688139114530, which took 0.063 ms

iter_count = 114, r_2norm = 1.950e-06, tol*||rhs|| = 2.753e-06

Anderson update took 67.225 ms, out of which F'*F took 31.286 ms; b-Ax took 216.782 ms, out of which Lap took 190.072 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.135 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160661, int_b + int_rho = -1.746e-13, checking this took 0.190 ms
2-norm of RHS = 686.8637741975529, which took 0.159 ms

iter_count = 186, r_2norm = 6.851e-04, tol*||rhs|| = 6.869e-04

Anderson update took 111.421 ms, out of which F'*F took 51.252 ms; b-Ax took 351.584 ms, out of which Lap took 310.881 ms
Solving Poisson took 788.919 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.077139 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.905 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.083163 
Total time for convolution: 	 convolve: 5.087991 
Total time for convolution: 	 convolve: 5.081380 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.853 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 1.655 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.898 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.584 ms

This SCF took 28069.992 ms, scf error = 4.281e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133446, lowerbound = -1.041836, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2045.112 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.936 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.742 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 24.721 ms
rank =  0, finding HY took 33.174 ms
rank =  0, distributing HY into block cyclic form took 20.614 ms
rank =  0, finding Y'*HY took 5.924 ms
Rank 0, Project_Hamiltonian used 85.528 ms
Total time for projection: 85.575 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.158 ms
    first calculated eigval = -1.041135228391513
    last  calculated eigval = 0.034152133928199
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56609529004282
lambda[   5] =  -0.53760217715829
lambda[   6] =  -0.48507551851656
lambda[   7] =  -0.41944687836090
lambda[   8] =  -0.40781044667255
lambda[   9] =  -0.37607489954509
lambda[  10] =  -0.34710080147747
lambda[  11] =  -0.28386159096552
lambda[  12] =  -0.24294517140841
lambda[  13] =  -0.22100890568447
lambda[  14] =  -0.03724683082830
lambda[  15] =  -0.01949984991364
lambda[  16] =   0.00860472384011
lambda[  17] =   0.01904823797163
lambda[  18] =   0.02485165591536
lambda[  19] =   0.02893240268962
lambda[  20] =   0.03415213392820
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 8.351 ms
rank =  0, Distributing orbital back into band + domain format took 20.611 ms
rank = 0, Subspace_Rotation used 28.984 ms

Total time for subspace rotation: 28.990 ms
rank = 0, Efermi =  -0.066343628577 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.282 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.379 ms
rank = 0, Calculating density took 2169.112 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.024 ms
rank = 0, D2D took 1.216 ms
rank = 0, Transfering density took 1.225 ms
Etot    =   -46.725434116034
Eband   =   -12.917785085526
E1      =    28.378993235764
E2      =   -12.129039569465
E3      =   -16.358374155104
Exc     =   -14.677224199928
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 8.840e-06, dEband = 2.255e-03
rank = 0, Calculating/Estimating energy took 1.494 ms, Etot = -46.725434116, dEtot = 8.840e-06, dEband = 2.255e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0500555686558, which took 0.062 ms

iter_count = 114, r_2norm = 1.223e-06, tol*||rhs|| = 2.002e-06

Anderson update took 67.566 ms, out of which F'*F took 31.614 ms; b-Ax took 217.842 ms, out of which Lap took 191.317 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.625 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160666, int_b + int_rho = -1.164e-13, checking this took 0.139 ms
2-norm of RHS = 686.8788427708848, which took 0.119 ms

iter_count = 180, r_2norm = 5.664e-04, tol*||rhs|| = 6.869e-04

Anderson update took 107.575 ms, out of which F'*F took 50.374 ms; b-Ax took 342.877 ms, out of which Lap took 304.126 ms
Solving Poisson took 767.281 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.080045 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.504 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.364 ms
Total time for convolution: 	 convolve: 5.082338 
Total time for convolution: 	 convolve: 5.083272 
Total time for convolution: 	 convolve: 5.078977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.934 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.639 ms

This SCF took 27785.739 ms, scf error = 2.965e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134152, lowerbound = -1.041135, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2007.141 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 20.653 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.478 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.167 ms
rank =  0, finding HY took 32.984 ms
rank =  0, distributing HY into block cyclic form took 20.472 ms
rank =  0, finding Y'*HY took 5.950 ms
Rank 0, Project_Hamiltonian used 84.620 ms
Total time for projection: 84.639 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.168 ms
    first calculated eigval = -1.040561342183901
    last  calculated eigval = 0.035060555292981
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56554681412752
lambda[   5] =  -0.53707393989782
lambda[   6] =  -0.48454274914873
lambda[   7] =  -0.41888495477606
lambda[   8] =  -0.40728998670020
lambda[   9] =  -0.37556023961020
lambda[  10] =  -0.34656639637269
lambda[  11] =  -0.28331203062348
lambda[  12] =  -0.24243832427065
lambda[  13] =  -0.22046730789571
lambda[  14] =  -0.03672336612081
lambda[  15] =  -0.01697320047019
lambda[  16] =   0.00910462772351
lambda[  17] =   0.02198975755657
lambda[  18] =   0.02709467493211
lambda[  19] =   0.03072204969339
lambda[  20] =   0.03506055529298
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 8.337 ms
rank =  0, Distributing orbital back into band + domain format took 20.179 ms
rank = 0, Subspace_Rotation used 28.535 ms

Total time for subspace rotation: 28.542 ms
rank = 0, Efermi =  -0.065820163762 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.610 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.584 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.386 ms
rank = 0, Calculating density took 2130.243 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.038 ms
rank = 0, D2D took 1.232 ms
rank = 0, Transfering density took 1.238 ms
Etot    =   -46.725522004715
Eband   =   -12.903764267199
E1      =    28.372157174097
E2      =   -12.121610033206
E3      =   -16.359198545468
Exc     =   -14.677891699374
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 1.099e-05, dEband = 1.753e-03
rank = 0, Calculating/Estimating energy took 1.400 ms, Etot = -46.725522005, dEtot = 1.099e-05, dEband = 1.753e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0405682656829, which took 0.051 ms

iter_count = 108, r_2norm = 1.442e-06, tol*||rhs|| = 1.623e-06

Anderson update took 63.454 ms, out of which F'*F took 29.792 ms; b-Ax took 205.795 ms, out of which Lap took 180.758 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.129 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160660, int_b + int_rho = -1.783e-13, checking this took 0.191 ms
2-norm of RHS = 686.8894292166295, which took 0.175 ms

iter_count = 162, r_2norm = 5.939e-04, tol*||rhs|| = 6.869e-04

Anderson update took 96.748 ms, out of which F'*F took 44.861 ms; b-Ax took 306.749 ms, out of which Lap took 270.718 ms
Solving Poisson took 685.626 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.078494 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.567 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.369 ms
Total time for convolution: 	 convolve: 5.080879 
Total time for convolution: 	 convolve: 5.082722 
Total time for convolution: 	 convolve: 5.078758 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.134 ms
---Transfer Veff_loc: D2D took 2.414 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.001 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.932 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.381 ms

This SCF took 27595.318 ms, scf error = 1.768e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135061, lowerbound = -1.040561, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2030.110 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.616 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 25.099 ms
rank =  0, finding HY took 33.075 ms
rank =  0, distributing HY into block cyclic form took 20.535 ms
rank =  0, finding Y'*HY took 5.974 ms
Rank 0, Project_Hamiltonian used 84.728 ms
Total time for projection: 84.745 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.040411460842786
    last  calculated eigval = 0.036242671228454
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56538157800101
lambda[   5] =  -0.53690259983388
lambda[   6] =  -0.48437681813969
lambda[   7] =  -0.41871079376919
lambda[   8] =  -0.40712163854782
lambda[   9] =  -0.37539245729027
lambda[  10] =  -0.34640700351766
lambda[  11] =  -0.28314198198376
lambda[  12] =  -0.24227973292007
lambda[  13] =  -0.22029144739436
lambda[  14] =  -0.03653548766027
lambda[  15] =  -0.01459667672454
lambda[  16] =   0.00929374616321
lambda[  17] =   0.02449175898880
lambda[  18] =   0.02904387163262
lambda[  19] =   0.03238038525226
lambda[  20] =   0.03624267122845
==subpsace eigenproblem: bcast eigvals took 0.046 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.343 ms
rank =  0, Distributing orbital back into band + domain format took 20.174 ms
rank = 0, Subspace_Rotation used 28.542 ms

Total time for subspace rotation: 28.549 ms
rank = 0, Efermi =  -0.065632285280 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 5.399 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.886 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.450 ms
rank = 0, Calculating density took 2153.495 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.013 ms
rank = 0, D2D took 1.189 ms
rank = 0, Transfering density took 1.192 ms
Etot    =   -46.725561272498
Eband   =   -12.899484516609
E1      =    28.370557015733
E2      =   -12.118926702481
E3      =   -16.359087905842
Exc     =   -14.677816589032
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 4.908e-06, dEband = 5.350e-04
rank = 0, Calculating/Estimating energy took 1.306 ms, Etot = -46.725561272, dEtot = 4.908e-06, dEband = 5.350e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0391732009826, which took 0.095 ms

iter_count = 108, r_2norm = 1.378e-06, tol*||rhs|| = 1.567e-06

Anderson update took 64.048 ms, out of which F'*F took 29.825 ms; b-Ax took 206.027 ms, out of which Lap took 180.580 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.163 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160665, int_b + int_rho = -1.273e-13, checking this took 0.187 ms
2-norm of RHS = 686.8891661511383, which took 0.147 ms

iter_count = 78, r_2norm = 6.647e-04, tol*||rhs|| = 6.869e-04

Anderson update took 46.258 ms, out of which F'*F took 21.932 ms; b-Ax took 148.023 ms, out of which Lap took 131.093 ms
Solving Poisson took 333.203 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.078691 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.528 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.078871 
Total time for convolution: 	 convolve: 5.086345 
Total time for convolution: 	 convolve: 5.079913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.123 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.028 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.421 ms
---Transfer Veff_loc: D2D took 1.677 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.928 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.644 ms

This SCF took 27281.325 ms, scf error = 1.647e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136243, lowerbound = -1.040411, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2021.722 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.689 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.514 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.241 ms
rank =  0, finding HY took 33.024 ms
rank =  0, distributing HY into block cyclic form took 20.604 ms
rank =  0, finding Y'*HY took 5.871 ms
Rank 0, Project_Hamiltonian used 84.794 ms
Total time for projection: 84.816 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.099 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -1.040401418261628
    last  calculated eigval = 0.036297170983118
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56537109154694
lambda[   5] =  -0.53689206844733
lambda[   6] =  -0.48436633421814
lambda[   7] =  -0.41869989437592
lambda[   8] =  -0.40711020488073
lambda[   9] =  -0.37538273850411
lambda[  10] =  -0.34639496163293
lambda[  11] =  -0.28313270561984
lambda[  12] =  -0.24227146769622
lambda[  13] =  -0.22028212222745
lambda[  14] =  -0.03652732193660
lambda[  15] =  -0.01441793374440
lambda[  16] =   0.00929215453326
lambda[  17] =   0.02460925768458
lambda[  18] =   0.02912696714555
lambda[  19] =   0.03243233365968
lambda[  20] =   0.03629717098312
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 8.369 ms
rank =  0, Distributing orbital back into band + domain format took 20.246 ms
rank = 0, Subspace_Rotation used 28.634 ms

Total time for subspace rotation: 28.641 ms
rank = 0, Efermi =  -0.065624119674 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.438 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.819 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.395 ms
rank = 0, Calculating density took 2145.178 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.020 ms
rank = 0, D2D took 1.210 ms
rank = 0, Transfering density took 1.220 ms
Etot    =   -46.725558387401
Eband   =   -12.899225585566
E1      =    28.370432771472
E2      =   -12.118792646153
E3      =   -16.359107284692
Exc     =   -14.677833713239
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 3.606e-07, dEband = 3.237e-05
rank = 0, Calculating/Estimating energy took 2.241 ms, Etot = -46.725558387, dEtot = 3.606e-07, dEband = 3.237e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0353513054808, which took 0.061 ms

iter_count = 108, r_2norm = 1.118e-06, tol*||rhs|| = 1.414e-06

Anderson update took 62.731 ms, out of which F'*F took 31.828 ms; b-Ax took 208.417 ms, out of which Lap took 183.282 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.100 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160660, int_b + int_rho = -1.819e-13, checking this took 0.163 ms
2-norm of RHS = 686.8889980292817, which took 0.088 ms

iter_count = 138, r_2norm = 6.767e-04, tol*||rhs|| = 6.869e-04

Anderson update took 81.565 ms, out of which F'*F took 37.607 ms; b-Ax took 264.994 ms, out of which Lap took 234.746 ms
Solving Poisson took 586.850 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.263698 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.080888 
Total time for convolution: 	 convolve: 5.080384 
Total time for convolution: 	 convolve: 5.082215 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.155 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.571 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.926 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.528 ms

This SCF took 27691.106 ms, scf error = 1.586e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136297, lowerbound = -1.040401, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2029.637 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.561 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.526 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.113 ms
rank =  0, finding HY took 33.047 ms
rank =  0, distributing HY into block cyclic form took 20.490 ms
rank =  0, finding Y'*HY took 5.917 ms
Rank 0, Project_Hamiltonian used 84.597 ms
Total time for projection: 84.617 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -1.040204519153711
    last  calculated eigval = 0.037016054176057
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56518134826411
lambda[   5] =  -0.53670851366236
lambda[   6] =  -0.48418015689443
lambda[   7] =  -0.41851364426300
lambda[   8] =  -0.40693672237388
lambda[   9] =  -0.37519649610716
lambda[  10] =  -0.34620784746338
lambda[  11] =  -0.28294360768582
lambda[  12] =  -0.24208496723551
lambda[  13] =  -0.22010591042772
lambda[  14] =  -0.03639025655265
lambda[  15] =  -0.01399633049614
lambda[  16] =   0.00938302106181
lambda[  17] =   0.02441308263684
lambda[  18] =   0.02918319085061
lambda[  19] =   0.03245291511995
lambda[  20] =   0.03701605417606
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 8.345 ms
rank =  0, Distributing orbital back into band + domain format took 20.119 ms
rank = 0, Subspace_Rotation used 28.479 ms

Total time for subspace rotation: 28.485 ms
rank = 0, Efermi =  -0.065487054110 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.268 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.840 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.394 ms
rank = 0, Calculating density took 2152.553 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 2.224 ms
rank = 0, D2D took 2.327 ms
rank = 0, Transfering density took 2.331 ms
Etot    =   -46.725595333171
Eband   =   -12.894356379029
E1      =    28.367877848241
E2      =   -12.116367003309
E3      =   -16.359442346835
Exc     =   -14.678094361615
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 4.618e-06, dEband = 6.087e-04
rank = 0, Calculating/Estimating energy took 1.145 ms, Etot = -46.725595333, dEtot = 4.618e-06, dEband = 6.087e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0298246337635, which took 0.058 ms

iter_count = 108, r_2norm = 8.866e-07, tol*||rhs|| = 1.193e-06

Anderson update took 64.139 ms, out of which F'*F took 29.751 ms; b-Ax took 205.596 ms, out of which Lap took 180.397 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 464.501 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160672, int_b + int_rho = -5.821e-14, checking this took 0.178 ms
2-norm of RHS = 686.8880169861305, which took 0.147 ms

iter_count = 120, r_2norm = 6.306e-04, tol*||rhs|| = 6.869e-04

Anderson update took 70.977 ms, out of which F'*F took 33.392 ms; b-Ax took 227.896 ms, out of which Lap took 201.965 ms
Solving Poisson took 510.505 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.080212 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.089310 
Total time for convolution: 	 convolve: 5.088474 
Total time for convolution: 	 convolve: 5.104926 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.401 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.605 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.883 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.522 ms

This SCF took 27594.949 ms, scf error = 1.142e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.137016, lowerbound = -1.040205, upperbound = 267.582557

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2015.430 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.677 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.547 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.248 ms
rank =  0, finding HY took 32.980 ms
rank =  0, distributing HY into block cyclic form took 20.472 ms
rank =  0, finding Y'*HY took 5.936 ms
Rank 0, Project_Hamiltonian used 84.668 ms
Total time for projection: 84.686 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -1.040104015139873
    last  calculated eigval = 0.037997162952051
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56508770677437
lambda[   5] =  -0.53661697700638
lambda[   6] =  -0.48408776313907
lambda[   7] =  -0.41841916820048
lambda[   8] =  -0.40684730881858
lambda[   9] =  -0.37510511196511
lambda[  10] =  -0.34611403771728
lambda[  11] =  -0.28285098412488
lambda[  12] =  -0.24199431990462
lambda[  13] =  -0.22002006732583
lambda[  14] =  -0.03632447288509
lambda[  15] =  -0.01338832741848
lambda[  16] =   0.00942048665211
lambda[  17] =   0.02445595182264
lambda[  18] =   0.02935143667818
lambda[  19] =   0.03262979488670
lambda[  20] =   0.03799716295205
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 8.348 ms
rank =  0, Distributing orbital back into band + domain format took 20.139 ms
rank = 0, Subspace_Rotation used 28.503 ms

Total time for subspace rotation: 28.508 ms
rank = 0, Efermi =  -0.065421270492 calculate fermi energy took 0.711 ms
rank = 0, --- Calculate rho: sum over local bands took 5.811 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.176 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.389 ms
rank = 0, Calculating density took 2138.783 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.143 ms
rank = 0, D2D took 1.324 ms
rank = 0, Transfering density took 1.329 ms
Etot    =   -46.725606366862
Eband   =   -12.891938713009
E1      =    28.366618897864
E2      =   -12.115163472685
E3      =   -16.359593906281
Exc     =   -14.678212139770
Esc     =   -75.996831790265
Entropy =    -0.000000000648
dE = 1.379e-06, dEband = 3.022e-04
rank = 0, Calculating/Estimating energy took 1.467 ms, Etot = -46.725606367, dEtot = 1.379e-06, dEband = 3.022e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229862480455, which took 0.075 ms

iter_count = 108, r_2norm = 7.500e-07, tol*||rhs|| = 9.194e-07

Anderson update took 63.662 ms, out of which F'*F took 29.454 ms; b-Ax took 203.596 ms, out of which Lap took 179.046 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.256 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002160678, int_rho =  26.00000002160674, int_b + int_rho = -4.366e-14, checking this took 0.190 ms
2-norm of RHS = 686.8868102648945, which took 0.151 ms

iter_count = 126, r_2norm = 6.256e-04, tol*||rhs|| = 6.869e-04

Anderson update took 75.017 ms, out of which F'*F took 34.452 ms; b-Ax took 236.820 ms, out of which Lap took 208.838 ms
Solving Poisson took 532.801 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.086251 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.084390 
Total time for convolution: 	 convolve: 5.116319 
Total time for convolution: 	 convolve: 5.079684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.607 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.504 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.451 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.980 ms

This SCF took 27488.497 ms, scf error = 9.324e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.56508770677437, occ[   4] =   2.00000000000000
lambda[   5] =  -0.53661697700638, occ[   5] =   2.00000000000000
lambda[   6] =  -0.48408776313907, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41841916820048, occ[   7] =   2.00000000000000
lambda[   8] =  -0.40684730881858, occ[   8] =   2.00000000000000
lambda[   9] =  -0.37510511196511, occ[   9] =   2.00000000000000
lambda[  10] =  -0.34611403771728, occ[  10] =   2.00000000000000
lambda[  11] =  -0.28285098412488, occ[  11] =   2.00000000000000
lambda[  12] =  -0.24199431990462, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22002006732583, occ[  13] =   2.00000000000000
lambda[  14] =  -0.03632447288509, occ[  14] =   0.00000002160669
lambda[  15] =  -0.01338832741848, occ[  15] =   0.00000000000000
lambda[  16] =   0.00942048665211, occ[  16] =   0.00000000000000
lambda[  17] =   0.02445595182264, occ[  17] =   0.00000000000000
lambda[  18] =   0.02935143667818, occ[  18] =   0.00000000000000
lambda[  19] =   0.03262979488670, occ[  19] =   0.00000000000000
lambda[  20] =   0.03799716295205, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.727 ms, time for Allreduce/Reduce: 10.679 ms 
Time for calculating local force components: 23.495 ms
Start Calculating nonlocal forces
force_nloc = 
  1.02632545365581  -0.29944004511944  -0.00000004704803
  0.00764232988548  -0.05435114036936   0.00000002240149
 -0.03651316466060   0.03934963674221  -0.00000001643894
  0.03577601268521   0.04108687922371  -0.00000004845772
 -0.12324448420933  -0.14780351940357  -0.00000019807634
  0.00232210956762   0.10727009523112  -0.00000060793129
 -0.10543636981039   0.22434019429500   0.00000045315123
 -0.83999488401610  -0.28431789338623   0.00000051897408
force_loc = 
 -1.00104984156455   0.28834544304754   0.00000047580047
 -0.00870726795395   0.05845351624845   0.00000002667084
  0.03927877023874  -0.04210696436701   0.00000003167006
 -0.03863862379125  -0.04356538637379  -0.00000006888369
  0.11536095336337   0.15182671670019   0.00000104865981
  0.00485930055968  -0.10064547238556  -0.00000042133035
  0.09684318537111  -0.21815774592212  -0.00000024038008
  0.82285483729207   0.26885513464488   0.00000287264524
Time for calculating nonlocal force components: 49.300 ms
[32mforces_xc: 
[0m[32m -0.02950405067633   0.00942991782729   0.00000005980822
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00914166565927   0.00211836593736   0.00000006792661
[0m[32m -0.00506403877554  -0.00241893882517  -0.00000001804329
[0m[32m  0.00838761422703  -0.00735285716480  -0.00000005964820
[0m[32m  0.01853614638727   0.00934036116317   0.00000006179686
[0mTime for calculating XC forces components: 31.311 ms
 Cartesian force = 
 -0.00412539526440  -0.00169672146259  -0.00000000059772
 -0.00096189474779   0.00407033866111  -0.00000044008604
  0.00286864889881  -0.00278936484279  -0.00000047392725
 -0.00275956778537  -0.00251054436807  -0.00000060649979
  0.00136117813398   0.00610952601600   0.00000042935171
  0.00222041467244   0.00417364680241  -0.00000153646331
 -0.00010252689157  -0.00120244600991  -0.00000033603542
  0.00149914298391  -0.00615443479616   0.00000296425781
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.271 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.856 ms
Time for printing density: 387.251 ms
The program took 483.021 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:37
Job ID:        2266704
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:39:12,vmem=8436K,walltime=00:08:16,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-21-1
---------------------------------------
