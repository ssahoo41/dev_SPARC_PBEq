---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:06
Job ID:    2266538
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:14
Job ID:    2266538
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.049 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 16.154 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 8.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 14.659 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 73.447 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.968 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.428772	   14.541392	   11.114085	
   11.626943	   14.478007	    8.885915	
   10.571228	    5.458608	   11.114085	
    8.373057	    5.521993	    8.885915	
   10.025523	   11.144324	    9.594621	
    9.974477	    8.855676	    9.594621	
    9.974477	   13.727823	    9.476560	
   10.025523	    6.272177	    9.476560	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.161 ms
Set up communicators.

--set up spincomm took 2.272 ms

--set up kptcomm took 0.356 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 2}
gridsizes = [100, 100, 100], Nstates = 18, dmcomm dims = [1, 1, 2]

--set up dmcomm took 0.006 ms

--set up blacscomm took 0.028 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 12, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
Nd_blacscomm 500000, Nstates 18 
rank =  0, my blacs rank = 0, BLCYC size (500000, 3), actual size (500000, 3)
rank = 0, mb = nb = 18, mbQ = nbQ = 64
rank = 0, nr_Hp = 18, nc_Hp = 18
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.090 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 3
npdomain: 2
Embeded Cartesian topology dims: (1,1,2)
# of FD-grid points per processor: 500000 = (100,100,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.168 ms

Calculate_SplineDerivRadFun took 0.201 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.920 ms.
time spent on vectorized spline interp: 3.186 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.577 ms.
time spent on vectorized spline interp: 1.666 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.614 ms.
time spent on vectorized spline interp: 1.669 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.549 ms.

Calculating rb for all atom types took 16.190 ms
----------------------
Estimated memory usage
Total: 1.11 GB
orbitals             : 823.97 MB
global sized vectors : 213.62 MB
subspace matrices : 15.19 kB
others : 103.76 MB
----------------------------------------------
Estimated memory usage per processor: 95.11 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.908 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -22.0000000344656, sum_int_rho = 21.5939102081105
PosCharge = 22.000000034466, NegCharge = -21.593910208110, scal_fac = 1.018805756921
After scaling, int_rho = 22.0000000344657, PosCharge + NegCharge - NetCharge = -1.066e-13
--Calculate Vref took 0.493 ms
--Calculate rho_guess took 2.944 ms

 integral of b = -22.0000000344656,
 int{b} + Nelectron + NetCharge = -3.447e-08,
 Esc = -59.6547134078804,
 MPI_Reduce took 6.902 ms

Calculating b & b_ref took 17.192 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.048 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.056 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.039 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.312 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 34.238 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446576, int_b + int_rho = 1.455e-13, checking this took 0.104 ms
2-norm of RHS = 684.0336407362646, which took 0.092 ms

iter_count = 420, r_2norm = 6.099e-04, tol*||rhs|| = 6.840e-04

Anderson update took 1050.721 ms, out of which F'*F took 591.960 ms; b-Ax took 2936.499 ms, out of which Lap took 2869.370 ms
Solving Poisson took 5111.658 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.430 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
Total time for convolution: 	 convolve: 5.231290 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.751 ms
Total time for convolution: 	 convolve: 6.183658 
Total time for convolution: 	 convolve: 5.170291 
Total time for convolution: 	 convolve: 5.134942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.726 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
rank = 0, XC calculation took 25613.580 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 2.847 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 5.313 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 9.238 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.142 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.652 ms
    Lanczos iter 53, eigmin  = -0.947598018, eigmax = 264.931117358, err_eigmin = 1.420e-04, err_eigmax = 9.665e-03
rank =   0, Lanczos took 120.541 ms, eigmin = -0.947598018092, eigmax = 267.580428531325

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.266415, lowerbound = -1.047598, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1463.223 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 23.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.656 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 27.334 ms
rank =  0, finding HY took 26.731 ms
rank =  0, distributing HY into block cyclic form took 16.207 ms
rank =  0, finding Y'*HY took 5.414 ms
Rank 0, Project_Hamiltonian used 75.728 ms
Total time for projection: 75.750 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.315 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.412 ms
    first calculated eigval = 2.757774210826451
    last  calculated eigval = 3.219207054488881
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =   2.78581470204555
lambda[   3] =   2.81927050110555
lambda[   4] =   2.83860278874523
lambda[   5] =   2.84955809777622
lambda[   6] =   2.89436553320188
lambda[   7] =   2.92411175582755
lambda[   8] =   2.93360683190195
lambda[   9] =   2.94309657191161
lambda[  10] =   2.95868259146278
lambda[  11] =   3.02989865653003
lambda[  12] =   3.05967197911249
lambda[  13] =   3.06823563034806
lambda[  14] =   3.11119009451530
lambda[  15] =   3.13144660005909
lambda[  16] =   3.14511401392120
lambda[  17] =   3.20456996252425
lambda[  18] =   3.21920705448888
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.444 ms
rank =  0, subspace rotation using ScaLAPACK took 6.702 ms
rank =  0, Distributing orbital back into band + domain format took 16.127 ms
rank = 0, Subspace_Rotation used 22.844 ms

Total time for subspace rotation: 22.847 ms
rank = 0, Efermi =   3.044784061964 calculate fermi energy took 0.046 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.319207, lowerbound = -1.047598, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1454.662 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.527 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.510 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 19.064 ms
rank =  0, finding HY took 25.369 ms
rank =  0, distributing HY into block cyclic form took 15.528 ms
rank =  0, finding Y'*HY took 4.828 ms
Rank 0, Project_Hamiltonian used 64.823 ms
Total time for projection: 64.826 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.805410362922542
    last  calculated eigval = 0.444392578629934
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.69271493433752
lambda[   3] =  -0.59246291201971
lambda[   4] =  -0.34277638112871
lambda[   5] =  -0.26608541679017
lambda[   6] =  -0.20635377078655
lambda[   7] =  -0.06185128976235
lambda[   8] =   0.05194885126254
lambda[   9] =   0.12095097199083
lambda[  10] =   0.16438610340713
lambda[  11] =   0.19254470286859
lambda[  12] =   0.32196787773528
lambda[  13] =   0.34917439526425
lambda[  14] =   0.35761795136020
lambda[  15] =   0.35987339637963
lambda[  16] =   0.39987931034988
lambda[  17] =   0.41162314691506
lambda[  18] =   0.44439257862993
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 6.963 ms
rank =  0, Distributing orbital back into band + domain format took 15.440 ms
rank = 0, Subspace_Rotation used 22.418 ms

Total time for subspace rotation: 22.422 ms
rank = 0, Efermi =   0.293294789496 calculate fermi energy took 0.028 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.544393, lowerbound = -1.047598, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1455.592 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.575 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.554 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.189 ms
rank =  0, finding HY took 25.262 ms
rank =  0, distributing HY into block cyclic form took 15.855 ms
rank =  0, finding Y'*HY took 4.796 ms
Rank 0, Project_Hamiltonian used 65.143 ms
Total time for projection: 65.148 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.133 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.949644727991851
    last  calculated eigval = 0.174062764705204
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.94051132240566
lambda[   3] =  -0.81471777921678
lambda[   4] =  -0.60746039919381
lambda[   5] =  -0.58320838206860
lambda[   6] =  -0.55965802796759
lambda[   7] =  -0.55419128250123
lambda[   8] =  -0.40326220681479
lambda[   9] =  -0.39396923015008
lambda[  10] =  -0.29015067090988
lambda[  11] =  -0.27461736927846
lambda[  12] =   0.02922298885023
lambda[  13] =   0.06284086050192
lambda[  14] =   0.07072638094152
lambda[  15] =   0.09508397329866
lambda[  16] =   0.11094779988232
lambda[  17] =   0.13226576899411
lambda[  18] =   0.17406276470520
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 6.985 ms
rank =  0, Distributing orbital back into band + domain format took 15.448 ms
rank = 0, Subspace_Rotation used 22.450 ms

Total time for subspace rotation: 22.464 ms
rank = 0, Efermi =   0.000549900621 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.274063, lowerbound = -1.047598, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1449.425 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 15.437 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.553 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.009 ms
rank =  0, finding HY took 25.367 ms
rank =  0, distributing HY into block cyclic form took 15.461 ms
rank =  0, finding Y'*HY took 4.855 ms
Rank 0, Project_Hamiltonian used 64.722 ms
Total time for projection: 64.726 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.069 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.950103746882349
    last  calculated eigval = 0.101536339685969
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.94077409146250
lambda[   3] =  -0.81518997887003
lambda[   4] =  -0.60970039244544
lambda[   5] =  -0.58736540629802
lambda[   6] =  -0.56272238756760
lambda[   7] =  -0.56267598764450
lambda[   8] =  -0.41237618205619
lambda[   9] =  -0.41129793651167
lambda[  10] =  -0.30055822524131
lambda[  11] =  -0.29983849679569
lambda[  12] =  -0.02455297723326
lambda[  13] =   0.00240340776430
lambda[  14] =   0.01422549271561
lambda[  15] =   0.04066564259287
lambda[  16] =   0.05686567754359
lambda[  17] =   0.06583235956825
lambda[  18] =   0.10153633968597
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 6.363 ms
rank =  0, Distributing orbital back into band + domain format took 16.067 ms
rank = 0, Subspace_Rotation used 22.445 ms

Total time for subspace rotation: 22.449 ms
rank = 0, Efermi =  -0.053226065475 calculate fermi energy took 0.025 ms
rank = 0, --- Calculate rho: sum over local bands took 3.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 7.161 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.330 ms
rank = 0, Calculating density took 6318.320 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.949 ms
rank = 0, D2D took 23.551 ms
rank = 0, Transfering density took 23.558 ms
Etot    =   -35.235462363702
Eband   =   -12.905205664397
E1      =    25.802143059106
E2      =   -10.215923714631
E3      =   -12.604761229007
Exc     =   -11.298371293149
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 4.404e+00, dEband = 1.613e+00
rank = 0, Calculating/Estimating energy took 24.881 ms, Etot = -35.235462364, dEtot = 4.404e+00, dEband = 1.613e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 55.0970036893898, which took 17.089 ms

iter_count = 96, r_2norm = 1.744e-03, tol*||rhs|| = 2.204e-03

Anderson update took 51.897 ms, out of which F'*F took 23.983 ms; b-Ax took 162.463 ms, out of which Lap took 145.370 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 384.582 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446566, int_b + int_rho = 5.093e-14, checking this took 0.122 ms
2-norm of RHS = 679.4157546161890, which took 0.165 ms

iter_count = 288, r_2norm = 6.436e-04, tol*||rhs|| = 6.794e-04

Anderson update took 158.157 ms, out of which F'*F took 72.477 ms; b-Ax took 484.386 ms, out of which Lap took 436.363 ms
Solving Poisson took 1034.542 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.418 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.564 ms
Total time for convolution: 	 convolve: 5.093995 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 88.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.603 ms
Total time for convolution: 	 convolve: 5.149414 
Total time for convolution: 	 convolve: 5.159467 
Total time for convolution: 	 convolve: 5.110096 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.577 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.287 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 1.837 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.740 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.605 ms

This SCF took 32532.732 ms, scf error = 1.845e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.201536, lowerbound = -0.950104, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1443.757 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.616 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.245 ms
rank =  0, finding HY took 25.433 ms
rank =  0, distributing HY into block cyclic form took 15.901 ms
rank =  0, finding Y'*HY took 5.290 ms
Rank 0, Project_Hamiltonian used 65.907 ms
Total time for projection: 65.919 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.912622971365625
    last  calculated eigval = 0.072437937396367
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.90324330681699
lambda[   3] =  -0.76061522097146
lambda[   4] =  -0.57459442555171
lambda[   5] =  -0.54733593171275
lambda[   6] =  -0.53045412038486
lambda[   7] =  -0.52968448830037
lambda[   8] =  -0.37751990299590
lambda[   9] =  -0.37597533357858
lambda[  10] =  -0.26471820383371
lambda[  11] =  -0.26393526537935
lambda[  12] =  -0.03802746072996
lambda[  13] =  -0.00847901439332
lambda[  14] =  -0.00091542196520
lambda[  15] =   0.01877057309693
lambda[  16] =   0.03173431468305
lambda[  17] =   0.03530566271898
lambda[  18] =   0.07243793739637
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 3.038 ms
rank =  0, Distributing orbital back into band + domain format took 19.875 ms
rank = 0, Subspace_Rotation used 22.927 ms

Total time for subspace rotation: 22.931 ms
rank = 0, Efermi =  -0.066700548938 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.760 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.876 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.314 ms
rank = 0, Calculating density took 1542.893 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.024 ms
rank = 0, D2D took 1.131 ms
rank = 0, Transfering density took 1.137 ms
Etot    =   -35.155821585599
Eband   =   -12.081398343093
E1      =    25.118680499181
E2      =   -10.117641818735
E3      =   -12.798501912671
Exc     =   -11.454534064193
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 9.955e-03, dEband = 1.030e-01
rank = 0, Calculating/Estimating energy took 0.910 ms, Etot = -35.155821586, dEtot = 9.955e-03, dEband = 1.030e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 18.9076244294417, which took 0.084 ms

iter_count = 102, r_2norm = 6.661e-04, tol*||rhs|| = 7.563e-04

Anderson update took 54.470 ms, out of which F'*F took 25.696 ms; b-Ax took 173.083 ms, out of which Lap took 154.971 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.215 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446571, int_b + int_rho = 9.823e-14, checking this took 0.091 ms
2-norm of RHS = 674.5619270721144, which took 0.157 ms

iter_count = 300, r_2norm = 6.453e-04, tol*||rhs|| = 6.746e-04

Anderson update took 163.095 ms, out of which F'*F took 75.398 ms; b-Ax took 505.778 ms, out of which Lap took 454.836 ms
Solving Poisson took 1080.590 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
Total time for convolution: 	 convolve: 5.139637 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.107554 
Total time for convolution: 	 convolve: 5.134929 
Total time for convolution: 	 convolve: 5.122118 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.730 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 1.812 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.740 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.580 ms

This SCF took 27532.895 ms, scf error = 1.195e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.172438, lowerbound = -0.912623, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1465.065 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.492 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.978 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.003 ms
rank =  0, Distribute data + matrix mult took 19.490 ms
rank =  0, finding HY took 26.168 ms
rank =  0, distributing HY into block cyclic form took 16.027 ms
rank =  0, finding Y'*HY took 4.818 ms
Rank 0, Project_Hamiltonian used 66.537 ms
Total time for projection: 66.551 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.862115069061510
    last  calculated eigval = 0.056380920271977
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.85374300042708
lambda[   3] =  -0.67759585550130
lambda[   4] =  -0.52642665689558
lambda[   5] =  -0.48995958619734
lambda[   6] =  -0.48655398356038
lambda[   7] =  -0.48596204746316
lambda[   8] =  -0.32831972565079
lambda[   9] =  -0.32688438265864
lambda[  10] =  -0.21252552098901
lambda[  11] =  -0.21169792420214
lambda[  12] =  -0.04213186028932
lambda[  13] =  -0.00457664918818
lambda[  14] =   0.01560360658994
lambda[  15] =   0.01692326356273
lambda[  16] =   0.02505734692577
lambda[  17] =   0.03343679342138
lambda[  18] =   0.05638092027198
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.193 ms
rank =  0, subspace rotation using ScaLAPACK took 7.132 ms
rank =  0, Distributing orbital back into band + domain format took 15.645 ms
rank = 0, Subspace_Rotation used 22.797 ms

Total time for subspace rotation: 22.801 ms
rank = 0, Efermi =  -0.070804948524 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.465 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.378 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.305 ms
rank = 0, Calculating density took 1564.909 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.054 ms
rank = 0, D2D took 1.194 ms
rank = 0, Transfering density took 1.200 ms
Etot    =   -35.103943582381
Eband   =   -10.923567506666
E1      =    24.190608994897
E2      =    -9.880593783350
E3      =   -13.097210054519
Exc     =   -11.694075499580
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 6.485e-03, dEband = 1.447e-01
rank = 0, Calculating/Estimating energy took 0.905 ms, Etot = -35.103943582, dEtot = 6.485e-03, dEband = 1.447e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.8225461609946, which took 0.053 ms

iter_count = 108, r_2norm = 1.557e-04, tol*||rhs|| = 2.329e-04

Anderson update took 57.311 ms, out of which F'*F took 26.975 ms; b-Ax took 183.634 ms, out of which Lap took 163.904 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.217 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446585, int_b + int_rho = 2.328e-13, checking this took 0.107 ms
2-norm of RHS = 675.2251800288910, which took 0.159 ms

iter_count = 282, r_2norm = 5.750e-04, tol*||rhs|| = 6.752e-04

Anderson update took 150.728 ms, out of which F'*F took 70.320 ms; b-Ax took 478.307 ms, out of which Lap took 427.790 ms
Solving Poisson took 1015.180 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.143 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
Total time for convolution: 	 convolve: 5.151446 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.165291 
Total time for convolution: 	 convolve: 5.133165 
Total time for convolution: 	 convolve: 5.180460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 1.800 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 2.727 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 4.554 ms

This SCF took 27649.176 ms, scf error = 4.581e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.156381, lowerbound = -0.862115, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1455.536 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.599 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.649 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.269 ms
rank =  0, finding HY took 25.416 ms
rank =  0, distributing HY into block cyclic form took 15.610 ms
rank =  0, finding Y'*HY took 4.676 ms
Rank 0, Project_Hamiltonian used 65.007 ms
Total time for projection: 65.022 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -0.850709071264352
    last  calculated eigval = 0.046121904348785
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.84328913178134
lambda[   3] =  -0.65021603110341
lambda[   4] =  -0.51415440881767
lambda[   5] =  -0.47644359631985
lambda[   6] =  -0.47566940252082
lambda[   7] =  -0.47269812203211
lambda[   8] =  -0.31531968725984
lambda[   9] =  -0.31386164000342
lambda[  10] =  -0.19667667589505
lambda[  11] =  -0.19585846828774
lambda[  12] =  -0.04284805789315
lambda[  13] =  -0.00703712348932
lambda[  14] =   0.01338539860034
lambda[  15] =   0.01438532690241
lambda[  16] =   0.02434833515058
lambda[  17] =   0.03760948013693
lambda[  18] =   0.04612190434878
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.215 ms
rank =  0, subspace rotation using ScaLAPACK took 6.998 ms
rank =  0, Distributing orbital back into band + domain format took 15.892 ms
rank = 0, Subspace_Rotation used 22.910 ms

Total time for subspace rotation: 22.915 ms
rank = 0, Efermi =  -0.071521146105 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 3.706 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.162 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.532 ms
rank = 0, Calculating density took 1554.217 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.097 ms
rank = 0, D2D took 1.218 ms
rank = 0, Transfering density took 1.225 ms
Etot    =   -35.098399393451
Eband   =   -10.609792472048
E1      =    24.009822558216
E2      =    -9.733575785945
E3      =   -13.177972206685
Exc     =   -11.755264063349
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 6.930e-04, dEband = 3.922e-02
rank = 0, Calculating/Estimating energy took 0.887 ms, Etot = -35.098399393, dEtot = 6.930e-04, dEband = 3.922e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.4030628906457, which took 0.074 ms

iter_count = 108, r_2norm = 9.088e-05, tol*||rhs|| = 9.612e-05

Anderson update took 57.559 ms, out of which F'*F took 26.934 ms; b-Ax took 183.714 ms, out of which Lap took 164.294 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.726 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446569, int_b + int_rho = 8.004e-14, checking this took 0.121 ms
2-norm of RHS = 675.6225121117736, which took 0.149 ms

iter_count = 264, r_2norm = 5.531e-04, tol*||rhs|| = 6.756e-04

Anderson update took 160.042 ms, out of which F'*F took 72.461 ms; b-Ax took 456.833 ms, out of which Lap took 409.570 ms
Solving Poisson took 987.809 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.271913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.132130 
Total time for convolution: 	 convolve: 5.156511 
Total time for convolution: 	 convolve: 5.129439 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.777 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.838 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.400 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.264 ms

This SCF took 27692.158 ms, scf error = 1.583e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.146122, lowerbound = -0.850709, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1453.289 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.671 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.584 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.290 ms
rank =  0, finding HY took 25.323 ms
rank =  0, distributing HY into block cyclic form took 15.562 ms
rank =  0, finding Y'*HY took 4.889 ms
Rank 0, Project_Hamiltonian used 65.130 ms
Total time for projection: 65.142 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.844282455019244
    last  calculated eigval = 0.045002165766821
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.83690726716068
lambda[   3] =  -0.64250679184225
lambda[   4] =  -0.50789227126655
lambda[   5] =  -0.47013023240303
lambda[   6] =  -0.46942412173628
lambda[   7] =  -0.46609867819249
lambda[   8] =  -0.30929015370801
lambda[   9] =  -0.30782487676940
lambda[  10] =  -0.19044863925806
lambda[  11] =  -0.18962912595247
lambda[  12] =  -0.04282423100603
lambda[  13] =  -0.00959295273112
lambda[  14] =   0.01247305177958
lambda[  15] =   0.01290163424319
lambda[  16] =   0.02209235032401
lambda[  17] =   0.02921047554574
lambda[  18] =   0.04500216576682
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.206 ms
rank =  0, subspace rotation using ScaLAPACK took 6.960 ms
rank =  0, Distributing orbital back into band + domain format took 15.446 ms
rank = 0, Subspace_Rotation used 22.427 ms

Total time for subspace rotation: 22.431 ms
rank = 0, Efermi =  -0.071497319254 calculate fermi energy took 1.746 ms
rank = 0, --- Calculate rho: sum over local bands took 4.155 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.703 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.302 ms
rank = 0, Calculating density took 1552.051 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.049 ms
rank = 0, D2D took 1.200 ms
rank = 0, Transfering density took 1.206 ms
Etot    =   -35.097160718466
Eband   =   -10.468869228093
E1      =    23.938568059975
E2      =    -9.656065087401
E3      =   -13.210834315341
Exc     =   -11.779045544192
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.548e-04, dEband = 1.762e-02
rank = 0, Calculating/Estimating energy took 0.919 ms, Etot = -35.097160718, dEtot = 1.548e-04, dEband = 1.762e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7718498088924, which took 0.052 ms

iter_count = 114, r_2norm = 2.175e-05, tol*||rhs|| = 3.087e-05

Anderson update took 61.192 ms, out of which F'*F took 28.421 ms; b-Ax took 194.470 ms, out of which Lap took 173.944 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.018 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446570, int_b + int_rho = 8.367e-14, checking this took 0.117 ms
2-norm of RHS = 676.0791358135098, which took 0.149 ms

iter_count = 258, r_2norm = 5.714e-04, tol*||rhs|| = 6.761e-04

Anderson update took 140.254 ms, out of which F'*F took 64.801 ms; b-Ax took 439.130 ms, out of which Lap took 393.003 ms
Solving Poisson took 935.942 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.167605 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.197574 
Total time for convolution: 	 convolve: 5.163374 
Total time for convolution: 	 convolve: 5.144080 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.847 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 2.009 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.947 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.986 ms

This SCF took 27755.009 ms, scf error = 8.521e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.145002, lowerbound = -0.844282, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1451.233 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.495 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.577 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.096 ms
rank =  0, finding HY took 25.298 ms
rank =  0, distributing HY into block cyclic form took 15.446 ms
rank =  0, finding Y'*HY took 5.991 ms
Rank 0, Project_Hamiltonian used 65.871 ms
Total time for projection: 65.885 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.839179887017633
    last  calculated eigval = 0.044191935835233
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.83167085991725
lambda[   3] =  -0.64007967000583
lambda[   4] =  -0.50320264466095
lambda[   5] =  -0.46539482426216
lambda[   6] =  -0.46449691995381
lambda[   7] =  -0.46193756625493
lambda[   8] =  -0.30483697816882
lambda[   9] =  -0.30337563770329
lambda[  10] =  -0.18663273248949
lambda[  11] =  -0.18581310493304
lambda[  12] =  -0.04245786493468
lambda[  13] =  -0.01068747299804
lambda[  14] =   0.01212875208423
lambda[  15] =   0.01274261899219
lambda[  16] =   0.01886341020552
lambda[  17] =   0.02386267445682
lambda[  18] =   0.04419193583523
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 3.932 ms
rank =  0, Distributing orbital back into band + domain format took 18.212 ms
rank = 0, Subspace_Rotation used 22.166 ms

Total time for subspace rotation: 22.171 ms
rank = 0, Efermi =  -0.071130953178 calculate fermi energy took 0.093 ms
rank = 0, --- Calculate rho: sum over local bands took 3.909 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.739 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.355 ms
rank = 0, Calculating density took 1549.695 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.056 ms
rank = 0, D2D took 1.456 ms
rank = 0, Transfering density took 1.463 ms
Etot    =   -35.096438720582
Eband   =   -10.373241652198
E1      =    23.904826551836
E2      =    -9.589299155422
E3      =   -13.225937909205
Exc     =   -11.788547275948
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 9.025e-05, dEband = 1.195e-02
rank = 0, Calculating/Estimating energy took 0.900 ms, Etot = -35.096438721, dEtot = 9.025e-05, dEband = 1.195e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4578040511858, which took 0.051 ms

iter_count = 108, r_2norm = 1.611e-05, tol*||rhs|| = 1.831e-05

Anderson update took 56.626 ms, out of which F'*F took 26.712 ms; b-Ax took 183.908 ms, out of which Lap took 164.127 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 403.419 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446571, int_b + int_rho = 9.823e-14, checking this took 0.110 ms
2-norm of RHS = 676.2132054686768, which took 0.150 ms

iter_count = 252, r_2norm = 6.438e-04, tol*||rhs|| = 6.762e-04

Anderson update took 135.620 ms, out of which F'*F took 62.939 ms; b-Ax took 430.164 ms, out of which Lap took 384.052 ms
Solving Poisson took 907.470 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.530 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.182898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.187372 
Total time for convolution: 	 convolve: 5.163858 
Total time for convolution: 	 convolve: 5.140608 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 1.908 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.837 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.789 ms

This SCF took 27629.720 ms, scf error = 3.730e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.144192, lowerbound = -0.839180, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1459.729 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.646 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.313 ms
rank =  0, finding HY took 25.351 ms
rank =  0, distributing HY into block cyclic form took 15.503 ms
rank =  0, finding Y'*HY took 4.832 ms
Rank 0, Project_Hamiltonian used 65.042 ms
Total time for projection: 65.061 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.834710220419764
    last  calculated eigval = 0.044562993527626
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82739250421629
lambda[   3] =  -0.63345777044603
lambda[   4] =  -0.49871603969319
lambda[   5] =  -0.46143559155917
lambda[   6] =  -0.46076041157968
lambda[   7] =  -0.45724066857610
lambda[   8] =  -0.29975893010201
lambda[   9] =  -0.29829834157418
lambda[  10] =  -0.18117442260418
lambda[  11] =  -0.18036025776317
lambda[  12] =  -0.04110478040324
lambda[  13] =  -0.01006846033465
lambda[  14] =   0.01215862647262
lambda[  15] =   0.01429012330242
lambda[  16] =   0.01721672988398
lambda[  17] =   0.02321096149514
lambda[  18] =   0.04456299352763
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 6.874 ms
rank =  0, Distributing orbital back into band + domain format took 15.130 ms
rank = 0, Subspace_Rotation used 22.030 ms

Total time for subspace rotation: 22.035 ms
rank = 0, Efermi =  -0.069777868641 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.811 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.890 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.355 ms
rank = 0, Calculating density took 1557.239 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.035 ms
rank = 0, D2D took 1.640 ms
rank = 0, Transfering density took 1.647 ms
Etot    =   -35.096092849968
Eband   =   -10.266610318484
E1      =    23.854338038508
E2      =    -9.529725063479
E3      =   -13.237951084831
Exc     =   -11.796783309403
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 4.323e-05, dEband = 1.333e-02
rank = 0, Calculating/Estimating energy took 0.905 ms, Etot = -35.096092850, dEtot = 4.323e-05, dEband = 1.333e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2997481047037, which took 0.107 ms

iter_count = 114, r_2norm = 7.934e-06, tol*||rhs|| = 1.199e-05

Anderson update took 60.766 ms, out of which F'*F took 28.230 ms; b-Ax took 193.340 ms, out of which Lap took 172.570 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.590 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446578, int_b + int_rho = 1.673e-13, checking this took 0.958 ms
2-norm of RHS = 676.2085748484209, which took 0.139 ms

iter_count = 216, r_2norm = 6.289e-04, tol*||rhs|| = 6.762e-04

Anderson update took 115.432 ms, out of which F'*F took 53.586 ms; b-Ax took 366.362 ms, out of which Lap took 326.848 ms
Solving Poisson took 775.958 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.133529 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 44.864 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
Total time for convolution: 	 convolve: 5.166546 
Total time for convolution: 	 convolve: 5.171686 
Total time for convolution: 	 convolve: 5.224370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 1.997 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.939 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.969 ms

This SCF took 27577.089 ms, scf error = 1.985e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.144563, lowerbound = -0.834710, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1466.999 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.735 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.469 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 19.233 ms
rank =  0, finding HY took 25.522 ms
rank =  0, distributing HY into block cyclic form took 15.553 ms
rank =  0, finding Y'*HY took 4.649 ms
Rank 0, Project_Hamiltonian used 65.005 ms
Total time for projection: 65.025 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.078 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.833317290332910
    last  calculated eigval = 0.042210557613601
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82597923958488
lambda[   3] =  -0.63245947293098
lambda[   4] =  -0.49743279441651
lambda[   5] =  -0.46016482241785
lambda[   6] =  -0.45947813596060
lambda[   7] =  -0.45601861389266
lambda[   8] =  -0.29842667585113
lambda[   9] =  -0.29696761699506
lambda[  10] =  -0.17997077424922
lambda[  11] =  -0.17915690415599
lambda[  12] =  -0.04017385509867
lambda[  13] =  -0.00920974118204
lambda[  14] =   0.01187503007289
lambda[  15] =   0.01505950017093
lambda[  16] =   0.01650142205032
lambda[  17] =   0.02335594232036
lambda[  18] =   0.04221055761360
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 6.961 ms
rank =  0, Distributing orbital back into band + domain format took 15.179 ms
rank = 0, Subspace_Rotation used 22.157 ms

Total time for subspace rotation: 22.161 ms
rank = 0, Efermi =  -0.068846943298 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 3.837 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.344 ms
rank = 0, Calculating density took 1564.487 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.040 ms
rank = 0, D2D took 1.698 ms
rank = 0, Transfering density took 1.705 ms
Etot    =   -35.096099036208
Eband   =   -10.238744682960
E1      =    23.840601814513
E2      =    -9.514818017819
E3      =   -13.240679344031
Exc     =   -11.798740120711
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 7.733e-07, dEband = 3.483e-03
rank = 0, Calculating/Estimating energy took 0.916 ms, Etot = -35.096099036, dEtot = 7.733e-07, dEband = 3.483e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1563361232786, which took 0.108 ms

iter_count = 108, r_2norm = 5.976e-06, tol*||rhs|| = 6.253e-06

Anderson update took 57.969 ms, out of which F'*F took 26.777 ms; b-Ax took 183.100 ms, out of which Lap took 163.723 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 456.216 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446566, int_b + int_rho = 4.729e-14, checking this took 0.103 ms
2-norm of RHS = 676.1826151028724, which took 0.090 ms

iter_count = 228, r_2norm = 6.448e-04, tol*||rhs|| = 6.762e-04

Anderson update took 123.146 ms, out of which F'*F took 59.314 ms; b-Ax took 415.616 ms, out of which Lap took 374.819 ms
Solving Poisson took 849.219 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.107508 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 108.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.113550 
Total time for convolution: 	 convolve: 5.099899 
Total time for convolution: 	 convolve: 5.131330 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
---Transfer Veff_loc: D2D took 1.934 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.916 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.880 ms

This SCF took 27450.692 ms, scf error = 1.384e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.142211, lowerbound = -0.833317, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1471.650 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.551 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.557 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 20.134 ms
rank =  0, finding HY took 25.618 ms
rank =  0, distributing HY into block cyclic form took 15.523 ms
rank =  0, finding Y'*HY took 4.800 ms
Rank 0, Project_Hamiltonian used 66.119 ms
Total time for projection: 66.135 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.831686568420802
    last  calculated eigval = 0.041269456228203
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82437976409488
lambda[   3] =  -0.63045180206313
lambda[   4] =  -0.49583077337910
lambda[   5] =  -0.45852973904161
lambda[   6] =  -0.45784292786958
lambda[   7] =  -0.45436043001964
lambda[   8] =  -0.29665759777779
lambda[   9] =  -0.29520202031883
lambda[  10] =  -0.17811262799013
lambda[  11] =  -0.17729522944330
lambda[  12] =  -0.03622570567506
lambda[  13] =  -0.00441377809328
lambda[  14] =   0.01532039262828
lambda[  15] =   0.01821148643798
lambda[  16] =   0.02036574651859
lambda[  17] =   0.02493019204412
lambda[  18] =   0.04126945622820
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 6.942 ms
rank =  0, Distributing orbital back into band + domain format took 15.079 ms
rank = 0, Subspace_Rotation used 22.042 ms

Total time for subspace rotation: 22.047 ms
rank = 0, Efermi =  -0.064898793904 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 3.763 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.952 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.350 ms
rank = 0, Calculating density took 1570.253 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.041 ms
rank = 0, D2D took 1.574 ms
rank = 0, Transfering density took 1.581 ms
Etot    =   -35.096195207777
Eband   =   -10.200698962086
E1      =    23.822842250613
E2      =    -9.494298893766
E3      =   -13.241971341498
Exc     =   -11.799895322669
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.202e-05, dEband = 4.756e-03
rank = 0, Calculating/Estimating energy took 1.378 ms, Etot = -35.096195208, dEtot = 1.202e-05, dEband = 4.756e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1115272161550, which took 0.145 ms

iter_count = 114, r_2norm = 3.032e-06, tol*||rhs|| = 4.461e-06

Anderson update took 61.098 ms, out of which F'*F took 28.603 ms; b-Ax took 193.104 ms, out of which Lap took 172.917 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.460 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446570, int_b + int_rho = 8.367e-14, checking this took 0.125 ms
2-norm of RHS = 676.1728124896197, which took 0.120 ms

iter_count = 186, r_2norm = 6.501e-04, tol*||rhs|| = 6.762e-04

Anderson update took 99.639 ms, out of which F'*F took 47.223 ms; b-Ax took 316.381 ms, out of which Lap took 282.483 ms
Solving Poisson took 669.927 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.139942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 61.285 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.177500 
Total time for convolution: 	 convolve: 5.167094 
Total time for convolution: 	 convolve: 5.160600 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.778 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.606 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
---Transfer Veff_loc: D2D took 1.941 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 1.013 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.985 ms

This SCF took 27601.402 ms, scf error = 7.445e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.141269, lowerbound = -0.831687, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1462.181 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.582 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.172 ms
rank =  0, finding HY took 25.509 ms
rank =  0, distributing HY into block cyclic form took 15.553 ms
rank =  0, finding Y'*HY took 4.637 ms
Rank 0, Project_Hamiltonian used 64.918 ms
Total time for projection: 64.932 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.830925330783534
    last  calculated eigval = 0.038899263792462
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82361711189199
lambda[   3] =  -0.62972944579142
lambda[   4] =  -0.49510361992067
lambda[   5] =  -0.45783063894937
lambda[   6] =  -0.45715114927132
lambda[   7] =  -0.45362450708175
lambda[   8] =  -0.29594173532667
lambda[   9] =  -0.29448812939705
lambda[  10] =  -0.17741746082539
lambda[  11] =  -0.17659882914888
lambda[  12] =  -0.03528541998108
lambda[  13] =  -0.00332301246250
lambda[  14] =   0.01593210002297
lambda[  15] =   0.01894957795239
lambda[  16] =   0.02129152375427
lambda[  17] =   0.02502302393721
lambda[  18] =   0.03889926379246
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.218 ms
rank =  0, subspace rotation using ScaLAPACK took 7.043 ms
rank =  0, Distributing orbital back into band + domain format took 15.339 ms
rank = 0, Subspace_Rotation used 22.401 ms

Total time for subspace rotation: 22.406 ms
rank = 0, Efermi =  -0.063958508197 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 3.998 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.684 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.324 ms
rank = 0, Calculating density took 1559.878 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.183 ms
rank = 0, D2D took 1.391 ms
rank = 0, Transfering density took 1.398 ms
Etot    =   -35.096271461796
Eband   =   -10.184855917992
E1      =    23.813752948217
E2      =    -9.487049559285
E3      =   -13.244013283138
Exc     =   -11.801517925544
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 9.532e-06, dEband = 1.980e-03
rank = 0, Calculating/Estimating energy took 1.089 ms, Etot = -35.096271462, dEtot = 9.532e-06, dEband = 1.980e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0860276384224, which took 0.125 ms

iter_count = 114, r_2norm = 2.208e-06, tol*||rhs|| = 3.441e-06

Anderson update took 61.192 ms, out of which F'*F took 28.312 ms; b-Ax took 193.565 ms, out of which Lap took 172.592 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.886 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446567, int_b + int_rho = 5.821e-14, checking this took 0.116 ms
2-norm of RHS = 676.1841476491832, which took 0.141 ms

iter_count = 192, r_2norm = 5.717e-04, tol*||rhs|| = 6.762e-04

Anderson update took 103.009 ms, out of which F'*F took 47.746 ms; b-Ax took 326.128 ms, out of which Lap took 290.683 ms
Solving Poisson took 689.709 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.162866 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 18.337 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.354 ms
Total time for convolution: 	 convolve: 5.156453 
Total time for convolution: 	 convolve: 5.204870 
Total time for convolution: 	 convolve: 5.157375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.775 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.572 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.946 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
---Transfer Veff_loc: D2D took 1.933 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.946 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.912 ms

This SCF took 27413.194 ms, scf error = 5.633e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.138899, lowerbound = -0.830925, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1453.533 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.055 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.599 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 23.684 ms
rank =  0, finding HY took 25.742 ms
rank =  0, distributing HY into block cyclic form took 15.582 ms
rank =  0, finding Y'*HY took 4.711 ms
Rank 0, Project_Hamiltonian used 69.762 ms
Total time for projection: 69.783 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.830377538647500
    last  calculated eigval = 0.038468333882610
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82307634627612
lambda[   3] =  -0.62916144161292
lambda[   4] =  -0.49456023502879
lambda[   5] =  -0.45729958790297
lambda[   6] =  -0.45661892596716
lambda[   7] =  -0.45308704174286
lambda[   8] =  -0.29538734848679
lambda[   9] =  -0.29393417634587
lambda[  10] =  -0.17684478681080
lambda[  11] =  -0.17602583415236
lambda[  12] =  -0.03283009937602
lambda[  13] =  -0.00109377757352
lambda[  14] =   0.01760159030556
lambda[  15] =   0.02148672550046
lambda[  16] =   0.02393572202272
lambda[  17] =   0.02625336059847
lambda[  18] =   0.03846833388261
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 3.225 ms
rank =  0, Distributing orbital back into band + domain format took 19.737 ms
rank = 0, Subspace_Rotation used 23.069 ms

Total time for subspace rotation: 23.073 ms
rank = 0, Efermi =  -0.061503187578 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.994 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.759 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.403 ms
rank = 0, Calculating density took 1556.915 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.067 ms
rank = 0, D2D took 1.207 ms
rank = 0, Transfering density took 1.213 ms
Etot    =   -35.096322327297
Eband   =   -10.172746527080
E1      =    23.808218403605
E2      =    -9.480361515750
E3      =   -13.244549998070
Exc     =   -11.801992308743
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 6.358e-06, dEband = 1.514e-03
rank = 0, Calculating/Estimating energy took 0.915 ms, Etot = -35.096322327, dEtot = 6.358e-06, dEband = 1.514e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0617613107960, which took 0.054 ms

iter_count = 108, r_2norm = 2.158e-06, tol*||rhs|| = 2.470e-06

Anderson update took 57.686 ms, out of which F'*F took 26.845 ms; b-Ax took 183.326 ms, out of which Lap took 163.824 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.966 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446571, int_b + int_rho = 9.459e-14, checking this took 0.098 ms
2-norm of RHS = 676.2012045585308, which took 0.151 ms

iter_count = 186, r_2norm = 5.915e-04, tol*||rhs|| = 6.762e-04

Anderson update took 100.180 ms, out of which F'*F took 46.629 ms; b-Ax took 317.863 ms, out of which Lap took 283.954 ms
Solving Poisson took 672.129 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.134991 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.359 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.138021 
Total time for convolution: 	 convolve: 5.205910 
Total time for convolution: 	 convolve: 5.155595 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.403 ms
---Transfer Veff_loc: D2D took 1.912 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.982 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.925 ms

This SCF took 27354.221 ms, scf error = 3.933e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.138468, lowerbound = -0.830378, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1464.566 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.651 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.529 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.199 ms
rank =  0, finding HY took 25.521 ms
rank =  0, distributing HY into block cyclic form took 15.714 ms
rank =  0, finding Y'*HY took 4.657 ms
Rank 0, Project_Hamiltonian used 65.122 ms
Total time for projection: 65.135 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.829773952846472
    last  calculated eigval = 0.038575502013566
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82247810901996
lambda[   3] =  -0.62852930979232
lambda[   4] =  -0.49396446877948
lambda[   5] =  -0.45671409846314
lambda[   6] =  -0.45603228301556
lambda[   7] =  -0.45249262567130
lambda[   8] =  -0.29477703200643
lambda[   9] =  -0.29332459605963
lambda[  10] =  -0.17622423191773
lambda[  11] =  -0.17540275289279
lambda[  12] =  -0.03047640291546
lambda[  13] =   0.00045799769206
lambda[  14] =   0.01876330401457
lambda[  15] =   0.02432537279330
lambda[  16] =   0.02620304030311
lambda[  17] =   0.02807941412792
lambda[  18] =   0.03857550201357
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 6.972 ms
rank =  0, Distributing orbital back into band + domain format took 15.747 ms
rank = 0, Subspace_Rotation used 22.731 ms

Total time for subspace rotation: 22.735 ms
rank = 0, Efermi =  -0.059149491128 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 3.987 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.879 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.298 ms
rank = 0, Calculating density took 1562.949 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.051 ms
rank = 0, D2D took 1.263 ms
rank = 0, Transfering density took 1.269 ms
Etot    =   -35.096420529680
Eband   =   -10.159426921980
E1      =    23.802027737788
E2      =    -9.472992919059
E3      =   -13.245343371818
Exc     =   -11.802644227466
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.228e-05, dEband = 1.665e-03
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -35.096420530, dEtot = 1.228e-05, dEband = 1.665e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0568140479550, which took 0.079 ms

iter_count = 108, r_2norm = 1.969e-06, tol*||rhs|| = 2.273e-06

Anderson update took 57.556 ms, out of which F'*F took 26.719 ms; b-Ax took 183.548 ms, out of which Lap took 163.628 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.359 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446570, int_b + int_rho = 9.095e-14, checking this took 0.110 ms
2-norm of RHS = 676.1992118533838, which took 0.120 ms

iter_count = 144, r_2norm = 6.236e-04, tol*||rhs|| = 6.762e-04

Anderson update took 79.525 ms, out of which F'*F took 37.916 ms; b-Ax took 246.208 ms, out of which Lap took 220.919 ms
Solving Poisson took 521.429 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.179977 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 42.709 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.179390 
Total time for convolution: 	 convolve: 5.140718 
Total time for convolution: 	 convolve: 5.189344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.687 ms
---Transfer Veff_loc: D2D took 1.885 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.921 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.837 ms

This SCF took 27263.114 ms, scf error = 2.894e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.138576, lowerbound = -0.829774, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1459.015 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.652 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.516 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 19.186 ms
rank =  0, finding HY took 25.587 ms
rank =  0, distributing HY into block cyclic form took 15.509 ms
rank =  0, finding Y'*HY took 4.791 ms
Rank 0, Project_Hamiltonian used 65.102 ms
Total time for projection: 65.116 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.829591401937578
    last  calculated eigval = 0.038395699492663
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82229522619264
lambda[   3] =  -0.62834925581210
lambda[   4] =  -0.49378884179814
lambda[   5] =  -0.45654324336474
lambda[   6] =  -0.45586264905854
lambda[   7] =  -0.45231366186561
lambda[   8] =  -0.29460182964630
lambda[   9] =  -0.29314954217219
lambda[  10] =  -0.17605330064100
lambda[  11] =  -0.17523124952938
lambda[  12] =  -0.02982793539794
lambda[  13] =   0.00074805844219
lambda[  14] =   0.01916269963664
lambda[  15] =   0.02532755198876
lambda[  16] =   0.02683657862180
lambda[  17] =   0.02866487536914
lambda[  18] =   0.03839569949266
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 7.044 ms
rank =  0, Distributing orbital back into band + domain format took 15.333 ms
rank = 0, Subspace_Rotation used 22.396 ms

Total time for subspace rotation: 22.399 ms
rank = 0, Efermi =  -0.058501023622 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.810 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.905 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.344 ms
rank = 0, Calculating density took 1556.931 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.063 ms
rank = 0, D2D took 1.369 ms
rank = 0, Transfering density took 1.374 ms
Etot    =   -35.096444400061
Eband   =   -10.155560405064
E1      =    23.799859812142
E2      =    -9.471199722093
E3      =   -13.245721668354
Exc     =   -11.802951788686
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 2.984e-06, dEband = 4.833e-04
rank = 0, Calculating/Estimating energy took 0.902 ms, Etot = -35.096444400, dEtot = 2.984e-06, dEband = 4.833e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0458886807455, which took 0.068 ms

iter_count = 108, r_2norm = 1.498e-06, tol*||rhs|| = 1.836e-06

Anderson update took 57.533 ms, out of which F'*F took 26.851 ms; b-Ax took 183.182 ms, out of which Lap took 163.497 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.342 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446572, int_b + int_rho = 1.055e-13, checking this took 0.074 ms
2-norm of RHS = 676.2003773207712, which took 0.121 ms

iter_count = 150, r_2norm = 6.624e-04, tol*||rhs|| = 6.762e-04

Anderson update took 80.537 ms, out of which F'*F took 37.643 ms; b-Ax took 255.914 ms, out of which Lap took 228.388 ms
Solving Poisson took 541.523 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.154452 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.941 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.167716 
Total time for convolution: 	 convolve: 5.170370 
Total time for convolution: 	 convolve: 5.169886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.782 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 1.987 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.950 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.971 ms

This SCF took 27234.593 ms, scf error = 2.169e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.138396, lowerbound = -0.829591, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1452.329 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.589 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.603 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.214 ms
rank =  0, finding HY took 25.461 ms
rank =  0, distributing HY into block cyclic form took 15.544 ms
rank =  0, finding Y'*HY took 5.639 ms
Rank 0, Project_Hamiltonian used 65.915 ms
Total time for projection: 65.927 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.829444540873040
    last  calculated eigval = 0.038802673535476
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82214860955507
lambda[   3] =  -0.62819512656879
lambda[   4] =  -0.49364427092042
lambda[   5] =  -0.45639419062376
lambda[   6] =  -0.45571231106607
lambda[   7] =  -0.45216800338027
lambda[   8] =  -0.29445330256566
lambda[   9] =  -0.29300137294486
lambda[  10] =  -0.17590652212750
lambda[  11] =  -0.17508500833216
lambda[  12] =  -0.03015513701738
lambda[  13] =   0.00022860573153
lambda[  14] =   0.01972039377208
lambda[  15] =   0.02516383228556
lambda[  16] =   0.02612740244430
lambda[  17] =   0.02852133452207
lambda[  18] =   0.03880267353548
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 3.762 ms
rank =  0, Distributing orbital back into band + domain format took 18.175 ms
rank = 0, Subspace_Rotation used 21.951 ms

Total time for subspace rotation: 21.956 ms
rank = 0, Efermi =  -0.058828225254 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.805 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.878 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.354 ms
rank = 0, Calculating density took 1550.581 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.047 ms
rank = 0, D2D took 1.679 ms
rank = 0, Transfering density took 1.685 ms
Etot    =   -35.096496162741
Eband   =   -10.152306518954
E1      =    23.798363745901
E2      =    -9.469397513977
E3      =   -13.245718580368
Exc     =   -11.802956075133
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 6.470e-06, dEband = 4.067e-04
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -35.096496163, dEtot = 6.470e-06, dEband = 4.067e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0326335258711, which took 0.051 ms

iter_count = 108, r_2norm = 1.279e-06, tol*||rhs|| = 1.305e-06

Anderson update took 57.348 ms, out of which F'*F took 26.939 ms; b-Ax took 183.502 ms, out of which Lap took 164.031 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.018 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446571, int_b + int_rho = 9.823e-14, checking this took 0.116 ms
2-norm of RHS = 676.2019170243934, which took 0.086 ms

iter_count = 138, r_2norm = 6.026e-04, tol*||rhs|| = 6.762e-04

Anderson update took 74.130 ms, out of which F'*F took 34.505 ms; b-Ax took 236.409 ms, out of which Lap took 211.091 ms
Solving Poisson took 498.689 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.184987 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 100.635 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.140780 
Total time for convolution: 	 convolve: 5.217310 
Total time for convolution: 	 convolve: 5.170055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.790 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.384 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.773 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.691 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.492 ms

This SCF took 28121.578 ms, scf error = 1.749e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.138803, lowerbound = -0.829445, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1434.953 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 147.245 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.680 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 150.944 ms
rank =  0, finding HY took 25.257 ms
rank =  0, distributing HY into block cyclic form took 15.485 ms
rank =  0, finding Y'*HY took 4.824 ms
Rank 0, Project_Hamiltonian used 196.546 ms
Total time for projection: 196.561 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.829347329088642
    last  calculated eigval = 0.039712967976553
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82205114778324
lambda[   3] =  -0.62809461346109
lambda[   4] =  -0.49354797270965
lambda[   5] =  -0.45629468524535
lambda[   6] =  -0.45561207396897
lambda[   7] =  -0.45207019504845
lambda[   8] =  -0.29436123237873
lambda[   9] =  -0.29290936092225
lambda[  10] =  -0.17581580344730
lambda[  11] =  -0.17499411790966
lambda[  12] =  -0.03026559229610
lambda[  13] =  -0.00002200978172
lambda[  14] =   0.02054043423774
lambda[  15] =   0.02520002819102
lambda[  16] =   0.02590921468397
lambda[  17] =   0.02898027454157
lambda[  18] =   0.03971296797655
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.220 ms
rank =  0, subspace rotation using ScaLAPACK took 6.936 ms
rank =  0, Distributing orbital back into band + domain format took 15.234 ms
rank = 0, Subspace_Rotation used 22.183 ms

Total time for subspace rotation: 22.187 ms
rank = 0, Efermi =  -0.058938680540 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 3.819 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.990 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.317 ms
rank = 0, Calculating density took 1664.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.073 ms
rank = 0, D2D took 1.353 ms
rank = 0, Transfering density took 1.360 ms
Etot    =   -35.096519784291
Eband   =   -10.150197064970
E1      =    23.797344337966
E2      =    -9.468257670948
E3      =   -13.245815717801
Exc     =   -11.803027037137
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 2.953e-06, dEband = 2.637e-04
rank = 0, Calculating/Estimating energy took 0.906 ms, Etot = -35.096519784, dEtot = 2.953e-06, dEband = 2.637e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0268591359675, which took 0.054 ms

iter_count = 114, r_2norm = 6.628e-07, tol*||rhs|| = 1.074e-06

Anderson update took 61.438 ms, out of which F'*F took 28.339 ms; b-Ax took 192.609 ms, out of which Lap took 172.180 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.911 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446561, int_b + int_rho = 0.000e+00, checking this took 0.105 ms
2-norm of RHS = 676.2019455115578, which took 0.137 ms

iter_count = 126, r_2norm = 6.073e-04, tol*||rhs|| = 6.762e-04

Anderson update took 67.703 ms, out of which F'*F took 31.505 ms; b-Ax took 213.177 ms, out of which Lap took 190.703 ms
Solving Poisson took 453.923 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.961 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.164686 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 59.417 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.155947 
Total time for convolution: 	 convolve: 5.113922 
Total time for convolution: 	 convolve: 5.123762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.989 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.932 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.973 ms

This SCF took 27166.650 ms, scf error = 1.476e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.139713, lowerbound = -0.829347, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1455.260 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.617 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.717 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 19.357 ms
rank =  0, finding HY took 25.470 ms
rank =  0, distributing HY into block cyclic form took 15.544 ms
rank =  0, finding Y'*HY took 4.683 ms
Rank 0, Project_Hamiltonian used 65.086 ms
Total time for projection: 65.101 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.073 ms
rank = 0, Solve_Generalized_EigenProblem used 0.186 ms
    first calculated eigval = -0.829248819819911
    last  calculated eigval = 0.040031127031187
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82195212604278
lambda[   3] =  -0.62800304811968
lambda[   4] =  -0.49345058521200
lambda[   5] =  -0.45619740392149
lambda[   6] =  -0.45551446537341
lambda[   7] =  -0.45197286636010
lambda[   8] =  -0.29427358332910
lambda[   9] =  -0.29282170907835
lambda[  10] =  -0.17572973782374
lambda[  11] =  -0.17490784242335
lambda[  12] =  -0.03042209612870
lambda[  13] =  -0.00019721121716
lambda[  14] =   0.02107668368506
lambda[  15] =   0.02516654954023
lambda[  16] =   0.02579696169394
lambda[  17] =   0.02949796290563
lambda[  18] =   0.04003112703119
==subpsace eigenproblem: bcast eigvals took 0.036 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 6.911 ms
rank =  0, Distributing orbital back into band + domain format took 15.168 ms
rank = 0, Subspace_Rotation used 22.094 ms

Total time for subspace rotation: 22.099 ms
rank = 0, Efermi =  -0.059095184370 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 3.787 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.870 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.487 ms
rank = 0, Calculating density took 1552.956 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.219 ms
rank = 0, D2D took 1.615 ms
rank = 0, Transfering density took 1.620 ms
Etot    =   -35.096531087776
Eband   =   -10.148144376056
E1      =    23.796272681436
E2      =    -9.467226161396
E3      =   -13.245977569396
Exc     =   -11.803149715048
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.413e-06, dEband = 2.566e-04
rank = 0, Calculating/Estimating energy took 0.889 ms, Etot = -35.096531088, dEtot = 1.413e-06, dEband = 2.566e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0239589064750, which took 0.096 ms

iter_count = 108, r_2norm = 7.400e-07, tol*||rhs|| = 9.584e-07

Anderson update took 57.197 ms, out of which F'*F took 27.061 ms; b-Ax took 184.176 ms, out of which Lap took 164.188 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.213 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446572, int_b + int_rho = 1.091e-13, checking this took 0.114 ms
2-norm of RHS = 676.2035986950439, which took 0.758 ms

iter_count = 144, r_2norm = 6.038e-04, tol*||rhs|| = 6.762e-04

Anderson update took 76.921 ms, out of which F'*F took 36.443 ms; b-Ax took 246.932 ms, out of which Lap took 220.570 ms
Solving Poisson took 520.329 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.164055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.336 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.203006 
Total time for convolution: 	 convolve: 5.186122 
Total time for convolution: 	 convolve: 5.200169 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 2.056 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.932 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.018 ms

This SCF took 27241.136 ms, scf error = 1.238e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.140031, lowerbound = -0.829249, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1460.055 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.527 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.519 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.071 ms
rank =  0, finding HY took 25.509 ms
rank =  0, distributing HY into block cyclic form took 15.522 ms
rank =  0, finding Y'*HY took 4.794 ms
Rank 0, Project_Hamiltonian used 64.926 ms
Total time for projection: 64.939 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.829212972668732
    last  calculated eigval = 0.041331743594330
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82191510689415
lambda[   3] =  -0.62799176661346
lambda[   4] =  -0.49341050481382
lambda[   5] =  -0.45615318548489
lambda[   6] =  -0.45546727886930
lambda[   7] =  -0.45194057523282
lambda[   8] =  -0.29424466941951
lambda[   9] =  -0.29279320647191
lambda[  10] =  -0.17570295288979
lambda[  11] =  -0.17488123405111
lambda[  12] =  -0.03034243779008
lambda[  13] =  -0.00031921333919
lambda[  14] =   0.02223350566531
lambda[  15] =   0.02518346053010
lambda[  16] =   0.02599238203953
lambda[  17] =   0.03227081144553
lambda[  18] =   0.04133174359433
==subpsace eigenproblem: bcast eigvals took 0.044 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 7.074 ms
rank =  0, Distributing orbital back into band + domain format took 15.336 ms
rank = 0, Subspace_Rotation used 22.427 ms

Total time for subspace rotation: 22.432 ms
rank = 0, Efermi =  -0.059015526024 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 3.976 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.791 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.330 ms
rank = 0, Calculating density took 1557.880 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.186 ms
rank = 0, D2D took 1.324 ms
rank = 0, Transfering density took 1.327 ms
Etot    =   -35.096540330711
Eband   =   -10.147426907865
E1      =    23.796128025559
E2      =    -9.466691492358
E3      =   -13.245772663069
Exc     =   -11.802992194933
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.155e-06, dEband = 8.968e-05
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -35.096540331, dEtot = 1.155e-06, dEband = 8.968e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0239042081862, which took 0.152 ms

iter_count = 108, r_2norm = 7.718e-07, tol*||rhs|| = 9.562e-07

Anderson update took 58.214 ms, out of which F'*F took 26.879 ms; b-Ax took 183.315 ms, out of which Lap took 163.736 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.857 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446576, int_b + int_rho = 1.492e-13, checking this took 0.104 ms
2-norm of RHS = 676.2036742017215, which took 0.160 ms

iter_count = 60, r_2norm = 6.593e-04, tol*||rhs|| = 6.762e-04

Anderson update took 32.243 ms, out of which F'*F took 14.974 ms; b-Ax took 101.904 ms, out of which Lap took 91.238 ms
Solving Poisson took 219.147 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.224046 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 12.810 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.255702 
Total time for convolution: 	 convolve: 5.174740 
Total time for convolution: 	 convolve: 5.182494 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.114 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.706 ms
---Transfer Veff_loc: D2D took 1.920 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.906 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.856 ms

This SCF took 27047.117 ms, scf error = 1.411e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.141332, lowerbound = -0.829213, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1470.459 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.520 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 19.264 ms
rank =  0, finding HY took 25.562 ms
rank =  0, distributing HY into block cyclic form took 15.498 ms
rank =  0, finding Y'*HY took 4.750 ms
Rank 0, Project_Hamiltonian used 65.108 ms
Total time for projection: 65.125 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.105 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.083 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.829189431074619
    last  calculated eigval = 0.041397880808431
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82189150352400
lambda[   3] =  -0.62796907388158
lambda[   4] =  -0.49338801408946
lambda[   5] =  -0.45613082741878
lambda[   6] =  -0.45544503334434
lambda[   7] =  -0.45191807427498
lambda[   8] =  -0.29422130608522
lambda[   9] =  -0.29276979956900
lambda[  10] =  -0.17568021966814
lambda[  11] =  -0.17485849368689
lambda[  12] =  -0.03012120670009
lambda[  13] =  -0.00016361518059
lambda[  14] =   0.02248171717264
lambda[  15] =   0.02537019563801
lambda[  16] =   0.02622633299697
lambda[  17] =   0.03235377108963
lambda[  18] =   0.04139788080843
==subpsace eigenproblem: bcast eigvals took 0.028 ms
Total time for solving subspace eigenvalue problem: 0.228 ms
rank =  0, subspace rotation using ScaLAPACK took 6.974 ms
rank =  0, Distributing orbital back into band + domain format took 15.226 ms
rank = 0, Subspace_Rotation used 22.216 ms

Total time for subspace rotation: 22.220 ms
rank = 0, Efermi =  -0.058794294942 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 3.841 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.835 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.332 ms
rank = 0, Calculating density took 1568.165 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.055 ms
rank = 0, D2D took 1.373 ms
rank = 0, Transfering density took 1.376 ms
Etot    =   -35.096540046120
Eband   =   -10.146923554272
E1      =    23.795870958079
E2      =    -9.466430792950
E3      =   -13.245838276548
Exc     =   -11.803043110526
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 3.557e-08, dEband = 6.292e-05
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -35.096540046, dEtot = 3.557e-08, dEband = 6.292e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0222396586770, which took 0.103 ms

iter_count = 108, r_2norm = 8.082e-07, tol*||rhs|| = 8.896e-07

Anderson update took 57.317 ms, out of which F'*F took 26.925 ms; b-Ax took 183.877 ms, out of which Lap took 164.357 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.195 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446562, int_b + int_rho = 7.276e-15, checking this took 0.101 ms
2-norm of RHS = 676.2040482068778, which took 0.132 ms

iter_count = 102, r_2norm = 6.481e-04, tol*||rhs|| = 6.762e-04

Anderson update took 54.474 ms, out of which F'*F took 25.772 ms; b-Ax took 173.962 ms, out of which Lap took 155.484 ms
Solving Poisson took 369.181 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.159847 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.288 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.202560 
Total time for convolution: 	 convolve: 5.136645 
Total time for convolution: 	 convolve: 5.133430 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 1.977 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.927 ms

This SCF took 27005.898 ms, scf error = 1.356e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.141398, lowerbound = -0.829189, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1461.350 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.728 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.469 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.217 ms
rank =  0, finding HY took 25.648 ms
rank =  0, distributing HY into block cyclic form took 15.555 ms
rank =  0, finding Y'*HY took 4.791 ms
Rank 0, Project_Hamiltonian used 65.251 ms
Total time for projection: 65.266 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.829107107504265
    last  calculated eigval = 0.042117449886525
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82180950202763
lambda[   3] =  -0.62788366165263
lambda[   4] =  -0.49330802121550
lambda[   5] =  -0.45605409569184
lambda[   6] =  -0.45536904726077
lambda[   7] =  -0.45183684431051
lambda[   8] =  -0.29414072961606
lambda[   9] =  -0.29268922813635
lambda[  10] =  -0.17559968582409
lambda[  11] =  -0.17477779459936
lambda[  12] =  -0.02962668377320
lambda[  13] =   0.00015864718303
lambda[  14] =   0.02335536814824
lambda[  15] =   0.02608524932376
lambda[  16] =   0.02687861060379
lambda[  17] =   0.03332293571434
lambda[  18] =   0.04211744988652
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.271 ms
rank =  0, subspace rotation using ScaLAPACK took 3.583 ms
rank =  0, Distributing orbital back into band + domain format took 17.866 ms
rank = 0, Subspace_Rotation used 21.466 ms

Total time for subspace rotation: 21.471 ms
rank = 0, Efermi =  -0.058299771995 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 3.630 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.156 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.329 ms
rank = 0, Calculating density took 1558.603 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 1.055 ms
rank = 0, D2D took 2.107 ms
rank = 0, Transfering density took 2.112 ms
Etot    =   -35.096544513180
Eband   =   -10.145151436699
E1      =    23.794923966569
E2      =    -9.465558408056
E3      =   -13.246037483209
Exc     =   -11.803199525416
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 5.584e-07, dEband = 2.215e-04
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -35.096544513, dEtot = 5.584e-07, dEband = 2.215e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226581294125, which took 0.052 ms

iter_count = 108, r_2norm = 8.391e-07, tol*||rhs|| = 9.063e-07

Anderson update took 57.620 ms, out of which F'*F took 27.059 ms; b-Ax took 183.784 ms, out of which Lap took 164.397 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.781 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446580, int_b + int_rho = 1.892e-13, checking this took 0.082 ms
2-norm of RHS = 676.2042921598462, which took 0.148 ms

iter_count = 18, r_2norm = 6.147e-04, tol*||rhs|| = 6.762e-04

Anderson update took 9.535 ms, out of which F'*F took 4.708 ms; b-Ax took 30.706 ms, out of which Lap took 27.437 ms
Solving Poisson took 67.831 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.142158 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 76.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.140640 
Total time for convolution: 	 convolve: 5.135899 
Total time for convolution: 	 convolve: 5.137524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.769 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.243 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 1.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.940 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.930 ms

This SCF took 26836.823 ms, scf error = 1.186e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.142117, lowerbound = -0.829107, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1460.017 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.541 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.565 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.142 ms
rank =  0, finding HY took 25.378 ms
rank =  0, distributing HY into block cyclic form took 15.606 ms
rank =  0, finding Y'*HY took 4.778 ms
Rank 0, Project_Hamiltonian used 64.952 ms
Total time for projection: 64.970 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.829111787522070
    last  calculated eigval = 0.042082905211436
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82181424760074
lambda[   3] =  -0.62788808445244
lambda[   4] =  -0.49331227421029
lambda[   5] =  -0.45605799148352
lambda[   6] =  -0.45537279708692
lambda[   7] =  -0.45184141187297
lambda[   8] =  -0.29414448022062
lambda[   9] =  -0.29269299416564
lambda[  10] =  -0.17560314052581
lambda[  11] =  -0.17478126269429
lambda[  12] =  -0.02958409267380
lambda[  13] =   0.00018527018616
lambda[  14] =   0.02334873862017
lambda[  15] =   0.02607547023971
lambda[  16] =   0.02689582480626
lambda[  17] =   0.03323143303613
lambda[  18] =   0.04208290521144
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 7.024 ms
rank =  0, Distributing orbital back into band + domain format took 15.296 ms
rank = 0, Subspace_Rotation used 22.342 ms

Total time for subspace rotation: 22.370 ms
rank = 0, Efermi =  -0.058257180909 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 3.897 ms
rank = 0, --- Calculate rho: reduce over all band groups took 6.800 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.333 ms
rank = 0, Calculating density took 1558.785 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.969 ms
rank = 0, D2D took 1.075 ms
rank = 0, Transfering density took 1.082 ms
Etot    =   -35.096548415759
Eband   =   -10.145240944690
E1      =    23.794996060665
E2      =    -9.465582626298
E3      =   -13.245991833285
Exc     =   -11.803164582417
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 4.878e-07, dEband = 1.119e-05
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -35.096548416, dEtot = 4.878e-07, dEband = 1.119e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0227503334429, which took 0.052 ms

iter_count = 108, r_2norm = 6.169e-07, tol*||rhs|| = 9.100e-07

Anderson update took 57.703 ms, out of which F'*F took 26.958 ms; b-Ax took 183.534 ms, out of which Lap took 163.912 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.024 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446568, int_b + int_rho = 6.548e-14, checking this took 0.100 ms
2-norm of RHS = 676.2020896019211, which took 0.133 ms

iter_count = 144, r_2norm = 5.762e-04, tol*||rhs|| = 6.762e-04

Anderson update took 76.845 ms, out of which F'*F took 36.216 ms; b-Ax took 245.862 ms, out of which Lap took 219.585 ms
Solving Poisson took 520.305 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.138515 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 82.371 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.145171 
Total time for convolution: 	 convolve: 5.136113 
Total time for convolution: 	 convolve: 5.138246 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.936 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.911 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.882 ms

This SCF took 27178.035 ms, scf error = 1.243e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.142083, lowerbound = -0.829112, upperbound = 267.580429

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (3 columns, degree = 45): 1460.087 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.663 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.620 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 19.315 ms
rank =  0, finding HY took 25.405 ms
rank =  0, distributing HY into block cyclic form took 15.545 ms
rank =  0, finding Y'*HY took 4.775 ms
Rank 0, Project_Hamiltonian used 65.087 ms
Total time for projection: 65.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -0.829051028855798
    last  calculated eigval = 0.040066649645405
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 22):
lambda[   2] =  -0.82175336649999
lambda[   3] =  -0.62782526700399
lambda[   4] =  -0.49325058580193
lambda[   5] =  -0.45600806692369
lambda[   6] =  -0.45532518023836
lambda[   7] =  -0.45177657292781
lambda[   8] =  -0.29409734465101
lambda[   9] =  -0.29264583298669
lambda[  10] =  -0.17555695932673
lambda[  11] =  -0.17473528305955
lambda[  12] =  -0.03094201970189
lambda[  13] =  -0.00079110850634
lambda[  14] =   0.02251519252038
lambda[  15] =   0.02463931320590
lambda[  16] =   0.02546838279482
lambda[  17] =   0.03462126899254
lambda[  18] =   0.04006664964540
==subpsace eigenproblem: bcast eigvals took 0.049 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 7.006 ms
rank =  0, Distributing orbital back into band + domain format took 15.388 ms
rank = 0, Subspace_Rotation used 22.417 ms

Total time for subspace rotation: 22.422 ms
rank = 0, Efermi =  -0.059615107937 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 3.960 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.841 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.335 ms
rank = 0, Calculating density took 1558.159 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.083 ms
rank = 0, D2D took 1.322 ms
rank = 0, Transfering density took 1.329 ms
Etot    =   -35.096547065378
Eband   =   -10.144050977618
E1      =    23.794110234710
E2      =    -9.465207134230
E3      =   -13.246264964502
Exc     =   -11.803365012303
Esc     =   -59.654713407880
Entropy =    -0.000000001019
dE = 1.688e-07, dEband = 1.487e-04
rank = 0, Calculating/Estimating energy took 0.932 ms, Etot = -35.096547065, dEtot = 1.688e-07, dEband = 1.487e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0186849813928, which took 0.074 ms

iter_count = 102, r_2norm = 6.468e-07, tol*||rhs|| = 7.474e-07

Anderson update took 54.542 ms, out of which F'*F took 25.391 ms; b-Ax took 173.462 ms, out of which Lap took 155.047 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.784 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -22.00000003446561, int_rho =  22.00000003446567, int_b + int_rho = 5.821e-14, checking this took 0.111 ms
2-norm of RHS = 676.2082146709103, which took 0.140 ms

iter_count = 114, r_2norm = 6.012e-04, tol*||rhs|| = 6.762e-04

Anderson update took 60.927 ms, out of which F'*F took 28.636 ms; b-Ax took 198.247 ms, out of which Lap took 177.686 ms
Solving Poisson took 415.443 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.147397 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 57.983 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.133219 
Total time for convolution: 	 convolve: 5.139621 
Total time for convolution: 	 convolve: 5.141711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.808 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.997 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 500000) to all bandcomms took 0.654 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.684 ms

This SCF took 27073.932 ms, scf error = 6.332e-05
The last 17 occupations of kpoints #1 are (Nelectron = 22):
lambda[   2] =  -0.82175336649999, occ[   2] =   2.00000000000000
lambda[   3] =  -0.62782526700399, occ[   3] =   2.00000000000000
lambda[   4] =  -0.49325058580193, occ[   4] =   2.00000000000000
lambda[   5] =  -0.45600806692369, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45532518023836, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45177657292781, occ[   7] =   2.00000000000000
lambda[   8] =  -0.29409734465101, occ[   8] =   2.00000000000000
lambda[   9] =  -0.29264583298669, occ[   9] =   2.00000000000000
lambda[  10] =  -0.17555695932673, occ[  10] =   2.00000000000000
lambda[  11] =  -0.17473528305955, occ[  11] =   2.00000000000000
lambda[  12] =  -0.03094201970189, occ[  12] =   0.00000003446572
lambda[  13] =  -0.00079110850634, occ[  13] =   0.00000000000000
lambda[  14] =   0.02251519252038, occ[  14] =   0.00000000000000
lambda[  15] =   0.02463931320590, occ[  15] =   0.00000000000000
lambda[  16] =   0.02546838279482, occ[  16] =   0.00000000000000
lambda[  17] =   0.03462126899254, occ[  17] =   0.00000000000000
lambda[  18] =   0.04006664964540, occ[  18] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 16 (90%) = 0.000000000000000.
Occupation of state 18 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.644 ms, time for Allreduce/Reduce: 8.828 ms 
Time for calculating local force components: 19.556 ms
Start Calculating nonlocal forces
force_nloc = 
  0.02009739685065  -0.02825524866320  -0.05582103393864
 -0.05628622077489  -0.02601039929424   0.02155485246997
 -0.02009735239457   0.02825521113623  -0.05582101301872
  0.05628619648314   0.02601037312525   0.02155481816375
 -0.01682944926652   0.13732932618988  -0.00946805987130
  0.01682959539447  -0.13732367101121  -0.00946731579330
  0.38440523791417  -0.25574113835998   0.38827132492569
 -0.38440269611778   0.25573581305027   0.38826880583482
force_loc = 
 -0.02284459234068   0.03212128073813   0.05902019036916
  0.05969930575624   0.02987026042516  -0.02453768656326
  0.02284483183395  -0.03212174626271   0.05902096600361
 -0.05969990472229  -0.02987092798288  -0.02453829052404
  0.01535771121790  -0.10879953862481   0.00752828581261
 -0.01535782889577   0.10880882154710   0.00752813309664
 -0.37376185306428   0.23500860502787  -0.37692767585895
  0.37376048549875  -0.23501391663478  -0.37692690378278
Time for calculating nonlocal force components: 36.946 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00038561822648  -0.01587446483285   0.00029195649260
[0m[32m -0.00038563037018   0.01587419658376   0.00029198190682
[0m[32m -0.00973614950696   0.00816612801457  -0.00990093540921
[0m[32m  0.00973606870067  -0.00816584204743  -0.00990092506107
[0mTime for calculating XC forces components: 26.968 ms
 Cartesian force = 
 -0.00274729179285   0.00386564180941   0.00319647202372
  0.00341298867854   0.00385947086540  -0.00298551850010
  0.00274738313657  -0.00386692539200   0.00319726857809
 -0.00341380454197  -0.00386094512315  -0.00298615676710
 -0.00108621612495   0.01265493246671  -0.00165050197288
  0.00108603982571  -0.01264104314587  -0.00164988519664
  0.00090713904012  -0.01256679558306   0.00144002925073
 -0.00090623822117   0.01255566410254   0.00143829258417
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Time for printing density: 371.898 ms
The program took 612.887 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:28
Job ID:        2266538
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:07:36,vmem=8412K,walltime=00:10:38,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-19-1
---------------------------------------
