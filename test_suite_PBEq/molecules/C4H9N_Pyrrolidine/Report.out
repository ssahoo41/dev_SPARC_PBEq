---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:24
Job ID:    2266683
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:28
Job ID:    2266683
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.056 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 28.512 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 14.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 11.501 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 117.102 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.946 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.084 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.071024	    6.544606	   10.000000	
    8.170659	    9.000725	   12.512693	
    8.170659	    9.000725	    7.487307	
   11.207003	    9.248359	   13.917956	
   11.207003	    9.248359	    6.082044	
   11.829341	   13.399490	   12.192887	
   11.829341	   13.399490	    7.807113	
    8.502854	   13.455394	   12.264822	
    8.502854	   13.455394	    7.735178	
   10.133487	    9.644774	   12.194883	
   10.133487	    9.644774	    7.805117	
   10.133487	   12.468607	   11.470345	
   10.133487	   12.468607	    8.529655	
   11.314818	    8.445741	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.173 ms
Set up communicators.

--set up spincomm took 2.238 ms

--set up kptcomm took 0.336 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.054 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.942 ms

Calculate_SplineDerivRadFun took 0.206 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 2.230 ms.
time spent on vectorized spline interp: 2.907 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.623 ms.
time spent on vectorized spline interp: 1.856 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.505 ms.
time spent on vectorized spline interp: 1.805 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.381 ms.

Calculating rb for all atom types took 17.319 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.917 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000484465, sum_int_rho = 29.0983254027978
PosCharge = 30.000000048446, NegCharge = -29.098325402798, scal_fac = 1.030987166209
After scaling, int_rho = 30.0000000484465, PosCharge + NegCharge - NetCharge = -1.421e-14
--Calculate Vref took 0.582 ms
--Calculate rho_guess took 3.323 ms

 integral of b = -30.0000000484465,
 int{b} + Nelectron + NetCharge = -4.845e-08,
 Esc = -71.0572553187105,
 MPI_Reduce took 13.096 ms

Calculating b & b_ref took 24.431 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.085 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.095 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.082 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.669 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.007 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.608 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844648, int_b + int_rho = -2.583e-13, checking this took 0.537 ms
2-norm of RHS = 878.9684875611379, which took 0.490 ms

iter_count = 420, r_2norm = 7.180e-04, tol*||rhs|| = 8.790e-04

Anderson update took 263.070 ms, out of which F'*F took 117.713 ms; b-Ax took 795.326 ms, out of which Lap took 707.948 ms
Solving Poisson took 1760.796 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.509 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.122792 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.121134 
Total time for convolution: 	 convolve: 5.121910 
Total time for convolution: 	 convolve: 5.116575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.692 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.418 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
rank = 0, XC calculation took 24353.896 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 4.802 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.958 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.838 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.159 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.851 ms
    Lanczos iter 54, eigmin  = -0.902600104, eigmax = 264.941268403, err_eigmin = 8.938e-04, err_eigmax = 9.951e-03
rank =   0, Lanczos took 136.830 ms, eigmin = -0.902600104030, eigmax = 267.590681087159

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.294040, lowerbound = -1.002600, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1789.396 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 51.615 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.525 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 55.162 ms
rank =  0, finding HY took 30.092 ms
rank =  0, distributing HY into block cyclic form took 23.717 ms
rank =  0, finding Y'*HY took 6.601 ms
Rank 0, Project_Hamiltonian used 116.043 ms
Total time for projection: 116.065 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.770 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.865 ms
    first calculated eigval = 2.702112469312989
    last  calculated eigval = 3.264412943925463
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.84677982881944
lambda[   7] =   2.88558555440462
lambda[   8] =   2.90666721274735
lambda[   9] =   2.93259029235825
lambda[  10] =   2.95053108764273
lambda[  11] =   2.96962938734222
lambda[  12] =   2.98364034333667
lambda[  13] =   2.99585040957960
lambda[  14] =   3.03001324330311
lambda[  15] =   3.05672819088332
lambda[  16] =   3.07141226380949
lambda[  17] =   3.08495967080583
lambda[  18] =   3.12509247948084
lambda[  19] =   3.14139533023657
lambda[  20] =   3.16778075131962
lambda[  21] =   3.18638788002836
lambda[  22] =   3.21614774291132
lambda[  23] =   3.26441294392546
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.881 ms
rank =  0, subspace rotation using ScaLAPACK took 10.574 ms
rank =  0, Distributing orbital back into band + domain format took 22.587 ms
rank = 0, Subspace_Rotation used 33.180 ms

Total time for subspace rotation: 33.185 ms
rank = 0, Efermi =   3.064069712577 calculate fermi energy took 0.065 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.364413, lowerbound = -1.002600, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1799.170 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.016 ms
rank =  0, Distribute orbital to block cyclic format took 24.936 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.439 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 28.396 ms
rank =  0, finding HY took 30.120 ms
rank =  0, distributing HY into block cyclic form took 22.043 ms
rank =  0, finding Y'*HY took 5.754 ms
Rank 0, Project_Hamiltonian used 86.365 ms
Total time for projection: 86.371 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.147 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.738692898682354
    last  calculated eigval = 0.435880103579998
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.19403579130145
lambda[   7] =  -0.18242085769061
lambda[   8] =  -0.04037800128620
lambda[   9] =  -0.00332377934604
lambda[  10] =   0.03964608837465
lambda[  11] =   0.06861735064516
lambda[  12] =   0.13135625834335
lambda[  13] =   0.23145613129235
lambda[  14] =   0.24466135891029
lambda[  15] =   0.26676836108348
lambda[  16] =   0.30167756824996
lambda[  17] =   0.33941583183529
lambda[  18] =   0.35018974710998
lambda[  19] =   0.35487191986676
lambda[  20] =   0.38097291261630
lambda[  21] =   0.39815400894414
lambda[  22] =   0.41728109848926
lambda[  23] =   0.43588010358000
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 10.521 ms
rank =  0, Distributing orbital back into band + domain format took 22.466 ms
rank = 0, Subspace_Rotation used 33.006 ms

Total time for subspace rotation: 33.012 ms
rank = 0, Efermi =   0.284223009066 calculate fermi energy took 0.028 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.535880, lowerbound = -1.002600, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1794.912 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 28.100 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.635 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 31.760 ms
rank =  0, finding HY took 29.607 ms
rank =  0, distributing HY into block cyclic form took 22.070 ms
rank =  0, finding Y'*HY took 5.778 ms
Rank 0, Project_Hamiltonian used 89.249 ms
Total time for projection: 89.255 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.913466399644849
    last  calculated eigval = 0.155089200937336
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54334134042378
lambda[   7] =  -0.51995716717284
lambda[   8] =  -0.45954441000532
lambda[   9] =  -0.43320823966488
lambda[  10] =  -0.40980563674208
lambda[  11] =  -0.40649991988282
lambda[  12] =  -0.38850179504991
lambda[  13] =  -0.37441469198622
lambda[  14] =  -0.35703922765496
lambda[  15] =  -0.21853279025171
lambda[  16] =   0.04286610130210
lambda[  17] =   0.05957980018916
lambda[  18] =   0.06944641587860
lambda[  19] =   0.09084643299549
lambda[  20] =   0.10215975069133
lambda[  21] =   0.11824393594354
lambda[  22] =   0.13042702593269
lambda[  23] =   0.15508920093734
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 10.535 ms
rank =  0, Distributing orbital back into band + domain format took 22.527 ms
rank = 0, Subspace_Rotation used 33.084 ms

Total time for subspace rotation: 33.089 ms
rank = 0, Efermi =   0.014505730586 calculate fermi energy took 0.035 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.255089, lowerbound = -1.002600, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1796.772 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 24.749 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 28.199 ms
rank =  0, finding HY took 32.080 ms
rank =  0, distributing HY into block cyclic form took 22.218 ms
rank =  0, finding Y'*HY took 5.759 ms
Rank 0, Project_Hamiltonian used 88.300 ms
Total time for projection: 88.311 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.231 ms
    first calculated eigval = -0.913802048291422
    last  calculated eigval = 0.088383314036022
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54671620303912
lambda[   7] =  -0.52314393414470
lambda[   8] =  -0.47386333019827
lambda[   9] =  -0.44396358424810
lambda[  10] =  -0.41739749142464
lambda[  11] =  -0.41655285400874
lambda[  12] =  -0.40510200474654
lambda[  13] =  -0.39930399380528
lambda[  14] =  -0.37564518085760
lambda[  15] =  -0.26350840369841
lambda[  16] =  -0.00423173561762
lambda[  17] =   0.01604559642454
lambda[  18] =   0.02942753282715
lambda[  19] =   0.04728180912844
lambda[  20] =   0.05906645307805
lambda[  21] =   0.06236370821468
lambda[  22] =   0.07653047389173
lambda[  23] =   0.08838331403602
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 10.551 ms
rank =  0, Distributing orbital back into band + domain format took 22.558 ms
rank = 0, Subspace_Rotation used 33.136 ms

Total time for subspace rotation: 33.144 ms
rank = 0, Efermi =  -0.032592106335 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 6.508 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.577 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.608 ms
rank = 0, Calculating density took 7854.917 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.925 ms
rank = 0, D2D took 2.028 ms
rank = 0, Transfering density took 2.036 ms
Etot    =   -39.959785146228
Eband   =   -15.922668793713
E1      =    33.404355746870
E2      =   -11.746952017319
E3      =   -16.056956884228
Exc     =   -14.188125680803
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 2.854e+00, dEband = 1.137e+00
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -39.959785146, dEtot = 2.854e+00, dEband = 1.137e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 55.0589709210710, which took 0.051 ms

iter_count = 96, r_2norm = 1.917e-03, tol*||rhs|| = 2.202e-03

Anderson update took 57.409 ms, out of which F'*F took 27.164 ms; b-Ax took 183.108 ms, out of which Lap took 163.826 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.200 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844662, int_b + int_rho = -1.237e-13, checking this took 0.158 ms
2-norm of RHS = 873.9096686557958, which took 1.004 ms

iter_count = 282, r_2norm = 8.732e-04, tol*||rhs|| = 8.739e-04

Anderson update took 166.959 ms, out of which F'*F took 78.908 ms; b-Ax took 533.836 ms, out of which Lap took 479.020 ms
Solving Poisson took 1171.849 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.406 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.193223 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.163314 
Total time for convolution: 	 convolve: 5.143131 
Total time for convolution: 	 convolve: 5.152407 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.751 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.180 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 3.539 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.085 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.657 ms

This SCF took 34067.126 ms, scf error = 1.972e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.188383, lowerbound = -0.913802, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1783.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 46.005 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.345 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 49.379 ms
rank =  0, finding HY took 29.490 ms
rank =  0, distributing HY into block cyclic form took 22.995 ms
rank =  0, finding Y'*HY took 6.077 ms
Rank 0, Project_Hamiltonian used 107.980 ms
Total time for projection: 108.005 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.139 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.890709358331551
    last  calculated eigval = 0.068887955979206
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52237352831259
lambda[   7] =  -0.49781089298226
lambda[   8] =  -0.44879746827550
lambda[   9] =  -0.41789057471549
lambda[  10] =  -0.39182452447419
lambda[  11] =  -0.39019808438125
lambda[  12] =  -0.37472541179930
lambda[  13] =  -0.37131847455932
lambda[  14] =  -0.34911562772103
lambda[  15] =  -0.23947577794444
lambda[  16] =  -0.02658012074384
lambda[  17] =   0.00214314232616
lambda[  18] =   0.01323193536483
lambda[  19] =   0.02367367743288
lambda[  20] =   0.03113704457349
lambda[  21] =   0.04248606331435
lambda[  22] =   0.05295626741302
lambda[  23] =   0.06888795597921
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 11.238 ms
rank =  0, Distributing orbital back into band + domain format took 22.482 ms
rank = 0, Subspace_Rotation used 33.742 ms

Total time for subspace rotation: 33.751 ms
rank = 0, Efermi =  -0.054940491450 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 6.363 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.617 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1945.886 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.016 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.965 ms
rank = 0, D2D took 2.089 ms
rank = 0, Transfering density took 2.097 ms
Etot    =   -39.897600076562
Eband   =   -15.122439121714
E1      =    32.667822909532
E2      =   -11.705382325630
E3      =   -16.279851523570
Exc     =   -14.370962393452
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 4.442e-03, dEband = 5.716e-02
rank = 0, Calculating/Estimating energy took 0.995 ms, Etot = -39.897600077, dEtot = 4.442e-03, dEband = 5.716e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 14.2648353335259, which took 0.116 ms

iter_count = 108, r_2norm = 3.439e-04, tol*||rhs|| = 5.706e-04

Anderson update took 64.735 ms, out of which F'*F took 31.035 ms; b-Ax took 209.607 ms, out of which Lap took 188.044 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.283 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844655, int_b + int_rho = -1.892e-13, checking this took 0.172 ms
2-norm of RHS = 864.9942970570881, which took 0.140 ms

iter_count = 306, r_2norm = 7.371e-04, tol*||rhs|| = 8.650e-04

Anderson update took 186.751 ms, out of which F'*F took 85.960 ms; b-Ax took 591.694 ms, out of which Lap took 534.464 ms
Solving Poisson took 1292.780 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.149822 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.150710 
Total time for convolution: 	 convolve: 5.160638 
Total time for convolution: 	 convolve: 5.139601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.552 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.001 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.087 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.671 ms

This SCF took 28311.524 ms, scf error = 1.390e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.168888, lowerbound = -0.890709, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1767.880 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 55.687 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.932 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 59.648 ms
rank =  0, finding HY took 29.628 ms
rank =  0, distributing HY into block cyclic form took 22.041 ms
rank =  0, finding Y'*HY took 6.313 ms
Rank 0, Project_Hamiltonian used 117.670 ms
Total time for projection: 117.692 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.137 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.733 ms
rank = 0, Solve_Generalized_EigenProblem used 1.684 ms
    first calculated eigval = -0.843436327317451
    last  calculated eigval = 0.062429229233513
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47099801188469
lambda[   7] =  -0.44302213121740
lambda[   8] =  -0.39384060094443
lambda[   9] =  -0.36145639790828
lambda[  10] =  -0.33802169041346
lambda[  11] =  -0.33591973176882
lambda[  12] =  -0.31156011624493
lambda[  13] =  -0.31084364616352
lambda[  14] =  -0.29009255102121
lambda[  15] =  -0.18871678240778
lambda[  16] =  -0.03075214454252
lambda[  17] =   0.00295829068367
lambda[  18] =   0.01061371293003
lambda[  19] =   0.01824625254122
lambda[  20] =   0.02003148323766
lambda[  21] =   0.03612740484518
lambda[  22] =   0.04821199703517
lambda[  23] =   0.06242922923351
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 1.698 ms
rank =  0, subspace rotation using ScaLAPACK took 10.612 ms
rank =  0, Distributing orbital back into band + domain format took 22.348 ms
rank = 0, Subspace_Rotation used 32.983 ms

Total time for subspace rotation: 32.990 ms
rank = 0, Efermi =  -0.059112515275 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 6.597 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.579 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1940.184 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.996 ms
rank = 0, D2D took 2.102 ms
rank = 0, Transfering density took 2.110 ms
Etot    =   -39.834419491021
Eband   =   -13.422437009442
E1      =    31.180008092436
E2      =   -11.454744945711
E3      =   -16.832691251370
Exc     =   -14.822171450968
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 4.513e-03, dEband = 1.214e-01
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -39.834419491, dEtot = 4.513e-03, dEband = 1.214e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.5596949121648, which took 0.070 ms

iter_count = 102, r_2norm = 2.140e-04, tol*||rhs|| = 2.224e-04

Anderson update took 61.956 ms, out of which F'*F took 28.848 ms; b-Ax took 193.846 ms, out of which Lap took 174.640 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 437.420 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844648, int_b + int_rho = -2.547e-13, checking this took 0.171 ms
2-norm of RHS = 865.7600721712832, which took 0.100 ms

iter_count = 264, r_2norm = 7.600e-04, tol*||rhs|| = 8.658e-04

Anderson update took 156.190 ms, out of which F'*F took 76.490 ms; b-Ax took 502.868 ms, out of which Lap took 453.905 ms
Solving Poisson took 1106.773 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.155335 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 11.935 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.127 ms
Total time for convolution: 	 convolve: 5.164795 
Total time for convolution: 	 convolve: 5.178731 
Total time for convolution: 	 convolve: 5.155033 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.465 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 3.529 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.096 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.654 ms

This SCF took 28160.419 ms, scf error = 3.796e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.162429, lowerbound = -0.843436, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1777.235 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 54.373 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.630 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.631 ms
rank =  0, finding HY took 29.082 ms
rank =  0, distributing HY into block cyclic form took 22.232 ms
rank =  0, finding Y'*HY took 5.467 ms
Rank 0, Project_Hamiltonian used 115.455 ms
Total time for projection: 115.481 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.223 ms
    first calculated eigval = -0.841368282260300
    last  calculated eigval = 0.052522763824194
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46632168371803
lambda[   7] =  -0.43596493150474
lambda[   8] =  -0.38758368764203
lambda[   9] =  -0.35470484697826
lambda[  10] =  -0.33291472349243
lambda[  11] =  -0.33230137188623
lambda[  12] =  -0.30615130923352
lambda[  13] =  -0.30562072730619
lambda[  14] =  -0.28169723826614
lambda[  15] =  -0.18836659709808
lambda[  16] =  -0.03192723148375
lambda[  17] =   0.00312796665029
lambda[  18] =   0.00938947345078
lambda[  19] =   0.01446353020345
lambda[  20] =   0.01617467838769
lambda[  21] =   0.02865782584662
lambda[  22] =   0.04413171783067
lambda[  23] =   0.05252276382419
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.240 ms
rank =  0, subspace rotation using ScaLAPACK took 10.536 ms
rank =  0, Distributing orbital back into band + domain format took 22.445 ms
rank = 0, Subspace_Rotation used 33.003 ms

Total time for subspace rotation: 33.011 ms
rank = 0, Efermi =  -0.060287602196 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 6.599 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.172 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.061 ms
rank = 0, Calculating density took 1946.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.017 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.210 ms
rank = 0, D2D took 2.322 ms
rank = 0, Transfering density took 2.330 ms
Etot    =   -39.830885115630
Eband   =   -13.269527754312
E1      =    31.131416398378
E2      =   -11.336864050366
E3      =   -16.892490198808
Exc     =   -14.864872688741
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 2.525e-04, dEband = 1.092e-02
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -39.830885116, dEtot = 2.525e-04, dEband = 1.092e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9307511199333, which took 0.078 ms

iter_count = 108, r_2norm = 7.620e-05, tol*||rhs|| = 7.723e-05

Anderson update took 68.861 ms, out of which F'*F took 31.240 ms; b-Ax took 203.665 ms, out of which Lap took 184.241 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.429 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844653, int_b + int_rho = -2.110e-13, checking this took 0.118 ms
2-norm of RHS = 865.7111867936406, which took 0.173 ms

iter_count = 252, r_2norm = 7.445e-04, tol*||rhs|| = 8.657e-04

Anderson update took 150.854 ms, out of which F'*F took 70.586 ms; b-Ax took 475.875 ms, out of which Lap took 426.228 ms
Solving Poisson took 1052.554 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.283 ms
Total time for convolution: 	 convolve: 5.157338 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.355 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.158151 
Total time for convolution: 	 convolve: 5.161526 
Total time for convolution: 	 convolve: 5.162664 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.395 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.339 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.603 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.378 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.017 ms

This SCF took 28108.194 ms, scf error = 1.242e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.152523, lowerbound = -0.841368, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1771.805 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 51.901 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.670 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 55.597 ms
rank =  0, finding HY took 28.898 ms
rank =  0, distributing HY into block cyclic form took 22.290 ms
rank =  0, finding Y'*HY took 5.572 ms
Rank 0, Project_Hamiltonian used 112.410 ms
Total time for projection: 112.436 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.132 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.237 ms
    first calculated eigval = -0.835887959944979
    last  calculated eigval = 0.049185240320784
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46073812537170
lambda[   7] =  -0.42997972054476
lambda[   8] =  -0.38177024798422
lambda[   9] =  -0.34863842695786
lambda[  10] =  -0.32721019657600
lambda[  11] =  -0.32663326370190
lambda[  12] =  -0.30007219917113
lambda[  13] =  -0.29969441038739
lambda[  14] =  -0.27530640411823
lambda[  15] =  -0.18314838957980
lambda[  16] =  -0.03199172127496
lambda[  17] =   0.00348888150172
lambda[  18] =   0.00905600525233
lambda[  19] =   0.01254189975640
lambda[  20] =   0.01473099090409
lambda[  21] =   0.02457555238103
lambda[  22] =   0.04145542931731
lambda[  23] =   0.04918524032078
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.253 ms
rank =  0, subspace rotation using ScaLAPACK took 10.546 ms
rank =  0, Distributing orbital back into band + domain format took 22.365 ms
rank = 0, Subspace_Rotation used 32.930 ms

Total time for subspace rotation: 32.936 ms
rank = 0, Efermi =  -0.060352091998 calculate fermi energy took 1.220 ms
rank = 0, --- Calculate rho: sum over local bands took 6.777 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.931 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1938.074 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.908 ms
rank = 0, D2D took 2.015 ms
rank = 0, Transfering density took 2.022 ms
Etot    =   -39.829571131060
Eband   =   -13.093123617515
E1      =    31.020651354538
E2      =   -11.259942468670
E3      =   -16.945371497899
Exc     =   -14.905157514523
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 9.386e-05, dEband = 1.260e-02
rank = 0, Calculating/Estimating energy took 1.007 ms, Etot = -39.829571131, dEtot = 9.386e-05, dEband = 1.260e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.7826490824204, which took 0.073 ms

iter_count = 114, r_2norm = 2.130e-05, tol*||rhs|| = 3.131e-05

Anderson update took 69.839 ms, out of which F'*F took 33.566 ms; b-Ax took 224.404 ms, out of which Lap took 201.047 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 489.191 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844646, int_b + int_rho = -2.838e-13, checking this took 0.117 ms
2-norm of RHS = 866.0820378612667, which took 0.149 ms

iter_count = 246, r_2norm = 7.374e-04, tol*||rhs|| = 8.661e-04

Anderson update took 150.522 ms, out of which F'*F took 69.123 ms; b-Ax took 471.517 ms, out of which Lap took 421.297 ms
Solving Poisson took 1033.401 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.323 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.144627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.151543 
Total time for convolution: 	 convolve: 5.153006 
Total time for convolution: 	 convolve: 5.156476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.378 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.006 ms
---Transfer Veff_loc: D2D took 4.280 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.879 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.193 ms

This SCF took 28207.458 ms, scf error = 6.515e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149185, lowerbound = -0.835888, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1776.718 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 50.792 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.512 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 54.329 ms
rank =  0, finding HY took 28.930 ms
rank =  0, distributing HY into block cyclic form took 22.028 ms
rank =  0, finding Y'*HY took 5.694 ms
Rank 0, Project_Hamiltonian used 111.023 ms
Total time for projection: 111.051 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.240 ms
    first calculated eigval = -0.830781154041268
    last  calculated eigval = 0.048348589162291
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45640383398880
lambda[   7] =  -0.42571962032372
lambda[   8] =  -0.37763292589627
lambda[   9] =  -0.34435400699583
lambda[  10] =  -0.32297675864927
lambda[  11] =  -0.32205345708527
lambda[  12] =  -0.29553281615616
lambda[  13] =  -0.29543052019406
lambda[  14] =  -0.27112680135509
lambda[  15] =  -0.17848614494262
lambda[  16] =  -0.03156718931516
lambda[  17] =   0.00401479098634
lambda[  18] =   0.00902416734864
lambda[  19] =   0.01232579306248
lambda[  20] =   0.01436195862751
lambda[  21] =   0.02341698503052
lambda[  22] =   0.03908528522166
lambda[  23] =   0.04834858916229
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 10.592 ms
rank =  0, Distributing orbital back into band + domain format took 22.433 ms
rank = 0, Subspace_Rotation used 33.045 ms

Total time for subspace rotation: 33.050 ms
rank = 0, Efermi =  -0.059927560021 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 6.751 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.301 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1940.886 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.946 ms
rank = 0, D2D took 2.056 ms
rank = 0, Transfering density took 2.061 ms
Etot    =   -39.828956859451
Eband   =   -12.960658845614
E1      =    30.958081072037
E2      =   -11.183890603706
E3      =   -16.967165210358
Exc     =   -14.920179579809
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 4.388e-05, dEband = 9.462e-03
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -39.828956859, dEtot = 4.388e-05, dEband = 9.462e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3525774537617, which took 0.086 ms

iter_count = 114, r_2norm = 1.014e-05, tol*||rhs|| = 1.410e-05

Anderson update took 66.507 ms, out of which F'*F took 33.172 ms; b-Ax took 216.613 ms, out of which Lap took 192.581 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.969 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844650, int_b + int_rho = -2.401e-13, checking this took 0.122 ms
2-norm of RHS = 866.3173038881771, which took 0.168 ms

iter_count = 240, r_2norm = 8.121e-04, tol*||rhs|| = 8.663e-04

Anderson update took 141.664 ms, out of which F'*F took 66.813 ms; b-Ax took 453.589 ms, out of which Lap took 405.035 ms
Solving Poisson took 1010.001 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.181907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.172785 
Total time for convolution: 	 convolve: 5.164781 
Total time for convolution: 	 convolve: 5.165832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.621 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.177 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.072 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.576 ms

This SCF took 28124.224 ms, scf error = 3.427e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.148349, lowerbound = -0.830781, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1767.987 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 57.932 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.572 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.526 ms
rank =  0, finding HY took 28.996 ms
rank =  0, distributing HY into block cyclic form took 22.054 ms
rank =  0, finding Y'*HY took 5.691 ms
Rank 0, Project_Hamiltonian used 118.309 ms
Total time for projection: 118.330 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.079 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.826301937868627
    last  calculated eigval = 0.049546802161698
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45201771463042
lambda[   7] =  -0.42092757224555
lambda[   8] =  -0.37304380968827
lambda[   9] =  -0.33963658824508
lambda[  10] =  -0.31849716933001
lambda[  11] =  -0.31742453332108
lambda[  12] =  -0.29038038179206
lambda[  13] =  -0.29028400830020
lambda[  14] =  -0.26631686219870
lambda[  15] =  -0.17457144322414
lambda[  16] =  -0.03033766702813
lambda[  17] =   0.00513590790334
lambda[  18] =   0.00959585769197
lambda[  19] =   0.01372720417614
lambda[  20] =   0.01586313829840
lambda[  21] =   0.02410317858979
lambda[  22] =   0.03828663094164
lambda[  23] =   0.04954680216170
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 10.553 ms
rank =  0, Distributing orbital back into band + domain format took 22.387 ms
rank = 0, Subspace_Rotation used 32.962 ms

Total time for subspace rotation: 32.968 ms
rank = 0, Efermi =  -0.058698037754 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 6.672 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.390 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 1939.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.920 ms
rank = 0, D2D took 2.027 ms
rank = 0, Transfering density took 2.033 ms
Etot    =   -39.828628986105
Eband   =   -12.819093955427
E1      =    30.886596038420
E2      =   -11.108289852909
E3      =   -16.987305220214
Exc     =   -14.934470822093
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 2.342e-05, dEband = 1.011e-02
rank = 0, Calculating/Estimating energy took 1.386 ms, Etot = -39.828628986, dEtot = 2.342e-05, dEband = 1.011e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2681095406179, which took 0.069 ms

iter_count = 114, r_2norm = 7.092e-06, tol*||rhs|| = 1.072e-05

Anderson update took 66.485 ms, out of which F'*F took 32.818 ms; b-Ax took 218.001 ms, out of which Lap took 194.052 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 483.124 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844659, int_b + int_rho = -1.455e-13, checking this took 0.182 ms
2-norm of RHS = 866.3400481155453, which took 0.174 ms

iter_count = 222, r_2norm = 6.923e-04, tol*||rhs|| = 8.663e-04

Anderson update took 130.281 ms, out of which F'*F took 62.098 ms; b-Ax took 427.820 ms, out of which Lap took 381.283 ms
Solving Poisson took 930.424 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.188122 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.191744 
Total time for convolution: 	 convolve: 5.165502 
Total time for convolution: 	 convolve: 5.156603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.733 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.139 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
---Transfer Veff_loc: D2D took 3.491 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.093 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.621 ms

This SCF took 28051.854 ms, scf error = 1.767e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.149547, lowerbound = -0.826302, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1771.104 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 54.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.530 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 57.612 ms
rank =  0, finding HY took 29.118 ms
rank =  0, distributing HY into block cyclic form took 22.172 ms
rank =  0, finding Y'*HY took 5.454 ms
Rank 0, Project_Hamiltonian used 114.398 ms
Total time for projection: 114.426 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.824642032292043
    last  calculated eigval = 0.051718040311047
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45039717111658
lambda[   7] =  -0.41923493430034
lambda[   8] =  -0.37139212823851
lambda[   9] =  -0.33792529585637
lambda[  10] =  -0.31683372224597
lambda[  11] =  -0.31576545123606
lambda[  12] =  -0.28871652128379
lambda[  13] =  -0.28855094784443
lambda[  14] =  -0.26459491933184
lambda[  15] =  -0.17285021034000
lambda[  16] =  -0.02864289070939
lambda[  17] =   0.00695325328309
lambda[  18] =   0.01111260547379
lambda[  19] =   0.01588110174171
lambda[  20] =   0.01806485426252
lambda[  21] =   0.02520809209839
lambda[  22] =   0.03855805723178
lambda[  23] =   0.05171804031105
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 10.715 ms
rank =  0, Distributing orbital back into band + domain format took 22.505 ms
rank = 0, Subspace_Rotation used 33.247 ms

Total time for subspace rotation: 33.254 ms
rank = 0, Efermi =  -0.057003261443 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 6.787 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.312 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.588 ms
rank = 0, Calculating density took 1938.889 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 3.150 ms
rank = 0, D2D took 3.258 ms
rank = 0, Transfering density took 3.265 ms
Etot    =   -39.828568002935
Eband   =   -12.768363078280
E1      =    30.863834778477
E2      =   -11.079854862005
E3      =   -16.988533130435
Exc     =   -14.935172375444
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 4.356e-06, dEband = 3.624e-03
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -39.828568003, dEtot = 4.356e-06, dEband = 3.624e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1154776393179, which took 0.065 ms

iter_count = 114, r_2norm = 3.452e-06, tol*||rhs|| = 4.619e-06

Anderson update took 66.942 ms, out of which F'*F took 31.813 ms; b-Ax took 218.169 ms, out of which Lap took 194.708 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.270 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844647, int_b + int_rho = -2.728e-13, checking this took 0.172 ms
2-norm of RHS = 866.2896365183359, which took 0.137 ms

iter_count = 216, r_2norm = 7.841e-04, tol*||rhs|| = 8.663e-04

Anderson update took 126.221 ms, out of which F'*F took 60.977 ms; b-Ax took 415.224 ms, out of which Lap took 368.382 ms
Solving Poisson took 903.554 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.162705 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.163993 
Total time for convolution: 	 convolve: 5.181572 
Total time for convolution: 	 convolve: 5.156976 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.537 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.401 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.141 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.463 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.890 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.387 ms

This SCF took 27976.746 ms, scf error = 1.210e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.151718, lowerbound = -0.824642, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1765.877 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 56.170 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.599 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 59.788 ms
rank =  0, finding HY took 29.029 ms
rank =  0, distributing HY into block cyclic form took 22.222 ms
rank =  0, finding Y'*HY took 5.486 ms
Rank 0, Project_Hamiltonian used 116.558 ms
Total time for projection: 116.581 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.130 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.822827767521338
    last  calculated eigval = 0.055358048515450
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44847802297186
lambda[   7] =  -0.41714605264031
lambda[   8] =  -0.36936510327401
lambda[   9] =  -0.33581841426021
lambda[  10] =  -0.31484413557806
lambda[  11] =  -0.31382983899046
lambda[  12] =  -0.28665540487750
lambda[  13] =  -0.28645221340359
lambda[  14] =  -0.26240098659598
lambda[  15] =  -0.17101420658257
lambda[  16] =  -0.02581554818604
lambda[  17] =   0.01043609576721
lambda[  18] =   0.01442896340659
lambda[  19] =   0.01916556608137
lambda[  20] =   0.02145355531574
lambda[  21] =   0.02735400805226
lambda[  22] =   0.03803497707367
lambda[  23] =   0.05535804851545
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.244 ms
rank =  0, subspace rotation using ScaLAPACK took 10.558 ms
rank =  0, Distributing orbital back into band + domain format took 22.375 ms
rank = 0, Subspace_Rotation used 33.434 ms

Total time for subspace rotation: 33.441 ms
rank = 0, Efermi =  -0.054175918895 calculate fermi energy took 0.607 ms
rank = 0, --- Calculate rho: sum over local bands took 7.112 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.641 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.592 ms
rank = 0, Calculating density took 1936.176 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.919 ms
rank = 0, D2D took 2.022 ms
rank = 0, Transfering density took 2.028 ms
Etot    =   -39.828514841406
Eband   =   -12.707535601041
E1      =    30.831079747255
E2      =   -11.050189788399
E3      =   -16.995917319744
Exc     =   -14.940910775635
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 3.797e-06, dEband = 4.345e-03
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -39.828514841, dEtot = 3.797e-06, dEband = 4.345e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0618540791862, which took 0.082 ms

iter_count = 114, r_2norm = 1.869e-06, tol*||rhs|| = 2.474e-06

Anderson update took 66.421 ms, out of which F'*F took 31.556 ms; b-Ax took 215.977 ms, out of which Lap took 191.552 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.922 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844647, int_b + int_rho = -2.692e-13, checking this took 0.129 ms
2-norm of RHS = 866.3074133883301, which took 0.183 ms

iter_count = 204, r_2norm = 7.566e-04, tol*||rhs|| = 8.663e-04

Anderson update took 120.425 ms, out of which F'*F took 56.516 ms; b-Ax took 386.814 ms, out of which Lap took 343.959 ms
Solving Poisson took 851.691 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.158688 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.762 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.154558 
Total time for convolution: 	 convolve: 5.160592 
Total time for convolution: 	 convolve: 5.158586 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.892 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.590 ms

This SCF took 27923.252 ms, scf error = 6.780e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.155358, lowerbound = -0.822828, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1772.185 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 52.418 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.471 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 55.911 ms
rank =  0, finding HY took 29.018 ms
rank =  0, distributing HY into block cyclic form took 22.030 ms
rank =  0, finding Y'*HY took 5.605 ms
Rank 0, Project_Hamiltonian used 112.598 ms
Total time for projection: 112.619 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.082 ms
rank = 0, Solve_Generalized_EigenProblem used 0.216 ms
    first calculated eigval = -0.821342807698689
    last  calculated eigval = 0.058391202987370
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44712640033409
lambda[   7] =  -0.41576869798469
lambda[   8] =  -0.36803112132384
lambda[   9] =  -0.33446079218858
lambda[  10] =  -0.31351511022139
lambda[  11] =  -0.31242822040385
lambda[  12] =  -0.28526834113670
lambda[  13] =  -0.28503208475850
lambda[  14] =  -0.26107381129324
lambda[  15] =  -0.16967716376853
lambda[  16] =  -0.02200032626502
lambda[  17] =   0.01470391396847
lambda[  18] =   0.01941407791513
lambda[  19] =   0.02325312854372
lambda[  20] =   0.02465557311808
lambda[  21] =   0.03042434255185
lambda[  22] =   0.03688893657479
lambda[  23] =   0.05839120298737
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.241 ms
rank =  0, subspace rotation using ScaLAPACK took 10.598 ms
rank =  0, Distributing orbital back into band + domain format took 22.386 ms
rank = 0, Subspace_Rotation used 32.998 ms

Total time for subspace rotation: 33.003 ms
rank = 0, Efermi =  -0.050360696990 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.800 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.230 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.591 ms
rank = 0, Calculating density took 1937.828 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.935 ms
rank = 0, D2D took 2.037 ms
rank = 0, Transfering density took 2.042 ms
Etot    =   -39.828584975841
Eband   =   -12.666398587998
E1      =    30.810922830891
E2      =   -11.028781401520
E3      =   -16.997948358157
Exc     =   -14.942583658283
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 5.010e-06, dEband = 2.938e-03
rank = 0, Calculating/Estimating energy took 0.983 ms, Etot = -39.828584976, dEtot = 5.010e-06, dEband = 2.938e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0565706980004, which took 0.057 ms

iter_count = 114, r_2norm = 1.429e-06, tol*||rhs|| = 2.263e-06

Anderson update took 67.140 ms, out of which F'*F took 32.172 ms; b-Ax took 217.916 ms, out of which Lap took 194.736 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.480 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844656, int_b + int_rho = -1.746e-13, checking this took 0.157 ms
2-norm of RHS = 866.3175826079927, which took 0.144 ms

iter_count = 162, r_2norm = 8.184e-04, tol*||rhs|| = 8.663e-04

Anderson update took 94.490 ms, out of which F'*F took 45.974 ms; b-Ax took 312.978 ms, out of which Lap took 278.363 ms
Solving Poisson took 678.620 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.159377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.156372 
Total time for convolution: 	 convolve: 5.169675 
Total time for convolution: 	 convolve: 5.156883 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.637 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.427 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.873 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.334 ms

This SCF took 27736.162 ms, scf error = 3.675e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.158391, lowerbound = -0.821343, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1771.294 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 53.419 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.787 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 57.229 ms
rank =  0, finding HY took 29.004 ms
rank =  0, distributing HY into block cyclic form took 22.286 ms
rank =  0, finding Y'*HY took 5.487 ms
Rank 0, Project_Hamiltonian used 114.041 ms
Total time for projection: 114.068 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.821122194389859
    last  calculated eigval = 0.058326067255035
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44688015698848
lambda[   7] =  -0.41549543536556
lambda[   8] =  -0.36776247665028
lambda[   9] =  -0.33419625530528
lambda[  10] =  -0.31325948667285
lambda[  11] =  -0.31219964341966
lambda[  12] =  -0.28501735816000
lambda[  13] =  -0.28479175367451
lambda[  14] =  -0.26079876189043
lambda[  15] =  -0.16946221315137
lambda[  16] =  -0.02120583807583
lambda[  17] =   0.01505650538263
lambda[  18] =   0.02069299709277
lambda[  19] =   0.02405516758411
lambda[  20] =   0.02473915040340
lambda[  21] =   0.03028900688349
lambda[  22] =   0.03602728126790
lambda[  23] =   0.05832606725503
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 10.556 ms
rank =  0, Distributing orbital back into band + domain format took 22.352 ms
rank = 0, Subspace_Rotation used 32.921 ms

Total time for subspace rotation: 32.928 ms
rank = 0, Efermi =  -0.049566208783 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.662 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.515 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 1938.833 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.933 ms
rank = 0, D2D took 2.060 ms
rank = 0, Transfering density took 2.067 ms
Etot    =   -39.828676155295
Eband   =   -12.658881828533
E1      =    30.807666908261
E2      =   -11.024365254712
E3      =   -16.998319417781
Exc     =   -14.942890587388
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 6.513e-06, dEband = 5.369e-04
rank = 0, Calculating/Estimating energy took 0.993 ms, Etot = -39.828676155, dEtot = 6.513e-06, dEband = 5.369e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0418158113081, which took 0.091 ms

iter_count = 114, r_2norm = 1.119e-06, tol*||rhs|| = 1.673e-06

Anderson update took 66.549 ms, out of which F'*F took 31.588 ms; b-Ax took 215.377 ms, out of which Lap took 190.861 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 484.482 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844649, int_b + int_rho = -2.474e-13, checking this took 0.159 ms
2-norm of RHS = 866.3253937605494, which took 0.192 ms

iter_count = 156, r_2norm = 8.566e-04, tol*||rhs|| = 8.663e-04

Anderson update took 92.232 ms, out of which F'*F took 43.333 ms; b-Ax took 296.159 ms, out of which Lap took 263.241 ms
Solving Poisson took 652.306 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.150115 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.904 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.158985 
Total time for convolution: 	 convolve: 5.155768 
Total time for convolution: 	 convolve: 5.164519 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.449 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.884 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.367 ms

This SCF took 27678.000 ms, scf error = 2.679e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.158326, lowerbound = -0.821122, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1774.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 55.296 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.603 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.918 ms
rank =  0, finding HY took 28.864 ms
rank =  0, distributing HY into block cyclic form took 22.181 ms
rank =  0, finding Y'*HY took 5.589 ms
Rank 0, Project_Hamiltonian used 115.963 ms
Total time for projection: 115.981 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.617 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.713 ms
    first calculated eigval = -0.820906309491249
    last  calculated eigval = 0.058945670005345
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44665158676857
lambda[   7] =  -0.41525364206090
lambda[   8] =  -0.36752227399724
lambda[   9] =  -0.33395612498100
lambda[  10] =  -0.31302404331653
lambda[  11] =  -0.31197934174182
lambda[  12] =  -0.28479555023020
lambda[  13] =  -0.28456217155083
lambda[  14] =  -0.26055738896877
lambda[  15] =  -0.16922005426056
lambda[  16] =  -0.01918618415000
lambda[  17] =   0.01626264800802
lambda[  18] =   0.02319855831173
lambda[  19] =   0.02579824322534
lambda[  20] =   0.02613068946931
lambda[  21] =   0.03142002846903
lambda[  22] =   0.03670555712571
lambda[  23] =   0.05894567000534
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.727 ms
rank =  0, subspace rotation using ScaLAPACK took 11.082 ms
rank =  0, Distributing orbital back into band + domain format took 22.366 ms
rank = 0, Subspace_Rotation used 33.464 ms

Total time for subspace rotation: 33.471 ms
rank = 0, Efermi =  -0.047546554883 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 6.702 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.355 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1944.809 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.910 ms
rank = 0, D2D took 2.012 ms
rank = 0, Transfering density took 2.015 ms
Etot    =   -39.828729179350
Eband   =   -12.651870672207
E1      =    30.804439977370
E2      =   -11.020512643327
E3      =   -16.998552079337
Exc     =   -14.943107887049
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 3.787e-06, dEband = 5.008e-04
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -39.828729179, dEtot = 3.787e-06, dEband = 5.008e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0307210101479, which took 0.084 ms

iter_count = 114, r_2norm = 7.652e-07, tol*||rhs|| = 1.229e-06

Anderson update took 67.328 ms, out of which F'*F took 31.660 ms; b-Ax took 217.060 ms, out of which Lap took 193.630 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.568 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844649, int_b + int_rho = -2.474e-13, checking this took 0.124 ms
2-norm of RHS = 866.3261392831748, which took 0.152 ms

iter_count = 138, r_2norm = 7.515e-04, tol*||rhs|| = 8.663e-04

Anderson update took 80.647 ms, out of which F'*F took 38.775 ms; b-Ax took 265.979 ms, out of which Lap took 235.774 ms
Solving Poisson took 577.913 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.172491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.155727 
Total time for convolution: 	 convolve: 5.171276 
Total time for convolution: 	 convolve: 5.162021 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.453 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.868 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.354 ms

This SCF took 27635.366 ms, scf error = 2.075e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.158946, lowerbound = -0.820906, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1775.742 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 51.462 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 55.026 ms
rank =  0, finding HY took 29.133 ms
rank =  0, distributing HY into block cyclic form took 22.056 ms
rank =  0, finding Y'*HY took 5.579 ms
Rank 0, Project_Hamiltonian used 112.329 ms
Total time for projection: 112.348 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.138 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.820741035721181
    last  calculated eigval = 0.059191383775670
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44648379604869
lambda[   7] =  -0.41507739161676
lambda[   8] =  -0.36735072982442
lambda[   9] =  -0.33377692211438
lambda[  10] =  -0.31285444191266
lambda[  11] =  -0.31180574463631
lambda[  12] =  -0.28462250101051
lambda[  13] =  -0.28437320682830
lambda[  14] =  -0.26037723388658
lambda[  15] =  -0.16904271843877
lambda[  16] =  -0.01822868929539
lambda[  17] =   0.01674474239252
lambda[  18] =   0.02383197470660
lambda[  19] =   0.02644717269567
lambda[  20] =   0.02694264484781
lambda[  21] =   0.03228322847240
lambda[  22] =   0.03741845265193
lambda[  23] =   0.05919138377567
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 10.578 ms
rank =  0, Distributing orbital back into band + domain format took 22.326 ms
rank = 0, Subspace_Rotation used 32.920 ms

Total time for subspace rotation: 32.925 ms
rank = 0, Efermi =  -0.046589060022 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 6.695 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.421 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.598 ms
rank = 0, Calculating density took 1941.106 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.136 ms
rank = 0, D2D took 2.237 ms
rank = 0, Transfering density took 2.243 ms
Etot    =   -39.828753956000
Eband   =   -12.646567182317
E1      =    30.801553190329
E2      =   -11.017980142070
E3      =   -16.999051071637
Exc     =   -14.943515857591
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 1.770e-06, dEband = 3.788e-04
rank = 0, Calculating/Estimating energy took 0.982 ms, Etot = -39.828753956, dEtot = 1.770e-06, dEband = 3.788e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0296085247388, which took 0.077 ms

iter_count = 108, r_2norm = 1.090e-06, tol*||rhs|| = 1.184e-06

Anderson update took 62.790 ms, out of which F'*F took 29.989 ms; b-Ax took 204.522 ms, out of which Lap took 181.292 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 459.599 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844648, int_b + int_rho = -2.547e-13, checking this took 0.120 ms
2-norm of RHS = 866.3257977680115, which took 0.181 ms

iter_count = 132, r_2norm = 7.775e-04, tol*||rhs|| = 8.663e-04

Anderson update took 77.506 ms, out of which F'*F took 36.282 ms; b-Ax took 250.949 ms, out of which Lap took 223.309 ms
Solving Poisson took 552.777 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.156687 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.781 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.153460 
Total time for convolution: 	 convolve: 5.173391 
Total time for convolution: 	 convolve: 5.163141 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.533 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.456 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.448 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.566 ms

This SCF took 27601.334 ms, scf error = 1.419e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.159191, lowerbound = -0.820741, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1768.394 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 49.896 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.574 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 53.490 ms
rank =  0, finding HY took 29.112 ms
rank =  0, distributing HY into block cyclic form took 22.172 ms
rank =  0, finding Y'*HY took 5.514 ms
Rank 0, Project_Hamiltonian used 110.323 ms
Total time for projection: 110.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.219 ms
    first calculated eigval = -0.820667242607415
    last  calculated eigval = 0.058443726875999
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44641113630899
lambda[   7] =  -0.41500329886136
lambda[   8] =  -0.36727672214713
lambda[   9] =  -0.33370354661835
lambda[  10] =  -0.31278233706594
lambda[  11] =  -0.31173427524552
lambda[  12] =  -0.28455064293558
lambda[  13] =  -0.28430010337634
lambda[  14] =  -0.26030294084618
lambda[  15] =  -0.16898048585107
lambda[  16] =  -0.01888504019926
lambda[  17] =   0.01611822147166
lambda[  18] =   0.02229845097315
lambda[  19] =   0.02601819926988
lambda[  20] =   0.02610441232825
lambda[  21] =   0.03249523783579
lambda[  22] =   0.03763412469312
lambda[  23] =   0.05844372687600
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 10.602 ms
rank =  0, Distributing orbital back into band + domain format took 22.423 ms
rank = 0, Subspace_Rotation used 33.041 ms

Total time for subspace rotation: 33.047 ms
rank = 0, Efermi =  -0.047245410921 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 6.733 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.304 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 1931.806 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.923 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.031 ms
Etot    =   -39.828783362277
Eband   =   -12.644389000021
E1      =    30.800447205875
E2      =   -11.016873951732
E3      =   -16.999098750208
Exc     =   -14.943558949943
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 2.100e-06, dEband = 1.556e-04
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -39.828783362, dEtot = 2.100e-06, dEband = 1.556e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231198485436, which took 0.061 ms

iter_count = 114, r_2norm = 5.492e-07, tol*||rhs|| = 9.248e-07

Anderson update took 66.306 ms, out of which F'*F took 31.717 ms; b-Ax took 215.837 ms, out of which Lap took 192.189 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.267 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844643, int_b + int_rho = -3.056e-13, checking this took 0.150 ms
2-norm of RHS = 866.3234112106337, which took 0.068 ms

iter_count = 114, r_2norm = 7.303e-04, tol*||rhs|| = 8.663e-04

Anderson update took 66.030 ms, out of which F'*F took 31.743 ms; b-Ax took 219.295 ms, out of which Lap took 195.243 ms
Solving Poisson took 481.901 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.164902 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.346863 
Total time for convolution: 	 convolve: 5.160706 
Total time for convolution: 	 convolve: 5.160164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.677 ms
---Transfer Veff_loc: D2D took 3.866 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.046 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.569 ms

This SCF took 28802.207 ms, scf error = 1.106e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.158444, lowerbound = -0.820667, upperbound = 267.590681

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1768.036 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 49.154 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 52.751 ms
rank =  0, finding HY took 29.085 ms
rank =  0, distributing HY into block cyclic form took 22.415 ms
rank =  0, finding Y'*HY took 5.884 ms
Rank 0, Project_Hamiltonian used 110.169 ms
Total time for projection: 110.192 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.131 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.820596870090199
    last  calculated eigval = 0.058237432137646
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44634684695299
lambda[   7] =  -0.41494156522246
lambda[   8] =  -0.36721261506134
lambda[   9] =  -0.33364341300896
lambda[  10] =  -0.31271830261908
lambda[  11] =  -0.31167145458301
lambda[  12] =  -0.28448879063220
lambda[  13] =  -0.28424015743407
lambda[  14] =  -0.26024419810491
lambda[  15] =  -0.16892147725169
lambda[  16] =  -0.01877248046052
lambda[  17] =   0.01605178105244
lambda[  18] =   0.02198868886038
lambda[  19] =   0.02596959458428
lambda[  20] =   0.02619061163036
lambda[  21] =   0.03307075806676
lambda[  22] =   0.03849967672040
lambda[  23] =   0.05823743213765
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 10.545 ms
rank =  0, Distributing orbital back into band + domain format took 22.173 ms
rank = 0, Subspace_Rotation used 32.731 ms

Total time for subspace rotation: 32.737 ms
rank = 0, Efermi =  -0.047132851199 calculate fermi energy took 0.099 ms
rank = 0, --- Calculate rho: sum over local bands took 6.623 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.421 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1931.031 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.924 ms
rank = 0, D2D took 2.026 ms
rank = 0, Transfering density took 2.032 ms
Etot    =   -39.828794926508
Eband   =   -12.642515022604
E1      =    30.799452816684
E2      =   -11.015975312006
E3      =   -16.999148014605
Exc     =   -14.943600727072
Esc     =   -71.057255318711
Entropy =    -0.000000001417
dE = 8.260e-07, dEband = 1.339e-04
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -39.828794927, dEtot = 8.260e-07, dEband = 1.339e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0100111088762, which took 0.054 ms

iter_count = 114, r_2norm = 3.401e-07, tol*||rhs|| = 4.004e-07

Anderson update took 66.591 ms, out of which F'*F took 31.816 ms; b-Ax took 215.964 ms, out of which Lap took 191.625 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 485.533 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000004844674, int_rho =  30.00000004844648, int_b + int_rho = -2.619e-13, checking this took 0.158 ms
2-norm of RHS = 866.3210442054354, which took 0.202 ms

iter_count = 108, r_2norm = 8.629e-04, tol*||rhs|| = 8.663e-04

Anderson update took 62.704 ms, out of which F'*F took 43.635 ms; b-Ax took 225.695 ms, out of which Lap took 203.453 ms
Solving Poisson took 469.527 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.147491 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.395 ms
Total time for convolution: 	 convolve: 5.154922 
Total time for convolution: 	 convolve: 5.160009 
Total time for convolution: 	 convolve: 5.157681 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.895 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.974 ms
---Transfer Veff_loc: D2D took 3.433 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.877 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.344 ms

This SCF took 27486.404 ms, scf error = 8.816e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.44634684695299, occ[   6] =   2.00000000000000
lambda[   7] =  -0.41494156522246, occ[   7] =   2.00000000000000
lambda[   8] =  -0.36721261506134, occ[   8] =   2.00000000000000
lambda[   9] =  -0.33364341300896, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31271830261908, occ[  10] =   2.00000000000000
lambda[  11] =  -0.31167145458301, occ[  11] =   2.00000000000000
lambda[  12] =  -0.28448879063220, occ[  12] =   2.00000000000000
lambda[  13] =  -0.28424015743407, occ[  13] =   2.00000000000000
lambda[  14] =  -0.26024419810491, occ[  14] =   2.00000000000000
lambda[  15] =  -0.16892147725169, occ[  15] =   2.00000000000000
lambda[  16] =  -0.01877248046052, occ[  16] =   0.00000004844650
lambda[  17] =   0.01605178105244, occ[  17] =   0.00000000000000
lambda[  18] =   0.02198868886038, occ[  18] =   0.00000000000000
lambda[  19] =   0.02596959458428, occ[  19] =   0.00000000000000
lambda[  20] =   0.02619061163036, occ[  20] =   0.00000000000000
lambda[  21] =   0.03307075806676, occ[  21] =   0.00000000000000
lambda[  22] =   0.03849967672040, occ[  22] =   0.00000000000000
lambda[  23] =   0.05823743213765, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.722 ms, time for Allreduce/Reduce: 16.426 ms 
Time for calculating local force components: 28.271 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00586516341106   0.06375754670481   0.00000003222497
  0.04460286230503   0.01458544843616  -0.00766822654672
  0.04460271246258   0.01458540965140   0.00766823484208
 -0.02602827034293   0.00942950889222  -0.04158721756919
 -0.02602820267668   0.00942956049950   0.04158713987665
 -0.04062695137339  -0.02235499472910  -0.01735343420654
 -0.04062707301629  -0.02235505487673   0.01735346091587
  0.03894152570301  -0.02401926538040  -0.01924465392421
  0.03894163433214  -0.02401933319673   0.01924467831668
  0.03532055150276  -0.03303917135133  -0.07467529510324
  0.03532070545848  -0.03303688633002   0.07467625752357
 -0.00360023368809  -0.01254079618529  -0.01148124621236
 -0.00360045693719  -0.01253857051477   0.01148042257683
 -0.63567939594150  -0.14052534480887   0.00000264478620
force_loc = 
 -0.00517612684067  -0.06606742664861   0.00000017224724
 -0.04621004676058  -0.01525703148629   0.00748591508429
 -0.04621185790350  -0.01525761166356  -0.00748606150430
  0.02687138842963  -0.00952811900423   0.04258737489886
  0.02687217662971  -0.00952798899970  -0.04258890529365
  0.04198356084099   0.02291739737894   0.01790863346493
  0.04198165458107   0.02291641434985  -0.01790791573526
 -0.04018328275273   0.02446486637325   0.01954547517742
 -0.04018214174079   0.02446370323950  -0.01954506276023
 -0.03361342961251   0.03474424539001   0.07332390146536
 -0.03361283342612   0.03474493515478  -0.07332489944272
  0.00315490116985   0.01063605758663   0.00969000408953
  0.00315547836792   0.01063509438795  -0.00969172212564
  0.61865860844922   0.13524660880410   0.00000037703600
Time for calculating nonlocal force components: 49.295 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00178370702980   0.00075497574808   0.00358060128918
[0m[32m -0.00178367560659   0.00075488495179  -0.00358065819353
[0m[32m  0.00032274971151   0.00133057045290   0.00162213482684
[0m[32m  0.00032280854839   0.00133042012647  -0.00162212557368
[0m[32m  0.01799503006849   0.00318539695913  -0.00000011292587
[0mTime for calculating XC forces components: 41.251 ms
 Cartesian force = 
  0.00069147754736  -0.00229884065179   0.00000020993468
 -0.00160474347859  -0.00066054375812  -0.00018230599996
 -0.00160670446396  -0.00066116272015   0.00018217880025
  0.00084555906367  -0.00008757081999   0.00100016279215
  0.00084641492999  -0.00008738920820  -0.00100175995452
  0.00135905044456   0.00057344194186   0.00055520472086
  0.00135702254175   0.00057239876513  -0.00055444935691
 -0.00123931607275   0.00045664028487   0.00030082671568
 -0.00123806643168   0.00045540933478  -0.00030037898108
 -0.00007414416258   0.00247108907877   0.00222921311378
 -0.00007336259727   0.00247397306856  -0.00222929465020
 -0.00012014182976  -0.00056312885375  -0.00016910183352
 -0.00011972904390  -0.00056201670834   0.00016658033999
  0.00097668355317  -0.00208229975362   0.00000291435880
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.377 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.367 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.946 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.174 ms
Time for printing density: 392.566 ms
The program took 453.955 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:03
Job ID:        2266683
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:33:00,vmem=8288K,walltime=00:07:45,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-19-1
---------------------------------------
