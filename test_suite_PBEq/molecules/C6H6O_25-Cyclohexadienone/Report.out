---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:07
Job ID:    2266805
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:22:10
Job ID:    2266805
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 40.088 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 13.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 10.669 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 69.460 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.082 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   10.000000	   14.570313	
   10.000000	   14.114695	   11.858361	
   10.000000	    5.885305	   11.858361	
   10.000000	   14.150761	    7.211912	
   10.000000	    5.849239	    7.211912	
   11.643070	   10.000000	    5.429687	
    8.356930	   10.000000	    5.429687	
   10.000000	   10.000000	   12.254888	
   10.000000	   10.000000	    6.695698	
   10.000000	   12.376695	   10.777725	
   10.000000	    7.623305	   10.777725	
   10.000000	   12.374688	    8.237174	
   10.000000	    7.625312	    8.237174	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.171 ms
Set up communicators.

--set up spincomm took 2.365 ms

--set up kptcomm took 0.352 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 2, 2}
gridsizes = [100, 100, 100], Nstates = 26, dmcomm dims = [1, 2, 2]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 3, ScaLAPACK topology Dims = (3, 1)
nproc = 12, size_blacscomm = 3 = dims[0] * dims[1] = (3, 1)
Nd_blacscomm 250000, Nstates 26 
rank =  0, my blacs rank = 0, BLCYC size (250000, 9), actual size (250000, 9)
rank = 0, mb = nb = 26, mbQ = nbQ = 64
rank = 0, nr_Hp = 26, nc_Hp = 26
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.069 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 3
# of bands per bandcomm          : 9
npdomain: 4
Embeded Cartesian topology dims: (1,2,2)
# of FD-grid points per processor: 250000 = (100,50,50)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.341 ms

Calculate_SplineDerivRadFun took 0.211 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.857 ms.
time spent on vectorized spline interp: 3.404 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.600 ms.
time spent on vectorized spline interp: 1.240 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.265 ms.
time spent on vectorized spline interp: 1.637 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.474 ms.

Calculating rb for all atom types took 15.486 ms
----------------------
Estimated memory usage
Total: 1.51 GB
orbitals             : 1.16 GB
global sized vectors : 213.62 MB
subspace matrices : 63.38 kB
others : 140.39 MB
----------------------------------------------
Estimated memory usage per processor: 128.69 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.047 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -36.0000000254370, sum_int_rho = 35.3756025391234
PosCharge = 36.000000025437, NegCharge = -35.375602539123, scal_fac = 1.017650511694
After scaling, int_rho = 36.0000000254366, PosCharge + NegCharge - NetCharge = 3.837e-13
--Calculate Vref took 0.834 ms
--Calculate rho_guess took 5.148 ms

 integral of b = -36.0000000254370,
 int{b} + Nelectron + NetCharge = -2.544e-08,
 Esc = -94.8410578552443,
 MPI_Reduce took 10.215 ms

Calculating b & b_ref took 26.335 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.039 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.048 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.022 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.226 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.011 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.012 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.027 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 51.364 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543692, int_b + int_rho = -9.895e-13, checking this took 0.090 ms
2-norm of RHS = 854.2197435324800, which took 0.445 ms

iter_count = 420, r_2norm = 7.839e-04, tol*||rhs|| = 8.542e-04

Anderson update took 207.242 ms, out of which F'*F took 120.799 ms; b-Ax took 713.805 ms, out of which Lap took 673.685 ms
Solving Poisson took 1205.590 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.907 ms
Total time for convolution: 	 convolve: 5.244524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 222.853 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.896 ms
Total time for convolution: 	 convolve: 5.434789 
Total time for convolution: 	 convolve: 5.209458 
Total time for convolution: 	 convolve: 5.141787 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.734 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.514 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.645 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
rank = 0, XC calculation took 25209.563 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
---Transfer Veff_loc: D2D took 1.642 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 2.215 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 4.976 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.145 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.592 ms
    Lanczos iter 56, eigmin  = -0.965038332, eigmax = 264.960853782, err_eigmin = 1.950e-03, err_eigmax = 9.805e-03
rank =   0, Lanczos took 112.824 ms, eigmin = -0.965038332052, eigmax = 267.610462319915

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.272712, lowerbound = -1.065038, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1692.763 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 45.929 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 7.069 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.733 ms
rank =  0, Distribute data + matrix mult took 56.745 ms
rank =  0, finding HY took 30.334 ms
rank =  0, distributing HY into block cyclic form took 25.327 ms
rank =  0, finding Y'*HY took 10.172 ms
Rank 0, Project_Hamiltonian used 122.625 ms
Total time for projection: 122.647 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.433 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.076 ms
rank = 0, Solve_Generalized_EigenProblem used 0.512 ms
    first calculated eigval = 2.702856706443219
    last  calculated eigval = 3.306110213621445
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =   2.90502779329419
lambda[  10] =   2.91199967027097
lambda[  11] =   2.94534334819413
lambda[  12] =   2.95889112997921
lambda[  13] =   2.97565333885109
lambda[  14] =   2.99148917766190
lambda[  15] =   3.00279539737783
lambda[  16] =   3.02546850890336
lambda[  17] =   3.04888729269945
lambda[  18] =   3.05773622328943
lambda[  19] =   3.07933878833407
lambda[  20] =   3.11724046792509
lambda[  21] =   3.12117989724651
lambda[  22] =   3.14514021367219
lambda[  23] =   3.19272271181490
lambda[  24] =   3.20953487741498
lambda[  25] =   3.24144231368475
lambda[  26] =   3.30611021362145
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.528 ms
rank =  0, subspace rotation using ScaLAPACK took 7.462 ms
rank =  0, Distributing orbital back into band + domain format took 17.147 ms
rank = 0, Subspace_Rotation used 24.623 ms

Total time for subspace rotation: 24.627 ms
rank = 0, Efermi =   3.068541901924 calculate fermi energy took 0.064 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.406110, lowerbound = -1.065038, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1691.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.011 ms
rank =  0, Distribute orbital to block cyclic format took 16.782 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.211 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.625 ms
rank =  0, Distribute data + matrix mult took 24.632 ms
rank =  0, finding HY took 30.768 ms
rank =  0, distributing HY into block cyclic form took 16.913 ms
rank =  0, finding Y'*HY took 8.937 ms
Rank 0, Project_Hamiltonian used 81.286 ms
Total time for projection: 81.289 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.189 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.250 ms
    first calculated eigval = -0.842994104225345
    last  calculated eigval = 0.478659186051937
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.17442182635344
lambda[  10] =  -0.12831967331825
lambda[  11] =  -0.08483025277449
lambda[  12] =  -0.00647101217955
lambda[  13] =   0.01436248445740
lambda[  14] =   0.07917023292934
lambda[  15] =   0.13372004410868
lambda[  16] =   0.21165962000655
lambda[  17] =   0.23500492218352
lambda[  18] =   0.27834480767787
lambda[  19] =   0.29995161275961
lambda[  20] =   0.32210883433537
lambda[  21] =   0.35889639378487
lambda[  22] =   0.37541082052071
lambda[  23] =   0.40627472210154
lambda[  24] =   0.41401131983519
lambda[  25] =   0.43433599524052
lambda[  26] =   0.47865918605194
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 7.415 ms
rank =  0, Distributing orbital back into band + domain format took 17.646 ms
rank = 0, Subspace_Rotation used 25.072 ms

Total time for subspace rotation: 25.076 ms
rank = 0, Efermi =   0.289148210931 calculate fermi energy took 0.030 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.578659, lowerbound = -1.065038, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1676.398 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 38.801 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.214 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.141 ms
rank =  0, Distribute data + matrix mult took 47.171 ms
rank =  0, finding HY took 30.868 ms
rank =  0, distributing HY into block cyclic form took 16.907 ms
rank =  0, finding Y'*HY took 9.038 ms
Rank 0, Project_Hamiltonian used 104.009 ms
Total time for projection: 104.012 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.185 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -1.014320680422362
    last  calculated eigval = 0.159561013698136
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.51031938984507
lambda[  10] =  -0.50244342425942
lambda[  11] =  -0.48925097956665
lambda[  12] =  -0.45559158850063
lambda[  13] =  -0.41382334454456
lambda[  14] =  -0.40719315439909
lambda[  15] =  -0.39176574324239
lambda[  16] =  -0.32178814740216
lambda[  17] =  -0.26399507346368
lambda[  18] =  -0.19855950677254
lambda[  19] =  -0.11560865515006
lambda[  20] =  -0.04294407110854
lambda[  21] =   0.07442621678092
lambda[  22] =   0.09130033585739
lambda[  23] =   0.10027702527454
lambda[  24] =   0.11235128769825
lambda[  25] =   0.14237758381827
lambda[  26] =   0.15956101369814
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.261 ms
rank =  0, subspace rotation using ScaLAPACK took 7.421 ms
rank =  0, Distributing orbital back into band + domain format took 17.567 ms
rank = 0, Subspace_Rotation used 25.000 ms

Total time for subspace rotation: 25.005 ms
rank = 0, Efermi =  -0.144558045886 calculate fermi energy took 0.032 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.259561, lowerbound = -1.065038, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1701.499 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 17.149 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.263 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.513 ms
rank =  0, Distribute data + matrix mult took 24.938 ms
rank =  0, finding HY took 30.621 ms
rank =  0, distributing HY into block cyclic form took 16.633 ms
rank =  0, finding Y'*HY took 9.049 ms
Rank 0, Project_Hamiltonian used 81.263 ms
Total time for projection: 81.266 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.246 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.309 ms
    first calculated eigval = -1.014488943735709
    last  calculated eigval = 0.086814522350506
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.51478066050918
lambda[  10] =  -0.50829693664471
lambda[  11] =  -0.49620131098640
lambda[  12] =  -0.46117751945281
lambda[  13] =  -0.44224006628032
lambda[  14] =  -0.41402694012198
lambda[  15] =  -0.40859722993380
lambda[  16] =  -0.33873190015932
lambda[  17] =  -0.31993256913608
lambda[  18] =  -0.28395503495418
lambda[  19] =  -0.15911377586304
lambda[  20] =  -0.11518498108735
lambda[  21] =   0.00152629195936
lambda[  22] =   0.01313230908224
lambda[  23] =   0.04309795176425
lambda[  24] =   0.06385998629861
lambda[  25] =   0.07576162263521
lambda[  26] =   0.08681452235051
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.317 ms
rank =  0, subspace rotation using ScaLAPACK took 7.245 ms
rank =  0, Distributing orbital back into band + domain format took 18.462 ms
rank = 0, Subspace_Rotation used 25.717 ms

Total time for subspace rotation: 25.721 ms
rank = 0, Efermi =  -0.188063166595 calculate fermi energy took 0.030 ms
rank = 0, --- Calculate rho: sum over local bands took 2.747 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.963 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.086 ms
rank = 0, Calculating density took 7375.141 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
rank = 0, D2D took 1.954 ms
rank = 0, Transfering density took 1.960 ms
Etot    =   -56.391428986509
Eband   =   -20.165863553604
E1      =    40.846633129498
E2      =   -15.744958264143
E3      =   -20.341384202444
Exc     =   -18.317483172987
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 4.338e+00, dEband = 1.551e+00
rank = 0, Calculating/Estimating energy took 1.266 ms, Etot = -56.391428987, dEtot = 4.338e+00, dEband = 1.551e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.2167749478982, which took 0.230 ms

iter_count = 96, r_2norm = 2.029e-03, tol*||rhs|| = 2.529e-03

Anderson update took 46.233 ms, out of which F'*F took 26.986 ms; b-Ax took 160.741 ms, out of which Lap took 151.783 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 275.820 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543663, int_b + int_rho = -1.273e-12, checking this took 0.176 ms
2-norm of RHS = 849.0559231282391, which took 0.191 ms

iter_count = 288, r_2norm = 6.995e-04, tol*||rhs|| = 8.491e-04

Anderson update took 135.001 ms, out of which F'*F took 80.611 ms; b-Ax took 490.024 ms, out of which Lap took 462.461 ms
Solving Poisson took 816.291 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.278182 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.216347 
Total time for convolution: 	 convolve: 5.177722 
Total time for convolution: 	 convolve: 5.158420 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.132 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.984 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.834 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.837 ms

This SCF took 33318.906 ms, scf error = 1.796e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.186815, lowerbound = -1.014489, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1657.463 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.413 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.780 ms
rank =  0, Distribute data + matrix mult took 24.620 ms
rank =  0, finding HY took 30.684 ms
rank =  0, distributing HY into block cyclic form took 20.890 ms
rank =  0, finding Y'*HY took 7.520 ms
Rank 0, Project_Hamiltonian used 83.740 ms
Total time for projection: 83.752 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.267 ms
    first calculated eigval = -0.989428737304500
    last  calculated eigval = 0.062108057819193
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.48625869432538
lambda[  10] =  -0.47902627317008
lambda[  11] =  -0.46629092890865
lambda[  12] =  -0.42956391963821
lambda[  13] =  -0.41002090031819
lambda[  14] =  -0.39337752212366
lambda[  15] =  -0.38613494227541
lambda[  16] =  -0.31290500014791
lambda[  17] =  -0.29531399611980
lambda[  18] =  -0.25470851511763
lambda[  19] =  -0.14098168360465
lambda[  20] =  -0.10114006306601
lambda[  21] =  -0.02685370921779
lambda[  22] =   0.00547584509510
lambda[  23] =   0.01619655065037
lambda[  24] =   0.03760079923516
lambda[  25] =   0.04719202514441
lambda[  26] =   0.06210805781919
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.283 ms
rank =  0, subspace rotation using ScaLAPACK took 7.194 ms
rank =  0, Distributing orbital back into band + domain format took 17.342 ms
rank = 0, Subspace_Rotation used 24.545 ms

Total time for subspace rotation: 24.549 ms
rank = 0, Efermi =  -0.169931074265 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.506 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.461 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.089 ms
rank = 0, Calculating density took 1773.231 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.384 ms
rank = 0, D2D took 2.852 ms
rank = 0, Transfering density took 2.858 ms
Etot    =   -56.302933096854
Eband   =   -19.133611841702
E1      =    39.934280081465
E2      =   -15.664770939505
E3      =   -20.606808071954
Exc     =   -18.534122492072
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 6.807e-03, dEband = 7.940e-02
rank = 0, Calculating/Estimating energy took 1.174 ms, Etot = -56.302933097, dEtot = 6.807e-03, dEband = 7.940e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 28.7610984195619, which took 0.232 ms

iter_count = 102, r_2norm = 8.001e-04, tol*||rhs|| = 1.150e-03

Anderson update took 48.225 ms, out of which F'*F took 27.433 ms; b-Ax took 171.185 ms, out of which Lap took 161.955 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.053 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543668, int_b + int_rho = -1.222e-12, checking this took 0.197 ms
2-norm of RHS = 842.6374925341568, which took 0.172 ms

iter_count = 300, r_2norm = 8.266e-04, tol*||rhs|| = 8.426e-04

Anderson update took 138.523 ms, out of which F'*F took 83.533 ms; b-Ax took 510.331 ms, out of which Lap took 482.607 ms
Solving Poisson took 841.606 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.275088 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.191866 
Total time for convolution: 	 convolve: 5.189643 
Total time for convolution: 	 convolve: 5.193869 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.163 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.994 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.844 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.856 ms

This SCF took 27825.227 ms, scf error = 1.239e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.162108, lowerbound = -0.989429, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1701.754 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.473 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.007 ms
rank =  0, Distribute data + matrix mult took 25.197 ms
rank =  0, finding HY took 32.243 ms
rank =  0, distributing HY into block cyclic form took 16.310 ms
rank =  0, finding Y'*HY took 8.184 ms
Rank 0, Project_Hamiltonian used 81.958 ms
Total time for projection: 81.970 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.215 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.424 ms
rank = 0, Solve_Generalized_EigenProblem used 0.659 ms
    first calculated eigval = -0.959844286255354
    last  calculated eigval = 0.054080798912298
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.43765937154510
lambda[  10] =  -0.42935706268007
lambda[  11] =  -0.41200473715062
lambda[  12] =  -0.38329907756230
lambda[  13] =  -0.37073348405683
lambda[  14] =  -0.35670973696464
lambda[  15] =  -0.33508387495071
lambda[  16] =  -0.26765023243515
lambda[  17] =  -0.25741491408870
lambda[  18] =  -0.21740681445356
lambda[  19] =  -0.10837610050776
lambda[  20] =  -0.06152623880418
lambda[  21] =  -0.03048823197354
lambda[  22] =   0.01045824312331
lambda[  23] =   0.01451265672992
lambda[  24] =   0.02779691704455
lambda[  25] =   0.03886776214929
lambda[  26] =   0.05408079891230
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.671 ms
rank =  0, subspace rotation using ScaLAPACK took 7.614 ms
rank =  0, Distributing orbital back into band + domain format took 16.971 ms
rank = 0, Subspace_Rotation used 24.596 ms

Total time for subspace rotation: 24.600 ms
rank = 0, Efermi =  -0.137325491165 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.455 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.383 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 1816.043 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
rank = 0, D2D took 3.433 ms
rank = 0, Transfering density took 3.438 ms
Etot    =   -56.225038956201
Eband   =   -17.411237459538
E1      =    38.476618045306
E2      =   -15.387450045368
E3      =   -21.096164303887
Exc     =   -18.932976035220
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 5.992e-03, dEband = 1.325e-01
rank = 0, Calculating/Estimating energy took 1.200 ms, Etot = -56.225038956, dEtot = 5.992e-03, dEband = 1.325e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 8.9431198273461, which took 0.201 ms

iter_count = 102, r_2norm = 3.271e-04, tol*||rhs|| = 3.577e-04

Anderson update took 47.849 ms, out of which F'*F took 28.445 ms; b-Ax took 169.616 ms, out of which Lap took 160.386 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 292.560 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543681, int_b + int_rho = -1.091e-12, checking this took 0.179 ms
2-norm of RHS = 842.1387400628281, which took 0.182 ms

iter_count = 276, r_2norm = 6.876e-04, tol*||rhs|| = 8.421e-04

Anderson update took 131.411 ms, out of which F'*F took 77.460 ms; b-Ax took 462.338 ms, out of which Lap took 437.181 ms
Solving Poisson took 772.303 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.331910 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.198954 
Total time for convolution: 	 convolve: 5.206725 
Total time for convolution: 	 convolve: 5.193828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.508 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.315 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.839 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.816 ms

This SCF took 27873.012 ms, scf error = 3.969e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.154081, lowerbound = -0.959844, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1633.172 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 37.403 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.317 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.443 ms
rank =  0, Distribute data + matrix mult took 45.192 ms
rank =  0, finding HY took 30.196 ms
rank =  0, distributing HY into block cyclic form took 16.483 ms
rank =  0, finding Y'*HY took 9.149 ms
Rank 0, Project_Hamiltonian used 101.044 ms
Total time for projection: 101.086 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.272 ms
    first calculated eigval = -0.948222530460001
    last  calculated eigval = 0.050880369199473
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.42316780278942
lambda[  10] =  -0.41616253121510
lambda[  11] =  -0.39642178605536
lambda[  12] =  -0.37018548567885
lambda[  13] =  -0.36070628400672
lambda[  14] =  -0.34140154282080
lambda[  15] =  -0.31996987929603
lambda[  16] =  -0.25676845629481
lambda[  17] =  -0.24737298690994
lambda[  18] =  -0.20644016550618
lambda[  19] =  -0.09799063771376
lambda[  20] =  -0.05134209778199
lambda[  21] =  -0.03046542578072
lambda[  22] =   0.00948750236955
lambda[  23] =   0.01525173424585
lambda[  24] =   0.02362908018533
lambda[  25] =   0.03193528665201
lambda[  26] =   0.05088036919947
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.287 ms
rank =  0, subspace rotation using ScaLAPACK took 7.622 ms
rank =  0, Distributing orbital back into band + domain format took 16.406 ms
rank = 0, Subspace_Rotation used 24.038 ms

Total time for subspace rotation: 24.042 ms
rank = 0, Efermi =  -0.126940028438 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 2.459 ms
rank = 0, --- Calculate rho: reduce over all band groups took 5.133 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.131 ms
rank = 0, Calculating density took 1766.430 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.417 ms
rank = 0, D2D took 3.065 ms
rank = 0, Transfering density took 3.072 ms
Etot    =   -56.217997887814
Eband   =   -16.915900411578
E1      =    38.119512695815
E2      =   -15.225456189987
E3      =   -21.243238778671
Exc     =   -19.049247284706
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 5.416e-04, dEband = 3.810e-02
rank = 0, Calculating/Estimating energy took 1.473 ms, Etot = -56.217997888, dEtot = 5.416e-04, dEband = 3.810e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.3240328217756, which took 0.146 ms

iter_count = 114, r_2norm = 5.801e-05, tol*||rhs|| = 9.296e-05

Anderson update took 53.340 ms, out of which F'*F took 57.919 ms; b-Ax took 215.847 ms, out of which Lap took 205.371 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.328 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543665, int_b + int_rho = -1.259e-12, checking this took 0.180 ms
2-norm of RHS = 843.0582970063961, which took 0.166 ms

iter_count = 264, r_2norm = 7.391e-04, tol*||rhs|| = 8.431e-04

Anderson update took 126.746 ms, out of which F'*F took 73.880 ms; b-Ax took 438.958 ms, out of which Lap took 414.992 ms
Solving Poisson took 737.077 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.254733 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.602 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.187352 
Total time for convolution: 	 convolve: 5.158938 
Total time for convolution: 	 convolve: 5.193057 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.514 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.149 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.133 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 0.998 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.793 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.818 ms

This SCF took 27745.756 ms, scf error = 1.915e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.150880, lowerbound = -0.948223, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1625.652 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 44.558 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.480 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.369 ms
rank =  0, Distribute data + matrix mult took 53.418 ms
rank =  0, finding HY took 30.071 ms
rank =  0, distributing HY into block cyclic form took 16.410 ms
rank =  0, finding Y'*HY took 9.224 ms
Rank 0, Project_Hamiltonian used 109.146 ms
Total time for projection: 109.159 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.222 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.279 ms
    first calculated eigval = -0.937283905855872
    last  calculated eigval = 0.049141826360116
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.41476924979536
lambda[  10] =  -0.41021038305068
lambda[  11] =  -0.38916797515057
lambda[  12] =  -0.36117861079984
lambda[  13] =  -0.35189978209987
lambda[  14] =  -0.33454158538278
lambda[  15] =  -0.31215244039714
lambda[  16] =  -0.25284715331029
lambda[  17] =  -0.24145358616526
lambda[  18] =  -0.19754922583699
lambda[  19] =  -0.09109408450268
lambda[  20] =  -0.04702827811729
lambda[  21] =  -0.03003926481798
lambda[  22] =   0.00937118243086
lambda[  23] =   0.01521968433870
lambda[  24] =   0.02108746197035
lambda[  25] =   0.02685133575731
lambda[  26] =   0.04914182636012
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 7.613 ms
rank =  0, Distributing orbital back into band + domain format took 17.565 ms
rank = 0, Subspace_Rotation used 25.188 ms

Total time for subspace rotation: 25.192 ms
rank = 0, Efermi =  -0.120043475206 calculate fermi energy took 4.570 ms
rank = 0, --- Calculate rho: sum over local bands took 2.521 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.540 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1769.079 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.350 ms
rank = 0, D2D took 1.237 ms
rank = 0, Transfering density took 1.243 ms
Etot    =   -56.215465163827
Eband   =   -16.651499319945
E1      =    37.994776018871
E2      =   -15.069325373083
E3      =   -21.311506929904
Exc     =   -19.098516309737
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 1.948e-04, dEband = 2.034e-02
rank = 0, Calculating/Estimating energy took 1.285 ms, Etot = -56.215465164, dEtot = 1.948e-04, dEband = 2.034e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.1794423812995, which took 0.213 ms

iter_count = 108, r_2norm = 4.295e-05, tol*||rhs|| = 4.718e-05

Anderson update took 50.349 ms, out of which F'*F took 30.534 ms; b-Ax took 181.930 ms, out of which Lap took 171.952 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 309.168 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543661, int_b + int_rho = -1.295e-12, checking this took 0.183 ms
2-norm of RHS = 843.5604136842076, which took 0.171 ms

iter_count = 240, r_2norm = 8.016e-04, tol*||rhs|| = 8.436e-04

Anderson update took 115.602 ms, out of which F'*F took 66.446 ms; b-Ax took 398.797 ms, out of which Lap took 375.576 ms
Solving Poisson took 669.430 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.294645 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 72.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.255160 
Total time for convolution: 	 convolve: 5.210128 
Total time for convolution: 	 convolve: 5.216899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.144 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.014 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.318 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.347 ms

This SCF took 28007.403 ms, scf error = 6.127e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.149142, lowerbound = -0.937284, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1625.772 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 42.234 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.512 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.259 ms
rank =  0, Distribute data + matrix mult took 51.016 ms
rank =  0, finding HY took 30.092 ms
rank =  0, distributing HY into block cyclic form took 16.426 ms
rank =  0, finding Y'*HY took 9.268 ms
Rank 0, Project_Hamiltonian used 106.826 ms
Total time for projection: 106.839 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.222 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.289 ms
    first calculated eigval = -0.933146491916881
    last  calculated eigval = 0.046417136048833
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.41064967950777
lambda[  10] =  -0.40632202249162
lambda[  11] =  -0.38518272905857
lambda[  12] =  -0.35682414373428
lambda[  13] =  -0.34842195482204
lambda[  14] =  -0.33030581619785
lambda[  15] =  -0.30804783965851
lambda[  16] =  -0.24928950741736
lambda[  17] =  -0.23751156433470
lambda[  18] =  -0.19299905369288
lambda[  19] =  -0.08749852132934
lambda[  20] =  -0.04373429222317
lambda[  21] =  -0.02982889781504
lambda[  22] =   0.00893331916553
lambda[  23] =   0.01476228120626
lambda[  24] =   0.01953379012646
lambda[  25] =   0.02316153931313
lambda[  26] =   0.04641713604883
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.305 ms
rank =  0, subspace rotation using ScaLAPACK took 7.618 ms
rank =  0, Distributing orbital back into band + domain format took 16.339 ms
rank = 0, Subspace_Rotation used 23.965 ms

Total time for subspace rotation: 23.969 ms
rank = 0, Efermi =  -0.116447911976 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.457 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.409 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1763.952 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
rank = 0, D2D took 3.640 ms
rank = 0, Transfering density took 3.646 ms
Etot    =   -56.214760048013
Eband   =   -16.506531188831
E1      =    37.930362434508
E2      =   -14.981819124102
E3      =   -21.335703598380
Exc     =   -19.115056160168
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 5.424e-05, dEband = 1.115e-02
rank = 0, Calculating/Estimating energy took 1.195 ms, Etot = -56.214760048, dEtot = 5.424e-05, dEband = 1.115e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6559631248316, which took 0.089 ms

iter_count = 108, r_2norm = 2.412e-05, tol*||rhs|| = 2.624e-05

Anderson update took 51.201 ms, out of which F'*F took 30.096 ms; b-Ax took 179.242 ms, out of which Lap took 168.338 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.255 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543661, int_b + int_rho = -1.295e-12, checking this took 1.006 ms
2-norm of RHS = 843.8647284548977, which took 0.183 ms

iter_count = 234, r_2norm = 7.283e-04, tol*||rhs|| = 8.439e-04

Anderson update took 117.974 ms, out of which F'*F took 65.005 ms; b-Ax took 397.376 ms, out of which Lap took 372.852 ms
Solving Poisson took 687.021 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.255003 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.236 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.166490 
Total time for convolution: 	 convolve: 5.200431 
Total time for convolution: 	 convolve: 5.204205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.148 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 0.966 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.327 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.307 ms

This SCF took 27720.133 ms, scf error = 3.417e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.146417, lowerbound = -0.933146, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1630.280 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 41.245 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.645 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.446 ms
rank =  0, Distribute data + matrix mult took 50.346 ms
rank =  0, finding HY took 30.158 ms
rank =  0, distributing HY into block cyclic form took 16.544 ms
rank =  0, finding Y'*HY took 9.096 ms
Rank 0, Project_Hamiltonian used 106.168 ms
Total time for projection: 106.181 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.201 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.266 ms
    first calculated eigval = -0.930752191400956
    last  calculated eigval = 0.044430450818716
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40785743583996
lambda[  10] =  -0.40344523577155
lambda[  11] =  -0.38217228289133
lambda[  12] =  -0.35403127692292
lambda[  13] =  -0.34589650313012
lambda[  14] =  -0.32728806992964
lambda[  15] =  -0.30507889432991
lambda[  16] =  -0.24636689089774
lambda[  17] =  -0.23481958240412
lambda[  18] =  -0.19042069548794
lambda[  19] =  -0.08486607134967
lambda[  20] =  -0.04103008920741
lambda[  21] =  -0.02925283252920
lambda[  22] =   0.00903491480415
lambda[  23] =   0.01486833902367
lambda[  24] =   0.01899010152377
lambda[  25] =   0.02174197055317
lambda[  26] =   0.04443045081872
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.282 ms
rank =  0, subspace rotation using ScaLAPACK took 7.611 ms
rank =  0, Distributing orbital back into band + domain format took 16.462 ms
rank = 0, Subspace_Rotation used 24.081 ms

Total time for subspace rotation: 24.086 ms
rank = 0, Efermi =  -0.113815462043 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 2.454 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.448 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1767.928 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
rank = 0, D2D took 2.617 ms
rank = 0, Transfering density took 2.622 ms
Etot    =   -56.214437326609
Eband   =   -16.401428711419
E1      =    37.883599419077
E2      =   -14.919726328393
E3      =   -21.347871688895
Exc     =   -19.123148195552
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 2.482e-05, dEband = 8.085e-03
rank = 0, Calculating/Estimating energy took 12.807 ms, Etot = -56.214437327, dEtot = 2.482e-05, dEband = 8.085e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3333934411145, which took 0.191 ms

iter_count = 114, r_2norm = 8.553e-06, tol*||rhs|| = 1.334e-05

Anderson update took 54.144 ms, out of which F'*F took 31.240 ms; b-Ax took 191.093 ms, out of which Lap took 180.435 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.751 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543663, int_b + int_rho = -1.281e-12, checking this took 0.220 ms
2-norm of RHS = 843.9063265098208, which took 0.063 ms

iter_count = 228, r_2norm = 7.712e-04, tol*||rhs|| = 8.439e-04

Anderson update took 119.626 ms, out of which F'*F took 64.193 ms; b-Ax took 418.479 ms, out of which Lap took 390.625 ms
Solving Poisson took 731.283 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.260036 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.839 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.210011 
Total time for convolution: 	 convolve: 5.240252 
Total time for convolution: 	 convolve: 5.196615 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.167 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.146 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 0.980 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.319 ms

This SCF took 27851.938 ms, scf error = 1.962e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.144430, lowerbound = -0.930752, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1617.519 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 70.138 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.702 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.030 ms
rank =  0, Distribute data + matrix mult took 78.881 ms
rank =  0, finding HY took 30.081 ms
rank =  0, distributing HY into block cyclic form took 16.651 ms
rank =  0, finding Y'*HY took 9.248 ms
Rank 0, Project_Hamiltonian used 134.884 ms
Total time for projection: 134.897 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.211 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.277 ms
    first calculated eigval = -0.926939717233700
    last  calculated eigval = 0.043479082410435
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40470117556985
lambda[  10] =  -0.40062881768518
lambda[  11] =  -0.37909759208661
lambda[  12] =  -0.35053630280577
lambda[  13] =  -0.34254114698131
lambda[  14] =  -0.32401056894780
lambda[  15] =  -0.30192479381659
lambda[  16] =  -0.24344966262394
lambda[  17] =  -0.23173705573807
lambda[  18] =  -0.18679779956916
lambda[  19] =  -0.08178147038488
lambda[  20] =  -0.03822008055790
lambda[  21] =  -0.02784173386709
lambda[  22] =   0.01034766666926
lambda[  23] =   0.01593951901534
lambda[  24] =   0.01986516832463
lambda[  25] =   0.02218272223849
lambda[  26] =   0.04347908241043
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 7.632 ms
rank =  0, Distributing orbital back into band + domain format took 16.839 ms
rank = 0, Subspace_Rotation used 24.480 ms

Total time for subspace rotation: 24.484 ms
rank = 0, Efermi =  -0.110730861022 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.272 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1784.117 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
rank = 0, D2D took 3.184 ms
rank = 0, Transfering density took 3.190 ms
Etot    =   -56.214291844074
Eband   =   -16.284107959575
E1      =    37.821311287712
E2      =   -14.861107011609
E3      =   -21.361903092491
Exc     =   -19.133447420307
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 1.119e-05, dEband = 9.025e-03
rank = 0, Calculating/Estimating energy took 1.244 ms, Etot = -56.214291844, dEtot = 1.119e-05, dEband = 9.025e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2182057280802, which took 0.050 ms

iter_count = 114, r_2norm = 6.309e-06, tol*||rhs|| = 8.728e-06

Anderson update took 65.120 ms, out of which F'*F took 31.446 ms; b-Ax took 202.713 ms, out of which Lap took 186.602 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 389.253 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543661, int_b + int_rho = -1.295e-12, checking this took 0.192 ms
2-norm of RHS = 843.9177843715692, which took 0.147 ms

iter_count = 204, r_2norm = 7.434e-04, tol*||rhs|| = 8.439e-04

Anderson update took 120.414 ms, out of which F'*F took 57.460 ms; b-Ax took 372.099 ms, out of which Lap took 338.868 ms
Solving Poisson took 729.033 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.220455 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.271312 
Total time for convolution: 	 convolve: 5.213406 
Total time for convolution: 	 convolve: 5.150759 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.975 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.300 ms

This SCF took 27795.141 ms, scf error = 1.190e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.143479, lowerbound = -0.926940, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1682.451 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 44.382 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.886 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 51.295 ms
rank =  0, finding HY took 38.294 ms
rank =  0, distributing HY into block cyclic form took 25.132 ms
rank =  0, finding Y'*HY took 8.007 ms
Rank 0, Project_Hamiltonian used 122.767 ms
Total time for projection: 122.786 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.198 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.278 ms
    first calculated eigval = -0.925676398806193
    last  calculated eigval = 0.041799620254435
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40373963279405
lambda[  10] =  -0.39978823436770
lambda[  11] =  -0.37824312248796
lambda[  12] =  -0.34946186085341
lambda[  13] =  -0.34141086015867
lambda[  14] =  -0.32309472256710
lambda[  15] =  -0.30101960275337
lambda[  16] =  -0.24255128088266
lambda[  17] =  -0.23073380027190
lambda[  18] =  -0.18561130027077
lambda[  19] =  -0.08073855652313
lambda[  20] =  -0.03728074981630
lambda[  21] =  -0.02649880373143
lambda[  22] =   0.01168620282697
lambda[  23] =   0.01731284584485
lambda[  24] =   0.02069092639661
lambda[  25] =   0.02255279327142
lambda[  26] =   0.04179962025443
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.360 ms
rank =  0, subspace rotation using ScaLAPACK took 12.931 ms
rank =  0, Distributing orbital back into band + domain format took 24.914 ms
rank = 0, Subspace_Rotation used 37.869 ms

Total time for subspace rotation: 37.911 ms
rank = 0, Efermi =  -0.109687947245 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 5.353 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.827 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.189 ms
rank = 0, Calculating density took 1853.113 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.640 ms
rank = 0, D2D took 0.773 ms
rank = 0, Transfering density took 0.782 ms
Etot    =   -56.214310395785
Eband   =   -16.249551732513
E1      =    37.806435546134
E2      =   -14.841142961847
E3      =   -21.362369602733
Exc     =   -19.133648917983
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 1.427e-06, dEband = 2.658e-03
rank = 0, Calculating/Estimating energy took 0.907 ms, Etot = -56.214310396, dEtot = 1.427e-06, dEband = 2.658e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1360675532883, which took 0.190 ms

iter_count = 114, r_2norm = 3.825e-06, tol*||rhs|| = 5.443e-06

Anderson update took 67.592 ms, out of which F'*F took 31.816 ms; b-Ax took 213.042 ms, out of which Lap took 194.115 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 423.437 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543670, int_b + int_rho = -1.208e-12, checking this took 0.267 ms
2-norm of RHS = 843.8984665266136, which took 0.181 ms

iter_count = 204, r_2norm = 7.486e-04, tol*||rhs|| = 8.439e-04

Anderson update took 118.111 ms, out of which F'*F took 56.535 ms; b-Ax took 372.920 ms, out of which Lap took 339.331 ms
Solving Poisson took 730.798 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.250372 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.228875 
Total time for convolution: 	 convolve: 5.171235 
Total time for convolution: 	 convolve: 5.178164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.162 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.153 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.960 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.284 ms

This SCF took 27875.112 ms, scf error = 8.525e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.141800, lowerbound = -0.925676, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1817.028 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 25.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 7.300 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 32.453 ms
rank =  0, finding HY took 37.695 ms
rank =  0, distributing HY into block cyclic form took 25.864 ms
rank =  0, finding Y'*HY took 7.643 ms
Rank 0, Project_Hamiltonian used 103.689 ms
Total time for projection: 103.706 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.180 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.248 ms
    first calculated eigval = -0.924182254572972
    last  calculated eigval = 0.041433327415384
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40227054485310
lambda[  10] =  -0.39837506336803
lambda[  11] =  -0.37678001835269
lambda[  12] =  -0.34797479460910
lambda[  13] =  -0.33998043269508
lambda[  14] =  -0.32159936592666
lambda[  15] =  -0.29955152169412
lambda[  16] =  -0.24115213232463
lambda[  17] =  -0.22933030057723
lambda[  18] =  -0.18412327039568
lambda[  19] =  -0.07931766181044
lambda[  20] =  -0.03583824239913
lambda[  21] =  -0.02385996225408
lambda[  22] =   0.01459608802893
lambda[  23] =   0.02042416875872
lambda[  24] =   0.02282002047738
lambda[  25] =   0.02434853622831
lambda[  26] =   0.04143332741538
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.308 ms
rank =  0, subspace rotation using ScaLAPACK took 13.277 ms
rank =  0, Distributing orbital back into band + domain format took 25.182 ms
rank = 0, Subspace_Rotation used 38.489 ms

Total time for subspace rotation: 38.496 ms
rank = 0, Efermi =  -0.108267052449 calculate fermi energy took 0.081 ms
rank = 0, --- Calculate rho: sum over local bands took 5.890 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.204 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.293 ms
rank = 0, Calculating density took 1970.120 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.681 ms
rank = 0, D2D took 0.799 ms
rank = 0, Transfering density took 0.807 ms
Etot    =   -56.214332979150
Eband   =   -16.196703222908
E1      =    37.778789378657
E2      =   -14.814911906191
E3      =   -21.366995012170
Exc     =   -19.137268197257
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 1.737e-06, dEband = 4.065e-03
rank = 0, Calculating/Estimating energy took 0.882 ms, Etot = -56.214332979, dEtot = 1.737e-06, dEband = 4.065e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0684784376876, which took 0.426 ms

iter_count = 114, r_2norm = 2.166e-06, tol*||rhs|| = 2.739e-06

Anderson update took 66.456 ms, out of which F'*F took 31.801 ms; b-Ax took 207.786 ms, out of which Lap took 189.026 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.282 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543670, int_b + int_rho = -1.208e-12, checking this took 0.147 ms
2-norm of RHS = 843.8936243088966, which took 0.103 ms

iter_count = 192, r_2norm = 6.882e-04, tol*||rhs|| = 8.439e-04

Anderson update took 105.896 ms, out of which F'*F took 52.034 ms; b-Ax took 331.141 ms, out of which Lap took 301.273 ms
Solving Poisson took 671.148 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.363 ms
Total time for convolution: 	 convolve: 5.252103 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.194453 
Total time for convolution: 	 convolve: 5.244323 
Total time for convolution: 	 convolve: 5.390483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.144 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.983 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.321 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.318 ms

This SCF took 28192.762 ms, scf error = 5.286e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.141433, lowerbound = -0.924182, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 2030.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.978 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 7.161 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.010 ms
rank =  0, Distribute data + matrix mult took 30.165 ms
rank =  0, finding HY took 37.225 ms
rank =  0, distributing HY into block cyclic form took 23.254 ms
rank =  0, finding Y'*HY took 8.536 ms
Rank 0, Project_Hamiltonian used 99.212 ms
Total time for projection: 99.227 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.207 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.278 ms
    first calculated eigval = -0.923316544138531
    last  calculated eigval = 0.040820420277083
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40145083648956
lambda[  10] =  -0.39752947946483
lambda[  11] =  -0.37595271468356
lambda[  12] =  -0.34711801293397
lambda[  13] =  -0.33910371040598
lambda[  14] =  -0.32075533691015
lambda[  15] =  -0.29872083097150
lambda[  16] =  -0.24032386280635
lambda[  17] =  -0.22847239143374
lambda[  18] =  -0.18324083406202
lambda[  19] =  -0.07848019372674
lambda[  20] =  -0.03495848801957
lambda[  21] =  -0.02101814805263
lambda[  22] =   0.01783142983136
lambda[  23] =   0.02385434905682
lambda[  24] =   0.02495493380669
lambda[  25] =   0.02650168506852
lambda[  26] =   0.04082042027708
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 10.591 ms
rank =  0, Distributing orbital back into band + domain format took 23.865 ms
rank = 0, Subspace_Rotation used 34.477 ms

Total time for subspace rotation: 34.482 ms
rank = 0, Efermi =  -0.107429584424 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 4.151 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.162 ms
rank = 0, Calculating density took 2174.124 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.581 ms
rank = 0, D2D took 0.764 ms
rank = 0, Transfering density took 0.772 ms
Etot    =   -56.214402509564
Eband   =   -16.166258392866
E1      =    37.764049077523
E2      =   -14.798948183573
E3      =   -21.368217191532
Exc     =   -19.138300713322
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 5.348e-06, dEband = 2.342e-03
rank = 0, Calculating/Estimating energy took 1.120 ms, Etot = -56.214402510, dEtot = 5.348e-06, dEband = 2.342e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0526607390356, which took 0.274 ms

iter_count = 114, r_2norm = 1.854e-06, tol*||rhs|| = 2.106e-06

Anderson update took 63.092 ms, out of which F'*F took 30.631 ms; b-Ax took 197.037 ms, out of which Lap took 178.668 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 414.430 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543665, int_b + int_rho = -1.259e-12, checking this took 0.115 ms
2-norm of RHS = 843.8997752048148, which took 0.247 ms

iter_count = 156, r_2norm = 7.486e-04, tol*||rhs|| = 8.439e-04

Anderson update took 80.653 ms, out of which F'*F took 42.408 ms; b-Ax took 263.051 ms, out of which Lap took 242.315 ms
Solving Poisson took 495.360 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.250533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.193968 
Total time for convolution: 	 convolve: 5.182837 
Total time for convolution: 	 convolve: 5.298293 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.171 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
---Transfer Veff_loc: D2D took 1.477 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.521 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.021 ms

This SCF took 28065.171 ms, scf error = 3.388e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.140820, lowerbound = -0.923317, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 2053.618 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 23.133 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.758 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 29.918 ms
rank =  0, finding HY took 36.796 ms
rank =  0, distributing HY into block cyclic form took 22.831 ms
rank =  0, finding Y'*HY took 8.550 ms
Rank 0, Project_Hamiltonian used 98.143 ms
Total time for projection: 98.192 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.239 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.789 ms
rank = 0, Solve_Generalized_EigenProblem used 1.031 ms
    first calculated eigval = -0.923008933227022
    last  calculated eigval = 0.039771971907793
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40116204440111
lambda[  10] =  -0.39722805537361
lambda[  11] =  -0.37565512778452
lambda[  12] =  -0.34681831064965
lambda[  13] =  -0.33878914250455
lambda[  14] =  -0.32045697168025
lambda[  15] =  -0.29842335430266
lambda[  16] =  -0.24002489828655
lambda[  17] =  -0.22817197815017
lambda[  18] =  -0.18294524335954
lambda[  19] =  -0.07817815279799
lambda[  20] =  -0.03466951588115
lambda[  21] =  -0.02008514651926
lambda[  22] =   0.01917133550029
lambda[  23] =   0.02472262440730
lambda[  24] =   0.02546712164142
lambda[  25] =   0.02682350605439
lambda[  26] =   0.03977197190779
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.059 ms
rank =  0, subspace rotation using ScaLAPACK took 10.617 ms
rank =  0, Distributing orbital back into band + domain format took 19.115 ms
rank = 0, Subspace_Rotation used 29.747 ms

Total time for subspace rotation: 29.751 ms
rank = 0, Efermi =  -0.107127543502 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.463 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.250 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 2189.549 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.357 ms
rank = 0, D2D took 1.228 ms
rank = 0, Transfering density took 1.233 ms
Etot    =   -56.214459987260
Eband   =   -16.155360240706
E1      =    37.758751239382
E2      =   -14.793182176478
E3      =   -21.368790023750
Exc     =   -19.138765330161
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 4.421e-06, dEband = 8.383e-04
rank = 0, Calculating/Estimating energy took 1.258 ms, Etot = -56.214459987, dEtot = 4.421e-06, dEband = 8.383e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0483916576455, which took 0.188 ms

iter_count = 108, r_2norm = 1.838e-06, tol*||rhs|| = 1.936e-06

Anderson update took 50.500 ms, out of which F'*F took 29.679 ms; b-Ax took 180.755 ms, out of which Lap took 170.643 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.864 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543663, int_b + int_rho = -1.273e-12, checking this took 0.174 ms
2-norm of RHS = 843.9200879540030, which took 0.185 ms

iter_count = 174, r_2norm = 8.132e-04, tol*||rhs|| = 8.439e-04

Anderson update took 85.337 ms, out of which F'*F took 48.509 ms; b-Ax took 288.811 ms, out of which Lap took 272.560 ms
Solving Poisson took 492.342 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.203120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 79.669 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.232969 
Total time for convolution: 	 convolve: 5.184750 
Total time for convolution: 	 convolve: 5.211107 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
---Transfer Veff_loc: D2D took 1.112 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.369 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.505 ms

This SCF took 27961.278 ms, scf error = 2.765e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.139772, lowerbound = -0.923009, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1926.310 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 17.028 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.311 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.297 ms
rank =  0, Distribute data + matrix mult took 24.648 ms
rank =  0, finding HY took 30.327 ms
rank =  0, distributing HY into block cyclic form took 16.979 ms
rank =  0, finding Y'*HY took 8.966 ms
Rank 0, Project_Hamiltonian used 80.972 ms
Total time for projection: 80.986 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.206 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.270 ms
    first calculated eigval = -0.922460288002048
    last  calculated eigval = 0.040490056148485
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40061787738542
lambda[  10] =  -0.39666794586414
lambda[  11] =  -0.37509681707753
lambda[  12] =  -0.34626999419783
lambda[  13] =  -0.33821449057933
lambda[  14] =  -0.31990374752843
lambda[  15] =  -0.29786652823571
lambda[  16] =  -0.23946186612722
lambda[  17] =  -0.22761725610915
lambda[  18] =  -0.18241683594106
lambda[  19] =  -0.07761621984491
lambda[  20] =  -0.03413717309991
lambda[  21] =  -0.01742688839385
lambda[  22] =   0.02313382747361
lambda[  23] =   0.02697788965238
lambda[  24] =   0.02745614636027
lambda[  25] =   0.02789566399367
lambda[  26] =   0.04049005614848
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.286 ms
rank =  0, subspace rotation using ScaLAPACK took 7.772 ms
rank =  0, Distributing orbital back into band + domain format took 16.850 ms
rank = 0, Subspace_Rotation used 24.634 ms

Total time for subspace rotation: 24.638 ms
rank = 0, Efermi =  -0.106565610574 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.512 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.247 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 2039.202 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
rank = 0, D2D took 3.281 ms
rank = 0, Transfering density took 3.288 ms
Etot    =   -56.214564434477
Eband   =   -16.135163303427
E1      =    37.749178033614
E2      =   -14.782264310427
E3      =   -21.369777081802
Exc     =   -19.139562700890
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 8.034e-06, dEband = 1.554e-03
rank = 0, Calculating/Estimating energy took 1.190 ms, Etot = -56.214564434, dEtot = 8.034e-06, dEband = 1.554e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0384365189707, which took 0.108 ms

iter_count = 114, r_2norm = 9.802e-07, tol*||rhs|| = 1.537e-06

Anderson update took 53.933 ms, out of which F'*F took 31.783 ms; b-Ax took 188.492 ms, out of which Lap took 177.624 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 327.209 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543661, int_b + int_rho = -1.295e-12, checking this took 0.178 ms
2-norm of RHS = 843.9167077783711, which took 0.168 ms

iter_count = 138, r_2norm = 7.343e-04, tol*||rhs|| = 8.439e-04

Anderson update took 66.724 ms, out of which F'*F took 38.615 ms; b-Ax took 228.956 ms, out of which Lap took 216.001 ms
Solving Poisson took 387.793 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Total time for convolution: 	 convolve: 5.209188 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.227254 
Total time for convolution: 	 convolve: 5.202978 
Total time for convolution: 	 convolve: 5.225661 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.103 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.534 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.249 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.353 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.595 ms
---Transfer Veff_loc: D2D took 1.126 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.352 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.518 ms

This SCF took 27721.041 ms, scf error = 1.776e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.140490, lowerbound = -0.922460, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1802.544 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 17.240 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.307 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.876 ms
rank =  0, Distribute data + matrix mult took 26.435 ms
rank =  0, finding HY took 30.308 ms
rank =  0, distributing HY into block cyclic form took 16.881 ms
rank =  0, finding Y'*HY took 9.645 ms
Rank 0, Project_Hamiltonian used 83.295 ms
Total time for projection: 83.311 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.193 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.259 ms
    first calculated eigval = -0.922264363189736
    last  calculated eigval = 0.039701502121201
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40044858759485
lambda[  10] =  -0.39651256948468
lambda[  11] =  -0.37493496384139
lambda[  12] =  -0.34609023561840
lambda[  13] =  -0.33803968392971
lambda[  14] =  -0.31972999241053
lambda[  15] =  -0.29770109711358
lambda[  16] =  -0.23930025079395
lambda[  17] =  -0.22744796759400
lambda[  18] =  -0.18223025286322
lambda[  19] =  -0.07745080011319
lambda[  20] =  -0.03400037760830
lambda[  21] =  -0.01748087956992
lambda[  22] =   0.02206755908316
lambda[  23] =   0.02693939379895
lambda[  24] =   0.02772392668815
lambda[  25] =   0.02783464489589
lambda[  26] =   0.03970150212120
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 7.749 ms
rank =  0, Distributing orbital back into band + domain format took 16.844 ms
rank = 0, Subspace_Rotation used 24.606 ms

Total time for subspace rotation: 24.611 ms
rank = 0, Efermi =  -0.106400190784 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.519 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.203 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.092 ms
rank = 0, Calculating density took 1917.680 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
rank = 0, D2D took 3.306 ms
rank = 0, Transfering density took 3.313 ms
Etot    =   -56.214606717973
Eband   =   -16.128990197107
E1      =    37.745767434144
E2      =   -14.779370919755
E3      =   -21.370250565447
Exc     =   -19.139947584209
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 3.253e-06, dEband = 4.749e-04
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -56.214606718, dEtot = 3.253e-06, dEband = 4.749e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0324013886529, which took 0.201 ms

iter_count = 108, r_2norm = 1.194e-06, tol*||rhs|| = 1.296e-06

Anderson update took 51.081 ms, out of which F'*F took 29.556 ms; b-Ax took 178.551 ms, out of which Lap took 168.370 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 309.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543663, int_b + int_rho = -1.273e-12, checking this took 0.180 ms
2-norm of RHS = 843.9171744406059, which took 0.916 ms

iter_count = 126, r_2norm = 7.947e-04, tol*||rhs|| = 8.439e-04

Anderson update took 61.023 ms, out of which F'*F took 34.940 ms; b-Ax took 209.024 ms, out of which Lap took 197.267 ms
Solving Poisson took 354.665 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.199675 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.755 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.211379 
Total time for convolution: 	 convolve: 5.201155 
Total time for convolution: 	 convolve: 5.197261 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.830 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.138 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.147 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 0.992 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.325 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.333 ms

This SCF took 27488.792 ms, scf error = 1.212e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.139702, lowerbound = -0.922264, upperbound = 267.610462

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (9 columns, degree = 45): 1623.553 ms
New BLOCK CYCLIC DOMAIN: nproc = 3, dims = (3, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 43.517 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 6.432 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.334 ms
rank =  0, Distribute data + matrix mult took 52.296 ms
rank =  0, finding HY took 29.994 ms
rank =  0, distributing HY into block cyclic form took 16.496 ms
rank =  0, finding Y'*HY took 9.271 ms
Rank 0, Project_Hamiltonian used 108.084 ms
Total time for projection: 108.100 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.194 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.257 ms
    first calculated eigval = -0.922209729452047
    last  calculated eigval = 0.040004150099595
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 36):
lambda[   9] =  -0.40036683986700
lambda[  10] =  -0.39642318469358
lambda[  11] =  -0.37485294915282
lambda[  12] =  -0.34601975034241
lambda[  13] =  -0.33797152877997
lambda[  14] =  -0.31964848978470
lambda[  15] =  -0.29762012504602
lambda[  16] =  -0.23921551078886
lambda[  17] =  -0.22736978534164
lambda[  18] =  -0.18216730420491
lambda[  19] =  -0.07737531780662
lambda[  20] =  -0.03392824148075
lambda[  21] =  -0.01675180176929
lambda[  22] =   0.02222993915687
lambda[  23] =   0.02745317590805
lambda[  24] =   0.02814058783217
lambda[  25] =   0.02896214687053
lambda[  26] =   0.04000415009960
==subpsace eigenproblem: bcast eigvals took 0.035 ms
Total time for solving subspace eigenvalue problem: 0.301 ms
rank =  0, subspace rotation using ScaLAPACK took 7.576 ms
rank =  0, Distributing orbital back into band + domain format took 16.287 ms
rank = 0, Subspace_Rotation used 23.873 ms

Total time for subspace rotation: 23.877 ms
rank = 0, Efermi =  -0.106324708457 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.451 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.624 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1763.115 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
rank = 0, D2D took 3.433 ms
rank = 0, Transfering density took 3.439 ms
Etot    =   -56.214627818404
Eband   =   -16.126185437772
E1      =    37.744488370346
E2      =   -14.777852837621
E3      =   -21.370190444395
Exc     =   -19.139916176991
Esc     =   -94.841057855244
Entropy =    -0.000000000759
dE = 1.623e-06, dEband = 2.158e-04
rank = 0, Calculating/Estimating energy took 1.226 ms, Etot = -56.214627818, dEtot = 1.623e-06, dEband = 2.158e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0220636943344, which took 0.144 ms

iter_count = 108, r_2norm = 8.477e-07, tol*||rhs|| = 8.825e-07

Anderson update took 50.703 ms, out of which F'*F took 29.803 ms; b-Ax took 179.002 ms, out of which Lap took 169.091 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 307.556 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -36.00000002543791, int_rho =  36.00000002543661, int_b + int_rho = -1.295e-12, checking this took 0.178 ms
2-norm of RHS = 843.9162453537600, which took 0.181 ms

iter_count = 132, r_2norm = 7.392e-04, tol*||rhs|| = 8.439e-04

Anderson update took 63.320 ms, out of which F'*F took 36.897 ms; b-Ax took 219.477 ms, out of which Lap took 207.440 ms
Solving Poisson took 367.714 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.195056 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 37.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Total time for convolution: 	 convolve: 5.210231 
Total time for convolution: 	 convolve: 5.223596 
Total time for convolution: 	 convolve: 5.157778 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.585 ms
---Transfer Veff_loc: D2D took 0.947 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 250000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.281 ms

This SCF took 27259.743 ms, scf error = 9.759e-05
The last 18 occupations of kpoints #1 are (Nelectron = 36):
lambda[   9] =  -0.40036683986700, occ[   9] =   2.00000000000000
lambda[  10] =  -0.39642318469358, occ[  10] =   2.00000000000000
lambda[  11] =  -0.37485294915282, occ[  11] =   2.00000000000000
lambda[  12] =  -0.34601975034241, occ[  12] =   2.00000000000000
lambda[  13] =  -0.33797152877997, occ[  13] =   2.00000000000000
lambda[  14] =  -0.31964848978470, occ[  14] =   2.00000000000000
lambda[  15] =  -0.29762012504602, occ[  15] =   2.00000000000000
lambda[  16] =  -0.23921551078886, occ[  16] =   2.00000000000000
lambda[  17] =  -0.22736978534164, occ[  17] =   2.00000000000000
lambda[  18] =  -0.18216730420491, occ[  18] =   2.00000000000000
lambda[  19] =  -0.07737531780662, occ[  19] =   0.00000002543664
lambda[  20] =  -0.03392824148075, occ[  20] =   0.00000000000000
lambda[  21] =  -0.01675180176929, occ[  21] =   0.00000000000000
lambda[  22] =   0.02222993915687, occ[  22] =   0.00000000000000
lambda[  23] =   0.02745317590805, occ[  23] =   0.00000000000000
lambda[  24] =   0.02814058783217, occ[  24] =   0.00000000000000
lambda[  25] =   0.02896214687053, occ[  25] =   0.00000000000000
lambda[  26] =   0.04000415009960, occ[  26] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 23 (90%) = 0.000000000000000.
Occupation of state 26 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 1.247 ms, time for Allreduce/Reduce: 11.335 ms 
Time for calculating local force components: 27.126 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00000027849603  -0.00000081229816  -1.15585351012781
 -0.00000002060826  -0.04402211196035  -0.02806607020316
 -0.00000000004873   0.04402208285185  -0.02806602677818
 -0.00000000102724  -0.04501627071293   0.02539523949607
  0.00000000863484   0.04501624471471   0.02539521998970
 -0.03863513660121   0.00000000718058   0.02957824200287
  0.03863512162681   0.00000001144875   0.02957822466107
  0.00000022645919   0.00000031232464   0.08117524872347
  0.00000019389750   0.00000042760052   0.02376208107582
  0.00000020384859  -0.02012000439998  -0.02008142568472
 -0.00000045779303   0.02011961237882  -0.02008040847617
  0.00000009431097  -0.02374321649339  -0.02644321667889
 -0.00000014901150   0.02374320589216  -0.02644375930589
force_loc = 
 -0.00000007055274  -0.00000012095957   1.13894767998710
  0.00000024428941   0.04703996340756   0.02991131007530
 -0.00000023563921  -0.04704011960283   0.02991142102511
  0.00000004991941   0.04783240852112  -0.02773790492821
 -0.00000015372736  -0.04783256411400  -0.02773798350619
  0.04050369886446   0.00000009320768  -0.03339135133350
 -0.04050364911876  -0.00000000763656  -0.03339103575232
  0.00000001059397  -0.00000040470115  -0.09550171458515
 -0.00000072580703   0.00000064417037  -0.01101969394274
 -0.00000056427394   0.01497333484955   0.02247920101838
 -0.00000066172962  -0.01497209150826   0.02248028820652
 -0.00000007966243   0.01939779891315   0.01943711670048
 -0.00000007309934  -0.01939726142688   0.01943728866909
Time for calculating nonlocal force components: 37.937 ms
[32mforces_xc: 
[0m[32m -0.00000001027006   0.00000001228167   0.02810596682662
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000001697284  -0.00000000437066   0.00535838511156
[0m[32m -0.00000003759693   0.00000001284868  -0.00191041232691
[0m[32m -0.00000004799656   0.00031471459027  -0.00366567912353
[0m[32m -0.00000001934616  -0.00031464632404  -0.00366566450050
[0m[32m -0.00000001245803   0.00148314118302   0.00592634349740
[0m[32m -0.00000000915651  -0.00148312597941   0.00592633738054
[0mTime for calculating XC forces components: 39.284 ms
 Cartesian force = 
 -0.00000016250742  -0.00000101835121   0.01121938767104
  0.00000042049256   0.00301775407207   0.00186449085727
 -0.00000003887653  -0.00301813412612   0.00186464523207
  0.00000024570358   0.00281604043305  -0.00232341444701
  0.00000005171890  -0.00281641677444  -0.00232351253135
  0.00186875907466   0.00000000301311  -0.00379385834549
 -0.00186833068054  -0.00000009356296  -0.00379356010611
  0.00000041689174  -0.00000019412232  -0.00894882976498
 -0.00000037269505   0.00000098724442   0.01085122579130
 -0.00000021161049  -0.00483205233531  -0.00124865280473
 -0.00000094205739   0.00483277717137  -0.00124653378502
  0.00000019900192  -0.00286237377237  -0.00106050549587
 -0.00000003445594   0.00286272111071  -0.00106088227113
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Time for printing density: 386.001 ms
The program took 451.202 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:42
Job ID:        2266805
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:31:36,vmem=8292K,walltime=00:07:38,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-14-2
---------------------------------------
