---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:07
Job ID:    2266589
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:15
Job ID:    2266589
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 14.802 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 10.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 19.209 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 146.174 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.973 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.141 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   12.029681	   11.247584	   11.666515	
   12.029681	   11.247584	    8.333485	
    7.970319	    8.752416	   11.666515	
    7.970319	    8.752416	    8.333485	
   10.806828	   11.209549	   10.000000	
    9.193172	    8.790451	   10.000000	
    9.193172	   13.456942	   10.000000	
   10.806828	    6.543058	   10.000000	
   12.138327	    4.757425	   10.000000	
    7.861673	   15.242575	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.224 ms
Set up communicators.

--set up spincomm took 2.224 ms

--set up kptcomm took 0.368 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.044 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.365 ms

Calculate_SplineDerivRadFun took 0.226 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.860 ms.
time spent on vectorized spline interp: 2.990 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.651 ms.
time spent on vectorized spline interp: 1.941 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.478 ms.
time spent on vectorized spline interp: 1.906 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.419 ms.

Calculating rb for all atom types took 17.260 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.067 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.015 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000317302, sum_int_rho = 29.5797929121945
PosCharge = 30.000000031730, NegCharge = -29.579792912195, scal_fac = 1.014205884429
After scaling, int_rho = 30.0000000317306, PosCharge + NegCharge - NetCharge = -3.837e-13
--Calculate Vref took 0.706 ms
--Calculate rho_guess took 3.749 ms

 integral of b = -30.0000000317302,
 int{b} + Nelectron + NetCharge = -3.173e-08,
 Esc = -80.3547260227569,
 MPI_Reduce took 11.176 ms

Calculating b & b_ref took 23.879 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.105 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.116 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.075 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.620 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.004 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.558 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173021, int_rho =  30.00000003173015, int_b + int_rho = -6.548e-14, checking this took 0.096 ms
2-norm of RHS = 760.5313681242868, which took 0.429 ms

iter_count = 420, r_2norm = 7.465e-04, tol*||rhs|| = 7.605e-04

Anderson update took 275.731 ms, out of which F'*F took 129.767 ms; b-Ax took 875.565 ms, out of which Lap took 779.946 ms
Solving Poisson took 1932.101 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.387 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
Total time for convolution: 	 convolve: 5.147868 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
Total time for convolution: 	 convolve: 5.140757 
Total time for convolution: 	 convolve: 5.141337 
Total time for convolution: 	 convolve: 5.135360 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.713 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.469 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.160 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
rank = 0, XC calculation took 24493.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 4.887 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.982 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.020 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.151 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.944 ms
    Lanczos iter 53, eigmin  = -0.938423931, eigmax = 264.931727788, err_eigmin = 5.654e-04, err_eigmax = 9.720e-03
rank =   0, Lanczos took 136.194 ms, eigmin = -0.938423930794, eigmax = 267.581045065572

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.271311, lowerbound = -1.038424, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1839.262 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 24.189 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.661 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.880 ms
rank =  0, finding HY took 29.257 ms
rank =  0, distributing HY into block cyclic form took 24.737 ms
rank =  0, finding Y'*HY took 6.793 ms
Rank 0, Project_Hamiltonian used 88.704 ms
Total time for projection: 89.099 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 1.376 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 1.489 ms
    first calculated eigval = 2.674127617328550
    last  calculated eigval = 3.271307515056386
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.84270423655382
lambda[   7] =   2.88036478978255
lambda[   8] =   2.88571900909352
lambda[   9] =   2.92779035052295
lambda[  10] =   2.94082345926483
lambda[  11] =   2.97344715790675
lambda[  12] =   2.98293588907956
lambda[  13] =   3.01306838474374
lambda[  14] =   3.01730028471048
lambda[  15] =   3.03429341538530
lambda[  16] =   3.05572463593962
lambda[  17] =   3.09415521686282
lambda[  18] =   3.10924328177480
lambda[  19] =   3.14563260017124
lambda[  20] =   3.15458328639070
lambda[  21] =   3.16422444112583
lambda[  22] =   3.21381880781045
lambda[  23] =   3.27130751505639
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 1.509 ms
rank =  0, subspace rotation using ScaLAPACK took 10.889 ms
rank =  0, Distributing orbital back into band + domain format took 22.582 ms
rank = 0, Subspace_Rotation used 33.495 ms

Total time for subspace rotation: 33.499 ms
rank = 0, Efermi =   3.045009029207 calculate fermi energy took 0.071 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.371308, lowerbound = -1.038424, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1821.411 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.020 ms
rank =  0, Distribute orbital to block cyclic format took 53.138 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.294 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 56.466 ms
rank =  0, finding HY took 29.636 ms
rank =  0, distributing HY into block cyclic form took 22.528 ms
rank =  0, finding Y'*HY took 5.755 ms
Rank 0, Project_Hamiltonian used 114.443 ms
Total time for projection: 114.451 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.187 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.109 ms
rank = 0, Solve_Generalized_EigenProblem used 0.300 ms
    first calculated eigval = -0.800636739422170
    last  calculated eigval = 0.446138157880495
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.25728883091759
lambda[   7] =  -0.19032165364625
lambda[   8] =  -0.16109129490991
lambda[   9] =  -0.08993453065167
lambda[  10] =  -0.06207579410535
lambda[  11] =  -0.04517987151895
lambda[  12] =   0.04901231802048
lambda[  13] =   0.09476534217714
lambda[  14] =   0.13784747533202
lambda[  15] =   0.21757382275899
lambda[  16] =   0.28185506604437
lambda[  17] =   0.31401329820722
lambda[  18] =   0.32393279484403
lambda[  19] =   0.34334312030731
lambda[  20] =   0.38280610987628
lambda[  21] =   0.39344721624571
lambda[  22] =   0.41199988636975
lambda[  23] =   0.44613815788050
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.309 ms
rank =  0, subspace rotation using ScaLAPACK took 10.756 ms
rank =  0, Distributing orbital back into band + domain format took 22.640 ms
rank = 0, Subspace_Rotation used 33.420 ms

Total time for subspace rotation: 33.427 ms
rank = 0, Efermi =   0.253106755514 calculate fermi energy took 0.045 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546138, lowerbound = -1.038424, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1842.095 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 52.764 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.361 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 56.156 ms
rank =  0, finding HY took 29.724 ms
rank =  0, distributing HY into block cyclic form took 22.551 ms
rank =  0, finding Y'*HY took 5.844 ms
Rank 0, Project_Hamiltonian used 114.910 ms
Total time for projection: 114.935 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.226 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.155 ms
rank = 0, Solve_Generalized_EigenProblem used 0.385 ms
    first calculated eigval = -0.957205802560827
    last  calculated eigval = 0.131571892313597
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55275426271183
lambda[   7] =  -0.54491906706321
lambda[   8] =  -0.48662592102319
lambda[   9] =  -0.46759649860503
lambda[  10] =  -0.42142808376541
lambda[  11] =  -0.41669585787558
lambda[  12] =  -0.38784245199344
lambda[  13] =  -0.37264359681022
lambda[  14] =  -0.36933800570928
lambda[  15] =  -0.34102223022689
lambda[  16] =  -0.06157398620056
lambda[  17] =  -0.01597248204366
lambda[  18] =   0.03020509125830
lambda[  19] =   0.04326366529986
lambda[  20] =   0.08846629539253
lambda[  21] =   0.09653248906764
lambda[  22] =   0.11539738317395
lambda[  23] =   0.13157189231360
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.405 ms
rank =  0, subspace rotation using ScaLAPACK took 10.762 ms
rank =  0, Distributing orbital back into band + domain format took 22.525 ms
rank = 0, Subspace_Rotation used 33.304 ms

Total time for subspace rotation: 33.309 ms
rank = 0, Efermi =  -0.090322528942 calculate fermi energy took 0.048 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.231572, lowerbound = -1.038424, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1809.205 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 50.574 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.334 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 53.941 ms
rank =  0, finding HY took 29.607 ms
rank =  0, distributing HY into block cyclic form took 22.641 ms
rank =  0, finding Y'*HY took 5.723 ms
Rank 0, Project_Hamiltonian used 111.949 ms
Total time for projection: 111.958 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.203 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.123 ms
rank = 0, Solve_Generalized_EigenProblem used 0.329 ms
    first calculated eigval = -0.957532955139645
    last  calculated eigval = 0.076373526650411
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55669611471900
lambda[   7] =  -0.54837187573315
lambda[   8] =  -0.50213976321321
lambda[   9] =  -0.47357593070874
lambda[  10] =  -0.42744093132110
lambda[  11] =  -0.42361078045663
lambda[  12] =  -0.39433469855912
lambda[  13] =  -0.38519550610932
lambda[  14] =  -0.38318847454634
lambda[  15] =  -0.38167763805186
lambda[  16] =  -0.10357357866713
lambda[  17] =  -0.08704779417634
lambda[  18] =  -0.05211422656091
lambda[  19] =  -0.03372256486963
lambda[  20] =   0.01235122499792
lambda[  21] =   0.02827152519858
lambda[  22] =   0.05387486801427
lambda[  23] =   0.07637352665041
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.339 ms
rank =  0, subspace rotation using ScaLAPACK took 10.804 ms
rank =  0, Distributing orbital back into band + domain format took 22.485 ms
rank = 0, Subspace_Rotation used 34.270 ms

Total time for subspace rotation: 34.276 ms
rank = 0, Efermi =  -0.132322121399 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 6.851 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.910 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.584 ms
rank = 0, Calculating density took 8038.633 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.977 ms
rank = 0, D2D took 2.084 ms
rank = 0, Transfering density took 2.093 ms
Etot    =   -47.323495495305
Eband   =   -17.229935884495
E1      =    35.079277983594
E2      =   -13.601301360493
E3      =   -16.791370744213
Exc     =   -15.210783675414
Esc     =   -80.354726022757
Entropy =    -0.000000000940
dE = 4.732e+00, dEband = 1.723e+00
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -47.323495495, dEtot = 4.732e+00, dEband = 1.723e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 52.9896696270820, which took 0.073 ms

iter_count = 96, r_2norm = 1.740e-03, tol*||rhs|| = 2.120e-03

Anderson update took 61.066 ms, out of which F'*F took 27.162 ms; b-Ax took 184.955 ms, out of which Lap took 162.982 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173062, int_b + int_rho = 4.002e-13, checking this took 0.121 ms
2-norm of RHS = 755.8144854725160, which took 1.098 ms

iter_count = 288, r_2norm = 6.185e-04, tol*||rhs|| = 7.558e-04

Anderson update took 182.091 ms, out of which F'*F took 81.308 ms; b-Ax took 569.618 ms, out of which Lap took 507.850 ms
Solving Poisson took 1300.719 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.387 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.201019 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.157166 
Total time for convolution: 	 convolve: 5.147456 
Total time for convolution: 	 convolve: 5.150048 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.172 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.536 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.115 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.687 ms

This SCF took 34597.406 ms, scf error = 1.860e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.176374, lowerbound = -0.957533, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1848.752 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.727 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.372 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.132 ms
rank =  0, finding HY took 29.067 ms
rank =  0, distributing HY into block cyclic form took 23.009 ms
rank =  0, finding Y'*HY took 6.224 ms
Rank 0, Project_Hamiltonian used 84.464 ms
Total time for projection: 84.482 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.176 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.278 ms
    first calculated eigval = -0.916496931525404
    last  calculated eigval = 0.049614272647082
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.53296800428177
lambda[   7] =  -0.52487131539378
lambda[   8] =  -0.47611461749886
lambda[   9] =  -0.45009664490460
lambda[  10] =  -0.38923409175438
lambda[  11] =  -0.38514881370016
lambda[  12] =  -0.36725157674931
lambda[  13] =  -0.35726765605383
lambda[  14] =  -0.35586232889052
lambda[  15] =  -0.35367272503186
lambda[  16] =  -0.08884077569297
lambda[  17] =  -0.07713500761251
lambda[  18] =  -0.06106201140964
lambda[  19] =  -0.04451970468468
lambda[  20] =  -0.01902210400295
lambda[  21] =   0.00698852412485
lambda[  22] =   0.03551618353602
lambda[  23] =   0.04961427264708
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.293 ms
rank =  0, subspace rotation using ScaLAPACK took 11.195 ms
rank =  0, Distributing orbital back into band + domain format took 22.602 ms
rank = 0, Subspace_Rotation used 33.822 ms

Total time for subspace rotation: 33.830 ms
rank = 0, Efermi =  -0.117589318663 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 6.733 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.213 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.623 ms
rank = 0, Calculating density took 1988.941 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.009 ms
rank = 0, D2D took 2.114 ms
rank = 0, Transfering density took 2.121 ms
Etot    =   -47.239939122026
Eband   =   -16.340736912513
E1      =    34.295013924747
E2      =   -13.534630598049
E3      =   -17.027165805349
Exc     =   -15.401286513961
Esc     =   -80.354726022757
Entropy =    -0.000000000940
dE = 8.356e-03, dEband = 8.892e-02
rank = 0, Calculating/Estimating energy took 1.069 ms, Etot = -47.239939122, dEtot = 8.356e-03, dEband = 8.892e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 27.2360043158488, which took 0.067 ms

iter_count = 102, r_2norm = 7.425e-04, tol*||rhs|| = 1.089e-03

Anderson update took 63.611 ms, out of which F'*F took 28.393 ms; b-Ax took 196.444 ms, out of which Lap took 174.031 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 449.498 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173062, int_b + int_rho = 4.002e-13, checking this took 0.121 ms
2-norm of RHS = 751.2857613831065, which took 0.132 ms

iter_count = 294, r_2norm = 6.989e-04, tol*||rhs|| = 7.513e-04

Anderson update took 182.369 ms, out of which F'*F took 81.600 ms; b-Ax took 558.047 ms, out of which Lap took 496.117 ms
Solving Poisson took 1271.854 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.144437 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.374 ms
Total time for convolution: 	 convolve: 5.155883 
Total time for convolution: 	 convolve: 5.151646 
Total time for convolution: 	 convolve: 5.161405 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.388 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.094 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.653 ms

This SCF took 28433.898 ms, scf error = 1.263e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.149614, lowerbound = -0.916497, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1860.698 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.669 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.025 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.721 ms
rank =  0, finding HY took 29.558 ms
rank =  0, distributing HY into block cyclic form took 22.953 ms
rank =  0, finding Y'*HY took 6.054 ms
Rank 0, Project_Hamiltonian used 85.331 ms
Total time for projection: 85.345 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.248 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.357 ms
    first calculated eigval = -0.866084289579599
    last  calculated eigval = 0.039944199141416
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.49512744718896
lambda[   7] =  -0.48481722830499
lambda[   8] =  -0.43527397828973
lambda[   9] =  -0.41264336216453
lambda[  10] =  -0.35089575754817
lambda[  11] =  -0.34566466280252
lambda[  12] =  -0.33369996957241
lambda[  13] =  -0.32354215479216
lambda[  14] =  -0.32216292281164
lambda[  15] =  -0.31901590589391
lambda[  16] =  -0.06088661953124
lambda[  17] =  -0.05388993699537
lambda[  18] =  -0.04823916006905
lambda[  19] =  -0.02653622641450
lambda[  20] =  -0.01847518779648
lambda[  21] =   0.00297089188261
lambda[  22] =   0.02458876131152
lambda[  23] =   0.03994419914142
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 1.246 ms
rank =  0, subspace rotation using ScaLAPACK took 11.196 ms
rank =  0, Distributing orbital back into band + domain format took 22.547 ms
rank = 0, Subspace_Rotation used 33.770 ms

Total time for subspace rotation: 33.779 ms
rank = 0, Efermi =  -0.089635336867 calculate fermi energy took 0.076 ms
rank = 0, --- Calculate rho: sum over local bands took 6.707 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.157 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.621 ms
rank = 0, Calculating density took 2001.729 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.027 ms
rank = 0, D2D took 2.133 ms
rank = 0, Transfering density took 2.138 ms
Etot    =   -47.180330006108
Eband   =   -15.143586919477
E1      =    33.282887590977
E2      =   -13.344625149812
E3      =   -17.364738369728
Exc     =   -15.674268173450
Esc     =   -80.354726022757
Entropy =    -0.000000000940
dE = 5.961e-03, dEband = 1.197e-01
rank = 0, Calculating/Estimating energy took 1.065 ms, Etot = -47.180330006, dEtot = 5.961e-03, dEband = 1.197e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.0917971374605, which took 0.077 ms

iter_count = 108, r_2norm = 1.867e-04, tol*||rhs|| = 2.837e-04

Anderson update took 67.172 ms, out of which F'*F took 30.179 ms; b-Ax took 206.780 ms, out of which Lap took 181.619 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.014 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173069, int_b + int_rho = 4.729e-13, checking this took 0.125 ms
2-norm of RHS = 750.4230228586026, which took 0.138 ms

iter_count = 282, r_2norm = 6.342e-04, tol*||rhs|| = 7.504e-04

Anderson update took 170.477 ms, out of which F'*F took 81.848 ms; b-Ax took 577.869 ms, out of which Lap took 517.078 ms
Solving Poisson took 1263.616 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.182168 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.941 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.176343 
Total time for convolution: 	 convolve: 5.184835 
Total time for convolution: 	 convolve: 5.214653 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.419 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.517 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.117 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.664 ms

This SCF took 28554.445 ms, scf error = 5.001e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.139944, lowerbound = -0.866084, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 2503.472 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 41.101 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 139.778 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 180.896 ms
rank =  0, finding HY took 19.758 ms
rank =  0, distributing HY into block cyclic form took 155.575 ms
rank =  0, finding Y'*HY took 44.230 ms
Rank 0, Project_Hamiltonian used 400.505 ms
Total time for projection: 400.527 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.192 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 13.732 ms
rank = 0, Solve_Generalized_EigenProblem used 13.928 ms
    first calculated eigval = -0.843403116230910
    last  calculated eigval = 0.034430908444502
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47630366893619
lambda[   7] =  -0.46542055467226
lambda[   8] =  -0.41568068967587
lambda[   9] =  -0.39375063916005
lambda[  10] =  -0.33355270317551
lambda[  11] =  -0.32765233755931
lambda[  12] =  -0.31767904690492
lambda[  13] =  -0.30768364692010
lambda[  14] =  -0.30606480350214
lambda[  15] =  -0.30297898726114
lambda[  16] =  -0.04710061965895
lambda[  17] =  -0.04388234178578
lambda[  18] =  -0.04160784316150
lambda[  19] =  -0.01568201071502
lambda[  20] =  -0.01197496289447
lambda[  21] =   0.00244728429435
lambda[  22] =   0.01824958055039
lambda[  23] =   0.03443090844450
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 13.948 ms
rank =  0, subspace rotation using ScaLAPACK took 10.451 ms
rank =  0, Distributing orbital back into band + domain format took 72.060 ms
rank = 0, Subspace_Rotation used 82.534 ms

Total time for subspace rotation: 82.540 ms
rank = 0, Efermi =  -0.075872208332 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 6.679 ms
rank = 0, --- Calculate rho: reduce over all band groups took 94.572 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.426 ms
rank = 0, Calculating density took 3104.315 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.011 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.090 ms
rank = 0, D2D took 23.001 ms
rank = 0, Transfering density took 23.013 ms
Etot    =   -47.170782039095
Eband   =   -14.576452262753
E1      =    32.848416695623
E2      =   -13.185721180503
E3      =   -17.539337772297
Exc     =   -15.813079401065
Esc     =   -80.354726022757
Entropy =    -0.000000000944
dE = 9.548e-04, dEband = 5.671e-02
rank = 0, Calculating/Estimating energy took 1.015 ms, Etot = -47.170782039, dEtot = 9.548e-04, dEband = 5.671e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.1139291241907, which took 0.055 ms

iter_count = 114, r_2norm = 5.497e-05, tol*||rhs|| = 8.456e-05

Anderson update took 135.593 ms, out of which F'*F took 32.601 ms; b-Ax took 289.433 ms, out of which Lap took 265.636 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 730.149 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173054, int_b + int_rho = 3.201e-13, checking this took 0.114 ms
2-norm of RHS = 751.6743154561043, which took 0.163 ms

iter_count = 270, r_2norm = 6.436e-04, tol*||rhs|| = 7.517e-04

Anderson update took 162.092 ms, out of which F'*F took 75.057 ms; b-Ax took 520.668 ms, out of which Lap took 465.430 ms
Solving Poisson took 1164.003 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.176131 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 5.615 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.187599 
Total time for convolution: 	 convolve: 5.322354 
Total time for convolution: 	 convolve: 5.183994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.398 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
---Transfer Veff_loc: D2D took 3.499 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.379 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.918 ms

This SCF took 29922.472 ms, scf error = 1.947e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134431, lowerbound = -0.843403, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1861.215 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.586 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.034 ms
rank =  0, finding HY took 28.698 ms
rank =  0, distributing HY into block cyclic form took 23.052 ms
rank =  0, finding Y'*HY took 5.632 ms
Rank 0, Project_Hamiltonian used 83.452 ms
Total time for projection: 83.467 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.839313386809767
    last  calculated eigval = 0.029925352008048
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47250310149858
lambda[   7] =  -0.46246521602233
lambda[   8] =  -0.41231472585810
lambda[   9] =  -0.38955012175795
lambda[  10] =  -0.32765419119404
lambda[  11] =  -0.32166433250164
lambda[  12] =  -0.31320717656843
lambda[  13] =  -0.30333654998848
lambda[  14] =  -0.30160460365568
lambda[  15] =  -0.29891154887525
lambda[  16] =  -0.04322351107463
lambda[  17] =  -0.04275780621285
lambda[  18] =  -0.03759320876068
lambda[  19] =  -0.01254884418435
lambda[  20] =  -0.00952591760638
lambda[  21] =   0.00134837031505
lambda[  22] =   0.01493533620041
lambda[  23] =   0.02992535200805
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.257 ms
rank =  0, subspace rotation using ScaLAPACK took 10.741 ms
rank =  0, Distributing orbital back into band + domain format took 22.610 ms
rank = 0, Subspace_Rotation used 33.374 ms

Total time for subspace rotation: 33.381 ms
rank = 0, Efermi =  -0.072394332306 calculate fermi energy took 1.023 ms
rank = 0, --- Calculate rho: sum over local bands took 7.088 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.280 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1999.398 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.937 ms
rank = 0, D2D took 2.037 ms
rank = 0, Transfering density took 2.040 ms
Etot    =   -47.168750152232
Eband   =   -14.452021649565
E1      =    32.816022981588
E2      =   -13.082877093102
E3      =   -17.580950914563
Exc     =   -15.841853468205
Esc     =   -80.354726022757
Entropy =    -0.000000000959
dE = 2.032e-04, dEband = 1.244e-02
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -47.168750152, dEtot = 2.032e-04, dEband = 1.244e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9506451626116, which took 0.077 ms

iter_count = 114, r_2norm = 2.623e-05, tol*||rhs|| = 3.803e-05

Anderson update took 70.543 ms, out of which F'*F took 32.152 ms; b-Ax took 221.271 ms, out of which Lap took 194.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 501.031 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173053, int_b + int_rho = 3.129e-13, checking this took 0.108 ms
2-norm of RHS = 752.0144154076227, which took 0.132 ms

iter_count = 240, r_2norm = 7.196e-04, tol*||rhs|| = 7.520e-04

Anderson update took 148.591 ms, out of which F'*F took 67.434 ms; b-Ax took 458.736 ms, out of which Lap took 410.547 ms
Solving Poisson took 1016.407 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.180003 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.186246 
Total time for convolution: 	 convolve: 5.180282 
Total time for convolution: 	 convolve: 5.187841 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.408 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 3.510 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.436 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.735 ms

This SCF took 28335.016 ms, scf error = 6.160e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129925, lowerbound = -0.839313, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1848.562 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.572 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.286 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.892 ms
rank =  0, finding HY took 29.984 ms
rank =  0, distributing HY into block cyclic form took 22.603 ms
rank =  0, finding Y'*HY took 5.525 ms
Rank 0, Project_Hamiltonian used 84.046 ms
Total time for projection: 84.057 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.095 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -0.837330869341978
    last  calculated eigval = 0.026332323406633
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47089799382017
lambda[   7] =  -0.46060686986933
lambda[   8] =  -0.41062697942208
lambda[   9] =  -0.38792739732988
lambda[  10] =  -0.32497090617636
lambda[  11] =  -0.31893132159522
lambda[  12] =  -0.31110050517081
lambda[  13] =  -0.30132119368487
lambda[  14] =  -0.29966425813165
lambda[  15] =  -0.29686928171929
lambda[  16] =  -0.04254650671136
lambda[  17] =  -0.04136523234600
lambda[  18] =  -0.03590640980974
lambda[  19] =  -0.01137422252498
lambda[  20] =  -0.00831476633432
lambda[  21] =   0.00051709748949
lambda[  22] =   0.01297303689926
lambda[  23] =   0.02633232340663
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.285 ms
rank =  0, subspace rotation using ScaLAPACK took 10.750 ms
rank =  0, Distributing orbital back into band + domain format took 22.574 ms
rank = 0, Subspace_Rotation used 33.346 ms

Total time for subspace rotation: 33.352 ms
rank = 0, Efermi =  -0.071508338993 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 6.985 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.740 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 1986.712 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.970 ms
rank = 0, D2D took 2.075 ms
rank = 0, Transfering density took 2.077 ms
Etot    =   -47.168214858913
Eband   =   -14.392572532026
E1      =    32.792167046361
E2      =   -13.043331658126
E3      =   -17.595607221716
Exc     =   -15.852022229378
Esc     =   -80.354726022757
Entropy =    -0.000000000955
dE = 5.353e-05, dEband = 5.945e-03
rank = 0, Calculating/Estimating energy took 1.057 ms, Etot = -47.168214859, dEtot = 5.353e-05, dEband = 5.945e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4466865947791, which took 0.062 ms

iter_count = 114, r_2norm = 1.326e-05, tol*||rhs|| = 1.787e-05

Anderson update took 70.248 ms, out of which F'*F took 31.557 ms; b-Ax took 215.173 ms, out of which Lap took 192.075 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.968 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173060, int_b + int_rho = 3.856e-13, checking this took 0.078 ms
2-norm of RHS = 752.3551507293654, which took 0.167 ms

iter_count = 252, r_2norm = 7.089e-04, tol*||rhs|| = 7.524e-04

Anderson update took 157.644 ms, out of which F'*F took 71.269 ms; b-Ax took 500.731 ms, out of which Lap took 448.685 ms
Solving Poisson took 1096.759 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.179072 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.186964 
Total time for convolution: 	 convolve: 5.182959 
Total time for convolution: 	 convolve: 5.197365 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.647 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.420 ms
---Transfer Veff_loc: D2D took 3.483 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.436 ms

This SCF took 28412.165 ms, scf error = 4.268e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.126332, lowerbound = -0.837331, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1871.321 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 22.734 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.253 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.018 ms
rank =  0, finding HY took 29.000 ms
rank =  0, distributing HY into block cyclic form took 22.694 ms
rank =  0, finding Y'*HY took 5.625 ms
Rank 0, Project_Hamiltonian used 83.379 ms
Total time for projection: 83.393 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.101 ms
rank = 0, Solve_Generalized_EigenProblem used 0.259 ms
    first calculated eigval = -0.833853375912688
    last  calculated eigval = 0.023436956479535
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46850000387553
lambda[   7] =  -0.45700501849666
lambda[   8] =  -0.40782864280104
lambda[   9] =  -0.38553490955340
lambda[  10] =  -0.32085650398888
lambda[  11] =  -0.31477967195693
lambda[  12] =  -0.30750273009836
lambda[  13] =  -0.29792332944330
lambda[  14] =  -0.29653194597523
lambda[  15] =  -0.29337366288460
lambda[  16] =  -0.04244646235822
lambda[  17] =  -0.03815174830977
lambda[  18] =  -0.03315780180052
lambda[  19] =  -0.00919769782780
lambda[  20] =  -0.00602881750123
lambda[  21] =  -0.00035647164646
lambda[  22] =   0.01182966818614
lambda[  23] =   0.02343695647953
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.298 ms
rank =  0, subspace rotation using ScaLAPACK took 10.753 ms
rank =  0, Distributing orbital back into band + domain format took 22.485 ms
rank = 0, Subspace_Rotation used 33.261 ms

Total time for subspace rotation: 33.270 ms
rank = 0, Efermi =  -0.071200859800 calculate fermi energy took 0.079 ms
rank = 0, --- Calculate rho: sum over local bands took 7.065 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.852 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 2008.942 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.993 ms
rank = 0, D2D took 2.091 ms
rank = 0, Transfering density took 2.093 ms
Etot    =   -47.167705294787
Eband   =   -14.293600580943
E1      =    32.747235659329
E2      =   -12.984275595700
E3      =   -17.613205625896
Exc     =   -15.864095571071
Esc     =   -80.354726022757
Entropy =    -0.000000000941
dE = 5.096e-05, dEband = 9.897e-03
rank = 0, Calculating/Estimating energy took 1.055 ms, Etot = -47.167705295, dEtot = 5.096e-05, dEband = 9.897e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3227314948979, which took 0.058 ms

iter_count = 108, r_2norm = 1.233e-05, tol*||rhs|| = 1.291e-05

Anderson update took 65.446 ms, out of which F'*F took 29.383 ms; b-Ax took 202.220 ms, out of which Lap took 178.748 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.030 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173059, int_b + int_rho = 3.711e-13, checking this took 0.109 ms
2-norm of RHS = 752.3189260883266, which took 0.221 ms

iter_count = 240, r_2norm = 6.547e-04, tol*||rhs|| = 7.523e-04

Anderson update took 148.709 ms, out of which F'*F took 66.227 ms; b-Ax took 448.911 ms, out of which Lap took 400.819 ms
Solving Poisson took 1009.560 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.173260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.874 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.185671 
Total time for convolution: 	 convolve: 5.180564 
Total time for convolution: 	 convolve: 5.197799 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.397 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.864 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.369 ms

This SCF took 28506.898 ms, scf error = 2.126e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.123437, lowerbound = -0.833853, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1839.022 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.564 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.357 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.949 ms
rank =  0, finding HY took 28.840 ms
rank =  0, distributing HY into block cyclic form took 23.196 ms
rank =  0, finding Y'*HY took 5.507 ms
Rank 0, Project_Hamiltonian used 83.530 ms
Total time for projection: 83.545 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.830867772937334
    last  calculated eigval = 0.021612543866819
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46737331365999
lambda[   7] =  -0.45506471101716
lambda[   8] =  -0.40644426822463
lambda[   9] =  -0.38417156046728
lambda[  10] =  -0.31776744432663
lambda[  11] =  -0.31171822493848
lambda[  12] =  -0.30456303885379
lambda[  13] =  -0.29514911144677
lambda[  14] =  -0.29403014887625
lambda[  15] =  -0.29067128754556
lambda[  16] =  -0.04175743842310
lambda[  17] =  -0.03574891180649
lambda[  18] =  -0.03101665110433
lambda[  19] =  -0.00743050609921
lambda[  20] =  -0.00442473854251
lambda[  21] =   0.00056217345808
lambda[  22] =   0.01228801454960
lambda[  23] =   0.02161254386682
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.293 ms
rank =  0, subspace rotation using ScaLAPACK took 10.743 ms
rank =  0, Distributing orbital back into band + domain format took 22.436 ms
rank = 0, Subspace_Rotation used 33.199 ms

Total time for subspace rotation: 33.207 ms
rank = 0, Efermi =  -0.070506632722 calculate fermi energy took 0.075 ms
rank = 0, --- Calculate rho: sum over local bands took 7.066 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.796 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.608 ms
rank = 0, Calculating density took 1976.692 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.858 ms
rank = 0, D2D took 2.956 ms
rank = 0, Transfering density took 2.959 ms
Etot    =   -47.167753140837
Eband   =   -14.225200495812
E1      =    32.709997067464
E2      =   -12.950468479057
E3      =   -17.622988893770
Exc     =   -15.871281061618
Esc     =   -80.354726022757
Entropy =    -0.000000000940
dE = 4.785e-06, dEband = 6.840e-03
rank = 0, Calculating/Estimating energy took 1.026 ms, Etot = -47.167753141, dEtot = 4.785e-06, dEband = 6.840e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2095904572592, which took 0.060 ms

iter_count = 114, r_2norm = 6.336e-06, tol*||rhs|| = 8.384e-06

Anderson update took 68.737 ms, out of which F'*F took 31.111 ms; b-Ax took 213.336 ms, out of which Lap took 189.226 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.473 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173058, int_b + int_rho = 3.565e-13, checking this took 0.114 ms
2-norm of RHS = 752.3299669779283, which took 0.190 ms

iter_count = 198, r_2norm = 7.176e-04, tol*||rhs|| = 7.523e-04

Anderson update took 411.036 ms, out of which F'*F took 304.965 ms; b-Ax took 1369.412 ms, out of which Lap took 1236.874 ms
Solving Poisson took 2378.148 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.192469 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.453 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.187342 
Total time for convolution: 	 convolve: 5.188290 
Total time for convolution: 	 convolve: 5.184226 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.876 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.514 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.867 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.420 ms

This SCF took 29642.002 ms, scf error = 1.216e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.121613, lowerbound = -0.830868, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1835.648 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.472 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.413 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.919 ms
rank =  0, finding HY took 28.898 ms
rank =  0, distributing HY into block cyclic form took 23.127 ms
rank =  0, finding Y'*HY took 5.717 ms
Rank 0, Project_Hamiltonian used 83.711 ms
Total time for projection: 83.730 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.156 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.252 ms
    first calculated eigval = -0.830596910309073
    last  calculated eigval = 0.020721961942657
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46708429025824
lambda[   7] =  -0.45469475919376
lambda[   8] =  -0.40612628707533
lambda[   9] =  -0.38390335836028
lambda[  10] =  -0.31740800652507
lambda[  11] =  -0.31137082948906
lambda[  12] =  -0.30420887175712
lambda[  13] =  -0.29481507271653
lambda[  14] =  -0.29371158207139
lambda[  15] =  -0.29031180835214
lambda[  16] =  -0.04122742806616
lambda[  17] =  -0.03538289150927
lambda[  18] =  -0.03067813177968
lambda[  19] =  -0.00711170668945
lambda[  20] =  -0.00423734394146
lambda[  21] =   0.00141692490454
lambda[  22] =   0.01260947008102
lambda[  23] =   0.02072196194266
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 10.710 ms
rank =  0, Distributing orbital back into band + domain format took 22.917 ms
rank = 0, Subspace_Rotation used 33.649 ms

Total time for subspace rotation: 33.654 ms
rank = 0, Efermi =  -0.069976778675 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 6.990 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.088 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.623 ms
rank = 0, Calculating density took 1974.201 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.999 ms
rank = 0, D2D took 2.097 ms
rank = 0, Transfering density took 2.104 ms
Etot    =   -47.167875121587
Eband   =   -14.215580054990
E1      =    32.706962045586
E2      =   -12.943923147021
E3      =   -17.622081587470
Exc     =   -15.870535822976
Esc     =   -80.354726022757
Entropy =    -0.000000000941
dE = 1.220e-05, dEband = 9.620e-04
rank = 0, Calculating/Estimating energy took 1.325 ms, Etot = -47.167875122, dEtot = 1.220e-05, dEband = 9.620e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1210936881245, which took 0.074 ms

iter_count = 108, r_2norm = 4.653e-06, tol*||rhs|| = 4.844e-06

Anderson update took 65.429 ms, out of which F'*F took 30.004 ms; b-Ax took 203.387 ms, out of which Lap took 181.365 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 461.041 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173060, int_b + int_rho = 3.820e-13, checking this took 0.108 ms
2-norm of RHS = 752.3090059963317, which took 0.152 ms

iter_count = 216, r_2norm = 7.294e-04, tol*||rhs|| = 7.523e-04

Anderson update took 132.326 ms, out of which F'*F took 59.190 ms; b-Ax took 404.336 ms, out of which Lap took 359.575 ms
Solving Poisson took 904.177 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.184308 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.192588 
Total time for convolution: 	 convolve: 5.184696 
Total time for convolution: 	 convolve: 5.197655 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.598 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.470 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.142 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.650 ms

This SCF took 28116.047 ms, scf error = 9.409e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.120722, lowerbound = -0.830597, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1854.674 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.535 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.564 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.139 ms
rank =  0, finding HY took 28.784 ms
rank =  0, distributing HY into block cyclic form took 22.922 ms
rank =  0, finding Y'*HY took 5.572 ms
Rank 0, Project_Hamiltonian used 83.457 ms
Total time for projection: 83.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.829273887453707
    last  calculated eigval = 0.022603346501710
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46593006601431
lambda[   7] =  -0.45344098505204
lambda[   8] =  -0.40493748179722
lambda[   9] =  -0.38273432904157
lambda[  10] =  -0.31610159105619
lambda[  11] =  -0.31006720904624
lambda[  12] =  -0.30287184436164
lambda[  13] =  -0.29352835367546
lambda[  14] =  -0.29244861033176
lambda[  15] =  -0.28900206280568
lambda[  16] =  -0.03814255443484
lambda[  17] =  -0.03402402584315
lambda[  18] =  -0.02935138982447
lambda[  19] =  -0.00526150169308
lambda[  20] =  -0.00293590458708
lambda[  21] =   0.00596747394108
lambda[  22] =   0.01637419534400
lambda[  23] =   0.02260334650171
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 10.720 ms
rank =  0, Distributing orbital back into band + domain format took 22.308 ms
rank = 0, Subspace_Rotation used 33.049 ms

Total time for subspace rotation: 33.055 ms
rank = 0, Efermi =  -0.066898391455 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 6.729 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.323 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.578 ms
rank = 0, Calculating density took 1992.275 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.958 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.069 ms
Etot    =   -47.168002082392
Eband   =   -14.177750316637
E1      =    32.688219592411
E2      =   -12.924219896684
E3      =   -17.624678871494
Exc     =   -15.872644102646
Esc     =   -80.354726022757
Entropy =    -0.000000000942
dE = 1.270e-05, dEband = 3.783e-03
rank = 0, Calculating/Estimating energy took 1.051 ms, Etot = -47.168002082, dEtot = 1.270e-05, dEband = 3.783e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0793765631370, which took 0.060 ms

iter_count = 114, r_2norm = 2.488e-06, tol*||rhs|| = 3.175e-06

Anderson update took 68.799 ms, out of which F'*F took 30.934 ms; b-Ax took 213.364 ms, out of which Lap took 188.495 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 492.166 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173066, int_b + int_rho = 4.475e-13, checking this took 0.113 ms
2-norm of RHS = 752.3087517318509, which took 0.207 ms

iter_count = 174, r_2norm = 6.362e-04, tol*||rhs|| = 7.523e-04

Anderson update took 107.116 ms, out of which F'*F took 47.961 ms; b-Ax took 326.130 ms, out of which Lap took 290.112 ms
Solving Poisson took 734.414 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.180470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.183559 
Total time for convolution: 	 convolve: 5.178155 
Total time for convolution: 	 convolve: 5.203443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.616 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.469 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.060 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.567 ms

This SCF took 27976.186 ms, scf error = 5.302e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.122603, lowerbound = -0.829274, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1840.629 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.507 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.456 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.000 ms
rank =  0, finding HY took 28.885 ms
rank =  0, distributing HY into block cyclic form took 23.133 ms
rank =  0, finding Y'*HY took 5.411 ms
Rank 0, Project_Hamiltonian used 83.467 ms
Total time for projection: 83.477 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.155 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.246 ms
    first calculated eigval = -0.828837764687982
    last  calculated eigval = 0.022996632168758
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46553987094020
lambda[   7] =  -0.45300627481348
lambda[   8] =  -0.40453443556585
lambda[   9] =  -0.38234914782224
lambda[  10] =  -0.31566835395189
lambda[  11] =  -0.30963322871073
lambda[  12] =  -0.30243715146071
lambda[  13] =  -0.29310662576320
lambda[  14] =  -0.29203610250904
lambda[  15] =  -0.28857265951145
lambda[  16] =  -0.03731094006312
lambda[  17] =  -0.03360738389509
lambda[  18] =  -0.02893770064811
lambda[  19] =  -0.00478034835322
lambda[  20] =  -0.00248362174607
lambda[  21] =   0.00745265116539
lambda[  22] =   0.01736991138407
lambda[  23] =   0.02299663216876
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 10.661 ms
rank =  0, Distributing orbital back into band + domain format took 23.137 ms
rank = 0, Subspace_Rotation used 33.824 ms

Total time for subspace rotation: 33.830 ms
rank = 0, Efermi =  -0.066071639143 calculate fermi energy took 0.340 ms
rank = 0, --- Calculate rho: sum over local bands took 7.042 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.298 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1978.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.999 ms
rank = 0, D2D took 2.107 ms
rank = 0, Transfering density took 2.113 ms
Etot    =   -47.168067667388
Eband   =   -14.165121720161
E1      =    32.681578010119
E2      =   -12.917946012591
E3      =   -17.625763821556
Exc     =   -15.873507767793
Esc     =   -80.354726022757
Entropy =    -0.000000000942
dE = 6.558e-06, dEband = 1.263e-03
rank = 0, Calculating/Estimating energy took 1.044 ms, Etot = -47.168067667, dEtot = 6.558e-06, dEband = 1.263e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0663860111331, which took 0.085 ms

iter_count = 108, r_2norm = 2.419e-06, tol*||rhs|| = 2.655e-06

Anderson update took 65.268 ms, out of which F'*F took 29.687 ms; b-Ax took 204.088 ms, out of which Lap took 181.061 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 460.714 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173039, int_b + int_rho = 1.673e-13, checking this took 0.111 ms
2-norm of RHS = 752.3263046591622, which took 0.213 ms

iter_count = 192, r_2norm = 6.169e-04, tol*||rhs|| = 7.523e-04

Anderson update took 117.935 ms, out of which F'*F took 52.993 ms; b-Ax took 359.676 ms, out of which Lap took 321.063 ms
Solving Poisson took 805.690 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.185963 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.195974 
Total time for convolution: 	 convolve: 5.179114 
Total time for convolution: 	 convolve: 5.192790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.781 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.333 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.486 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.159 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.683 ms

This SCF took 28016.624 ms, scf error = 4.181e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.122997, lowerbound = -0.828838, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1856.402 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.590 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.087 ms
rank =  0, finding HY took 28.988 ms
rank =  0, distributing HY into block cyclic form took 22.707 ms
rank =  0, finding Y'*HY took 5.658 ms
Rank 0, Project_Hamiltonian used 83.482 ms
Total time for projection: 83.499 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.150 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.666 ms
rank = 0, Solve_Generalized_EigenProblem used 1.257 ms
    first calculated eigval = -0.828144344207887
    last  calculated eigval = 0.026031331862371
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46480268712050
lambda[   7] =  -0.45223837653741
lambda[   8] =  -0.40379968934544
lambda[   9] =  -0.38162833968198
lambda[  10] =  -0.31502304110990
lambda[  11] =  -0.30898796477388
lambda[  12] =  -0.30174321497241
lambda[  13] =  -0.29242432648964
lambda[  14] =  -0.29135213260817
lambda[  15] =  -0.28788055036113
lambda[  16] =  -0.03514692249251
lambda[  17] =  -0.03293179441618
lambda[  18] =  -0.02821679530829
lambda[  19] =  -0.00379764324286
lambda[  20] =  -0.00107875385528
lambda[  21] =   0.01052498861392
lambda[  22] =   0.02024340929855
lambda[  23] =   0.02603133186237
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 1.282 ms
rank =  0, subspace rotation using ScaLAPACK took 10.712 ms
rank =  0, Distributing orbital back into band + domain format took 22.521 ms
rank = 0, Subspace_Rotation used 33.256 ms

Total time for subspace rotation: 33.263 ms
rank = 0, Efermi =  -0.063965791138 calculate fermi energy took 0.066 ms
rank = 0, --- Calculate rho: sum over local bands took 7.062 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.623 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1994.863 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.959 ms
rank = 0, D2D took 2.056 ms
rank = 0, Transfering density took 2.059 ms
Etot    =   -47.168172950885
Eband   =   -14.143871077036
E1      =    32.671236035396
E2      =   -12.906655070465
E3      =   -17.627112917353
Exc     =   -15.874579873359
Esc     =   -80.354726022757
Entropy =    -0.000000000948
dE = 1.053e-05, dEband = 2.125e-03
rank = 0, Calculating/Estimating energy took 1.054 ms, Etot = -47.168172951, dEtot = 1.053e-05, dEband = 2.125e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0585383048978, which took 0.064 ms

iter_count = 108, r_2norm = 1.936e-06, tol*||rhs|| = 2.342e-06

Anderson update took 64.896 ms, out of which F'*F took 29.543 ms; b-Ax took 202.540 ms, out of which Lap took 179.223 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 462.347 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173063, int_b + int_rho = 4.111e-13, checking this took 0.115 ms
2-norm of RHS = 752.3322188108092, which took 0.144 ms

iter_count = 156, r_2norm = 6.788e-04, tol*||rhs|| = 7.523e-04

Anderson update took 95.915 ms, out of which F'*F took 42.549 ms; b-Ax took 290.760 ms, out of which Lap took 258.279 ms
Solving Poisson took 654.104 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.180936 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.182 ms
Total time for convolution: 	 convolve: 5.194004 
Total time for convolution: 	 convolve: 5.182913 
Total time for convolution: 	 convolve: 5.194106 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.326 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
---Transfer Veff_loc: D2D took 3.489 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.434 ms

This SCF took 27876.306 ms, scf error = 2.436e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.126031, lowerbound = -0.828144, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1838.731 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.721 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.676 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.440 ms
rank =  0, finding HY took 28.238 ms
rank =  0, distributing HY into block cyclic form took 23.130 ms
rank =  0, finding Y'*HY took 5.346 ms
Rank 0, Project_Hamiltonian used 84.193 ms
Total time for projection: 84.211 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.248 ms
    first calculated eigval = -0.827895311444617
    last  calculated eigval = 0.028003907232615
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46454568878831
lambda[   7] =  -0.45198150091943
lambda[   8] =  -0.40354533885183
lambda[   9] =  -0.38137406919818
lambda[  10] =  -0.31479450636419
lambda[  11] =  -0.30875991722298
lambda[  12] =  -0.30149696115100
lambda[  13] =  -0.29218198077185
lambda[  14] =  -0.29110840621423
lambda[  15] =  -0.28763665790729
lambda[  16] =  -0.03412327881939
lambda[  17] =  -0.03270531197033
lambda[  18] =  -0.02796073334682
lambda[  19] =  -0.00342254905240
lambda[  20] =  -0.00023463885985
lambda[  21] =   0.01207634157628
lambda[  22] =   0.02151440467585
lambda[  23] =   0.02800390723261
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.282 ms
rank =  0, subspace rotation using ScaLAPACK took 10.645 ms
rank =  0, Distributing orbital back into band + domain format took 22.578 ms
rank = 0, Subspace_Rotation used 33.245 ms

Total time for subspace rotation: 33.251 ms
rank = 0, Efermi =  -0.063039319441 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 7.142 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.704 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.596 ms
rank = 0, Calculating density took 1977.062 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.996 ms
rank = 0, D2D took 2.103 ms
rank = 0, Transfering density took 2.108 ms
Etot    =   -47.168217968088
Eband   =   -14.136425149580
E1      =    32.667659976842
E2      =   -12.902666921573
E3      =   -17.627484670332
Exc     =   -15.874878363546
Esc     =   -80.354726022757
Entropy =    -0.000000000953
dE = 4.502e-06, dEband = 7.446e-04
rank = 0, Calculating/Estimating energy took 1.047 ms, Etot = -47.168217968, dEtot = 4.502e-06, dEband = 7.446e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322177765703, which took 0.077 ms

iter_count = 114, r_2norm = 7.807e-07, tol*||rhs|| = 1.289e-06

Anderson update took 68.859 ms, out of which F'*F took 31.498 ms; b-Ax took 213.966 ms, out of which Lap took 190.087 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 488.487 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173074, int_b + int_rho = 5.166e-13, checking this took 0.108 ms
2-norm of RHS = 752.3408746637316, which took 0.185 ms

iter_count = 162, r_2norm = 6.988e-04, tol*||rhs|| = 7.523e-04

Anderson update took 100.303 ms, out of which F'*F took 45.119 ms; b-Ax took 303.495 ms, out of which Lap took 271.135 ms
Solving Poisson took 681.945 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.287 ms
Total time for convolution: 	 convolve: 5.181668 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.365 ms
Total time for convolution: 	 convolve: 5.186326 
Total time for convolution: 	 convolve: 5.179838 
Total time for convolution: 	 convolve: 5.185746 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.194 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.533 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.109 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.680 ms

This SCF took 27894.300 ms, scf error = 1.940e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.128004, lowerbound = -0.827895, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1836.489 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 22.453 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.482 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.970 ms
rank =  0, finding HY took 28.923 ms
rank =  0, distributing HY into block cyclic form took 22.944 ms
rank =  0, finding Y'*HY took 5.557 ms
Rank 0, Project_Hamiltonian used 83.437 ms
Total time for projection: 83.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 0.263 ms
    first calculated eigval = -0.827701525996929
    last  calculated eigval = 0.029115960431277
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46432987205665
lambda[   7] =  -0.45179213083898
lambda[   8] =  -0.40333352706666
lambda[   9] =  -0.38115874218216
lambda[  10] =  -0.31460602906480
lambda[  11] =  -0.30857020085790
lambda[  12] =  -0.30130295569567
lambda[  13] =  -0.29199336675890
lambda[  14] =  -0.29091543600540
lambda[  15] =  -0.28744646082010
lambda[  16] =  -0.03394263929979
lambda[  17] =  -0.03257186526599
lambda[  18] =  -0.02779932706424
lambda[  19] =  -0.00328263996825
lambda[  20] =   0.00068715618657
lambda[  21] =   0.01237767582950
lambda[  22] =   0.02126677476058
lambda[  23] =   0.02911596043128
==subpsace eigenproblem: bcast eigvals took 0.023 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 10.743 ms
rank =  0, Distributing orbital back into band + domain format took 22.571 ms
rank = 0, Subspace_Rotation used 33.336 ms

Total time for subspace rotation: 33.342 ms
rank = 0, Efermi =  -0.062867093748 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 7.083 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.784 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1974.201 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.980 ms
rank = 0, D2D took 2.076 ms
rank = 0, Transfering density took 2.079 ms
Etot    =   -47.168282389219
Eband   =   -14.130472977429
E1      =    32.665147375508
E2      =   -12.899152295747
E3      =   -17.627525566743
Exc     =   -15.874908626078
Esc     =   -80.354726022757
Entropy =    -0.000000000953
dE = 6.442e-06, dEband = 5.952e-04
rank = 0, Calculating/Estimating energy took 1.086 ms, Etot = -47.168282389, dEtot = 6.442e-06, dEband = 5.952e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0295007156170, which took 0.065 ms

iter_count = 114, r_2norm = 7.304e-07, tol*||rhs|| = 1.180e-06

Anderson update took 68.372 ms, out of which F'*F took 31.076 ms; b-Ax took 213.297 ms, out of which Lap took 188.561 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 487.272 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173048, int_b + int_rho = 2.619e-13, checking this took 0.115 ms
2-norm of RHS = 752.3390977151032, which took 0.177 ms

iter_count = 102, r_2norm = 7.453e-04, tol*||rhs|| = 7.523e-04

Anderson update took 62.253 ms, out of which F'*F took 27.762 ms; b-Ax took 189.914 ms, out of which Lap took 168.810 ms
Solving Poisson took 429.582 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.333 ms
Total time for convolution: 	 convolve: 5.186908 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.383 ms
Total time for convolution: 	 convolve: 5.181691 
Total time for convolution: 	 convolve: 6.524374 
Total time for convolution: 	 convolve: 5.180794 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.060 ms
---Transfer Veff_loc: D2D took 4.294 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.887 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.216 ms

This SCF took 28988.840 ms, scf error = 1.438e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.129116, lowerbound = -0.827702, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1850.895 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.994 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.634 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.665 ms
rank =  0, finding HY took 28.699 ms
rank =  0, distributing HY into block cyclic form took 23.103 ms
rank =  0, finding Y'*HY took 5.649 ms
Rank 0, Project_Hamiltonian used 84.161 ms
Total time for projection: 84.175 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.151 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.827628067548639
    last  calculated eigval = 0.029402384436373
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46426728969349
lambda[   7] =  -0.45172310538405
lambda[   8] =  -0.40326863369903
lambda[   9] =  -0.38109623970677
lambda[  10] =  -0.31453713622362
lambda[  11] =  -0.30850078416630
lambda[  12] =  -0.30123314103004
lambda[  13] =  -0.29192555591276
lambda[  14] =  -0.29084929429176
lambda[  15] =  -0.28737814319939
lambda[  16] =  -0.03377637935163
lambda[  17] =  -0.03251308962919
lambda[  18] =  -0.02774136951172
lambda[  19] =  -0.00322313549306
lambda[  20] =   0.00102635489886
lambda[  21] =   0.01251655797340
lambda[  22] =   0.02133626543583
lambda[  23] =   0.02940238443637
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.279 ms
rank =  0, subspace rotation using ScaLAPACK took 10.653 ms
rank =  0, Distributing orbital back into band + domain format took 22.530 ms
rank = 0, Subspace_Rotation used 33.215 ms

Total time for subspace rotation: 33.221 ms
rank = 0, Efermi =  -0.062721430783 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 7.195 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.590 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.600 ms
rank = 0, Calculating density took 1989.120 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.976 ms
rank = 0, D2D took 2.081 ms
rank = 0, Transfering density took 2.086 ms
Etot    =   -47.168289368086
Eband   =   -14.128432548427
E1      =    32.664014417920
E2      =   -12.898209076613
E3      =   -17.627682047885
Exc     =   -15.875036338366
Esc     =   -80.354726022757
Entropy =    -0.000000000954
dE = 6.979e-07, dEband = 2.040e-04
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -47.168289368, dEtot = 6.979e-07, dEband = 2.040e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0256032681550, which took 0.082 ms

iter_count = 108, r_2norm = 8.668e-07, tol*||rhs|| = 1.024e-06

Anderson update took 65.975 ms, out of which F'*F took 29.990 ms; b-Ax took 203.220 ms, out of which Lap took 180.228 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.021 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173059, int_b + int_rho = 3.674e-13, checking this took 0.174 ms
2-norm of RHS = 752.3361097481232, which took 0.113 ms

iter_count = 126, r_2norm = 6.741e-04, tol*||rhs|| = 7.523e-04

Anderson update took 77.750 ms, out of which F'*F took 35.111 ms; b-Ax took 237.367 ms, out of which Lap took 211.785 ms
Solving Poisson took 533.741 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
Total time for convolution: 	 convolve: 5.185273 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.178633 
Total time for convolution: 	 convolve: 5.200338 
Total time for convolution: 	 convolve: 5.185120 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.130 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.527 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.912 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.477 ms

This SCF took 27754.382 ms, scf error = 1.178e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.129402, lowerbound = -0.827628, upperbound = 267.581045

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1844.754 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.629 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.323 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 25.983 ms
rank =  0, finding HY took 28.860 ms
rank =  0, distributing HY into block cyclic form took 23.090 ms
rank =  0, finding Y'*HY took 5.642 ms
Rank 0, Project_Hamiltonian used 83.615 ms
Total time for projection: 83.629 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.262 ms
    first calculated eigval = -0.827515278550013
    last  calculated eigval = 0.029809248768157
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46416424316117
lambda[   7] =  -0.45161010156352
lambda[   8] =  -0.40316284598668
lambda[   9] =  -0.38099356345298
lambda[  10] =  -0.31442995674756
lambda[  11] =  -0.30839349470067
lambda[  12] =  -0.30112097625181
lambda[  13] =  -0.29181731334550
lambda[  14] =  -0.29074326065284
lambda[  15] =  -0.28726821047295
lambda[  16] =  -0.03347172232338
lambda[  17] =  -0.03241285706204
lambda[  18] =  -0.02765062223554
lambda[  19] =  -0.00314481895028
lambda[  20] =   0.00171346564483
lambda[  21] =   0.01281067266063
lambda[  22] =   0.02147322149042
lambda[  23] =   0.02980924876816
==subpsace eigenproblem: bcast eigvals took 0.024 ms
Total time for solving subspace eigenvalue problem: 0.294 ms
rank =  0, subspace rotation using ScaLAPACK took 10.718 ms
rank =  0, Distributing orbital back into band + domain format took 22.629 ms
rank = 0, Subspace_Rotation used 33.369 ms

Total time for subspace rotation: 33.375 ms
rank = 0, Efermi =  -0.062461750370 calculate fermi energy took 0.109 ms
rank = 0, --- Calculate rho: sum over local bands took 7.050 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.643 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.517 ms
rank = 0, Calculating density took 1983.475 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.087 ms
rank = 0, D2D took 2.197 ms
rank = 0, Transfering density took 2.203 ms
Etot    =   -47.168308356350
Eband   =   -14.125176052852
E1      =    32.662320766578
E2      =   -12.896614040553
E3      =   -17.627792518447
Exc     =   -15.875133605364
Esc     =   -80.354726022757
Entropy =    -0.000000000956
dE = 1.899e-06, dEband = 3.256e-04
rank = 0, Calculating/Estimating energy took 1.754 ms, Etot = -47.168308356, dEtot = 1.899e-06, dEband = 3.256e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0186110891819, which took 0.060 ms

iter_count = 114, r_2norm = 4.750e-07, tol*||rhs|| = 7.444e-07

Anderson update took 69.426 ms, out of which F'*F took 31.331 ms; b-Ax took 213.847 ms, out of which Lap took 189.971 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 486.971 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003173022, int_rho =  30.00000003173060, int_b + int_rho = 3.783e-13, checking this took 0.113 ms
2-norm of RHS = 752.3346074724739, which took 0.186 ms

iter_count = 102, r_2norm = 6.282e-04, tol*||rhs|| = 7.523e-04

Anderson update took 62.583 ms, out of which F'*F took 27.673 ms; b-Ax took 189.695 ms, out of which Lap took 168.976 ms
Solving Poisson took 429.453 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.177980 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.378 ms
Total time for convolution: 	 convolve: 5.185587 
Total time for convolution: 	 convolve: 5.188472 
Total time for convolution: 	 convolve: 5.218055 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 1.009 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.485 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.901 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.423 ms

This SCF took 29338.555 ms, scf error = 9.258e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.46416424316117, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45161010156352, occ[   7] =   2.00000000000000
lambda[   8] =  -0.40316284598668, occ[   8] =   2.00000000000000
lambda[   9] =  -0.38099356345298, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31442995674756, occ[  10] =   2.00000000000000
lambda[  11] =  -0.30839349470067, occ[  11] =   2.00000000000000
lambda[  12] =  -0.30112097625181, occ[  12] =   2.00000000000000
lambda[  13] =  -0.29181731334550, occ[  13] =   2.00000000000000
lambda[  14] =  -0.29074326065284, occ[  14] =   2.00000000000000
lambda[  15] =  -0.28726821047295, occ[  15] =   2.00000000000000
lambda[  16] =  -0.03347172232338, occ[  16] =   0.00000002431956
lambda[  17] =  -0.03241285706204, occ[  17] =   0.00000000738992
lambda[  18] =  -0.02765062223554, occ[  18] =   0.00000000002111
lambda[  19] =  -0.00314481895028, occ[  19] =   0.00000000000000
lambda[  20] =   0.00171346564483, occ[  20] =   0.00000000000000
lambda[  21] =   0.01281067266063, occ[  21] =   0.00000000000000
lambda[  22] =   0.02147322149042, occ[  22] =   0.00000000000000
lambda[  23] =   0.02980924876816, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.397 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.704 ms, time for Allreduce/Reduce: 12.574 ms 
Time for calculating local force components: 25.874 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.03054492538044  -0.00107420766389  -0.04063536216624
 -0.03054491182838  -0.00107419889476   0.04063533621783
  0.03054492938416   0.00107419735421  -0.04063538233695
  0.03054491498358   0.00107420012190   0.04063535267948
 -0.10498458197418   0.07311039204250  -0.00000030020761
  0.10498414120555  -0.07311105310849  -0.00000033264736
  0.00730621266549  -0.01017994048136  -0.00000047406759
 -0.00730528721401   0.01017936480701  -0.00000010375114
 -0.56301608309491   0.76069016103159   0.00000019619029
  0.56301394992058  -0.76068979479514   0.00000062322745
force_loc = 
  0.03184724741556   0.00186585626213   0.04191968623722
  0.03184701248712   0.00186604603277  -0.04191992655147
 -0.03184728920468  -0.00186589776313   0.04192026641305
 -0.03184701748608  -0.00186589457166  -0.04191984280527
  0.09735088418901  -0.06413348136069  -0.00000116290159
 -0.09734999482454   0.06413358556902   0.00000009493566
 -0.01481103566126   0.02461603762906  -0.00000275562393
  0.01481257042882  -0.02461288370313   0.00000001381618
  0.53349367944280  -0.72003308981129   0.00000125469014
 -0.53349850521789   0.72003202840314   0.00000248037357
Time for calculating nonlocal force components: 50.992 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00523527962612  -0.00176628006454  -0.00000006300484
[0m[32m -0.00523526141283   0.00176628817373   0.00000001468619
[0m[32m -0.01023579012287   0.01326006270850  -0.00000016529919
[0m[32m  0.01023588773938  -0.01325988996401   0.00000000944655
[0m[32m  0.00926249553750  -0.01256372776232   0.00000007327830
[0m[32m -0.00926271205360   0.01256362096901   0.00000015035135
[0mTime for calculating XC forces components: 36.088 ms
 Cartesian force = 
  0.00130274108012   0.00079149848223   0.00128435595298
  0.00130251970374   0.00079169702200  -0.00128455845165
 -0.00130194077552  -0.00079185052494   0.00128491595810
 -0.00130168345751  -0.00079184456577  -0.00128445824380
 -0.00239799911405   0.00721048050125  -0.00000149423205
  0.00239930401318  -0.00721132948175  -0.00000019114352
 -0.01774019407364   0.02769600974018  -0.00000336310872
  0.01774358999919  -0.02769355897614  -0.00000004860642
 -0.02025948906961   0.02809319334196   0.00000155604072
  0.02025315169409  -0.02809429553900   0.00000328583436
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.360 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 383.207 ms
The program took 490.751 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:26
Job ID:        2266589
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:41:00,vmem=8436K,walltime=00:08:25,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-015-24-1
---------------------------------------
