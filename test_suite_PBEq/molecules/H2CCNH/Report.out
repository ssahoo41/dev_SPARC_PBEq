---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:46
Job ID:    2266463
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:51
Job ID:    2266463
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.074 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.017 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 17.482 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 6.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 18.576 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 67.131 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.958 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.086 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.028059	    6.556401	   11.767988	
   10.028059	    6.556401	    8.232012	
   10.785162	   13.443599	   10.000000	
    9.913097	    7.568261	   10.000000	
    9.676483	   10.045367	   10.000000	
    9.214838	   12.328989	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.004 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.161 ms
Set up communicators.

--set up spincomm took 2.271 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.074 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.435 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.427 ms

Calculate_SplineDerivRadFun took 0.196 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.321 ms.
time spent on vectorized spline interp: 2.337 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.998 ms.
time spent on vectorized spline interp: 1.731 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.576 ms.
time spent on vectorized spline interp: 1.676 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.515 ms.

Calculating rb for all atom types took 15.181 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.926 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000174699, sum_int_rho = 15.6923679436260
PosCharge = 16.000000017470, NegCharge = -15.692367943626, scal_fac = 1.019603929436
After scaling, int_rho = 16.0000000174699, PosCharge + NegCharge - NetCharge = 4.263e-14
--Calculate Vref took 0.355 ms
--Calculate rho_guess took 2.089 ms

 integral of b = -16.0000000174699,
 int{b} + Nelectron + NetCharge = -1.747e-08,
 Esc = -41.6319448477075,
 MPI_Reduce took 4.308 ms

Calculating b & b_ref took 12.319 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.015 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.077 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.129 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746993, int_b + int_rho = -4.911e-14, checking this took 0.089 ms
2-norm of RHS = 584.3785834113343, which took 0.466 ms

iter_count = 420, r_2norm = 5.453e-04, tol*||rhs|| = 5.844e-04

Anderson update took 232.299 ms, out of which F'*F took 105.361 ms; b-Ax took 742.853 ms, out of which Lap took 668.516 ms
Solving Poisson took 1541.599 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.413 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
Total time for convolution: 	 convolve: 5.137721 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 504.184 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.159802 
Total time for convolution: 	 convolve: 5.107374 
Total time for convolution: 	 convolve: 5.171323 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.531 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.212 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.411 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
rank = 0, XC calculation took 24950.602 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 1.152 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.752 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.030 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.152 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.683 ms
    Lanczos iter 53, eigmin  = -0.933799352, eigmax = 264.925408289, err_eigmin = 1.419e-03, err_eigmax = 9.694e-03
rank =   0, Lanczos took 118.967 ms, eigmin = -0.933799351813, eigmax = 267.574662372111

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.270432, lowerbound = -1.033799, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1163.274 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.072 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.573 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.375 ms
rank =  0, Distribute data + matrix mult took 17.045 ms
rank =  0, finding HY took 18.732 ms
rank =  0, distributing HY into block cyclic form took 13.657 ms
rank =  0, finding Y'*HY took 2.061 ms
Rank 0, Project_Hamiltonian used 51.533 ms
Total time for projection: 51.548 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.357 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.433 ms
    first calculated eigval = 2.790733830683301
    last  calculated eigval = 3.185957203543205
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79073383068330
lambda[   2] =   2.83114352138738
lambda[   3] =   2.86478635064189
lambda[   4] =   2.92281010853022
lambda[   5] =   2.95238550921411
lambda[   6] =   2.99356200697609
lambda[   7] =   3.01550321317556
lambda[   8] =   3.03329370775545
lambda[   9] =   3.07314637317958
lambda[  10] =   3.08426794697022
lambda[  11] =   3.11515326126994
lambda[  12] =   3.13472288758270
lambda[  13] =   3.16105077065262
lambda[  14] =   3.18595720354321
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.445 ms
rank =  0, subspace rotation using ScaLAPACK took 3.229 ms
rank =  0, Distributing orbital back into band + domain format took 11.924 ms
rank = 0, Subspace_Rotation used 15.179 ms

Total time for subspace rotation: 15.183 ms
rank = 0, Efermi =   3.053220117291 calculate fermi energy took 0.051 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.285957, lowerbound = -1.033799, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1135.053 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.508 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 13.992 ms
rank =  0, finding HY took 17.784 ms
rank =  0, distributing HY into block cyclic form took 12.687 ms
rank =  0, finding Y'*HY took 2.116 ms
Rank 0, Project_Hamiltonian used 46.614 ms
Total time for projection: 46.619 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -0.685059749431844
    last  calculated eigval = 0.446983770825451
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.68505974943184
lambda[   2] =  -0.56036451747539
lambda[   3] =  -0.26179017693118
lambda[   4] =  -0.16482037365984
lambda[   5] =  -0.00920266035451
lambda[   6] =   0.09217787986538
lambda[   7] =   0.22316427919223
lambda[   8] =   0.27709139639514
lambda[   9] =   0.30005807970194
lambda[  10] =   0.34498631938598
lambda[  11] =   0.36591892933635
lambda[  12] =   0.37706161411378
lambda[  13] =   0.39951138620495
lambda[  14] =   0.44698377082545
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.313 ms
rank =  0, Distributing orbital back into band + domain format took 12.024 ms
rank = 0, Subspace_Rotation used 15.358 ms

Total time for subspace rotation: 15.363 ms
rank = 0, Efermi =   0.288574738702 calculate fermi energy took 0.018 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.546984, lowerbound = -1.033799, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1145.966 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.593 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.439 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.072 ms
rank =  0, Distribute data + matrix mult took 14.121 ms
rank =  0, finding HY took 17.823 ms
rank =  0, distributing HY into block cyclic form took 12.642 ms
rank =  0, finding Y'*HY took 2.119 ms
Rank 0, Project_Hamiltonian used 46.767 ms
Total time for projection: 46.773 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -0.955957043792779
    last  calculated eigval = 0.141011786909510
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95595704379278
lambda[   2] =  -0.81724534172155
lambda[   3] =  -0.60386486120117
lambda[   4] =  -0.55755038822689
lambda[   5] =  -0.52190401193370
lambda[   6] =  -0.40913264249560
lambda[   7] =  -0.33625239741017
lambda[   8] =  -0.29950487089671
lambda[   9] =  -0.03157163985265
lambda[  10] =   0.04502038516165
lambda[  11] =   0.06914388650795
lambda[  12] =   0.08932978666963
lambda[  13] =   0.10610970482944
lambda[  14] =   0.14101178690951
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 3.212 ms
rank =  0, Distributing orbital back into band + domain format took 12.065 ms
rank = 0, Subspace_Rotation used 15.293 ms

Total time for subspace rotation: 15.298 ms
rank = 0, Efermi =  -0.060859358407 calculate fermi energy took 0.022 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.241012, lowerbound = -1.033799, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1162.740 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.510 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.452 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.036 ms
rank =  0, Distribute data + matrix mult took 14.019 ms
rank =  0, finding HY took 17.900 ms
rank =  0, distributing HY into block cyclic form took 12.561 ms
rank =  0, finding Y'*HY took 2.163 ms
Rank 0, Project_Hamiltonian used 46.681 ms
Total time for projection: 46.699 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.956398848271580
    last  calculated eigval = 0.075069234402866
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.95639884827158
lambda[   2] =  -0.81823424837860
lambda[   3] =  -0.60783631670398
lambda[   4] =  -0.56315918808229
lambda[   5] =  -0.52984701321340
lambda[   6] =  -0.42927618498915
lambda[   7] =  -0.38299073880760
lambda[   8] =  -0.31659781122575
lambda[   9] =  -0.11238180181609
lambda[  10] =  -0.03217612556033
lambda[  11] =  -0.00868513311178
lambda[  12] =   0.05103478986104
lambda[  13] =   0.05692285136976
lambda[  14] =   0.07506923440287
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.297 ms
rank =  0, Distributing orbital back into band + domain format took 11.895 ms
rank = 0, Subspace_Rotation used 15.207 ms

Total time for subspace rotation: 15.211 ms
rank = 0, Efermi =  -0.141669520398 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.641 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 4984.990 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.484 ms
rank = 0, D2D took 0.653 ms
rank = 0, Transfering density took 0.656 ms
Etot    =   -24.252059890775
Eband   =    -9.208680701308
E1      =    18.598890597620
E2      =    -7.101127839197
E3      =    -8.846544611915
Exc     =    -7.957997389965
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 4.042e+00, dEband = 1.535e+00
rank = 0, Calculating/Estimating energy took 1.686 ms, Etot = -24.252059891, dEtot = 4.042e+00, dEband = 1.535e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 39.9029057908301, which took 0.058 ms

iter_count = 96, r_2norm = 1.414e-03, tol*||rhs|| = 1.596e-03

Anderson update took 51.664 ms, out of which F'*F took 24.230 ms; b-Ax took 161.532 ms, out of which Lap took 145.207 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.369 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746982, int_b + int_rho = -1.601e-13, checking this took 0.124 ms
2-norm of RHS = 580.8091425783334, which took 0.135 ms

iter_count = 288, r_2norm = 5.168e-04, tol*||rhs|| = 5.808e-04

Anderson update took 154.730 ms, out of which F'*F took 72.710 ms; b-Ax took 486.739 ms, out of which Lap took 436.743 ms
Solving Poisson took 1031.920 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.193 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.097465 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
Total time for convolution: 	 convolve: 5.092515 
Total time for convolution: 	 convolve: 5.121368 
Total time for convolution: 	 convolve: 5.137231 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.360 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.176 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.735 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.064 ms

This SCF took 30858.370 ms, scf error = 1.932e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.175069, lowerbound = -0.956399, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1096.402 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.471 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.421 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 13.935 ms
rank =  0, finding HY took 18.048 ms
rank =  0, distributing HY into block cyclic form took 12.613 ms
rank =  0, finding Y'*HY took 2.115 ms
Rank 0, Project_Hamiltonian used 46.752 ms
Total time for projection: 46.767 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.102 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.167 ms
    first calculated eigval = -0.926843423167072
    last  calculated eigval = 0.045596100451929
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.92684342316707
lambda[   2] =  -0.77676835538206
lambda[   3] =  -0.57841130824575
lambda[   4] =  -0.52534503720151
lambda[   5] =  -0.49346198522956
lambda[   6] =  -0.40270938624618
lambda[   7] =  -0.36001702834841
lambda[   8] =  -0.28080824255511
lambda[   9] =  -0.10263852093844
lambda[  10] =  -0.05673071030692
lambda[  11] =  -0.02923143725124
lambda[  12] =   0.02289279053241
lambda[  13] =   0.03766444680562
lambda[  14] =   0.04559610045193
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.180 ms
rank =  0, subspace rotation using ScaLAPACK took 3.364 ms
rank =  0, Distributing orbital back into band + domain format took 11.990 ms
rank = 0, Subspace_Rotation used 15.377 ms

Total time for subspace rotation: 15.381 ms
rank = 0, Efermi =  -0.131926239554 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.136 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.754 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.094 ms
rank = 0, Calculating density took 1161.856 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.425 ms
rank = 0, D2D took 0.553 ms
rank = 0, Transfering density took 0.555 ms
Etot    =   -24.196620676589
Eband   =    -8.688729534544
E1      =    18.151239585438
E2      =    -7.059484486050
E3      =    -8.977042468277
Exc     =    -8.063712833574
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 9.240e-03, dEband = 8.666e-02
rank = 0, Calculating/Estimating energy took 2.732 ms, Etot = -24.196620677, dEtot = 9.240e-03, dEband = 8.666e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.0401803554979, which took 0.055 ms

iter_count = 102, r_2norm = 5.736e-04, tol*||rhs|| = 6.816e-04

Anderson update took 54.245 ms, out of which F'*F took 25.733 ms; b-Ax took 174.659 ms, out of which Lap took 156.242 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 376.896 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746986, int_b + int_rho = -1.182e-13, checking this took 0.118 ms
2-norm of RHS = 577.0651820690039, which took 0.154 ms

iter_count = 294, r_2norm = 5.695e-04, tol*||rhs|| = 5.771e-04

Anderson update took 160.949 ms, out of which F'*F took 74.918 ms; b-Ax took 508.317 ms, out of which Lap took 456.052 ms
Solving Poisson took 1071.457 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.492 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.124749 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.117618 
Total time for convolution: 	 convolve: 5.110261 
Total time for convolution: 	 convolve: 5.107407 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 27196.127 ms, scf error = 1.247e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.145596, lowerbound = -0.926843, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1103.137 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.568 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.670 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.013 ms
rank =  0, Distribute data + matrix mult took 14.268 ms
rank =  0, finding HY took 21.851 ms
rank =  0, distributing HY into block cyclic form took 12.748 ms
rank =  0, finding Y'*HY took 2.117 ms
Rank 0, Project_Hamiltonian used 51.021 ms
Total time for projection: 51.034 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.143 ms
    first calculated eigval = -0.886842642429170
    last  calculated eigval = 0.033781086329494
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88684264242917
lambda[   2] =  -0.71979842884815
lambda[   3] =  -0.54173744969035
lambda[   4] =  -0.47279094284405
lambda[   5] =  -0.44552632548249
lambda[   6] =  -0.36725380265651
lambda[   7] =  -0.32835109066514
lambda[   8] =  -0.23785857087632
lambda[   9] =  -0.07460815909552
lambda[  10] =  -0.03644713080639
lambda[  11] =  -0.03334059625558
lambda[  12] =   0.01428963875948
lambda[  13] =   0.02882267863530
lambda[  14] =   0.03378108632949
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.157 ms
rank =  0, subspace rotation using ScaLAPACK took 3.369 ms
rank =  0, Distributing orbital back into band + domain format took 12.079 ms
rank = 0, Subspace_Rotation used 15.492 ms

Total time for subspace rotation: 15.496 ms
rank = 0, Efermi =  -0.103895877716 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.993 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.558 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1172.620 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.411 ms
rank = 0, D2D took 0.607 ms
rank = 0, Transfering density took 0.618 ms
Etot    =   -24.162669604004
Eband   =    -8.000318508288
E1      =    17.573509175353
E2      =    -6.945282728630
E3      =    -9.169336314181
Exc     =    -8.218534465645
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 5.659e-03, dEband = 1.147e-01
rank = 0, Calculating/Estimating energy took 1.807 ms, Etot = -24.162669604, dEtot = 5.659e-03, dEband = 1.147e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.7020482271294, which took 0.054 ms

iter_count = 102, r_2norm = 2.231e-04, tol*||rhs|| = 2.681e-04

Anderson update took 67.645 ms, out of which F'*F took 26.427 ms; b-Ax took 193.478 ms, out of which Lap took 171.662 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.791 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746995, int_b + int_rho = -2.728e-14, checking this took 0.108 ms
2-norm of RHS = 576.4987071562618, which took 0.092 ms

iter_count = 282, r_2norm = 5.105e-04, tol*||rhs|| = 5.765e-04

Anderson update took 233.034 ms, out of which F'*F took 175.739 ms; b-Ax took 877.214 ms, out of which Lap took 788.875 ms
Solving Poisson took 1638.024 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.253 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 6.886237 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.647689 
Total time for convolution: 	 convolve: 5.512795 
Total time for convolution: 	 convolve: 5.392258 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3911.792 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.330 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.304 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.301 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.973 ms

This SCF took 35171.973 ms, scf error = 5.387e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.133781, lowerbound = -0.886843, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1136.742 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.488 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 13.948 ms
rank =  0, finding HY took 19.550 ms
rank =  0, distributing HY into block cyclic form took 12.369 ms
rank =  0, finding Y'*HY took 3.322 ms
Rank 0, Project_Hamiltonian used 49.222 ms
Total time for projection: 49.236 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.866441301657613
    last  calculated eigval = 0.030253705826037
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86644130165761
lambda[   2] =  -0.69558588530650
lambda[   3] =  -0.52405663020240
lambda[   4] =  -0.44952883660796
lambda[   5] =  -0.42493801962782
lambda[   6] =  -0.34925395625083
lambda[   7] =  -0.31286295027001
lambda[   8] =  -0.22200081715007
lambda[   9] =  -0.05754893713273
lambda[  10] =  -0.03660796827309
lambda[  11] =  -0.02138332340963
lambda[  12] =   0.01197066832839
lambda[  13] =   0.02287837112242
lambda[  14] =   0.03025370582604
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.179 ms
rank =  0, Distributing orbital back into band + domain format took 12.012 ms
rank = 0, Subspace_Rotation used 15.212 ms

Total time for subspace rotation: 15.216 ms
rank = 0, Efermi =  -0.086836655723 calculate fermi energy took 0.055 ms
rank = 0, --- Calculate rho: sum over local bands took 2.046 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.861 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.090 ms
rank = 0, Calculating density took 1204.474 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.360 ms
rank = 0, D2D took 2.144 ms
rank = 0, Transfering density took 2.151 ms
Etot    =   -24.156903100783
Eband   =    -7.689336795152
E1      =    17.347863944337
E2      =    -6.845167878317
E3      =    -9.262746531822
Exc     =    -8.291399811873
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 9.611e-04, dEband = 5.183e-02
rank = 0, Calculating/Estimating energy took 0.897 ms, Etot = -24.156903101, dEtot = 9.611e-04, dEband = 5.183e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7907855528372, which took 0.048 ms

iter_count = 108, r_2norm = 8.185e-05, tol*||rhs|| = 1.116e-04

Anderson update took 77.521 ms, out of which F'*F took 31.785 ms; b-Ax took 212.732 ms, out of which Lap took 191.967 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.552 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746992, int_b + int_rho = -6.185e-14, checking this took 0.131 ms
2-norm of RHS = 576.8147080072647, which took 10.480 ms

iter_count = 258, r_2norm = 4.783e-04, tol*||rhs|| = 5.768e-04

Anderson update took 171.481 ms, out of which F'*F took 89.768 ms; b-Ax took 520.190 ms, out of which Lap took 474.368 ms
Solving Poisson took 1066.894 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.702 ms
Total time for convolution: 	 convolve: 5.310818 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.165242 
Total time for convolution: 	 convolve: 5.171560 
Total time for convolution: 	 convolve: 5.186431 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.175 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.002 ms

This SCF took 27626.621 ms, scf error = 1.779e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.130254, lowerbound = -0.866441, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1143.435 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.075 ms
rank =  0, Distribute data + matrix mult took 14.026 ms
rank =  0, finding HY took 18.056 ms
rank =  0, distributing HY into block cyclic form took 12.465 ms
rank =  0, finding Y'*HY took 3.041 ms
Rank 0, Project_Hamiltonian used 47.622 ms
Total time for projection: 47.637 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 3.886 ms
rank = 0, Solve_Generalized_EigenProblem used 3.973 ms
    first calculated eigval = -0.861764391205972
    last  calculated eigval = 0.028851771524887
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.86176439120597
lambda[   2] =  -0.69129536187783
lambda[   3] =  -0.51897656681767
lambda[   4] =  -0.44470015705250
lambda[   5] =  -0.42014956190620
lambda[   6] =  -0.34479889314572
lambda[   7] =  -0.30854348499860
lambda[   8] =  -0.21808331269314
lambda[   9] =  -0.05393537225696
lambda[  10] =  -0.03703209196983
lambda[  11] =  -0.01899024338380
lambda[  12] =   0.01096316495881
lambda[  13] =   0.02016829415840
lambda[  14] =   0.02885177152489
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 3.986 ms
rank =  0, subspace rotation using ScaLAPACK took 3.143 ms
rank =  0, Distributing orbital back into band + domain format took 11.814 ms
rank = 0, Subspace_Rotation used 14.975 ms

Total time for subspace rotation: 14.979 ms
rank = 0, Efermi =  -0.083223090846 calculate fermi energy took 2.218 ms
rank = 0, --- Calculate rho: sum over local bands took 1.371 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.612 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.061 ms
rank = 0, Calculating density took 1214.381 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.392 ms
rank = 0, D2D took 0.537 ms
rank = 0, Transfering density took 0.543 ms
Etot    =   -24.156108809823
Eband   =    -7.616623460338
E1      =    17.311859969467
E2      =    -6.803312341907
E3      =    -9.283837538930
Exc     =    -8.306550351555
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 1.324e-04, dEband = 1.212e-02
rank = 0, Calculating/Estimating energy took 4.212 ms, Etot = -24.156108810, dEtot = 1.324e-04, dEband = 1.212e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9480631213640, which took 0.151 ms

iter_count = 108, r_2norm = 3.772e-05, tol*||rhs|| = 3.792e-05

Anderson update took 65.607 ms, out of which F'*F took 29.834 ms; b-Ax took 187.368 ms, out of which Lap took 169.653 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.507 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746992, int_b + int_rho = -5.639e-14, checking this took 0.129 ms
2-norm of RHS = 577.3250393205259, which took 0.189 ms

iter_count = 252, r_2norm = 5.023e-04, tol*||rhs|| = 5.773e-04

Anderson update took 149.672 ms, out of which F'*F took 67.660 ms; b-Ax took 464.823 ms, out of which Lap took 421.622 ms
Solving Poisson took 957.790 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.158 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.287791 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.332 ms
Total time for convolution: 	 convolve: 5.190150 
Total time for convolution: 	 convolve: 5.240196 
Total time for convolution: 	 convolve: 5.185694 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.482 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.574 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 27612.787 ms, scf error = 9.674e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.128852, lowerbound = -0.861764, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1114.096 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 25.122 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.438 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.466 ms
rank =  0, Distribute data + matrix mult took 27.042 ms
rank =  0, finding HY took 18.194 ms
rank =  0, distributing HY into block cyclic form took 14.916 ms
rank =  0, finding Y'*HY took 2.330 ms
Rank 0, Project_Hamiltonian used 62.515 ms
Total time for projection: 62.527 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.151 ms
    first calculated eigval = -0.859484822124466
    last  calculated eigval = 0.028530423124450
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85948482212447
lambda[   2] =  -0.68887786527484
lambda[   3] =  -0.51602861186984
lambda[   4] =  -0.44189535882992
lambda[   5] =  -0.41705236139470
lambda[   6] =  -0.34222945473259
lambda[   7] =  -0.30592889503691
lambda[   8] =  -0.21547663155851
lambda[   9] =  -0.05170082648529
lambda[  10] =  -0.03683504920984
lambda[  11] =  -0.01724571903363
lambda[  12] =   0.01085272207328
lambda[  13] =   0.01916174227986
lambda[  14] =   0.02853042312445
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.164 ms
rank =  0, subspace rotation using ScaLAPACK took 3.091 ms
rank =  0, Distributing orbital back into band + domain format took 11.945 ms
rank = 0, Subspace_Rotation used 15.062 ms

Total time for subspace rotation: 15.066 ms
rank = 0, Efermi =  -0.080988545053 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 1.916 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.749 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1194.716 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.420 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.716 ms
Etot    =   -24.155703360005
Eband   =    -7.573948002547
E1      =    17.303257218839
E2      =    -6.766032152750
E3      =    -9.293005671262
Exc     =    -8.312105552075
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.757e-05, dEband = 7.113e-03
rank = 0, Calculating/Estimating energy took 1.447 ms, Etot = -24.155703360, dEtot = 6.757e-05, dEband = 7.113e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4825968805788, which took 0.062 ms

iter_count = 108, r_2norm = 1.799e-05, tol*||rhs|| = 1.930e-05

Anderson update took 63.005 ms, out of which F'*F took 28.923 ms; b-Ax took 202.701 ms, out of which Lap took 184.885 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.225 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746984, int_b + int_rho = -1.382e-13, checking this took 0.074 ms
2-norm of RHS = 577.5220382449933, which took 0.090 ms

iter_count = 240, r_2norm = 5.697e-04, tol*||rhs|| = 5.775e-04

Anderson update took 146.016 ms, out of which F'*F took 66.448 ms; b-Ax took 421.348 ms, out of which Lap took 381.222 ms
Solving Poisson took 898.961 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.194412 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.197161 
Total time for convolution: 	 convolve: 5.163331 
Total time for convolution: 	 convolve: 5.184032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.665 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.233 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.256 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.662 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 27330.639 ms, scf error = 4.351e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128530, lowerbound = -0.859485, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1153.380 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.643 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.601 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 14.291 ms
rank =  0, finding HY took 18.277 ms
rank =  0, distributing HY into block cyclic form took 12.865 ms
rank =  0, finding Y'*HY took 1.967 ms
Rank 0, Project_Hamiltonian used 47.447 ms
Total time for projection: 47.464 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.856945057268709
    last  calculated eigval = 0.028987262394604
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85694505726871
lambda[   2] =  -0.68526242746274
lambda[   3] =  -0.51349294270958
lambda[   4] =  -0.43848852016586
lambda[   5] =  -0.41371325420613
lambda[   6] =  -0.33947920502806
lambda[   7] =  -0.30335433673154
lambda[   8] =  -0.21229140717640
lambda[   9] =  -0.04919795130473
lambda[  10] =  -0.03620392476096
lambda[  11] =  -0.01502129720070
lambda[  12] =   0.01133187148007
lambda[  13] =   0.01928992621315
lambda[  14] =   0.02898726239460
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.057 ms
rank =  0, Distributing orbital back into band + domain format took 12.319 ms
rank = 0, Subspace_Rotation used 15.394 ms

Total time for subspace rotation: 15.398 ms
rank = 0, Efermi =  -0.078485669860 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.320 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.552 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.071 ms
rank = 0, Calculating density took 1219.496 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 3.502 ms
rank = 0, D2D took 3.625 ms
rank = 0, Transfering density took 3.634 ms
Etot    =   -24.155528366892
Eband   =    -7.526054302358
E1      =    17.281222217937
E2      =    -6.737717536944
E3      =    -9.301523025231
Exc     =    -8.317991996413
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 2.917e-05, dEband = 7.982e-03
rank = 0, Calculating/Estimating energy took 2.122 ms, Etot = -24.155528367, dEtot = 2.917e-05, dEband = 7.982e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1889751967048, which took 0.051 ms

iter_count = 114, r_2norm = 6.043e-06, tol*||rhs|| = 7.559e-06

Anderson update took 68.429 ms, out of which F'*F took 29.175 ms; b-Ax took 212.645 ms, out of which Lap took 193.265 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 440.978 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746985, int_b + int_rho = -1.273e-13, checking this took 0.149 ms
2-norm of RHS = 577.6130585811155, which took 0.096 ms

iter_count = 240, r_2norm = 5.362e-04, tol*||rhs|| = 5.776e-04

Anderson update took 147.017 ms, out of which F'*F took 64.159 ms; b-Ax took 435.654 ms, out of which Lap took 396.394 ms
Solving Poisson took 915.859 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.177839 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.200186 
Total time for convolution: 	 convolve: 5.159102 
Total time for convolution: 	 convolve: 5.179674 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.738 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.327 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.315 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.007 ms

This SCF took 27384.935 ms, scf error = 2.602e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128987, lowerbound = -0.856945, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1145.431 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.581 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.444 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.075 ms
rank =  0, finding HY took 18.661 ms
rank =  0, distributing HY into block cyclic form took 12.770 ms
rank =  0, finding Y'*HY took 2.073 ms
Rank 0, Project_Hamiltonian used 47.634 ms
Total time for projection: 47.653 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.133 ms
    first calculated eigval = -0.854019195840071
    last  calculated eigval = 0.030717611437799
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85401919584007
lambda[   2] =  -0.68227758685758
lambda[   3] =  -0.51095984067974
lambda[   4] =  -0.43571931672197
lambda[   5] =  -0.41107364821917
lambda[   6] =  -0.33645525912239
lambda[   7] =  -0.30059773241714
lambda[   8] =  -0.20941841842759
lambda[   9] =  -0.04639562052973
lambda[  10] =  -0.03447917555018
lambda[  11] =  -0.01232739565730
lambda[  12] =   0.01270518093360
lambda[  13] =   0.02104176790593
lambda[  14] =   0.03071761143780
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.145 ms
rank =  0, subspace rotation using ScaLAPACK took 3.203 ms
rank =  0, Distributing orbital back into band + domain format took 12.059 ms
rank = 0, Subspace_Rotation used 15.275 ms

Total time for subspace rotation: 15.278 ms
rank = 0, Efermi =  -0.075683339239 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 2.151 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.815 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1211.672 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
rank = 0, D2D took 0.749 ms
rank = 0, Transfering density took 0.755 ms
Etot    =   -24.155468078880
Eband   =    -7.481041997382
E1      =    17.259929581074
E2      =    -6.712316986102
E3      =    -9.307314569486
Exc     =    -8.322042369925
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 1.005e-05, dEband = 7.502e-03
rank = 0, Calculating/Estimating energy took 0.934 ms, Etot = -24.155468079, dEtot = 1.005e-05, dEband = 7.502e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1627549703311, which took 0.223 ms

iter_count = 114, r_2norm = 4.235e-06, tol*||rhs|| = 6.510e-06

Anderson update took 74.651 ms, out of which F'*F took 35.833 ms; b-Ax took 203.854 ms, out of which Lap took 184.524 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 438.822 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746992, int_b + int_rho = -6.185e-14, checking this took 0.124 ms
2-norm of RHS = 577.5758766162585, which took 0.062 ms

iter_count = 222, r_2norm = 5.205e-04, tol*||rhs|| = 5.776e-04

Anderson update took 153.455 ms, out of which F'*F took 56.361 ms; b-Ax took 399.527 ms, out of which Lap took 363.531 ms
Solving Poisson took 852.712 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.209872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.241877 
Total time for convolution: 	 convolve: 5.234603 
Total time for convolution: 	 convolve: 5.227647 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.749 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.176 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.658 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 27540.554 ms, scf error = 1.401e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.130718, lowerbound = -0.854019, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1126.396 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.632 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.322 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.356 ms
rank =  0, Distribute data + matrix mult took 27.325 ms
rank =  0, finding HY took 19.453 ms
rank =  0, distributing HY into block cyclic form took 12.725 ms
rank =  0, finding Y'*HY took 2.308 ms
Rank 0, Project_Hamiltonian used 61.841 ms
Total time for projection: 61.853 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -0.852420173388335
    last  calculated eigval = 0.031618602789310
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85242017338834
lambda[   2] =  -0.68055783020703
lambda[   3] =  -0.50948353843543
lambda[   4] =  -0.43404433858814
lambda[   5] =  -0.40944631130272
lambda[   6] =  -0.33484202437294
lambda[   7] =  -0.29908016682619
lambda[   8] =  -0.20784668943802
lambda[   9] =  -0.04480166020805
lambda[  10] =  -0.03264577629733
lambda[  11] =  -0.01060114333077
lambda[  12] =   0.01418301499809
lambda[  13] =   0.02297116482845
lambda[  14] =   0.03161860278931
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.204 ms
rank =  0, Distributing orbital back into band + domain format took 12.266 ms
rank = 0, Subspace_Rotation used 15.484 ms

Total time for subspace rotation: 15.488 ms
rank = 0, Efermi =  -0.074089378891 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.048 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.650 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.092 ms
rank = 0, Calculating density took 1207.840 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
rank = 0, D2D took 0.503 ms
rank = 0, Transfering density took 0.504 ms
Etot    =   -24.155504393063
Eband   =    -7.455442145900
E1      =    17.245620678818
E2      =    -6.700192616022
E3      =    -9.310939728836
Exc     =    -8.324870422604
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.052e-06, dEband = 4.267e-03
rank = 0, Calculating/Estimating energy took 3.107 ms, Etot = -24.155504393, dEtot = 6.052e-06, dEband = 4.267e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0939746652087, which took 0.182 ms

iter_count = 114, r_2norm = 2.380e-06, tol*||rhs|| = 3.759e-06

Anderson update took 64.261 ms, out of which F'*F took 28.101 ms; b-Ax took 209.361 ms, out of which Lap took 189.940 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 435.861 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746983, int_b + int_rho = -1.455e-13, checking this took 0.099 ms
2-norm of RHS = 577.5645145033194, which took 0.078 ms

iter_count = 216, r_2norm = 4.777e-04, tol*||rhs|| = 5.776e-04

Anderson update took 134.359 ms, out of which F'*F took 55.458 ms; b-Ax took 388.578 ms, out of which Lap took 352.782 ms
Solving Poisson took 820.341 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.078 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.722 ms
Total time for convolution: 	 convolve: 5.132080 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 74.933 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.328 ms
Total time for convolution: 	 convolve: 5.269303 
Total time for convolution: 	 convolve: 5.274969 
Total time for convolution: 	 convolve: 5.236816 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.764 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.306 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.661 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.995 ms

This SCF took 27613.583 ms, scf error = 9.485e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131619, lowerbound = -0.852420, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1152.964 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.720 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 15.084 ms
rank =  0, finding HY took 18.583 ms
rank =  0, distributing HY into block cyclic form took 14.962 ms
rank =  0, finding Y'*HY took 1.675 ms
Rank 0, Project_Hamiltonian used 50.336 ms
Total time for projection: 50.351 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -0.851928859980384
    last  calculated eigval = 0.032922701847836
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85192885998038
lambda[   2] =  -0.67993856271961
lambda[   3] =  -0.50893155552357
lambda[   4] =  -0.43341226584708
lambda[   5] =  -0.40873277053422
lambda[   6] =  -0.33425998849468
lambda[   7] =  -0.29845866956532
lambda[   8] =  -0.20716387179985
lambda[   9] =  -0.04407664225772
lambda[  10] =  -0.02956267036604
lambda[  11] =  -0.00918748557253
lambda[  12] =   0.01698283081635
lambda[  13] =   0.02575012370352
lambda[  14] =   0.03292270184784
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.410 ms
rank =  0, Distributing orbital back into band + domain format took 11.973 ms
rank = 0, Subspace_Rotation used 15.402 ms

Total time for subspace rotation: 15.406 ms
rank = 0, Efermi =  -0.073364360858 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.145 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.681 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1221.939 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.496 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.708 ms
Etot    =   -24.155559707427
Eband   =    -7.445653089699
E1      =    17.241903605986
E2      =    -6.694225727384
E3      =    -9.310614509839
Exc     =    -8.324705612702
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 9.219e-06, dEband = 1.632e-03
rank = 0, Calculating/Estimating energy took 1.024 ms, Etot = -24.155559707, dEtot = 9.219e-06, dEband = 1.632e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0657870201827, which took 0.049 ms

iter_count = 108, r_2norm = 2.085e-06, tol*||rhs|| = 2.631e-06

Anderson update took 58.729 ms, out of which F'*F took 27.354 ms; b-Ax took 194.140 ms, out of which Lap took 175.769 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.984 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746987, int_b + int_rho = -1.128e-13, checking this took 0.142 ms
2-norm of RHS = 577.5850815396692, which took 0.783 ms

iter_count = 204, r_2norm = 4.825e-04, tol*||rhs|| = 5.776e-04

Anderson update took 145.481 ms, out of which F'*F took 61.275 ms; b-Ax took 383.851 ms, out of which Lap took 336.227 ms
Solving Poisson took 804.925 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.350122 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.302682 
Total time for convolution: 	 convolve: 5.336763 
Total time for convolution: 	 convolve: 5.205502 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.754 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.700 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 27804.980 ms, scf error = 5.922e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.132923, lowerbound = -0.851929, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1144.107 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.826 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.321 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 14.184 ms
rank =  0, finding HY took 22.411 ms
rank =  0, distributing HY into block cyclic form took 12.699 ms
rank =  0, finding Y'*HY took 2.088 ms
Rank 0, Project_Hamiltonian used 51.415 ms
Total time for projection: 51.431 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.851027188827517
    last  calculated eigval = 0.034519063372904
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85102718882752
lambda[   2] =  -0.67906869567105
lambda[   3] =  -0.50808758586581
lambda[   4] =  -0.43255651877699
lambda[   5] =  -0.40788101204752
lambda[   6] =  -0.33340614705612
lambda[   7] =  -0.29760048822870
lambda[   8] =  -0.20635251374528
lambda[   9] =  -0.04317501889176
lambda[  10] =  -0.02576695984261
lambda[  11] =  -0.00826549300380
lambda[  12] =   0.02103757498732
lambda[  13] =   0.02838045601919
lambda[  14] =   0.03451906337290
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.284 ms
rank =  0, Distributing orbital back into band + domain format took 12.127 ms
rank = 0, Subspace_Rotation used 15.425 ms

Total time for subspace rotation: 15.429 ms
rank = 0, Efermi =  -0.072462737457 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.576 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.102 ms
rank = 0, Calculating density took 1215.020 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.380 ms
rank = 0, D2D took 0.498 ms
rank = 0, Transfering density took 0.500 ms
Etot    =   -24.155648972847
Eband   =    -7.431960301192
E1      =    17.235070260754
E2      =    -6.686981093553
E3      =    -9.312125215738
Exc     =    -8.325920393465
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 1.488e-05, dEband = 2.282e-03
rank = 0, Calculating/Estimating energy took 1.154 ms, Etot = -24.155648973, dEtot = 1.488e-05, dEband = 2.282e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0569216547891, which took 0.064 ms

iter_count = 108, r_2norm = 1.980e-06, tol*||rhs|| = 2.277e-06

Anderson update took 62.376 ms, out of which F'*F took 28.594 ms; b-Ax took 191.210 ms, out of which Lap took 171.487 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 406.475 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746991, int_b + int_rho = -6.912e-14, checking this took 0.124 ms
2-norm of RHS = 577.5841631649095, which took 0.076 ms

iter_count = 150, r_2norm = 5.697e-04, tol*||rhs|| = 5.776e-04

Anderson update took 85.345 ms, out of which F'*F took 38.157 ms; b-Ax took 259.758 ms, out of which Lap took 235.801 ms
Solving Poisson took 549.111 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.318 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.175719 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.190747 
Total time for convolution: 	 convolve: 5.160948 
Total time for convolution: 	 convolve: 5.181701 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.756 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.983 ms

This SCF took 27080.897 ms, scf error = 3.585e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134519, lowerbound = -0.851027, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1144.702 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.329 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.603 ms
rank =  0, Distribute data + matrix mult took 14.282 ms
rank =  0, finding HY took 19.593 ms
rank =  0, distributing HY into block cyclic form took 13.487 ms
rank =  0, finding Y'*HY took 1.816 ms
Rank 0, Project_Hamiltonian used 49.211 ms
Total time for projection: 49.223 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.850865472636212
    last  calculated eigval = 0.034864190636337
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85086547263621
lambda[   2] =  -0.67886071393698
lambda[   3] =  -0.50793491597272
lambda[   4] =  -0.43236208952277
lambda[   5] =  -0.40769011789470
lambda[   6] =  -0.33324699002081
lambda[   7] =  -0.29744037815560
lambda[   8] =  -0.20616918280071
lambda[   9] =  -0.04301910379467
lambda[  10] =  -0.02473070677505
lambda[  11] =  -0.00814856591096
lambda[  12] =   0.02189976522620
lambda[  13] =   0.02865084226836
lambda[  14] =   0.03486419063634
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.228 ms
rank =  0, Distributing orbital back into band + domain format took 12.043 ms
rank = 0, Subspace_Rotation used 15.285 ms

Total time for subspace rotation: 15.290 ms
rank = 0, Efermi =  -0.072306822346 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.689 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1212.417 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.564 ms
rank = 0, D2D took 0.751 ms
rank = 0, Transfering density took 0.754 ms
Etot    =   -24.155674741173
Eband   =    -7.429139722633
E1      =    17.233475462499
E2      =    -6.685689813730
E3      =    -9.312395355441
Exc     =    -8.326150801976
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 4.295e-06, dEband = 4.701e-04
rank = 0, Calculating/Estimating energy took 1.751 ms, Etot = -24.155674741, dEtot = 4.295e-06, dEband = 4.701e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0400136378866, which took 0.050 ms

iter_count = 108, r_2norm = 1.546e-06, tol*||rhs|| = 1.601e-06

Anderson update took 65.223 ms, out of which F'*F took 27.409 ms; b-Ax took 188.419 ms, out of which Lap took 168.556 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746992, int_b + int_rho = -5.821e-14, checking this took 0.096 ms
2-norm of RHS = 577.5868352459513, which took 0.129 ms

iter_count = 156, r_2norm = 5.035e-04, tol*||rhs|| = 5.776e-04

Anderson update took 86.497 ms, out of which F'*F took 39.675 ms; b-Ax took 271.103 ms, out of which Lap took 245.441 ms
Solving Poisson took 573.220 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.221751 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.186316 
Total time for convolution: 	 convolve: 5.192486 
Total time for convolution: 	 convolve: 5.216801 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.789 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.654 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.984 ms

This SCF took 27097.901 ms, scf error = 2.681e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.134864, lowerbound = -0.850865, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1117.539 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 28.191 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.507 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 29.739 ms
rank =  0, finding HY took 18.375 ms
rank =  0, distributing HY into block cyclic form took 12.811 ms
rank =  0, finding Y'*HY took 1.984 ms
Rank 0, Project_Hamiltonian used 62.943 ms
Total time for projection: 62.956 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.850663201684029
    last  calculated eigval = 0.035068406798718
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85066320168403
lambda[   2] =  -0.67866688460369
lambda[   3] =  -0.50774381745280
lambda[   4] =  -0.43217170599216
lambda[   5] =  -0.40749968178457
lambda[   6] =  -0.33305088756312
lambda[   7] =  -0.29724632864296
lambda[   8] =  -0.20598205965880
lambda[   9] =  -0.04288641729903
lambda[  10] =  -0.02477383495161
lambda[  11] =  -0.00824318958216
lambda[  12] =   0.02178739843706
lambda[  13] =   0.02811491487987
lambda[  14] =   0.03506840679872
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.245 ms
rank =  0, Distributing orbital back into band + domain format took 12.471 ms
rank = 0, Subspace_Rotation used 15.731 ms

Total time for subspace rotation: 15.736 ms
rank = 0, Efermi =  -0.072174135865 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.077 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.715 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1199.424 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.433 ms
rank = 0, D2D took 0.945 ms
rank = 0, Transfering density took 0.948 ms
Etot    =   -24.155726899216
Eband   =    -7.426049135513
E1      =    17.231978717080
E2      =    -6.683998168755
E3      =    -9.312602945983
Exc     =    -8.326312747285
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 8.693e-06, dEband = 5.151e-04
rank = 0, Calculating/Estimating energy took 1.563 ms, Etot = -24.155726899, dEtot = 8.693e-06, dEband = 5.151e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0312884641015, which took 0.077 ms

iter_count = 108, r_2norm = 1.099e-06, tol*||rhs|| = 1.252e-06

Anderson update took 60.042 ms, out of which F'*F took 28.445 ms; b-Ax took 188.924 ms, out of which Lap took 170.380 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.119 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746991, int_b + int_rho = -6.912e-14, checking this took 0.096 ms
2-norm of RHS = 577.5911924516217, which took 0.088 ms

iter_count = 156, r_2norm = 5.210e-04, tol*||rhs|| = 5.776e-04

Anderson update took 89.237 ms, out of which F'*F took 42.818 ms; b-Ax took 267.550 ms, out of which Lap took 241.453 ms
Solving Poisson took 573.368 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.194776 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.168577 
Total time for convolution: 	 convolve: 5.187434 
Total time for convolution: 	 convolve: 5.161844 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.759 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.397 ms
---Transfer Veff_loc: D2D took 0.671 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.009 ms

This SCF took 26983.685 ms, scf error = 2.025e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135068, lowerbound = -0.850663, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1150.799 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.299 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.360 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.711 ms
rank =  0, Distribute data + matrix mult took 14.384 ms
rank =  0, finding HY took 18.213 ms
rank =  0, distributing HY into block cyclic form took 12.655 ms
rank =  0, finding Y'*HY took 2.081 ms
Rank 0, Project_Hamiltonian used 47.360 ms
Total time for projection: 47.374 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.850683444134443
    last  calculated eigval = 0.036718485504383
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85068344413444
lambda[   2] =  -0.67866518181003
lambda[   3] =  -0.50773646078496
lambda[   4] =  -0.43215617290395
lambda[   5] =  -0.40746687346481
lambda[   6] =  -0.33304889291774
lambda[   7] =  -0.29723921577650
lambda[   8] =  -0.20596774147264
lambda[   9] =  -0.04292025861425
lambda[  10] =  -0.02444831299132
lambda[  11] =  -0.00833390459103
lambda[  12] =   0.02182423684091
lambda[  13] =   0.02868071724359
lambda[  14] =   0.03671848550438
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.176 ms
rank =  0, Distributing orbital back into band + domain format took 12.612 ms
rank = 0, Subspace_Rotation used 15.804 ms

Total time for subspace rotation: 15.808 ms
rank = 0, Efermi =  -0.072207977220 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 2.102 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.417 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.144 ms
rank = 0, Calculating density took 1217.968 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.393 ms
rank = 0, D2D took 0.515 ms
rank = 0, Transfering density took 0.517 ms
Etot    =   -24.155761279544
Eband   =    -7.425927967280
E1      =    17.232356250447
E2      =    -6.683551419965
E3      =    -9.312220425061
Exc     =    -8.326016559502
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 5.730e-06, dEband = 2.019e-05
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -24.155761280, dEtot = 5.730e-06, dEband = 2.019e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0314960002444, which took 0.056 ms

iter_count = 108, r_2norm = 1.077e-06, tol*||rhs|| = 1.260e-06

Anderson update took 61.385 ms, out of which F'*F took 27.631 ms; b-Ax took 193.459 ms, out of which Lap took 174.024 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.091 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746993, int_b + int_rho = -4.366e-14, checking this took 0.101 ms
2-norm of RHS = 577.5911760230882, which took 0.075 ms

iter_count = 18, r_2norm = 5.279e-04, tol*||rhs|| = 5.776e-04

Anderson update took 10.571 ms, out of which F'*F took 4.178 ms; b-Ax took 31.930 ms, out of which Lap took 28.788 ms
Solving Poisson took 70.031 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.192 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.159038 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.947 ms
Total time for convolution: 	 convolve: 5.197541 
Total time for convolution: 	 convolve: 5.209235 
Total time for convolution: 	 convolve: 5.183806 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.753 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.018 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.645 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.326 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.993 ms

This SCF took 26568.221 ms, scf error = 2.333e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136718, lowerbound = -0.850683, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1135.680 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 13.056 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.338 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.435 ms
rank =  0, finding HY took 19.678 ms
rank =  0, distributing HY into block cyclic form took 12.746 ms
rank =  0, finding Y'*HY took 2.050 ms
Rank 0, Project_Hamiltonian used 48.938 ms
Total time for projection: 48.953 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.080 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.850683964726038
    last  calculated eigval = 0.036285081179906
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85068396472604
lambda[   2] =  -0.67866575298686
lambda[   3] =  -0.50773733329788
lambda[   4] =  -0.43215686798623
lambda[   5] =  -0.40746779642118
lambda[   6] =  -0.33304941427261
lambda[   7] =  -0.29723997925193
lambda[   8] =  -0.20596857250508
lambda[   9] =  -0.04292088535548
lambda[  10] =  -0.02444667097523
lambda[  11] =  -0.00834276322871
lambda[  12] =   0.02161071790500
lambda[  13] =   0.02839327302168
lambda[  14] =   0.03628508117991
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.439 ms
rank =  0, Distributing orbital back into band + domain format took 11.874 ms
rank = 0, Subspace_Rotation used 15.332 ms

Total time for subspace rotation: 15.351 ms
rank = 0, Efermi =  -0.072208603909 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 2.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.101 ms
rank = 0, Calculating density took 1203.208 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.470 ms
rank = 0, D2D took 0.611 ms
rank = 0, Transfering density took 0.613 ms
Etot    =   -24.155764424345
Eband   =    -7.425939363645
E1      =    17.232361433370
E2      =    -6.683556185756
E3      =    -9.312214874498
Exc     =    -8.326012706089
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 5.241e-07, dEband = 1.899e-06
rank = 0, Calculating/Estimating energy took 1.669 ms, Etot = -24.155764424, dEtot = 5.241e-07, dEband = 1.899e-06
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0318622616376, which took 0.178 ms

iter_count = 108, r_2norm = 1.061e-06, tol*||rhs|| = 1.274e-06

Anderson update took 65.473 ms, out of which F'*F took 27.006 ms; b-Ax took 188.012 ms, out of which Lap took 170.554 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.678 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746985, int_b + int_rho = -1.237e-13, checking this took 0.141 ms
2-norm of RHS = 577.5918941421111, which took 0.060 ms

iter_count = 84, r_2norm = 5.209e-04, tol*||rhs|| = 5.776e-04

Anderson update took 48.638 ms, out of which F'*F took 22.097 ms; b-Ax took 143.220 ms, out of which Lap took 129.685 ms
Solving Poisson took 308.654 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.169367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.189776 
Total time for convolution: 	 convolve: 5.162381 
Total time for convolution: 	 convolve: 5.169436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.303 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26727.110 ms, scf error = 2.271e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136285, lowerbound = -0.850684, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1130.567 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 12.810 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.403 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 14.251 ms
rank =  0, finding HY took 18.787 ms
rank =  0, distributing HY into block cyclic form took 12.753 ms
rank =  0, finding Y'*HY took 2.086 ms
Rank 0, Project_Hamiltonian used 47.914 ms
Total time for projection: 47.929 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.164 ms
    first calculated eigval = -0.850658899840380
    last  calculated eigval = 0.036103833155762
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85065889984038
lambda[   2] =  -0.67864760109909
lambda[   3] =  -0.50771408425024
lambda[   4] =  -0.43213786836498
lambda[   5] =  -0.40744909107979
lambda[   6] =  -0.33302501704345
lambda[   7] =  -0.29721631138268
lambda[   8] =  -0.20594917056361
lambda[   9] =  -0.04289290561089
lambda[  10] =  -0.02421191396418
lambda[  11] =  -0.00830490045674
lambda[  12] =   0.02162746902226
lambda[  13] =   0.02831490184071
lambda[  14] =   0.03610383315576
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.175 ms
rank =  0, subspace rotation using ScaLAPACK took 3.448 ms
rank =  0, Distributing orbital back into band + domain format took 11.900 ms
rank = 0, Subspace_Rotation used 15.372 ms

Total time for subspace rotation: 15.376 ms
rank = 0, Efermi =  -0.072180624214 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.356 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.823 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.074 ms
rank = 0, Calculating density took 1196.426 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.425 ms
rank = 0, D2D took 1.731 ms
rank = 0, Transfering density took 1.740 ms
Etot    =   -24.155760474601
Eband   =    -7.425596087998
E1      =    17.232224660085
E2      =    -6.683346988479
E3      =    -9.312240021094
Exc     =    -8.326031208026
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.583e-07, dEband = 5.721e-05
rank = 0, Calculating/Estimating energy took 2.273 ms, Etot = -24.155760475, dEtot = 6.583e-07, dEband = 5.721e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0329681448766, which took 0.952 ms

iter_count = 108, r_2norm = 1.026e-06, tol*||rhs|| = 1.319e-06

Anderson update took 59.476 ms, out of which F'*F took 27.004 ms; b-Ax took 189.915 ms, out of which Lap took 170.915 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 404.759 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746993, int_b + int_rho = -5.093e-14, checking this took 0.106 ms
2-norm of RHS = 577.5925754294340, which took 0.106 ms

iter_count = 102, r_2norm = 5.167e-04, tol*||rhs|| = 5.776e-04

Anderson update took 58.369 ms, out of which F'*F took 26.480 ms; b-Ax took 175.326 ms, out of which Lap took 158.972 ms
Solving Poisson took 372.170 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.171539 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.195385 
Total time for convolution: 	 convolve: 5.229956 
Total time for convolution: 	 convolve: 5.201032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.602 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.276 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.878 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.660 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.999 ms

This SCF took 26876.815 ms, scf error = 2.311e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.136104, lowerbound = -0.850659, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1142.036 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.697 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.539 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 14.290 ms
rank =  0, finding HY took 19.932 ms
rank =  0, distributing HY into block cyclic form took 13.139 ms
rank =  0, finding Y'*HY took 1.878 ms
Rank 0, Project_Hamiltonian used 49.275 ms
Total time for projection: 49.290 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.850613679136480
    last  calculated eigval = 0.036075557261369
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85061367913648
lambda[   2] =  -0.67861028962497
lambda[   3] =  -0.50767290909791
lambda[   4] =  -0.43210163380805
lambda[   5] =  -0.40741442350542
lambda[   6] =  -0.33298408224831
lambda[   7] =  -0.29717566889290
lambda[   8] =  -0.20591409131486
lambda[   9] =  -0.04285266230886
lambda[  10] =  -0.02395763748310
lambda[  11] =  -0.00828902618597
lambda[  12] =   0.02165160420675
lambda[  13] =   0.02846226487178
lambda[  14] =   0.03607555726137
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.142 ms
rank =  0, Distributing orbital back into band + domain format took 11.690 ms
rank = 0, Subspace_Rotation used 14.853 ms

Total time for subspace rotation: 14.857 ms
rank = 0, Efermi =  -0.072140380924 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.051 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.736 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1209.370 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.441 ms
rank = 0, D2D took 0.570 ms
rank = 0, Transfering density took 0.576 ms
Etot    =   -24.155764281171
Eband   =    -7.424973556006
E1      =    17.231941263226
E2      =    -6.683001640004
E3      =    -9.312251094718
Exc     =    -8.326039874878
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.344e-07, dEband = 1.038e-04
rank = 0, Calculating/Estimating energy took 1.662 ms, Etot = -24.155764281, dEtot = 6.344e-07, dEband = 1.038e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0334732052445, which took 0.050 ms

iter_count = 108, r_2norm = 9.975e-07, tol*||rhs|| = 1.339e-06

Anderson update took 59.732 ms, out of which F'*F took 28.872 ms; b-Ax took 188.091 ms, out of which Lap took 169.064 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.727 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746994, int_b + int_rho = -3.456e-14, checking this took 0.132 ms
2-norm of RHS = 577.5920501546544, which took 0.187 ms

iter_count = 90, r_2norm = 5.483e-04, tol*||rhs|| = 5.776e-04

Anderson update took 52.338 ms, out of which F'*F took 22.978 ms; b-Ax took 157.079 ms, out of which Lap took 140.971 ms
Solving Poisson took 333.612 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.202276 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.217456 
Total time for convolution: 	 convolve: 5.173668 
Total time for convolution: 	 convolve: 5.178433 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.771 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.306 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26838.021 ms, scf error = 2.332e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.136076, lowerbound = -0.850614, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1152.424 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.481 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.436 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 13.953 ms
rank =  0, finding HY took 18.472 ms
rank =  0, distributing HY into block cyclic form took 12.914 ms
rank =  0, finding Y'*HY took 1.972 ms
Rank 0, Project_Hamiltonian used 47.346 ms
Total time for projection: 47.362 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.156 ms
    first calculated eigval = -0.850632138869776
    last  calculated eigval = 0.035030581705663
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85063213886978
lambda[   2] =  -0.67863815772923
lambda[   3] =  -0.50769086447379
lambda[   4] =  -0.43212830580895
lambda[   5] =  -0.40744100043706
lambda[   6] =  -0.33300752195898
lambda[   7] =  -0.29719643416389
lambda[   8] =  -0.20593993965902
lambda[   9] =  -0.04290023874836
lambda[  10] =  -0.02465765372722
lambda[  11] =  -0.00846055760764
lambda[  12] =   0.02088929779547
lambda[  13] =   0.02805470476494
lambda[  14] =   0.03503058170566
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.168 ms
rank =  0, subspace rotation using ScaLAPACK took 3.145 ms
rank =  0, Distributing orbital back into band + domain format took 11.911 ms
rank = 0, Subspace_Rotation used 15.076 ms

Total time for subspace rotation: 15.080 ms
rank = 0, Efermi =  -0.072187957288 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 2.089 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.662 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1218.015 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.466 ms
rank = 0, D2D took 0.643 ms
rank = 0, Transfering density took 0.649 ms
Etot    =   -24.155768469196
Eband   =    -7.425348726951
E1      =    17.232098748779
E2      =    -6.683229320478
E3      =    -9.312189916507
Exc     =    -8.325992879775
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.980e-07, dEband = 6.253e-05
rank = 0, Calculating/Estimating energy took 1.261 ms, Etot = -24.155768469, dEtot = 6.980e-07, dEband = 6.253e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0311549251462, which took 0.064 ms

iter_count = 108, r_2norm = 9.822e-07, tol*||rhs|| = 1.246e-06

Anderson update took 62.164 ms, out of which F'*F took 27.715 ms; b-Ax took 190.107 ms, out of which Lap took 170.925 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 406.549 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746991, int_b + int_rho = -6.912e-14, checking this took 0.246 ms
2-norm of RHS = 577.5918442003930, which took 0.350 ms

iter_count = 84, r_2norm = 5.723e-04, tol*||rhs|| = 5.776e-04

Anderson update took 45.632 ms, out of which F'*F took 20.683 ms; b-Ax took 152.113 ms, out of which Lap took 134.988 ms
Solving Poisson took 312.033 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.425 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.182606 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.205902 
Total time for convolution: 	 convolve: 5.254687 
Total time for convolution: 	 convolve: 5.189659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.557 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.313 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.682 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.023 ms

This SCF took 26875.314 ms, scf error = 2.161e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.135031, lowerbound = -0.850632, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1132.612 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.526 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.460 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.026 ms
rank =  0, finding HY took 19.808 ms
rank =  0, distributing HY into block cyclic form took 12.618 ms
rank =  0, finding Y'*HY took 2.424 ms
Rank 0, Project_Hamiltonian used 48.937 ms
Total time for projection: 48.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.079 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.850599236373513
    last  calculated eigval = 0.034794486111131
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85059923637351
lambda[   2] =  -0.67861400585964
lambda[   3] =  -0.50766093058443
lambda[   4] =  -0.43210507934508
lambda[   5] =  -0.40741968171476
lambda[   6] =  -0.33298158321690
lambda[   7] =  -0.29716911549308
lambda[   8] =  -0.20591909602938
lambda[   9] =  -0.04287528129443
lambda[  10] =  -0.02451022587025
lambda[  11] =  -0.00845983567721
lambda[  12] =   0.02089472933223
lambda[  13] =   0.02817506976765
lambda[  14] =   0.03479448611113
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.269 ms
rank =  0, Distributing orbital back into band + domain format took 12.184 ms
rank = 0, Subspace_Rotation used 15.469 ms

Total time for subspace rotation: 15.472 ms
rank = 0, Efermi =  -0.072162999914 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.144 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.779 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1200.331 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.588 ms
rank = 0, D2D took 0.769 ms
rank = 0, Transfering density took 0.776 ms
Etot    =   -24.155770306194
Eband   =    -7.424937457983
E1      =    17.231864699954
E2      =    -6.683043268201
E3      =    -9.312229263638
Exc     =    -8.326025231769
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 3.062e-07, dEband = 6.854e-05
rank = 0, Calculating/Estimating energy took 0.942 ms, Etot = -24.155770306, dEtot = 3.062e-07, dEband = 6.854e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0259739638150, which took 0.056 ms

iter_count = 108, r_2norm = 9.094e-07, tol*||rhs|| = 1.039e-06

Anderson update took 64.127 ms, out of which F'*F took 27.396 ms; b-Ax took 191.481 ms, out of which Lap took 172.534 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 408.822 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746989, int_b + int_rho = -8.913e-14, checking this took 0.103 ms
2-norm of RHS = 577.5922608548791, which took 0.209 ms

iter_count = 120, r_2norm = 5.115e-04, tol*||rhs|| = 5.776e-04

Anderson update took 70.128 ms, out of which F'*F took 30.898 ms; b-Ax took 211.878 ms, out of which Lap took 190.358 ms
Solving Poisson took 446.841 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.186394 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.193018 
Total time for convolution: 	 convolve: 5.233727 
Total time for convolution: 	 convolve: 5.214498 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.776 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.476 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.988 ms

This SCF took 26998.453 ms, scf error = 2.078e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.134794, lowerbound = -0.850599, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.893 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.450 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.561 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.071 ms
rank =  0, finding HY took 18.932 ms
rank =  0, distributing HY into block cyclic form took 12.652 ms
rank =  0, finding Y'*HY took 2.091 ms
Rank 0, Project_Hamiltonian used 47.780 ms
Total time for projection: 47.798 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.126 ms
    first calculated eigval = -0.850636802700557
    last  calculated eigval = 0.034930968994146
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85063680270056
lambda[   2] =  -0.67863355728106
lambda[   3] =  -0.50768449614846
lambda[   4] =  -0.43212064683233
lambda[   5] =  -0.40742805322243
lambda[   6] =  -0.33301414699194
lambda[   7] =  -0.29719463869430
lambda[   8] =  -0.20593960313705
lambda[   9] =  -0.04289560421125
lambda[  10] =  -0.02408756278038
lambda[  11] =  -0.00847309759408
lambda[  12] =   0.02118047815521
lambda[  13] =   0.02876666178731
lambda[  14] =   0.03493096899415
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.138 ms
rank =  0, subspace rotation using ScaLAPACK took 3.173 ms
rank =  0, Distributing orbital back into band + domain format took 12.135 ms
rank = 0, Subspace_Rotation used 15.321 ms

Total time for subspace rotation: 15.324 ms
rank = 0, Efermi =  -0.072183322823 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.129 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.689 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1228.230 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.881 ms
rank = 0, D2D took 0.986 ms
rank = 0, Transfering density took 0.993 ms
Etot    =   -24.155773083833
Eband   =    -7.425303890766
E1      =    17.232132509398
E2      =    -6.683179316905
E3      =    -9.312087931299
Exc     =    -8.325924102436
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 4.629e-07, dEband = 6.107e-05
rank = 0, Calculating/Estimating energy took 1.108 ms, Etot = -24.155773084, dEtot = 4.629e-07, dEband = 6.107e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0341295561913, which took 2.192 ms

iter_count = 108, r_2norm = 9.236e-07, tol*||rhs|| = 1.365e-06

Anderson update took 57.719 ms, out of which F'*F took 27.772 ms; b-Ax took 190.241 ms, out of which Lap took 170.397 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.012 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746983, int_b + int_rho = -1.437e-13, checking this took 0.168 ms
2-norm of RHS = 577.5893140456934, which took 0.086 ms

iter_count = 84, r_2norm = 5.416e-04, tol*||rhs|| = 5.776e-04

Anderson update took 45.937 ms, out of which F'*F took 21.718 ms; b-Ax took 153.618 ms, out of which Lap took 136.992 ms
Solving Poisson took 315.451 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.183375 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.168781 
Total time for convolution: 	 convolve: 5.176499 
Total time for convolution: 	 convolve: 5.172877 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.732 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.542 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26752.029 ms, scf error = 2.364e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.134931, lowerbound = -0.850637, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1134.579 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.631 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.679 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 14.353 ms
rank =  0, finding HY took 19.592 ms
rank =  0, distributing HY into block cyclic form took 12.756 ms
rank =  0, finding Y'*HY took 2.716 ms
Rank 0, Project_Hamiltonian used 49.455 ms
Total time for projection: 49.471 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.850562979881921
    last  calculated eigval = 0.034024484970421
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85056297988192
lambda[   2] =  -0.67856850839334
lambda[   3] =  -0.50762927647325
lambda[   4] =  -0.43206501581972
lambda[   5] =  -0.40738049913226
lambda[   6] =  -0.33295485916307
lambda[   7] =  -0.29713909053293
lambda[   8] =  -0.20588835882855
lambda[   9] =  -0.04285446275274
lambda[  10] =  -0.02449216148790
lambda[  11] =  -0.00848119246861
lambda[  12] =   0.02066464248163
lambda[  13] =   0.02812643136099
lambda[  14] =   0.03402448497042
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.469 ms
rank =  0, Distributing orbital back into band + domain format took 11.914 ms
rank = 0, Subspace_Rotation used 15.399 ms

Total time for subspace rotation: 15.403 ms
rank = 0, Efermi =  -0.072142181348 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.137 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.761 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1202.745 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
rank = 0, D2D took 0.729 ms
rank = 0, Transfering density took 0.732 ms
Etot    =   -24.155777232640
Eband   =    -7.424377177199
E1      =    17.231448975285
E2      =    -6.682880828326
E3      =    -9.312297557208
Exc     =    -8.326082568027
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 6.915e-07, dEband = 1.545e-04
rank = 0, Calculating/Estimating energy took 0.976 ms, Etot = -24.155777233, dEtot = 6.915e-07, dEband = 1.545e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0199003206196, which took 0.244 ms

iter_count = 108, r_2norm = 7.921e-07, tol*||rhs|| = 7.960e-07

Anderson update took 59.492 ms, out of which F'*F took 29.956 ms; b-Ax took 198.947 ms, out of which Lap took 175.526 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.715 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746990, int_b + int_rho = -7.276e-14, checking this took 0.104 ms
2-norm of RHS = 577.5857956554273, which took 0.105 ms

iter_count = 114, r_2norm = 5.549e-04, tol*||rhs|| = 5.776e-04

Anderson update took 66.843 ms, out of which F'*F took 32.079 ms; b-Ax took 203.640 ms, out of which Lap took 181.909 ms
Solving Poisson took 428.932 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.924 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.243851 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.269799 
Total time for convolution: 	 convolve: 5.937740 
Total time for convolution: 	 convolve: 5.236002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.737 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.320 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.023 ms

This SCF took 27877.789 ms, scf error = 1.798e-04
-------------
SCF iter 22  
-------------

 Chebfilt 25, in Chebyshev filtering, lambda_cutoff = 0.134024, lowerbound = -0.850563, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1355.250 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 13.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.387 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 14.641 ms
rank =  0, finding HY took 19.103 ms
rank =  0, distributing HY into block cyclic form took 12.885 ms
rank =  0, finding Y'*HY took 1.987 ms
Rank 0, Project_Hamiltonian used 48.651 ms
Total time for projection: 48.662 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.850425136650924
    last  calculated eigval = 0.032762422321465
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85042513665092
lambda[   2] =  -0.67846515479918
lambda[   3] =  -0.50751768661502
lambda[   4] =  -0.43197439433853
lambda[   5] =  -0.40730121723338
lambda[   6] =  -0.33284590865852
lambda[   7] =  -0.29703255158321
lambda[   8] =  -0.20580051360026
lambda[   9] =  -0.04277602370492
lambda[  10] =  -0.02517169064576
lambda[  11] =  -0.00849583259545
lambda[  12] =   0.01992980171858
lambda[  13] =   0.02743526178634
lambda[  14] =   0.03276242232147
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.251 ms
rank =  0, Distributing orbital back into band + domain format took 12.088 ms
rank = 0, Subspace_Rotation used 15.351 ms

Total time for subspace rotation: 15.355 ms
rank = 0, Efermi =  -0.072063742310 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.175 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.711 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1422.482 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.508 ms
rank = 0, D2D took 0.705 ms
rank = 0, Transfering density took 0.709 ms
Etot    =   -24.155779017683
Eband   =    -7.422725127705
E1      =    17.230315216505
E2      =    -6.682266403590
E3      =    -9.312679166885
Exc     =    -8.326369828724
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 2.975e-07, dEband = 2.753e-04
rank = 0, Calculating/Estimating energy took 1.023 ms, Etot = -24.155779018, dEtot = 2.975e-07, dEband = 2.753e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0249606324040, which took 0.048 ms

iter_count = 102, r_2norm = 9.199e-07, tol*||rhs|| = 9.984e-07

Anderson update took 130.722 ms, out of which F'*F took 34.390 ms; b-Ax took 306.920 ms, out of which Lap took 290.523 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 639.924 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746993, int_b + int_rho = -5.093e-14, checking this took 0.098 ms
2-norm of RHS = 577.5855920123130, which took 0.712 ms

iter_count = 150, r_2norm = 4.850e-04, tol*||rhs|| = 5.776e-04

Anderson update took 382.227 ms, out of which F'*F took 142.869 ms; b-Ax took 741.861 ms, out of which Lap took 718.984 ms
Solving Poisson took 1420.394 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.130774 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 624.699 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.202022 
Total time for convolution: 	 convolve: 5.987254 
Total time for convolution: 	 convolve: 5.732370 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.217 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.686 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 23.043 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 23.752 ms

This SCF took 30508.679 ms, scf error = 1.154e-04
-------------
SCF iter 23  
-------------

 Chebfilt 26, in Chebyshev filtering, lambda_cutoff = 0.132762, lowerbound = -0.850425, upperbound = 267.574662

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 2480.828 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 11.326 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.319 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 33.265 ms
rank =  0, Distribute data + matrix mult took 45.921 ms
rank =  0, finding HY took 19.650 ms
rank =  0, distributing HY into block cyclic form took 13.728 ms
rank =  0, finding Y'*HY took 1.755 ms
Rank 0, Project_Hamiltonian used 81.088 ms
Total time for projection: 81.101 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.850229787926563
    last  calculated eigval = 0.032594020161254
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.85022978792656
lambda[   2] =  -0.67827637293884
lambda[   3] =  -0.50732858723389
lambda[   4] =  -0.43179668912809
lambda[   5] =  -0.40712339147721
lambda[   6] =  -0.33266994943178
lambda[   7] =  -0.29684929601889
lambda[   8] =  -0.20562276979090
lambda[   9] =  -0.04261792511761
lambda[  10] =  -0.02520576953354
lambda[  11] =  -0.00831811967769
lambda[  12] =   0.01975558914696
lambda[  13] =   0.02806092146422
lambda[  14] =   0.03259402016125
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 2.263 ms
rank =  0, Distributing orbital back into band + domain format took 11.325 ms
rank = 0, Subspace_Rotation used 13.601 ms

Total time for subspace rotation: 13.604 ms
rank = 0, Efermi =  -0.071905643727 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.367 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.630 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.063 ms
rank = 0, Calculating density took 2578.889 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.026 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.451 ms
rank = 0, D2D took 2.772 ms
rank = 0, Transfering density took 2.780 ms
Etot    =   -24.155781985560
Eband   =    -7.419793688637
E1      =    17.228744590506
E2      =    -6.680798946883
E3      =    -9.313091022981
Exc     =    -8.326678009059
Esc     =   -41.631944847708
Entropy =    -0.000000000527
dE = 4.946e-07, dEband = 4.886e-04
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -24.155781986, dEtot = 4.946e-07, dEband = 4.886e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0185248094892, which took 18.923 ms

iter_count = 102, r_2norm = 6.551e-07, tol*||rhs|| = 7.410e-07

Anderson update took 474.249 ms, out of which F'*F took 184.952 ms; b-Ax took 792.012 ms, out of which Lap took 780.357 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 1656.424 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001746998, int_rho =  16.00000001746988, int_b + int_rho = -1.019e-13, checking this took 0.153 ms
2-norm of RHS = 577.5877625640888, which took 22.105 ms

iter_count = 120, r_2norm = 5.492e-04, tol*||rhs|| = 5.776e-04

Anderson update took 514.779 ms, out of which F'*F took 344.814 ms; b-Ax took 1419.394 ms, out of which Lap took 1405.583 ms
Solving Poisson took 2271.382 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.535324 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.353 ms
Total time for convolution: 	 convolve: 5.210637 
Total time for convolution: 	 convolve: 5.480609 
Total time for convolution: 	 convolve: 5.950247 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.829 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.258 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 32850.779 ms, scf error = 7.037e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.85022978792656, occ[   1] =   2.00000000000000
lambda[   2] =  -0.67827637293884, occ[   2] =   2.00000000000000
lambda[   3] =  -0.50732858723389, occ[   3] =   2.00000000000000
lambda[   4] =  -0.43179668912809, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40712339147721, occ[   5] =   2.00000000000000
lambda[   6] =  -0.33266994943178, occ[   6] =   2.00000000000000
lambda[   7] =  -0.29684929601889, occ[   7] =   2.00000000000000
lambda[   8] =  -0.20562276979090, occ[   8] =   2.00000000000000
lambda[   9] =  -0.04261792511761, occ[   9] =   0.00000001746990
lambda[  10] =  -0.02520576953354, occ[  10] =   0.00000000000000
lambda[  11] =  -0.00831811967769, occ[  11] =   0.00000000000000
lambda[  12] =   0.01975558914696, occ[  12] =   0.00000000000000
lambda[  13] =   0.02806092146422, occ[  13] =   0.00000000000000
lambda[  14] =   0.03259402016125, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.469 ms, time for Allreduce/Reduce: 6.548 ms 
Time for calculating local force components: 15.221 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00289637698561   0.02557602801758  -0.04424513172394
 -0.00289640554604   0.02557600896437   0.04424511307200
 -0.05010087471911  -0.03778354614843  -0.00000000827369
  0.00194002744861   0.11997489612301   0.00000001349330
 -0.06050498774828   0.10175202616904  -0.00000009741470
  0.66715205045776  -0.46595564069944  -0.00000041959555
force_loc = 
  0.00317519942671  -0.02832811185617   0.04710122709340
  0.00317545221218  -0.02832968489219  -0.04710288770782
  0.05177839893717   0.04296082752837  -0.00000006536746
 -0.00263480731753  -0.11307521626273   0.00000589725931
  0.05731647085844  -0.10268091394546  -0.00000059358558
 -0.64980154402436   0.45195351002667  -0.00000182111946
Time for calculating nonlocal force components: 25.368 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00057880608032   0.00135926451408   0.00000027507784
[0m[32m  0.00097053513522   0.00061346415502  -0.00000002932062
[0m[32m -0.01604572481490   0.00639752822513  -0.00000003493065
[0mTime for calculating XC forces components: 19.725 ms
 Cartesian force = 
  0.00027072123444  -0.00275382382506   0.00285585587673
  0.00027094545948  -0.00275541591430  -0.00285801412855
  0.00166942301141   0.00517554139347  -0.00000031313388
 -0.00128168715590   0.00825720438789   0.00000594633772
 -0.00222608296128  -0.00031716360788  -0.00000095981363
  0.00129668041184  -0.00760634243412  -0.00000251513839
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 384.107 ms
The program took 674.448 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:31:06
Job ID:        2266463
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:18:12,vmem=8284K,walltime=00:11:31,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-12-2
---------------------------------------
