---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:42
Job ID:    2266749
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:46
Job ID:    2266749
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.050 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 18.100 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.005 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 15.078 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 70.988 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.957 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.098 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.141322	   13.709785	   10.000000	
   12.430038	    6.856504	   11.667188	
   12.430038	    6.856504	    8.332812	
    7.569962	    6.290215	   10.000000	
   10.278590	   11.670942	   10.000000	
   11.667112	    7.811594	   10.000000	
    8.831241	    7.902023	   10.000000	
    8.000746	   10.198029	   10.000000	
   12.398715	   10.478223	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.180 ms
Set up communicators.

--set up spincomm took 2.222 ms

--set up kptcomm took 0.347 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.008 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.044 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.842 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.794 ms

Calculate_SplineDerivRadFun took 0.212 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.281 ms.
time spent on vectorized spline interp: 2.728 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.062 ms.
time spent on vectorized spline interp: 1.765 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.527 ms.
time spent on vectorized spline interp: 1.740 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.621 ms.

Calculating rb for all atom types took 15.734 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.043 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000266218, sum_int_rho = 25.5865197682779
PosCharge = 26.000000026622, NegCharge = -25.586519768278, scal_fac = 1.016160082031
After scaling, int_rho = 26.0000000266217, PosCharge + NegCharge - NetCharge = 7.816e-14
--Calculate Vref took 0.591 ms
--Calculate rho_guess took 3.329 ms

 integral of b = -26.0000000266218,
 int{b} + Nelectron + NetCharge = -2.662e-08,
 Esc = -70.0048273070000,
 MPI_Reduce took 12.303 ms

Calculating b & b_ref took 23.702 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.042 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.052 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.004 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.970 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662178, int_b + int_rho = 1.273e-13, checking this took 0.091 ms
2-norm of RHS = 725.3229029413310, which took 0.731 ms

iter_count = 420, r_2norm = 6.798e-04, tol*||rhs|| = 7.253e-04

Anderson update took 261.235 ms, out of which F'*F took 118.353 ms; b-Ax took 817.133 ms, out of which Lap took 721.330 ms
Solving Poisson took 1778.698 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.399 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
Total time for convolution: 	 convolve: 5.155919 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 144.855 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.188103 
Total time for convolution: 	 convolve: 5.157298 
Total time for convolution: 	 convolve: 5.143157 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.718 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.315 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
rank = 0, XC calculation took 24653.693 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 2.195 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.173 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.473 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.137 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.837 ms
    Lanczos iter 53, eigmin  = -1.009029707, eigmax = 264.933145975, err_eigmin = 6.585e-04, err_eigmax = 9.625e-03
rank =   0, Lanczos took 133.226 ms, eigmin = -1.009029707196, eigmax = 267.582477434447

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.236724, lowerbound = -1.109030, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2024.486 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 23.292 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.194 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.020 ms
rank =  0, Distribute data + matrix mult took 27.538 ms
rank =  0, finding HY took 33.644 ms
rank =  0, distributing HY into block cyclic form took 22.177 ms
rank =  0, finding Y'*HY took 6.323 ms
Rank 0, Project_Hamiltonian used 89.722 ms
Total time for projection: 89.740 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.288 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.826 ms
rank = 0, Solve_Generalized_EigenProblem used 1.121 ms
    first calculated eigval = 2.683534867127810
    last  calculated eigval = 3.226046675029512
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81624180173920
lambda[   5] =   2.84871225555144
lambda[   6] =   2.89153126937160
lambda[   7] =   2.91588763698523
lambda[   8] =   2.94298629005343
lambda[   9] =   2.94592102411497
lambda[  10] =   2.97721373083620
lambda[  11] =   2.99253583093483
lambda[  12] =   3.03010962354676
lambda[  13] =   3.06027197180864
lambda[  14] =   3.09010582931044
lambda[  15] =   3.10374113014581
lambda[  16] =   3.13101795670674
lambda[  17] =   3.13784944297028
lambda[  18] =   3.14316208411790
lambda[  19] =   3.18052480747425
lambda[  20] =   3.22604667502951
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.169 ms
rank =  0, subspace rotation using ScaLAPACK took 6.565 ms
rank =  0, Distributing orbital back into band + domain format took 20.530 ms
rank = 0, Subspace_Rotation used 27.122 ms

Total time for subspace rotation: 27.127 ms
rank = 0, Efermi =   3.075188898014 calculate fermi energy took 0.080 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.326047, lowerbound = -1.109030, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2066.099 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.088 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.019 ms
rank =  0, Distribute data + matrix mult took 25.442 ms
rank =  0, finding HY took 33.270 ms
rank =  0, distributing HY into block cyclic form took 20.774 ms
rank =  0, finding Y'*HY took 6.228 ms
Rank 0, Project_Hamiltonian used 85.758 ms
Total time for projection: 85.778 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.742488985934742
    last  calculated eigval = 0.436662831122689
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.37204488752127
lambda[   5] =  -0.19130450673619
lambda[   6] =  -0.13945150415626
lambda[   7] =  -0.01548483425107
lambda[   8] =   0.03924237199103
lambda[   9] =   0.05752914531805
lambda[  10] =   0.11931442197061
lambda[  11] =   0.14478800080668
lambda[  12] =   0.23562678666691
lambda[  13] =   0.26643983769498
lambda[  14] =   0.30596457165585
lambda[  15] =   0.32213177043108
lambda[  16] =   0.34299086055483
lambda[  17] =   0.37116805274962
lambda[  18] =   0.37269520278255
lambda[  19] =   0.41893356805256
lambda[  20] =   0.43666283112269
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.194 ms
rank =  0, subspace rotation using ScaLAPACK took 6.500 ms
rank =  0, Distributing orbital back into band + domain format took 20.523 ms
rank = 0, Subspace_Rotation used 27.044 ms

Total time for subspace rotation: 27.048 ms
rank = 0, Efermi =   0.286202324285 calculate fermi energy took 0.043 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.536663, lowerbound = -1.109030, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1984.410 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.521 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.730 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 30.298 ms
rank =  0, finding HY took 36.726 ms
rank =  0, distributing HY into block cyclic form took 20.849 ms
rank =  0, finding Y'*HY took 6.173 ms
Rank 0, Project_Hamiltonian used 94.084 ms
Total time for projection: 94.101 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -1.012987493158199
    last  calculated eigval = 0.143918095100329
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64355090092045
lambda[   5] =  -0.61016643769852
lambda[   6] =  -0.53293657547312
lambda[   7] =  -0.51086831882315
lambda[   8] =  -0.48287616197213
lambda[   9] =  -0.44027075477806
lambda[  10] =  -0.38321213390996
lambda[  11] =  -0.34033371655741
lambda[  12] =  -0.31765895964823
lambda[  13] =  -0.25212789844484
lambda[  14] =  -0.09231563050117
lambda[  15] =   0.02518494610731
lambda[  16] =   0.06252594259593
lambda[  17] =   0.09301575849945
lambda[  18] =   0.11251153261804
lambda[  19] =   0.13067499557267
lambda[  20] =   0.14391809510033
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 6.478 ms
rank =  0, Distributing orbital back into band + domain format took 20.524 ms
rank = 0, Subspace_Rotation used 27.023 ms

Total time for subspace rotation: 27.029 ms
rank = 0, Efermi =  -0.121223762092 calculate fermi energy took 0.062 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.243918, lowerbound = -1.109030, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.254 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.010 ms
rank =  0, Distribute orbital to block cyclic format took 35.320 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.279 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 39.640 ms
rank =  0, finding HY took 33.390 ms
rank =  0, distributing HY into block cyclic form took 20.797 ms
rank =  0, finding Y'*HY took 6.174 ms
Rank 0, Project_Hamiltonian used 100.041 ms
Total time for projection: 100.085 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.169 ms
    first calculated eigval = -1.013757379951770
    last  calculated eigval = 0.084556289027049
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64562145785739
lambda[   5] =  -0.61345821476750
lambda[   6] =  -0.55225446858746
lambda[   7] =  -0.51927419797644
lambda[   8] =  -0.49081863343125
lambda[   9] =  -0.44997595734990
lambda[  10] =  -0.39978765571255
lambda[  11] =  -0.36778092035652
lambda[  12] =  -0.33692894691393
lambda[  13] =  -0.33560490928864
lambda[  14] =  -0.15156183161722
lambda[  15] =  -0.04525789749403
lambda[  16] =  -0.00136156150445
lambda[  17] =   0.04455444407455
lambda[  18] =   0.05307248401980
lambda[  19] =   0.06107982032693
lambda[  20] =   0.08455628902705
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.186 ms
rank =  0, subspace rotation using ScaLAPACK took 6.480 ms
rank =  0, Distributing orbital back into band + domain format took 20.585 ms
rank = 0, Subspace_Rotation used 27.087 ms

Total time for subspace rotation: 27.093 ms
rank = 0, Efermi =  -0.180469963222 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 5.717 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.804 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.282 ms
rank = 0, Calculating density took 8710.185 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.750 ms
rank = 0, D2D took 1.905 ms
rank = 0, Transfering density took 1.918 ms
Etot    =   -41.254807458011
Eband   =   -14.797724319846
E1      =    30.210265409168
E2      =   -11.853310975589
E3      =   -14.824330239675
Exc     =   -13.340162454804
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 4.584e+00, dEband = 1.644e+00
rank = 0, Calculating/Estimating energy took 1.571 ms, Etot = -41.254807458, dEtot = 4.584e+00, dEband = 1.644e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 52.8903530851502, which took 0.079 ms

iter_count = 96, r_2norm = 1.628e-03, tol*||rhs|| = 2.116e-03

Anderson update took 62.766 ms, out of which F'*F took 27.770 ms; b-Ax took 181.443 ms, out of which Lap took 164.959 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 410.214 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662175, int_b + int_rho = 9.459e-14, checking this took 0.124 ms
2-norm of RHS = 721.0389203881308, which took 0.199 ms

iter_count = 288, r_2norm = 5.674e-04, tol*||rhs|| = 7.210e-04

Anderson update took 175.843 ms, out of which F'*F took 81.180 ms; b-Ax took 543.905 ms, out of which Lap took 487.263 ms
Solving Poisson took 1198.147 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.830 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Total time for convolution: 	 convolve: 5.089711 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 79.965 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.141143 
Total time for convolution: 	 convolve: 5.075493 
Total time for convolution: 	 convolve: 5.078676 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.379 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.243 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 1.304 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.476 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.804 ms

This SCF took 34806.730 ms, scf error = 1.773e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184556, lowerbound = -1.013757, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1999.001 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.674 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.403 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 25.118 ms
rank =  0, finding HY took 33.607 ms
rank =  0, distributing HY into block cyclic form took 20.870 ms
rank =  0, finding Y'*HY took 6.292 ms
Rank 0, Project_Hamiltonian used 85.936 ms
Total time for projection: 85.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.985944032337104
    last  calculated eigval = 0.055303505298076
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.62133201677223
lambda[   5] =  -0.58957106442787
lambda[   6] =  -0.52417060522329
lambda[   7] =  -0.49431862135442
lambda[   8] =  -0.46255288341743
lambda[   9] =  -0.42629895764511
lambda[  10] =  -0.38031309673529
lambda[  11] =  -0.33424812170809
lambda[  12] =  -0.31252281952822
lambda[  13] =  -0.30231700361871
lambda[  14] =  -0.13999745286597
lambda[  15] =  -0.04817678466043
lambda[  16] =  -0.02257234647216
lambda[  17] =   0.02005457971651
lambda[  18] =   0.02716237636765
lambda[  19] =   0.04720354410796
lambda[  20] =   0.05530350529808
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 7.066 ms
rank =  0, Distributing orbital back into band + domain format took 21.913 ms
rank = 0, Subspace_Rotation used 29.001 ms

Total time for subspace rotation: 29.008 ms
rank = 0, Efermi =  -0.168905584473 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.296 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.008 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.334 ms
rank = 0, Calculating density took 2124.688 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.002 ms
rank = 0, D2D took 1.107 ms
rank = 0, Transfering density took 1.114 ms
Etot    =   -41.203149053544
Eband   =   -14.093880609574
E1      =    29.587154638297
E2      =   -11.788993896764
E3      =   -15.009042417307
Exc     =   -13.489632088546
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 5.740e-03, dEband = 7.820e-02
rank = 0, Calculating/Estimating energy took 1.027 ms, Etot = -41.203149054, dEtot = 5.740e-03, dEband = 7.820e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 23.5325575802871, which took 0.088 ms

iter_count = 102, r_2norm = 6.432e-04, tol*||rhs|| = 9.413e-04

Anderson update took 62.198 ms, out of which F'*F took 28.862 ms; b-Ax took 193.698 ms, out of which Lap took 173.276 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 434.418 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662170, int_b + int_rho = 4.366e-14, checking this took 0.119 ms
2-norm of RHS = 716.1544120988832, which took 0.134 ms

iter_count = 300, r_2norm = 5.955e-04, tol*||rhs|| = 7.162e-04

Anderson update took 179.473 ms, out of which F'*F took 83.429 ms; b-Ax took 563.400 ms, out of which Lap took 502.824 ms
Solving Poisson took 1238.883 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.086994 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 3.414 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.095530 
Total time for convolution: 	 convolve: 5.109116 
Total time for convolution: 	 convolve: 5.083719 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.281 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.487 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.791 ms

This SCF took 28352.904 ms, scf error = 1.208e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.155304, lowerbound = -0.985944, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2048.201 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.996 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.582 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.407 ms
rank =  0, Distribute data + matrix mult took 26.002 ms
rank =  0, finding HY took 31.219 ms
rank =  0, distributing HY into block cyclic form took 33.959 ms
rank =  0, finding Y'*HY took 6.581 ms
Rank 0, Project_Hamiltonian used 97.803 ms
Total time for projection: 97.819 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.943150668484658
    last  calculated eigval = 0.051286422539635
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.57783247135605
lambda[   5] =  -0.54826095781236
lambda[   6] =  -0.47789474091541
lambda[   7] =  -0.45551647256158
lambda[   8] =  -0.41760937536986
lambda[   9] =  -0.38342357318993
lambda[  10] =  -0.34674171948255
lambda[  11] =  -0.28673025422192
lambda[  12] =  -0.27935872202356
lambda[  13] =  -0.25527947775047
lambda[  14] =  -0.10998239947927
lambda[  15] =  -0.02923131119080
lambda[  16] =  -0.02357095268528
lambda[  17] =   0.01417136599224
lambda[  18] =   0.01866482562538
lambda[  19] =   0.03600732296937
lambda[  20] =   0.05128642253963
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 8.060 ms
rank =  0, Distributing orbital back into band + domain format took 20.917 ms
rank = 0, Subspace_Rotation used 28.998 ms

Total time for subspace rotation: 29.004 ms
rank = 0, Efermi =  -0.138890531135 calculate fermi energy took 0.059 ms
rank = 0, --- Calculate rho: sum over local bands took 5.388 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.805 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.278 ms
rank = 0, Calculating density took 2185.236 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.036 ms
rank = 0, D2D took 1.204 ms
rank = 0, Transfering density took 1.208 ms
Etot    =   -41.158062600766
Eband   =   -12.986034777062
E1      =    28.653919703862
E2      =   -11.598368309758
E3      =   -15.327313766853
Exc     =   -13.746802296384
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 5.010e-03, dEband = 1.231e-01
rank = 0, Calculating/Estimating energy took 1.018 ms, Etot = -41.158062601, dEtot = 5.010e-03, dEband = 1.231e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.4829492738690, which took 0.070 ms

iter_count = 108, r_2norm = 1.644e-04, tol*||rhs|| = 2.593e-04

Anderson update took 67.696 ms, out of which F'*F took 31.193 ms; b-Ax took 206.188 ms, out of which Lap took 185.949 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 463.042 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662163, int_b + int_rho = -2.910e-14, checking this took 0.130 ms
2-norm of RHS = 715.7727661981473, which took 0.192 ms

iter_count = 276, r_2norm = 6.542e-04, tol*||rhs|| = 7.158e-04

Anderson update took 163.952 ms, out of which F'*F took 77.024 ms; b-Ax took 522.346 ms, out of which Lap took 466.477 ms
Solving Poisson took 1143.332 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
Total time for convolution: 	 convolve: 5.082614 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 10.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.088519 
Total time for convolution: 	 convolve: 5.084868 
Total time for convolution: 	 convolve: 5.104667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.913 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.327 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 1.303 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.515 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.841 ms

This SCF took 28209.569 ms, scf error = 4.154e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.151286, lowerbound = -0.943151, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2010.148 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 25.599 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.500 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 30.137 ms
rank =  0, finding HY took 32.362 ms
rank =  0, distributing HY into block cyclic form took 20.738 ms
rank =  0, finding Y'*HY took 5.742 ms
Rank 0, Project_Hamiltonian used 89.025 ms
Total time for projection: 89.045 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.604 ms
rank = 0, Solve_Generalized_EigenProblem used 1.105 ms
    first calculated eigval = -0.928459063246797
    last  calculated eigval = 0.046249336565031
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56152397542851
lambda[   5] =  -0.53183921707318
lambda[   6] =  -0.46171144372622
lambda[   7] =  -0.44199247024865
lambda[   8] =  -0.40143756090585
lambda[   9] =  -0.36691803637571
lambda[  10] =  -0.33456101385980
lambda[  11] =  -0.27172620081492
lambda[  12] =  -0.26849342924206
lambda[  13] =  -0.24138200156697
lambda[  14] =  -0.09867792274516
lambda[  15] =  -0.03039716128349
lambda[  16] =  -0.01475915680286
lambda[  17] =   0.01315294603425
lambda[  18] =   0.01668449126176
lambda[  19] =   0.02796330588206
lambda[  20] =   0.04624933656503
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.122 ms
rank =  0, subspace rotation using ScaLAPACK took 7.605 ms
rank =  0, Distributing orbital back into band + domain format took 21.123 ms
rank = 0, Subspace_Rotation used 28.745 ms

Total time for subspace rotation: 28.751 ms
rank = 0, Efermi =  -0.127586054398 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.296 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.468 ms
rank = 0, Calculating density took 2139.237 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.089 ms
rank = 0, D2D took 1.281 ms
rank = 0, Transfering density took 1.286 ms
Etot    =   -41.152338394634
Eband   =   -12.600354910752
E1      =    28.373634764236
E2      =   -11.474054519045
E3      =   -15.443994847068
Exc     =   -13.838840306439
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 6.360e-04, dEband = 4.285e-02
rank = 0, Calculating/Estimating energy took 1.144 ms, Etot = -41.152338395, dEtot = 6.360e-04, dEband = 4.285e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.0895038240341, which took 0.058 ms

iter_count = 108, r_2norm = 8.120e-05, tol*||rhs|| = 8.358e-05

Anderson update took 64.149 ms, out of which F'*F took 30.527 ms; b-Ax took 210.235 ms, out of which Lap took 187.709 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.742 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662170, int_b + int_rho = 3.638e-14, checking this took 0.112 ms
2-norm of RHS = 716.8630150098215, which took 0.165 ms

iter_count = 264, r_2norm = 6.314e-04, tol*||rhs|| = 7.169e-04

Anderson update took 156.236 ms, out of which F'*F took 73.418 ms; b-Ax took 498.996 ms, out of which Lap took 445.400 ms
Solving Poisson took 1093.146 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.078889 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.139 ms
Total time for convolution: 	 convolve: 5.082615 
Total time for convolution: 	 convolve: 5.075014 
Total time for convolution: 	 convolve: 5.071689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.410 ms
---Transfer Veff_loc: D2D took 1.314 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.253 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.596 ms

This SCF took 28012.709 ms, scf error = 1.815e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.146249, lowerbound = -0.928459, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2017.655 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.977 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.509 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 26.035 ms
rank =  0, finding HY took 32.288 ms
rank =  0, distributing HY into block cyclic form took 20.787 ms
rank =  0, finding Y'*HY took 5.838 ms
Rank 0, Project_Hamiltonian used 84.996 ms
Total time for projection: 85.014 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.129 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.192 ms
    first calculated eigval = -0.923081752432191
    last  calculated eigval = 0.042143923162701
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55577139241934
lambda[   5] =  -0.52574764897323
lambda[   6] =  -0.45638594478403
lambda[   7] =  -0.43721934436979
lambda[   8] =  -0.39573364952885
lambda[   9] =  -0.36070245903270
lambda[  10] =  -0.32987373231643
lambda[  11] =  -0.26658734898701
lambda[  12] =  -0.26423769601456
lambda[  13] =  -0.23631495341192
lambda[  14] =  -0.09427506331925
lambda[  15] =  -0.03060721529744
lambda[  16] =  -0.01160068755508
lambda[  17] =   0.01277025225960
lambda[  18] =   0.01627667948485
lambda[  19] =   0.02331421407696
lambda[  20] =   0.04214392316270
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 7.623 ms
rank =  0, Distributing orbital back into band + domain format took 21.289 ms
rank = 0, Subspace_Rotation used 28.932 ms

Total time for subspace rotation: 28.937 ms
rank = 0, Efermi =  -0.123183194952 calculate fermi energy took 2.425 ms
rank = 0, --- Calculate rho: sum over local bands took 5.332 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.567 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.266 ms
rank = 0, Calculating density took 2142.486 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.034 ms
rank = 0, D2D took 1.203 ms
rank = 0, Transfering density took 1.206 ms
Etot    =   -41.150791758481
Eband   =   -12.463036168840
E1      =    28.325304110988
E2      =   -11.375961630992
E3      =   -15.478531518761
Exc     =   -13.862725542588
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 1.718e-04, dEband = 1.526e-02
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -41.150791758, dEtot = 1.718e-04, dEband = 1.526e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.8417978599546, which took 0.126 ms

iter_count = 114, r_2norm = 2.380e-05, tol*||rhs|| = 3.367e-05

Anderson update took 67.772 ms, out of which F'*F took 31.933 ms; b-Ax took 213.581 ms, out of which Lap took 191.559 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.848 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662162, int_b + int_rho = -3.638e-14, checking this took 0.113 ms
2-norm of RHS = 717.2229634638405, which took 0.160 ms

iter_count = 240, r_2norm = 6.118e-04, tol*||rhs|| = 7.172e-04

Anderson update took 145.606 ms, out of which F'*F took 66.610 ms; b-Ax took 453.119 ms, out of which Lap took 403.264 ms
Solving Poisson took 990.304 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.166 ms
Total time for convolution: 	 convolve: 5.081073 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 72.186 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.074729 
Total time for convolution: 	 convolve: 5.105319 
Total time for convolution: 	 convolve: 5.092594 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 24.089 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 1.606 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.633 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.268 ms

This SCF took 28505.222 ms, scf error = 6.175e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.142144, lowerbound = -0.923082, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 2015.144 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 32.828 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 37.282 ms
rank =  0, finding HY took 32.488 ms
rank =  0, distributing HY into block cyclic form took 20.756 ms
rank =  0, finding Y'*HY took 5.801 ms
Rank 0, Project_Hamiltonian used 96.369 ms
Total time for projection: 96.387 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.920167966922395
    last  calculated eigval = 0.039333894570648
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.55321723935458
lambda[   5] =  -0.52337063517816
lambda[   6] =  -0.45363822033107
lambda[   7] =  -0.43476972012063
lambda[   8] =  -0.39313230761897
lambda[   9] =  -0.35820264985944
lambda[  10] =  -0.32739839086749
lambda[  11] =  -0.26350285920186
lambda[  12] =  -0.26170394410018
lambda[  13] =  -0.23295242074562
lambda[  14] =  -0.09210659068747
lambda[  15] =  -0.03062098316884
lambda[  16] =  -0.00996655740571
lambda[  17] =   0.01232619389711
lambda[  18] =   0.01624425140929
lambda[  19] =   0.02063800053833
lambda[  20] =   0.03933389457065
==subpsace eigenproblem: bcast eigvals took 0.025 ms
Total time for solving subspace eigenvalue problem: 0.224 ms
rank =  0, subspace rotation using ScaLAPACK took 7.593 ms
rank =  0, Distributing orbital back into band + domain format took 21.206 ms
rank = 0, Subspace_Rotation used 28.818 ms

Total time for subspace rotation: 28.823 ms
rank = 0, Efermi =  -0.121014722302 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.166 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.228 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.309 ms
rank = 0, Calculating density took 2150.760 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.024 ms
rank = 0, D2D took 1.177 ms
rank = 0, Transfering density took 1.184 ms
Etot    =   -41.150384820980
Eband   =   -12.392807524736
E1      =    28.297224355969
E2      =   -11.330132970238
E3      =   -15.490848761111
Exc     =   -13.870956075769
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 4.522e-05, dEband = 7.803e-03
rank = 0, Calculating/Estimating energy took 1.004 ms, Etot = -41.150384821, dEtot = 4.522e-05, dEband = 7.803e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4360146014678, which took 0.072 ms

iter_count = 114, r_2norm = 1.166e-05, tol*||rhs|| = 1.744e-05

Anderson update took 68.061 ms, out of which F'*F took 31.381 ms; b-Ax took 213.463 ms, out of which Lap took 189.655 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.138 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662168, int_b + int_rho = 2.183e-14, checking this took 0.120 ms
2-norm of RHS = 717.5043410777766, which took 0.167 ms

iter_count = 246, r_2norm = 6.980e-04, tol*||rhs|| = 7.175e-04

Anderson update took 144.575 ms, out of which F'*F took 67.903 ms; b-Ax took 462.511 ms, out of which Lap took 411.016 ms
Solving Poisson took 1014.905 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.074925 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.240 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.095739 
Total time for convolution: 	 convolve: 5.089943 
Total time for convolution: 	 convolve: 5.080812 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.628 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.300 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.244 ms
---Transfer Veff_loc: D2D took 2.448 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.864 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.351 ms

This SCF took 28095.110 ms, scf error = 3.843e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.139334, lowerbound = -0.920168, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1985.553 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 20.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.442 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.340 ms
rank =  0, finding HY took 32.399 ms
rank =  0, distributing HY into block cyclic form took 20.678 ms
rank =  0, finding Y'*HY took 5.793 ms
Rank 0, Project_Hamiltonian used 84.249 ms
Total time for projection: 84.264 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.915906275169848
    last  calculated eigval = 0.038158133255643
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54932846865426
lambda[   5] =  -0.51965513271593
lambda[   6] =  -0.44932335999958
lambda[   7] =  -0.43112072801171
lambda[   8] =  -0.38934353087597
lambda[   9] =  -0.35455042145302
lambda[  10] =  -0.32370780248530
lambda[  11] =  -0.25914770239532
lambda[  12] =  -0.25793399687065
lambda[  13] =  -0.22854838973255
lambda[  14] =  -0.08861139040296
lambda[  15] =  -0.03015429227116
lambda[  16] =  -0.00725968310570
lambda[  17] =   0.01250820040586
lambda[  18] =   0.01727496429761
lambda[  19] =   0.02063557301346
lambda[  20] =   0.03815813325564
==subpsace eigenproblem: bcast eigvals took 0.027 ms
Total time for solving subspace eigenvalue problem: 0.213 ms
rank =  0, subspace rotation using ScaLAPACK took 7.597 ms
rank =  0, Distributing orbital back into band + domain format took 21.269 ms
rank = 0, Subspace_Rotation used 28.883 ms

Total time for subspace rotation: 28.888 ms
rank = 0, Efermi =  -0.117519522080 calculate fermi energy took 0.095 ms
rank = 0, --- Calculate rho: sum over local bands took 5.206 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.012 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.301 ms
rank = 0, Calculating density took 2108.599 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.997 ms
rank = 0, D2D took 1.177 ms
rank = 0, Transfering density took 1.181 ms
Etot    =   -41.150091976266
Eband   =   -12.289213939347
E1      =    28.249154285035
E2      =   -11.270731892119
E3      =   -15.503883847596
Exc     =   -13.879820753876
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 3.254e-05, dEband = 1.151e-02
rank = 0, Calculating/Estimating energy took 1.022 ms, Etot = -41.150091976, dEtot = 3.254e-05, dEband = 1.151e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3115731444625, which took 0.072 ms

iter_count = 114, r_2norm = 7.654e-06, tol*||rhs|| = 1.246e-05

Anderson update took 67.547 ms, out of which F'*F took 31.418 ms; b-Ax took 213.023 ms, out of which Lap took 188.970 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 476.135 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662170, int_b + int_rho = 4.366e-14, checking this took 0.080 ms
2-norm of RHS = 717.4688628518380, which took 0.172 ms

iter_count = 228, r_2norm = 6.413e-04, tol*||rhs|| = 7.175e-04

Anderson update took 132.293 ms, out of which F'*F took 63.404 ms; b-Ax took 429.553 ms, out of which Lap took 381.953 ms
Solving Poisson took 937.520 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.098763 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.080483 
Total time for convolution: 	 convolve: 5.076475 
Total time for convolution: 	 convolve: 5.076782 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.157 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 1.696 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.889 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.623 ms

This SCF took 27979.218 ms, scf error = 1.922e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.138158, lowerbound = -0.915906, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1978.859 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 21.094 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.279 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.407 ms
rank =  0, finding HY took 32.347 ms
rank =  0, distributing HY into block cyclic form took 20.721 ms
rank =  0, finding Y'*HY took 6.341 ms
Rank 0, Project_Hamiltonian used 84.854 ms
Total time for projection: 84.867 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.063 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.913374577849917
    last  calculated eigval = 0.037677384313177
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54697260204731
lambda[   5] =  -0.51736130085109
lambda[   6] =  -0.44693707394138
lambda[   7] =  -0.42911964004101
lambda[   8] =  -0.38701717027195
lambda[   9] =  -0.35225029504717
lambda[  10] =  -0.32155026944982
lambda[  11] =  -0.25652198952991
lambda[  12] =  -0.25549282744175
lambda[  13] =  -0.22582729385172
lambda[  14] =  -0.08641714374649
lambda[  15] =  -0.02920758781270
lambda[  16] =  -0.00530779160958
lambda[  17] =   0.01315090708928
lambda[  18] =   0.01855902286101
lambda[  19] =   0.02160951358970
lambda[  20] =   0.03767738431318
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.202 ms
rank =  0, subspace rotation using ScaLAPACK took 7.676 ms
rank =  0, Distributing orbital back into band + domain format took 21.124 ms
rank = 0, Subspace_Rotation used 28.820 ms

Total time for subspace rotation: 28.826 ms
rank = 0, Efermi =  -0.115325275376 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 5.235 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.211 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.292 ms
rank = 0, Calculating density took 2102.619 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.012 ms
rank = 0, D2D took 1.167 ms
rank = 0, Transfering density took 1.170 ms
Etot    =   -41.150099404764
Eband   =   -12.227144527814
E1      =    28.214733633670
E2      =   -11.241082023480
E3      =   -15.511988993434
Exc     =   -13.885932219741
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 8.254e-07, dEband = 6.897e-03
rank = 0, Calculating/Estimating energy took 1.038 ms, Etot = -41.150099405, dEtot = 8.254e-07, dEband = 6.897e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1945189357598, which took 0.062 ms

iter_count = 114, r_2norm = 5.787e-06, tol*||rhs|| = 7.781e-06

Anderson update took 67.441 ms, out of which F'*F took 33.622 ms; b-Ax took 215.550 ms, out of which Lap took 191.390 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.036 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662170, int_b + int_rho = 3.638e-14, checking this took 0.104 ms
2-norm of RHS = 717.4853214787050, which took 0.134 ms

iter_count = 210, r_2norm = 5.824e-04, tol*||rhs|| = 7.175e-04

Anderson update took 121.975 ms, out of which F'*F took 57.412 ms; b-Ax took 393.155 ms, out of which Lap took 349.549 ms
Solving Poisson took 862.449 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.087753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.366 ms
Total time for convolution: 	 convolve: 5.081071 
Total time for convolution: 	 convolve: 5.082181 
Total time for convolution: 	 convolve: 5.078778 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.308 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 1.711 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.908 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.655 ms

This SCF took 27799.463 ms, scf error = 1.274e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.137677, lowerbound = -0.913375, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1981.497 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.019 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.473 ms
rank =  0, finding HY took 32.276 ms
rank =  0, distributing HY into block cyclic form took 20.626 ms
rank =  0, finding Y'*HY took 5.871 ms
Rank 0, Project_Hamiltonian used 84.289 ms
Total time for projection: 84.301 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.175 ms
    first calculated eigval = -0.912563007382522
    last  calculated eigval = 0.037276714334443
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54623673808675
lambda[   5] =  -0.51664891102219
lambda[   6] =  -0.44620162320192
lambda[   7] =  -0.42843547391442
lambda[   8] =  -0.38631281733191
lambda[   9] =  -0.35152825988414
lambda[  10] =  -0.32076791190675
lambda[  11] =  -0.25572925801704
lambda[  12] =  -0.25466003644595
lambda[  13] =  -0.22499065723181
lambda[  14] =  -0.08561619488282
lambda[  15] =  -0.02802302203290
lambda[  16] =  -0.00431000670230
lambda[  17] =   0.01400092604349
lambda[  18] =   0.01991024605735
lambda[  19] =   0.02265818560492
lambda[  20] =   0.03727671433444
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 7.641 ms
rank =  0, Distributing orbital back into band + domain format took 21.085 ms
rank = 0, Subspace_Rotation used 28.747 ms

Total time for subspace rotation: 28.754 ms
rank = 0, Efermi =  -0.114524326541 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.398 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.952 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.291 ms
rank = 0, Calculating density took 2104.531 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.047 ms
rank = 0, D2D took 2.050 ms
rank = 0, Transfering density took 2.053 ms
Etot    =   -41.150129305652
Eband   =   -12.207439728892
E1      =    28.206977280003
E2      =   -11.228995940141
E3      =   -15.512037822263
Exc     =   -13.885873311375
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 3.322e-06, dEband = 2.189e-03
rank = 0, Calculating/Estimating energy took 0.963 ms, Etot = -41.150129306, dEtot = 3.322e-06, dEband = 2.189e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1006180580212, which took 0.059 ms

iter_count = 114, r_2norm = 2.933e-06, tol*||rhs|| = 4.025e-06

Anderson update took 66.967 ms, out of which F'*F took 31.448 ms; b-Ax took 212.843 ms, out of which Lap took 188.647 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.665 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662177, int_b + int_rho = 1.091e-13, checking this took 0.115 ms
2-norm of RHS = 717.4573346174664, which took 0.136 ms

iter_count = 216, r_2norm = 6.320e-04, tol*||rhs|| = 7.175e-04

Anderson update took 125.983 ms, out of which F'*F took 58.987 ms; b-Ax took 406.226 ms, out of which Lap took 361.027 ms
Solving Poisson took 888.903 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.079801 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
Total time for convolution: 	 convolve: 5.084174 
Total time for convolution: 	 convolve: 5.085159 
Total time for convolution: 	 convolve: 5.083511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 1.457 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.776 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.263 ms

This SCF took 27807.371 ms, scf error = 9.175e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.137277, lowerbound = -0.912563, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1982.584 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 20.937 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.403 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.377 ms
rank =  0, finding HY took 32.384 ms
rank =  0, distributing HY into block cyclic form took 20.786 ms
rank =  0, finding Y'*HY took 5.722 ms
Rank 0, Project_Hamiltonian used 84.309 ms
Total time for projection: 84.322 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.178 ms
    first calculated eigval = -0.910994037739682
    last  calculated eigval = 0.037210526779140
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54470240097561
lambda[   5] =  -0.51514922222962
lambda[   6] =  -0.44465298997899
lambda[   7] =  -0.42693307067430
lambda[   8] =  -0.38481814686874
lambda[   9] =  -0.35000318503366
lambda[  10] =  -0.31924039091231
lambda[  11] =  -0.25419797011747
lambda[  12] =  -0.25316511692180
lambda[  13] =  -0.22345568917438
lambda[  14] =  -0.08410241758840
lambda[  15] =  -0.02436252707344
lambda[  16] =  -0.00210107733534
lambda[  17] =   0.01756338476945
lambda[  18] =   0.02393165941768
lambda[  19] =   0.02653835778198
lambda[  20] =   0.03721052677914
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.200 ms
rank =  0, subspace rotation using ScaLAPACK took 7.584 ms
rank =  0, Distributing orbital back into band + domain format took 21.120 ms
rank = 0, Subspace_Rotation used 28.726 ms

Total time for subspace rotation: 28.733 ms
rank = 0, Efermi =  -0.113010549205 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 5.306 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.937 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.988 ms
rank = 0, Calculating density took 2106.941 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.702 ms
rank = 0, D2D took 0.811 ms
rank = 0, Transfering density took 0.818 ms
Etot    =   -41.150207266405
Eband   =   -12.167747661567
E1      =    28.186775095837
E2      =   -11.208890557751
E3      =   -15.514908621340
Exc     =   -13.888206571973
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 8.662e-06, dEband = 4.410e-03
rank = 0, Calculating/Estimating energy took 1.146 ms, Etot = -41.150207266, dEtot = 8.662e-06, dEband = 4.410e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0747269447938, which took 0.072 ms

iter_count = 114, r_2norm = 2.317e-06, tol*||rhs|| = 2.989e-06

Anderson update took 66.421 ms, out of which F'*F took 31.067 ms; b-Ax took 212.975 ms, out of which Lap took 188.957 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.759 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662167, int_b + int_rho = 7.276e-15, checking this took 0.112 ms
2-norm of RHS = 717.4617068979901, which took 0.157 ms

iter_count = 180, r_2norm = 6.235e-04, tol*||rhs|| = 7.175e-04

Anderson update took 104.860 ms, out of which F'*F took 49.402 ms; b-Ax took 336.668 ms, out of which Lap took 299.604 ms
Solving Poisson took 739.253 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.079798 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.856 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.371 ms
Total time for convolution: 	 convolve: 5.078311 
Total time for convolution: 	 convolve: 5.083170 
Total time for convolution: 	 convolve: 5.084533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.315 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 1.782 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.888 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.707 ms

This SCF took 27667.623 ms, scf error = 5.341e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.137211, lowerbound = -0.910994, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1982.080 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 21.129 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.343 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.509 ms
rank =  0, finding HY took 32.338 ms
rank =  0, distributing HY into block cyclic form took 20.667 ms
rank =  0, finding Y'*HY took 5.814 ms
Rank 0, Project_Hamiltonian used 84.369 ms
Total time for projection: 84.384 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.106 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.054 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -0.910514742269951
    last  calculated eigval = 0.036260075525929
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54426126660831
lambda[   5] =  -0.51470325404711
lambda[   6] =  -0.44418591878646
lambda[   7] =  -0.42645512756093
lambda[   8] =  -0.38437461624237
lambda[   9] =  -0.34956491487369
lambda[  10] =  -0.31878756358187
lambda[  11] =  -0.25375231504116
lambda[  12] =  -0.25268356310930
lambda[  13] =  -0.22302105159457
lambda[  14] =  -0.08363881628865
lambda[  15] =  -0.02284211397251
lambda[  16] =  -0.00141375302193
lambda[  17] =   0.01891205167507
lambda[  18] =   0.02541441075435
lambda[  19] =   0.02758250284966
lambda[  20] =   0.03626007552593
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.181 ms
rank =  0, subspace rotation using ScaLAPACK took 7.641 ms
rank =  0, Distributing orbital back into band + domain format took 21.077 ms
rank = 0, Subspace_Rotation used 28.736 ms

Total time for subspace rotation: 28.743 ms
rank = 0, Efermi =  -0.112546947894 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 5.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.151 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.317 ms
rank = 0, Calculating density took 2105.135 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.014 ms
rank = 0, D2D took 1.187 ms
rank = 0, Transfering density took 1.192 ms
Etot    =   -41.150283083648
Eband   =   -12.155849401360
E1      =    28.181044923124
E2      =   -11.202589936912
E3      =   -15.515344999704
Exc     =   -13.888586234235
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 8.424e-06, dEband = 1.322e-03
rank = 0, Calculating/Estimating energy took 1.006 ms, Etot = -41.150283084, dEtot = 8.424e-06, dEband = 1.322e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0665566921249, which took 0.056 ms

iter_count = 114, r_2norm = 1.785e-06, tol*||rhs|| = 2.662e-06

Anderson update took 67.399 ms, out of which F'*F took 31.242 ms; b-Ax took 212.522 ms, out of which Lap took 188.608 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.723 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662174, int_b + int_rho = 8.731e-14, checking this took 0.114 ms
2-norm of RHS = 717.4787071882283, which took 0.129 ms

iter_count = 174, r_2norm = 7.084e-04, tol*||rhs|| = 7.175e-04

Anderson update took 103.853 ms, out of which F'*F took 47.700 ms; b-Ax took 327.315 ms, out of which Lap took 291.182 ms
Solving Poisson took 719.488 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.301 ms
Total time for convolution: 	 convolve: 5.079387 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.079498 
Total time for convolution: 	 convolve: 5.078144 
Total time for convolution: 	 convolve: 5.086601 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.396 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 1.622 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.558 ms

This SCF took 27794.839 ms, scf error = 3.980e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.136260, lowerbound = -0.910515, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1980.150 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.979 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.435 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.448 ms
rank =  0, finding HY took 32.365 ms
rank =  0, distributing HY into block cyclic form took 20.594 ms
rank =  0, finding Y'*HY took 5.875 ms
Rank 0, Project_Hamiltonian used 84.326 ms
Total time for projection: 84.342 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.111 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.173 ms
    first calculated eigval = -0.909957173450315
    last  calculated eigval = 0.035838066869442
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54373228594787
lambda[   5] =  -0.51417001250077
lambda[   6] =  -0.44364890621373
lambda[   7] =  -0.42591873741106
lambda[   8] =  -0.38385491418484
lambda[   9] =  -0.34904123653897
lambda[  10] =  -0.31825736328224
lambda[  11] =  -0.25324345475239
lambda[  12] =  -0.25214318270685
lambda[  13] =  -0.22252692624667
lambda[  14] =  -0.08311796238747
lambda[  15] =  -0.02092999650665
lambda[  16] =  -0.00072391960808
lambda[  17] =   0.02077218361911
lambda[  18] =   0.02707036301810
lambda[  19] =   0.02920340409652
lambda[  20] =   0.03583806686944
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 8.146 ms
rank =  0, Distributing orbital back into band + domain format took 20.718 ms
rank = 0, Subspace_Rotation used 28.885 ms

Total time for subspace rotation: 28.893 ms
rank = 0, Efermi =  -0.112026093948 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 5.358 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.012 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.265 ms
rank = 0, Calculating density took 2103.730 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.054 ms
rank = 0, D2D took 1.176 ms
rank = 0, Transfering density took 1.183 ms
Etot    =   -41.150363190434
Eband   =   -12.142056038797
E1      =    28.174455054171
E2      =   -11.195132192916
E3      =   -15.516197669585
Exc     =   -13.889264760515
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 8.901e-06, dEband = 1.533e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -41.150363190, dEtot = 8.901e-06, dEband = 1.533e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0503457164433, which took 0.059 ms

iter_count = 114, r_2norm = 1.221e-06, tol*||rhs|| = 2.014e-06

Anderson update took 67.111 ms, out of which F'*F took 31.462 ms; b-Ax took 213.675 ms, out of which Lap took 189.495 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.773 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662172, int_b + int_rho = 6.185e-14, checking this took 0.110 ms
2-norm of RHS = 717.4923494564817, which took 0.163 ms

iter_count = 168, r_2norm = 6.293e-04, tol*||rhs|| = 7.175e-04

Anderson update took 101.274 ms, out of which F'*F took 46.102 ms; b-Ax took 314.669 ms, out of which Lap took 279.883 ms
Solving Poisson took 694.142 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.079623 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.080484 
Total time for convolution: 	 convolve: 5.081761 
Total time for convolution: 	 convolve: 5.078898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.067 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.175 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
---Transfer Veff_loc: D2D took 1.615 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.876 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.525 ms

This SCF took 27803.102 ms, scf error = 2.724e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135838, lowerbound = -0.909957, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1974.123 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.961 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.525 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.525 ms
rank =  0, finding HY took 32.364 ms
rank =  0, distributing HY into block cyclic form took 20.713 ms
rank =  0, finding Y'*HY took 5.830 ms
Rank 0, Project_Hamiltonian used 84.470 ms
Total time for projection: 84.488 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.551 ms
    first calculated eigval = -0.909572551286251
    last  calculated eigval = 0.035921427629254
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54335100153750
lambda[   5] =  -0.51378784855265
lambda[   6] =  -0.44327729368924
lambda[   7] =  -0.42554704871127
lambda[   8] =  -0.38348590087693
lambda[   9] =  -0.34866545763507
lambda[  10] =  -0.31787527109198
lambda[  11] =  -0.25287691211511
lambda[  12] =  -0.25175969660744
lambda[  13] =  -0.22216791720633
lambda[  14] =  -0.08275043164317
lambda[  15] =  -0.01828257762719
lambda[  16] =  -0.00016252099165
lambda[  17] =   0.02356291254348
lambda[  18] =   0.02898800799862
lambda[  19] =   0.03066117357158
lambda[  20] =   0.03592142762925
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.572 ms
rank =  0, subspace rotation using ScaLAPACK took 8.192 ms
rank =  0, Distributing orbital back into band + domain format took 20.497 ms
rank = 0, Subspace_Rotation used 28.708 ms

Total time for subspace rotation: 28.716 ms
rank = 0, Efermi =  -0.111658563356 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 5.281 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.100 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.305 ms
rank = 0, Calculating density took 2097.739 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.995 ms
rank = 0, D2D took 1.168 ms
rank = 0, Transfering density took 1.178 ms
Etot    =   -41.150425463849
Eband   =   -12.132283831108
E1      =    28.169885631315
E2      =   -11.189753169239
E3      =   -15.516753914362
Exc     =   -13.889707039864
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 6.919e-06, dEband = 1.086e-03
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -41.150425464, dEtot = 6.919e-06, dEband = 1.086e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0319660626971, which took 0.057 ms

iter_count = 114, r_2norm = 8.475e-07, tol*||rhs|| = 1.279e-06

Anderson update took 66.955 ms, out of which F'*F took 31.444 ms; b-Ax took 212.796 ms, out of which Lap took 188.598 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.912 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662162, int_b + int_rho = -3.638e-14, checking this took 0.115 ms
2-norm of RHS = 717.4966540605094, which took 0.171 ms

iter_count = 150, r_2norm = 6.515e-04, tol*||rhs|| = 7.175e-04

Anderson update took 87.583 ms, out of which F'*F took 41.494 ms; b-Ax took 282.322 ms, out of which Lap took 250.907 ms
Solving Poisson took 618.471 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.080667 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.076617 
Total time for convolution: 	 convolve: 6.479416 
Total time for convolution: 	 convolve: 5.080247 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.419 ms
---Transfer Veff_loc: D2D took 1.715 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.890 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.637 ms

This SCF took 28896.321 ms, scf error = 1.974e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135921, lowerbound = -0.909573, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1976.122 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 21.121 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.011 ms
rank =  0, Distribute data + matrix mult took 25.592 ms
rank =  0, finding HY took 32.300 ms
rank =  0, distributing HY into block cyclic form took 20.793 ms
rank =  0, finding Y'*HY took 5.383 ms
Rank 0, Project_Hamiltonian used 84.840 ms
Total time for projection: 84.860 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.182 ms
    first calculated eigval = -0.909445598189097
    last  calculated eigval = 0.036534227842604
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54319250464603
lambda[   5] =  -0.51362975130065
lambda[   6] =  -0.44312466905915
lambda[   7] =  -0.42538991408705
lambda[   8] =  -0.38333519745434
lambda[   9] =  -0.34851481312382
lambda[  10] =  -0.31771857805078
lambda[  11] =  -0.25271547712502
lambda[  12] =  -0.25161415644892
lambda[  13] =  -0.22201272122594
lambda[  14] =  -0.08261308866505
lambda[  15] =  -0.01712484900909
lambda[  16] =  -0.00001297847225
lambda[  17] =   0.02474822763378
lambda[  18] =   0.02974391099948
lambda[  19] =   0.03086910312241
lambda[  20] =   0.03653422784260
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.198 ms
rank =  0, subspace rotation using ScaLAPACK took 7.584 ms
rank =  0, Distributing orbital back into band + domain format took 21.120 ms
rank = 0, Subspace_Rotation used 28.723 ms

Total time for subspace rotation: 28.729 ms
rank = 0, Efermi =  -0.111521220375 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.160 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.224 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.305 ms
rank = 0, Calculating density took 2099.741 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.005 ms
rank = 0, D2D took 1.178 ms
rank = 0, Transfering density took 1.185 ms
Etot    =   -41.150470006127
Eband   =   -12.128351192243
E1      =    28.168162318397
E2      =   -11.187494772435
E3      =   -15.516810228468
Exc     =   -13.889758825390
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 4.949e-06, dEband = 4.370e-04
rank = 0, Calculating/Estimating energy took 1.001 ms, Etot = -41.150470006, dEtot = 4.949e-06, dEband = 4.370e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0289712933753, which took 0.060 ms

iter_count = 114, r_2norm = 8.267e-07, tol*||rhs|| = 1.159e-06

Anderson update took 66.582 ms, out of which F'*F took 31.121 ms; b-Ax took 213.973 ms, out of which Lap took 190.127 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 475.146 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662164, int_b + int_rho = -1.819e-14, checking this took 0.113 ms
2-norm of RHS = 717.4936943152182, which took 0.127 ms

iter_count = 102, r_2norm = 6.169e-04, tol*||rhs|| = 7.175e-04

Anderson update took 59.108 ms, out of which F'*F took 27.795 ms; b-Ax took 191.086 ms, out of which Lap took 169.773 ms
Solving Poisson took 421.083 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.096572 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.652 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.103715 
Total time for convolution: 	 convolve: 5.081847 
Total time for convolution: 	 convolve: 5.078349 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.886 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.635 ms

This SCF took 27348.578 ms, scf error = 1.712e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136534, lowerbound = -0.909446, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1981.433 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 21.020 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.944 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.014 ms
rank =  0, Distribute data + matrix mult took 25.006 ms
rank =  0, finding HY took 32.298 ms
rank =  0, distributing HY into block cyclic form took 20.684 ms
rank =  0, finding Y'*HY took 5.829 ms
Rank 0, Project_Hamiltonian used 83.858 ms
Total time for projection: 83.884 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.058 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.909381144625771
    last  calculated eigval = 0.036607383070062
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54313551677095
lambda[   5] =  -0.51357430726918
lambda[   6] =  -0.44306670420245
lambda[   7] =  -0.42533522201342
lambda[   8] =  -0.38327762285229
lambda[   9] =  -0.34845908345507
lambda[  10] =  -0.31766379072390
lambda[  11] =  -0.25265729855715
lambda[  12] =  -0.25155495974228
lambda[  13] =  -0.22195397988236
lambda[  14] =  -0.08256168365049
lambda[  15] =  -0.01682125776747
lambda[  16] =   0.00003007775727
lambda[  17] =   0.02496285085925
lambda[  18] =   0.02981295675908
lambda[  19] =   0.03078920151850
lambda[  20] =   0.03660738307006
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 7.608 ms
rank =  0, Distributing orbital back into band + domain format took 20.948 ms
rank = 0, Subspace_Rotation used 28.575 ms

Total time for subspace rotation: 28.581 ms
rank = 0, Efermi =  -0.111469815236 calculate fermi energy took 0.102 ms
rank = 0, --- Calculate rho: sum over local bands took 5.159 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.962 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.462 ms
rank = 0, Calculating density took 2104.403 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.015 ms
======D2D: initiated sending and receiving took 1.014 ms
rank = 0, D2D took 1.187 ms
rank = 0, Transfering density took 1.196 ms
Etot    =   -41.150473959506
Eband   =   -12.126837756951
E1      =    28.167253908939
E2      =   -11.186862215691
E3      =   -15.516947523735
Exc     =   -13.889872543126
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 4.393e-07, dEband = 1.682e-04
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -41.150473960, dEtot = 4.393e-07, dEband = 1.682e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0264167876744, which took 0.052 ms

iter_count = 108, r_2norm = 9.819e-07, tol*||rhs|| = 1.057e-06

Anderson update took 63.941 ms, out of which F'*F took 29.634 ms; b-Ax took 201.397 ms, out of which Lap took 178.429 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 451.407 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662172, int_b + int_rho = 6.185e-14, checking this took 0.137 ms
2-norm of RHS = 717.4929691523866, which took 0.148 ms

iter_count = 126, r_2norm = 6.945e-04, tol*||rhs|| = 7.175e-04

Anderson update took 73.080 ms, out of which F'*F took 34.711 ms; b-Ax took 237.289 ms, out of which Lap took 211.257 ms
Solving Poisson took 519.935 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.087013 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.356 ms
Total time for convolution: 	 convolve: 5.085005 
Total time for convolution: 	 convolve: 5.083973 
Total time for convolution: 	 convolve: 5.091526 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.131 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 1.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.453 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.909 ms

This SCF took 27436.416 ms, scf error = 1.417e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136607, lowerbound = -0.909381, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1979.607 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 22.198 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.368 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.017 ms
rank =  0, Distribute data + matrix mult took 26.606 ms
rank =  0, finding HY took 32.381 ms
rank =  0, distributing HY into block cyclic form took 20.697 ms
rank =  0, finding Y'*HY took 5.763 ms
Rank 0, Project_Hamiltonian used 85.487 ms
Total time for projection: 85.504 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.909227434548480
    last  calculated eigval = 0.037678481070968
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54299785043582
lambda[   5] =  -0.51343899899703
lambda[   6] =  -0.44292819895067
lambda[   7] =  -0.42520063459942
lambda[   8] =  -0.38314210384762
lambda[   9] =  -0.34832263597896
lambda[  10] =  -0.31752474645290
lambda[  11] =  -0.25252321911914
lambda[  12] =  -0.25141283311938
lambda[  13] =  -0.22181871711655
lambda[  14] =  -0.08243012624545
lambda[  15] =  -0.01568405374150
lambda[  16] =   0.00018709980698
lambda[  17] =   0.02576963664876
lambda[  18] =   0.03051321502495
lambda[  19] =   0.03146376223330
lambda[  20] =   0.03767848107097
==subpsace eigenproblem: bcast eigvals took 0.038 ms
Total time for solving subspace eigenvalue problem: 0.230 ms
rank =  0, subspace rotation using ScaLAPACK took 7.610 ms
rank =  0, Distributing orbital back into band + domain format took 20.979 ms
rank = 0, Subspace_Rotation used 28.605 ms

Total time for subspace rotation: 28.611 ms
rank = 0, Efermi =  -0.111338257960 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.232 ms
rank = 0, --- Calculate rho: reduce over all band groups took 4.117 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.535 ms
rank = 0, Calculating density took 2103.970 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.047 ms
rank = 0, D2D took 1.217 ms
rank = 0, Transfering density took 1.220 ms
Etot    =   -41.150495565159
Eband   =   -12.123219551731
E1      =    28.165487613564
E2      =   -11.184965264538
E3      =   -15.517053040760
Exc     =   -13.889954624497
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 2.401e-06, dEband = 4.020e-04
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -41.150495565, dEtot = 2.401e-06, dEband = 4.020e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0202507708825, which took 0.090 ms

iter_count = 114, r_2norm = 5.032e-07, tol*||rhs|| = 8.100e-07

Anderson update took 66.319 ms, out of which F'*F took 31.317 ms; b-Ax took 213.405 ms, out of which Lap took 189.292 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 474.402 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662168, int_b + int_rho = 2.547e-14, checking this took 0.137 ms
2-norm of RHS = 717.4910183065723, which took 0.079 ms

iter_count = 120, r_2norm = 6.381e-04, tol*||rhs|| = 7.175e-04

Anderson update took 70.126 ms, out of which F'*F took 33.170 ms; b-Ax took 224.899 ms, out of which Lap took 200.358 ms
Solving Poisson took 493.943 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
Total time for convolution: 	 convolve: 5.099541 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
Total time for convolution: 	 convolve: 5.143137 
Total time for convolution: 	 convolve: 5.088433 
Total time for convolution: 	 convolve: 5.085490 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.095 ms
---Transfer Veff_loc: D2D took 2.911 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.875 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 3.824 ms

This SCF took 27511.561 ms, scf error = 1.183e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137678, lowerbound = -0.909227, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1985.002 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 20.989 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.388 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.412 ms
rank =  0, finding HY took 32.559 ms
rank =  0, distributing HY into block cyclic form took 23.113 ms
rank =  0, finding Y'*HY took 4.910 ms
Rank 0, Project_Hamiltonian used 86.031 ms
Total time for projection: 86.049 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.909194696057461
    last  calculated eigval = 0.038239078321994
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54296943964660
lambda[   5] =  -0.51341102633381
lambda[   6] =  -0.44290114267501
lambda[   7] =  -0.42517045366047
lambda[   8] =  -0.38311390716157
lambda[   9] =  -0.34829358045987
lambda[  10] =  -0.31749479951597
lambda[  11] =  -0.25249968328821
lambda[  12] =  -0.25138437562641
lambda[  13] =  -0.22179506565512
lambda[  14] =  -0.08241015801717
lambda[  15] =  -0.01583128689084
lambda[  16] =   0.00012765884075
lambda[  17] =   0.02521917095451
lambda[  18] =   0.03007412607942
lambda[  19] =   0.03084676041078
lambda[  20] =   0.03823907832199
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 8.267 ms
rank =  0, Distributing orbital back into band + domain format took 20.237 ms
rank = 0, Subspace_Rotation used 28.524 ms

Total time for subspace rotation: 28.530 ms
rank = 0, Efermi =  -0.111318289649 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.336 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.937 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.415 ms
rank = 0, Calculating density took 2109.622 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.016 ms
rank = 0, D2D took 1.190 ms
rank = 0, Transfering density took 1.199 ms
Etot    =   -41.150500823800
Eband   =   -12.122483555920
E1      =    28.165116006869
E2      =   -11.184608716120
E3      =   -15.517011027155
Exc     =   -13.889925710231
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 5.843e-07, dEband = 8.178e-05
rank = 0, Calculating/Estimating energy took 1.034 ms, Etot = -41.150500824, dEtot = 5.843e-07, dEband = 8.178e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0159753771915, which took 1.085 ms

iter_count = 114, r_2norm = 4.354e-07, tol*||rhs|| = 6.390e-07

Anderson update took 70.425 ms, out of which F'*F took 31.161 ms; b-Ax took 211.884 ms, out of which Lap took 188.264 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 479.968 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662174, int_b + int_rho = 8.731e-14, checking this took 0.115 ms
2-norm of RHS = 717.4892163247982, which took 0.141 ms

iter_count = 120, r_2norm = 6.449e-04, tol*||rhs|| = 7.175e-04

Anderson update took 69.650 ms, out of which F'*F took 33.021 ms; b-Ax took 225.649 ms, out of which Lap took 200.623 ms
Solving Poisson took 493.605 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.312 ms
Total time for convolution: 	 convolve: 5.153903 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 15.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
Total time for convolution: 	 convolve: 5.152900 
Total time for convolution: 	 convolve: 5.139914 
Total time for convolution: 	 convolve: 5.148603 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.208 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.763 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
---Transfer Veff_loc: D2D took 1.726 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.885 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.646 ms

This SCF took 27716.382 ms, scf error = 1.049e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.138239, lowerbound = -0.909195, upperbound = 267.582477

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1971.092 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.859 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 25.333 ms
rank =  0, finding HY took 32.384 ms
rank =  0, distributing HY into block cyclic form took 20.561 ms
rank =  0, finding Y'*HY took 5.890 ms
Rank 0, Project_Hamiltonian used 84.211 ms
Total time for projection: 84.228 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.103 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.163 ms
    first calculated eigval = -0.909178992529587
    last  calculated eigval = 0.039006479588524
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54295763669740
lambda[   5] =  -0.51339906978861
lambda[   6] =  -0.44289025701771
lambda[   7] =  -0.42515370043527
lambda[   8] =  -0.38310103208882
lambda[   9] =  -0.34828105179568
lambda[  10] =  -0.31748135754537
lambda[  11] =  -0.25249531161160
lambda[  12] =  -0.25137417567737
lambda[  13] =  -0.22179246096522
lambda[  14] =  -0.08240552950656
lambda[  15] =  -0.01578947196071
lambda[  16] =   0.00007668469266
lambda[  17] =   0.02490422558645
lambda[  18] =   0.02982353046453
lambda[  19] =   0.03030387483302
lambda[  20] =   0.03900647958852
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 8.307 ms
rank =  0, Distributing orbital back into band + domain format took 20.360 ms
rank = 0, Subspace_Rotation used 28.685 ms

Total time for subspace rotation: 28.692 ms
rank = 0, Efermi =  -0.111313661159 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 5.267 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.867 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.332 ms
rank = 0, Calculating density took 2093.814 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.994 ms
rank = 0, D2D took 1.180 ms
rank = 0, Transfering density took 1.183 ms
Etot    =   -41.150507176510
Eband   =   -12.122183873639
E1      =    28.164902074653
E2      =   -11.184530848950
E3      =   -15.516974283258
Exc     =   -13.889903201939
Esc     =   -70.004827307000
Entropy =    -0.000000000793
dE = 7.059e-07, dEband = 3.330e-05
rank = 0, Calculating/Estimating energy took 1.427 ms, Etot = -41.150507177, dEtot = 7.059e-07, dEband = 3.330e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0141108561521, which took 0.055 ms

iter_count = 114, r_2norm = 4.049e-07, tol*||rhs|| = 5.644e-07

Anderson update took 66.717 ms, out of which F'*F took 31.400 ms; b-Ax took 216.616 ms, out of which Lap took 192.722 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 477.986 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002662166, int_rho =  26.00000002662172, int_b + int_rho = 6.548e-14, checking this took 0.113 ms
2-norm of RHS = 717.4902069066544, which took 0.135 ms

iter_count = 78, r_2norm = 7.147e-04, tol*||rhs|| = 7.175e-04

Anderson update took 45.859 ms, out of which F'*F took 21.681 ms; b-Ax took 147.231 ms, out of which Lap took 130.980 ms
Solving Poisson took 324.246 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.148451 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 7.457 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.163727 
Total time for convolution: 	 convolve: 5.143583 
Total time for convolution: 	 convolve: 5.147181 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.059 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.324 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 1.548 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.433 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.003 ms

This SCF took 27512.102 ms, scf error = 9.036e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.54295763669740, occ[   4] =   2.00000000000000
lambda[   5] =  -0.51339906978861, occ[   5] =   2.00000000000000
lambda[   6] =  -0.44289025701771, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42515370043527, occ[   7] =   2.00000000000000
lambda[   8] =  -0.38310103208882, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34828105179568, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31748135754537, occ[  10] =   2.00000000000000
lambda[  11] =  -0.25249531161160, occ[  11] =   2.00000000000000
lambda[  12] =  -0.25137417567737, occ[  12] =   2.00000000000000
lambda[  13] =  -0.22179246096522, occ[  13] =   2.00000000000000
lambda[  14] =  -0.08240552950656, occ[  14] =   0.00000002662170
lambda[  15] =  -0.01578947196071, occ[  15] =   0.00000000000000
lambda[  16] =   0.00007668469266, occ[  16] =   0.00000000000000
lambda[  17] =   0.02490422558645, occ[  17] =   0.00000000000000
lambda[  18] =   0.02982353046453, occ[  18] =   0.00000000000000
lambda[  19] =   0.03030387483302, occ[  19] =   0.00000000000000
lambda[  20] =   0.03900647958852, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.689 ms, time for Allreduce/Reduce: 12.799 ms 
Time for calculating local force components: 26.600 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00336620023567  -0.05376685565419   0.00000001284596
 -0.01880964885848   0.02258486200820  -0.04031851988878
 -0.01880964978293   0.02258485949566   0.04031851423083
  0.03326976460154   0.04127551259121  -0.00000000730653
 -0.01963125739434  -0.07367568998594  -0.00000019151295
  0.00839508410940   0.05759674892598  -0.00000008272787
 -0.01770394150383   0.06759990117169   0.00000009657741
  0.79788988322816  -0.34648573369641  -0.00000003485025
 -0.82321809797799  -0.26629572306188   0.00000048381998
force_loc = 
 -0.00374515096722   0.05821863175263   0.00000000529319
  0.02108536909861  -0.02528322954057   0.04264423106926
  0.02108548546675  -0.02528338084914  -0.04264415618804
 -0.03580404928670  -0.04474508819340   0.00000002032476
  0.00950034401068   0.07384276623849  -0.00000054339477
 -0.01270478148716  -0.04894555815250   0.00000021233502
  0.02158042508228  -0.07408303130036  -0.00000024527223
 -0.77577762392010   0.34507000265173  -0.00000035848720
  0.80725244124861   0.25334718924603   0.00000111629518
Time for calculating nonlocal force components: 49.459 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00667236123775  -0.00125565783849  -0.00000002122914
[0m[32m -0.00082893055656  -0.00243567803456   0.00000000968349
[0m[32m -0.00126954778179   0.00442378319929  -0.00000002542875
[0m[32m -0.02001627411304   0.00509555484829  -0.00000002087838
[0m[32m  0.01823574968282   0.01068060372596   0.00000005399837
[0mTime for calculating XC forces components: 33.841 ms
 Cartesian force = 
 -0.00038052343957   0.00444457725980  -0.00000004289513
  0.00227414753212  -0.00270556637101   0.00232565014619
  0.00227426297580  -0.00270572019211  -0.00232570299149
 -0.00253585739318  -0.00347677444083  -0.00000004801606
 -0.00346012485393  -0.00109578042458  -0.00000081717115
 -0.00514020064233   0.00620831390029   0.00000007825636
  0.00260536308864  -0.00206654576802  -0.00000023515786
  0.00209441248701   0.00367262496498  -0.00000047525011
  0.00226852024543  -0.00227512892853   0.00000159307925
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.376 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Time for printing density: 390.270 ms
The program took 537.567 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:44
Job ID:        2266749
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:49:12,vmem=8372K,walltime=00:09:06,mem=8148K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-014-35-1
---------------------------------------
