---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:41
Job ID:    2266855
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:27:46
Job ID:    2266855
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.005 ms
Reading input file sprc-calc.inpt

Reading input file took 0.961 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 7.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 0.767 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 62.503 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.997 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.099 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.105728	   11.662075	   10.000000	
    7.788940	    7.778221	   10.000000	
   12.863730	   12.221779	   10.000000	
   11.901432	    9.433394	   11.681159	
   11.901432	    9.433394	    8.318841	
   11.600909	   10.596532	   10.000000	
    7.136270	    9.918165	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.198 ms
Set up communicators.

--set up spincomm took 1.179 ms

--set up kptcomm took 0.345 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.004 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.055 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.387 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.307 ms

Calculate_SplineDerivRadFun took 0.299 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.800 ms.
time spent on vectorized spline interp: 3.147 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.692 ms.
time spent on vectorized spline interp: 1.392 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.285 ms.
time spent on vectorized spline interp: 1.673 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.545 ms.
time spent on vectorized spline interp: 1.570 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.524 ms.

Calculating rb for all atom types took 20.641 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.058 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.016 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000226011, sum_int_rho = 23.6982853200492
PosCharge = 24.000000022601, NegCharge = -23.698285320049, scal_fac = 1.012731499283
After scaling, int_rho = 24.0000000226010, PosCharge + NegCharge - NetCharge = 1.599e-13
--Calculate Vref took 0.485 ms
--Calculate rho_guess took 2.775 ms

 integral of b = -24.0000000226011,
 int{b} + Nelectron + NetCharge = -2.260e-08,
 Esc = -79.3117500222765,
 MPI_Reduce took 4.997 ms

Calculating b & b_ref took 14.995 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.063 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.130 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.102 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.595 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.004 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.408 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260106, int_b + int_rho = -2.401e-13, checking this took 0.546 ms
2-norm of RHS = 674.4525823423556, which took 0.485 ms

iter_count = 420, r_2norm = 5.682e-04, tol*||rhs|| = 6.745e-04

Anderson update took 231.203 ms, out of which F'*F took 105.342 ms; b-Ax took 710.708 ms, out of which Lap took 637.622 ms
Solving Poisson took 1515.027 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.825 ms
Total time for convolution: 	 convolve: 5.120123 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.379 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
Total time for convolution: 	 convolve: 5.117177 
Total time for convolution: 	 convolve: 5.118435 
Total time for convolution: 	 convolve: 5.105428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.719 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.530 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.432 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
rank = 0, XC calculation took 24381.388 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 5.584 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.899 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.619 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.152 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.668 ms
    Lanczos iter 53, eigmin  = -1.109309312, eigmax = 264.929992749, err_eigmin = 9.750e-04, err_eigmax = 9.704e-03
rank =   0, Lanczos took 119.930 ms, eigmin = -1.109309312008, eigmax = 267.579292676952

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.184992, lowerbound = -1.209309, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1380.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 66.920 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 69.649 ms
rank =  0, finding HY took 24.457 ms
rank =  0, distributing HY into block cyclic form took 19.759 ms
rank =  0, finding Y'*HY took 3.993 ms
Rank 0, Project_Hamiltonian used 117.896 ms
Total time for projection: 117.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.791 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.892 ms
    first calculated eigval = 2.746927844585657
    last  calculated eigval = 3.251301724447846
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.81484787138462
lambda[   4] =   2.83765821075096
lambda[   5] =   2.87591446136917
lambda[   6] =   2.90515872733797
lambda[   7] =   2.92723839824786
lambda[   8] =   2.95198488091868
lambda[   9] =   2.99036857002153
lambda[  10] =   3.01556891241518
lambda[  11] =   3.02503907156354
lambda[  12] =   3.03286603044549
lambda[  13] =   3.07593369860658
lambda[  14] =   3.10816438414624
lambda[  15] =   3.14187852382194
lambda[  16] =   3.15247368849636
lambda[  17] =   3.18539069753170
lambda[  18] =   3.21107639262342
lambda[  19] =   3.25130172444785
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.908 ms
rank =  0, subspace rotation using ScaLAPACK took 7.358 ms
rank =  0, Distributing orbital back into band + domain format took 16.801 ms
rank = 0, Subspace_Rotation used 24.176 ms

Total time for subspace rotation: 24.179 ms
rank = 0, Efermi =   3.054400537985 calculate fermi energy took 0.055 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351302, lowerbound = -1.209309, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1422.813 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 16.872 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.522 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.410 ms
rank =  0, finding HY took 23.800 ms
rank =  0, distributing HY into block cyclic form took 17.066 ms
rank =  0, finding Y'*HY took 3.615 ms
Rank 0, Project_Hamiltonian used 63.919 ms
Total time for projection: 63.925 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.248 ms
rank = 0, Solve_Generalized_EigenProblem used 0.730 ms
    first calculated eigval = -0.953184826801120
    last  calculated eigval = 0.457352898665190
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.45720021946711
lambda[   4] =  -0.23829149198579
lambda[   5] =  -0.16479608545721
lambda[   6] =  -0.04641370302155
lambda[   7] =   0.01241639257360
lambda[   8] =   0.02789889498220
lambda[   9] =   0.06555367121534
lambda[  10] =   0.15691524722901
lambda[  11] =   0.27136415123211
lambda[  12] =   0.28574765682656
lambda[  13] =   0.30324864369863
lambda[  14] =   0.31146429619428
lambda[  15] =   0.34414364065771
lambda[  16] =   0.39057398148269
lambda[  17] =   0.40812670731846
lambda[  18] =   0.42408344497461
lambda[  19] =   0.45735289866519
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.749 ms
rank =  0, subspace rotation using ScaLAPACK took 7.417 ms
rank =  0, Distributing orbital back into band + domain format took 16.751 ms
rank = 0, Subspace_Rotation used 24.800 ms

Total time for subspace rotation: 24.805 ms
rank = 0, Efermi =   0.294483674489 calculate fermi energy took 0.046 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.557353, lowerbound = -1.209309, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1433.848 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 16.883 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.520 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.418 ms
rank =  0, finding HY took 23.960 ms
rank =  0, distributing HY into block cyclic form took 16.953 ms
rank =  0, finding Y'*HY took 3.609 ms
Rank 0, Project_Hamiltonian used 63.975 ms
Total time for projection: 63.988 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.121805202513859
    last  calculated eigval = 0.166887977411086
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.76973230498261
lambda[   4] =  -0.62365468533791
lambda[   5] =  -0.53721550754916
lambda[   6] =  -0.51524834377282
lambda[   7] =  -0.50652049303068
lambda[   8] =  -0.42495019838614
lambda[   9] =  -0.42048821701422
lambda[  10] =  -0.36384568767431
lambda[  11] =  -0.28548594397298
lambda[  12] =  -0.21482889284017
lambda[  13] =  -0.00865479795756
lambda[  14] =   0.05238689494294
lambda[  15] =   0.06699592195955
lambda[  16] =   0.09607984675786
lambda[  17] =   0.10459274139544
lambda[  18] =   0.12268695685827
lambda[  19] =   0.16688797741109
==subpsace eigenproblem: bcast eigvals took 0.060 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 7.393 ms
rank =  0, Distributing orbital back into band + domain format took 16.609 ms
rank = 0, Subspace_Rotation used 24.018 ms

Total time for subspace rotation: 24.022 ms
rank = 0, Efermi =  -0.037711026276 calculate fermi energy took 0.042 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.266888, lowerbound = -1.209309, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1422.098 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 16.927 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.507 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 19.449 ms
rank =  0, finding HY took 23.822 ms
rank =  0, distributing HY into block cyclic form took 18.070 ms
rank =  0, finding Y'*HY took 3.433 ms
Rank 0, Project_Hamiltonian used 65.200 ms
Total time for projection: 65.212 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.154 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.249 ms
    first calculated eigval = -1.121986993897648
    last  calculated eigval = 0.104716815310837
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.77220312319804
lambda[   4] =  -0.63045253779908
lambda[   5] =  -0.54535059244834
lambda[   6] =  -0.52530456955169
lambda[   7] =  -0.51375643510032
lambda[   8] =  -0.43763624678061
lambda[   9] =  -0.43326235261990
lambda[  10] =  -0.37545088657869
lambda[  11] =  -0.32640182563135
lambda[  12] =  -0.26039085800423
lambda[  13] =  -0.09631489084337
lambda[  14] =  -0.00301543373550
lambda[  15] =   0.01394785594328
lambda[  16] =   0.04471285457675
lambda[  17] =   0.05421844998687
lambda[  18] =   0.06856825856829
lambda[  19] =   0.10471681531084
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 7.349 ms
rank =  0, Distributing orbital back into band + domain format took 16.788 ms
rank = 0, Subspace_Rotation used 24.152 ms

Total time for subspace rotation: 24.156 ms
rank = 0, Efermi =  -0.125371119044 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.192 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.513 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.605 ms
rank = 0, Calculating density took 6208.189 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.831 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.940 ms
Etot    =   -51.241251334512
Eband   =   -13.885021458688
E1      =    27.747636265462
E2      =   -12.563566000568
E3      =   -15.772958361576
Exc     =   -14.128640480478
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 7.320e+00, dEband = 1.984e+00
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -51.241251335, dEtot = 7.320e+00, dEband = 1.984e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 70.3758971708052, which took 0.890 ms

iter_count = 90, r_2norm = 2.359e-03, tol*||rhs|| = 2.815e-03

Anderson update took 48.463 ms, out of which F'*F took 22.536 ms; b-Ax took 157.353 ms, out of which Lap took 141.844 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 334.373 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260104, int_b + int_rho = -2.656e-13, checking this took 0.131 ms
2-norm of RHS = 671.8443842739122, which took 0.219 ms

iter_count = 282, r_2norm = 6.331e-04, tol*||rhs|| = 6.718e-04

Anderson update took 152.262 ms, out of which F'*F took 69.980 ms; b-Ax took 473.402 ms, out of which Lap took 424.253 ms
Solving Poisson took 1012.142 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.366 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.150499 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 55.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.263229 
Total time for convolution: 	 convolve: 5.155647 
Total time for convolution: 	 convolve: 5.145578 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.198 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.049 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.154 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.500 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.760 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.301 ms

This SCF took 32375.068 ms, scf error = 1.460e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.204717, lowerbound = -1.121987, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1372.448 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 69.424 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.537 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 71.980 ms
rank =  0, finding HY took 23.675 ms
rank =  0, distributing HY into block cyclic form took 18.984 ms
rank =  0, finding Y'*HY took 3.561 ms
Rank 0, Project_Hamiltonian used 118.236 ms
Total time for projection: 118.253 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.140 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -1.127036259946658
    last  calculated eigval = 0.079558822597910
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.74702354171538
lambda[   4] =  -0.61418117689673
lambda[   5] =  -0.52671201631891
lambda[   6] =  -0.49903681596640
lambda[   7] =  -0.49246847696884
lambda[   8] =  -0.43066182170535
lambda[   9] =  -0.42367923878290
lambda[  10] =  -0.36287985360365
lambda[  11] =  -0.31329576885076
lambda[  12] =  -0.25252211391556
lambda[  13] =  -0.11482571147573
lambda[  14] =  -0.02292145197817
lambda[  15] =   0.00438719231855
lambda[  16] =   0.02949444828561
lambda[  17] =   0.03539957281970
lambda[  18] =   0.04852342853447
lambda[  19] =   0.07955882259791
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.252 ms
rank =  0, subspace rotation using ScaLAPACK took 6.891 ms
rank =  0, Distributing orbital back into band + domain format took 16.957 ms
rank = 0, Subspace_Rotation used 23.865 ms

Total time for subspace rotation: 23.869 ms
rank = 0, Efermi =  -0.143881939845 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 5.400 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.152 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1531.543 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.878 ms
rank = 0, D2D took 1.981 ms
rank = 0, Transfering density took 1.987 ms
Etot    =   -51.193360011156
Eband   =   -13.561014523568
E1      =    27.450110960627
E2      =   -12.560684058133
E3      =   -15.892283334924
Exc     =   -14.223673818319
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 6.842e-03, dEband = 4.629e-02
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -51.193360011, dEtot = 6.842e-03, dEband = 4.629e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 31.0885129572581, which took 0.100 ms

iter_count = 96, r_2norm = 9.161e-04, tol*||rhs|| = 1.244e-03

Anderson update took 51.183 ms, out of which F'*F took 23.672 ms; b-Ax took 161.221 ms, out of which Lap took 143.813 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.268 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260101, int_b + int_rho = -2.947e-13, checking this took 0.125 ms
2-norm of RHS = 669.4313411221485, which took 0.150 ms

iter_count = 288, r_2norm = 6.647e-04, tol*||rhs|| = 6.694e-04

Anderson update took 154.175 ms, out of which F'*F took 71.977 ms; b-Ax took 485.454 ms, out of which Lap took 435.175 ms
Solving Poisson took 1033.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.155505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 71.694 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.156226 
Total time for convolution: 	 convolve: 5.161956 
Total time for convolution: 	 convolve: 5.153511 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.311 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.380 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.509 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 4.750 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.660 ms

This SCF took 27676.601 ms, scf error = 9.458e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.179559, lowerbound = -1.127036, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1368.972 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 55.920 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.865 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 58.803 ms
rank =  0, finding HY took 24.754 ms
rank =  0, distributing HY into block cyclic form took 17.133 ms
rank =  0, finding Y'*HY took 3.724 ms
Rank 0, Project_Hamiltonian used 104.446 ms
Total time for projection: 104.463 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.213 ms
    first calculated eigval = -1.135307764550355
    last  calculated eigval = 0.068733899172420
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.71578309376383
lambda[   4] =  -0.58599904661643
lambda[   5] =  -0.51089743200296
lambda[   6] =  -0.47630526670456
lambda[   7] =  -0.46813123563125
lambda[   8] =  -0.41604591200867
lambda[   9] =  -0.39771513083380
lambda[  10] =  -0.34112153405078
lambda[  11] =  -0.29678768916683
lambda[  12] =  -0.24322974849579
lambda[  13] =  -0.11916907672057
lambda[  14] =  -0.02722655646975
lambda[  15] =   0.00836869443537
lambda[  16] =   0.02211410387983
lambda[  17] =   0.03007102315052
lambda[  18] =   0.04047480896664
lambda[  19] =   0.06873389917242
==subpsace eigenproblem: bcast eigvals took 0.017 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 6.931 ms
rank =  0, Distributing orbital back into band + domain format took 16.891 ms
rank = 0, Subspace_Rotation used 23.840 ms

Total time for subspace rotation: 23.845 ms
rank = 0, Efermi =  -0.148225304999 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 5.433 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.163 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.569 ms
rank = 0, Calculating density took 1513.799 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.809 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.930 ms
Etot    =   -51.162476531745
Eband   =   -13.135438461363
E1      =    27.067138812623
E2      =   -12.512249048822
E3      =   -16.071762247402
Exc     =   -14.366438156275
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 4.412e-03, dEband = 6.080e-02
rank = 0, Calculating/Estimating energy took 0.925 ms, Etot = -51.162476532, dEtot = 4.412e-03, dEband = 6.080e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 10.3629995016214, which took 0.531 ms

iter_count = 96, r_2norm = 3.468e-04, tol*||rhs|| = 4.145e-04

Anderson update took 51.640 ms, out of which F'*F took 23.980 ms; b-Ax took 160.826 ms, out of which Lap took 144.594 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.392 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260101, int_b + int_rho = -2.947e-13, checking this took 0.105 ms
2-norm of RHS = 669.0869494876874, which took 0.067 ms

iter_count = 270, r_2norm = 6.402e-04, tol*||rhs|| = 6.691e-04

Anderson update took 144.844 ms, out of which F'*F took 67.639 ms; b-Ax took 456.131 ms, out of which Lap took 409.384 ms
Solving Poisson took 966.532 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.149409 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 73.144 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.144760 
Total time for convolution: 	 convolve: 5.161881 
Total time for convolution: 	 convolve: 5.161286 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.703 ms
---Transfer Veff_loc: D2D took 3.942 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 6.240 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 10.568 ms

This SCF took 27564.345 ms, scf error = 3.693e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.168734, lowerbound = -1.135308, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1369.302 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 55.306 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.562 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 57.885 ms
rank =  0, finding HY took 23.504 ms
rank =  0, distributing HY into block cyclic form took 16.974 ms
rank =  0, finding Y'*HY took 3.534 ms
Rank 0, Project_Hamiltonian used 101.923 ms
Total time for projection: 101.943 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.135165460951668
    last  calculated eigval = 0.060630497779507
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.70447048469221
lambda[   4] =  -0.57314925313826
lambda[   5] =  -0.50476708562242
lambda[   6] =  -0.47112276325322
lambda[   7] =  -0.45922905472275
lambda[   8] =  -0.40406737880481
lambda[   9] =  -0.38303723937758
lambda[  10] =  -0.33274083322475
lambda[  11] =  -0.29253626568772
lambda[  12] =  -0.23824069125310
lambda[  13] =  -0.11657368152138
lambda[  14] =  -0.02899570831658
lambda[  15] =   0.00848575463311
lambda[  16] =   0.01846869209341
lambda[  17] =   0.02529049938088
lambda[  18] =   0.03533219780513
lambda[  19] =   0.06063049777951
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 6.874 ms
rank =  0, Distributing orbital back into band + domain format took 16.883 ms
rank = 0, Subspace_Rotation used 23.771 ms

Total time for subspace rotation: 23.776 ms
rank = 0, Efermi =  -0.145629909782 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.337 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.255 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.595 ms
rank = 0, Calculating density took 1512.542 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.011 ms
rank = 0, D2D took 2.108 ms
rank = 0, Transfering density took 2.111 ms
Etot    =   -51.157334720504
Eband   =   -12.954523771909
E1      =    26.918411209114
E2      =   -12.466357271816
E3      =   -16.157937022821
Exc     =   -14.433766429392
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 7.345e-04, dEband = 2.584e-02
rank = 0, Calculating/Estimating energy took 0.921 ms, Etot = -51.157334721, dEtot = 7.345e-04, dEband = 2.584e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.2970068827493, which took 0.065 ms

iter_count = 102, r_2norm = 1.100e-04, tol*||rhs|| = 1.319e-04

Anderson update took 54.477 ms, out of which F'*F took 25.927 ms; b-Ax took 172.953 ms, out of which Lap took 155.609 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 373.705 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260086, int_b + int_rho = -4.475e-13, checking this took 0.110 ms
2-norm of RHS = 669.2989357985094, which took 0.152 ms

iter_count = 246, r_2norm = 6.500e-04, tol*||rhs|| = 6.693e-04

Anderson update took 131.676 ms, out of which F'*F took 61.312 ms; b-Ax took 429.914 ms, out of which Lap took 388.018 ms
Solving Poisson took 895.122 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.142886 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 81.919 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.148592 
Total time for convolution: 	 convolve: 5.156640 
Total time for convolution: 	 convolve: 5.156895 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.343 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.784 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.485 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.572 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.094 ms

This SCF took 27473.268 ms, scf error = 1.410e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.160630, lowerbound = -1.135165, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1372.508 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 60.658 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.570 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 63.246 ms
rank =  0, finding HY took 23.526 ms
rank =  0, distributing HY into block cyclic form took 16.964 ms
rank =  0, finding Y'*HY took 3.929 ms
Rank 0, Project_Hamiltonian used 107.697 ms
Total time for projection: 107.715 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 29.297 ms
rank = 0, Solve_Generalized_EigenProblem used 29.424 ms
    first calculated eigval = -1.132491353015532
    last  calculated eigval = 0.052743542154532
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.70092987961067
lambda[   4] =  -0.56895033214566
lambda[   5] =  -0.50174831526425
lambda[   6] =  -0.46867388978697
lambda[   7] =  -0.45579927853099
lambda[   8] =  -0.39980335156436
lambda[   9] =  -0.37794748806113
lambda[  10] =  -0.32986690681806
lambda[  11] =  -0.29040145436293
lambda[  12] =  -0.23523678070082
lambda[  13] =  -0.11424054496208
lambda[  14] =  -0.02966672491442
lambda[  15] =   0.00831076904732
lambda[  16] =   0.01677077169521
lambda[  17] =   0.02142267349288
lambda[  18] =   0.03220441587642
lambda[  19] =   0.05274354215453
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 29.442 ms
rank =  0, subspace rotation using ScaLAPACK took 6.885 ms
rank =  0, Distributing orbital back into band + domain format took 20.501 ms
rank = 0, Subspace_Rotation used 27.401 ms

Total time for subspace rotation: 27.407 ms
rank = 0, Efermi =  -0.143296773285 calculate fermi energy took 0.605 ms
rank = 0, --- Calculate rho: sum over local bands took 5.362 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.131 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 1553.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.852 ms
rank = 0, D2D took 1.955 ms
rank = 0, Transfering density took 1.962 ms
Etot    =   -51.156446514968
Eband   =   -12.877863865765
E1      =    26.870328099245
E2      =   -12.430745491296
E3      =   -16.189180500491
Exc     =   -14.457086717281
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 1.269e-04, dEband = 1.095e-02
rank = 0, Calculating/Estimating energy took 0.977 ms, Etot = -51.156446515, dEtot = 1.269e-04, dEband = 1.095e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9776232607108, which took 3.287 ms

iter_count = 108, r_2norm = 3.521e-05, tol*||rhs|| = 3.910e-05

Anderson update took 57.662 ms, out of which F'*F took 27.062 ms; b-Ax took 180.687 ms, out of which Lap took 162.363 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.314 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260104, int_b + int_rho = -2.656e-13, checking this took 0.112 ms
2-norm of RHS = 669.5857270148969, which took 0.155 ms

iter_count = 240, r_2norm = 5.720e-04, tol*||rhs|| = 6.696e-04

Anderson update took 129.086 ms, out of which F'*F took 61.117 ms; b-Ax took 405.953 ms, out of which Lap took 364.044 ms
Solving Poisson took 858.891 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.154523 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.847 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.152198 
Total time for convolution: 	 convolve: 5.142554 
Total time for convolution: 	 convolve: 5.141321 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.076 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.465 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.024 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.525 ms

This SCF took 27445.618 ms, scf error = 5.846e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.152744, lowerbound = -1.132491, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1366.278 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 59.363 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.522 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.903 ms
rank =  0, finding HY took 23.537 ms
rank =  0, distributing HY into block cyclic form took 16.962 ms
rank =  0, finding Y'*HY took 3.560 ms
Rank 0, Project_Hamiltonian used 105.993 ms
Total time for projection: 106.008 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.086 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.130541945129503
    last  calculated eigval = 0.045354615941836
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69855417754122
lambda[   4] =  -0.56663499346623
lambda[   5] =  -0.49987639142386
lambda[   6] =  -0.46696417374905
lambda[   7] =  -0.45366364173445
lambda[   8] =  -0.39746575746725
lambda[   9] =  -0.37543327808570
lambda[  10] =  -0.32771410989134
lambda[  11] =  -0.28815579947124
lambda[  12] =  -0.23353011573982
lambda[  13] =  -0.11299024359623
lambda[  14] =  -0.02951432113619
lambda[  15] =   0.00876487881583
lambda[  16] =   0.01629179017743
lambda[  17] =   0.01909742502946
lambda[  18] =   0.03053118268337
lambda[  19] =   0.04535461594184
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.232 ms
rank =  0, subspace rotation using ScaLAPACK took 6.881 ms
rank =  0, Distributing orbital back into band + domain format took 16.938 ms
rank = 0, Subspace_Rotation used 23.836 ms

Total time for subspace rotation: 23.840 ms
rank = 0, Efermi =  -0.142046471931 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 5.323 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.267 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.603 ms
rank = 0, Calculating density took 1512.671 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.485 ms
rank = 0, D2D took 2.581 ms
rank = 0, Transfering density took 2.589 ms
Etot    =   -51.156252654167
Eband   =   -12.826452805765
E1      =    26.845357617605
E2      =   -12.400522181346
E3      =   -16.202895861108
Exc     =   -14.466825485507
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 2.769e-05, dEband = 7.344e-03
rank = 0, Calculating/Estimating energy took 1.082 ms, Etot = -51.156252654, dEtot = 2.769e-05, dEband = 7.344e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5082510953541, which took 0.056 ms

iter_count = 108, r_2norm = 1.637e-05, tol*||rhs|| = 2.033e-05

Anderson update took 57.421 ms, out of which F'*F took 27.082 ms; b-Ax took 182.996 ms, out of which Lap took 164.079 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.733 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260105, int_b + int_rho = -2.583e-13, checking this took 0.108 ms
2-norm of RHS = 669.8440964778996, which took 0.110 ms

iter_count = 234, r_2norm = 5.909e-04, tol*||rhs|| = 6.698e-04

Anderson update took 124.888 ms, out of which F'*F took 58.481 ms; b-Ax took 395.996 ms, out of which Lap took 354.983 ms
Solving Poisson took 836.662 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.155364 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 68.771 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.140853 
Total time for convolution: 	 convolve: 5.138718 
Total time for convolution: 	 convolve: 5.146101 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.271 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.488 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.188 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.714 ms

This SCF took 27391.028 ms, scf error = 2.445e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.145355, lowerbound = -1.130542, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1368.399 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 59.020 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.506 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.544 ms
rank =  0, finding HY took 23.567 ms
rank =  0, distributing HY into block cyclic form took 16.834 ms
rank =  0, finding Y'*HY took 3.542 ms
Rank 0, Project_Hamiltonian used 105.517 ms
Total time for projection: 105.535 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.114 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.205 ms
    first calculated eigval = -1.129123856496168
    last  calculated eigval = 0.039602402332647
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69602673438265
lambda[   4] =  -0.56423851280069
lambda[   5] =  -0.49813880814426
lambda[   6] =  -0.46540996265116
lambda[   7] =  -0.45169755373851
lambda[   8] =  -0.39499281352662
lambda[   9] =  -0.37284767390547
lambda[  10] =  -0.32576209449090
lambda[  11] =  -0.28642538750598
lambda[  12] =  -0.23216475785147
lambda[  13] =  -0.11186568244245
lambda[  14] =  -0.02830761378523
lambda[  15] =   0.01015412071276
lambda[  16] =   0.01706912475974
lambda[  17] =   0.01862493090838
lambda[  18] =   0.03019717729439
lambda[  19] =   0.03960240233265
==subpsace eigenproblem: bcast eigvals took 0.045 ms
Total time for solving subspace eigenvalue problem: 0.259 ms
rank =  0, subspace rotation using ScaLAPACK took 6.879 ms
rank =  0, Distributing orbital back into band + domain format took 17.335 ms
rank = 0, Subspace_Rotation used 24.782 ms

Total time for subspace rotation: 24.787 ms
rank = 0, Efermi =  -0.140921910673 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 5.390 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.244 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.609 ms
rank = 0, Calculating density took 1515.399 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.853 ms
rank = 0, D2D took 1.955 ms
rank = 0, Transfering density took 1.961 ms
Etot    =   -51.156201938426
Eband   =   -12.779419000097
E1      =    26.822972811443
E2      =   -12.373531493755
E3      =   -16.210983526416
Exc     =   -14.472520746990
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 7.245e-06, dEband = 6.719e-03
rank = 0, Calculating/Estimating energy took 0.918 ms, Etot = -51.156201938, dEtot = 7.245e-06, dEband = 6.719e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2778440890106, which took 0.115 ms

iter_count = 108, r_2norm = 1.008e-05, tol*||rhs|| = 1.111e-05

Anderson update took 57.216 ms, out of which F'*F took 27.068 ms; b-Ax took 182.028 ms, out of which Lap took 163.253 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.280 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260100, int_b + int_rho = -3.092e-13, checking this took 0.120 ms
2-norm of RHS = 669.8847192568209, which took 0.132 ms

iter_count = 204, r_2norm = 5.536e-04, tol*||rhs|| = 6.699e-04

Anderson update took 108.152 ms, out of which F'*F took 50.921 ms; b-Ax took 343.843 ms, out of which Lap took 307.824 ms
Solving Poisson took 728.443 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.136828 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 58.903 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.145679 
Total time for convolution: 	 convolve: 5.133225 
Total time for convolution: 	 convolve: 5.133108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.220 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.399 ms
---Transfer Veff_loc: D2D took 3.485 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.010 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.529 ms

This SCF took 27241.948 ms, scf error = 1.080e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.139602, lowerbound = -1.129124, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1366.996 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 58.517 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.493 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.026 ms
rank =  0, finding HY took 23.594 ms
rank =  0, distributing HY into block cyclic form took 16.967 ms
rank =  0, finding Y'*HY took 3.579 ms
Rank 0, Project_Hamiltonian used 105.198 ms
Total time for projection: 105.216 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.128494376856730
    last  calculated eigval = 0.035352017977125
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69514065912359
lambda[   4] =  -0.56334950442112
lambda[   5] =  -0.49738722016081
lambda[   6] =  -0.46475186430596
lambda[   7] =  -0.45090281409067
lambda[   8] =  -0.39415646594172
lambda[   9] =  -0.37195067416647
lambda[  10] =  -0.32492568923082
lambda[  11] =  -0.28569431806946
lambda[  12] =  -0.23149042954754
lambda[  13] =  -0.11125270426255
lambda[  14] =  -0.02746287083322
lambda[  15] =   0.01098699799233
lambda[  16] =   0.01761982573127
lambda[  17] =   0.01850092248793
lambda[  18] =   0.03023838536168
lambda[  19] =   0.03535201797713
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.222 ms
rank =  0, subspace rotation using ScaLAPACK took 6.839 ms
rank =  0, Distributing orbital back into band + domain format took 17.278 ms
rank = 0, Subspace_Rotation used 24.132 ms

Total time for subspace rotation: 24.137 ms
rank = 0, Efermi =  -0.140308932612 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.311 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.354 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.629 ms
rank = 0, Calculating density took 1512.998 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.852 ms
rank = 0, D2D took 1.958 ms
rank = 0, Transfering density took 1.961 ms
Etot    =   -51.156213393108
Eband   =   -12.760769061300
E1      =    26.813485479704
E2      =   -12.363643013744
E3      =   -16.213605279329
Exc     =   -14.474428081632
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 1.636e-06, dEband = 2.664e-03
rank = 0, Calculating/Estimating energy took 0.933 ms, Etot = -51.156213393, dEtot = 1.636e-06, dEband = 2.664e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1112361043069, which took 0.060 ms

iter_count = 114, r_2norm = 2.992e-06, tol*||rhs|| = 4.449e-06

Anderson update took 60.771 ms, out of which F'*F took 28.590 ms; b-Ax took 193.182 ms, out of which Lap took 173.183 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.007 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260091, int_b + int_rho = -3.929e-13, checking this took 0.118 ms
2-norm of RHS = 669.9039447379968, which took 0.113 ms

iter_count = 210, r_2norm = 6.417e-04, tol*||rhs|| = 6.699e-04

Anderson update took 112.018 ms, out of which F'*F took 52.602 ms; b-Ax took 356.054 ms, out of which Lap took 319.036 ms
Solving Poisson took 751.323 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.140896 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.304 ms
Total time for convolution: 	 convolve: 5.300266 
Total time for convolution: 	 convolve: 5.139968 
Total time for convolution: 	 convolve: 5.181105 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.361 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.333 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.883 ms
---Transfer Veff_loc: D2D took 3.495 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.178 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.709 ms

This SCF took 27553.990 ms, scf error = 7.750e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.135352, lowerbound = -1.128494, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1358.571 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 62.625 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.571 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 65.211 ms
rank =  0, finding HY took 23.535 ms
rank =  0, distributing HY into block cyclic form took 17.044 ms
rank =  0, finding Y'*HY took 3.551 ms
Rank 0, Project_Hamiltonian used 109.369 ms
Total time for projection: 109.385 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.084 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -1.127408289190165
    last  calculated eigval = 0.033320992423262
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69391843182328
lambda[   4] =  -0.56207210114198
lambda[   5] =  -0.49617382053251
lambda[   6] =  -0.46369260764482
lambda[   7] =  -0.44969220526411
lambda[   8] =  -0.39299252756989
lambda[   9] =  -0.37069593899339
lambda[  10] =  -0.32366427779963
lambda[  11] =  -0.28455652370563
lambda[  12] =  -0.23032762744787
lambda[  13] =  -0.11017100431395
lambda[  14] =  -0.02516174720642
lambda[  15] =   0.01354706973093
lambda[  16] =   0.01961641069130
lambda[  17] =   0.02051171309722
lambda[  18] =   0.03144289098963
lambda[  19] =   0.03332099242326
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 6.876 ms
rank =  0, Distributing orbital back into band + domain format took 17.519 ms
rank = 0, Subspace_Rotation used 24.409 ms

Total time for subspace rotation: 24.414 ms
rank = 0, Efermi =  -0.139227232658 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 5.227 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.351 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.574 ms
rank = 0, Calculating density took 1508.904 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.804 ms
rank = 0, D2D took 1.895 ms
rank = 0, Transfering density took 1.897 ms
Etot    =   -51.156246071050
Eband   =   -12.732390935344
E1      =    26.799058744486
E2      =   -12.348833919901
E3      =   -16.216801418875
Exc     =   -14.476799196015
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 4.668e-06, dEband = 4.054e-03
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -51.156246071, dEtot = 4.668e-06, dEband = 4.054e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0809267864995, which took 0.348 ms

iter_count = 108, r_2norm = 2.639e-06, tol*||rhs|| = 3.237e-06

Anderson update took 57.450 ms, out of which F'*F took 26.973 ms; b-Ax took 180.907 ms, out of which Lap took 162.347 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.356 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260099, int_b + int_rho = -3.129e-13, checking this took 0.126 ms
2-norm of RHS = 669.9194588419614, which took 0.121 ms

iter_count = 204, r_2norm = 5.374e-04, tol*||rhs|| = 6.699e-04

Anderson update took 109.327 ms, out of which F'*F took 51.038 ms; b-Ax took 345.249 ms, out of which Lap took 309.387 ms
Solving Poisson took 729.181 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.136638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.642 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.135941 
Total time for convolution: 	 convolve: 5.141679 
Total time for convolution: 	 convolve: 5.153692 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.786 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.848 ms
---Transfer Veff_loc: D2D took 3.437 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.030 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.501 ms

This SCF took 27252.241 ms, scf error = 4.208e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133321, lowerbound = -1.127408, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1364.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 59.573 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.502 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.093 ms
rank =  0, finding HY took 23.559 ms
rank =  0, distributing HY into block cyclic form took 17.025 ms
rank =  0, finding Y'*HY took 3.575 ms
Rank 0, Project_Hamiltonian used 106.881 ms
Total time for projection: 106.899 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.822 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.761 ms
rank = 0, Solve_Generalized_EigenProblem used 1.590 ms
    first calculated eigval = -1.126597401279627
    last  calculated eigval = 0.034539009659987
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69297090078415
lambda[   4] =  -0.56113371167765
lambda[   5] =  -0.49532680033385
lambda[   6] =  -0.46287067541426
lambda[   7] =  -0.44881547893424
lambda[   8] =  -0.39205502305846
lambda[   9] =  -0.36972976828688
lambda[  10] =  -0.32278168208554
lambda[  11] =  -0.28368513221004
lambda[  12] =  -0.22952288776255
lambda[  13] =  -0.10940367221668
lambda[  14] =  -0.02202284484916
lambda[  15] =   0.01666676085174
lambda[  16] =   0.02337837531017
lambda[  17] =   0.02397208617037
lambda[  18] =   0.03159636351666
lambda[  19] =   0.03453900965999
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.607 ms
rank =  0, subspace rotation using ScaLAPACK took 6.902 ms
rank =  0, Distributing orbital back into band + domain format took 16.887 ms
rank = 0, Subspace_Rotation used 23.807 ms

Total time for subspace rotation: 23.812 ms
rank = 0, Efermi =  -0.138459900434 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 5.305 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.234 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 1513.556 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.850 ms
rank = 0, D2D took 1.949 ms
rank = 0, Transfering density took 1.956 ms
Etot    =   -51.156278008735
Eband   =   -12.711250217380
E1      =    26.789018205248
E2      =   -12.337402175298
E3      =   -16.218130251445
Exc     =   -14.477828400394
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 4.563e-06, dEband = 3.020e-03
rank = 0, Calculating/Estimating energy took 0.926 ms, Etot = -51.156278009, dEtot = 4.563e-06, dEband = 3.020e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0532296675321, which took 0.055 ms

iter_count = 114, r_2norm = 1.361e-06, tol*||rhs|| = 2.129e-06

Anderson update took 60.843 ms, out of which F'*F took 28.405 ms; b-Ax took 193.264 ms, out of which Lap took 173.688 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.078 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260103, int_b + int_rho = -2.801e-13, checking this took 0.110 ms
2-norm of RHS = 669.9166652403384, which took 0.109 ms

iter_count = 156, r_2norm = 6.423e-04, tol*||rhs|| = 6.699e-04

Anderson update took 84.124 ms, out of which F'*F took 39.043 ms; b-Ax took 264.084 ms, out of which Lap took 237.997 ms
Solving Poisson took 560.320 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.137724 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 63.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.137619 
Total time for convolution: 	 convolve: 5.143404 
Total time for convolution: 	 convolve: 5.133780 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.721 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.191 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 3.470 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.024 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.529 ms

This SCF took 27109.373 ms, scf error = 2.318e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134539, lowerbound = -1.126597, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1362.486 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 59.901 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.489 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 62.409 ms
rank =  0, finding HY took 23.545 ms
rank =  0, distributing HY into block cyclic form took 17.043 ms
rank =  0, finding Y'*HY took 3.609 ms
Rank 0, Project_Hamiltonian used 107.257 ms
Total time for projection: 107.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.115 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.085 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -1.126358700668084
    last  calculated eigval = 0.035060502839498
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69275909012619
lambda[   4] =  -0.56092209953380
lambda[   5] =  -0.49510455935284
lambda[   6] =  -0.46265258322636
lambda[   7] =  -0.44859780290139
lambda[   8] =  -0.39185161010837
lambda[   9] =  -0.36951967491702
lambda[  10] =  -0.32256264683481
lambda[  11] =  -0.28346526967476
lambda[  12] =  -0.22929881868701
lambda[  13] =  -0.10917696411782
lambda[  14] =  -0.02108914819771
lambda[  15] =   0.01737923814181
lambda[  16] =   0.02459334967573
lambda[  17] =   0.02485405875967
lambda[  18] =   0.03089085274562
lambda[  19] =   0.03506050283950
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.227 ms
rank =  0, subspace rotation using ScaLAPACK took 6.835 ms
rank =  0, Distributing orbital back into band + domain format took 17.155 ms
rank = 0, Subspace_Rotation used 24.003 ms

Total time for subspace rotation: 24.009 ms
rank = 0, Efermi =  -0.138233192351 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 5.369 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.200 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.622 ms
rank = 0, Calculating density took 1510.367 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.829 ms
rank = 0, D2D took 1.932 ms
rank = 0, Transfering density took 1.938 ms
Etot    =   -51.156288652343
Eband   =   -12.706000339775
E1      =    26.786352801973
E2      =   -12.334721769394
E3      =   -16.218546805907
Exc     =   -14.478159666889
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 1.521e-06, dEband = 7.500e-04
rank = 0, Calculating/Estimating energy took 0.920 ms, Etot = -51.156288652, dEtot = 1.521e-06, dEband = 7.500e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0337288069643, which took 0.049 ms

iter_count = 114, r_2norm = 8.812e-07, tol*||rhs|| = 1.349e-06

Anderson update took 60.883 ms, out of which F'*F took 28.433 ms; b-Ax took 192.859 ms, out of which Lap took 173.634 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.877 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260091, int_b + int_rho = -3.893e-13, checking this took 0.113 ms
2-norm of RHS = 669.9148224129797, which took 0.102 ms

iter_count = 168, r_2norm = 6.000e-04, tol*||rhs|| = 6.699e-04

Anderson update took 89.908 ms, out of which F'*F took 42.176 ms; b-Ax took 283.327 ms, out of which Lap took 254.219 ms
Solving Poisson took 601.295 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.145303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 49.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.134824 
Total time for convolution: 	 convolve: 5.137132 
Total time for convolution: 	 convolve: 5.139945 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.831 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.444 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.023 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.514 ms

This SCF took 27140.091 ms, scf error = 1.850e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.135061, lowerbound = -1.126359, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1368.143 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 54.409 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.562 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 56.995 ms
rank =  0, finding HY took 23.533 ms
rank =  0, distributing HY into block cyclic form took 17.012 ms
rank =  0, finding Y'*HY took 3.588 ms
Rank 0, Project_Hamiltonian used 101.156 ms
Total time for projection: 101.173 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.125977413005386
    last  calculated eigval = 0.036103243145228
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69239519679899
lambda[   4] =  -0.56057374507595
lambda[   5] =  -0.49474831529473
lambda[   6] =  -0.46229284257418
lambda[   7] =  -0.44824761235631
lambda[   8] =  -0.39150430043544
lambda[   9] =  -0.36917223909811
lambda[  10] =  -0.32221351579209
lambda[  11] =  -0.28311681718441
lambda[  12] =  -0.22895298954162
lambda[  13] =  -0.10881398222429
lambda[  14] =  -0.01971840626061
lambda[  15] =   0.01745871903891
lambda[  16] =   0.02651339606588
lambda[  17] =   0.02690402733196
lambda[  18] =   0.03122268212075
lambda[  19] =   0.03610324314523
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 6.849 ms
rank =  0, Distributing orbital back into band + domain format took 16.868 ms
rank = 0, Subspace_Rotation used 23.731 ms

Total time for subspace rotation: 23.736 ms
rank = 0, Efermi =  -0.137870210506 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.345 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.292 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.576 ms
rank = 0, Calculating density took 1509.595 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.910 ms
rank = 0, Transfering density took 1.912 ms
Etot    =   -51.156321288292
Eband   =   -12.697463799814
E1      =    26.781952879079
E2      =   -12.330457278945
E3      =   -16.219096051760
Exc     =   -14.478613675309
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 4.662e-06, dEband = 1.220e-03
rank = 0, Calculating/Estimating energy took 0.938 ms, Etot = -51.156321288, dEtot = 4.662e-06, dEband = 1.220e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0268863090459, which took 0.050 ms

iter_count = 108, r_2norm = 9.028e-07, tol*||rhs|| = 1.075e-06

Anderson update took 58.241 ms, out of which F'*F took 27.087 ms; b-Ax took 181.147 ms, out of which Lap took 163.334 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.496 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260094, int_b + int_rho = -3.674e-13, checking this took 0.125 ms
2-norm of RHS = 669.9182329350089, which took 0.069 ms

iter_count = 156, r_2norm = 5.447e-04, tol*||rhs|| = 6.699e-04

Anderson update took 83.229 ms, out of which F'*F took 38.747 ms; b-Ax took 263.052 ms, out of which Lap took 235.185 ms
Solving Poisson took 557.735 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.131279 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 86.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.137584 
Total time for convolution: 	 convolve: 5.140895 
Total time for convolution: 	 convolve: 5.137572 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.058 ms
---Transfer Veff_loc: D2D took 4.324 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.182 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.541 ms

This SCF took 27635.128 ms, scf error = 1.199e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136103, lowerbound = -1.125977, upperbound = 267.579293

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1365.971 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 58.583 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.523 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 61.124 ms
rank =  0, finding HY took 23.613 ms
rank =  0, distributing HY into block cyclic form took 17.084 ms
rank =  0, finding Y'*HY took 3.572 ms
Rank 0, Project_Hamiltonian used 105.428 ms
Total time for projection: 105.448 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.117 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.208 ms
    first calculated eigval = -1.125742489343716
    last  calculated eigval = 0.037757203888423
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.69214012290007
lambda[   4] =  -0.56032089484725
lambda[   5] =  -0.49450443919245
lambda[   6] =  -0.46205224034485
lambda[   7] =  -0.44800275914475
lambda[   8] =  -0.39125478538769
lambda[   9] =  -0.36892286317651
lambda[  10] =  -0.32196309677640
lambda[  11] =  -0.28286884092312
lambda[  12] =  -0.22872022277650
lambda[  13] =  -0.10858010803601
lambda[  14] =  -0.01841609046421
lambda[  15] =   0.01783499972998
lambda[  16] =   0.02750425337034
lambda[  17] =   0.02874180352552
lambda[  18] =   0.03176857528788
lambda[  19] =   0.03775720388842
==subpsace eigenproblem: bcast eigvals took 0.029 ms
Total time for solving subspace eigenvalue problem: 0.246 ms
rank =  0, subspace rotation using ScaLAPACK took 6.834 ms
rank =  0, Distributing orbital back into band + domain format took 16.941 ms
rank = 0, Subspace_Rotation used 23.790 ms

Total time for subspace rotation: 23.795 ms
rank = 0, Efermi =  -0.137636336347 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 5.363 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.216 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.611 ms
rank = 0, Calculating density took 1511.832 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.836 ms
rank = 0, D2D took 1.947 ms
rank = 0, Transfering density took 1.954 ms
Etot    =   -51.156344746754
Eband   =   -12.691561236678
E1      =    26.779034995503
E2      =   -12.327380944062
E3      =   -16.219465732384
Exc     =   -14.478915159073
Esc     =   -79.311750022277
Entropy =    -0.000000000677
dE = 3.351e-06, dEband = 8.432e-04
rank = 0, Calculating/Estimating energy took 0.895 ms, Etot = -51.156344747, dEtot = 3.351e-06, dEband = 8.432e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229214219714, which took 0.055 ms

iter_count = 108, r_2norm = 8.334e-07, tol*||rhs|| = 9.169e-07

Anderson update took 57.364 ms, out of which F'*F took 26.986 ms; b-Ax took 181.978 ms, out of which Lap took 162.722 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 394.806 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000002260131, int_rho =  24.00000002260096, int_b + int_rho = -3.492e-13, checking this took 0.122 ms
2-norm of RHS = 669.9208904142853, which took 0.148 ms

iter_count = 132, r_2norm = 6.228e-04, tol*||rhs|| = 6.699e-04

Anderson update took 70.414 ms, out of which F'*F took 33.147 ms; b-Ax took 225.646 ms, out of which Lap took 203.028 ms
Solving Poisson took 474.718 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.158315 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 128.212 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.300 ms
Total time for convolution: 	 convolve: 5.164476 
Total time for convolution: 	 convolve: 5.152940 
Total time for convolution: 	 convolve: 5.184551 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.180 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 3.470 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.267 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.780 ms

This SCF took 27189.373 ms, scf error = 8.219e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.69214012290007, occ[   3] =   2.00000000000000
lambda[   4] =  -0.56032089484725, occ[   4] =   2.00000000000000
lambda[   5] =  -0.49450443919245, occ[   5] =   2.00000000000000
lambda[   6] =  -0.46205224034485, occ[   6] =   2.00000000000000
lambda[   7] =  -0.44800275914475, occ[   7] =   2.00000000000000
lambda[   8] =  -0.39125478538769, occ[   8] =   2.00000000000000
lambda[   9] =  -0.36892286317651, occ[   9] =   2.00000000000000
lambda[  10] =  -0.32196309677640, occ[  10] =   2.00000000000000
lambda[  11] =  -0.28286884092312, occ[  11] =   2.00000000000000
lambda[  12] =  -0.22872022277650, occ[  12] =   2.00000000000000
lambda[  13] =  -0.10858010803601, occ[  13] =   0.00000002260099
lambda[  14] =  -0.01841609046421, occ[  14] =   0.00000000000000
lambda[  15] =   0.01783499972998, occ[  15] =   0.00000000000000
lambda[  16] =   0.02750425337034, occ[  16] =   0.00000000000000
lambda[  17] =   0.02874180352552, occ[  17] =   0.00000000000000
lambda[  18] =   0.03176857528788, occ[  18] =   0.00000000000000
lambda[  19] =   0.03775720388842, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.312 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.648 ms, time for Allreduce/Reduce: 7.550 ms 
Time for calculating local force components: 18.529 ms
Start Calculating nonlocal forces
force_nloc = 
  0.22068643088207  -0.92142046676424  -0.00000075038868
 -0.28902330271281   1.28020048591524  -0.00000022112154
 -0.03223112470010  -0.04066223903335   0.00000000687492
 -0.00784220354332   0.02909869779871  -0.04126195543592
 -0.00784220777538   0.02909867694939   0.04126194701059
 -0.18758504053232   0.07335719888109  -0.00000014430667
  0.97540837357061  -0.57778789716218  -0.00000219999283
force_loc = 
 -0.20381567745078   0.90894256751531  -0.00000613240082
  0.28470272116836  -1.26411365383518  -0.00000060523860
  0.03319961968567   0.04166493033885  -0.00000035208757
  0.00822127186950  -0.02988736177440   0.04262511287460
  0.00822147857366  -0.02988686665988  -0.04262446127322
  0.18366620139874  -0.07098778875297  -0.00000112436215
 -0.96025175128944   0.56848491119528  -0.00000413184284
Time for calculating nonlocal force components: 37.735 ms
[32mforces_xc: 
[0m[32m -0.00906956952203   0.02886782329516  -0.00000021037164
[0m[32m  0.00605931663106  -0.03110907310520   0.00000000574194
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00932561523478  -0.00330933333899   0.00000000253346
[0m[32m -0.03244936747289   0.00989902772061  -0.00000011674645
[0mTime for calculating XC forces components: 25.444 ms
 Cartesian force = 
  0.00788964333563   0.01632568987720  -0.00000490308493
  0.00182719451298  -0.01508647519417   0.00000136945799
  0.00105695441194   0.00093845713647   0.00000184486355
  0.00046752775255  -0.00085289814473   0.00136534751488
  0.00046773022466  -0.00085242387953  -0.00136032418643
  0.00549523552757  -0.00100415737990   0.00000092394085
 -0.01720428576534   0.00053180758467  -0.00000425850591
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.313 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Time for printing density: 389.403 ms
The program took 388.755 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:34:16
Job ID:        2266855
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:19:48,vmem=8364K,walltime=00:06:39,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-10-1
---------------------------------------
