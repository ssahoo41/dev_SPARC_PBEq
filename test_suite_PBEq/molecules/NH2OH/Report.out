---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:43
Job ID:    2266975
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:28:47
Job ID:    2266975
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.065 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.004 ms
Reading input file sprc-calc.inpt

Reading input file took 1.163 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 1.372 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 155.404 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.996 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.116 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    9.653755	    8.591569	   10.000000	
   11.431211	    8.231446	   10.000000	
    8.568789	   11.768554	   11.523308	
    8.568789	   11.768554	    8.476692	
    9.653755	   11.328837	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.194 ms
Set up communicators.

--set up spincomm took 2.304 ms

--set up kptcomm took 0.359 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {2, 2, 3}
gridsizes = [100, 100, 100], Nstates = 13, dmcomm dims = [2, 2, 3]

--set up dmcomm took 0.010 ms

--set up blacscomm took 0.008 ms
rank = 0, size_blacscomm = 1, ScaLAPACK topology Dims = (1, 1)
nproc = 12, size_blacscomm = 1 = dims[0] * dims[1] = (1, 1)
Nd_blacscomm 85000, Nstates 13 
rank =  0, my blacs rank = 0, BLCYC size (85000, 13), actual size (85000, 13)
rank = 0, mb = nb = 13, mbQ = nbQ = 64
rank = 0, nr_Hp = 13, nc_Hp = 13
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.111 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.469 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 1
# of bands per bandcomm          : 13
npdomain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.041 ms

Calculate_SplineDerivRadFun took 0.211 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.292 ms.
time spent on vectorized spline interp: 3.258 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 3.119 ms.
time spent on vectorized spline interp: 1.326 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.340 ms.
time spent on vectorized spline interp: 1.661 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.518 ms.

Calculating rb for all atom types took 15.546 ms
----------------------
Estimated memory usage
Total: 562.34 MB
orbitals             : 297.55 MB
global sized vectors : 213.62 MB
subspace matrices : 47.53 kB
others : 51.12 MB
----------------------------------------------
Estimated memory usage per processor: 46.86 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.814 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.012 ms
Calculating pseudocharge density ... 
the global sum of int_b = -14.0000000157138, sum_int_rho = 13.7063256573517
PosCharge = 14.000000015714, NegCharge = -13.706325657352, scal_fac = 1.021426191505
After scaling, int_rho = 14.0000000157138, PosCharge + NegCharge - NetCharge = 5.329e-15
--Calculate Vref took 0.255 ms
--Calculate rho_guess took 1.361 ms

 integral of b = -14.0000000157138,
 int{b} + Nelectron + NetCharge = -1.571e-08,
 Esc = -44.9473974759032,
 MPI_Reduce took 4.696 ms

Calculating b & b_ref took 10.895 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.009 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.068 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 24.987 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571388, int_b + int_rho = -4.184e-14, checking this took 0.092 ms
2-norm of RHS = 561.9472616401581, which took 0.820 ms

iter_count = 414, r_2norm = 5.553e-04, tol*||rhs|| = 5.619e-04

Anderson update took 233.974 ms, out of which F'*F took 105.550 ms; b-Ax took 716.289 ms, out of which Lap took 642.176 ms
Solving Poisson took 1505.591 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.822 ms
Total time for convolution: 	 convolve: 5.179795 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 31.308 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.839 ms
Total time for convolution: 	 convolve: 5.157867 
Total time for convolution: 	 convolve: 5.187000 
Total time for convolution: 	 convolve: 5.188340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.725 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.070 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
rank = 0, XC calculation took 24696.211 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.580 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 1.695 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.201 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.672 ms
    Lanczos iter 53, eigmin  = -1.024460065, eigmax = 264.921592506, err_eigmin = 4.635e-04, err_eigmax = 9.688e-03
rank =   0, Lanczos took 124.913 ms, eigmin = -1.024460064943, eigmax = 267.570808431424

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.223174, lowerbound = -1.124460, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1128.108 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.793 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 2.827 ms
rank =  0, finding HY took 18.215 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.393 ms
Rank 0, Project_Hamiltonian used 23.457 ms
Total time for projection: 23.520 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.323 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.077 ms
rank = 0, Solve_Generalized_EigenProblem used 0.421 ms
    first calculated eigval = 2.848066922463612
    last  calculated eigval = 3.231723447523245
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =   2.84806692246361
lambda[   2] =   2.89457720854179
lambda[   3] =   2.92899710166123
lambda[   4] =   2.94276117713938
lambda[   5] =   2.97656374832972
lambda[   6] =   3.01227949492543
lambda[   7] =   3.02517389088331
lambda[   8] =   3.07115781986916
lambda[   9] =   3.07484587925607
lambda[  10] =   3.10573797226930
lambda[  11] =   3.14609187642823
lambda[  12] =   3.20504733845264
lambda[  13] =   3.23172344752324
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.442 ms
rank =  0, subspace rotation using ScaLAPACK took 2.765 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 2.779 ms

Total time for subspace rotation: 2.780 ms
rank = 0, Efermi =   3.048150562840 calculate fermi energy took 0.069 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.331723, lowerbound = -1.124460, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.042 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.727 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.058 ms
rank =  0, Distribute data + matrix mult took 2.789 ms
rank =  0, finding HY took 18.223 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.341 ms
Rank 0, Project_Hamiltonian used 23.380 ms
Total time for projection: 23.396 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.720171657580313
    last  calculated eigval = 0.453232787314435
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.72017165758031
lambda[   2] =  -0.54420383116532
lambda[   3] =  -0.14301436155671
lambda[   4] =   0.02107820996338
lambda[   5] =   0.14239836542762
lambda[   6] =   0.21012998588995
lambda[   7] =   0.25989126154049
lambda[   8] =   0.31909025328721
lambda[   9] =   0.36167342498942
lambda[  10] =   0.36813647079296
lambda[  11] =   0.41098263327483
lambda[  12] =   0.43809615915754
lambda[  13] =   0.45323278731444
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.136 ms
rank =  0, subspace rotation using ScaLAPACK took 3.034 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.040 ms

Total time for subspace rotation: 3.041 ms
rank = 0, Efermi =   0.290026330648 calculate fermi energy took 0.025 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.553233, lowerbound = -1.124460, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1095.735 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.722 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 2.800 ms
rank =  0, finding HY took 18.868 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.354 ms
Rank 0, Project_Hamiltonian used 24.049 ms
Total time for projection: 24.083 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -1.030060627968184
    last  calculated eigval = 0.153368393338254
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.03006062796818
lambda[   2] =  -0.82590957974350
lambda[   3] =  -0.52996797012736
lambda[   4] =  -0.50138452691988
lambda[   5] =  -0.45674325832924
lambda[   6] =  -0.28719900750652
lambda[   7] =  -0.26119997229592
lambda[   8] =   0.05659183414237
lambda[   9] =   0.07672084999080
lambda[  10] =   0.10542791231964
lambda[  11] =   0.12280362109591
lambda[  12] =   0.13549813144934
lambda[  13] =   0.15336839333825
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.135 ms
rank =  0, subspace rotation using ScaLAPACK took 2.839 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.845 ms

Total time for subspace rotation: 2.845 ms
rank = 0, Efermi =   0.027209383906 calculate fermi energy took 0.052 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.253368, lowerbound = -1.124460, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1113.513 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.739 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.037 ms
rank =  0, Distribute data + matrix mult took 2.781 ms
rank =  0, finding HY took 18.194 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.341 ms
Rank 0, Project_Hamiltonian used 23.342 ms
Total time for projection: 23.361 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -1.030392787747022
    last  calculated eigval = 0.082381068197005
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.03039278774702
lambda[   2] =  -0.82631060633237
lambda[   3] =  -0.53360531501567
lambda[   4] =  -0.51460747796465
lambda[   5] =  -0.46535077257405
lambda[   6] =  -0.31762251041154
lambda[   7] =  -0.31685170576962
lambda[   8] =  -0.01657841629116
lambda[   9] =  -0.00485570029907
lambda[  10] =   0.05146097887317
lambda[  11] =   0.06534964166718
lambda[  12] =   0.07908970840772
lambda[  13] =   0.08238106819701
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.130 ms
rank =  0, subspace rotation using ScaLAPACK took 3.046 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.051 ms

Total time for subspace rotation: 3.052 ms
rank = 0, Efermi =  -0.045960866587 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 4660.336 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
rank = 0, D2D took 0.476 ms
rank = 0, Transfering density took 0.519 ms
Etot    =   -28.684752370095
Eband   =    -8.009482351890
E1      =    16.115497911694
E2      =    -7.123056385553
E3      =    -9.070377452670
Exc     =    -8.036804291743
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 5.737e+00, dEband = 1.602e+00
rank = 0, Calculating/Estimating energy took 1.850 ms, Etot = -28.684752370, dEtot = 5.737e+00, dEband = 1.602e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 63.9276549406495, which took 0.078 ms

iter_count = 90, r_2norm = 1.794e-03, tol*||rhs|| = 2.557e-03

Anderson update took 48.674 ms, out of which F'*F took 22.595 ms; b-Ax took 152.044 ms, out of which Lap took 136.502 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.474 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571380, int_b + int_rho = -1.182e-13, checking this took 0.154 ms
2-norm of RHS = 559.2318087057703, which took 0.170 ms

iter_count = 282, r_2norm = 4.557e-04, tol*||rhs|| = 5.592e-04

Anderson update took 153.486 ms, out of which F'*F took 71.171 ms; b-Ax took 474.862 ms, out of which Lap took 426.630 ms
Solving Poisson took 1013.647 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.898 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.208044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.243094 
Total time for convolution: 	 convolve: 5.265868 
Total time for convolution: 	 convolve: 5.199348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.728 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.214 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 30977.081 ms, scf error = 1.530e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.182381, lowerbound = -1.030393, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1093.099 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.728 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.053 ms
rank =  0, Distribute data + matrix mult took 2.786 ms
rank =  0, finding HY took 18.124 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.325 ms
Rank 0, Project_Hamiltonian used 23.257 ms
Total time for projection: 23.277 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.101 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.128 ms
    first calculated eigval = -1.011196702205447
    last  calculated eigval = 0.060192393695780
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -1.01119670220545
lambda[   2] =  -0.79693539862277
lambda[   3] =  -0.50745567882776
lambda[   4] =  -0.49455222067430
lambda[   5] =  -0.44028007491222
lambda[   6] =  -0.29606159109703
lambda[   7] =  -0.28501251055207
lambda[   8] =  -0.03150317765356
lambda[   9] =  -0.02212168718178
lambda[  10] =   0.03151352885558
lambda[  11] =   0.04188283827931
lambda[  12] =   0.04703097136678
lambda[  13] =   0.06019239369578
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.047 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.052 ms

Total time for subspace rotation: 3.053 ms
rank = 0, Efermi =  -0.060885632836 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.490 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1121.201 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
rank = 0, D2D took 0.452 ms
rank = 0, Transfering density took 0.455 ms
Etot    =   -28.662979327311
Eband   =    -7.662988354278
E1      =    15.825894250807
E2      =    -7.067375813433
E3      =    -9.167532996540
Exc     =    -8.113396557435
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 4.355e-03, dEband = 6.930e-02
rank = 0, Calculating/Estimating energy took 2.065 ms, Etot = -28.662979327, dEtot = 4.355e-03, dEband = 6.930e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 19.3282974142996, which took 1.299 ms

iter_count = 96, r_2norm = 6.118e-04, tol*||rhs|| = 7.731e-04

Anderson update took 52.254 ms, out of which F'*F took 23.900 ms; b-Ax took 167.895 ms, out of which Lap took 151.217 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 358.644 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571377, int_b + int_rho = -1.492e-13, checking this took 0.138 ms
2-norm of RHS = 556.4428945916420, which took 0.145 ms

iter_count = 294, r_2norm = 4.606e-04, tol*||rhs|| = 5.564e-04

Anderson update took 160.845 ms, out of which F'*F took 77.581 ms; b-Ax took 506.317 ms, out of which Lap took 452.277 ms
Solving Poisson took 1064.006 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.793 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.180538 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.290015 
Total time for convolution: 	 convolve: 5.259809 
Total time for convolution: 	 convolve: 5.249464 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.629 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 0.324 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.341 ms

This SCF took 27619.997 ms, scf error = 1.033e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.160192, lowerbound = -1.011197, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.024 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.060 ms
rank =  0, Distribute data + matrix mult took 2.789 ms
rank =  0, finding HY took 18.273 ms
rank =  0, distributing HY into block cyclic form took 0.001 ms
rank =  0, finding Y'*HY took 2.349 ms
Rank 0, Project_Hamiltonian used 23.437 ms
Total time for projection: 23.452 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 2.365 ms
rank = 0, Solve_Generalized_EigenProblem used 2.440 ms
    first calculated eigval = -0.982338114026819
    last  calculated eigval = 0.055553878318554
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.98233811402682
lambda[   2] =  -0.75192614469571
lambda[   3] =  -0.46658436632435
lambda[   4] =  -0.46335195564121
lambda[   5] =  -0.40182869415171
lambda[   6] =  -0.25899528107171
lambda[   7] =  -0.23619998060145
lambda[   8] =  -0.03580771959562
lambda[   9] =  -0.01742972059257
lambda[  10] =   0.02578401894476
lambda[  11] =   0.02894985234853
lambda[  12] =   0.03464339846078
lambda[  13] =   0.05555387831855
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 2.523 ms
rank =  0, subspace rotation using ScaLAPACK took 3.010 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.016 ms

Total time for subspace rotation: 3.016 ms
rank = 0, Efermi =  -0.065190169778 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.488 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.739 ms
rank = 0, Calculating density took 1119.177 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
rank = 0, D2D took 0.329 ms
rank = 0, Transfering density took 0.335 ms
Etot    =   -28.645224551441
Eband   =    -7.122449073589
E1      =    15.403366878713
E2      =    -6.930674121981
E3      =    -9.338130360477
Exc     =    -8.247549362646
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 3.551e-03, dEband = 1.081e-01
rank = 0, Calculating/Estimating energy took 0.876 ms, Etot = -28.645224551, dEtot = 3.551e-03, dEband = 1.081e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.7281789715887, which took 0.058 ms

iter_count = 96, r_2norm = 2.713e-04, tol*||rhs|| = 3.091e-04

Anderson update took 51.899 ms, out of which F'*F took 24.068 ms; b-Ax took 163.799 ms, out of which Lap took 146.888 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.103 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571380, int_b + int_rho = -1.146e-13, checking this took 0.107 ms
2-norm of RHS = 557.6011300019505, which took 0.125 ms

iter_count = 264, r_2norm = 5.535e-04, tol*||rhs|| = 5.576e-04

Anderson update took 142.943 ms, out of which F'*F took 66.575 ms; b-Ax took 448.420 ms, out of which Lap took 402.752 ms
Solving Poisson took 948.800 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.205494 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.163203 
Total time for convolution: 	 convolve: 5.201020 
Total time for convolution: 	 convolve: 5.254075 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.869 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.633 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 0.326 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27264.514 ms, scf error = 3.439e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.155554, lowerbound = -0.982338, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1099.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.705 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.070 ms
rank =  0, Distribute data + matrix mult took 2.779 ms
rank =  0, finding HY took 18.103 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.339 ms
Rank 0, Project_Hamiltonian used 23.241 ms
Total time for projection: 23.256 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.981607078479010
    last  calculated eigval = 0.048601768157884
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.98160707847901
lambda[   2] =  -0.74849876660620
lambda[   3] =  -0.46195945158311
lambda[   4] =  -0.46178667007786
lambda[   5] =  -0.39942890373075
lambda[   6] =  -0.25598764795877
lambda[   7] =  -0.23342002852679
lambda[   8] =  -0.03667322487108
lambda[   9] =  -0.01840599799968
lambda[  10] =   0.01956282934027
lambda[  11] =   0.02577577530022
lambda[  12] =   0.02669723468752
lambda[  13] =   0.04860176815788
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.048 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 3.633 ms

Total time for subspace rotation: 3.634 ms
rank = 0, Efermi =  -0.066055675114 calculate fermi energy took 0.687 ms
rank = 0, --- Calculate rho: sum over local bands took 1.446 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1128.793 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.254 ms
rank = 0, D2D took 0.395 ms
rank = 0, Transfering density took 0.401 ms
Etot    =   -28.643603051849
Eband   =    -7.085377094501
E1      =    15.407552620117
E2      =    -6.886243384611
E3      =    -9.353563291919
Exc     =    -8.258187777616
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 3.243e-04, dEband = 7.414e-03
rank = 0, Calculating/Estimating energy took 1.217 ms, Etot = -28.643603052, dEtot = 3.243e-04, dEband = 7.414e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 1.3472040165725, which took 0.056 ms

iter_count = 108, r_2norm = 5.349e-05, tol*||rhs|| = 5.389e-05

Anderson update took 58.183 ms, out of which F'*F took 27.032 ms; b-Ax took 184.435 ms, out of which Lap took 165.100 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.047 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571385, int_b + int_rho = -6.366e-14, checking this took 0.125 ms
2-norm of RHS = 558.0055493363608, which took 0.144 ms

iter_count = 258, r_2norm = 4.572e-04, tol*||rhs|| = 5.580e-04

Anderson update took 137.042 ms, out of which F'*F took 64.608 ms; b-Ax took 438.624 ms, out of which Lap took 392.785 ms
Solving Poisson took 925.996 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.215472 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.186852 
Total time for convolution: 	 convolve: 5.211560 
Total time for convolution: 	 convolve: 5.190853 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.865 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.441 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.319 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.338 ms

This SCF took 27268.574 ms, scf error = 1.176e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.148602, lowerbound = -0.981607, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.335 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.708 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.023 ms
rank =  0, Distribute data + matrix mult took 2.735 ms
rank =  0, finding HY took 18.255 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.346 ms
Rank 0, Project_Hamiltonian used 23.368 ms
Total time for projection: 23.383 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.095 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.121 ms
    first calculated eigval = -0.978761319152566
    last  calculated eigval = 0.043074358278997
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.97876131915257
lambda[   2] =  -0.74478221700403
lambda[   3] =  -0.45897558356827
lambda[   4] =  -0.45782357428958
lambda[   5] =  -0.39612629304163
lambda[   6] =  -0.25267545814003
lambda[   7] =  -0.22971905161987
lambda[   8] =  -0.03689941050618
lambda[   9] =  -0.01814232612552
lambda[  10] =   0.01687482577784
lambda[  11] =   0.02110695526082
lambda[  12] =   0.02543404499569
lambda[  13] =   0.04307435827900
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.142 ms
rank =  0, subspace rotation using ScaLAPACK took 2.951 ms
rank =  0, Distributing orbital back into band + domain format took 0.006 ms
rank = 0, Subspace_Rotation used 2.967 ms

Total time for subspace rotation: 2.969 ms
rank = 0, Efermi =  -0.066281860718 calculate fermi energy took 0.616 ms
rank = 0, --- Calculate rho: sum over local bands took 1.451 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1116.745 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
rank = 0, D2D took 0.460 ms
rank = 0, Transfering density took 0.469 ms
Etot    =   -28.643177930390
Eband   =    -7.037726994212
E1      =    15.388007621630
E2      =    -6.854688991900
E3      =    -9.367560422790
Exc     =    -8.268310496120
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 8.502e-05, dEband = 9.530e-03
rank = 0, Calculating/Estimating energy took 0.978 ms, Etot = -28.643177930, dEtot = 8.502e-05, dEband = 9.530e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5898114621630, which took 0.055 ms

iter_count = 108, r_2norm = 2.257e-05, tol*||rhs|| = 2.359e-05

Anderson update took 57.933 ms, out of which F'*F took 27.202 ms; b-Ax took 184.019 ms, out of which Lap took 164.789 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.849 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571379, int_b + int_rho = -1.291e-13, checking this took 0.097 ms
2-norm of RHS = 558.1473319545943, which took 0.162 ms

iter_count = 252, r_2norm = 5.384e-04, tol*||rhs|| = 5.581e-04

Anderson update took 134.052 ms, out of which F'*F took 63.307 ms; b-Ax took 429.661 ms, out of which Lap took 384.727 ms
Solving Poisson took 905.353 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.213652 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.361 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.177446 
Total time for convolution: 	 convolve: 5.245717 
Total time for convolution: 	 convolve: 5.210537 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.773 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.136 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 0.332 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27277.564 ms, scf error = 5.377e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.143074, lowerbound = -0.978761, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.762 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.736 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.050 ms
rank =  0, Distribute data + matrix mult took 2.791 ms
rank =  0, finding HY took 18.275 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.351 ms
Rank 0, Project_Hamiltonian used 23.446 ms
Total time for projection: 23.467 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.066 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.090 ms
    first calculated eigval = -0.973935522194009
    last  calculated eigval = 0.038510579625574
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.97393552219401
lambda[   2] =  -0.74095013432637
lambda[   3] =  -0.45502768729281
lambda[   4] =  -0.45383975545503
lambda[   5] =  -0.39195169729130
lambda[   6] =  -0.24883969996814
lambda[   7] =  -0.22558177318826
lambda[   8] =  -0.03705483122394
lambda[   9] =  -0.01741738887742
lambda[  10] =   0.01496410064469
lambda[  11] =   0.01807374996701
lambda[  12] =   0.02480653011357
lambda[  13] =   0.03851057962557
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.093 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.101 ms

Total time for subspace rotation: 3.102 ms
rank = 0, Efermi =  -0.066437281398 calculate fermi energy took 0.056 ms
rank = 0, --- Calculate rho: sum over local bands took 1.512 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.630 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.255 ms
rank = 0, D2D took 0.434 ms
rank = 0, Transfering density took 0.437 ms
Etot    =   -28.643097502223
Eband   =    -6.980252540014
E1      =    15.359953049943
E2      =    -6.822651205974
E3      =    -9.376427650462
Exc     =    -8.274479392209
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.609e-05, dEband = 1.149e-02
rank = 0, Calculating/Estimating energy took 1.025 ms, Etot = -28.643097502, dEtot = 1.609e-05, dEband = 1.149e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3590061724718, which took 0.058 ms

iter_count = 108, r_2norm = 1.230e-05, tol*||rhs|| = 1.436e-05

Anderson update took 58.545 ms, out of which F'*F took 30.022 ms; b-Ax took 207.784 ms, out of which Lap took 188.544 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.725 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571380, int_b + int_rho = -1.146e-13, checking this took 0.116 ms
2-norm of RHS = 558.2291165657109, which took 0.134 ms

iter_count = 240, r_2norm = 5.337e-04, tol*||rhs|| = 5.582e-04

Anderson update took 127.880 ms, out of which F'*F took 60.021 ms; b-Ax took 408.070 ms, out of which Lap took 365.610 ms
Solving Poisson took 862.607 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.170967 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 102.822 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.342 ms
Total time for convolution: 	 convolve: 5.192089 
Total time for convolution: 	 convolve: 5.230000 
Total time for convolution: 	 convolve: 5.201273 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
---Transfer Veff_loc: D2D took 0.342 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.361 ms

This SCF took 27324.770 ms, scf error = 2.546e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.138511, lowerbound = -0.973936, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.174 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.724 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.153 ms
rank =  0, Distribute data + matrix mult took 2.883 ms
rank =  0, finding HY took 18.247 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.335 ms
Rank 0, Project_Hamiltonian used 23.489 ms
Total time for projection: 23.504 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.094 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.515 ms
    first calculated eigval = -0.971992913572365
    last  calculated eigval = 0.035544671734112
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.97199291357236
lambda[   2] =  -0.73900264359441
lambda[   3] =  -0.45308973324140
lambda[   4] =  -0.45202570765096
lambda[   5] =  -0.38972952078073
lambda[   6] =  -0.24670060334387
lambda[   7] =  -0.22354968465106
lambda[   8] =  -0.03608753724597
lambda[   9] =  -0.01639728510647
lambda[  10] =   0.01382304175785
lambda[  11] =   0.01769865679547
lambda[  12] =   0.02511029465710
lambda[  13] =   0.03554467173411
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.533 ms
rank =  0, subspace rotation using ScaLAPACK took 3.326 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.334 ms

Total time for subspace rotation: 3.335 ms
rank = 0, Efermi =  -0.065469987382 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.472 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.039 ms
rank = 0, Calculating density took 1116.159 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.248 ms
rank = 0, D2D took 0.402 ms
rank = 0, Transfering density took 0.405 ms
Etot    =   -28.643170108843
Eband   =    -6.952181614237
E1      =    15.348732502874
E2      =    -6.804756847356
E3      =    -9.379222413252
Exc     =    -8.276302781709
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.452e-05, dEband = 5.614e-03
rank = 0, Calculating/Estimating energy took 1.100 ms, Etot = -28.643170109, dEtot = 1.452e-05, dEband = 5.614e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2406672289920, which took 0.058 ms

iter_count = 108, r_2norm = 8.275e-06, tol*||rhs|| = 9.627e-06

Anderson update took 57.861 ms, out of which F'*F took 27.056 ms; b-Ax took 184.131 ms, out of which Lap took 164.876 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.901 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571383, int_b + int_rho = -8.913e-14, checking this took 0.130 ms
2-norm of RHS = 558.2006484087353, which took 0.160 ms

iter_count = 222, r_2norm = 4.616e-04, tol*||rhs|| = 5.582e-04

Anderson update took 117.892 ms, out of which F'*F took 55.865 ms; b-Ax took 378.657 ms, out of which Lap took 339.223 ms
Solving Poisson took 798.031 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.119 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.222245 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.193868 
Total time for convolution: 	 convolve: 5.187511 
Total time for convolution: 	 convolve: 5.257406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.832 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 0.340 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.360 ms

This SCF took 27250.351 ms, scf error = 1.378e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.135545, lowerbound = -0.971993, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.433 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.744 ms
rank =  0, finding HY took 18.105 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.551 ms
Rank 0, Project_Hamiltonian used 23.906 ms
Total time for projection: 23.920 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.119 ms
    first calculated eigval = -0.970631576965373
    last  calculated eigval = 0.033747564109673
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.97063157696537
lambda[   2] =  -0.73765333518187
lambda[   3] =  -0.45179664436269
lambda[   4] =  -0.45073009369015
lambda[   5] =  -0.38833947450989
lambda[   6] =  -0.24543291854402
lambda[   7] =  -0.22207550129855
lambda[   8] =  -0.03509100435244
lambda[   9] =  -0.01523227853458
lambda[  10] =   0.01340931835372
lambda[  11] =   0.01809030555102
lambda[  12] =   0.02543638773483
lambda[  13] =   0.03374756410967
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.137 ms
rank =  0, subspace rotation using ScaLAPACK took 3.072 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.077 ms

Total time for subspace rotation: 3.078 ms
rank = 0, Efermi =  -0.064473454562 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 1.536 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1114.260 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.453 ms
rank = 0, Transfering density took 0.456 ms
Etot    =   -28.643256378631
Eband   =    -6.933319089657
E1      =    15.338344744094
E2      =    -6.795685357942
E3      =    -9.381382616151
Exc     =    -8.277952530782
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.725e-05, dEband = 3.773e-03
rank = 0, Calculating/Estimating energy took 1.002 ms, Etot = -28.643256379, dEtot = 1.725e-05, dEband = 3.773e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1381712343215, which took 0.055 ms

iter_count = 114, r_2norm = 3.411e-06, tol*||rhs|| = 5.527e-06

Anderson update took 61.329 ms, out of which F'*F took 28.615 ms; b-Ax took 194.462 ms, out of which Lap took 174.104 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.382 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571383, int_b + int_rho = -8.913e-14, checking this took 0.127 ms
2-norm of RHS = 558.2168749074118, which took 0.133 ms

iter_count = 210, r_2norm = 4.888e-04, tol*||rhs|| = 5.582e-04

Anderson update took 111.518 ms, out of which F'*F took 52.617 ms; b-Ax took 356.797 ms, out of which Lap took 319.853 ms
Solving Poisson took 754.457 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.174808 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.234115 
Total time for convolution: 	 convolve: 5.191049 
Total time for convolution: 	 convolve: 5.170942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.855 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.560 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.326 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.344 ms

This SCF took 27290.730 ms, scf error = 9.198e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.133748, lowerbound = -0.970632, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.498 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.740 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 3.791 ms
rank =  0, finding HY took 18.289 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.375 ms
Rank 0, Project_Hamiltonian used 24.477 ms
Total time for projection: 24.500 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.969896010191262
    last  calculated eigval = 0.032981105125084
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96989601019126
lambda[   2] =  -0.73690947493282
lambda[   3] =  -0.45105921639659
lambda[   4] =  -0.44994615078241
lambda[   5] =  -0.38759816428720
lambda[   6] =  -0.24469474318628
lambda[   7] =  -0.22134189756303
lambda[   8] =  -0.03352453588231
lambda[   9] =  -0.01348189399882
lambda[  10] =   0.01347354586843
lambda[  11] =   0.01954172966135
lambda[  12] =   0.02626473624887
lambda[  13] =   0.03298110512508
==subpsace eigenproblem: bcast eigvals took 0.062 ms
Total time for solving subspace eigenvalue problem: 0.184 ms
rank =  0, subspace rotation using ScaLAPACK took 3.048 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.053 ms

Total time for subspace rotation: 3.054 ms
rank = 0, Efermi =  -0.062906986083 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.494 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.876 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
rank = 0, D2D took 0.467 ms
rank = 0, Transfering density took 0.477 ms
Etot    =   -28.643339664353
Eband   =    -6.922891315206
E1      =    15.333935807539
E2      =    -6.789540535675
E3      =    -9.381707415135
Exc     =    -8.278234631117
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.666e-05, dEband = 2.086e-03
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -28.643339664, dEtot = 1.666e-05, dEband = 2.086e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0738972354668, which took 0.053 ms

iter_count = 114, r_2norm = 1.837e-06, tol*||rhs|| = 2.956e-06

Anderson update took 61.112 ms, out of which F'*F took 28.769 ms; b-Ax took 194.596 ms, out of which Lap took 174.157 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.706 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571377, int_b + int_rho = -1.437e-13, checking this took 0.120 ms
2-norm of RHS = 558.2133099750811, which took 0.124 ms

iter_count = 210, r_2norm = 5.015e-04, tol*||rhs|| = 5.582e-04

Anderson update took 111.532 ms, out of which F'*F took 52.821 ms; b-Ax took 358.318 ms, out of which Lap took 320.884 ms
Solving Poisson took 755.164 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.177 ms
Total time for convolution: 	 convolve: 5.222591 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.209500 
Total time for convolution: 	 convolve: 5.170230 
Total time for convolution: 	 convolve: 5.208476 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.061 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.194 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.318 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.336 ms

This SCF took 27127.517 ms, scf error = 6.197e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.132981, lowerbound = -0.969896, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1085.663 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.009 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.708 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 2.746 ms
rank =  0, finding HY took 18.151 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.343 ms
Rank 0, Project_Hamiltonian used 23.267 ms
Total time for projection: 23.281 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.968656920214689
    last  calculated eigval = 0.034064215254525
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96865692021469
lambda[   2] =  -0.73576841923346
lambda[   3] =  -0.44988720645102
lambda[   4] =  -0.44879862814410
lambda[   5] =  -0.38641969313583
lambda[   6] =  -0.24349048433118
lambda[   7] =  -0.22022501835261
lambda[   8] =  -0.02999359494243
lambda[   9] =  -0.00927351764669
lambda[  10] =   0.01418446472743
lambda[  11] =   0.02364401090740
lambda[  12] =   0.02852435160537
lambda[  13] =   0.03406421525453
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.131 ms
rank =  0, subspace rotation using ScaLAPACK took 3.048 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.055 ms

Total time for subspace rotation: 3.055 ms
rank = 0, Efermi =  -0.059376045135 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 1.527 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1114.102 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
rank = 0, D2D took 0.424 ms
rank = 0, Transfering density took 0.428 ms
Etot    =   -28.643392255850
Eband   =    -6.906492740197
E1      =    15.325625521986
E2      =    -6.781171079803
E3      =    -9.383057236546
Exc     =    -8.279355877610
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.052e-05, dEband = 3.280e-03
rank = 0, Calculating/Estimating energy took 1.014 ms, Etot = -28.643392256, dEtot = 1.052e-05, dEband = 3.280e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0638823290802, which took 0.069 ms

iter_count = 108, r_2norm = 2.459e-06, tol*||rhs|| = 2.555e-06

Anderson update took 57.935 ms, out of which F'*F took 27.181 ms; b-Ax took 184.449 ms, out of which Lap took 165.105 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.954 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571383, int_b + int_rho = -8.185e-14, checking this took 0.122 ms
2-norm of RHS = 558.2180363406233, which took 0.149 ms

iter_count = 174, r_2norm = 5.096e-04, tol*||rhs|| = 5.582e-04

Anderson update took 92.288 ms, out of which F'*F took 43.707 ms; b-Ax took 298.168 ms, out of which Lap took 267.451 ms
Solving Poisson took 627.451 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.910 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.163510 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 21.679 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.336 ms
Total time for convolution: 	 convolve: 5.164702 
Total time for convolution: 	 convolve: 5.232209 
Total time for convolution: 	 convolve: 5.199534 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.868 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.090 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.369 ms

This SCF took 26969.241 ms, scf error = 3.605e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.134064, lowerbound = -0.968657, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1096.922 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.715 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.055 ms
rank =  0, Distribute data + matrix mult took 2.775 ms
rank =  0, finding HY took 18.096 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.352 ms
Rank 0, Project_Hamiltonian used 23.246 ms
Total time for projection: 23.303 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.021 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.968190995789760
    last  calculated eigval = 0.034103545129199
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96819099578976
lambda[   2] =  -0.73531174885947
lambda[   3] =  -0.44943941274389
lambda[   4] =  -0.44835608949647
lambda[   5] =  -0.38597809973153
lambda[   6] =  -0.24304371357688
lambda[   7] =  -0.21980333101216
lambda[   8] =  -0.02909500001868
lambda[   9] =  -0.00789538236919
lambda[  10] =   0.01435707158576
lambda[  11] =   0.02419134942297
lambda[  12] =   0.02903421977385
lambda[  13] =   0.03410354512920
==subpsace eigenproblem: bcast eigvals took 0.083 ms
Total time for solving subspace eigenvalue problem: 0.208 ms
rank =  0, subspace rotation using ScaLAPACK took 3.096 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.101 ms

Total time for subspace rotation: 3.102 ms
rank = 0, Efermi =  -0.058477450167 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.491 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1125.214 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
rank = 0, D2D took 0.468 ms
rank = 0, Transfering density took 0.478 ms
Etot    =   -28.643441331138
Eband   =    -6.900246782878
E1      =    15.322431118726
E2      =    -6.777949144323
E3      =    -9.383671127814
Exc     =    -8.279848462745
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 9.815e-06, dEband = 1.249e-03
rank = 0, Calculating/Estimating energy took 0.986 ms, Etot = -28.643441331, dEtot = 9.815e-06, dEband = 1.249e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0422625909778, which took 0.072 ms

iter_count = 108, r_2norm = 1.228e-06, tol*||rhs|| = 1.691e-06

Anderson update took 57.949 ms, out of which F'*F took 27.132 ms; b-Ax took 184.096 ms, out of which Lap took 164.789 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.508 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571384, int_b + int_rho = -7.094e-14, checking this took 0.113 ms
2-norm of RHS = 558.2349144633405, which took 0.140 ms

iter_count = 180, r_2norm = 5.339e-04, tol*||rhs|| = 5.582e-04

Anderson update took 95.664 ms, out of which F'*F took 45.334 ms; b-Ax took 312.031 ms, out of which Lap took 280.081 ms
Solving Poisson took 652.016 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.545 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.204254 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.202005 
Total time for convolution: 	 convolve: 5.198938 
Total time for convolution: 	 convolve: 5.187969 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.086 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
---Transfer Veff_loc: D2D took 0.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.354 ms

This SCF took 27024.339 ms, scf error = 2.660e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134104, lowerbound = -0.968191, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1086.568 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.705 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.167 ms
rank =  0, Distribute data + matrix mult took 2.877 ms
rank =  0, finding HY took 18.293 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.327 ms
Rank 0, Project_Hamiltonian used 23.523 ms
Total time for projection: 23.546 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.089 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.115 ms
    first calculated eigval = -0.967914901928535
    last  calculated eigval = 0.036242074796882
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96791490192854
lambda[   2] =  -0.73498209044511
lambda[   3] =  -0.44914097488671
lambda[   4] =  -0.44801918953975
lambda[   5] =  -0.38570309708707
lambda[   6] =  -0.24277763024443
lambda[   7] =  -0.21951161924497
lambda[   8] =  -0.02704713640913
lambda[   9] =  -0.00570321204481
lambda[  10] =   0.01478105601058
lambda[  11] =   0.02633263889938
lambda[  12] =   0.03077982912118
lambda[  13] =   0.03624207479688
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 3.058 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.065 ms

Total time for subspace rotation: 3.066 ms
rank = 0, Efermi =  -0.056429586617 calculate fermi energy took 0.048 ms
rank = 0, --- Calculate rho: sum over local bands took 1.554 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1114.991 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
rank = 0, D2D took 0.443 ms
rank = 0, Transfering density took 0.447 ms
Etot    =   -28.643495301321
Eband   =    -6.896099007178
E1      =    15.320900800016
E2      =    -6.775324990851
E3      =    -9.383572108719
Exc     =    -8.279796717351
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.079e-05, dEband = 8.296e-04
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -28.643495301, dEtot = 1.079e-05, dEband = 8.296e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0405439755997, which took 0.055 ms

iter_count = 108, r_2norm = 1.359e-06, tol*||rhs|| = 1.622e-06

Anderson update took 57.895 ms, out of which F'*F took 27.168 ms; b-Ax took 184.124 ms, out of which Lap took 164.802 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.318 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571387, int_b + int_rho = -4.366e-14, checking this took 0.948 ms
2-norm of RHS = 558.2328890083171, which took 0.118 ms

iter_count = 120, r_2norm = 5.089e-04, tol*||rhs|| = 5.582e-04

Anderson update took 63.447 ms, out of which F'*F took 30.200 ms; b-Ax took 204.329 ms, out of which Lap took 183.100 ms
Solving Poisson took 432.538 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.260646 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.187300 
Total time for convolution: 	 convolve: 5.326802 
Total time for convolution: 	 convolve: 5.283907 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.857 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.265 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27082.566 ms, scf error = 2.736e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.136242, lowerbound = -0.967915, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.547 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.707 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.736 ms
rank =  0, finding HY took 18.210 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.317 ms
Rank 0, Project_Hamiltonian used 23.285 ms
Total time for projection: 23.299 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -0.967837887847085
    last  calculated eigval = 0.036364762270514
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96783788784708
lambda[   2] =  -0.73490717653230
lambda[   3] =  -0.44906841678191
lambda[   4] =  -0.44794720132122
lambda[   5] =  -0.38562364735451
lambda[   6] =  -0.24269948025128
lambda[   7] =  -0.21943172559740
lambda[   8] =  -0.02674137218630
lambda[   9] =  -0.00545820735906
lambda[  10] =   0.01487270422130
lambda[  11] =   0.02652310038330
lambda[  12] =   0.03088931485922
lambda[  13] =   0.03636476227051
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 3.075 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.080 ms

Total time for subspace rotation: 3.081 ms
rank = 0, Efermi =  -0.056123822443 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.502 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1115.697 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
rank = 0, D2D took 0.428 ms
rank = 0, Transfering density took 0.431 ms
Etot    =   -28.643501353856
Eband   =    -6.895031071792
E1      =    15.320290296348
E2      =    -6.774835634642
E3      =    -9.383706843249
Exc     =    -8.279905579924
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.211e-06, dEband = 2.136e-04
rank = 0, Calculating/Estimating energy took 1.039 ms, Etot = -28.643501354, dEtot = 1.211e-06, dEband = 2.136e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0423607038937, which took 0.056 ms

iter_count = 108, r_2norm = 1.369e-06, tol*||rhs|| = 1.694e-06

Anderson update took 57.878 ms, out of which F'*F took 27.151 ms; b-Ax took 184.059 ms, out of which Lap took 164.873 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.300 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571382, int_b + int_rho = -1.000e-13, checking this took 0.134 ms
2-norm of RHS = 558.2311825616919, which took 0.141 ms

iter_count = 120, r_2norm = 5.104e-04, tol*||rhs|| = 5.582e-04

Anderson update took 64.004 ms, out of which F'*F took 30.203 ms; b-Ax took 204.748 ms, out of which Lap took 183.274 ms
Solving Poisson took 432.988 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.082 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
Total time for convolution: 	 convolve: 5.188301 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.440 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.343 ms
Total time for convolution: 	 convolve: 5.234625 
Total time for convolution: 	 convolve: 5.247412 
Total time for convolution: 	 convolve: 5.271390 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.860 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.292 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.329 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.347 ms

This SCF took 26980.753 ms, scf error = 2.291e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.136365, lowerbound = -0.967838, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.633 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.867 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 2.906 ms
rank =  0, finding HY took 18.150 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.337 ms
Rank 0, Project_Hamiltonian used 23.416 ms
Total time for projection: 23.439 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.020 ms
rank = 0, Solve_Generalized_EigenProblem used 0.099 ms
    first calculated eigval = -0.967744581519427
    last  calculated eigval = 0.036612291192898
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96774458151943
lambda[   2] =  -0.73482262907649
lambda[   3] =  -0.44898207543694
lambda[   4] =  -0.44786604796544
lambda[   5] =  -0.38553226465917
lambda[   6] =  -0.24260762245125
lambda[   7] =  -0.21934520385388
lambda[   8] =  -0.02653602808515
lambda[   9] =  -0.00536439029765
lambda[  10] =   0.01500624111346
lambda[  11] =   0.02660988521719
lambda[  12] =   0.03092806512875
lambda[  13] =   0.03661229119290
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.119 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.125 ms

Total time for subspace rotation: 3.126 ms
rank = 0, Efermi =  -0.055918478236 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.530 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1118.044 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
rank = 0, D2D took 0.456 ms
rank = 0, Transfering density took 0.459 ms
Etot    =   -28.643509949391
Eband   =    -6.893800850342
E1      =    15.319595297871
E2      =    -6.774259786731
E3      =    -9.383858117047
Exc     =    -8.280024824320
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.719e-06, dEband = 2.460e-04
rank = 0, Calculating/Estimating energy took 0.987 ms, Etot = -28.643509949, dEtot = 1.719e-06, dEband = 2.460e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0409817360079, which took 0.056 ms

iter_count = 108, r_2norm = 1.102e-06, tol*||rhs|| = 1.639e-06

Anderson update took 57.720 ms, out of which F'*F took 27.058 ms; b-Ax took 184.521 ms, out of which Lap took 165.057 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.725 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571382, int_b + int_rho = -9.641e-14, checking this took 0.100 ms
2-norm of RHS = 558.2318310659663, which took 0.084 ms

iter_count = 150, r_2norm = 4.783e-04, tol*||rhs|| = 5.582e-04

Anderson update took 79.225 ms, out of which F'*F took 37.418 ms; b-Ax took 256.121 ms, out of which Lap took 228.793 ms
Solving Poisson took 540.827 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.262 ms
Total time for convolution: 	 convolve: 5.293339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.239206 
Total time for convolution: 	 convolve: 5.257700 
Total time for convolution: 	 convolve: 5.211755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.613 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.320 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.338 ms

This SCF took 27265.204 ms, scf error = 1.910e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136612, lowerbound = -0.967745, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.084 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.810 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.843 ms
rank =  0, finding HY took 18.164 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.367 ms
Rank 0, Project_Hamiltonian used 23.424 ms
Total time for projection: 23.443 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.112 ms
    first calculated eigval = -0.967515937751352
    last  calculated eigval = 0.038162184959252
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96751593775135
lambda[   2] =  -0.73461231148931
lambda[   3] =  -0.44876511607388
lambda[   4] =  -0.44765839106561
lambda[   5] =  -0.38531243980827
lambda[   6] =  -0.24239264587610
lambda[   7] =  -0.21913587116960
lambda[   8] =  -0.02633618955315
lambda[   9] =  -0.00558722704421
lambda[  10] =   0.01553332750583
lambda[  11] =   0.02662310122767
lambda[  12] =   0.03097936675906
lambda[  13] =   0.03816218495925
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.133 ms
rank =  0, subspace rotation using ScaLAPACK took 3.062 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.067 ms

Total time for subspace rotation: 3.067 ms
rank = 0, Efermi =  -0.055718639816 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.516 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1117.378 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.476 ms
rank = 0, Transfering density took 0.478 ms
Etot    =   -28.643533901018
Eband   =    -6.890785426882
E1      =    15.318072285614
E2      =    -6.772682178772
E3      =    -9.384106688645
Exc     =    -8.280212150789
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 4.790e-06, dEband = 6.031e-04
rank = 0, Calculating/Estimating energy took 2.194 ms, Etot = -28.643533901, dEtot = 4.790e-06, dEband = 6.031e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0355634982535, which took 0.075 ms

iter_count = 108, r_2norm = 8.993e-07, tol*||rhs|| = 1.423e-06

Anderson update took 57.747 ms, out of which F'*F took 27.145 ms; b-Ax took 184.724 ms, out of which Lap took 165.077 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.239 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571387, int_b + int_rho = -4.547e-14, checking this took 0.107 ms
2-norm of RHS = 558.2354470153691, which took 0.130 ms

iter_count = 126, r_2norm = 4.993e-04, tol*||rhs|| = 5.582e-04

Anderson update took 66.557 ms, out of which F'*F took 31.672 ms; b-Ax took 215.672 ms, out of which Lap took 192.733 ms
Solving Poisson took 455.029 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.217736 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.372 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.256367 
Total time for convolution: 	 convolve: 5.237032 
Total time for convolution: 	 convolve: 5.333338 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.324 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.342 ms

This SCF took 27089.161 ms, scf error = 1.431e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.138162, lowerbound = -0.967516, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1115.516 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.712 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 2.741 ms
rank =  0, finding HY took 18.216 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.323 ms
Rank 0, Project_Hamiltonian used 23.307 ms
Total time for projection: 23.321 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.068 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.092 ms
    first calculated eigval = -0.967438803612232
    last  calculated eigval = 0.038634093700749
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96743880361223
lambda[   2] =  -0.73453817177918
lambda[   3] =  -0.44868782544953
lambda[   4] =  -0.44758187859812
lambda[   5] =  -0.38524105757185
lambda[   6] =  -0.24232133544322
lambda[   7] =  -0.21907079711124
lambda[   8] =  -0.02628770136297
lambda[   9] =  -0.00575194351655
lambda[  10] =   0.01604309600537
lambda[  11] =   0.02661175659032
lambda[  12] =   0.03083189433633
lambda[  13] =   0.03863409370075
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.076 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.081 ms

Total time for subspace rotation: 3.082 ms
rank = 0, Efermi =  -0.055670151529 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 1.639 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.027 ms
rank = 0, Calculating density took 1143.888 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
rank = 0, D2D took 0.466 ms
rank = 0, Transfering density took 0.473 ms
Etot    =   -28.643542497694
Eband   =    -6.889759739544
E1      =    15.317682036026
E2      =    -6.772034412056
E3      =    -9.384103684785
Exc     =    -8.280205414637
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.719e-06, dEband = 2.051e-04
rank = 0, Calculating/Estimating energy took 1.877 ms, Etot = -28.643542498, dEtot = 1.719e-06, dEband = 2.051e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0298930333948, which took 0.052 ms

iter_count = 108, r_2norm = 8.468e-07, tol*||rhs|| = 1.196e-06

Anderson update took 57.825 ms, out of which F'*F took 27.038 ms; b-Ax took 184.782 ms, out of which Lap took 165.134 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.999 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571383, int_b + int_rho = -8.185e-14, checking this took 0.102 ms
2-norm of RHS = 558.2359770516221, which took 0.130 ms

iter_count = 126, r_2norm = 5.387e-04, tol*||rhs|| = 5.582e-04

Anderson update took 66.617 ms, out of which F'*F took 31.398 ms; b-Ax took 215.031 ms, out of which Lap took 192.221 ms
Solving Poisson took 454.782 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Total time for convolution: 	 convolve: 5.243248 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.202179 
Total time for convolution: 	 convolve: 5.224663 
Total time for convolution: 	 convolve: 5.203680 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.301 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.023 ms
======D2D: initiated sending and receiving took 0.322 ms
---Transfer Veff_loc: D2D took 0.418 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.437 ms

This SCF took 26940.032 ms, scf error = 1.591e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.138634, lowerbound = -0.967439, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.585 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.714 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 2.752 ms
rank =  0, finding HY took 18.324 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.353 ms
Rank 0, Project_Hamiltonian used 23.454 ms
Total time for projection: 23.472 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.023 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.967310260938081
    last  calculated eigval = 0.039908591575857
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96731026093808
lambda[   2] =  -0.73441231740083
lambda[   3] =  -0.44856291564087
lambda[   4] =  -0.44745907895444
lambda[   5] =  -0.38511226123837
lambda[   6] =  -0.24219102900351
lambda[   7] =  -0.21894983932830
lambda[   8] =  -0.02607575676326
lambda[   9] =  -0.00593017072105
lambda[  10] =   0.01750681712750
lambda[  11] =   0.02680290821184
lambda[  12] =   0.03092176376561
lambda[  13] =   0.03990859157586
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.132 ms
rank =  0, subspace rotation using ScaLAPACK took 3.055 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.061 ms

Total time for subspace rotation: 3.062 ms
rank = 0, Efermi =  -0.055458206990 calculate fermi energy took 0.052 ms
rank = 0, --- Calculate rho: sum over local bands took 1.447 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1116.844 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
rank = 0, D2D took 0.420 ms
rank = 0, Transfering density took 0.428 ms
Etot    =   -28.643552474701
Eband   =    -6.887995405419
E1      =    15.316799729991
E2      =    -6.771106615648
E3      =    -9.384261180722
Exc     =    -8.280327119265
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.995e-06, dEband = 3.529e-04
rank = 0, Calculating/Estimating energy took 2.151 ms, Etot = -28.643552475, dEtot = 1.995e-06, dEband = 3.529e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0366650997552, which took 0.054 ms

iter_count = 102, r_2norm = 1.417e-06, tol*||rhs|| = 1.467e-06

Anderson update took 54.595 ms, out of which F'*F took 25.458 ms; b-Ax took 174.243 ms, out of which Lap took 155.893 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.201 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571378, int_b + int_rho = -1.346e-13, checking this took 0.113 ms
2-norm of RHS = 558.2389428205677, which took 0.122 ms

iter_count = 102, r_2norm = 5.286e-04, tol*||rhs|| = 5.582e-04

Anderson update took 53.875 ms, out of which F'*F took 25.631 ms; b-Ax took 175.153 ms, out of which Lap took 156.273 ms
Solving Poisson took 368.896 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Total time for convolution: 	 convolve: 5.282270 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.229926 
Total time for convolution: 	 convolve: 5.210239 
Total time for convolution: 	 convolve: 5.241589 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.421 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.335 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.358 ms

This SCF took 27725.603 ms, scf error = 1.451e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.139909, lowerbound = -0.967310, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1087.687 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.703 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.024 ms
rank =  0, Distribute data + matrix mult took 2.732 ms
rank =  0, finding HY took 18.186 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.348 ms
Rank 0, Project_Hamiltonian used 23.291 ms
Total time for projection: 23.312 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.029 ms
rank = 0, Solve_Generalized_EigenProblem used 0.118 ms
    first calculated eigval = -0.967440575772448
    last  calculated eigval = 0.040286398633909
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96744057577245
lambda[   2] =  -0.73452622554324
lambda[   3] =  -0.44867981144107
lambda[   4] =  -0.44756012549741
lambda[   5] =  -0.38522943208703
lambda[   6] =  -0.24230998637626
lambda[   7] =  -0.21905562211857
lambda[   8] =  -0.02554580356326
lambda[   9] =  -0.00547127746868
lambda[  10] =   0.01710777664400
lambda[  11] =   0.02746302889729
lambda[  12] =   0.03111737934809
lambda[  13] =   0.04028639863391
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.139 ms
rank =  0, subspace rotation using ScaLAPACK took 3.027 ms
rank =  0, Distributing orbital back into band + domain format took 0.001 ms
rank = 0, Subspace_Rotation used 3.039 ms

Total time for subspace rotation: 3.040 ms
rank = 0, Efermi =  -0.054928253735 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.335 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1160.391 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
rank = 0, D2D took 0.405 ms
rank = 0, Transfering density took 0.412 ms
Etot    =   -28.643545473004
Eband   =    -6.889603558073
E1      =    15.317848156679
E2      =    -6.771754419732
E3      =    -9.383924455103
Exc     =    -8.280071470065
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.400e-06, dEband = 3.216e-04
rank = 0, Calculating/Estimating energy took 0.929 ms, Etot = -28.643545473, dEtot = 1.400e-06, dEband = 3.216e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0387527676524, which took 0.089 ms

iter_count = 102, r_2norm = 1.111e-06, tol*||rhs|| = 1.550e-06

Anderson update took 54.745 ms, out of which F'*F took 25.623 ms; b-Ax took 174.792 ms, out of which Lap took 156.028 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.998 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571380, int_b + int_rho = -1.182e-13, checking this took 0.106 ms
2-norm of RHS = 558.2380106796480, which took 0.082 ms

iter_count = 132, r_2norm = 5.369e-04, tol*||rhs|| = 5.582e-04

Anderson update took 69.715 ms, out of which F'*F took 32.892 ms; b-Ax took 225.547 ms, out of which Lap took 201.535 ms
Solving Poisson took 476.485 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.238339 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.223192 
Total time for convolution: 	 convolve: 5.256734 
Total time for convolution: 	 convolve: 5.242002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.328 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.346 ms

This SCF took 27053.274 ms, scf error = 2.318e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.140286, lowerbound = -0.967441, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1089.092 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.014 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.693 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 2.723 ms
rank =  0, finding HY took 18.218 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.347 ms
Rank 0, Project_Hamiltonian used 23.322 ms
Total time for projection: 23.395 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.067 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.019 ms
rank = 0, Solve_Generalized_EigenProblem used 0.090 ms
    first calculated eigval = -0.967290745656403
    last  calculated eigval = 0.038783039543708
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96729074565640
lambda[   2] =  -0.73439672400063
lambda[   3] =  -0.44854423361108
lambda[   4] =  -0.44744798190834
lambda[   5] =  -0.38510661042998
lambda[   6] =  -0.24218026720615
lambda[   7] =  -0.21895380126320
lambda[   8] =  -0.02684707525722
lambda[   9] =  -0.00665583849352
lambda[  10] =   0.01776714372010
lambda[  11] =   0.02583071155206
lambda[  12] =   0.02996988706386
lambda[  13] =   0.03878303954371
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.043 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 3.051 ms

Total time for subspace rotation: 3.052 ms
rank = 0, Efermi =  -0.056229525437 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 1.509 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.025 ms
rank = 0, Calculating density took 1117.352 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.250 ms
rank = 0, D2D took 0.401 ms
rank = 0, Transfering density took 0.404 ms
Etot    =   -28.643556895275
Eband   =    -6.887840728573
E1      =    15.316711885871
E2      =    -6.771030233558
E3      =    -9.384272412685
Exc     =    -8.280333222437
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 2.284e-06, dEband = 3.526e-04
rank = 0, Calculating/Estimating energy took 1.374 ms, Etot = -28.643556895, dEtot = 2.284e-06, dEband = 3.526e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0341312674214, which took 0.053 ms

iter_count = 96, r_2norm = 1.346e-06, tol*||rhs|| = 1.365e-06

Anderson update took 51.565 ms, out of which F'*F took 23.973 ms; b-Ax took 163.877 ms, out of which Lap took 146.738 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 353.844 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571390, int_b + int_rho = -1.637e-14, checking this took 0.103 ms
2-norm of RHS = 558.2396665950682, which took 0.132 ms

iter_count = 132, r_2norm = 5.210e-04, tol*||rhs|| = 5.582e-04

Anderson update took 69.621 ms, out of which F'*F took 33.222 ms; b-Ax took 226.604 ms, out of which Lap took 202.256 ms
Solving Poisson took 476.321 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Total time for convolution: 	 convolve: 5.267466 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.298274 
Total time for convolution: 	 convolve: 5.286228 
Total time for convolution: 	 convolve: 5.244285 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.875 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.331 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 27113.059 ms, scf error = 1.357e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.138783, lowerbound = -0.967291, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1091.015 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.822 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.031 ms
rank =  0, Distribute data + matrix mult took 2.860 ms
rank =  0, finding HY took 18.149 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.386 ms
Rank 0, Project_Hamiltonian used 23.422 ms
Total time for projection: 23.438 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.022 ms
rank = 0, Solve_Generalized_EigenProblem used 0.109 ms
    first calculated eigval = -0.967319012182125
    last  calculated eigval = 0.040473127943257
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96731901218212
lambda[   2] =  -0.73440535444358
lambda[   3] =  -0.44856155829248
lambda[   4] =  -0.44745337328431
lambda[   5] =  -0.38512910849068
lambda[   6] =  -0.24220449409430
lambda[   7] =  -0.21896815192053
lambda[   8] =  -0.02663331383186
lambda[   9] =  -0.00693616472403
lambda[  10] =   0.01966101432206
lambda[  11] =   0.02596615631059
lambda[  12] =   0.03027727351219
lambda[  13] =   0.04047312794326
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.124 ms
rank =  0, subspace rotation using ScaLAPACK took 2.979 ms
rank =  0, Distributing orbital back into band + domain format took 0.000 ms
rank = 0, Subspace_Rotation used 2.986 ms

Total time for subspace rotation: 2.987 ms
rank = 0, Efermi =  -0.056015764106 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 1.545 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1119.262 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
rank = 0, D2D took 0.442 ms
rank = 0, Transfering density took 0.450 ms
Etot    =   -28.643563099480
Eband   =    -6.888082105835
E1      =    15.316907150471
E2      =    -6.771101505421
E3      =    -9.384146164150
Exc     =    -8.280238337308
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 1.241e-06, dEband = 4.828e-05
rank = 0, Calculating/Estimating energy took 1.343 ms, Etot = -28.643563099, dEtot = 1.241e-06, dEband = 4.828e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0259834352524, which took 0.064 ms

iter_count = 102, r_2norm = 7.842e-07, tol*||rhs|| = 1.039e-06

Anderson update took 54.742 ms, out of which F'*F took 25.445 ms; b-Ax took 174.238 ms, out of which Lap took 155.543 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.040 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571385, int_b + int_rho = -6.366e-14, checking this took 0.098 ms
2-norm of RHS = 558.2376122643317, which took 0.145 ms

iter_count = 90, r_2norm = 5.202e-04, tol*||rhs|| = 5.582e-04

Anderson update took 47.447 ms, out of which F'*F took 22.497 ms; b-Ax took 153.480 ms, out of which Lap took 137.340 ms
Solving Poisson took 325.566 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.231393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.210809 
Total time for convolution: 	 convolve: 5.291312 
Total time for convolution: 	 convolve: 5.229291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.006 ms
======D2D: initiated sending and receiving took 0.861 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.614 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.364 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.316 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.335 ms

This SCF took 26848.118 ms, scf error = 1.498e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.140473, lowerbound = -0.967319, upperbound = 267.570808

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (13 columns, degree = 45): 1088.139 ms
New BLOCK CYCLIC DOMAIN: nproc = 1, dims = (1, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 0.000 ms
rank = 0, STARTING DSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.718 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.062 ms
rank =  0, Distribute data + matrix mult took 2.784 ms
rank =  0, finding HY took 18.298 ms
rank =  0, distributing HY into block cyclic form took 0.000 ms
rank =  0, finding Y'*HY took 2.336 ms
Rank 0, Project_Hamiltonian used 23.444 ms
Total time for projection: 23.458 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.024 ms
rank = 0, Solve_Generalized_EigenProblem used 0.136 ms
    first calculated eigval = -0.967248155855010
    last  calculated eigval = 0.040482097401491
The last 13 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 14):
lambda[   1] =  -0.96724815585501
lambda[   2] =  -0.73434733592319
lambda[   3] =  -0.44849912358034
lambda[   4] =  -0.44740152558457
lambda[   5] =  -0.38506789541808
lambda[   6] =  -0.24214053913671
lambda[   7] =  -0.21891488056472
lambda[   8] =  -0.02670241109711
lambda[   9] =  -0.00706013212324
lambda[  10] =   0.02014257164089
lambda[  11] =   0.02581350823624
lambda[  12] =   0.03016570992860
lambda[  13] =   0.04048209740149
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.158 ms
rank =  0, subspace rotation using ScaLAPACK took 3.049 ms
rank =  0, Distributing orbital back into band + domain format took 0.002 ms
rank = 0, Subspace_Rotation used 3.062 ms

Total time for subspace rotation: 3.063 ms
rank = 0, Efermi =  -0.056084861372 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.524 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.000 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.026 ms
rank = 0, Calculating density took 1116.528 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, D2D took 0.465 ms
rank = 0, Transfering density took 0.473 ms
Etot    =   -28.643564785397
Eband   =    -6.887238912545
E1      =    15.316339123328
E2      =    -6.770783837997
E3      =    -9.384320051741
Exc     =    -8.280371409540
Esc     =   -44.947397475903
Entropy =    -0.000000000475
dE = 3.372e-07, dEband = 1.686e-04
rank = 0, Calculating/Estimating energy took 1.281 ms, Etot = -28.643564785, dEtot = 3.372e-07, dEband = 1.686e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0165903337859, which took 0.068 ms

iter_count = 108, r_2norm = 4.252e-07, tol*||rhs|| = 6.636e-07

Anderson update took 57.866 ms, out of which F'*F took 26.952 ms; b-Ax took 183.833 ms, out of which Lap took 164.257 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.859 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -14.00000001571392, int_rho =  14.00000001571386, int_b + int_rho = -5.457e-14, checking this took 0.107 ms
2-norm of RHS = 558.2346828999526, which took 0.079 ms

iter_count = 102, r_2norm = 4.940e-04, tol*||rhs|| = 5.582e-04

Anderson update took 54.015 ms, out of which F'*F took 25.481 ms; b-Ax took 174.287 ms, out of which Lap took 155.485 ms
Solving Poisson took 368.194 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.221626 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.252095 
Total time for convolution: 	 convolve: 5.239924 
Total time for convolution: 	 convolve: 5.241428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.594 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.013 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 0.321 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 85000) to all bandcomms took 0.002 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.348 ms

This SCF took 26910.523 ms, scf error = 9.283e-05
The last 13 occupations of kpoints #1 are (Nelectron = 14):
lambda[   1] =  -0.96724815585501, occ[   1] =   2.00000000000000
lambda[   2] =  -0.73434733592319, occ[   2] =   2.00000000000000
lambda[   3] =  -0.44849912358034, occ[   3] =   2.00000000000000
lambda[   4] =  -0.44740152558457, occ[   4] =   2.00000000000000
lambda[   5] =  -0.38506789541808, occ[   5] =   2.00000000000000
lambda[   6] =  -0.24214053913671, occ[   6] =   2.00000000000000
lambda[   7] =  -0.21891488056472, occ[   7] =   2.00000000000000
lambda[   8] =  -0.02670241109711, occ[   8] =   0.00000001571383
lambda[   9] =  -0.00706013212324, occ[   9] =   0.00000000000000
lambda[  10] =   0.02014257164089, occ[  10] =   0.00000000000000
lambda[  11] =   0.02581350823624, occ[  11] =   0.00000000000000
lambda[  12] =   0.03016570992860, occ[  12] =   0.00000000000000
lambda[  13] =   0.04048209740149, occ[  13] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 12 (90%) = 0.000000000000000.
Occupation of state 13 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.317 ms, time for Allreduce/Reduce: 5.759 ms 
Time for calculating local force components: 12.600 ms
Start Calculating nonlocal forces
force_nloc = 
  0.87596689664626   0.66820980409694   0.00000059576633
 -0.07463319240655   0.01615850901020   0.00000000396840
  0.03537157043362  -0.01551025724645  -0.05269782183058
  0.03537156492235  -0.01551023148236   0.05269777222394
 -0.72213026932518  -0.45211781375941  -0.00000113898186
force_loc = 
 -0.85302781494347  -0.64804006015111   0.00000112654850
  0.07968718111105  -0.01854081734660   0.00000044534205
 -0.03717474054139   0.01766480584809   0.05726166587859
 -0.03717346018278   0.01766360294418  -0.05725862444895
  0.70462234283368   0.43700875381706  -0.00000023708671
Time for calculating nonlocal force components: 19.704 ms
[32mforces_xc: 
[0m[32m -0.02605728231311  -0.02505788618593   0.00000011760814
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.01908368575178   0.01808022742594   0.00000002782270
[0mTime for calculating XC forces components: 16.240 ms
 Cartesian force = 
 -0.00309949700757  -0.00488986963421   0.00000105336086
  0.00507269230725  -0.00238403573051  -0.00000033725166
 -0.00178446650502   0.00215282120753   0.00456305748590
 -0.00178319165767   0.00215164406771  -0.00456163878711
  0.00159446286302   0.00296944008948  -0.00000213480799
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Time for printing density: 396.714 ms
The program took 602.547 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:38:51
Job ID:        2266975
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:03:00,vmem=8384K,walltime=00:10:15,mem=8164K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-19-2
---------------------------------------
