---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:44
Job ID:    2266455
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:48
Job ID:    2266455
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.057 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.016 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 77.510 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 5.727 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 102.852 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.952 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.089 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.000000	   11.804025	    7.222426	
   10.000000	    8.195975	    7.222426	
   10.000000	   10.000000	    8.156918	
   10.000000	   10.000000	   10.618248	
   10.000000	   10.000000	   12.777574	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.160 ms
Set up communicators.

--set up spincomm took 2.297 ms

--set up kptcomm took 0.358 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.008 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.013 ms

--set up blacscomm took 0.006 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 1.057 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.010 ms

Calculate_SplineDerivRadFun took 0.200 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.262 ms.
time spent on vectorized spline interp: 2.266 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.993 ms.
time spent on vectorized spline interp: 1.662 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.518 ms.
time spent on vectorized spline interp: 1.654 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.495 ms.

Calculating rb for all atom types took 14.860 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.032 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.013 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000075426, sum_int_rho = 15.7936496203322
PosCharge = 16.000000007543, NegCharge = -15.793649620332, scal_fac = 1.013065402372
After scaling, int_rho = 16.0000000075426, PosCharge + NegCharge - NetCharge = -2.132e-14
--Calculate Vref took 0.346 ms
--Calculate rho_guess took 2.010 ms

 integral of b = -16.0000000075426,
 int{b} + Nelectron + NetCharge = -7.543e-09,
 Esc = -46.3970105202668,
 MPI_Reduce took 3.519 ms

Calculating b & b_ref took 11.224 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.028 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.098 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.003 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.033 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.005 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.006 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.006 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 26.767 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754254, int_b + int_rho = -4.311e-13, checking this took 0.110 ms
2-norm of RHS = 554.9385908797125, which took 0.504 ms

iter_count = 420, r_2norm = 5.214e-04, tol*||rhs|| = 5.549e-04

Anderson update took 230.722 ms, out of which F'*F took 105.254 ms; b-Ax took 713.574 ms, out of which Lap took 640.829 ms
Solving Poisson took 1513.957 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.443 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
Total time for convolution: 	 convolve: 5.112348 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 30.651 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.008 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.138556 
Total time for convolution: 	 convolve: 5.100916 
Total time for convolution: 	 convolve: 5.107557 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.720 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.626 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.555 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.058 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.402 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
rank = 0, XC calculation took 24607.538 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.264 ms
---Transfer Veff_loc: D2D took 1.128 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.787 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.042 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.692 ms
    Lanczos iter 54, eigmin  = -1.061837381, eigmax = 264.925674413, err_eigmin = 1.055e-03, err_eigmax = 9.804e-03
rank =   0, Lanczos took 123.452 ms, eigmin = -1.061837381377, eigmax = 267.574931157285

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.206547, lowerbound = -1.161837, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1164.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 14.372 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.495 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.134 ms
rank =  0, Distribute data + matrix mult took 17.025 ms
rank =  0, finding HY took 18.951 ms
rank =  0, distributing HY into block cyclic form took 13.531 ms
rank =  0, finding Y'*HY took 2.058 ms
Rank 0, Project_Hamiltonian used 51.615 ms
Total time for projection: 51.626 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.377 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.459 ms
    first calculated eigval = 2.791107983222002
    last  calculated eigval = 3.189802927351684
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79110798322200
lambda[   2] =   2.82710523071051
lambda[   3] =   2.84626681114432
lambda[   4] =   2.90465487038149
lambda[   5] =   2.94778653504308
lambda[   6] =   2.97723098682031
lambda[   7] =   3.01949761060348
lambda[   8] =   3.05188145625393
lambda[   9] =   3.06704939918733
lambda[  10] =   3.08888044428052
lambda[  11] =   3.11579316734094
lambda[  12] =   3.13145649323988
lambda[  13] =   3.16002511599272
lambda[  14] =   3.18980292735168
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.490 ms
rank =  0, subspace rotation using ScaLAPACK took 3.300 ms
rank =  0, Distributing orbital back into band + domain format took 12.306 ms
rank = 0, Subspace_Rotation used 15.623 ms

Total time for subspace rotation: 15.626 ms
rank = 0, Efermi =   3.059465427649 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.289803, lowerbound = -1.161837, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1167.780 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.624 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.058 ms
rank =  0, Distribute data + matrix mult took 14.140 ms
rank =  0, finding HY took 18.211 ms
rank =  0, distributing HY into block cyclic form took 12.533 ms
rank =  0, finding Y'*HY took 2.167 ms
Rank 0, Project_Hamiltonian used 47.078 ms
Total time for projection: 47.084 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.918701369417400
    last  calculated eigval = 0.411133643938177
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.91870136941740
lambda[   2] =  -0.69358039670965
lambda[   3] =  -0.20028660622183
lambda[   4] =  -0.14781130897584
lambda[   5] =  -0.04142395954736
lambda[   6] =   0.12410261516777
lambda[   7] =   0.21445898742139
lambda[   8] =   0.24156443376673
lambda[   9] =   0.30561440178662
lambda[  10] =   0.32680853676390
lambda[  11] =   0.34138686789208
lambda[  12] =   0.38149738380524
lambda[  13] =   0.39113895095371
lambda[  14] =   0.41113364393818
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.362 ms
rank =  0, Distributing orbital back into band + domain format took 11.933 ms
rank = 0, Subspace_Rotation used 15.312 ms

Total time for subspace rotation: 15.315 ms
rank = 0, Efermi =   0.275590167923 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.511134, lowerbound = -1.161837, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1145.216 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.499 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.403 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 13.920 ms
rank =  0, finding HY took 18.230 ms
rank =  0, distributing HY into block cyclic form took 12.351 ms
rank =  0, finding Y'*HY took 2.225 ms
Rank 0, Project_Hamiltonian used 46.756 ms
Total time for projection: 46.781 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.390 ms
rank = 0, Solve_Generalized_EigenProblem used 0.458 ms
    first calculated eigval = -1.073810437242833
    last  calculated eigval = 0.117087241884724
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07381043724283
lambda[   2] =  -0.86426679272292
lambda[   3] =  -0.61271473697442
lambda[   4] =  -0.55147672610799
lambda[   5] =  -0.46820996548251
lambda[   6] =  -0.43952969302731
lambda[   7] =  -0.41214468962728
lambda[   8] =  -0.24334243032811
lambda[   9] =  -0.06680472147763
lambda[  10] =  -0.01041706231372
lambda[  11] =   0.06788786312609
lambda[  12] =   0.09479028225062
lambda[  13] =   0.11241471420756
lambda[  14] =   0.11708724188472
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.466 ms
rank =  0, subspace rotation using ScaLAPACK took 3.370 ms
rank =  0, Distributing orbital back into band + domain format took 11.975 ms
rank = 0, Subspace_Rotation used 15.359 ms

Total time for subspace rotation: 15.363 ms
rank = 0, Efermi =  -0.096835736523 calculate fermi energy took 0.020 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.217087, lowerbound = -1.161837, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1166.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.524 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.435 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.005 ms
rank =  0, Distribute data + matrix mult took 13.979 ms
rank =  0, finding HY took 18.220 ms
rank =  0, distributing HY into block cyclic form took 12.676 ms
rank =  0, finding Y'*HY took 2.116 ms
Rank 0, Project_Hamiltonian used 47.020 ms
Total time for projection: 47.025 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.052 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.073969212102273
    last  calculated eigval = 0.067928735408459
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.07396921210227
lambda[   2] =  -0.86463612783402
lambda[   3] =  -0.61963220620163
lambda[   4] =  -0.55636862658175
lambda[   5] =  -0.47466464887035
lambda[   6] =  -0.45532723078646
lambda[   7] =  -0.42119149047993
lambda[   8] =  -0.27769050393560
lambda[   9] =  -0.12513297839043
lambda[  10] =  -0.06367468784639
lambda[  11] =   0.02886012127836
lambda[  12] =   0.03891851421663
lambda[  13] =   0.06329675761505
lambda[  14] =   0.06792873540846
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.371 ms
rank =  0, Distributing orbital back into band + domain format took 12.021 ms
rank = 0, Subspace_Rotation used 15.406 ms

Total time for subspace rotation: 15.409 ms
rank = 0, Efermi =  -0.155163993258 calculate fermi energy took 0.020 ms
rank = 0, --- Calculate rho: sum over local bands took 2.095 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.091 ms
rank = 0, Calculating density took 5027.961 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.364 ms
rank = 0, D2D took 1.458 ms
rank = 0, Transfering density took 1.461 ms
Etot    =   -27.963399742393
Eband   =    -9.486960094528
E1      =    19.103237256901
E2      =    -7.886264155289
E3      =    -9.475148480256
Exc     =    -8.544079019811
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 5.593e+00, dEband = 1.897e+00
rank = 0, Calculating/Estimating energy took 0.883 ms, Etot = -27.963399742, dEtot = 5.593e+00, dEband = 1.897e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 41.5001864191719, which took 0.055 ms

iter_count = 96, r_2norm = 1.299e-03, tol*||rhs|| = 1.660e-03

Anderson update took 51.427 ms, out of which F'*F took 24.183 ms; b-Ax took 162.616 ms, out of which Lap took 145.361 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 349.291 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754258, int_b + int_rho = -3.965e-13, checking this took 0.138 ms
2-norm of RHS = 552.3228706723492, which took 0.114 ms

iter_count = 288, r_2norm = 4.578e-04, tol*||rhs|| = 5.523e-04

Anderson update took 154.624 ms, out of which F'*F took 72.592 ms; b-Ax took 486.840 ms, out of which Lap took 436.264 ms
Solving Poisson took 1033.550 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.810 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Total time for convolution: 	 convolve: 5.095587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.092704 
Total time for convolution: 	 convolve: 5.210176 
Total time for convolution: 	 convolve: 5.100948 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.305 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.561 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.201 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
---Transfer Veff_loc: D2D took 0.661 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.976 ms

This SCF took 31034.698 ms, scf error = 1.679e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.167929, lowerbound = -1.073969, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.771 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.589 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.053 ms
rank =  0, finding HY took 18.020 ms
rank =  0, distributing HY into block cyclic form took 12.488 ms
rank =  0, finding Y'*HY took 2.163 ms
Rank 0, Project_Hamiltonian used 46.754 ms
Total time for projection: 46.768 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.066883754998611
    last  calculated eigval = 0.045673859050246
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.06688375499861
lambda[   2] =  -0.83695696630767
lambda[   3] =  -0.57951968719062
lambda[   4] =  -0.52649732445966
lambda[   5] =  -0.46782547473682
lambda[   6] =  -0.44388486717159
lambda[   7] =  -0.40998614930633
lambda[   8] =  -0.24919507884743
lambda[   9] =  -0.12437935616124
lambda[  10] =  -0.06044933585250
lambda[  11] =   0.00526700546436
lambda[  12] =   0.02323388730114
lambda[  13] =   0.03054688712587
lambda[  14] =   0.04567385905025
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.439 ms
rank =  0, Distributing orbital back into band + domain format took 11.810 ms
rank = 0, Subspace_Rotation used 15.263 ms

Total time for subspace rotation: 15.267 ms
rank = 0, Efermi =  -0.154410371306 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.181 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.686 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.097 ms
rank = 0, Calculating density took 1182.570 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.043 ms
rank = 0, D2D took 1.145 ms
rank = 0, Transfering density took 1.148 ms
Etot    =   -27.919269774201
Eband   =    -9.161498606976
E1      =    18.807333913331
E2      =    -7.883628596674
E3      =    -9.566145196136
Exc     =    -8.617868352866
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 8.826e-03, dEband = 6.509e-02
rank = 0, Calculating/Estimating energy took 0.905 ms, Etot = -27.919269774, dEtot = 8.826e-03, dEband = 6.509e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 18.0846044551216, which took 0.059 ms

iter_count = 96, r_2norm = 7.184e-04, tol*||rhs|| = 7.234e-04

Anderson update took 51.225 ms, out of which F'*F took 24.210 ms; b-Ax took 162.714 ms, out of which Lap took 145.989 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 355.865 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754261, int_b + int_rho = -3.638e-13, checking this took 0.122 ms
2-norm of RHS = 548.8138975268797, which took 0.146 ms

iter_count = 294, r_2norm = 4.827e-04, tol*||rhs|| = 5.488e-04

Anderson update took 158.693 ms, out of which F'*F took 74.611 ms; b-Ax took 503.928 ms, out of which Lap took 453.706 ms
Solving Poisson took 1061.989 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.559 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.083324 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 19.609 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.083124 
Total time for convolution: 	 convolve: 5.078597 
Total time for convolution: 	 convolve: 5.095328 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.369 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.613 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.436 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
---Transfer Veff_loc: D2D took 0.698 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.030 ms

This SCF took 27167.932 ms, scf error = 1.081e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.145674, lowerbound = -1.066884, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1135.533 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.583 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.651 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.072 ms
rank =  0, Distribute data + matrix mult took 14.320 ms
rank =  0, finding HY took 19.470 ms
rank =  0, distributing HY into block cyclic form took 12.748 ms
rank =  0, finding Y'*HY took 2.079 ms
Rank 0, Project_Hamiltonian used 48.648 ms
Total time for projection: 48.666 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.044575162347598
    last  calculated eigval = 0.037341797631164
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.04457516234760
lambda[   2] =  -0.79754212663855
lambda[   3] =  -0.52689912182338
lambda[   4] =  -0.49207018035038
lambda[   5] =  -0.45038644374792
lambda[   6] =  -0.41575023974843
lambda[   7] =  -0.38116586675176
lambda[   8] =  -0.21240207208555
lambda[   9] =  -0.10874435373599
lambda[  10] =  -0.03969361878132
lambda[  11] =  -0.01751347643122
lambda[  12] =   0.01815771743430
lambda[  13] =   0.02181145749481
lambda[  14] =   0.03734179763116
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.474 ms
rank =  0, Distributing orbital back into band + domain format took 11.934 ms
rank = 0, Subspace_Rotation used 16.090 ms

Total time for subspace rotation: 16.097 ms
rank = 0, Efermi =  -0.138775368453 calculate fermi energy took 0.616 ms
rank = 0, --- Calculate rho: sum over local bands took 2.048 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.711 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.098 ms
rank = 0, Calculating density took 1203.984 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.435 ms
rank = 0, D2D took 0.775 ms
rank = 0, Transfering density took 0.785 ms
Etot    =   -27.892572930784
Eband   =    -8.641582427807
E1      =    18.345131770759
E2      =    -7.819361636502
E3      =    -9.731868477132
Exc     =    -8.750341866869
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 5.339e-03, dEband = 1.040e-01
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -27.892572931, dEtot = 5.339e-03, dEband = 1.040e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 4.9787541747558, which took 0.052 ms

iter_count = 102, r_2norm = 1.504e-04, tol*||rhs|| = 1.992e-04

Anderson update took 54.260 ms, out of which F'*F took 25.539 ms; b-Ax took 173.089 ms, out of which Lap took 155.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.004 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754260, int_b + int_rho = -3.747e-13, checking this took 0.110 ms
2-norm of RHS = 548.0368274325674, which took 0.098 ms

iter_count = 276, r_2norm = 4.925e-04, tol*||rhs|| = 5.480e-04

Anderson update took 146.639 ms, out of which F'*F took 69.482 ms; b-Ax took 472.523 ms, out of which Lap took 423.883 ms
Solving Poisson took 992.782 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.192 ms
Total time for convolution: 	 convolve: 5.124412 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.089535 
Total time for convolution: 	 convolve: 5.078274 
Total time for convolution: 	 convolve: 5.081384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.297 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.216 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
---Transfer Veff_loc: D2D took 0.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 27023.808 ms, scf error = 4.373e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.137342, lowerbound = -1.044575, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1096.616 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.656 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.134 ms
rank =  0, finding HY took 18.380 ms
rank =  0, distributing HY into block cyclic form took 12.295 ms
rank =  0, finding Y'*HY took 2.631 ms
Rank 0, Project_Hamiltonian used 47.471 ms
Total time for projection: 47.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.022499123449972
    last  calculated eigval = 0.033748539511145
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02249912344997
lambda[   2] =  -0.78126483542190
lambda[   3] =  -0.51243024584832
lambda[   4] =  -0.47795240330305
lambda[   5] =  -0.43304737070032
lambda[   6] =  -0.39459797488579
lambda[   7] =  -0.36590019467292
lambda[   8] =  -0.20164933970828
lambda[   9] =  -0.09308734908744
lambda[  10] =  -0.02918403909795
lambda[  11] =  -0.02595866266107
lambda[  12] =   0.01641576985830
lambda[  13] =   0.01941286859752
lambda[  14] =   0.03374853951115
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.912 ms
rank =  0, Distributing orbital back into band + domain format took 10.918 ms
rank = 0, Subspace_Rotation used 14.847 ms

Total time for subspace rotation: 14.856 ms
rank = 0, Efermi =  -0.123118363891 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.130 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.909 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.098 ms
rank = 0, Calculating density took 1163.303 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.438 ms
rank = 0, D2D took 0.661 ms
rank = 0, Transfering density took 0.669 ms
Etot    =   -27.888580229969
Eband   =    -8.378682976683
E1      =    18.145565586966
E2      =    -7.740013636838
E3      =    -9.817882283808
Exc     =    -8.816348240398
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.985e-04, dEband = 5.258e-02
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -27.888580230, dEtot = 7.985e-04, dEband = 5.258e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.8455121720507, which took 0.054 ms

iter_count = 102, r_2norm = 1.001e-04, tol*||rhs|| = 1.138e-04

Anderson update took 54.254 ms, out of which F'*F took 25.650 ms; b-Ax took 172.969 ms, out of which Lap took 154.897 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 374.970 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754261, int_b + int_rho = -3.674e-13, checking this took 0.130 ms
2-norm of RHS = 548.3609739024294, which took 0.102 ms

iter_count = 234, r_2norm = 4.962e-04, tol*||rhs|| = 5.484e-04

Anderson update took 125.387 ms, out of which F'*F took 59.265 ms; b-Ax took 395.880 ms, out of which Lap took 357.258 ms
Solving Poisson took 843.072 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.089443 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.157240 
Total time for convolution: 	 convolve: 5.113308 
Total time for convolution: 	 convolve: 5.118858 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.562 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.382 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.178 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 0.715 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.061 ms

This SCF took 26857.827 ms, scf error = 1.295e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.133749, lowerbound = -1.022499, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1139.240 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 49.547 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.443 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 51.012 ms
rank =  0, finding HY took 18.057 ms
rank =  0, distributing HY into block cyclic form took 12.626 ms
rank =  0, finding Y'*HY took 2.417 ms
Rank 0, Project_Hamiltonian used 84.146 ms
Total time for projection: 84.161 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.065 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.045 ms
rank = 0, Solve_Generalized_EigenProblem used 0.113 ms
    first calculated eigval = -1.022974483553516
    last  calculated eigval = 0.031672930002375
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02297448355352
lambda[   2] =  -0.77904148186954
lambda[   3] =  -0.50835985448540
lambda[   4] =  -0.47602551723044
lambda[   5] =  -0.43292644903855
lambda[   6] =  -0.39470754331129
lambda[   7] =  -0.36406910894354
lambda[   8] =  -0.19950545930874
lambda[   9] =  -0.09322108469706
lambda[  10] =  -0.03038670109449
lambda[  11] =  -0.02668561351051
lambda[  12] =   0.01591666255501
lambda[  13] =   0.01879531353897
lambda[  14] =   0.03167293000238
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 3.300 ms
rank =  0, Distributing orbital back into band + domain format took 10.975 ms
rank = 0, Subspace_Rotation used 14.851 ms

Total time for subspace rotation: 14.859 ms
rank = 0, Efermi =  -0.123252099824 calculate fermi energy took 0.153 ms
rank = 0, --- Calculate rho: sum over local bands took 2.116 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.087 ms
rank = 0, Calculating density took 1242.490 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.512 ms
rank = 0, D2D took 0.723 ms
rank = 0, Transfering density took 0.731 ms
Etot    =   -27.888191300160
Eband   =    -8.355219796185
E1      =    18.136445823049
E2      =    -7.723939552231
E3      =    -9.824940482214
Exc     =    -8.821286840969
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.779e-05, dEband = 4.693e-03
rank = 0, Calculating/Estimating energy took 0.974 ms, Etot = -27.888191300, dEtot = 7.779e-05, dEband = 4.693e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9924864029646, which took 0.054 ms

iter_count = 108, r_2norm = 3.600e-05, tol*||rhs|| = 3.970e-05

Anderson update took 58.011 ms, out of which F'*F took 27.351 ms; b-Ax took 183.081 ms, out of which Lap took 164.471 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 395.985 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754262, int_b + int_rho = -3.583e-13, checking this took 0.177 ms
2-norm of RHS = 549.0292623707821, which took 0.120 ms

iter_count = 240, r_2norm = 5.369e-04, tol*||rhs|| = 5.490e-04

Anderson update took 129.938 ms, out of which F'*F took 61.021 ms; b-Ax took 407.346 ms, out of which Lap took 366.227 ms
Solving Poisson took 864.193 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 6.141049 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.292675 
Total time for convolution: 	 convolve: 5.085932 
Total time for convolution: 	 convolve: 5.080190 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.528 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.578 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
---Transfer Veff_loc: D2D took 0.667 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.300 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.981 ms

This SCF took 28115.285 ms, scf error = 8.445e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131673, lowerbound = -1.022974, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1158.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.646 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.448 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.043 ms
rank =  0, Distribute data + matrix mult took 14.150 ms
rank =  0, finding HY took 18.193 ms
rank =  0, distributing HY into block cyclic form took 12.722 ms
rank =  0, finding Y'*HY took 2.117 ms
Rank 0, Project_Hamiltonian used 47.212 ms
Total time for projection: 47.223 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.515 ms
    first calculated eigval = -1.021682503365193
    last  calculated eigval = 0.030664527106043
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02168250336519
lambda[   2] =  -0.77729829780505
lambda[   3] =  -0.50571189816546
lambda[   4] =  -0.47417202430649
lambda[   5] =  -0.43130884150115
lambda[   6] =  -0.39270702146843
lambda[   7] =  -0.36192879280033
lambda[   8] =  -0.19778633922629
lambda[   9] =  -0.09167852424056
lambda[  10] =  -0.03052818720232
lambda[  11] =  -0.02523954792281
lambda[  12] =   0.01616178825805
lambda[  13] =   0.01866346100256
lambda[  14] =   0.03066452710604
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.531 ms
rank =  0, subspace rotation using ScaLAPACK took 3.911 ms
rank =  0, Distributing orbital back into band + domain format took 11.675 ms
rank = 0, Subspace_Rotation used 15.610 ms

Total time for subspace rotation: 15.615 ms
rank = 0, Efermi =  -0.121709538886 calculate fermi energy took 0.051 ms
rank = 0, --- Calculate rho: sum over local bands took 2.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.751 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1224.715 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.534 ms
rank = 0, D2D took 0.735 ms
rank = 0, Transfering density took 0.744 ms
Etot    =   -27.887895992234
Eband   =    -8.325191437968
E1      =    18.134336259365
E2      =    -7.693259182807
E3      =    -9.832188210928
Exc     =    -8.825477686866
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 5.906e-05, dEband = 6.006e-03
rank = 0, Calculating/Estimating energy took 0.973 ms, Etot = -27.887895992, dEtot = 5.906e-05, dEband = 6.006e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4236932061156, which took 0.058 ms

iter_count = 108, r_2norm = 1.669e-05, tol*||rhs|| = 1.695e-05

Anderson update took 57.727 ms, out of which F'*F took 27.177 ms; b-Ax took 183.942 ms, out of which Lap took 165.038 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.544 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754257, int_b + int_rho = -3.984e-13, checking this took 0.113 ms
2-norm of RHS = 549.2775964035681, which took 0.120 ms

iter_count = 228, r_2norm = 4.975e-04, tol*||rhs|| = 5.493e-04

Anderson update took 123.035 ms, out of which F'*F took 57.092 ms; b-Ax took 385.983 ms, out of which Lap took 348.008 ms
Solving Poisson took 821.778 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.080608 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.096248 
Total time for convolution: 	 convolve: 5.084613 
Total time for convolution: 	 convolve: 5.100205 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.293 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.298 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.979 ms

This SCF took 26905.855 ms, scf error = 3.513e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.130665, lowerbound = -1.021683, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1108.451 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.458 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.120 ms
rank =  0, finding HY took 18.372 ms
rank =  0, distributing HY into block cyclic form took 12.646 ms
rank =  0, finding Y'*HY took 2.396 ms
Rank 0, Project_Hamiltonian used 47.989 ms
Total time for projection: 48.000 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.020614657368611
    last  calculated eigval = 0.030171754221755
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.02061465736861
lambda[   2] =  -0.77558649182185
lambda[   3] =  -0.50346893023723
lambda[   4] =  -0.47268373998415
lambda[   5] =  -0.43010515989425
lambda[   6] =  -0.39107905377743
lambda[   7] =  -0.36027359134828
lambda[   8] =  -0.19597459060161
lambda[   9] =  -0.09048335707121
lambda[  10] =  -0.03011523444619
lambda[  11] =  -0.02393067497019
lambda[  12] =   0.01671359044742
lambda[  13] =   0.01871956708237
lambda[  14] =   0.03017175422176
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.333 ms
rank =  0, Distributing orbital back into band + domain format took 12.101 ms
rank = 0, Subspace_Rotation used 15.450 ms

Total time for subspace rotation: 15.453 ms
rank = 0, Efermi =  -0.120514371948 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.108 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.772 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1175.175 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
rank = 0, D2D took 0.736 ms
rank = 0, Transfering density took 0.739 ms
Etot    =   -27.887801505602
Eband   =    -8.299572430749
E1      =    18.124584215706
E2      =    -7.675642175512
E3      =    -9.837756608133
Exc     =    -8.829201553704
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.890e-05, dEband = 5.124e-03
rank = 0, Calculating/Estimating energy took 0.991 ms, Etot = -27.887801506, dEtot = 1.890e-05, dEband = 5.124e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1821671578423, which took 0.051 ms

iter_count = 114, r_2norm = 4.701e-06, tol*||rhs|| = 7.287e-06

Anderson update took 61.192 ms, out of which F'*F took 28.697 ms; b-Ax took 192.758 ms, out of which Lap took 173.509 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 417.961 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754261, int_b + int_rho = -3.638e-13, checking this took 0.115 ms
2-norm of RHS = 549.3689585251166, which took 0.126 ms

iter_count = 234, r_2norm = 4.939e-04, tol*||rhs|| = 5.494e-04

Anderson update took 125.828 ms, out of which F'*F took 58.794 ms; b-Ax took 397.352 ms, out of which Lap took 356.381 ms
Solving Poisson took 840.892 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.085110 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.096158 
Total time for convolution: 	 convolve: 5.087210 
Total time for convolution: 	 convolve: 5.081900 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.395 ms
---Transfer Veff_loc: D2D took 0.665 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26794.122 ms, scf error = 2.194e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130172, lowerbound = -1.020615, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1105.032 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.657 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.922 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.010 ms
rank =  0, finding HY took 18.962 ms
rank =  0, distributing HY into block cyclic form took 12.735 ms
rank =  0, finding Y'*HY took 2.080 ms
Rank 0, Project_Hamiltonian used 48.820 ms
Total time for projection: 48.831 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.018095068786257
    last  calculated eigval = 0.031004870725354
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01809506878626
lambda[   2] =  -0.77304309131544
lambda[   3] =  -0.50121940342356
lambda[   4] =  -0.47055618056679
lambda[   5] =  -0.42764720266596
lambda[   6] =  -0.38838411287748
lambda[   7] =  -0.35817300192271
lambda[   8] =  -0.19360769148484
lambda[   9] =  -0.08816937125241
lambda[  10] =  -0.02846674339766
lambda[  11] =  -0.02165088852944
lambda[  12] =   0.01904340238841
lambda[  13] =   0.01959135101455
lambda[  14] =   0.03100487072535
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.156 ms
rank =  0, subspace rotation using ScaLAPACK took 3.332 ms
rank =  0, Distributing orbital back into band + domain format took 12.084 ms
rank = 0, Subspace_Rotation used 15.429 ms

Total time for subspace rotation: 15.439 ms
rank = 0, Efermi =  -0.118200385909 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.123 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.728 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1172.538 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
rank = 0, D2D took 0.728 ms
rank = 0, Transfering density took 0.731 ms
Etot    =   -27.887831636828
Eband   =    -8.261451506751
E1      =    18.105368779511
E2      =    -7.654920219731
E3      =    -9.843975790196
Exc     =    -8.833634399016
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 6.026e-06, dEband = 7.624e-03
rank = 0, Calculating/Estimating energy took 0.984 ms, Etot = -27.887831637, dEtot = 6.026e-06, dEband = 7.624e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1218016661871, which took 0.060 ms

iter_count = 114, r_2norm = 3.095e-06, tol*||rhs|| = 4.872e-06

Anderson update took 61.213 ms, out of which F'*F took 28.877 ms; b-Ax took 193.221 ms, out of which Lap took 173.910 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.301 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754255, int_b + int_rho = -4.220e-13, checking this took 0.104 ms
2-norm of RHS = 549.3417331541240, which took 0.097 ms

iter_count = 210, r_2norm = 4.843e-04, tol*||rhs|| = 5.493e-04

Anderson update took 112.328 ms, out of which F'*F took 53.156 ms; b-Ax took 356.529 ms, out of which Lap took 319.856 ms
Solving Poisson took 755.018 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.095 ms
Total time for convolution: 	 convolve: 5.081855 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.315 ms
Total time for convolution: 	 convolve: 5.086660 
Total time for convolution: 	 convolve: 5.092005 
Total time for convolution: 	 convolve: 5.097113 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.814 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.399 ms
---Transfer Veff_loc: D2D took 0.659 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.302 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26682.932 ms, scf error = 9.831e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.131005, lowerbound = -1.018095, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1105.071 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.668 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.445 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.006 ms
rank =  0, Distribute data + matrix mult took 14.134 ms
rank =  0, finding HY took 18.399 ms
rank =  0, distributing HY into block cyclic form took 12.692 ms
rank =  0, finding Y'*HY took 2.120 ms
Rank 0, Project_Hamiltonian used 47.370 ms
Total time for projection: 47.388 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -1.016998731831370
    last  calculated eigval = 0.031765364064099
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01699873183137
lambda[   2] =  -0.77204866557986
lambda[   3] =  -0.50017885494274
lambda[   4] =  -0.46959497164581
lambda[   5] =  -0.42661862297320
lambda[   6] =  -0.38728973064338
lambda[   7] =  -0.35718552686586
lambda[   8] =  -0.19267475919956
lambda[   9] =  -0.08717627353023
lambda[  10] =  -0.02680810258265
lambda[  11] =  -0.02065004805867
lambda[  12] =   0.02048528023266
lambda[  13] =   0.02169621245451
lambda[  14] =   0.03176536406410
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.354 ms
rank =  0, Distributing orbital back into band + domain format took 11.971 ms
rank = 0, Subspace_Rotation used 15.337 ms

Total time for subspace rotation: 15.341 ms
rank = 0, Efermi =  -0.117207288429 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.700 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.072 ms
rank = 0, Calculating density took 1170.978 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.504 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.709 ms
Etot    =   -27.887900651068
Eband   =    -8.245179728021
E1      =    18.096367502404
E2      =    -7.647041991258
E3      =    -9.846389943493
Exc     =    -8.835509839702
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.380e-05, dEband = 3.254e-03
rank = 0, Calculating/Estimating energy took 1.020 ms, Etot = -27.887900651, dEtot = 1.380e-05, dEband = 3.254e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0718199506887, which took 0.050 ms

iter_count = 114, r_2norm = 1.795e-06, tol*||rhs|| = 2.873e-06

Anderson update took 61.248 ms, out of which F'*F took 28.713 ms; b-Ax took 193.583 ms, out of which Lap took 174.155 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.802 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754260, int_b + int_rho = -3.747e-13, checking this took 0.101 ms
2-norm of RHS = 549.3339523887396, which took 0.098 ms

iter_count = 204, r_2norm = 4.747e-04, tol*||rhs|| = 5.493e-04

Anderson update took 109.085 ms, out of which F'*F took 51.608 ms; b-Ax took 346.535 ms, out of which Lap took 310.400 ms
Solving Poisson took 732.835 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.094032 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.078954 
Total time for convolution: 	 convolve: 5.147517 
Total time for convolution: 	 convolve: 5.097540 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.803 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.762 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.215 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.390 ms
---Transfer Veff_loc: D2D took 0.647 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.779 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.078 ms

This SCF took 26714.182 ms, scf error = 6.712e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.131765, lowerbound = -1.016999, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1114.399 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.444 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.104 ms
rank =  0, Distribute data + matrix mult took 14.204 ms
rank =  0, finding HY took 18.366 ms
rank =  0, distributing HY into block cyclic form took 12.737 ms
rank =  0, finding Y'*HY took 2.081 ms
Rank 0, Project_Hamiltonian used 47.419 ms
Total time for projection: 47.430 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.016666549682995
    last  calculated eigval = 0.033177140050460
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01666654968300
lambda[   2] =  -0.77167294438205
lambda[   3] =  -0.49970758499935
lambda[   4] =  -0.46917556277479
lambda[   5] =  -0.42623321312293
lambda[   6] =  -0.38691428006069
lambda[   7] =  -0.35675399776139
lambda[   8] =  -0.19219838053227
lambda[   9] =  -0.08673009644521
lambda[  10] =  -0.02432618173431
lambda[  11] =  -0.02005188407891
lambda[  12] =   0.02245482279527
lambda[  13] =   0.02521554916547
lambda[  14] =   0.03317714005046
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.341 ms
rank =  0, Distributing orbital back into band + domain format took 12.100 ms
rank = 0, Subspace_Rotation used 15.456 ms

Total time for subspace rotation: 15.460 ms
rank = 0, Efermi =  -0.116761111274 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.148 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1180.558 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.745 ms
rank = 0, Transfering density took 0.748 ms
Etot    =   -27.887937980065
Eband   =    -8.238645027287
E1      =    18.093915975898
E2      =    -7.643040920714
E3      =    -9.846167957517
Exc     =    -8.835407286407
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.466e-06, dEband = 1.307e-03
rank = 0, Calculating/Estimating energy took 0.985 ms, Etot = -27.887937980, dEtot = 7.466e-06, dEband = 1.307e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0512969059267, which took 0.111 ms

iter_count = 108, r_2norm = 1.956e-06, tol*||rhs|| = 2.052e-06

Anderson update took 59.915 ms, out of which F'*F took 27.468 ms; b-Ax took 183.528 ms, out of which Lap took 165.101 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.323 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754260, int_b + int_rho = -3.711e-13, checking this took 0.154 ms
2-norm of RHS = 549.3484567675362, which took 0.063 ms

iter_count = 192, r_2norm = 4.502e-04, tol*||rhs|| = 5.493e-04

Anderson update took 102.689 ms, out of which F'*F took 48.604 ms; b-Ax took 326.290 ms, out of which Lap took 292.556 ms
Solving Poisson took 690.873 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.091 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.096696 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.083291 
Total time for convolution: 	 convolve: 5.079673 
Total time for convolution: 	 convolve: 5.115189 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.747 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.508 ms
---Transfer Veff_loc: D2D took 1.785 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.109 ms

This SCF took 26621.702 ms, scf error = 4.314e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133177, lowerbound = -1.016667, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1104.586 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.607 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.146 ms
rank =  0, Distribute data + matrix mult took 14.207 ms
rank =  0, finding HY took 18.326 ms
rank =  0, distributing HY into block cyclic form took 12.655 ms
rank =  0, finding Y'*HY took 2.093 ms
Rank 0, Project_Hamiltonian used 47.312 ms
Total time for projection: 47.323 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.093 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.147 ms
    first calculated eigval = -1.016079076742793
    last  calculated eigval = 0.034860339271721
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01607907674279
lambda[   2] =  -0.77104518296827
lambda[   3] =  -0.49911721028760
lambda[   4] =  -0.46860529268990
lambda[   5] =  -0.42564422757151
lambda[   6] =  -0.38634111698995
lambda[   7] =  -0.35619080991721
lambda[   8] =  -0.19164497064541
lambda[   9] =  -0.08616173062793
lambda[  10] =  -0.02207574062540
lambda[  11] =  -0.01958257274498
lambda[  12] =   0.02427299977072
lambda[  13] =   0.02817733910488
lambda[  14] =   0.03486033927172
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.319 ms
rank =  0, Distributing orbital back into band + domain format took 12.021 ms
rank = 0, Subspace_Rotation used 15.352 ms

Total time for subspace rotation: 15.356 ms
rank = 0, Efermi =  -0.116192745343 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.139 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.732 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1170.533 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.525 ms
rank = 0, D2D took 0.732 ms
rank = 0, Transfering density took 0.734 ms
Etot    =   -27.887988108047
Eband   =    -8.229335776275
E1      =    18.089109845280
E2      =    -7.638254442803
E3      =    -9.847308188164
Exc     =    -8.836314287520
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.003e-05, dEband = 1.862e-03
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -27.887988108, dEtot = 1.003e-05, dEband = 1.862e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0429419554733, which took 0.058 ms

iter_count = 114, r_2norm = 1.070e-06, tol*||rhs|| = 1.718e-06

Anderson update took 61.067 ms, out of which F'*F took 28.984 ms; b-Ax took 193.325 ms, out of which Lap took 173.867 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 419.180 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754258, int_b + int_rho = -3.965e-13, checking this took 0.129 ms
2-norm of RHS = 549.3494111237250, which took 0.130 ms

iter_count = 150, r_2norm = 4.603e-04, tol*||rhs|| = 5.493e-04

Anderson update took 80.021 ms, out of which F'*F took 38.558 ms; b-Ax took 255.317 ms, out of which Lap took 228.897 ms
Solving Poisson took 540.066 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.233755 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.327 ms
Total time for convolution: 	 convolve: 5.143469 
Total time for convolution: 	 convolve: 5.116736 
Total time for convolution: 	 convolve: 5.101716 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.207 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.133 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.395 ms
---Transfer Veff_loc: D2D took 0.673 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.985 ms

This SCF took 26799.600 ms, scf error = 2.480e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.134860, lowerbound = -1.016079, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1112.452 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.666 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.437 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.063 ms
rank =  0, Distribute data + matrix mult took 14.180 ms
rank =  0, finding HY took 18.250 ms
rank =  0, distributing HY into block cyclic form took 12.562 ms
rank =  0, finding Y'*HY took 2.200 ms
Rank 0, Project_Hamiltonian used 47.224 ms
Total time for projection: 47.235 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.015921404196407
    last  calculated eigval = 0.035397625861897
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01592140419641
lambda[   2] =  -0.77088600080969
lambda[   3] =  -0.49897634618914
lambda[   4] =  -0.46845456566828
lambda[   5] =  -0.42548861622832
lambda[   6] =  -0.38621076589986
lambda[   7] =  -0.35604926497603
lambda[   8] =  -0.19150585053004
lambda[   9] =  -0.08601564778093
lambda[  10] =  -0.02122904743862
lambda[  11] =  -0.01951017999849
lambda[  12] =   0.02473544994583
lambda[  13] =   0.02930220492520
lambda[  14] =   0.03539762586190
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.338 ms
rank =  0, Distributing orbital back into band + domain format took 12.021 ms
rank = 0, Subspace_Rotation used 15.371 ms

Total time for subspace rotation: 15.374 ms
rank = 0, Efermi =  -0.116046662403 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.124 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.763 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1178.341 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
rank = 0, D2D took 0.754 ms
rank = 0, Transfering density took 0.756 ms
Etot    =   -27.888006744633
Eband   =    -8.226985629644
E1      =    18.087909139506
E2      =    -7.637064306777
E3      =    -9.847467455808
Exc     =    -8.836451496581
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 3.727e-06, dEband = 4.700e-04
rank = 0, Calculating/Estimating energy took 1.827 ms, Etot = -27.888006745, dEtot = 3.727e-06, dEband = 4.700e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304351917906, which took 0.049 ms

iter_count = 114, r_2norm = 7.818e-07, tol*||rhs|| = 1.217e-06

Anderson update took 61.141 ms, out of which F'*F took 28.814 ms; b-Ax took 193.790 ms, out of which Lap took 174.485 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 418.653 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754257, int_b + int_rho = -4.038e-13, checking this took 0.119 ms
2-norm of RHS = 549.3545449753138, which took 0.108 ms

iter_count = 156, r_2norm = 5.453e-04, tol*||rhs|| = 5.494e-04

Anderson update took 83.601 ms, out of which F'*F took 39.614 ms; b-Ax took 265.083 ms, out of which Lap took 237.743 ms
Solving Poisson took 561.696 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.103 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.092123 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.085033 
Total time for convolution: 	 convolve: 5.082027 
Total time for convolution: 	 convolve: 5.089821 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.553 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.209 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.274 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.415 ms
---Transfer Veff_loc: D2D took 0.679 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.317 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.012 ms

This SCF took 26477.069 ms, scf error = 2.090e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.135398, lowerbound = -1.015921, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.033 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.674 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.446 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 14.209 ms
rank =  0, finding HY took 18.282 ms
rank =  0, distributing HY into block cyclic form took 12.739 ms
rank =  0, finding Y'*HY took 2.092 ms
Rank 0, Project_Hamiltonian used 47.349 ms
Total time for projection: 47.361 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -1.015685797147427
    last  calculated eigval = 0.035816595410733
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01568579714743
lambda[   2] =  -0.77067731555756
lambda[   3] =  -0.49877092209788
lambda[   4] =  -0.46823964219326
lambda[   5] =  -0.42526539895006
lambda[   6] =  -0.38600388443358
lambda[   7] =  -0.35583656455503
lambda[   8] =  -0.19130581030499
lambda[   9] =  -0.08582067329729
lambda[  10] =  -0.02049711920879
lambda[  11] =  -0.01950701103008
lambda[  12] =   0.02534658044643
lambda[  13] =   0.02978247810729
lambda[  14] =   0.03581659541073
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.330 ms
rank =  0, Distributing orbital back into band + domain format took 12.009 ms
rank = 0, Subspace_Rotation used 15.352 ms

Total time for subspace rotation: 15.356 ms
rank = 0, Efermi =  -0.115851688371 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.120 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.730 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.085 ms
rank = 0, Calculating density took 1185.992 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.508 ms
rank = 0, D2D took 1.973 ms
rank = 0, Transfering density took 1.980 ms
Etot    =   -27.888043928937
Eband   =    -8.223570671127
E1      =    18.086317130215
E2      =    -7.635158877560
E3      =    -9.847671507245
Exc     =    -8.836610252331
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.437e-06, dEband = 6.830e-04
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -27.888043929, dEtot = 7.437e-06, dEband = 6.830e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0236766392070, which took 0.100 ms

iter_count = 108, r_2norm = 9.211e-07, tol*||rhs|| = 9.471e-07

Anderson update took 57.996 ms, out of which F'*F took 27.152 ms; b-Ax took 182.609 ms, out of which Lap took 164.366 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.809 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754264, int_b + int_rho = -3.311e-13, checking this took 0.096 ms
2-norm of RHS = 549.3596797755933, which took 0.102 ms

iter_count = 156, r_2norm = 4.609e-04, tol*||rhs|| = 5.494e-04

Anderson update took 84.259 ms, out of which F'*F took 39.312 ms; b-Ax took 265.311 ms, out of which Lap took 237.838 ms
Solving Poisson took 563.076 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.085108 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.080511 
Total time for convolution: 	 convolve: 5.100203 
Total time for convolution: 	 convolve: 5.082266 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.417 ms
---Transfer Veff_loc: D2D took 0.691 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.313 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.020 ms

This SCF took 26483.627 ms, scf error = 1.454e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135817, lowerbound = -1.015686, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1135.068 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.638 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.434 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.074 ms
rank =  0, Distribute data + matrix mult took 14.158 ms
rank =  0, finding HY took 18.276 ms
rank =  0, distributing HY into block cyclic form took 12.734 ms
rank =  0, finding Y'*HY took 2.124 ms
Rank 0, Project_Hamiltonian used 47.320 ms
Total time for projection: 47.333 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -1.015637897840621
    last  calculated eigval = 0.036578747629117
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01563789784062
lambda[   2] =  -0.77063810145867
lambda[   3] =  -0.49869688957499
lambda[   4] =  -0.46817508494725
lambda[   5] =  -0.42520974584772
lambda[   6] =  -0.38594533257417
lambda[   7] =  -0.35576572501289
lambda[   8] =  -0.19124263209030
lambda[   9] =  -0.08577309827252
lambda[  10] =  -0.01952419315134
lambda[  11] =  -0.01931591156523
lambda[  12] =   0.02622695260976
lambda[  13] =   0.03051235282344
lambda[  14] =   0.03657874762912
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.334 ms
rank =  0, Distributing orbital back into band + domain format took 12.038 ms
rank = 0, Subspace_Rotation used 15.384 ms

Total time for subspace rotation: 15.388 ms
rank = 0, Efermi =  -0.115804113412 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 2.126 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.762 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1201.056 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.421 ms
rank = 0, D2D took 0.547 ms
rank = 0, Transfering density took 0.549 ms
Etot    =   -27.888062356809
Eband   =    -8.222622819340
E1      =    18.086156116831
E2      =    -7.634385661329
E3      =    -9.847522680599
Exc     =    -8.836493475728
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 3.686e-06, dEband = 1.896e-04
rank = 0, Calculating/Estimating energy took 0.881 ms, Etot = -27.888062357, dEtot = 3.686e-06, dEband = 1.896e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0244635114867, which took 0.077 ms

iter_count = 108, r_2norm = 8.873e-07, tol*||rhs|| = 9.785e-07

Anderson update took 58.146 ms, out of which F'*F took 27.395 ms; b-Ax took 183.656 ms, out of which Lap took 165.295 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.639 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754256, int_b + int_rho = -4.111e-13, checking this took 0.100 ms
2-norm of RHS = 549.3597136575287, which took 0.094 ms

iter_count = 84, r_2norm = 4.850e-04, tol*||rhs|| = 5.494e-04

Anderson update took 45.000 ms, out of which F'*F took 21.414 ms; b-Ax took 142.745 ms, out of which Lap took 128.179 ms
Solving Poisson took 304.031 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.131607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Total time for convolution: 	 convolve: 5.100057 
Total time for convolution: 	 convolve: 5.084362 
Total time for convolution: 	 convolve: 5.082284 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.532 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.521 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.306 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.973 ms

This SCF took 26276.217 ms, scf error = 1.602e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.136579, lowerbound = -1.015638, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1108.641 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.636 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.455 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 14.113 ms
rank =  0, finding HY took 18.380 ms
rank =  0, distributing HY into block cyclic form took 12.583 ms
rank =  0, finding Y'*HY took 2.143 ms
Rank 0, Project_Hamiltonian used 47.250 ms
Total time for projection: 47.262 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.146 ms
    first calculated eigval = -1.015668275315538
    last  calculated eigval = 0.035692127793673
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01566827531554
lambda[   2] =  -0.77066934861817
lambda[   3] =  -0.49872505018046
lambda[   4] =  -0.46820152165769
lambda[   5] =  -0.42523913739900
lambda[   6] =  -0.38597692359804
lambda[   7] =  -0.35579164659404
lambda[   8] =  -0.19126875199803
lambda[   9] =  -0.08580127143966
lambda[  10] =  -0.01966943327966
lambda[  11] =  -0.01953774969513
lambda[  12] =   0.02580348559422
lambda[  13] =   0.03014267703702
lambda[  14] =   0.03569212779367
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.159 ms
rank =  0, subspace rotation using ScaLAPACK took 3.338 ms
rank =  0, Distributing orbital back into band + domain format took 12.011 ms
rank = 0, Subspace_Rotation used 15.362 ms

Total time for subspace rotation: 15.366 ms
rank = 0, Efermi =  -0.115832286346 calculate fermi energy took 0.608 ms
rank = 0, --- Calculate rho: sum over local bands took 2.132 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.787 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.079 ms
rank = 0, Calculating density took 1175.480 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.532 ms
rank = 0, D2D took 0.734 ms
rank = 0, Transfering density took 0.737 ms
Etot    =   -27.888061644734
Eband   =    -8.223081311369
E1      =    18.086422769245
E2      =    -7.634596017273
E3      =    -9.847444260562
Exc     =    -8.836432859945
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.424e-07, dEband = 9.170e-05
rank = 0, Calculating/Estimating energy took 0.997 ms, Etot = -27.888061645, dEtot = 1.424e-07, dEband = 9.170e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0243555706305, which took 0.071 ms

iter_count = 108, r_2norm = 8.907e-07, tol*||rhs|| = 9.742e-07

Anderson update took 57.805 ms, out of which F'*F took 27.073 ms; b-Ax took 182.932 ms, out of which Lap took 164.548 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.633 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754256, int_b + int_rho = -4.111e-13, checking this took 0.133 ms
2-norm of RHS = 549.3596277740784, which took 0.083 ms

iter_count = 54, r_2norm = 5.003e-04, tol*||rhs|| = 5.494e-04

Anderson update took 29.021 ms, out of which F'*F took 13.642 ms; b-Ax took 91.575 ms, out of which Lap took 82.092 ms
Solving Poisson took 196.476 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.098 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.080597 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 47.898 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.081141 
Total time for convolution: 	 convolve: 5.087085 
Total time for convolution: 	 convolve: 5.080930 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.544 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.271 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.303 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.986 ms

This SCF took 26121.485 ms, scf error = 1.723e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135692, lowerbound = -1.015668, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1124.486 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.052 ms
rank =  0, Distribute orbital to block cyclic format took 12.617 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.418 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.027 ms
rank =  0, Distribute data + matrix mult took 14.076 ms
rank =  0, finding HY took 18.662 ms
rank =  0, distributing HY into block cyclic form took 12.763 ms
rank =  0, finding Y'*HY took 2.097 ms
Rank 0, Project_Hamiltonian used 47.681 ms
Total time for projection: 47.693 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.015655749966282
    last  calculated eigval = 0.035211271882669
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01565574996628
lambda[   2] =  -0.77065642776348
lambda[   3] =  -0.49871416571017
lambda[   4] =  -0.46819173409998
lambda[   5] =  -0.42522758211350
lambda[   6] =  -0.38596307009818
lambda[   7] =  -0.35578193738263
lambda[   8] =  -0.19125763328478
lambda[   9] =  -0.08579081270792
lambda[  10] =  -0.01964543168735
lambda[  11] =  -0.01953972027517
lambda[  12] =   0.02568782681174
lambda[  13] =   0.03009793874048
lambda[  14] =   0.03521127188267
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.322 ms
rank =  0, Distributing orbital back into band + domain format took 11.005 ms
rank = 0, Subspace_Rotation used 14.352 ms

Total time for subspace rotation: 14.949 ms
rank = 0, Efermi =  -0.115821827460 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.263 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.679 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.069 ms
rank = 0, Calculating density took 1191.303 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.549 ms
rank = 0, D2D took 0.747 ms
rank = 0, Transfering density took 0.755 ms
Etot    =   -27.888057819865
Eband   =    -8.222896601485
E1      =    18.086309075931
E2      =    -7.634515377977
E3      =    -9.847501381656
Exc     =    -8.836476533444
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.650e-07, dEband = 3.694e-05
rank = 0, Calculating/Estimating energy took 0.966 ms, Etot = -27.888057820, dEtot = 7.650e-07, dEband = 3.694e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0241346043182, which took 0.053 ms

iter_count = 108, r_2norm = 8.018e-07, tol*||rhs|| = 9.654e-07

Anderson update took 58.028 ms, out of which F'*F took 27.336 ms; b-Ax took 183.381 ms, out of which Lap took 164.970 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.155 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754261, int_b + int_rho = -3.638e-13, checking this took 0.093 ms
2-norm of RHS = 549.3613372006092, which took 0.092 ms

iter_count = 102, r_2norm = 5.251e-04, tol*||rhs|| = 5.494e-04

Anderson update took 54.536 ms, out of which F'*F took 25.789 ms; b-Ax took 172.971 ms, out of which Lap took 154.984 ms
Solving Poisson took 368.307 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.083843 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Total time for convolution: 	 convolve: 5.078478 
Total time for convolution: 	 convolve: 6.501769 
Total time for convolution: 	 convolve: 5.078842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.796 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.554 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.286 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 0.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 27676.893 ms, scf error = 1.644e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.135211, lowerbound = -1.015656, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1106.217 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.648 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.441 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.041 ms
rank =  0, Distribute data + matrix mult took 14.142 ms
rank =  0, finding HY took 18.381 ms
rank =  0, distributing HY into block cyclic form took 12.688 ms
rank =  0, finding Y'*HY took 2.124 ms
Rank 0, Project_Hamiltonian used 47.363 ms
Total time for projection: 47.375 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.145 ms
    first calculated eigval = -1.015572285346057
    last  calculated eigval = 0.034717480937723
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01557228534606
lambda[   2] =  -0.77057096691409
lambda[   3] =  -0.49864668800166
lambda[   4] =  -0.46811895378967
lambda[   5] =  -0.42514801704261
lambda[   6] =  -0.38589335118086
lambda[   7] =  -0.35571444019295
lambda[   8] =  -0.19118892097091
lambda[   9] =  -0.08572486599705
lambda[  10] =  -0.01959182612242
lambda[  11] =  -0.01951683127570
lambda[  12] =   0.02565855005972
lambda[  13] =   0.02996100542418
lambda[  14] =   0.03471748093772
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 4.013 ms
rank =  0, Distributing orbital back into band + domain format took 11.189 ms
rank = 0, Subspace_Rotation used 15.218 ms

Total time for subspace rotation: 15.224 ms
rank = 0, Efermi =  -0.115755881066 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.087 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1172.473 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.518 ms
rank = 0, D2D took 0.769 ms
rank = 0, Transfering density took 0.777 ms
Etot    =   -27.888066072598
Eband   =    -8.221707247524
E1      =    18.085664045961
E2      =    -7.633923096047
E3      =    -9.847652696363
Exc     =    -8.836588142945
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.651e-06, dEband = 2.379e-04
rank = 0, Calculating/Estimating energy took 0.953 ms, Etot = -27.888066073, dEtot = 1.651e-06, dEband = 2.379e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0235887625005, which took 0.049 ms

iter_count = 108, r_2norm = 7.848e-07, tol*||rhs|| = 9.436e-07

Anderson update took 57.881 ms, out of which F'*F took 27.311 ms; b-Ax took 183.096 ms, out of which Lap took 164.819 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.490 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754256, int_b + int_rho = -4.111e-13, checking this took 0.098 ms
2-norm of RHS = 549.3621605523882, which took 0.097 ms

iter_count = 66, r_2norm = 5.066e-04, tol*||rhs|| = 5.494e-04

Anderson update took 35.490 ms, out of which F'*F took 16.588 ms; b-Ax took 111.941 ms, out of which Lap took 100.318 ms
Solving Poisson took 239.467 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.089826 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.345 ms
Total time for convolution: 	 convolve: 5.077386 
Total time for convolution: 	 convolve: 5.089928 
Total time for convolution: 	 convolve: 5.081377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.691 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.006 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.573 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
---Transfer Veff_loc: D2D took 0.685 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.998 ms

This SCF took 26119.738 ms, scf error = 1.415e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134717, lowerbound = -1.015572, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1111.152 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.645 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 14.099 ms
rank =  0, finding HY took 18.325 ms
rank =  0, distributing HY into block cyclic form took 12.776 ms
rank =  0, finding Y'*HY took 2.107 ms
Rank 0, Project_Hamiltonian used 47.336 ms
Total time for projection: 47.348 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -1.015556993830016
    last  calculated eigval = 0.034187020023923
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01555699383002
lambda[   2] =  -0.77055497319862
lambda[   3] =  -0.49863062171087
lambda[   4] =  -0.46810411980350
lambda[   5] =  -0.42513309996376
lambda[   6] =  -0.38587743796111
lambda[   7] =  -0.35569891447397
lambda[   8] =  -0.19117282471076
lambda[   9] =  -0.08570915931345
lambda[  10] =  -0.01963060078695
lambda[  11] =  -0.01950042759152
lambda[  12] =   0.02554782799877
lambda[  13] =   0.02987702696295
lambda[  14] =   0.03418702002392
==subpsace eigenproblem: bcast eigvals took 0.542 ms
Total time for solving subspace eigenvalue problem: 1.419 ms
rank =  0, subspace rotation using ScaLAPACK took 3.421 ms
rank =  0, Distributing orbital back into band + domain format took 11.685 ms
rank = 0, Subspace_Rotation used 15.122 ms

Total time for subspace rotation: 15.131 ms
rank = 0, Efermi =  -0.115740173899 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.111 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.811 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1178.152 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.755 ms
rank = 0, Transfering density took 0.762 ms
Etot    =   -27.888063601454
Eband   =    -8.221457971952
E1      =    18.085553518802
E2      =    -7.633773937571
E3      =    -9.847700650166
Exc     =    -8.836623215540
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 4.942e-07, dEband = 4.986e-05
rank = 0, Calculating/Estimating energy took 0.957 ms, Etot = -27.888063601, dEtot = 4.942e-07, dEband = 4.986e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231198888910, which took 0.052 ms

iter_count = 108, r_2norm = 7.753e-07, tol*||rhs|| = 9.248e-07

Anderson update took 57.981 ms, out of which F'*F took 27.328 ms; b-Ax took 183.156 ms, out of which Lap took 164.811 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.983 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754261, int_b + int_rho = -3.693e-13, checking this took 0.127 ms
2-norm of RHS = 549.3634459808312, which took 0.107 ms

iter_count = 84, r_2norm = 5.229e-04, tol*||rhs|| = 5.494e-04

Anderson update took 45.089 ms, out of which F'*F took 21.267 ms; b-Ax took 142.692 ms, out of which Lap took 127.907 ms
Solving Poisson took 304.072 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.100860 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Total time for convolution: 	 convolve: 5.081310 
Total time for convolution: 	 convolve: 5.080191 
Total time for convolution: 	 convolve: 5.088384 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.076 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 0.666 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.987 ms

This SCF took 26198.767 ms, scf error = 1.424e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.134187, lowerbound = -1.015557, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1114.768 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.642 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.107 ms
rank =  0, Distribute data + matrix mult took 14.190 ms
rank =  0, finding HY took 18.446 ms
rank =  0, distributing HY into block cyclic form took 12.516 ms
rank =  0, finding Y'*HY took 2.240 ms
Rank 0, Project_Hamiltonian used 48.168 ms
Total time for projection: 48.184 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.160 ms
    first calculated eigval = -1.015538335832258
    last  calculated eigval = 0.033964019927755
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01553833583226
lambda[   2] =  -0.77053369605557
lambda[   3] =  -0.49860614041519
lambda[   4] =  -0.46808200445282
lambda[   5] =  -0.42511205332998
lambda[   6] =  -0.38585605936710
lambda[   7] =  -0.35567606911318
lambda[   8] =  -0.19115002385791
lambda[   9] =  -0.08568517321892
lambda[  10] =  -0.01947100169510
lambda[  11] =  -0.01943819665416
lambda[  12] =   0.02558807831638
lambda[  13] =   0.03003052063694
lambda[  14] =   0.03396401992776
==subpsace eigenproblem: bcast eigvals took 22.017 ms
Total time for solving subspace eigenvalue problem: 22.183 ms
rank =  0, subspace rotation using ScaLAPACK took 3.372 ms
rank =  0, Distributing orbital back into band + domain format took 12.190 ms
rank = 0, Subspace_Rotation used 15.577 ms

Total time for subspace rotation: 15.582 ms
rank = 0, Efermi =  -0.115716188164 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.144 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.746 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1203.844 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.551 ms
rank = 0, D2D took 0.750 ms
rank = 0, Transfering density took 0.758 ms
Etot    =   -27.888065572631
Eband   =    -8.221108765494
E1      =    18.085424498044
E2      =    -7.633547888558
E3      =    -9.847715641704
Exc     =    -8.836634314943
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 3.942e-07, dEband = 6.984e-05
rank = 0, Calculating/Estimating energy took 0.970 ms, Etot = -27.888065573, dEtot = 3.942e-07, dEband = 6.984e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0229706429371, which took 0.054 ms

iter_count = 108, r_2norm = 7.078e-07, tol*||rhs|| = 9.188e-07

Anderson update took 57.973 ms, out of which F'*F took 27.206 ms; b-Ax took 182.980 ms, out of which Lap took 164.793 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 396.986 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754262, int_b + int_rho = -3.565e-13, checking this took 0.116 ms
2-norm of RHS = 549.3613691643573, which took 0.087 ms

iter_count = 96, r_2norm = 4.899e-04, tol*||rhs|| = 5.494e-04

Anderson update took 51.156 ms, out of which F'*F took 24.300 ms; b-Ax took 163.206 ms, out of which Lap took 146.144 ms
Solving Poisson took 347.503 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.079912 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.166 ms
Total time for convolution: 	 convolve: 5.081538 
Total time for convolution: 	 convolve: 5.079823 
Total time for convolution: 	 convolve: 5.090216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.785 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.185 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.213 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 0.688 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.316 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.020 ms

This SCF took 26251.958 ms, scf error = 1.510e-04
-------------
SCF iter 20  
-------------

 Chebfilt 23, in Chebyshev filtering, lambda_cutoff = 0.133964, lowerbound = -1.015538, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1124.562 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.620 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.666 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.007 ms
rank =  0, Distribute data + matrix mult took 15.314 ms
rank =  0, finding HY took 19.124 ms
rank =  0, distributing HY into block cyclic form took 12.792 ms
rank =  0, finding Y'*HY took 2.074 ms
Rank 0, Project_Hamiltonian used 49.336 ms
Total time for projection: 49.354 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.088 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.142 ms
    first calculated eigval = -1.015488921148451
    last  calculated eigval = 0.033055548102747
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01548892114845
lambda[   2] =  -0.77049533379871
lambda[   3] =  -0.49858632418185
lambda[   4] =  -0.46805226523695
lambda[   5] =  -0.42507587351979
lambda[   6] =  -0.38582707462858
lambda[   7] =  -0.35564968076280
lambda[   8] =  -0.19112670370058
lambda[   9] =  -0.08566303083345
lambda[  10] =  -0.01976944929062
lambda[  11] =  -0.01947440904337
lambda[  12] =   0.02528327547555
lambda[  13] =   0.02955037164194
lambda[  14] =   0.03305554810275
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.332 ms
rank =  0, Distributing orbital back into band + domain format took 12.055 ms
rank = 0, Subspace_Rotation used 15.400 ms

Total time for subspace rotation: 15.403 ms
rank = 0, Efermi =  -0.115694045726 calculate fermi energy took 0.038 ms
rank = 0, --- Calculate rho: sum over local bands took 2.141 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1192.594 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.563 ms
rank = 0, D2D took 0.748 ms
rank = 0, Transfering density took 0.756 ms
Etot    =   -27.888065924171
Eband   =    -8.220604354602
E1      =    18.085025628606
E2      =    -7.633407630874
E3      =    -9.847844825878
Exc     =    -8.836729134427
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 7.031e-08, dEband = 1.009e-04
rank = 0, Calculating/Estimating energy took 0.940 ms, Etot = -27.888065924, dEtot = 7.031e-08, dEband = 1.009e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0238560761741, which took 0.079 ms

iter_count = 102, r_2norm = 9.486e-07, tol*||rhs|| = 9.542e-07

Anderson update took 54.867 ms, out of which F'*F took 25.841 ms; b-Ax took 172.867 ms, out of which Lap took 155.474 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 375.306 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754259, int_b + int_rho = -3.838e-13, checking this took 0.119 ms
2-norm of RHS = 549.3571181558784, which took 0.112 ms

iter_count = 138, r_2norm = 5.276e-04, tol*||rhs|| = 5.494e-04

Anderson update took 73.771 ms, out of which F'*F took 34.881 ms; b-Ax took 235.482 ms, out of which Lap took 211.345 ms
Solving Poisson took 497.461 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.131 ms
Total time for convolution: 	 convolve: 5.076631 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.324 ms
Total time for convolution: 	 convolve: 5.078503 
Total time for convolution: 	 convolve: 5.081066 
Total time for convolution: 	 convolve: 5.084089 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.539 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.099 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.007 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
---Transfer Veff_loc: D2D took 0.674 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.319 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.011 ms

This SCF took 26359.231 ms, scf error = 1.163e-04
-------------
SCF iter 21  
-------------

 Chebfilt 24, in Chebyshev filtering, lambda_cutoff = 0.133056, lowerbound = -1.015489, upperbound = 267.574931

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1105.921 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.646 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.445 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.015 ms
rank =  0, Distribute data + matrix mult took 14.121 ms
rank =  0, finding HY took 18.340 ms
rank =  0, distributing HY into block cyclic form took 12.669 ms
rank =  0, finding Y'*HY took 2.107 ms
Rank 0, Project_Hamiltonian used 47.268 ms
Total time for projection: 47.280 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.086 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -1.015328670433552
    last  calculated eigval = 0.032133428620134
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -1.01532867043355
lambda[   2] =  -0.77033515349030
lambda[   3] =  -0.49845051525827
lambda[   4] =  -0.46790649155246
lambda[   5] =  -0.42492654316732
lambda[   6] =  -0.38569551430387
lambda[   7] =  -0.35551082420134
lambda[   8] =  -0.19099163708234
lambda[   9] =  -0.08553725685294
lambda[  10] =  -0.02000620177777
lambda[  11] =  -0.01939862358285
lambda[  12] =   0.02504787278907
lambda[  13] =   0.02924190521552
lambda[  14] =   0.03213342862013
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.153 ms
rank =  0, subspace rotation using ScaLAPACK took 3.340 ms
rank =  0, Distributing orbital back into band + domain format took 12.019 ms
rank = 0, Subspace_Rotation used 15.372 ms

Total time for subspace rotation: 15.375 ms
rank = 0, Efermi =  -0.115568271813 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.129 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.722 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1172.172 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
rank = 0, D2D took 0.721 ms
rank = 0, Transfering density took 0.724 ms
Etot    =   -27.888074311642
Eband   =    -8.218290699624
E1      =    18.083701032455
E2      =    -7.632346154275
E3      =    -9.848128968615
Exc     =    -8.836949246863
Esc     =   -46.397010520267
Entropy =    -0.000000000233
dE = 1.677e-06, dEband = 4.627e-04
rank = 0, Calculating/Estimating energy took 0.996 ms, Etot = -27.888074312, dEtot = 1.677e-06, dEband = 4.627e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0179185278879, which took 0.054 ms

iter_count = 108, r_2norm = 4.922e-07, tol*||rhs|| = 7.167e-07

Anderson update took 58.038 ms, out of which F'*F took 27.163 ms; b-Ax took 183.543 ms, out of which Lap took 165.323 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.891 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000000754298, int_rho =  16.00000000754256, int_b + int_rho = -4.093e-13, checking this took 0.102 ms
2-norm of RHS = 549.3560164903847, which took 0.111 ms

iter_count = 96, r_2norm = 5.433e-04, tol*||rhs|| = 5.494e-04

Anderson update took 51.382 ms, out of which F'*F took 24.256 ms; b-Ax took 162.781 ms, out of which Lap took 145.919 ms
Solving Poisson took 346.625 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.085863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.077950 
Total time for convolution: 	 convolve: 5.091802 
Total time for convolution: 	 convolve: 5.085243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.791 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.541 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.451 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.624 ms

This SCF took 26255.871 ms, scf error = 7.166e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -1.01532867043355, occ[   1] =   2.00000000000000
lambda[   2] =  -0.77033515349030, occ[   2] =   2.00000000000000
lambda[   3] =  -0.49845051525827, occ[   3] =   2.00000000000000
lambda[   4] =  -0.46790649155246, occ[   4] =   2.00000000000000
lambda[   5] =  -0.42492654316732, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38569551430387, occ[   6] =   2.00000000000000
lambda[   7] =  -0.35551082420134, occ[   7] =   2.00000000000000
lambda[   8] =  -0.19099163708234, occ[   8] =   2.00000000000000
lambda[   9] =  -0.08553725685294, occ[   9] =   0.00000000754258
lambda[  10] =  -0.02000620177777, occ[  10] =   0.00000000000000
lambda[  11] =  -0.01939862358285, occ[  11] =   0.00000000000000
lambda[  12] =   0.02504787278907, occ[  12] =   0.00000000000000
lambda[  13] =   0.02924190521552, occ[  13] =   0.00000000000000
lambda[  14] =   0.03213342862013, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.020 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.466 ms, time for Allreduce/Reduce: 5.943 ms 
Time for calculating local force components: 14.070 ms
Start Calculating nonlocal forces
force_nloc = 
  0.00000005994266  -0.04628405968001   0.02469252200955
 -0.00000002721454   0.04628402220980   0.02469252826713
 -0.00000089756983  -0.00000052994254   0.29892674063509
  0.00000035345510  -0.00000007753382   0.21985049989558
  0.00000155839796  -0.00000018953897  -1.14176893349333
force_loc = 
 -0.00000045816532   0.04974199020407  -0.02796192514926
 -0.00000048646541  -0.04974219535438  -0.02796166569530
 -0.00000538736027   0.00000052889024  -0.28270457127396
  0.00000105124837   0.00000050094125  -0.23518585852277
  0.00000331038902  -0.00000029474043   1.12884521498540
Time for calculating nonlocal force components: 23.969 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000030527850   0.00000002537468  -0.00633106129725
[0m[32m  0.00000011721082   0.00000004564966   0.00370262350224
[0m[32m  0.00000009025222  -0.00000000482290   0.02122252701335
[0mTime for calculating XC forces components: 17.926 ms
 Cartesian force = 
 -0.00000019399112   0.00345797819273  -0.00327313131500
 -0.00000030944840  -0.00345812547592  -0.00327286560346
 -0.00000638597705   0.00000007199105   0.00988737988859
  0.00000172614583   0.00000051672576  -0.01163646330025
  0.00000516327074  -0.00000044143363   0.00829508033012
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.316 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.189 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Time for printing density: 390.189 ms
The program took 592.986 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:42
Job ID:        2266455
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=02:01:36,vmem=8332K,walltime=00:10:08,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-003-9-2
---------------------------------------
