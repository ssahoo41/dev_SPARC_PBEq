---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:19:55
Job ID:    2266528
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:02
Job ID:    2266528
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.094 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 27.959 ms
Reading ion file sprc-calc.ion
Number of atom types : 2.
Total number of atoms: 8.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = N.psp8

Reading ion file took 13.338 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 580.392 ms

Freeing SPARC_INPUT_MPI datatype took 0.009 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.933 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.110 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.279484	   11.579960	   10.000000	
   10.411907	   14.092243	   11.527500	
   10.411907	   14.092243	    8.472500	
    8.720516	    8.420040	   10.000000	
    9.588093	    5.907757	    8.472500	
    9.588093	    5.907757	   11.527500	
   10.000000	   13.010627	   10.000000	
   10.000000	    6.989373	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.193 ms
Set up communicators.

--set up spincomm took 3.847 ms

--set up kptcomm took 0.373 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 2, 3}
gridsizes = [100, 100, 100], Nstates = 14, dmcomm dims = [1, 2, 3]

--set up dmcomm took 0.012 ms

--set up blacscomm took 0.007 ms
rank = 0, size_blacscomm = 2, ScaLAPACK topology Dims = (2, 1)
nproc = 12, size_blacscomm = 2 = dims[0] * dims[1] = (2, 1)
Nd_blacscomm 170000, Nstates 14 
rank =  0, my blacs rank = 0, BLCYC size (170000, 7), actual size (170000, 7)
rank = 0, mb = nb = 14, mbQ = nbQ = 64
rank = 0, nr_Hp = 14, nc_Hp = 14
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.086 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.354 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 2
# of bands per bandcomm          : 7
npdomain: 6
Embeded Cartesian topology dims: (1,2,3)
# of FD-grid points per processor: 170000 = (100,50,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 8.075 ms

Calculate_SplineDerivRadFun took 0.113 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.271 ms.
time spent on vectorized spline interp: 2.244 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 3.025 ms.
time spent on vectorized spline interp: 1.667 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.616 ms.

Calculating rb for all atom types took 10.831 ms
----------------------
Estimated memory usage
Total: 939.97 MB
orbitals             : 640.87 MB
global sized vectors : 213.62 MB
subspace matrices : 27.56 kB
others : 85.45 MB
----------------------------------------------
Estimated memory usage per processor: 78.33 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.916 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.010 ms
Calculating pseudocharge density ... 
the global sum of int_b = -16.0000000191279, sum_int_rho = 15.4141584414821
PosCharge = 16.000000019128, NegCharge = -15.414158441482, scal_fac = 1.038006718295
After scaling, int_rho = 16.0000000191278, PosCharge + NegCharge - NetCharge = 3.553e-14
--Calculate Vref took 0.324 ms
--Calculate rho_guess took 1.524 ms

 integral of b = -16.0000000191279,
 int{b} + Nelectron + NetCharge = -1.913e-08,
 Esc = -41.8638178037265,
 MPI_Reduce took 6.395 ms

Calculating b & b_ref took 13.026 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.007 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.108 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.003 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.019 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 27.055 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912790, int_b + int_rho = -6.003e-14, checking this took 0.090 ms
2-norm of RHS = 681.5468171877291, which took 0.714 ms

iter_count = 414, r_2norm = 6.106e-04, tol*||rhs|| = 6.815e-04

Anderson update took 227.750 ms, out of which F'*F took 104.129 ms; b-Ax took 708.683 ms, out of which Lap took 634.419 ms
Solving Poisson took 1498.675 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.401 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.140989 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.146268 
Total time for convolution: 	 convolve: 5.171200 
Total time for convolution: 	 convolve: 5.148471 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.524 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 2.306 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
rank = 0, XC calculation took 24666.752 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
---Transfer Veff_loc: D2D took 1.168 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.774 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 3.036 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.655 ms
    Lanczos iter 53, eigmin  = -0.887876264, eigmax = 264.925970253, err_eigmin = 5.906e-05, err_eigmax = 9.571e-03
rank =   0, Lanczos took 120.088 ms, eigmin = -0.887876263763, eigmax = 267.575229955788

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.293677, lowerbound = -0.987876, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1124.004 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 14.202 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.549 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.209 ms
rank =  0, Distribute data + matrix mult took 16.979 ms
rank =  0, finding HY took 18.892 ms
rank =  0, distributing HY into block cyclic form took 13.766 ms
rank =  0, finding Y'*HY took 1.970 ms
Rank 0, Project_Hamiltonian used 51.639 ms
Total time for projection: 51.649 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.390 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.451 ms
    first calculated eigval = 2.797334782958941
    last  calculated eigval = 3.196197459269381
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =   2.79733478295894
lambda[   2] =   2.85180291491500
lambda[   3] =   2.86231259468884
lambda[   4] =   2.91531845994785
lambda[   5] =   2.95190428008562
lambda[   6] =   2.99006291458454
lambda[   7] =   3.02637665547513
lambda[   8] =   3.04657510664195
lambda[   9] =   3.07976879224402
lambda[  10] =   3.08722929809141
lambda[  11] =   3.09908597405518
lambda[  12] =   3.13883611844879
lambda[  13] =   3.15535656719065
lambda[  14] =   3.19619745926938
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 0.466 ms
rank =  0, subspace rotation using ScaLAPACK took 3.271 ms
rank =  0, Distributing orbital back into band + domain format took 12.172 ms
rank = 0, Subspace_Rotation used 15.458 ms

Total time for subspace rotation: 15.462 ms
rank = 0, Efermi =   3.063170001805 calculate fermi energy took 0.062 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.296197, lowerbound = -0.987876, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1125.533 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 32.154 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.455 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.028 ms
rank =  0, Distribute data + matrix mult took 33.653 ms
rank =  0, finding HY took 18.088 ms
rank =  0, distributing HY into block cyclic form took 12.689 ms
rank =  0, finding Y'*HY took 2.129 ms
Rank 0, Project_Hamiltonian used 66.627 ms
Total time for projection: 66.633 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.748717972293569
    last  calculated eigval = 0.459957970890746
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.74871797229357
lambda[   2] =  -0.46104657536340
lambda[   3] =  -0.11439828912814
lambda[   4] =  -0.01182368989938
lambda[   5] =   0.05329898804573
lambda[   6] =   0.12367754378692
lambda[   7] =   0.16647502322984
lambda[   8] =   0.25366578560803
lambda[   9] =   0.30814492239725
lambda[  10] =   0.34918911133563
lambda[  11] =   0.38020873981192
lambda[  12] =   0.41706990517220
lambda[  13] =   0.44029915844081
lambda[  14] =   0.45995797089075
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.421 ms
rank =  0, Distributing orbital back into band + domain format took 12.024 ms
rank = 0, Subspace_Rotation used 15.464 ms

Total time for subspace rotation: 15.467 ms
rank = 0, Efermi =   0.280962823942 calculate fermi energy took 0.021 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.559958, lowerbound = -0.987876, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1131.902 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 29.166 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.022 ms
rank =  0, Distribute data + matrix mult took 30.631 ms
rank =  0, finding HY took 18.009 ms
rank =  0, distributing HY into block cyclic form took 12.836 ms
rank =  0, finding Y'*HY took 2.042 ms
Rank 0, Project_Hamiltonian used 63.558 ms
Total time for projection: 63.563 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.096 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.161 ms
    first calculated eigval = -0.887212257634664
    last  calculated eigval = 0.152099206240222
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88721225763466
lambda[   2] =  -0.88308089728023
lambda[   3] =  -0.51417502390105
lambda[   4] =  -0.50063124997220
lambda[   5] =  -0.49854360624874
lambda[   6] =  -0.48287961629695
lambda[   7] =  -0.32247986773772
lambda[   8] =  -0.30151884090358
lambda[   9] =   0.02991844507515
lambda[  10] =   0.09049532017154
lambda[  11] =   0.10003281109750
lambda[  12] =   0.12317096638910
lambda[  13] =   0.14173068883591
lambda[  14] =   0.15209920624022
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.170 ms
rank =  0, subspace rotation using ScaLAPACK took 3.292 ms
rank =  0, Distributing orbital back into band + domain format took 12.060 ms
rank = 0, Subspace_Rotation used 15.377 ms

Total time for subspace rotation: 15.380 ms
rank = 0, Efermi =   0.000712031535 calculate fermi energy took 0.021 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.252099, lowerbound = -0.987876, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1161.974 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 12.528 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.535 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 14.110 ms
rank =  0, finding HY took 17.932 ms
rank =  0, distributing HY into block cyclic form took 12.676 ms
rank =  0, finding Y'*HY took 2.190 ms
Rank 0, Project_Hamiltonian used 46.939 ms
Total time for projection: 46.944 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.090 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.046 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.888134026228457
    last  calculated eigval = 0.087157422064419
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.88813402622846
lambda[   2] =  -0.88331258779010
lambda[   3] =  -0.51967121872799
lambda[   4] =  -0.50862135417588
lambda[   5] =  -0.50698099456966
lambda[   6] =  -0.49660023923875
lambda[   7] =  -0.33544490447355
lambda[   8] =  -0.33374407058036
lambda[   9] =  -0.01923587372471
lambda[  10] =   0.04996185653757
lambda[  11] =   0.05450017259273
lambda[  12] =   0.05883380037320
lambda[  13] =   0.07835891909228
lambda[  14] =   0.08715742206442
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.305 ms
rank =  0, Distributing orbital back into band + domain format took 12.028 ms
rank = 0, Subspace_Rotation used 15.347 ms

Total time for subspace rotation: 15.350 ms
rank = 0, Efermi =  -0.048442287331 calculate fermi energy took 0.021 ms
rank = 0, --- Calculate rho: sum over local bands took 2.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.719 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.093 ms
rank = 0, Calculating density took 4960.347 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.516 ms
rank = 0, D2D took 0.706 ms
rank = 0, Transfering density took 0.709 ms
Etot    =   -24.433293976032
Eband   =    -8.945018791937
E1      =    18.289060982211
E2      =    -6.915301241157
E3      =    -9.084941650810
Exc     =    -7.913761253971
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 3.054e+00, dEband = 1.118e+00
rank = 0, Calculating/Estimating energy took 0.968 ms, Etot = -24.433293976, dEtot = 3.054e+00, dEband = 1.118e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 48.0787442033924, which took 0.053 ms

iter_count = 96, r_2norm = 1.452e-03, tol*||rhs|| = 1.923e-03

Anderson update took 51.078 ms, out of which F'*F took 24.012 ms; b-Ax took 166.396 ms, out of which Lap took 149.135 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 351.212 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912789, int_b + int_rho = -7.640e-14, checking this took 0.120 ms
2-norm of RHS = 677.4381774968624, which took 0.144 ms

iter_count = 282, r_2norm = 6.498e-04, tol*||rhs|| = 6.774e-04

Anderson update took 148.995 ms, out of which F'*F took 70.223 ms; b-Ax took 480.322 ms, out of which Lap took 428.567 ms
Solving Poisson took 1014.235 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.353 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.261 ms
Total time for convolution: 	 convolve: 5.879547 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
Total time for convolution: 	 convolve: 5.086201 
Total time for convolution: 	 convolve: 5.177615 
Total time for convolution: 	 convolve: 5.113084 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.346 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.332 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.253 ms
---Transfer Veff_loc: D2D took 0.693 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 1.102 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.826 ms

This SCF took 31576.455 ms, scf error = 1.760e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.187157, lowerbound = -0.888134, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.738 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.563 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.559 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.157 ms
rank =  0, finding HY took 18.031 ms
rank =  0, distributing HY into block cyclic form took 12.786 ms
rank =  0, finding Y'*HY took 2.044 ms
Rank 0, Project_Hamiltonian used 47.045 ms
Total time for projection: 47.056 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.083 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.846980483230094
    last  calculated eigval = 0.065250439549199
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.84698048323009
lambda[   2] =  -0.84168007268704
lambda[   3] =  -0.48507753192105
lambda[   4] =  -0.47319496198009
lambda[   5] =  -0.47128395683127
lambda[   6] =  -0.46010690615633
lambda[   7] =  -0.29248178426065
lambda[   8] =  -0.29049735942292
lambda[   9] =  -0.03908655765807
lambda[  10] =   0.02284551477091
lambda[  11] =   0.02835925615853
lambda[  12] =   0.03726650955950
lambda[  13] =   0.04560108039621
lambda[  14] =   0.06525043954920
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 3.300 ms
rank =  0, Distributing orbital back into band + domain format took 12.085 ms
rank = 0, Subspace_Rotation used 15.397 ms

Total time for subspace rotation: 15.401 ms
rank = 0, Efermi =  -0.068292971202 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.164 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.652 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.084 ms
rank = 0, Calculating density took 1185.398 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.456 ms
rank = 0, D2D took 0.665 ms
rank = 0, Transfering density took 0.668 ms
Etot    =   -24.380675608510
Eband   =    -8.322606113727
E1      =    17.771522644785
E2      =    -6.829743147419
E3      =    -9.247050244414
Exc     =    -8.042567727099
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 6.577e-03, dEband = 7.780e-02
rank = 0, Calculating/Estimating energy took 1.011 ms, Etot = -24.380675609, dEtot = 6.577e-03, dEband = 7.780e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.6619499235425, which took 0.060 ms

iter_count = 102, r_2norm = 5.400e-04, tol*||rhs|| = 8.265e-04

Anderson update took 54.611 ms, out of which F'*F took 54.351 ms; b-Ax took 202.055 ms, out of which Lap took 184.301 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 405.545 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912784, int_b + int_rho = -1.219e-13, checking this took 0.125 ms
2-norm of RHS = 673.6881876660219, which took 0.160 ms

iter_count = 288, r_2norm = 6.142e-04, tol*||rhs|| = 6.737e-04

Anderson update took 152.332 ms, out of which F'*F took 71.860 ms; b-Ax took 492.475 ms, out of which Lap took 440.114 ms
Solving Poisson took 1038.973 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.476 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.590 ms
Total time for convolution: 	 convolve: 5.137316 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.120620 
Total time for convolution: 	 convolve: 5.119501 
Total time for convolution: 	 convolve: 5.120216 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.455 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.190 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.415 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.268 ms
---Transfer Veff_loc: D2D took 0.740 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.533 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.291 ms

This SCF took 27140.588 ms, scf error = 1.128e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.165250, lowerbound = -0.846980, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1155.109 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.545 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.758 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.012 ms
rank =  0, Distribute data + matrix mult took 14.326 ms
rank =  0, finding HY took 19.390 ms
rank =  0, distributing HY into block cyclic form took 12.726 ms
rank =  0, finding Y'*HY took 2.131 ms
Rank 0, Project_Hamiltonian used 48.601 ms
Total time for projection: 48.614 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.120 ms
    first calculated eigval = -0.803122731277934
    last  calculated eigval = 0.055793420927965
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.80312273127793
lambda[   2] =  -0.79746121929071
lambda[   3] =  -0.44737061653592
lambda[   4] =  -0.43491620859800
lambda[   5] =  -0.43287754770326
lambda[   6] =  -0.42062875841286
lambda[   7] =  -0.24851062873074
lambda[   8] =  -0.24601130318167
lambda[   9] =  -0.04344961585062
lambda[  10] =   0.01061689161787
lambda[  11] =   0.01914282307819
lambda[  12] =   0.02897970639968
lambda[  13] =   0.03411002649041
lambda[  14] =   0.05579342092797
==subpsace eigenproblem: bcast eigvals took 0.015 ms
Total time for solving subspace eigenvalue problem: 0.161 ms
rank =  0, subspace rotation using ScaLAPACK took 3.287 ms
rank =  0, Distributing orbital back into band + domain format took 12.210 ms
rank = 0, Subspace_Rotation used 15.508 ms

Total time for subspace rotation: 15.512 ms
rank = 0, Efermi =  -0.072656029399 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.127 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.725 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.088 ms
rank = 0, Calculating density took 1222.480 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.469 ms
rank = 0, D2D took 0.715 ms
rank = 0, Transfering density took 0.718 ms
Etot    =   -24.358580714879
Eband   =    -7.661798028293
E1      =    17.234631644827
E2      =    -6.687111243026
E3      =    -9.442557524315
Exc     =    -8.197265294453
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 2.762e-03, dEband = 8.260e-02
rank = 0, Calculating/Estimating energy took 0.988 ms, Etot = -24.358580715, dEtot = 2.762e-03, dEband = 8.260e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 4.3224382833290, which took 0.049 ms

iter_count = 108, r_2norm = 1.073e-04, tol*||rhs|| = 1.729e-04

Anderson update took 57.607 ms, out of which F'*F took 26.824 ms; b-Ax took 183.060 ms, out of which Lap took 163.746 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 397.568 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912780, int_b + int_rho = -1.619e-13, checking this took 0.082 ms
2-norm of RHS = 673.7126846108126, which took 0.131 ms

iter_count = 282, r_2norm = 5.507e-04, tol*||rhs|| = 6.737e-04

Anderson update took 151.215 ms, out of which F'*F took 69.747 ms; b-Ax took 475.770 ms, out of which Lap took 426.567 ms
Solving Poisson took 1013.323 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.373 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.122814 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 14.638 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.141340 
Total time for convolution: 	 convolve: 5.118531 
Total time for convolution: 	 convolve: 5.112673 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.299 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 0.669 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.297 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.984 ms

This SCF took 27322.077 ms, scf error = 5.873e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.155793, lowerbound = -0.803123, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1152.842 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.576 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.457 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.075 ms
rank =  0, finding HY took 18.225 ms
rank =  0, distributing HY into block cyclic form took 12.428 ms
rank =  0, finding Y'*HY took 2.306 ms
Rank 0, Project_Hamiltonian used 47.064 ms
Total time for projection: 47.077 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.134 ms
    first calculated eigval = -0.789863689166520
    last  calculated eigval = 0.048769283928346
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.78986368916652
lambda[   2] =  -0.78427441036357
lambda[   3] =  -0.43299322790881
lambda[   4] =  -0.42126440607405
lambda[   5] =  -0.41919275363657
lambda[   6] =  -0.40647141893406
lambda[   7] =  -0.23762163877096
lambda[   8] =  -0.23509015121947
lambda[   9] =  -0.04373257123033
lambda[  10] =   0.00534498995557
lambda[  11] =   0.01402379913566
lambda[  12] =   0.02488185416004
lambda[  13] =   0.02918586406676
lambda[  14] =   0.04876928392835
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.397 ms
rank =  0, Distributing orbital back into band + domain format took 11.960 ms
rank = 0, Subspace_Rotation used 15.369 ms

Total time for subspace rotation: 15.373 ms
rank = 0, Efermi =  -0.072938984889 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 2.111 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.895 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.095 ms
rank = 0, Calculating density took 1218.686 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.407 ms
rank = 0, D2D took 0.708 ms
rank = 0, Transfering density took 0.711 ms
Etot    =   -24.353883817120
Eband   =    -7.453543392985
E1      =    17.118359881054
E2      =    -6.580376755489
E3      =    -9.522643485835
Exc     =    -8.257902742212
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 5.871e-04, dEband = 2.603e-02
rank = 0, Calculating/Estimating energy took 1.029 ms, Etot = -24.353883817, dEtot = 5.871e-04, dEband = 2.603e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4808251663306, which took 0.074 ms

iter_count = 108, r_2norm = 5.554e-05, tol*||rhs|| = 5.923e-05

Anderson update took 57.491 ms, out of which F'*F took 27.550 ms; b-Ax took 183.425 ms, out of which Lap took 164.557 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.091 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912786, int_b + int_rho = -9.459e-14, checking this took 0.103 ms
2-norm of RHS = 673.5091620194429, which took 0.128 ms

iter_count = 246, r_2norm = 6.095e-04, tol*||rhs|| = 6.735e-04

Anderson update took 132.067 ms, out of which F'*F took 61.651 ms; b-Ax took 418.846 ms, out of which Lap took 375.703 ms
Solving Poisson took 885.161 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.117785 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
Total time for convolution: 	 convolve: 5.159731 
Total time for convolution: 	 convolve: 5.117085 
Total time for convolution: 	 convolve: 5.120409 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.359 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.293 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 27088.722 ms, scf error = 1.085e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.148769, lowerbound = -0.789864, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1150.284 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.552 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.429 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 14.021 ms
rank =  0, finding HY took 18.171 ms
rank =  0, distributing HY into block cyclic form took 12.972 ms
rank =  0, finding Y'*HY took 1.963 ms
Rank 0, Project_Hamiltonian used 47.160 ms
Total time for projection: 47.176 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.040 ms
rank = 0, Solve_Generalized_EigenProblem used 0.129 ms
    first calculated eigval = -0.783771413095168
    last  calculated eigval = 0.041738232373292
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.78377141309517
lambda[   2] =  -0.77815381420513
lambda[   3] =  -0.42745514192603
lambda[   4] =  -0.41588635635477
lambda[   5] =  -0.41378844619108
lambda[   6] =  -0.40079565478348
lambda[   7] =  -0.23178211267627
lambda[   8] =  -0.22916166253636
lambda[   9] =  -0.04381912003876
lambda[  10] =   0.00265930562589
lambda[  11] =   0.01206247789639
lambda[  12] =   0.02220480658870
lambda[  13] =   0.02706079087417
lambda[  14] =   0.04173823237329
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.141 ms
rank =  0, subspace rotation using ScaLAPACK took 3.304 ms
rank =  0, Distributing orbital back into band + domain format took 12.171 ms
rank = 0, Subspace_Rotation used 15.490 ms

Total time for subspace rotation: 15.493 ms
rank = 0, Efermi =  -0.073025533759 calculate fermi energy took 0.130 ms
rank = 0, --- Calculate rho: sum over local bands took 2.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.732 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1216.184 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.465 ms
rank = 0, D2D took 0.714 ms
rank = 0, Transfering density took 0.717 ms
Etot    =   -24.353261999888
Eband   =    -7.361589204375
E1      =    17.054930801414
E2      =    -6.545994487622
E3      =    -9.550189427868
Exc     =    -8.278969708115
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 7.773e-05, dEband = 1.149e-02
rank = 0, Calculating/Estimating energy took 1.580 ms, Etot = -24.353262000, dEtot = 7.773e-05, dEband = 1.149e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5257610638078, which took 0.053 ms

iter_count = 114, r_2norm = 1.341e-05, tol*||rhs|| = 2.103e-05

Anderson update took 60.683 ms, out of which F'*F took 29.186 ms; b-Ax took 194.062 ms, out of which Lap took 173.959 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 420.475 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912783, int_b + int_rho = -1.328e-13, checking this took 0.120 ms
2-norm of RHS = 673.9038670858710, which took 0.075 ms

iter_count = 264, r_2norm = 5.634e-04, tol*||rhs|| = 6.739e-04

Anderson update took 141.875 ms, out of which F'*F took 67.939 ms; b-Ax took 452.588 ms, out of which Lap took 406.166 ms
Solving Poisson took 954.772 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.117197 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.116380 
Total time for convolution: 	 convolve: 5.110011 
Total time for convolution: 	 convolve: 5.111780 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.592 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.097 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
---Transfer Veff_loc: D2D took 0.683 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.992 ms

This SCF took 27065.909 ms, scf error = 7.013e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.141738, lowerbound = -0.783771, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1154.516 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.630 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.440 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.030 ms
rank =  0, Distribute data + matrix mult took 14.116 ms
rank =  0, finding HY took 18.355 ms
rank =  0, distributing HY into block cyclic form took 13.457 ms
rank =  0, finding Y'*HY took 1.800 ms
Rank 0, Project_Hamiltonian used 47.764 ms
Total time for projection: 47.777 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.051 ms
rank = 0, Solve_Generalized_EigenProblem used 0.141 ms
    first calculated eigval = -0.778922271338299
    last  calculated eigval = 0.035601302974175
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77892227133830
lambda[   2] =  -0.77333540971769
lambda[   3] =  -0.42259404664602
lambda[   4] =  -0.41162725411395
lambda[   5] =  -0.40952027846917
lambda[   6] =  -0.39601467404874
lambda[   7] =  -0.22707327960316
lambda[   8] =  -0.22439312093153
lambda[   9] =  -0.04332130666249
lambda[  10] =   0.00138745617862
lambda[  11] =   0.01156462105351
lambda[  12] =   0.01910875594578
lambda[  13] =   0.02672897065532
lambda[  14] =   0.03560130297417
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.152 ms
rank =  0, subspace rotation using ScaLAPACK took 3.214 ms
rank =  0, Distributing orbital back into band + domain format took 12.255 ms
rank = 0, Subspace_Rotation used 15.485 ms

Total time for subspace rotation: 15.489 ms
rank = 0, Efermi =  -0.072527720229 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.118 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.730 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1220.999 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
rank = 0, D2D took 0.737 ms
rank = 0, Transfering density took 0.740 ms
Etot    =   -24.353063237111
Eband   =    -7.286960670566
E1      =    17.026302720934
E2      =    -6.495813222990
E3      =    -9.562084322139
Exc     =    -8.286485028307
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 2.485e-05, dEband = 9.329e-03
rank = 0, Calculating/Estimating energy took 1.521 ms, Etot = -24.353063237, dEtot = 2.485e-05, dEband = 9.329e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3885041913347, which took 0.067 ms

iter_count = 108, r_2norm = 1.457e-05, tol*||rhs|| = 1.554e-05

Anderson update took 58.155 ms, out of which F'*F took 27.013 ms; b-Ax took 185.296 ms, out of which Lap took 166.143 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 398.103 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912787, int_b + int_rho = -9.095e-14, checking this took 0.098 ms
2-norm of RHS = 673.8618699136692, which took 0.092 ms

iter_count = 222, r_2norm = 6.198e-04, tol*||rhs|| = 6.739e-04

Anderson update took 118.711 ms, out of which F'*F took 55.255 ms; b-Ax took 380.825 ms, out of which Lap took 341.751 ms
Solving Poisson took 800.463 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.125576 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.118299 
Total time for convolution: 	 convolve: 5.114071 
Total time for convolution: 	 convolve: 5.155436 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.834 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
---Transfer Veff_loc: D2D took 0.675 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.314 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.005 ms

This SCF took 26954.647 ms, scf error = 2.480e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.135601, lowerbound = -0.778922, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1121.044 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.518 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.412 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.032 ms
rank =  0, Distribute data + matrix mult took 13.977 ms
rank =  0, finding HY took 18.573 ms
rank =  0, distributing HY into block cyclic form took 12.748 ms
rank =  0, finding Y'*HY took 2.018 ms
Rank 0, Project_Hamiltonian used 47.350 ms
Total time for projection: 47.364 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.082 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.135 ms
    first calculated eigval = -0.777249136959076
    last  calculated eigval = 0.030804321170396
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77724913695908
lambda[   2] =  -0.77166826216251
lambda[   3] =  -0.42090520828194
lambda[   4] =  -0.41006038584325
lambda[   5] =  -0.40795313389339
lambda[   6] =  -0.39431963289908
lambda[   7] =  -0.22532801158541
lambda[   8] =  -0.22264634980171
lambda[   9] =  -0.04276730903454
lambda[  10] =   0.00076345436733
lambda[  11] =   0.01146637491416
lambda[  12] =   0.01756514861390
lambda[  13] =   0.02691979702341
lambda[  14] =   0.03080432117040
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.146 ms
rank =  0, subspace rotation using ScaLAPACK took 3.593 ms
rank =  0, Distributing orbital back into band + domain format took 11.844 ms
rank = 0, Subspace_Rotation used 15.456 ms

Total time for subspace rotation: 15.460 ms
rank = 0, Efermi =  -0.071973722573 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.064 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.438 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.182 ms
rank = 0, Calculating density took 1187.819 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.436 ms
rank = 0, D2D took 0.544 ms
rank = 0, Transfering density took 0.546 ms
Etot    =   -24.353073032895
Eband   =    -7.260260243671
E1      =    17.010986866186
E2      =    -6.483152014261
E3      =    -9.567191460503
Exc     =    -8.290325325872
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 1.224e-06, dEband = 3.338e-03
rank = 0, Calculating/Estimating energy took 0.911 ms, Etot = -24.353073033, dEtot = 1.224e-06, dEband = 3.338e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1682911961293, which took 0.060 ms

iter_count = 114, r_2norm = 4.598e-06, tol*||rhs|| = 6.732e-06

Anderson update took 61.375 ms, out of which F'*F took 31.291 ms; b-Ax took 207.041 ms, out of which Lap took 186.625 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 431.468 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912784, int_b + int_rho = -1.182e-13, checking this took 0.107 ms
2-norm of RHS = 673.8695415821912, which took 0.123 ms

iter_count = 228, r_2norm = 6.473e-04, tol*||rhs|| = 6.739e-04

Anderson update took 122.166 ms, out of which F'*F took 57.589 ms; b-Ax took 390.000 ms, out of which Lap took 349.177 ms
Solving Poisson took 821.711 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.087 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.264 ms
Total time for convolution: 	 convolve: 5.178570 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.325 ms
Total time for convolution: 	 convolve: 5.151868 
Total time for convolution: 	 convolve: 5.142415 
Total time for convolution: 	 convolve: 5.112549 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.839 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.347 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.412 ms
---Transfer Veff_loc: D2D took 0.672 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.307 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.994 ms

This SCF took 27045.034 ms, scf error = 1.847e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.130804, lowerbound = -0.777249, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1122.623 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.857 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.429 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.025 ms
rank =  0, Distribute data + matrix mult took 14.328 ms
rank =  0, finding HY took 18.508 ms
rank =  0, distributing HY into block cyclic form took 12.793 ms
rank =  0, finding Y'*HY took 2.008 ms
Rank 0, Project_Hamiltonian used 47.670 ms
Total time for projection: 47.683 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.087 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.140 ms
    first calculated eigval = -0.775800160359194
    last  calculated eigval = 0.029345718526017
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77580016035919
lambda[   2] =  -0.77023406477717
lambda[   3] =  -0.41932613403288
lambda[   4] =  -0.40866455219406
lambda[   5] =  -0.40656528501018
lambda[   6] =  -0.39276320329751
lambda[   7] =  -0.22368484967126
lambda[   8] =  -0.22102179576307
lambda[   9] =  -0.04046061732002
lambda[  10] =   0.00226719035113
lambda[  11] =   0.01370673933410
lambda[  12] =   0.01708607218384
lambda[  13] =   0.02789414284080
lambda[  14] =   0.02934571852602
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.151 ms
rank =  0, subspace rotation using ScaLAPACK took 3.141 ms
rank =  0, Distributing orbital back into band + domain format took 12.463 ms
rank = 0, Subspace_Rotation used 15.618 ms

Total time for subspace rotation: 15.622 ms
rank = 0, Efermi =  -0.069667030994 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 2.113 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.783 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1189.173 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.524 ms
rank = 0, D2D took 0.718 ms
rank = 0, Transfering density took 0.722 ms
Etot    =   -24.353141773132
Eband   =    -7.236120090985
E1      =    17.000735221098
E2      =    -6.468971673884
E3      =    -9.567893244824
Exc     =    -8.290804017651
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 8.593e-06, dEband = 3.018e-03
rank = 0, Calculating/Estimating energy took 0.994 ms, Etot = -24.353141773, dEtot = 8.593e-06, dEband = 3.018e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1292393264641, which took 0.090 ms

iter_count = 108, r_2norm = 4.856e-06, tol*||rhs|| = 5.170e-06

Anderson update took 57.931 ms, out of which F'*F took 27.221 ms; b-Ax took 186.428 ms, out of which Lap took 166.740 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.228 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912782, int_b + int_rho = -1.419e-13, checking this took 0.141 ms
2-norm of RHS = 673.8737708769172, which took 0.100 ms

iter_count = 210, r_2norm = 5.772e-04, tol*||rhs|| = 6.739e-04

Anderson update took 113.288 ms, out of which F'*F took 52.637 ms; b-Ax took 358.849 ms, out of which Lap took 321.153 ms
Solving Poisson took 757.772 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.095 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.127414 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.188 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.156613 
Total time for convolution: 	 convolve: 5.114547 
Total time for convolution: 	 convolve: 5.125303 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.245 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 0.664 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.296 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.974 ms

This SCF took 26961.753 ms, scf error = 9.380e-04
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129346, lowerbound = -0.775800, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.657 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.566 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.415 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.033 ms
rank =  0, Distribute data + matrix mult took 14.030 ms
rank =  0, finding HY took 18.446 ms
rank =  0, distributing HY into block cyclic form took 13.073 ms
rank =  0, finding Y'*HY took 1.935 ms
Rank 0, Project_Hamiltonian used 47.519 ms
Total time for projection: 47.532 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.084 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.774631315690284
    last  calculated eigval = 0.029772232955021
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77463131569028
lambda[   2] =  -0.76906969381403
lambda[   3] =  -0.41814985313871
lambda[   4] =  -0.40757342352955
lambda[   5] =  -0.40547825748638
lambda[   6] =  -0.39158917115526
lambda[   7] =  -0.22258377104523
lambda[   8] =  -0.21991460349715
lambda[   9] =  -0.03807512623824
lambda[  10] =   0.00417571050231
lambda[  11] =   0.01577730416023
lambda[  12] =   0.01800643363438
lambda[  13] =   0.02810814616742
lambda[  14] =   0.02977223295502
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.148 ms
rank =  0, subspace rotation using ScaLAPACK took 3.187 ms
rank =  0, Distributing orbital back into band + domain format took 12.424 ms
rank = 0, Subspace_Rotation used 15.627 ms

Total time for subspace rotation: 15.631 ms
rank = 0, Efermi =  -0.067281539866 calculate fermi energy took 0.050 ms
rank = 0, --- Calculate rho: sum over local bands took 2.182 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.705 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1183.057 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.489 ms
rank = 0, D2D took 0.686 ms
rank = 0, Transfering density took 0.688 ms
Etot    =   -24.353218342059
Eband   =    -7.217980179441
E1      =    16.991605570945
E2      =    -6.459573814814
E3      =    -9.569591915266
Exc     =    -8.292191659340
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 9.571e-06, dEband = 2.267e-03
rank = 0, Calculating/Estimating energy took 1.012 ms, Etot = -24.353218342, dEtot = 9.571e-06, dEband = 2.267e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0830746578712, which took 0.049 ms

iter_count = 108, r_2norm = 2.807e-06, tol*||rhs|| = 3.323e-06

Anderson update took 58.596 ms, out of which F'*F took 27.398 ms; b-Ax took 186.684 ms, out of which Lap took 167.011 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 400.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912788, int_b + int_rho = -8.185e-14, checking this took 0.076 ms
2-norm of RHS = 673.8833667621034, which took 0.101 ms

iter_count = 192, r_2norm = 6.132e-04, tol*||rhs|| = 6.739e-04

Anderson update took 103.136 ms, out of which F'*F took 48.208 ms; b-Ax took 328.020 ms, out of which Lap took 293.487 ms
Solving Poisson took 694.271 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.370 ms
Total time for convolution: 	 convolve: 5.121090 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Total time for convolution: 	 convolve: 5.118030 
Total time for convolution: 	 convolve: 5.116997 
Total time for convolution: 	 convolve: 5.137352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.818 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.020 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.287 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.400 ms
---Transfer Veff_loc: D2D took 0.668 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.978 ms

This SCF took 26775.046 ms, scf error = 5.981e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.129772, lowerbound = -0.774631, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.160 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.563 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.407 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.006 ms
rank =  0, finding HY took 18.428 ms
rank =  0, distributing HY into block cyclic form took 12.781 ms
rank =  0, finding Y'*HY took 1.999 ms
Rank 0, Project_Hamiltonian used 47.244 ms
Total time for projection: 47.259 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.092 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.048 ms
rank = 0, Solve_Generalized_EigenProblem used 0.144 ms
    first calculated eigval = -0.774146399224103
    last  calculated eigval = 0.030261272179276
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77414639922410
lambda[   2] =  -0.76858885754931
lambda[   3] =  -0.41763117436194
lambda[   4] =  -0.40708435692580
lambda[   5] =  -0.40499159864281
lambda[   6] =  -0.39108019850034
lambda[   7] =  -0.22216956471650
lambda[   8] =  -0.21949719733727
lambda[   9] =  -0.03601082275588
lambda[  10] =   0.00587741825966
lambda[  11] =   0.01640307268425
lambda[  12] =   0.02059687527118
lambda[  13] =   0.02984721528298
lambda[  14] =   0.03026127217928
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.155 ms
rank =  0, subspace rotation using ScaLAPACK took 3.232 ms
rank =  0, Distributing orbital back into band + domain format took 12.507 ms
rank = 0, Subspace_Rotation used 15.761 ms

Total time for subspace rotation: 15.765 ms
rank = 0, Efermi =  -0.065217236299 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.099 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.766 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.077 ms
rank = 0, Calculating density took 1186.461 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.527 ms
rank = 0, D2D took 0.711 ms
rank = 0, Transfering density took 0.720 ms
Etot    =   -24.353306044909
Eband   =    -7.210378695205
E1      =    16.988223886833
E2      =    -6.455313117068
E3      =    -9.569867409839
Exc     =    -8.292513959142
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 1.096e-05, dEband = 9.502e-04
rank = 0, Calculating/Estimating energy took 0.965 ms, Etot = -24.353306045, dEtot = 1.096e-05, dEband = 9.502e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0516052183354, which took 0.052 ms

iter_count = 114, r_2norm = 1.322e-06, tol*||rhs|| = 2.064e-06

Anderson update took 61.188 ms, out of which F'*F took 28.798 ms; b-Ax took 197.206 ms, out of which Lap took 176.099 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.201 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912785, int_b + int_rho = -1.128e-13, checking this took 0.112 ms
2-norm of RHS = 673.8853878055356, which took 0.173 ms

iter_count = 174, r_2norm = 5.922e-04, tol*||rhs|| = 6.739e-04

Anderson update took 93.363 ms, out of which F'*F took 43.749 ms; b-Ax took 297.413 ms, out of which Lap took 266.526 ms
Solving Poisson took 628.064 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.174415 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.129009 
Total time for convolution: 	 convolve: 5.129536 
Total time for convolution: 	 convolve: 5.142790 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.811 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.055 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.278 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 0.680 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.311 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.008 ms

This SCF took 26816.746 ms, scf error = 4.819e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.130261, lowerbound = -0.774146, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1116.545 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.637 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.090 ms
rank =  0, finding HY took 18.545 ms
rank =  0, distributing HY into block cyclic form took 12.479 ms
rank =  0, finding Y'*HY took 2.287 ms
Rank 0, Project_Hamiltonian used 47.435 ms
Total time for projection: 47.447 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.636 ms
rank = 0, Solve_Generalized_EigenProblem used 0.704 ms
    first calculated eigval = -0.773590757043407
    last  calculated eigval = 0.031439324175627
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77359075704341
lambda[   2] =  -0.76803396137209
lambda[   3] =  -0.41709180230521
lambda[   4] =  -0.40657481844770
lambda[   5] =  -0.40448123851239
lambda[   6] =  -0.39053977470571
lambda[   7] =  -0.22162646648597
lambda[   8] =  -0.21894810752963
lambda[   9] =  -0.03439603705565
lambda[  10] =   0.00693863978174
lambda[  11] =   0.01688497069449
lambda[  12] =   0.02247189753601
lambda[  13] =   0.03074944409867
lambda[  14] =   0.03143932417563
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.717 ms
rank =  0, subspace rotation using ScaLAPACK took 3.105 ms
rank =  0, Distributing orbital back into band + domain format took 12.454 ms
rank = 0, Subspace_Rotation used 15.575 ms

Total time for subspace rotation: 15.597 ms
rank = 0, Efermi =  -0.063602450722 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 2.199 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.729 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1183.515 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.532 ms
rank = 0, D2D took 0.757 ms
rank = 0, Transfering density took 0.765 ms
Etot    =   -24.353333921296
Eband   =    -7.201773853462
E1      =    16.983489431745
E2      =    -6.451122870629
E3      =    -9.571191426694
Exc     =    -8.293545992600
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 3.485e-06, dEband = 1.076e-03
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -24.353333921, dEtot = 3.485e-06, dEband = 1.076e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0325681203104, which took 0.057 ms

iter_count = 108, r_2norm = 1.167e-06, tol*||rhs|| = 1.303e-06

Anderson update took 57.839 ms, out of which F'*F took 27.383 ms; b-Ax took 186.567 ms, out of which Lap took 166.776 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.686 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912782, int_b + int_rho = -1.382e-13, checking this took 0.093 ms
2-norm of RHS = 673.8966504054117, which took 0.072 ms

iter_count = 174, r_2norm = 5.364e-04, tol*||rhs|| = 6.739e-04

Anderson update took 93.311 ms, out of which F'*F took 43.613 ms; b-Ax took 297.752 ms, out of which Lap took 266.648 ms
Solving Poisson took 627.765 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.286 ms
Total time for convolution: 	 convolve: 5.125715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.334 ms
Total time for convolution: 	 convolve: 5.114170 
Total time for convolution: 	 convolve: 5.136079 
Total time for convolution: 	 convolve: 5.112291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.387 ms
---Transfer Veff_loc: D2D took 0.663 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.292 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.968 ms

This SCF took 26731.905 ms, scf error = 2.802e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131439, lowerbound = -0.773591, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1115.778 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.515 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.417 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.060 ms
rank =  0, Distribute data + matrix mult took 14.028 ms
rank =  0, finding HY took 18.882 ms
rank =  0, distributing HY into block cyclic form took 12.813 ms
rank =  0, finding Y'*HY took 2.037 ms
Rank 0, Project_Hamiltonian used 47.796 ms
Total time for projection: 47.814 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.131 ms
    first calculated eigval = -0.773342053340295
    last  calculated eigval = 0.033246482398633
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77334205334029
lambda[   2] =  -0.76778826474397
lambda[   3] =  -0.41681760804000
lambda[   4] =  -0.40631961628015
lambda[   5] =  -0.40422473627049
lambda[   6] =  -0.39027590982226
lambda[   7] =  -0.22136451176603
lambda[   8] =  -0.21868416024062
lambda[   9] =  -0.03296760788907
lambda[  10] =   0.00804457738770
lambda[  11] =   0.01771839209791
lambda[  12] =   0.02438059051958
lambda[  13] =   0.03189764020109
lambda[  14] =   0.03324648239863
==subpsace eigenproblem: bcast eigvals took 0.042 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 3.282 ms
rank =  0, Distributing orbital back into band + domain format took 12.096 ms
rank = 0, Subspace_Rotation used 15.393 ms

Total time for subspace rotation: 15.397 ms
rank = 0, Efermi =  -0.062174021552 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 2.106 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.785 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.081 ms
rank = 0, Calculating density took 1182.289 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.544 ms
rank = 0, D2D took 0.739 ms
rank = 0, Transfering density took 0.746 ms
Etot    =   -24.353398809276
Eband   =    -7.197633721638
E1      =    16.981902865193
E2      =    -6.448515503967
E3      =    -9.571210339339
Exc     =    -8.293575991836
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 8.111e-06, dEband = 5.175e-04
rank = 0, Calculating/Estimating energy took 0.960 ms, Etot = -24.353398809, dEtot = 8.111e-06, dEband = 5.175e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304632537502, which took 0.103 ms

iter_count = 108, r_2norm = 1.082e-06, tol*||rhs|| = 1.219e-06

Anderson update took 58.193 ms, out of which F'*F took 27.112 ms; b-Ax took 186.546 ms, out of which Lap took 166.553 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.556 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912785, int_b + int_rho = -1.091e-13, checking this took 0.112 ms
2-norm of RHS = 673.8948798756185, which took 0.098 ms

iter_count = 138, r_2norm = 5.694e-04, tol*||rhs|| = 6.739e-04

Anderson update took 75.084 ms, out of which F'*F took 34.720 ms; b-Ax took 235.748 ms, out of which Lap took 210.900 ms
Solving Poisson took 499.438 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Total time for convolution: 	 convolve: 5.116715 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.130456 
Total time for convolution: 	 convolve: 5.160187 
Total time for convolution: 	 convolve: 5.144872 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.204 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.432 ms
---Transfer Veff_loc: D2D took 0.713 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.308 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.036 ms

This SCF took 26688.197 ms, scf error = 2.581e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133246, lowerbound = -0.773342, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.845 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.507 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.407 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.035 ms
rank =  0, Distribute data + matrix mult took 13.965 ms
rank =  0, finding HY took 18.616 ms
rank =  0, distributing HY into block cyclic form took 12.754 ms
rank =  0, finding Y'*HY took 1.991 ms
Rank 0, Project_Hamiltonian used 47.363 ms
Total time for projection: 47.378 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.138 ms
    first calculated eigval = -0.773187398350035
    last  calculated eigval = 0.034320310499274
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77318739835003
lambda[   2] =  -0.76763356461037
lambda[   3] =  -0.41667026522260
lambda[   4] =  -0.40617797414695
lambda[   5] =  -0.40408246034029
lambda[   6] =  -0.39012789166900
lambda[   7] =  -0.22121244186956
lambda[   8] =  -0.21852945251263
lambda[   9] =  -0.03254703677083
lambda[  10] =   0.00831027727063
lambda[  11] =   0.01801639481440
lambda[  12] =   0.02499241161902
lambda[  13] =   0.03221838206102
lambda[  14] =   0.03432031049927
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.149 ms
rank =  0, subspace rotation using ScaLAPACK took 3.305 ms
rank =  0, Distributing orbital back into band + domain format took 12.094 ms
rank = 0, Subspace_Rotation used 15.417 ms

Total time for subspace rotation: 15.435 ms
rank = 0, Efermi =  -0.061753450384 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.111 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.827 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.082 ms
rank = 0, Calculating density took 1185.989 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.526 ms
rank = 0, D2D took 0.715 ms
rank = 0, Transfering density took 0.718 ms
Etot    =   -24.353411658236
Eband   =    -7.195242898065
E1      =    16.980520607905
E2      =    -6.447412410439
E3      =    -9.571577006655
Exc     =    -8.293860980867
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 1.606e-06, dEband = 2.989e-04
rank = 0, Calculating/Estimating energy took 0.951 ms, Etot = -24.353411658, dEtot = 1.606e-06, dEband = 2.989e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0271547443938, which took 0.086 ms

iter_count = 108, r_2norm = 9.549e-07, tol*||rhs|| = 1.086e-06

Anderson update took 57.869 ms, out of which F'*F took 27.340 ms; b-Ax took 186.331 ms, out of which Lap took 166.436 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.328 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912783, int_b + int_rho = -1.328e-13, checking this took 0.122 ms
2-norm of RHS = 673.8925432157348, which took 0.097 ms

iter_count = 132, r_2norm = 6.341e-04, tol*||rhs|| = 6.739e-04

Anderson update took 70.839 ms, out of which F'*F took 33.269 ms; b-Ax took 225.194 ms, out of which Lap took 201.654 ms
Solving Poisson took 477.009 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.148344 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.321 ms
Total time for convolution: 	 convolve: 5.184890 
Total time for convolution: 	 convolve: 5.144308 
Total time for convolution: 	 convolve: 5.129260 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.387 ms
---Transfer Veff_loc: D2D took 0.657 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.295 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26710.407 ms, scf error = 1.644e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.134320, lowerbound = -0.773187, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1120.132 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 12.634 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.513 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.034 ms
rank =  0, Distribute data + matrix mult took 14.199 ms
rank =  0, finding HY took 18.395 ms
rank =  0, distributing HY into block cyclic form took 12.841 ms
rank =  0, finding Y'*HY took 1.995 ms
Rank 0, Project_Hamiltonian used 47.460 ms
Total time for projection: 47.474 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.063 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.049 ms
rank = 0, Solve_Generalized_EigenProblem used 0.116 ms
    first calculated eigval = -0.773088119319603
    last  calculated eigval = 0.035314401977396
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77308811931960
lambda[   2] =  -0.76753436573167
lambda[   3] =  -0.41657317822866
lambda[   4] =  -0.40608512092751
lambda[   5] =  -0.40398896014496
lambda[   6] =  -0.39003069048942
lambda[   7] =  -0.22112562837269
lambda[   8] =  -0.21843940388287
lambda[   9] =  -0.03319723299002
lambda[  10] =   0.00786036384151
lambda[  11] =   0.01868062896961
lambda[  12] =   0.02390336619137
lambda[  13] =   0.03172640697670
lambda[  14] =   0.03531440197740
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.154 ms
rank =  0, subspace rotation using ScaLAPACK took 3.229 ms
rank =  0, Distributing orbital back into band + domain format took 12.170 ms
rank = 0, Subspace_Rotation used 15.412 ms

Total time for subspace rotation: 15.415 ms
rank = 0, Efermi =  -0.062403646637 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 2.213 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.670 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.076 ms
rank = 0, Calculating density took 1186.291 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.546 ms
rank = 0, D2D took 0.746 ms
rank = 0, Transfering density took 0.749 ms
Etot    =   -24.353437074300
Eband   =    -7.193730934830
E1      =    16.979716131026
E2      =    -6.446675516964
E3      =    -9.571624354270
Exc     =    -8.293904337428
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 3.177e-06, dEband = 1.890e-04
rank = 0, Calculating/Estimating energy took 0.949 ms, Etot = -24.353437074, dEtot = 3.177e-06, dEband = 1.890e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0205935332408, which took 0.092 ms

iter_count = 108, r_2norm = 7.621e-07, tol*||rhs|| = 8.237e-07

Anderson update took 57.813 ms, out of which F'*F took 27.324 ms; b-Ax took 186.355 ms, out of which Lap took 166.379 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.559 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912785, int_b + int_rho = -1.110e-13, checking this took 0.077 ms
2-norm of RHS = 673.8923327954002, which took 0.103 ms

iter_count = 120, r_2norm = 6.222e-04, tol*||rhs|| = 6.739e-04

Anderson update took 64.187 ms, out of which F'*F took 29.975 ms; b-Ax took 205.141 ms, out of which Lap took 183.715 ms
Solving Poisson took 433.713 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.121411 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.146615 
Total time for convolution: 	 convolve: 5.111735 
Total time for convolution: 	 convolve: 5.141210 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.792 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
---Transfer Veff_loc: D2D took 0.694 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.862 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.573 ms

This SCF took 26555.271 ms, scf error = 1.179e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135314, lowerbound = -0.773088, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1118.896 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.054 ms
rank =  0, Distribute orbital to block cyclic format took 12.561 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.414 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.021 ms
rank =  0, Distribute data + matrix mult took 14.011 ms
rank =  0, finding HY took 18.529 ms
rank =  0, distributing HY into block cyclic form took 12.736 ms
rank =  0, finding Y'*HY took 2.130 ms
Rank 0, Project_Hamiltonian used 47.489 ms
Total time for projection: 47.500 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.053 ms
rank = 0, Solve_Generalized_EigenProblem used 0.137 ms
    first calculated eigval = -0.773053438983712
    last  calculated eigval = 0.036949780404079
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77305343898371
lambda[   2] =  -0.76749981238263
lambda[   3] =  -0.41653792103854
lambda[   4] =  -0.40605158498239
lambda[   5] =  -0.40395509158532
lambda[   6] =  -0.38999570414518
lambda[   7] =  -0.22110024965993
lambda[   8] =  -0.21841228218399
lambda[   9] =  -0.03330546071372
lambda[  10] =   0.00763634502024
lambda[  11] =   0.01987979517557
lambda[  12] =   0.02357890269832
lambda[  13] =   0.03183108247685
lambda[  14] =   0.03694978040408
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.147 ms
rank =  0, subspace rotation using ScaLAPACK took 3.206 ms
rank =  0, Distributing orbital back into band + domain format took 12.212 ms
rank = 0, Subspace_Rotation used 15.433 ms

Total time for subspace rotation: 15.437 ms
rank = 0, Efermi =  -0.062511874359 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 2.137 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.767 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.080 ms
rank = 0, Calculating density took 1185.113 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.672 ms
rank = 0, D2D took 0.844 ms
rank = 0, Transfering density took 0.846 ms
Etot    =   -24.353449791776
Eband   =    -7.193212170560
E1      =    16.979490216081
E2      =    -6.446379921535
E3      =    -9.571576792976
Exc     =    -8.293866747505
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 1.590e-06, dEband = 6.485e-05
rank = 0, Calculating/Estimating energy took 0.913 ms, Etot = -24.353449792, dEtot = 1.590e-06, dEband = 6.485e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0135547759606, which took 0.046 ms

iter_count = 114, r_2norm = 3.306e-07, tol*||rhs|| = 5.422e-07

Anderson update took 61.052 ms, out of which F'*F took 28.947 ms; b-Ax took 196.468 ms, out of which Lap took 175.596 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 421.595 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912785, int_b + int_rho = -1.146e-13, checking this took 0.106 ms
2-norm of RHS = 673.8952161979599, which took 0.060 ms

iter_count = 120, r_2norm = 6.391e-04, tol*||rhs|| = 6.739e-04

Anderson update took 64.950 ms, out of which F'*F took 30.404 ms; b-Ax took 205.180 ms, out of which Lap took 183.888 ms
Solving Poisson took 434.158 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.116659 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.320 ms
Total time for convolution: 	 convolve: 5.194958 
Total time for convolution: 	 convolve: 5.127395 
Total time for convolution: 	 convolve: 5.125277 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.565 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.200 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.379 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
---Transfer Veff_loc: D2D took 0.657 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.305 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.975 ms

This SCF took 26782.599 ms, scf error = 1.008e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.136950, lowerbound = -0.773053, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.624 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.557 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.410 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.026 ms
rank =  0, Distribute data + matrix mult took 14.010 ms
rank =  0, finding HY took 18.634 ms
rank =  0, distributing HY into block cyclic form took 12.803 ms
rank =  0, finding Y'*HY took 1.987 ms
Rank 0, Project_Hamiltonian used 47.469 ms
Total time for projection: 47.483 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.085 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.050 ms
rank = 0, Solve_Generalized_EigenProblem used 0.139 ms
    first calculated eigval = -0.773015919384494
    last  calculated eigval = 0.037125064841148
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77301591938449
lambda[   2] =  -0.76746273144367
lambda[   3] =  -0.41649556756035
lambda[   4] =  -0.40601314441122
lambda[   5] =  -0.40391669957302
lambda[   6] =  -0.38995444738061
lambda[   7] =  -0.22107503099741
lambda[   8] =  -0.21838592791438
lambda[   9] =  -0.03297970467980
lambda[  10] =   0.00744228923617
lambda[  11] =   0.02195378640290
lambda[  12] =   0.02400548265123
lambda[  13] =   0.03230366832108
lambda[  14] =   0.03712506484115
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.150 ms
rank =  0, subspace rotation using ScaLAPACK took 4.181 ms
rank =  0, Distributing orbital back into band + domain format took 11.501 ms
rank = 0, Subspace_Rotation used 15.702 ms

Total time for subspace rotation: 15.706 ms
rank = 0, Efermi =  -0.062186118170 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 2.103 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.761 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1186.069 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.505 ms
rank = 0, D2D took 0.715 ms
rank = 0, Transfering density took 0.717 ms
Etot    =   -24.353453854450
Eband   =    -7.192638937961
E1      =    16.979332124520
E2      =    -6.445960929129
E3      =    -9.571551071588
Exc     =    -8.293841237425
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 5.078e-07, dEband = 7.165e-05
rank = 0, Calculating/Estimating energy took 1.040 ms, Etot = -24.353453854, dEtot = 5.078e-07, dEband = 7.165e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0136194381014, which took 0.048 ms

iter_count = 114, r_2norm = 3.415e-07, tol*||rhs|| = 5.448e-07

Anderson update took 61.164 ms, out of which F'*F took 28.811 ms; b-Ax took 197.538 ms, out of which Lap took 176.305 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 422.337 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912777, int_b + int_rho = -1.892e-13, checking this took 0.125 ms
2-norm of RHS = 673.8937413482694, which took 0.074 ms

iter_count = 48, r_2norm = 6.347e-04, tol*||rhs|| = 6.739e-04

Anderson update took 26.374 ms, out of which F'*F took 13.071 ms; b-Ax took 84.081 ms, out of which Lap took 75.918 ms
Solving Poisson took 176.592 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
Total time for convolution: 	 convolve: 5.133406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.118344 
Total time for convolution: 	 convolve: 5.143976 
Total time for convolution: 	 convolve: 5.128628 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.411 ms
---Transfer Veff_loc: D2D took 0.678 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.299 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 0.990 ms

This SCF took 26364.842 ms, scf error = 1.224e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.137125, lowerbound = -0.773016, upperbound = 267.575230

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (7 columns, degree = 45): 1119.609 ms
New BLOCK CYCLIC DOMAIN: nproc = 2, dims = (2, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 12.585 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 1.438 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.029 ms
rank =  0, Distribute data + matrix mult took 14.068 ms
rank =  0, finding HY took 18.400 ms
rank =  0, distributing HY into block cyclic form took 12.799 ms
rank =  0, finding Y'*HY took 2.015 ms
Rank 0, Project_Hamiltonian used 47.312 ms
Total time for projection: 47.323 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.081 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.047 ms
rank = 0, Solve_Generalized_EigenProblem used 0.132 ms
    first calculated eigval = -0.772984995004027
    last  calculated eigval = 0.036751964609354
The last 14 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 16):
lambda[   1] =  -0.77298499500403
lambda[   2] =  -0.76743159424932
lambda[   3] =  -0.41646885980380
lambda[   4] =  -0.40598714307492
lambda[   5] =  -0.40389047653974
lambda[   6] =  -0.38992661473414
lambda[   7] =  -0.22104441784418
lambda[   8] =  -0.21835473431063
lambda[   9] =  -0.03320568080612
lambda[  10] =   0.00719546084001
lambda[  11] =   0.02169275976153
lambda[  12] =   0.02362225156420
lambda[  13] =   0.03195849537467
lambda[  14] =   0.03675196460935
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.143 ms
rank =  0, subspace rotation using ScaLAPACK took 3.193 ms
rank =  0, Distributing orbital back into band + domain format took 12.127 ms
rank = 0, Subspace_Rotation used 15.335 ms

Total time for subspace rotation: 15.339 ms
rank = 0, Efermi =  -0.062412094315 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.219 ms
rank = 0, --- Calculate rho: reduce over all band groups took 0.698 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.078 ms
rank = 0, Calculating density took 1185.516 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.522 ms
rank = 0, D2D took 0.708 ms
rank = 0, Transfering density took 0.711 ms
Etot    =   -24.353454042215
Eband   =    -7.192177671757
E1      =    16.978981286717
E2      =    -6.445817322149
E3      =    -9.571691709479
Exc     =    -8.293948884503
Esc     =   -41.863817803726
Entropy =    -0.000000000575
dE = 2.347e-08, dEband = 5.766e-05
rank = 0, Calculating/Estimating energy took 0.990 ms, Etot = -24.353454042, dEtot = 2.347e-08, dEband = 5.766e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0123877903833, which took 0.053 ms

iter_count = 108, r_2norm = 4.338e-07, tol*||rhs|| = 4.955e-07

Anderson update took 57.902 ms, out of which F'*F took 27.399 ms; b-Ax took 186.615 ms, out of which Lap took 167.131 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 399.790 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -16.00000001912796, int_rho =  16.00000001912787, int_b + int_rho = -8.913e-14, checking this took 0.079 ms
2-norm of RHS = 673.8933529181533, which took 0.077 ms

iter_count = 108, r_2norm = 6.468e-04, tol*||rhs|| = 6.739e-04

Anderson update took 58.417 ms, out of which F'*F took 27.401 ms; b-Ax took 184.940 ms, out of which Lap took 165.691 ms
Solving Poisson took 391.792 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.197426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.326 ms
Total time for convolution: 	 convolve: 5.120772 
Total time for convolution: 	 convolve: 5.129041 
Total time for convolution: 	 convolve: 5.092037 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.820 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 0.704 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 170000) to all bandcomms took 0.310 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.031 ms

This SCF took 26537.251 ms, scf error = 8.232e-05
The last 14 occupations of kpoints #1 are (Nelectron = 16):
lambda[   1] =  -0.77298499500403, occ[   1] =   2.00000000000000
lambda[   2] =  -0.76743159424932, occ[   2] =   2.00000000000000
lambda[   3] =  -0.41646885980380, occ[   3] =   2.00000000000000
lambda[   4] =  -0.40598714307492, occ[   4] =   2.00000000000000
lambda[   5] =  -0.40389047653974, occ[   5] =   2.00000000000000
lambda[   6] =  -0.38992661473414, occ[   6] =   2.00000000000000
lambda[   7] =  -0.22104441784418, occ[   7] =   2.00000000000000
lambda[   8] =  -0.21835473431063, occ[   8] =   2.00000000000000
lambda[   9] =  -0.03320568080612, occ[   9] =   0.00000001912783
lambda[  10] =   0.00719546084001, occ[  10] =   0.00000000000000
lambda[  11] =   0.02169275976153, occ[  11] =   0.00000000000000
lambda[  12] =   0.02362225156420, occ[  12] =   0.00000000000000
lambda[  13] =   0.03195849537467, occ[  13] =   0.00000000000000
lambda[  14] =   0.03675196460935, occ[  14] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 13 (90%) = 0.000000000000000.
Occupation of state 14 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.000 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.310 ms, time for Allreduce/Reduce: 7.594 ms 
Time for calculating local force components: 14.809 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.04133544131303   0.04930706137617  -0.00000001338908
 -0.01215276951387  -0.03575524836125  -0.05138828369876
 -0.01215276333065  -0.03575527699577   0.05138831052989
  0.04133531645123  -0.04930697080490   0.00000000914313
  0.01215269009202   0.03575515172409   0.05138815041158
  0.01215271186061   0.03575517854571  -0.05138816591997
  0.66282861463308   0.25225168475635   0.00000059919489
 -0.66282738686861  -0.25224974757059  -0.00000052053507
force_loc = 
  0.04322082094721  -0.05286094968376  -0.00000003003895
  0.01147534742852   0.03766741880450   0.05492693921291
  0.01147530598643   0.03766719391270  -0.05492680418008
 -0.04321654257426   0.05285721865867   0.00000013578100
 -0.01147388333944  -0.03766428895731  -0.05492278235943
 -0.01147390557070  -0.03766408764883   0.05492263298300
 -0.64614194871357  -0.24464955331954  -0.00000187987689
  0.64614695076547   0.24465166115938   0.00000234336162
Time for calculating nonlocal force components: 23.988 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.01668121039026  -0.00670837287954  -0.00000006768793
[0m[32m  0.01668129928042   0.00670844255447   0.00000008966481
[0mTime for calculating XC forces components: 19.856 ms
 Cartesian force = 
  0.00188372890536  -0.00355470271641  -0.00000012625261
 -0.00067907281417   0.00191135603443   0.00353857268957
 -0.00067910807304   0.00191110250811  -0.00353857647477
 -0.00188287685186   0.00354943344495   0.00000006209954
  0.00067715602375  -0.00190995164204  -0.00353471477243
  0.00067715556109  -0.00190972351194   0.00353438423844
  0.00000380480042   0.00089294414845  -0.00000143119452
 -0.00000078755154  -0.00089045826556   0.00000182966678
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.368 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.178 ms
Time for printing density: 395.314 ms
The program took 489.616 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:13
Job ID:        2266528
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:41:00,vmem=8452K,walltime=00:08:25,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-01-004-15-1
---------------------------------------
