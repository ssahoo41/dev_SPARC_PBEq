---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:30
Job ID:    2266700
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:36
Job ID:    2266700
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.051 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.015 ms

Set default values took 0.002 ms
Reading input file sprc-calc.inpt

Reading input file took 19.602 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 9.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 11.126 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 69.414 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.970 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.129 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.309209	   10.000000	   13.361915	
   11.690791	   10.000000	   13.361915	
   10.000000	   12.789952	    6.638085	
   10.000000	    7.210048	    6.638085	
   10.000000	   10.000000	   12.183127	
   10.000000	   11.376749	    8.110026	
   10.000000	    8.623251	    8.110026	
   10.000000	   11.884359	   10.435720	
   10.000000	    8.115641	   10.435720	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.211 ms
Set up communicators.

--set up spincomm took 2.245 ms

--set up kptcomm took 0.351 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 3}
gridsizes = [100, 100, 100], Nstates = 20, dmcomm dims = [1, 1, 3]

--set up dmcomm took 0.009 ms

--set up blacscomm took 0.011 ms
rank = 0, size_blacscomm = 4, ScaLAPACK topology Dims = (4, 1)
nproc = 12, size_blacscomm = 4 = dims[0] * dims[1] = (4, 1)
Nd_blacscomm 340000, Nstates 20 
rank =  0, my blacs rank = 0, BLCYC size (340000, 5), actual size (340000, 5)
rank = 0, mb = nb = 20, mbQ = nbQ = 64
rank = 0, nr_Hp = 20, nc_Hp = 20
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.407 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.108 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 4
# of bands per bandcomm          : 5
npdomain: 3
Embeded Cartesian topology dims: (1,1,3)
# of FD-grid points per processor: 340000 = (100,100,34)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.590 ms

Calculate_SplineDerivRadFun took 0.203 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.211 ms.
time spent on vectorized spline interp: 2.539 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.946 ms.
time spent on vectorized spline interp: 1.563 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.464 ms.
time spent on vectorized spline interp: 1.546 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.490 ms.

Calculating rb for all atom types took 14.769 ms
----------------------
Estimated memory usage
Total: 1.21 GB
orbitals             : 915.53 MB
global sized vectors : 213.62 MB
subspace matrices : 28.12 kB
others : 112.92 MB
----------------------------------------------
Estimated memory usage per processor: 103.51 MB
Start ground-state calculation.

Computing nearest neighbor distance (2.041 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.011 ms
Calculating pseudocharge density ... 
the global sum of int_b = -26.0000000220499, sum_int_rho = 25.5863336789013
PosCharge = 26.000000022050, NegCharge = -25.586333678901, scal_fac = 1.016167472383
After scaling, int_rho = 26.0000000220496, PosCharge + NegCharge - NetCharge = 3.055e-13
--Calculate Vref took 0.568 ms
--Calculate rho_guess took 3.353 ms

 integral of b = -26.0000000220499,
 int{b} + Nelectron + NetCharge = -2.205e-08,
 Esc = -70.0051398431679,
 MPI_Reduce took 5.313 ms

Calculating b & b_ref took 16.596 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.019 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.026 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.006 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.059 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.007 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.001 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.010 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 38.776 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204999, int_b + int_rho = -2.619e-13, checking this took 0.089 ms
2-norm of RHS = 724.3231078609230, which took 0.875 ms

iter_count = 420, r_2norm = 6.869e-04, tol*||rhs|| = 7.243e-04

Anderson update took 222.513 ms, out of which F'*F took 118.160 ms; b-Ax took 702.991 ms, out of which Lap took 665.784 ms
Solving Poisson took 1201.525 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.556 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.803 ms
Total time for convolution: 	 convolve: 5.107533 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 165.829 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.788 ms
Total time for convolution: 	 convolve: 5.147639 
Total time for convolution: 	 convolve: 5.124035 
Total time for convolution: 	 convolve: 5.103066 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.710 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.536 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.126 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.462 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
rank = 0, XC calculation took 24507.024 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.198 ms
---Transfer Veff_loc: D2D took 2.075 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 3.025 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 6.174 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.208 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.505 ms
    Lanczos iter 55, eigmin  = -1.073720522, eigmax = 264.947412324, err_eigmin = 3.821e-04, err_eigmax = 9.860e-03
rank =   0, Lanczos took 104.701 ms, eigmin = -1.073720521846, eigmax = 267.596886447454

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.211583, lowerbound = -1.173721, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1387.296 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.823 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.052 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.348 ms
rank =  0, Distribute data + matrix mult took 22.237 ms
rank =  0, finding HY took 25.542 ms
rank =  0, distributing HY into block cyclic form took 15.150 ms
rank =  0, finding Y'*HY took 7.033 ms
Rank 0, Project_Hamiltonian used 69.987 ms
Total time for projection: 69.999 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.364 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.109 ms
rank = 0, Solve_Generalized_EigenProblem used 0.484 ms
    first calculated eigval = 2.719504138129319
    last  calculated eigval = 3.217529590758382
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =   2.81103655704304
lambda[   5] =   2.86204883043530
lambda[   6] =   2.87799302951760
lambda[   7] =   2.89162475245219
lambda[   8] =   2.93983812642522
lambda[   9] =   2.95962646618625
lambda[  10] =   2.98923294053190
lambda[  11] =   3.00138156275647
lambda[  12] =   3.01805169313338
lambda[  13] =   3.05747520304428
lambda[  14] =   3.06840259727842
lambda[  15] =   3.10068392567189
lambda[  16] =   3.10653858419183
lambda[  17] =   3.16042259504214
lambda[  18] =   3.17128765312587
lambda[  19] =   3.19106319325887
lambda[  20] =   3.21752959075838
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.527 ms
rank =  0, subspace rotation using ScaLAPACK took 5.183 ms
rank =  0, Distributing orbital back into band + domain format took 13.270 ms
rank = 0, Subspace_Rotation used 18.466 ms

Total time for subspace rotation: 18.470 ms
rank = 0, Efermi =   3.062938900286 calculate fermi energy took 0.052 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.317530, lowerbound = -1.173721, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1385.240 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 13.068 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.048 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.583 ms
rank =  0, Distribute data + matrix mult took 18.711 ms
rank =  0, finding HY took 24.937 ms
rank =  0, distributing HY into block cyclic form took 13.514 ms
rank =  0, finding Y'*HY took 6.707 ms
Rank 0, Project_Hamiltonian used 63.895 ms
Total time for projection: 63.909 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.127 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.191 ms
    first calculated eigval = -0.837624875548313
    last  calculated eigval = 0.449687261298372
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.35889844959586
lambda[   5] =  -0.24300874002023
lambda[   6] =  -0.21655681549881
lambda[   7] =  -0.15288336086270
lambda[   8] =  -0.08214976059148
lambda[   9] =   0.06721901695866
lambda[  10] =   0.10381602587245
lambda[  11] =   0.12418934421410
lambda[  12] =   0.17307476565685
lambda[  13] =   0.27474492783797
lambda[  14] =   0.30080617888617
lambda[  15] =   0.35843277291517
lambda[  16] =   0.37416207864748
lambda[  17] =   0.38237521018741
lambda[  18] =   0.41275474634852
lambda[  19] =   0.42709440376047
lambda[  20] =   0.44968726129837
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.199 ms
rank =  0, subspace rotation using ScaLAPACK took 5.162 ms
rank =  0, Distributing orbital back into band + domain format took 13.071 ms
rank = 0, Subspace_Rotation used 18.244 ms

Total time for subspace rotation: 18.247 ms
rank = 0, Efermi =   0.287775555027 calculate fermi energy took 0.024 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.549687, lowerbound = -1.173721, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1358.592 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.018 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.028 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.574 ms
rank =  0, Distribute data + matrix mult took 19.631 ms
rank =  0, finding HY took 24.917 ms
rank =  0, distributing HY into block cyclic form took 13.182 ms
rank =  0, finding Y'*HY took 8.602 ms
Rank 0, Project_Hamiltonian used 66.357 ms
Total time for projection: 66.369 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.064 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -1.074530256010225
    last  calculated eigval = 0.148213066226912
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64443461288556
lambda[   5] =  -0.62948134612511
lambda[   6] =  -0.57568151497270
lambda[   7] =  -0.54246914875760
lambda[   8] =  -0.50751249430148
lambda[   9] =  -0.49415736227978
lambda[  10] =  -0.38286531507155
lambda[  11] =  -0.33869694310857
lambda[  12] =  -0.32913851688155
lambda[  13] =  -0.21508647869273
lambda[  14] =  -0.09092364697352
lambda[  15] =   0.01661670952369
lambda[  16] =   0.07517269340197
lambda[  17] =   0.11295085375546
lambda[  18] =   0.11672146328970
lambda[  19] =   0.13024231047725
lambda[  20] =   0.14821306622691
==subpsace eigenproblem: bcast eigvals took 0.055 ms
Total time for solving subspace eigenvalue problem: 0.248 ms
rank =  0, subspace rotation using ScaLAPACK took 5.080 ms
rank =  0, Distributing orbital back into band + domain format took 12.789 ms
rank = 0, Subspace_Rotation used 17.876 ms

Total time for subspace rotation: 17.879 ms
rank = 0, Efermi =  -0.120002152748 calculate fermi energy took 0.045 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.248213, lowerbound = -1.173721, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1373.074 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.696 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.040 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.656 ms
rank =  0, Distribute data + matrix mult took 21.402 ms
rank =  0, finding HY took 25.095 ms
rank =  0, distributing HY into block cyclic form took 13.005 ms
rank =  0, finding Y'*HY took 6.795 ms
Rank 0, Project_Hamiltonian used 66.320 ms
Total time for projection: 66.337 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.062 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -1.075491999957428
    last  calculated eigval = 0.094082370626267
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.64661151730670
lambda[   5] =  -0.63634215837071
lambda[   6] =  -0.58103477058724
lambda[   7] =  -0.54680733602195
lambda[   8] =  -0.51500641782801
lambda[   9] =  -0.51321957731914
lambda[  10] =  -0.39986980595514
lambda[  11] =  -0.35489014487504
lambda[  12] =  -0.35063132257400
lambda[  13] =  -0.29586024690786
lambda[  14] =  -0.17096037973122
lambda[  15] =  -0.05824047464174
lambda[  16] =   0.01434355579392
lambda[  17] =   0.04912049238676
lambda[  18] =   0.07139269966568
lambda[  19] =   0.08329860870164
lambda[  20] =   0.09408237062627
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.210 ms
rank =  0, subspace rotation using ScaLAPACK took 5.097 ms
rank =  0, Distributing orbital back into band + domain format took 12.859 ms
rank = 0, Subspace_Rotation used 17.964 ms

Total time for subspace rotation: 17.968 ms
rank = 0, Efermi =  -0.200038885407 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 1.978 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.284 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.142 ms
rank = 0, Calculating density took 5957.214 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.543 ms
rank = 0, D2D took 4.872 ms
rank = 0, Transfering density took 4.877 ms
Etot    =   -41.204286322634
Eband   =   -15.271657742726
E1      =    30.397006755632
E2      =   -12.154790429917
E3      =   -14.971511104068
Exc     =   -13.450797025697
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 4.578e+00, dEband = 1.697e+00
rank = 0, Calculating/Estimating energy took 1.462 ms, Etot = -41.204286323, dEtot = 4.578e+00, dEband = 1.697e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 61.6004305703642, which took 0.209 ms

iter_count = 96, r_2norm = 1.820e-03, tol*||rhs|| = 2.464e-03

Anderson update took 47.036 ms, out of which F'*F took 27.217 ms; b-Ax took 161.631 ms, out of which Lap took 153.393 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 273.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204958, int_b + int_rho = -6.767e-13, checking this took 0.181 ms
2-norm of RHS = 719.1857639214738, which took 0.216 ms

iter_count = 288, r_2norm = 6.398e-04, tol*||rhs|| = 7.192e-04

Anderson update took 142.321 ms, out of which F'*F took 81.816 ms; b-Ax took 489.024 ms, out of which Lap took 461.708 ms
Solving Poisson took 826.488 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.854 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.254448 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.098062 
Total time for convolution: 	 convolve: 5.083455 
Total time for convolution: 	 convolve: 5.122747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.255 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.401 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.206 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
---Transfer Veff_loc: D2D took 1.176 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.136 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.332 ms

This SCF took 31630.667 ms, scf error = 1.847e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194082, lowerbound = -1.075492, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1395.838 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 13.332 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.043 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.150 ms
rank =  0, Distribute data + matrix mult took 18.537 ms
rank =  0, finding HY took 25.599 ms
rank =  0, distributing HY into block cyclic form took 13.325 ms
rank =  0, finding Y'*HY took 6.914 ms
Rank 0, Project_Hamiltonian used 64.401 ms
Total time for projection: 64.416 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.066 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -1.036817165607507
    last  calculated eigval = 0.066168516839159
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.61197309625283
lambda[   5] =  -0.61157174431415
lambda[   6] =  -0.54718383132812
lambda[   7] =  -0.52149670494125
lambda[   8] =  -0.48683554548868
lambda[   9] =  -0.48446510982879
lambda[  10] =  -0.37849021870589
lambda[  11] =  -0.32219679698157
lambda[  12] =  -0.31269138739327
lambda[  13] =  -0.25385537296503
lambda[  14] =  -0.15040939453167
lambda[  15] =  -0.04566888869220
lambda[  16] =  -0.00982586947156
lambda[  17] =   0.02927585431384
lambda[  18] =   0.04442641382605
lambda[  19] =   0.05630080548123
lambda[  20] =   0.06616851683916
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.207 ms
rank =  0, subspace rotation using ScaLAPACK took 5.269 ms
rank =  0, Distributing orbital back into band + domain format took 14.113 ms
rank = 0, Subspace_Rotation used 19.399 ms

Total time for subspace rotation: 19.403 ms
rank = 0, Efermi =  -0.179487900221 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 2.030 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.569 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.147 ms
rank = 0, Calculating density took 1485.381 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
rank = 0, D2D took 3.891 ms
rank = 0, Transfering density took 3.897 ms
Etot    =   -41.141254576807
Eband   =   -14.423944806434
E1      =    29.661449102887
E2      =   -12.067146492404
E3      =   -15.175209869607
Exc     =   -13.615975391442
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 7.004e-03, dEband = 9.419e-02
rank = 0, Calculating/Estimating energy took 1.481 ms, Etot = -41.141254577, dEtot = 7.004e-03, dEband = 9.419e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 20.7805725471519, which took 0.204 ms

iter_count = 102, r_2norm = 6.530e-04, tol*||rhs|| = 8.312e-04

Anderson update took 49.233 ms, out of which F'*F took 29.437 ms; b-Ax took 177.136 ms, out of which Lap took 168.051 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 298.182 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204960, int_b + int_rho = -6.548e-13, checking this took 0.193 ms
2-norm of RHS = 712.6295431912498, which took 0.237 ms

iter_count = 306, r_2norm = 6.155e-04, tol*||rhs|| = 7.126e-04

Anderson update took 151.165 ms, out of which F'*F took 85.858 ms; b-Ax took 512.357 ms, out of which Lap took 483.969 ms
Solving Poisson took 858.284 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Total time for convolution: 	 convolve: 5.134990 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.126602 
Total time for convolution: 	 convolve: 5.078164 
Total time for convolution: 	 convolve: 5.075302 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.226 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.209 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.341 ms
---Transfer Veff_loc: D2D took 1.244 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.126 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.389 ms

This SCF took 27096.588 ms, scf error = 1.253e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.166169, lowerbound = -1.036817, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1336.789 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 35.256 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.456 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.298 ms
rank =  0, Distribute data + matrix mult took 41.023 ms
rank =  0, finding HY took 25.017 ms
rank =  0, distributing HY into block cyclic form took 15.234 ms
rank =  0, finding Y'*HY took 7.329 ms
Rank 0, Project_Hamiltonian used 88.632 ms
Total time for projection: 88.648 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.070 ms
rank = 0, Solve_Generalized_EigenProblem used 0.194 ms
    first calculated eigval = -0.974182062914800
    last  calculated eigval = 0.047172730278100
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.56326943747728
lambda[   5] =  -0.55548363063050
lambda[   6] =  -0.48621283000066
lambda[   7] =  -0.47797056173483
lambda[   8] =  -0.43191820673430
lambda[   9] =  -0.43136112526027
lambda[  10] =  -0.33785641065600
lambda[  11] =  -0.27222472539955
lambda[  12] =  -0.25079295714892
lambda[  13] =  -0.18639073238814
lambda[  14] =  -0.10954573619513
lambda[  15] =  -0.02248105330379
lambda[  16] =  -0.00666430008629
lambda[  17] =   0.02173342192946
lambda[  18] =   0.03427327797216
lambda[  19] =   0.04339151871928
lambda[  20] =   0.04717273027810
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.833 ms
rank =  0, Distributing orbital back into band + domain format took 14.531 ms
rank = 0, Subspace_Rotation used 19.381 ms

Total time for subspace rotation: 19.385 ms
rank = 0, Efermi =  -0.138624241892 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.096 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.138 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.148 ms
rank = 0, Calculating density took 1450.541 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
rank = 0, D2D took 3.254 ms
rank = 0, Transfering density took 3.260 ms
Etot    =   -41.085186677092
Eband   =   -12.973713273449
E1      =    28.458316333941
E2      =   -11.802130488758
E3      =   -15.561977936951
Exc     =   -13.928758319465
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 6.230e-03, dEband = 1.611e-01
rank = 0, Calculating/Estimating energy took 1.661 ms, Etot = -41.085186677, dEtot = 6.230e-03, dEband = 1.611e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 7.4764221939059, which took 0.263 ms

iter_count = 102, r_2norm = 2.676e-04, tol*||rhs|| = 2.991e-04

Anderson update took 49.582 ms, out of which F'*F took 28.954 ms; b-Ax took 172.815 ms, out of which Lap took 163.651 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.525 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204958, int_b + int_rho = -6.730e-13, checking this took 0.198 ms
2-norm of RHS = 713.2801697477358, which took 0.236 ms

iter_count = 276, r_2norm = 6.080e-04, tol*||rhs|| = 7.133e-04

Anderson update took 137.809 ms, out of which F'*F took 79.047 ms; b-Ax took 463.424 ms, out of which Lap took 438.452 ms
Solving Poisson took 775.681 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.144771 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.316 ms
Total time for convolution: 	 convolve: 5.163774 
Total time for convolution: 	 convolve: 5.987355 
Total time for convolution: 	 convolve: 5.429243 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.252 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.139 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.143 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.176 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.381 ms
---Transfer Veff_loc: D2D took 1.244 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.130 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.393 ms

This SCF took 28629.702 ms, scf error = 4.040e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.147173, lowerbound = -0.974182, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1913.031 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.936 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.026 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.617 ms
rank =  0, Distribute data + matrix mult took 18.591 ms
rank =  0, finding HY took 24.894 ms
rank =  0, distributing HY into block cyclic form took 13.048 ms
rank =  0, finding Y'*HY took 6.623 ms
Rank 0, Project_Hamiltonian used 63.185 ms
Total time for projection: 63.201 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.074 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.965705259244804
    last  calculated eigval = 0.038748946137138
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54975087293839
lambda[   5] =  -0.54494926253909
lambda[   6] =  -0.47316852742200
lambda[   7] =  -0.46938618840753
lambda[   8] =  -0.41911466235270
lambda[   9] =  -0.41888645041198
lambda[  10] =  -0.32753016155895
lambda[  11] =  -0.26705394398679
lambda[  12] =  -0.24238033379326
lambda[  13] =  -0.18018223683367
lambda[  14] =  -0.10303487376648
lambda[  15] =  -0.02727036489363
lambda[  16] =   0.00109289475710
lambda[  17] =   0.01913050711667
lambda[  18] =   0.02759840665731
lambda[  19] =   0.03460282086755
lambda[  20] =   0.03874894613714
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 4.880 ms
rank =  0, Distributing orbital back into band + domain format took 14.131 ms
rank = 0, Subspace_Rotation used 19.026 ms

Total time for subspace rotation: 19.030 ms
rank = 0, Efermi =  -0.132113379458 calculate fermi energy took 0.054 ms
rank = 0, --- Calculate rho: sum over local bands took 1.964 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.732 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.177 ms
rank = 0, Calculating density took 2001.481 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.509 ms
rank = 0, D2D took 3.734 ms
rank = 0, Transfering density took 3.740 ms
Etot    =   -41.080548806838
Eband   =   -12.713988522147
E1      =    28.301244018820
E2      =   -11.686929038776
E3      =   -15.635980715480
Exc     =   -13.985574213939
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 5.153e-04, dEband = 2.886e-02
rank = 0, Calculating/Estimating energy took 1.206 ms, Etot = -41.080548807, dEtot = 5.153e-04, dEband = 2.886e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 3.1997107982125, which took 0.282 ms

iter_count = 108, r_2norm = 1.063e-04, tol*||rhs|| = 1.280e-04

Anderson update took 52.408 ms, out of which F'*F took 30.615 ms; b-Ax took 182.038 ms, out of which Lap took 172.385 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.583 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204968, int_b + int_rho = -5.784e-13, checking this took 0.206 ms
2-norm of RHS = 713.6695572071814, which took 0.239 ms

iter_count = 258, r_2norm = 6.128e-04, tol*||rhs|| = 7.137e-04

Anderson update took 127.547 ms, out of which F'*F took 71.765 ms; b-Ax took 430.900 ms, out of which Lap took 407.965 ms
Solving Poisson took 724.587 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.074 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Total time for convolution: 	 convolve: 5.135666 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.260 ms
Total time for convolution: 	 convolve: 5.077897 
Total time for convolution: 	 convolve: 5.070208 
Total time for convolution: 	 convolve: 5.069044 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.152 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.201 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.202 ms
---Transfer Veff_loc: D2D took 1.206 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.893 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.123 ms

This SCF took 27448.895 ms, scf error = 1.701e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.138749, lowerbound = -0.965705, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1354.315 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 19.400 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.020 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 3.164 ms
rank =  0, Distribute data + matrix mult took 26.615 ms
rank =  0, finding HY took 24.751 ms
rank =  0, distributing HY into block cyclic form took 13.090 ms
rank =  0, finding Y'*HY took 6.896 ms
Rank 0, Project_Hamiltonian used 71.383 ms
Total time for projection: 71.404 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.060 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.959932244165946
    last  calculated eigval = 0.034549193460107
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54446387331697
lambda[   5] =  -0.53906990104406
lambda[   6] =  -0.46746601745464
lambda[   7] =  -0.46422912573164
lambda[   8] =  -0.41340152806244
lambda[   9] =  -0.41298495097459
lambda[  10] =  -0.32321775880547
lambda[  11] =  -0.26240540699791
lambda[  12] =  -0.23633585383636
lambda[  13] =  -0.17402059047771
lambda[  14] =  -0.09892569285259
lambda[  15] =  -0.02928932028261
lambda[  16] =   0.00452757251134
lambda[  17] =   0.01801470334334
lambda[  18] =   0.02038957622477
lambda[  19] =   0.03096299806327
lambda[  20] =   0.03454919346011
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.201 ms
rank =  0, subspace rotation using ScaLAPACK took 4.776 ms
rank =  0, Distributing orbital back into band + domain format took 14.346 ms
rank = 0, Subspace_Rotation used 19.132 ms

Total time for subspace rotation: 19.137 ms
rank = 0, Efermi =  -0.128004198551 calculate fermi energy took 4.138 ms
rank = 0, --- Calculate rho: sum over local bands took 2.178 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.412 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.135 ms
rank = 0, Calculating density took 1452.985 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.610 ms
rank = 0, D2D took 1.927 ms
rank = 0, Transfering density took 1.933 ms
Etot    =   -41.079115802480
Eband   =   -12.570086533943
E1      =    28.223491183631
E2      =   -11.612466547221
E3      =   -15.673465819476
Exc     =   -14.013312975036
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.592e-04, dEband = 1.599e-02
rank = 0, Calculating/Estimating energy took 1.306 ms, Etot = -41.079115802, dEtot = 1.592e-04, dEband = 1.599e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.9262091671553, which took 0.195 ms

iter_count = 114, r_2norm = 2.741e-05, tol*||rhs|| = 3.705e-05

Anderson update took 57.438 ms, out of which F'*F took 32.368 ms; b-Ax took 192.463 ms, out of which Lap took 182.160 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.455 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204956, int_b + int_rho = -6.912e-13, checking this took 0.190 ms
2-norm of RHS = 714.3492206035017, which took 0.161 ms

iter_count = 252, r_2norm = 6.422e-04, tol*||rhs|| = 7.143e-04

Anderson update took 123.394 ms, out of which F'*F took 72.351 ms; b-Ax took 425.738 ms, out of which Lap took 402.931 ms
Solving Poisson took 708.313 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.102 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.219 ms
Total time for convolution: 	 convolve: 5.123023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.266 ms
Total time for convolution: 	 convolve: 5.097464 
Total time for convolution: 	 convolve: 5.068812 
Total time for convolution: 	 convolve: 5.072245 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.499 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.497 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.150 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.184 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 1.220 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.463 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.708 ms

This SCF took 26884.460 ms, scf error = 9.324e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.134549, lowerbound = -0.959932, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1372.938 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 14.623 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.089 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.093 ms
rank =  0, Distribute data + matrix mult took 20.817 ms
rank =  0, finding HY took 24.940 ms
rank =  0, distributing HY into block cyclic form took 13.014 ms
rank =  0, finding Y'*HY took 6.795 ms
Rank 0, Project_Hamiltonian used 65.593 ms
Total time for projection: 65.611 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.956477914278605
    last  calculated eigval = 0.031699614387784
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.54147437490653
lambda[   5] =  -0.53546523572067
lambda[   6] =  -0.46429844250411
lambda[   7] =  -0.46086470270892
lambda[   8] =  -0.41017219796712
lambda[   9] =  -0.40961971205745
lambda[  10] =  -0.32056480217119
lambda[  11] =  -0.25924400660824
lambda[  12] =  -0.23251418359963
lambda[  13] =  -0.17012630466060
lambda[  14] =  -0.09623414108214
lambda[  15] =  -0.02993842217862
lambda[  16] =   0.00671192457215
lambda[  17] =   0.01584203724118
lambda[  18] =   0.01794862821178
lambda[  19] =   0.02910569992120
lambda[  20] =   0.03169961438778
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.851 ms
rank =  0, Distributing orbital back into band + domain format took 14.309 ms
rank = 0, Subspace_Rotation used 19.170 ms

Total time for subspace rotation: 19.175 ms
rank = 0, Efermi =  -0.125312646806 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.954 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.309 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.263 ms
rank = 0, Calculating density took 1463.567 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.599 ms
rank = 0, D2D took 3.377 ms
rank = 0, Transfering density took 3.379 ms
Etot    =   -41.078376305789
Eband   =   -12.483762496167
E1      =    28.199240243748
E2      =   -11.545296382788
E3      =   -15.689021614601
Exc     =   -14.023032206931
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 8.217e-05, dEband = 9.592e-03
rank = 0, Calculating/Estimating energy took 1.449 ms, Etot = -41.078376306, dEtot = 8.217e-05, dEband = 9.592e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5116664439041, which took 0.182 ms

iter_count = 108, r_2norm = 1.974e-05, tol*||rhs|| = 2.047e-05

Anderson update took 53.938 ms, out of which F'*F took 30.436 ms; b-Ax took 181.868 ms, out of which Lap took 171.896 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.731 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204964, int_b + int_rho = -6.148e-13, checking this took 0.166 ms
2-norm of RHS = 714.5622160823076, which took 0.193 ms

iter_count = 258, r_2norm = 6.339e-04, tol*||rhs|| = 7.146e-04

Anderson update took 126.220 ms, out of which F'*F took 74.474 ms; b-Ax took 436.355 ms, out of which Lap took 413.141 ms
Solving Poisson took 729.748 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.606 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Total time for convolution: 	 convolve: 5.124435 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Total time for convolution: 	 convolve: 5.074749 
Total time for convolution: 	 convolve: 5.070578 
Total time for convolution: 	 convolve: 5.079478 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.511 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.246 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.132 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.219 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.123 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.192 ms
---Transfer Veff_loc: D2D took 1.185 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.765 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.990 ms

This SCF took 26878.729 ms, scf error = 4.140e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.131700, lowerbound = -0.956478, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1357.558 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 13.008 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.924 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.746 ms
rank =  0, Distribute data + matrix mult took 18.689 ms
rank =  0, finding HY took 24.828 ms
rank =  0, distributing HY into block cyclic form took 12.969 ms
rank =  0, finding Y'*HY took 6.765 ms
Rank 0, Project_Hamiltonian used 63.282 ms
Total time for projection: 63.295 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.950314011779266
    last  calculated eigval = 0.029869429733356
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53665442492557
lambda[   5] =  -0.52972548978968
lambda[   6] =  -0.45806019303372
lambda[   7] =  -0.45618126330151
lambda[   8] =  -0.40532826337445
lambda[   9] =  -0.40436900397210
lambda[  10] =  -0.31572164880814
lambda[  11] =  -0.25335965686259
lambda[  12] =  -0.22614056282143
lambda[  13] =  -0.16347859373874
lambda[  14] =  -0.09151662076477
lambda[  15] =  -0.02977193387265
lambda[  16] =   0.01144115234711
lambda[  17] =   0.01370039229650
lambda[  18] =   0.01873986257497
lambda[  19] =   0.02865687911862
lambda[  20] =   0.02986942973336
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.197 ms
rank =  0, subspace rotation using ScaLAPACK took 4.763 ms
rank =  0, Distributing orbital back into band + domain format took 14.318 ms
rank = 0, Subspace_Rotation used 19.092 ms

Total time for subspace rotation: 19.096 ms
rank = 0, Efermi =  -0.120595126456 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.954 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.244 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.151 ms
rank = 0, Calculating density took 1445.592 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.594 ms
rank = 0, D2D took 3.682 ms
rank = 0, Transfering density took 3.684 ms
Etot    =   -41.077950223404
Eband   =   -12.336683563435
E1      =    28.124743506206
E2      =   -11.467355671408
E3      =   -15.708601679023
Exc     =   -14.036827672777
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 4.734e-05, dEband = 1.634e-02
rank = 0, Calculating/Estimating energy took 1.319 ms, Etot = -41.077950223, dEtot = 4.734e-05, dEband = 1.634e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3011159398667, which took 0.256 ms

iter_count = 114, r_2norm = 9.221e-06, tol*||rhs|| = 1.204e-05

Anderson update took 55.407 ms, out of which F'*F took 49.971 ms; b-Ax took 210.458 ms, out of which Lap took 200.132 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 347.639 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204965, int_b + int_rho = -6.075e-13, checking this took 1.117 ms
2-norm of RHS = 714.6142473441480, which took 0.200 ms

iter_count = 216, r_2norm = 6.345e-04, tol*||rhs|| = 7.146e-04

Anderson update took 105.292 ms, out of which F'*F took 61.210 ms; b-Ax took 366.688 ms, out of which Lap took 346.336 ms
Solving Poisson took 609.092 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.125 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.136655 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.080524 
Total time for convolution: 	 convolve: 5.082174 
Total time for convolution: 	 convolve: 5.078701 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.779 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.504 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.365 ms
---Transfer Veff_loc: D2D took 1.207 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.419 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.649 ms

This SCF took 26855.712 ms, scf error = 1.912e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.129869, lowerbound = -0.950314, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1458.728 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 13.376 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.059 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.393 ms
rank =  0, Distribute data + matrix mult took 18.843 ms
rank =  0, finding HY took 24.982 ms
rank =  0, distributing HY into block cyclic form took 12.896 ms
rank =  0, finding Y'*HY took 7.865 ms
Rank 0, Project_Hamiltonian used 64.607 ms
Total time for projection: 64.623 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.125 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.184 ms
    first calculated eigval = -0.949587243889312
    last  calculated eigval = 0.029601718477746
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53585102807270
lambda[   5] =  -0.52894171437483
lambda[   6] =  -0.45724377997632
lambda[   7] =  -0.45534392961220
lambda[   8] =  -0.40456084713543
lambda[   9] =  -0.40361124116555
lambda[  10] =  -0.31485581643597
lambda[  11] =  -0.25257430178594
lambda[  12] =  -0.22536762763317
lambda[  13] =  -0.16277088720756
lambda[  14] =  -0.09072915364825
lambda[  15] =  -0.02920648449435
lambda[  16] =   0.01225380529056
lambda[  17] =   0.01290947957754
lambda[  18] =   0.01942702470266
lambda[  19] =   0.02769081557233
lambda[  20] =   0.02960171847775
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 4.779 ms
rank =  0, Distributing orbital back into band + domain format took 14.232 ms
rank = 0, Subspace_Rotation used 19.019 ms

Total time for subspace rotation: 19.023 ms
rank = 0, Efermi =  -0.119807659447 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.953 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.292 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.148 ms
rank = 0, Calculating density took 1548.058 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.606 ms
rank = 0, D2D took 3.707 ms
rank = 0, Transfering density took 3.712 ms
Etot    =   -41.078041077424
Eband   =   -12.316394613356
E1      =    28.118736544614
E2      =   -11.452920575047
E3      =   -15.707907628845
Exc     =   -14.036071368746
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.009e-05, dEband = 2.254e-03
rank = 0, Calculating/Estimating energy took 1.300 ms, Etot = -41.078041077, dEtot = 1.009e-05, dEband = 2.254e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2112983173358, which took 0.204 ms

iter_count = 114, r_2norm = 5.681e-06, tol*||rhs|| = 8.452e-06

Anderson update took 55.661 ms, out of which F'*F took 32.765 ms; b-Ax took 191.188 ms, out of which Lap took 181.100 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.772 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204970, int_b + int_rho = -5.530e-13, checking this took 0.200 ms
2-norm of RHS = 714.5395728767988, which took 0.202 ms

iter_count = 222, r_2norm = 6.740e-04, tol*||rhs|| = 7.145e-04

Anderson update took 106.545 ms, out of which F'*F took 63.351 ms; b-Ax took 375.939 ms, out of which Lap took 356.253 ms
Solving Poisson took 625.047 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Total time for convolution: 	 convolve: 5.130684 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.109522 
Total time for convolution: 	 convolve: 5.112554 
Total time for convolution: 	 convolve: 5.109483 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.798 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.100 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.149 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.227 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.197 ms
---Transfer Veff_loc: D2D took 1.208 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.434 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.666 ms

This SCF took 26979.719 ms, scf error = 1.475e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.129602, lowerbound = -0.949587, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1377.082 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.938 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.936 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.741 ms
rank =  0, Distribute data + matrix mult took 18.625 ms
rank =  0, finding HY took 24.904 ms
rank =  0, distributing HY into block cyclic form took 12.883 ms
rank =  0, finding Y'*HY took 7.035 ms
Rank 0, Project_Hamiltonian used 63.470 ms
Total time for projection: 63.485 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.068 ms
rank = 0, Solve_Generalized_EigenProblem used 0.195 ms
    first calculated eigval = -0.947585925227786
    last  calculated eigval = 0.030759149977166
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53412268462049
lambda[   5] =  -0.52702554178577
lambda[   6] =  -0.45529707368772
lambda[   7] =  -0.45347803921077
lambda[   8] =  -0.40274271252604
lambda[   9] =  -0.40179844257091
lambda[  10] =  -0.31309292490213
lambda[  11] =  -0.25063050312914
lambda[  12] =  -0.22333843747685
lambda[  13] =  -0.16065900953142
lambda[  14] =  -0.08887217516397
lambda[  15] =  -0.02686094844604
lambda[  16] =   0.01421759220010
lambda[  17] =   0.01476449929813
lambda[  18] =   0.02238350598541
lambda[  19] =   0.02851267007497
lambda[  20] =   0.03075914997717
==subpsace eigenproblem: bcast eigvals took 0.012 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 4.757 ms
rank =  0, Distributing orbital back into band + domain format took 14.271 ms
rank = 0, Subspace_Rotation used 19.037 ms

Total time for subspace rotation: 19.041 ms
rank = 0, Efermi =  -0.117950680820 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 2.065 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.220 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1465.369 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.601 ms
rank = 0, D2D took 4.124 ms
rank = 0, Transfering density took 4.129 ms
Etot    =   -41.078092975235
Eband   =   -12.266569202114
E1      =    28.091625156785
E2      =   -11.429237734496
E3      =   -15.712422997325
Exc     =   -14.039669817898
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 5.766e-06, dEband = 5.536e-03
rank = 0, Calculating/Estimating energy took 1.494 ms, Etot = -41.078092975, dEtot = 5.766e-06, dEband = 5.536e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1366574541818, which took 0.249 ms

iter_count = 114, r_2norm = 3.548e-06, tol*||rhs|| = 5.466e-06

Anderson update took 55.307 ms, out of which F'*F took 32.945 ms; b-Ax took 193.085 ms, out of which Lap took 182.935 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.880 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204963, int_b + int_rho = -6.221e-13, checking this took 0.201 ms
2-norm of RHS = 714.5365817676985, which took 0.058 ms

iter_count = 204, r_2norm = 6.353e-04, tol*||rhs|| = 7.145e-04

Anderson update took 99.708 ms, out of which F'*F took 57.567 ms; b-Ax took 346.154 ms, out of which Lap took 328.054 ms
Solving Poisson took 575.676 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.093 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.122633 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.079079 
Total time for convolution: 	 convolve: 5.078690 
Total time for convolution: 	 convolve: 5.077088 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.501 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.134 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.206 ms
---Transfer Veff_loc: D2D took 1.228 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.428 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.678 ms

This SCF took 26733.373 ms, scf error = 8.491e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130759, lowerbound = -0.947586, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1354.835 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.823 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.025 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.864 ms
rank =  0, Distribute data + matrix mult took 18.720 ms
rank =  0, finding HY took 24.877 ms
rank =  0, distributing HY into block cyclic form took 12.958 ms
rank =  0, finding Y'*HY took 6.814 ms
Rank 0, Project_Hamiltonian used 63.393 ms
Total time for projection: 63.406 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.126 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.946701177014910
    last  calculated eigval = 0.031681103540091
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53326751379807
lambda[   5] =  -0.52615118594183
lambda[   6] =  -0.45440455536940
lambda[   7] =  -0.45259095479006
lambda[   8] =  -0.40189570848558
lambda[   9] =  -0.40094934076023
lambda[  10] =  -0.31218863582620
lambda[  11] =  -0.24972671775848
lambda[  12] =  -0.22246618760505
lambda[  13] =  -0.15980888399895
lambda[  14] =  -0.08787843424269
lambda[  15] =  -0.02435714854323
lambda[  16] =   0.01535918056583
lambda[  17] =   0.01731227189865
lambda[  18] =   0.02534591597175
lambda[  19] =   0.02920027377894
lambda[  20] =   0.03168110354009
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.229 ms
rank =  0, subspace rotation using ScaLAPACK took 4.753 ms
rank =  0, Distributing orbital back into band + domain format took 14.428 ms
rank = 0, Subspace_Rotation used 19.190 ms

Total time for subspace rotation: 19.194 ms
rank = 0, Efermi =  -0.116956940054 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.935 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.360 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.150 ms
rank = 0, Calculating density took 1443.222 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.007 ms
======D2D: initiated sending and receiving took 0.647 ms
rank = 0, D2D took 4.779 ms
rank = 0, Transfering density took 4.782 ms
Etot    =   -41.078171626442
Eband   =   -12.243809489373
E1      =    28.081151252807
E2      =   -11.416791897955
E3      =   -15.713076129868
Exc     =   -14.040241573870
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 8.739e-06, dEband = 2.529e-03
rank = 0, Calculating/Estimating energy took 1.709 ms, Etot = -41.078171626, dEtot = 8.739e-06, dEband = 2.529e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1371772285464, which took 0.216 ms

iter_count = 108, r_2norm = 3.814e-06, tol*||rhs|| = 5.487e-06

Anderson update took 52.403 ms, out of which F'*F took 30.689 ms; b-Ax took 182.442 ms, out of which Lap took 172.914 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.151 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204965, int_b + int_rho = -6.003e-13, checking this took 0.198 ms
2-norm of RHS = 714.5613565718852, which took 0.216 ms

iter_count = 198, r_2norm = 7.061e-04, tol*||rhs|| = 7.146e-04

Anderson update took 97.756 ms, out of which F'*F took 56.492 ms; b-Ax took 335.268 ms, out of which Lap took 317.618 ms
Solving Poisson took 559.268 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.118376 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.087418 
Total time for convolution: 	 convolve: 5.076113 
Total time for convolution: 	 convolve: 5.077185 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.809 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.135 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
---Transfer Veff_loc: D2D took 1.219 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.424 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.666 ms

This SCF took 26676.478 ms, scf error = 6.225e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131681, lowerbound = -0.946701, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1356.207 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 12.917 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.105 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.514 ms
rank =  0, Distribute data + matrix mult took 18.546 ms
rank =  0, finding HY took 24.818 ms
rank =  0, distributing HY into block cyclic form took 13.215 ms
rank =  0, finding Y'*HY took 6.666 ms
Rank 0, Project_Hamiltonian used 63.276 ms
Total time for projection: 63.290 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.176 ms
    first calculated eigval = -0.945580873592471
    last  calculated eigval = 0.032554313824103
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53220358430275
lambda[   5] =  -0.52505926132116
lambda[   6] =  -0.45330626768387
lambda[   7] =  -0.45152163932193
lambda[   8] =  -0.40085227088893
lambda[   9] =  -0.39989063403666
lambda[  10] =  -0.31110679239960
lambda[  11] =  -0.24863235490242
lambda[  12] =  -0.22141519923254
lambda[  13] =  -0.15879682270811
lambda[  14] =  -0.08676357891797
lambda[  15] =  -0.02099499041941
lambda[  16] =   0.01648554999113
lambda[  17] =   0.02132613332813
lambda[  18] =   0.02899602952173
lambda[  19] =   0.03023382506685
lambda[  20] =   0.03255431382410
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.188 ms
rank =  0, subspace rotation using ScaLAPACK took 4.851 ms
rank =  0, Distributing orbital back into band + domain format took 14.385 ms
rank = 0, Subspace_Rotation used 19.246 ms

Total time for subspace rotation: 19.251 ms
rank = 0, Efermi =  -0.115842084531 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.943 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.356 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.146 ms
rank = 0, Calculating density took 1444.511 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.598 ms
rank = 0, D2D took 3.438 ms
rank = 0, Transfering density took 3.443 ms
Etot    =   -41.078334984415
Eband   =   -12.215871932844
E1      =    28.067448396621
E2      =   -11.402050115692
E3      =   -15.714925275011
Exc     =   -14.041746995066
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.815e-05, dEband = 3.104e-03
rank = 0, Calculating/Estimating energy took 1.353 ms, Etot = -41.078334984, dEtot = 1.815e-05, dEband = 3.104e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0686113094591, which took 0.198 ms

iter_count = 114, r_2norm = 1.753e-06, tol*||rhs|| = 2.744e-06

Anderson update took 54.904 ms, out of which F'*F took 32.825 ms; b-Ax took 193.340 ms, out of which Lap took 183.081 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.797 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204963, int_b + int_rho = -6.257e-13, checking this took 0.178 ms
2-norm of RHS = 714.5618910985327, which took 0.193 ms

iter_count = 162, r_2norm = 6.255e-04, tol*||rhs|| = 7.146e-04

Anderson update took 80.131 ms, out of which F'*F took 46.211 ms; b-Ax took 273.485 ms, out of which Lap took 259.094 ms
Solving Poisson took 458.326 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Total time for convolution: 	 convolve: 5.116829 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 8.438 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Total time for convolution: 	 convolve: 5.077506 
Total time for convolution: 	 convolve: 5.073166 
Total time for convolution: 	 convolve: 5.073942 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.538 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.071 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.135 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.401 ms
---Transfer Veff_loc: D2D took 1.269 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 1.153 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.445 ms

This SCF took 26589.394 ms, scf error = 3.880e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.132554, lowerbound = -0.945581, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1359.182 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.977 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.927 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.857 ms
rank =  0, Distribute data + matrix mult took 18.770 ms
rank =  0, finding HY took 24.940 ms
rank =  0, distributing HY into block cyclic form took 12.991 ms
rank =  0, finding Y'*HY took 6.785 ms
Rank 0, Project_Hamiltonian used 63.509 ms
Total time for projection: 63.523 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.183 ms
    first calculated eigval = -0.945154985523318
    last  calculated eigval = 0.032925578887317
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53183715569083
lambda[   5] =  -0.52466003407281
lambda[   6] =  -0.45290780880181
lambda[   7] =  -0.45112558897484
lambda[   8] =  -0.40047751408874
lambda[   9] =  -0.39952104787644
lambda[  10] =  -0.31073298854812
lambda[  11] =  -0.24822387409263
lambda[  12] =  -0.22101354871287
lambda[  13] =  -0.15838679871802
lambda[  14] =  -0.08637035679378
lambda[  15] =  -0.01955687791791
lambda[  16] =   0.01685256349280
lambda[  17] =   0.02254706297908
lambda[  18] =   0.03005172510497
lambda[  19] =   0.03055766884002
lambda[  20] =   0.03292557888732
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.196 ms
rank =  0, subspace rotation using ScaLAPACK took 4.822 ms
rank =  0, Distributing orbital back into band + domain format took 14.305 ms
rank = 0, Subspace_Rotation used 19.135 ms

Total time for subspace rotation: 19.140 ms
rank = 0, Efermi =  -0.115448862427 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.983 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.169 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.146 ms
rank = 0, Calculating density took 1447.451 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.604 ms
rank = 0, D2D took 3.770 ms
rank = 0, Transfering density took 3.773 ms
Etot    =   -41.078398632188
Eband   =   -12.205563900866
E1      =    28.061885193106
E2      =   -11.397066392550
E3      =   -15.715834544151
Exc     =   -14.042481017301
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 7.072e-06, dEband = 1.145e-03
rank = 0, Calculating/Estimating energy took 1.316 ms, Etot = -41.078398632, dEtot = 7.072e-06, dEband = 1.145e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0477110309177, which took 0.173 ms

iter_count = 114, r_2norm = 1.228e-06, tol*||rhs|| = 1.908e-06

Anderson update took 55.912 ms, out of which F'*F took 32.156 ms; b-Ax took 193.039 ms, out of which Lap took 182.652 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.709 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204957, int_b + int_rho = -6.876e-13, checking this took 0.185 ms
2-norm of RHS = 714.5765377791078, which took 0.231 ms

iter_count = 168, r_2norm = 7.030e-04, tol*||rhs|| = 7.146e-04

Anderson update took 80.877 ms, out of which F'*F took 47.595 ms; b-Ax took 285.006 ms, out of which Lap took 269.830 ms
Solving Poisson took 474.270 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.116587 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.272 ms
Total time for convolution: 	 convolve: 5.109837 
Total time for convolution: 	 convolve: 5.118644 
Total time for convolution: 	 convolve: 5.103620 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.505 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.108 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.137 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.386 ms
---Transfer Veff_loc: D2D took 1.261 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.415 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.698 ms

This SCF took 26748.573 ms, scf error = 2.757e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132926, lowerbound = -0.945155, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1353.039 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.815 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.084 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.872 ms
rank =  0, Distribute data + matrix mult took 18.780 ms
rank =  0, finding HY took 24.875 ms
rank =  0, distributing HY into block cyclic form took 12.745 ms
rank =  0, finding Y'*HY took 6.988 ms
Rank 0, Project_Hamiltonian used 63.412 ms
Total time for projection: 63.425 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.124 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.061 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.944900774528777
    last  calculated eigval = 0.033767031527605
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53155288086003
lambda[   5] =  -0.52439081171680
lambda[   6] =  -0.45265022894955
lambda[   7] =  -0.45081403713899
lambda[   8] =  -0.40020096213042
lambda[   9] =  -0.39926235309882
lambda[  10] =  -0.31044510356842
lambda[  11] =  -0.24795965961125
lambda[  12] =  -0.22076649658015
lambda[  13] =  -0.15815453691089
lambda[  14] =  -0.08611847370103
lambda[  15] =  -0.01747429022838
lambda[  16] =   0.01705782396573
lambda[  17] =   0.02409572012049
lambda[  18] =   0.03150057542531
lambda[  19] =   0.03159825877668
lambda[  20] =   0.03376703152760
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 4.795 ms
rank =  0, Distributing orbital back into band + domain format took 14.272 ms
rank = 0, Subspace_Rotation used 19.084 ms

Total time for subspace rotation: 19.088 ms
rank = 0, Efermi =  -0.115196979416 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 2.046 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.608 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1441.354 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.589 ms
rank = 0, D2D took 3.587 ms
rank = 0, Transfering density took 3.591 ms
Etot    =   -41.078476618701
Eband   =   -12.198618422847
E1      =    28.059104018060
E2      =   -11.392822315616
E3      =   -15.715839718502
Exc     =   -14.042484404203
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 8.665e-06, dEband = 7.717e-04
rank = 0, Calculating/Estimating energy took 1.439 ms, Etot = -41.078476619, dEtot = 8.665e-06, dEband = 7.717e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0379803314712, which took 0.223 ms

iter_count = 114, r_2norm = 9.770e-07, tol*||rhs|| = 1.519e-06

Anderson update took 54.814 ms, out of which F'*F took 31.912 ms; b-Ax took 192.848 ms, out of which Lap took 182.648 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.562 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204964, int_b + int_rho = -6.185e-13, checking this took 0.199 ms
2-norm of RHS = 714.5774117314886, which took 0.205 ms

iter_count = 138, r_2norm = 6.747e-04, tol*||rhs|| = 7.146e-04

Anderson update took 67.509 ms, out of which F'*F took 39.629 ms; b-Ax took 233.988 ms, out of which Lap took 221.746 ms
Solving Poisson took 389.761 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.072 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Total time for convolution: 	 convolve: 5.113363 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.091022 
Total time for convolution: 	 convolve: 5.078817 
Total time for convolution: 	 convolve: 5.074832 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.836 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.501 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.030 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.224 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.166 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
---Transfer Veff_loc: D2D took 1.255 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.589 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.867 ms

This SCF took 26545.177 ms, scf error = 2.216e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.133767, lowerbound = -0.944901, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1358.052 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 12.967 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.060 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.550 ms
rank =  0, Distribute data + matrix mult took 18.588 ms
rank =  0, finding HY took 25.667 ms
rank =  0, distributing HY into block cyclic form took 12.851 ms
rank =  0, finding Y'*HY took 6.943 ms
Rank 0, Project_Hamiltonian used 64.091 ms
Total time for projection: 64.107 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.123 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.067 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.944778933682056
    last  calculated eigval = 0.033743729268026
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53141255920862
lambda[   5] =  -0.52425601847152
lambda[   6] =  -0.45251475891269
lambda[   7] =  -0.45067321369176
lambda[   8] =  -0.40006357503640
lambda[   9] =  -0.39912717967587
lambda[  10] =  -0.31031321168211
lambda[  11] =  -0.24783264932479
lambda[  12] =  -0.22063188636216
lambda[  13] =  -0.15802384152932
lambda[  14] =  -0.08601401474556
lambda[  15] =  -0.01656203316033
lambda[  16] =   0.01713387553414
lambda[  17] =   0.02481429039885
lambda[  18] =   0.03190316620437
lambda[  19] =   0.03234664195264
lambda[  20] =   0.03374372926803
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.773 ms
rank =  0, Distributing orbital back into band + domain format took 14.305 ms
rank = 0, Subspace_Rotation used 19.087 ms

Total time for subspace rotation: 19.091 ms
rank = 0, Efermi =  -0.115092520433 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.939 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.250 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.159 ms
rank = 0, Calculating density took 1446.940 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.597 ms
rank = 0, D2D took 3.772 ms
rank = 0, Transfering density took 3.777 ms
Etot    =   -41.078510775731
Eband   =   -12.195141330231
E1      =    28.057359311359
E2      =   -11.391015316805
E3      =   -15.716051731137
Exc     =   -14.042655960973
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 3.795e-06, dEband = 3.863e-04
rank = 0, Calculating/Estimating energy took 1.253 ms, Etot = -41.078510776, dEtot = 3.795e-06, dEband = 3.863e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0342781943835, which took 0.204 ms

iter_count = 108, r_2norm = 1.369e-06, tol*||rhs|| = 1.371e-06

Anderson update took 52.603 ms, out of which F'*F took 30.594 ms; b-Ax took 180.988 ms, out of which Lap took 170.954 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.504 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204963, int_b + int_rho = -6.221e-13, checking this took 0.183 ms
2-norm of RHS = 714.5769174202856, which took 0.189 ms

iter_count = 120, r_2norm = 7.036e-04, tol*||rhs|| = 7.146e-04

Anderson update took 57.930 ms, out of which F'*F took 34.193 ms; b-Ax took 203.348 ms, out of which Lap took 192.593 ms
Solving Poisson took 338.908 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.068 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Total time for convolution: 	 convolve: 5.114086 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.078463 
Total time for convolution: 	 convolve: 5.197977 
Total time for convolution: 	 convolve: 5.078813 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.503 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.112 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.133 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.221 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.213 ms
---Transfer Veff_loc: D2D took 1.241 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.430 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.693 ms

This SCF took 26583.589 ms, scf error = 1.805e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.133744, lowerbound = -0.944779, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1349.654 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 40.494 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.045 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.929 ms
rank =  0, Distribute data + matrix mult took 46.478 ms
rank =  0, finding HY took 24.902 ms
rank =  0, distributing HY into block cyclic form took 12.727 ms
rank =  0, finding Y'*HY took 7.019 ms
Rank 0, Project_Hamiltonian used 91.153 ms
Total time for projection: 91.167 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.128 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.057 ms
rank = 0, Solve_Generalized_EigenProblem used 0.188 ms
    first calculated eigval = -0.944725136230711
    last  calculated eigval = 0.033812904496808
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53134188788525
lambda[   5] =  -0.52419181062827
lambda[   6] =  -0.45244685776321
lambda[   7] =  -0.45061133283704
lambda[   8] =  -0.39999822044379
lambda[   9] =  -0.39905860950318
lambda[  10] =  -0.31024674603549
lambda[  11] =  -0.24777239100802
lambda[  12] =  -0.22056803057733
lambda[  13] =  -0.15796492509743
lambda[  14] =  -0.08596017523410
lambda[  15] =  -0.01584845652011
lambda[  16] =   0.01718277034195
lambda[  17] =   0.02538087843645
lambda[  18] =   0.03219062301598
lambda[  19] =   0.03293010256146
lambda[  20] =   0.03381290449681
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 4.765 ms
rank =  0, Distributing orbital back into band + domain format took 14.146 ms
rank = 0, Subspace_Rotation used 18.919 ms

Total time for subspace rotation: 18.924 ms
rank = 0, Efermi =  -0.115038680974 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 1.959 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.242 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.154 ms
rank = 0, Calculating density took 1465.454 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.606 ms
rank = 0, D2D took 3.925 ms
rank = 0, Transfering density took 3.931 ms
Etot    =   -41.078523081354
Eband   =   -12.193490584769
E1      =    28.056577685446
E2      =   -11.390138960267
E3      =   -15.716063263741
Exc     =   -14.042672562211
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.367e-06, dEband = 1.834e-04
rank = 0, Calculating/Estimating energy took 1.284 ms, Etot = -41.078523081, dEtot = 1.367e-06, dEband = 1.834e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0334319980846, which took 0.247 ms

iter_count = 108, r_2norm = 1.309e-06, tol*||rhs|| = 1.337e-06

Anderson update took 52.361 ms, out of which F'*F took 30.754 ms; b-Ax took 182.808 ms, out of which Lap took 173.225 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.375 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204960, int_b + int_rho = -6.548e-13, checking this took 0.191 ms
2-norm of RHS = 714.5739525372478, which took 0.198 ms

iter_count = 108, r_2norm = 6.880e-04, tol*||rhs|| = 7.146e-04

Anderson update took 53.167 ms, out of which F'*F took 30.595 ms; b-Ax took 183.089 ms, out of which Lap took 173.530 ms
Solving Poisson took 306.331 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.948 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.117581 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.074770 
Total time for convolution: 	 convolve: 5.079540 
Total time for convolution: 	 convolve: 5.075291 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.789 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.501 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.075 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.131 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.789 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.170 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.210 ms
---Transfer Veff_loc: D2D took 1.243 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.458 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.738 ms

This SCF took 26433.451 ms, scf error = 1.708e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.133813, lowerbound = -0.944725, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1356.387 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 13.361 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.005 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.369 ms
rank =  0, Distribute data + matrix mult took 18.749 ms
rank =  0, finding HY took 24.982 ms
rank =  0, distributing HY into block cyclic form took 12.850 ms
rank =  0, finding Y'*HY took 6.983 ms
Rank 0, Project_Hamiltonian used 63.586 ms
Total time for projection: 63.604 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.059 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.944671599133769
    last  calculated eigval = 0.033576194695396
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53129957866565
lambda[   5] =  -0.52414491604067
lambda[   6] =  -0.45240095123712
lambda[   7] =  -0.45056578386460
lambda[   8] =  -0.39995400358409
lambda[   9] =  -0.39901487777448
lambda[  10] =  -0.31020337239233
lambda[  11] =  -0.24772425616594
lambda[  12] =  -0.22052263627236
lambda[  13] =  -0.15791773656620
lambda[  14] =  -0.08592745705100
lambda[  15] =  -0.01574849367361
lambda[  16] =   0.01720173910251
lambda[  17] =   0.02520266088062
lambda[  18] =   0.03212429906364
lambda[  19] =   0.03312504410426
lambda[  20] =   0.03357619469540
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.770 ms
rank =  0, Distributing orbital back into band + domain format took 14.214 ms
rank = 0, Subspace_Rotation used 18.992 ms

Total time for subspace rotation: 18.997 ms
rank = 0, Efermi =  -0.115005962832 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.939 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.306 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.160 ms
rank = 0, Calculating density took 1444.691 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.602 ms
rank = 0, D2D took 3.688 ms
rank = 0, Transfering density took 3.693 ms
Etot    =   -41.078533820766
Eband   =   -12.192280186080
E1      =    28.055874963974
E2      =   -11.389622762086
E3      =   -15.716090457930
Exc     =   -14.042701974848
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.193e-06, dEband = 1.345e-04
rank = 0, Calculating/Estimating energy took 1.420 ms, Etot = -41.078533821, dEtot = 1.193e-06, dEband = 1.345e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0226480228854, which took 0.206 ms

iter_count = 114, r_2norm = 5.722e-07, tol*||rhs|| = 9.059e-07

Anderson update took 54.313 ms, out of which F'*F took 31.970 ms; b-Ax took 191.638 ms, out of which Lap took 181.560 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.429 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204958, int_b + int_rho = -6.767e-13, checking this took 0.194 ms
2-norm of RHS = 714.5707805096145, which took 1.157 ms

iter_count = 144, r_2norm = 6.549e-04, tol*||rhs|| = 7.146e-04

Anderson update took 70.008 ms, out of which F'*F took 41.067 ms; b-Ax took 243.803 ms, out of which Lap took 230.983 ms
Solving Poisson took 407.418 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.081 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.106899 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.092390 
Total time for convolution: 	 convolve: 5.076993 
Total time for convolution: 	 convolve: 5.073489 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.813 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.502 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.138 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 1.335 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.455 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.813 ms

This SCF took 26549.726 ms, scf error = 1.477e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133576, lowerbound = -0.944672, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1353.605 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.913 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.071 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.795 ms
rank =  0, Distribute data + matrix mult took 18.788 ms
rank =  0, finding HY took 24.952 ms
rank =  0, distributing HY into block cyclic form took 13.065 ms
rank =  0, finding Y'*HY took 6.755 ms
Rank 0, Project_Hamiltonian used 63.584 ms
Total time for projection: 63.598 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.119 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.055 ms
rank = 0, Solve_Generalized_EigenProblem used 0.177 ms
    first calculated eigval = -0.944628352208535
    last  calculated eigval = 0.033411762566801
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53126345654039
lambda[   5] =  -0.52411266545185
lambda[   6] =  -0.45237585393899
lambda[   7] =  -0.45052136919013
lambda[   8] =  -0.39991600973324
lambda[   9] =  -0.39898261311076
lambda[  10] =  -0.31016493807764
lambda[  11] =  -0.24769347263879
lambda[  12] =  -0.22050564371981
lambda[  13] =  -0.15790265932434
lambda[  14] =  -0.08593865828707
lambda[  15] =  -0.01660635826081
lambda[  16] =   0.01714684136407
lambda[  17] =   0.02397442514801
lambda[  18] =   0.03099415475989
lambda[  19] =   0.03253486965030
lambda[  20] =   0.03341176256680
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.772 ms
rank =  0, Distributing orbital back into band + domain format took 14.259 ms
rank = 0, Subspace_Rotation used 19.040 ms

Total time for subspace rotation: 19.045 ms
rank = 0, Efermi =  -0.115017163916 calculate fermi energy took 0.043 ms
rank = 0, --- Calculate rho: sum over local bands took 1.954 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.322 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1441.971 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.616 ms
rank = 0, D2D took 3.696 ms
rank = 0, Transfering density took 3.702 ms
Etot    =   -41.078558080384
Eband   =   -12.191440255557
E1      =    28.055467926359
E2      =   -11.389215812523
E3      =   -15.715906765953
Exc     =   -14.042568485834
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 2.696e-06, dEband = 9.333e-05
rank = 0, Calculating/Estimating energy took 1.336 ms, Etot = -41.078558080, dEtot = 2.696e-06, dEband = 9.333e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0189741382736, which took 0.233 ms

iter_count = 114, r_2norm = 5.344e-07, tol*||rhs|| = 7.590e-07

Anderson update took 55.883 ms, out of which F'*F took 32.491 ms; b-Ax took 194.410 ms, out of which Lap took 184.242 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 330.413 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204960, int_b + int_rho = -6.512e-13, checking this took 0.196 ms
2-norm of RHS = 714.5698910827379, which took 0.245 ms

iter_count = 102, r_2norm = 6.159e-04, tol*||rhs|| = 7.146e-04

Anderson update took 49.862 ms, out of which F'*F took 29.224 ms; b-Ax took 172.400 ms, out of which Lap took 163.375 ms
Solving Poisson took 288.401 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.107963 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 6.591 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.077054 
Total time for convolution: 	 convolve: 5.077937 
Total time for convolution: 	 convolve: 5.074179 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.502 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.109 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.135 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.210 ms
---Transfer Veff_loc: D2D took 1.228 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.434 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.684 ms

This SCF took 26424.686 ms, scf error = 1.299e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.133412, lowerbound = -0.944628, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1353.309 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 12.875 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.035 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.740 ms
rank =  0, Distribute data + matrix mult took 18.659 ms
rank =  0, finding HY took 24.926 ms
rank =  0, distributing HY into block cyclic form took 12.986 ms
rank =  0, finding Y'*HY took 6.780 ms
Rank 0, Project_Hamiltonian used 63.374 ms
Total time for projection: 63.386 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.056 ms
rank = 0, Solve_Generalized_EigenProblem used 0.180 ms
    first calculated eigval = -0.944557092213129
    last  calculated eigval = 0.033707509304502
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53120948703529
lambda[   5] =  -0.52405515037156
lambda[   6] =  -0.45231881503369
lambda[   7] =  -0.45046067142779
lambda[   8] =  -0.39985954264105
lambda[   9] =  -0.39892945030834
lambda[  10] =  -0.31010805818534
lambda[  11] =  -0.24763375196034
lambda[  12] =  -0.22045344035821
lambda[  13] =  -0.15784874821044
lambda[  14] =  -0.08588147600949
lambda[  15] =  -0.01618561234662
lambda[  16] =   0.01719523872384
lambda[  17] =   0.02408843566055
lambda[  18] =   0.03131868315131
lambda[  19] =   0.03264549861155
lambda[  20] =   0.03370750930450
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.192 ms
rank =  0, subspace rotation using ScaLAPACK took 4.773 ms
rank =  0, Distributing orbital back into band + domain format took 14.287 ms
rank = 0, Subspace_Rotation used 19.068 ms

Total time for subspace rotation: 19.073 ms
rank = 0, Efermi =  -0.114959981708 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 1.945 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.303 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.152 ms
rank = 0, Calculating density took 1441.488 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.594 ms
rank = 0, D2D took 3.605 ms
rank = 0, Transfering density took 3.607 ms
Etot    =   -41.078559877844
Eband   =   -12.189919553836
E1      =    28.054580445462
E2      =   -11.388547804309
E3      =   -15.716060194914
Exc     =   -14.042688924865
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 1.997e-07, dEband = 1.690e-04
rank = 0, Calculating/Estimating energy took 1.264 ms, Etot = -41.078559878, dEtot = 1.997e-07, dEband = 1.690e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0198776681774, which took 0.227 ms

iter_count = 108, r_2norm = 7.623e-07, tol*||rhs|| = 7.951e-07

Anderson update took 52.805 ms, out of which F'*F took 30.641 ms; b-Ax took 181.995 ms, out of which Lap took 172.396 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.610 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204959, int_b + int_rho = -6.658e-13, checking this took 0.182 ms
2-norm of RHS = 714.5708477050750, which took 0.186 ms

iter_count = 126, r_2norm = 6.487e-04, tol*||rhs|| = 7.146e-04

Anderson update took 84.936 ms, out of which F'*F took 35.826 ms; b-Ax took 212.963 ms, out of which Lap took 201.732 ms
Solving Poisson took 382.107 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.082227 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Total time for convolution: 	 convolve: 5.063222 
Total time for convolution: 	 convolve: 5.078030 
Total time for convolution: 	 convolve: 5.106599 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.131 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.183 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.195 ms
---Transfer Veff_loc: D2D took 1.186 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.414 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 1.623 ms

This SCF took 26485.931 ms, scf error = 1.087e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133708, lowerbound = -0.944557, upperbound = 267.596886

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 45): 1356.641 ms
New BLOCK CYCLIC DOMAIN: nproc = 4, dims = (4, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 13.183 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 4.076 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.356 ms
rank =  0, Distribute data + matrix mult took 18.627 ms
rank =  0, finding HY took 24.996 ms
rank =  0, distributing HY into block cyclic form took 13.229 ms
rank =  0, finding Y'*HY took 6.560 ms
Rank 0, Project_Hamiltonian used 63.437 ms
Total time for projection: 63.453 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.121 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.065 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.944458316045306
    last  calculated eigval = 0.033387299713946
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 26):
lambda[   4] =  -0.53113120343821
lambda[   5] =  -0.52397502495810
lambda[   6] =  -0.45223467926992
lambda[   7] =  -0.45037977905533
lambda[   8] =  -0.39978095729166
lambda[   9] =  -0.39885275203808
lambda[  10] =  -0.31002716560212
lambda[  11] =  -0.24755024735531
lambda[  12] =  -0.22038127466670
lambda[  13] =  -0.15777575554539
lambda[  14] =  -0.08583250192045
lambda[  15] =  -0.01746318237783
lambda[  16] =   0.01721541611323
lambda[  17] =   0.02251458457077
lambda[  18] =   0.03003518829947
lambda[  19] =   0.03137477025539
lambda[  20] =   0.03338729971395
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 4.860 ms
rank =  0, Distributing orbital back into band + domain format took 14.679 ms
rank = 0, Subspace_Rotation used 19.551 ms

Total time for subspace rotation: 19.555 ms
rank = 0, Efermi =  -0.114911007721 calculate fermi energy took 0.047 ms
rank = 0, --- Calculate rho: sum over local bands took 1.982 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.323 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.248 ms
rank = 0, Calculating density took 1445.501 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.017 ms
======D2D: initiated sending and receiving took 0.627 ms
rank = 0, D2D took 4.487 ms
rank = 0, Transfering density took 4.491 ms
Etot    =   -41.078564076424
Eband   =   -12.187782474816
E1      =    28.053385519333
E2      =   -11.387530946929
E3      =   -15.716309037805
Exc     =   -14.042867261847
Esc     =   -70.005139843168
Entropy =    -0.000000000661
dE = 4.665e-07, dEband = 2.375e-04
rank = 0, Calculating/Estimating energy took 1.805 ms, Etot = -41.078564076, dEtot = 4.665e-07, dEband = 2.375e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0197870914975, which took 0.208 ms

iter_count = 108, r_2norm = 6.056e-07, tol*||rhs|| = 7.915e-07

Anderson update took 52.249 ms, out of which F'*F took 30.992 ms; b-Ax took 183.199 ms, out of which Lap took 173.224 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.990 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -26.00000002205025, int_rho =  26.00000002204955, int_b + int_rho = -7.058e-13, checking this took 0.196 ms
2-norm of RHS = 714.5726289338534, which took 0.206 ms

iter_count = 120, r_2norm = 6.501e-04, tol*||rhs|| = 7.146e-04

Anderson update took 58.841 ms, out of which F'*F took 33.372 ms; b-Ax took 202.447 ms, out of which Lap took 191.470 ms
Solving Poisson took 340.220 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Total time for convolution: 	 convolve: 5.093835 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.268 ms
Total time for convolution: 	 convolve: 5.078655 
Total time for convolution: 	 convolve: 5.073442 
Total time for convolution: 	 convolve: 5.155337 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.054 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.855 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.051 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.582 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.355 ms
---Transfer Veff_loc: D2D took 1.837 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 340000) to all bandcomms took 0.670 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 2.551 ms

This SCF took 26585.183 ms, scf error = 7.998e-05
The last 17 occupations of kpoints #1 are (Nelectron = 26):
lambda[   4] =  -0.53113120343821, occ[   4] =   2.00000000000000
lambda[   5] =  -0.52397502495810, occ[   5] =   2.00000000000000
lambda[   6] =  -0.45223467926992, occ[   6] =   2.00000000000000
lambda[   7] =  -0.45037977905533, occ[   7] =   2.00000000000000
lambda[   8] =  -0.39978095729166, occ[   8] =   2.00000000000000
lambda[   9] =  -0.39885275203808, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31002716560212, occ[  10] =   2.00000000000000
lambda[  11] =  -0.24755024735531, occ[  11] =   2.00000000000000
lambda[  12] =  -0.22038127466670, occ[  12] =   2.00000000000000
lambda[  13] =  -0.15777575554539, occ[  13] =   2.00000000000000
lambda[  14] =  -0.08583250192045, occ[  14] =   0.00000002204962
lambda[  15] =  -0.01746318237783, occ[  15] =   0.00000000000000
lambda[  16] =   0.01721541611323, occ[  16] =   0.00000000000000
lambda[  17] =   0.02251458457077, occ[  17] =   0.00000000000000
lambda[  18] =   0.03003518829947, occ[  18] =   0.00000000000000
lambda[  19] =   0.03137477025539, occ[  19] =   0.00000000000000
lambda[  20] =   0.03338729971395, occ[  20] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 18 (90%) = 0.000000000000000.
Occupation of state 20 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.905 ms, time for Allreduce/Reduce: 8.370 ms 
Time for calculating local force components: 22.200 ms
Start Calculating nonlocal forces
force_nloc = 
  0.04203710940130   0.00000001611374  -0.02900950832496
 -0.04203712083606   0.00000000584412  -0.02900952614677
  0.00000000616600  -0.03746639444356   0.03777851653495
  0.00000000157081   0.03746638696276   0.03777852386600
 -0.00000027203542   0.00000030101418  -0.13471459074943
  0.00000021286391   0.00747602182737   0.09270716118941
  0.00000015644943  -0.00747558764394   0.09270672344055
 -0.00000031940981  -0.56591873761805  -0.24207061871681
 -0.00000026579789   0.56591630659588  -0.24207002200076
force_loc = 
 -0.04535312648421  -0.00000006165023   0.03318958875360
  0.04535316285452  -0.00000036800671   0.03318943721189
  0.00000005870916   0.04068241691176  -0.04142152065914
  0.00000006404692  -0.04068312638127  -0.04142190112897
  0.00000014089627  -0.00000237652680   0.09409613975214
  0.00000077933028  -0.01060816434692  -0.09828491029651
  0.00000134601107   0.01061034577364  -0.09828394480583
 -0.00000242334105   0.75160155216615   0.25991178270982
 -0.00000044867589  -0.75159239657500   0.25990948224741
Time for calculating nonlocal force components: 41.851 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00000002307539  -0.00000012749478  -0.00016239084486
[0m[32m  0.00000003097322  -0.00036006358322   0.00610800230178
[0m[32m  0.00000006064647   0.00036021671744   0.00610806789884
[0m[32m -0.00000010575185   0.01177697923302   0.00156422541165
[0m[32m -0.00000007226558  -0.01177650850085   0.00156408394507
[0mTime for calculating XC forces components: 30.934 ms
 Cartesian force = 
 -0.00331590066582  -0.00000078291301   0.00416199136319
  0.00331615843555  -0.00000109953912   0.00416182199967
  0.00000018129225   0.00321528509168  -0.00366109318964
  0.00000018203481  -0.00321747679503  -0.00366146632843
 -0.00000003779745  -0.00000294038392  -0.04079893090761
  0.00000113958450  -0.00349294347930   0.00051216412922
  0.00000167952405   0.00349423747061   0.00051275746811
 -0.00000273208562   0.19745905640459   0.01938730033921
 -0.00000067032227  -0.19745333585650   0.01938545512627
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.314 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.391 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Time for printing density: 405.321 ms
The program took 542.394 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:29:39
Job ID:        2266700
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:51:48,vmem=8440K,walltime=00:09:19,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-7-2
---------------------------------------
