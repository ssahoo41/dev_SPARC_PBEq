---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:00
Job ID:    2267022
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:29:05
Job ID:    2267022
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.063 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.013 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 20.408 ms
Reading ion file sprc-calc.ion
Number of atom types : 4.
Total number of atoms: 9.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8
pseudo_dir # 4 = N.psp8

Reading ion file took 5.687 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 130.720 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.024 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.760 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   10.832828	   12.974476	    9.738158	
    6.251682	   11.542215	    9.254240	
    7.101830	    8.393232	    8.385975	
    6.917412	    9.252205	   11.614025	
   13.748318	    9.277282	    9.886756	
   11.386368	    7.025524	    9.905175	
    7.440473	    9.929077	    9.728418	
   10.191753	   10.772114	    9.718115	
   11.909324	    8.836131	    9.672609	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.006 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.853 ms
Set up communicators.

--set up spincomm took 1.606 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 19, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 19 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 19, mbQ = nbQ = 64
rank = 0, nr_Hp = 19, nc_Hp = 19
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.034 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.400 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 6.526 ms

Calculate_SplineDerivRadFun took 0.315 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.774 ms.
time spent on vectorized spline interp: 3.592 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.728 ms.
time spent on vectorized spline interp: 1.261 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.292 ms.
time spent on vectorized spline interp: 1.567 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.593 ms.
time spent on vectorized spline interp: 1.570 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 3, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.509 ms.

Calculating rb for all atom types took 19.898 ms
----------------------
Estimated memory usage
Total: 1.16 GB
orbitals             : 869.75 MB
global sized vectors : 213.62 MB
subspace matrices : 8.46 kB
others : 108.34 MB
----------------------------------------------
Estimated memory usage per processor: 99.31 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.899 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -24.0000000370992, sum_int_rho = 23.4990822813901
PosCharge = 24.000000037099, NegCharge = -23.499082281390, scal_fac = 1.021316481627
After scaling, int_rho = 24.0000000370992, PosCharge + NegCharge - NetCharge = 0.000e+00
--Calculate Vref took 0.527 ms
--Calculate rho_guess took 2.586 ms

 integral of b = -24.0000000370992,
 int{b} + Nelectron + NetCharge = -3.710e-08,
 Esc = -68.5550536788838,
 MPI_Reduce took 5.849 ms

Calculating b & b_ref took 15.391 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.073 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.083 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.080 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.603 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.003 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.005 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.825 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709933, int_b + int_rho = 1.382e-13, checking this took 0.091 ms
2-norm of RHS = 728.3295973034186, which took 0.458 ms

iter_count = 420, r_2norm = 6.111e-04, tol*||rhs|| = 7.283e-04

Anderson update took 201.251 ms, out of which F'*F took 94.856 ms; b-Ax took 634.797 ms, out of which Lap took 577.733 ms
Solving Poisson took 1228.352 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.405 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.807 ms
Total time for convolution: 	 convolve: 5.159717 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 150.970 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
Total time for convolution: 	 convolve: 5.111937 
Total time for convolution: 	 convolve: 5.125129 
Total time for convolution: 	 convolve: 5.103747 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.715 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.521 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.168 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.652 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
rank = 0, XC calculation took 24505.938 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 5.064 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.780 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.970 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.143 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.559 ms
    Lanczos iter 53, eigmin  = -1.007562359, eigmax = 264.930214703, err_eigmin = 1.963e-03, err_eigmax = 9.670e-03
rank =   0, Lanczos took 106.727 ms, eigmin = -1.007562358836, eigmax = 267.579516849657

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.235977, lowerbound = -1.107562, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1335.003 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 53.924 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.683 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 56.623 ms
rank =  0, finding HY took 23.699 ms
rank =  0, distributing HY into block cyclic form took 19.106 ms
rank =  0, finding Y'*HY took 3.944 ms
Rank 0, Project_Hamiltonian used 103.398 ms
Total time for projection: 103.412 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.745 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.088 ms
rank = 0, Solve_Generalized_EigenProblem used 0.837 ms
    first calculated eigval = 2.746717806377130
    last  calculated eigval = 3.251014190842660
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =   2.81606156368225
lambda[   4] =   2.82644237657602
lambda[   5] =   2.86510375909222
lambda[   6] =   2.90415746767507
lambda[   7] =   2.93141821398541
lambda[   8] =   2.97123652780788
lambda[   9] =   2.99104949821013
lambda[  10] =   3.00924482863992
lambda[  11] =   3.02230426225695
lambda[  12] =   3.03730088304002
lambda[  13] =   3.07698350328705
lambda[  14] =   3.13108847377302
lambda[  15] =   3.14695442548049
lambda[  16] =   3.15043015751913
lambda[  17] =   3.18070465890280
lambda[  18] =   3.21699669272005
lambda[  19] =   3.25101419084266
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.850 ms
rank =  0, subspace rotation using ScaLAPACK took 6.545 ms
rank =  0, Distributing orbital back into band + domain format took 15.038 ms
rank = 0, Subspace_Rotation used 21.593 ms

Total time for subspace rotation: 21.596 ms
rank = 0, Efermi =   3.057142369907 calculate fermi energy took 0.047 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.351014, lowerbound = -1.107562, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1334.903 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.298 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.312 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.619 ms
rank =  0, finding HY took 23.177 ms
rank =  0, distributing HY into block cyclic form took 15.400 ms
rank =  0, finding Y'*HY took 3.445 ms
Rank 0, Project_Hamiltonian used 59.663 ms
Total time for projection: 59.681 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.122 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.232 ms
    first calculated eigval = -0.871424334558139
    last  calculated eigval = 0.456367876289785
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.55117172737836
lambda[   4] =  -0.30809742498950
lambda[   5] =  -0.19446827777305
lambda[   6] =  -0.13150635760577
lambda[   7] =  -0.05953068273034
lambda[   8] =  -0.00154786968388
lambda[   9] =   0.01596885707187
lambda[  10] =   0.11429608907590
lambda[  11] =   0.17569075770549
lambda[  12] =   0.27628262838781
lambda[  13] =   0.29279278382848
lambda[  14] =   0.32140160266567
lambda[  15] =   0.35472752501618
lambda[  16] =   0.37918545205789
lambda[  17] =   0.39739739666331
lambda[  18] =   0.40973457998323
lambda[  19] =   0.45636787628978
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.247 ms
rank =  0, subspace rotation using ScaLAPACK took 6.473 ms
rank =  0, Distributing orbital back into band + domain format took 15.262 ms
rank = 0, Subspace_Rotation used 21.743 ms

Total time for subspace rotation: 21.748 ms
rank = 0, Efermi =   0.284537706535 calculate fermi energy took 0.037 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.556368, lowerbound = -1.107562, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1338.431 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 15.265 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.378 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.652 ms
rank =  0, finding HY took 23.026 ms
rank =  0, distributing HY into block cyclic form took 15.342 ms
rank =  0, finding Y'*HY took 3.508 ms
Rank 0, Project_Hamiltonian used 59.547 ms
Total time for projection: 59.555 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.201 ms
    first calculated eigval = -1.031960485555946
    last  calculated eigval = 0.182224401957331
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79033483847835
lambda[   4] =  -0.61754040151347
lambda[   5] =  -0.56868351533399
lambda[   6] =  -0.51538012467635
lambda[   7] =  -0.49532804847774
lambda[   8] =  -0.46748288240680
lambda[   9] =  -0.44043059066821
lambda[  10] =  -0.39257675831122
lambda[  11] =  -0.29291865444985
lambda[  12] =  -0.27110599936160
lambda[  13] =   0.00477092992562
lambda[  14] =   0.04335714278915
lambda[  15] =   0.08346951500013
lambda[  16] =   0.10211810555641
lambda[  17] =   0.11862445361651
lambda[  18] =   0.14105163360537
lambda[  19] =   0.18222440195733
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.504 ms
rank =  0, Distributing orbital back into band + domain format took 16.217 ms
rank = 0, Subspace_Rotation used 22.731 ms

Total time for subspace rotation: 22.735 ms
rank = 0, Efermi =  -0.023834806775 calculate fermi energy took 0.043 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.282224, lowerbound = -1.107562, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1345.080 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.230 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.584 ms
rank =  0, finding HY took 23.087 ms
rank =  0, distributing HY into block cyclic form took 15.297 ms
rank =  0, finding Y'*HY took 3.438 ms
Rank 0, Project_Hamiltonian used 59.444 ms
Total time for projection: 59.455 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -1.032066485484661
    last  calculated eigval = 0.094536463230914
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.79106904048747
lambda[   4] =  -0.62079170961368
lambda[   5] =  -0.57100868450349
lambda[   6] =  -0.52233477413367
lambda[   7] =  -0.50375586951132
lambda[   8] =  -0.47244315263208
lambda[   9] =  -0.45048173611706
lambda[  10] =  -0.40670337432289
lambda[  11] =  -0.31735907508149
lambda[  12] =  -0.30249191099070
lambda[  13] =  -0.06113405117393
lambda[  14] =  -0.00912870689755
lambda[  15] =   0.03869607405579
lambda[  16] =   0.05233867392840
lambda[  17] =   0.06457794180593
lambda[  18] =   0.07668376366968
lambda[  19] =   0.09453646323091
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.219 ms
rank =  0, subspace rotation using ScaLAPACK took 6.870 ms
rank =  0, Distributing orbital back into band + domain format took 15.143 ms
rank = 0, Subspace_Rotation used 22.021 ms

Total time for subspace rotation: 22.025 ms
rank = 0, Efermi =  -0.089739787840 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 3.955 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.814 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.612 ms
rank = 0, Calculating density took 5848.785 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.919 ms
rank = 0, D2D took 2.034 ms
rank = 0, Transfering density took 2.039 ms
Etot    =   -42.079561741526
Eband   =   -13.809868055556
E1      =    27.466681856119
E2      =   -11.246719744787
E3      =   -14.393536996476
Exc     =   -12.821578603374
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 4.676e+00, dEband = 1.534e+00
rank = 0, Calculating/Estimating energy took 0.798 ms, Etot = -42.079561742, dEtot = 4.676e+00, dEband = 1.534e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 57.0170115529784, which took 0.623 ms

iter_count = 96, r_2norm = 1.612e-03, tol*||rhs|| = 2.281e-03

Anderson update took 43.953 ms, out of which F'*F took 21.434 ms; b-Ax took 141.991 ms, out of which Lap took 129.679 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 279.241 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709927, int_b + int_rho = 8.004e-14, checking this took 0.105 ms
2-norm of RHS = 723.7983980780399, which took 0.078 ms

iter_count = 288, r_2norm = 5.550e-04, tol*||rhs|| = 7.238e-04

Anderson update took 127.435 ms, out of which F'*F took 64.807 ms; b-Ax took 432.477 ms, out of which Lap took 392.561 ms
Solving Poisson took 833.901 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.394 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.192162 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 27.386 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.258 ms
Total time for convolution: 	 convolve: 5.164271 
Total time for convolution: 	 convolve: 5.169703 
Total time for convolution: 	 convolve: 5.163766 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.251 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.154 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.179 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.595 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.214 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.842 ms

This SCF took 31641.817 ms, scf error = 1.622e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.194536, lowerbound = -1.032066, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1344.204 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.397 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.293 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.699 ms
rank =  0, finding HY took 22.390 ms
rank =  0, distributing HY into block cyclic form took 18.915 ms
rank =  0, finding Y'*HY took 3.502 ms
Rank 0, Project_Hamiltonian used 62.529 ms
Total time for projection: 62.539 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.113 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -1.006119637176240
    last  calculated eigval = 0.047822838891461
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.75410157334340
lambda[   4] =  -0.59206627388142
lambda[   5] =  -0.54037662647233
lambda[   6] =  -0.49088857282475
lambda[   7] =  -0.47209869559548
lambda[   8] =  -0.43776439967288
lambda[   9] =  -0.41875425443297
lambda[  10] =  -0.38327557290434
lambda[  11] =  -0.28396920165530
lambda[  12] =  -0.26887725144011
lambda[  13] =  -0.05903979247255
lambda[  14] =  -0.03308190737427
lambda[  15] =   0.01693389108730
lambda[  16] =   0.01892619738192
lambda[  17] =   0.03570798595026
lambda[  18] =   0.04290990973238
lambda[  19] =   0.04782283889146
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.221 ms
rank =  0, subspace rotation using ScaLAPACK took 6.787 ms
rank =  0, Distributing orbital back into band + domain format took 14.889 ms
rank = 0, Subspace_Rotation used 21.684 ms

Total time for subspace rotation: 21.688 ms
rank = 0, Efermi =  -0.087645529140 calculate fermi energy took 0.042 ms
rank = 0, --- Calculate rho: sum over local bands took 3.975 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.868 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.613 ms
rank = 0, Calculating density took 1443.223 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.863 ms
rank = 0, D2D took 1.997 ms
rank = 0, Transfering density took 1.999 ms
Etot    =   -42.010414222767
Eband   =   -13.058466707994
E1      =    26.830881326361
E2      =   -11.160177576138
E3      =   -14.593437145888
Exc     =   -12.981389883183
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 7.683e-03, dEband = 8.349e-02
rank = 0, Calculating/Estimating energy took 0.779 ms, Etot = -42.010414223, dEtot = 7.683e-03, dEband = 8.349e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 24.1268859731472, which took 0.148 ms

iter_count = 102, r_2norm = 6.786e-04, tol*||rhs|| = 9.651e-04

Anderson update took 43.625 ms, out of which F'*F took 22.785 ms; b-Ax took 149.844 ms, out of which Lap took 136.843 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 294.027 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709923, int_b + int_rho = 3.638e-14, checking this took 0.095 ms
2-norm of RHS = 719.6142521518349, which took 0.100 ms

iter_count = 294, r_2norm = 6.033e-04, tol*||rhs|| = 7.196e-04

Anderson update took 122.672 ms, out of which F'*F took 64.667 ms; b-Ax took 436.776 ms, out of which Lap took 397.377 ms
Solving Poisson took 831.832 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.214579 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.302 ms
Total time for convolution: 	 convolve: 5.195011 
Total time for convolution: 	 convolve: 5.161659 
Total time for convolution: 	 convolve: 5.160426 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.157 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.595 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.689 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.332 ms

This SCF took 27277.692 ms, scf error = 1.036e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.147823, lowerbound = -1.006120, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1341.537 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 15.635 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.977 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.623 ms
rank =  0, finding HY took 23.012 ms
rank =  0, distributing HY into block cyclic form took 15.912 ms
rank =  0, finding Y'*HY took 3.597 ms
Rank 0, Project_Hamiltonian used 61.169 ms
Total time for projection: 61.180 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.204 ms
    first calculated eigval = -0.974536467188332
    last  calculated eigval = 0.038064335306432
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.70494671698097
lambda[   4] =  -0.55561389117407
lambda[   5] =  -0.50489265265215
lambda[   6] =  -0.45008317363054
lambda[   7] =  -0.43136540471645
lambda[   8] =  -0.39124867328695
lambda[   9] =  -0.38160668554449
lambda[  10] =  -0.35270743598664
lambda[  11] =  -0.25014185509062
lambda[  12] =  -0.23218118504972
lambda[  13] =  -0.04052638189816
lambda[  14] =  -0.03664336121546
lambda[  15] =   0.00802544203808
lambda[  16] =   0.00987579752131
lambda[  17] =   0.02507062817164
lambda[  18] =   0.02941020553861
lambda[  19] =   0.03806433530643
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.214 ms
rank =  0, subspace rotation using ScaLAPACK took 6.864 ms
rank =  0, Distributing orbital back into band + domain format took 14.963 ms
rank = 0, Subspace_Rotation used 21.836 ms

Total time for subspace rotation: 21.840 ms
rank = 0, Efermi =  -0.069142097040 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 3.966 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.799 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 1439.298 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.938 ms
rank = 0, D2D took 2.059 ms
rank = 0, Transfering density took 2.061 ms
Etot    =   -41.973336721906
Eband   =   -12.145748582595
E1      =    26.077897143348
E2      =   -10.983872626077
E3      =   -14.860110467362
Exc     =   -13.194414696117
Esc     =   -68.555053678884
Entropy =    -0.000000001096
dE = 4.120e-03, dEband = 1.014e-01
rank = 0, Calculating/Estimating energy took 0.832 ms, Etot = -41.973336722, dEtot = 4.120e-03, dEband = 1.014e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 5.3423984845137, which took 0.532 ms

iter_count = 108, r_2norm = 1.498e-04, tol*||rhs|| = 2.137e-04

Anderson update took 46.324 ms, out of which F'*F took 24.145 ms; b-Ax took 158.507 ms, out of which Lap took 145.400 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.816 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709927, int_b + int_rho = 7.640e-14, checking this took 0.834 ms
2-norm of RHS = 719.5005424119298, which took 0.082 ms

iter_count = 282, r_2norm = 6.575e-04, tol*||rhs|| = 7.195e-04

Anderson update took 117.866 ms, out of which F'*F took 63.628 ms; b-Ax took 419.004 ms, out of which Lap took 382.137 ms
Solving Poisson took 793.267 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Total time for convolution: 	 convolve: 5.169203 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.574 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.161979 
Total time for convolution: 	 convolve: 5.157613 
Total time for convolution: 	 convolve: 5.167530 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.021 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.231 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.225 ms
---Transfer Veff_loc: D2D took 3.589 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.208 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.826 ms

This SCF took 27208.017 ms, scf error = 4.733e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.138064, lowerbound = -0.974536, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1345.320 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.656 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.012 ms
rank =  0, finding HY took 22.424 ms
rank =  0, distributing HY into block cyclic form took 15.422 ms
rank =  0, finding Y'*HY took 3.459 ms
Rank 0, Project_Hamiltonian used 59.342 ms
Total time for projection: 59.354 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.203 ms
    first calculated eigval = -0.958797779122827
    last  calculated eigval = 0.034362494678786
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67966948014269
lambda[   4] =  -0.53980815490528
lambda[   5] =  -0.49303688776009
lambda[   6] =  -0.42886243940986
lambda[   7] =  -0.40988821230856
lambda[   8] =  -0.36728982851997
lambda[   9] =  -0.36374126279594
lambda[  10] =  -0.33622697648155
lambda[  11] =  -0.24397456375075
lambda[  12] =  -0.21928313412912
lambda[  13] =  -0.03803153226570
lambda[  14] =  -0.02613112145232
lambda[  15] =   0.00476238368547
lambda[  16] =   0.00752626695684
lambda[  17] =   0.02250641105710
lambda[  18] =   0.02346779580122
lambda[  19] =   0.03436249467879
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.216 ms
rank =  0, subspace rotation using ScaLAPACK took 6.817 ms
rank =  0, Distributing orbital back into band + domain format took 14.864 ms
rank = 0, Subspace_Rotation used 21.691 ms

Total time for subspace rotation: 21.695 ms
rank = 0, Efermi =  -0.066637269118 calculate fermi energy took 0.039 ms
rank = 0, --- Calculate rho: sum over local bands took 4.076 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.991 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.055 ms
rank = 0, Calculating density took 1441.861 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 2.030 ms
rank = 0, D2D took 2.146 ms
rank = 0, Transfering density took 2.149 ms
Etot    =   -41.965600336444
Eband   =   -11.746198980540
E1      =    25.800897797382
E2      =   -10.840962540431
E3      =   -14.988215748222
Exc     =   -13.294423761961
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 8.596e-04, dEband = 4.439e-02
rank = 0, Calculating/Estimating energy took 0.801 ms, Etot = -41.965600336, dEtot = 8.596e-04, dEband = 4.439e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.7113956867669, which took 0.050 ms

iter_count = 108, r_2norm = 7.571e-05, tol*||rhs|| = 1.085e-04

Anderson update took 45.162 ms, out of which F'*F took 24.389 ms; b-Ax took 161.417 ms, out of which Lap took 147.261 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.260 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709922, int_b + int_rho = 2.910e-14, checking this took 0.084 ms
2-norm of RHS = 719.6943578466916, which took 0.098 ms

iter_count = 258, r_2norm = 5.949e-04, tol*||rhs|| = 7.197e-04

Anderson update took 109.324 ms, out of which F'*F took 57.879 ms; b-Ax took 378.502 ms, out of which Lap took 347.217 ms
Solving Poisson took 724.932 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.116 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.245 ms
Total time for convolution: 	 convolve: 5.165440 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 22.367 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.163100 
Total time for convolution: 	 convolve: 5.169241 
Total time for convolution: 	 convolve: 5.160893 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.187 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.239 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.612 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.870 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.515 ms

This SCF took 28237.412 ms, scf error = 1.243e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.134362, lowerbound = -0.958798, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1341.699 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.954 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.305 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.269 ms
rank =  0, finding HY took 22.686 ms
rank =  0, distributing HY into block cyclic form took 15.263 ms
rank =  0, finding Y'*HY took 3.747 ms
Rank 0, Project_Hamiltonian used 59.988 ms
Total time for projection: 60.001 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.112 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.075 ms
rank = 0, Solve_Generalized_EigenProblem used 0.190 ms
    first calculated eigval = -0.952831374682180
    last  calculated eigval = 0.031840365182492
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67430064673335
lambda[   4] =  -0.53580870982436
lambda[   5] =  -0.48920250790297
lambda[   6] =  -0.42310809937498
lambda[   7] =  -0.40491158199333
lambda[   8] =  -0.36154604012102
lambda[   9] =  -0.35694077516407
lambda[  10] =  -0.33096882796290
lambda[  11] =  -0.23953924533218
lambda[  12] =  -0.21255977854088
lambda[  13] =  -0.03833096146918
lambda[  14] =  -0.02266280950105
lambda[  15] =   0.00395944495408
lambda[  16] =   0.00657709717488
lambda[  17] =   0.02071618536820
lambda[  18] =   0.02222496982846
lambda[  19] =   0.03184036518249
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.203 ms
rank =  0, subspace rotation using ScaLAPACK took 6.794 ms
rank =  0, Distributing orbital back into band + domain format took 14.930 ms
rank = 0, Subspace_Rotation used 21.733 ms

Total time for subspace rotation: 21.738 ms
rank = 0, Efermi =  -0.066936698156 calculate fermi energy took 0.727 ms
rank = 0, --- Calculate rho: sum over local bands took 4.090 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.749 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.570 ms
rank = 0, Calculating density took 1438.831 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.908 ms
rank = 0, D2D took 2.024 ms
rank = 0, Transfering density took 2.043 ms
Etot    =   -41.964530591612
Eband   =   -11.620372737164
E1      =    25.729232060003
E2      =   -10.778456845939
E3      =   -15.025047742574
Exc     =   -13.321840822987
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 1.189e-04, dEband = 1.398e-02
rank = 0, Calculating/Estimating energy took 1.238 ms, Etot = -41.964530592, dEtot = 1.189e-04, dEband = 1.398e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4173244746060, which took 0.146 ms

iter_count = 108, r_2norm = 4.485e-05, tol*||rhs|| = 5.669e-05

Anderson update took 44.831 ms, out of which F'*F took 24.285 ms; b-Ax took 161.463 ms, out of which Lap took 146.624 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.242 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709928, int_b + int_rho = 8.731e-14, checking this took 0.085 ms
2-norm of RHS = 720.1403963988714, which took 0.103 ms

iter_count = 240, r_2norm = 6.613e-04, tol*||rhs|| = 7.201e-04

Anderson update took 99.571 ms, out of which F'*F took 54.051 ms; b-Ax took 355.786 ms, out of which Lap took 324.591 ms
Solving Poisson took 675.231 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.231 ms
Total time for convolution: 	 convolve: 5.168302 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 46.730 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.278 ms
Total time for convolution: 	 convolve: 5.160898 
Total time for convolution: 	 convolve: 5.165705 
Total time for convolution: 	 convolve: 5.165854 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.151 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.073 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.165 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.586 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.150 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.768 ms

This SCF took 27112.455 ms, scf error = 6.632e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.131840, lowerbound = -0.952831, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1342.457 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.670 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.362 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.042 ms
rank =  0, finding HY took 22.397 ms
rank =  0, distributing HY into block cyclic form took 15.559 ms
rank =  0, finding Y'*HY took 3.457 ms
Rank 0, Project_Hamiltonian used 59.476 ms
Total time for projection: 59.489 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.951852134800323
    last  calculated eigval = 0.030825315281461
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.67315244352753
lambda[   4] =  -0.53506366813539
lambda[   5] =  -0.48854458258859
lambda[   6] =  -0.42188015046967
lambda[   7] =  -0.40362875107981
lambda[   8] =  -0.36035949450394
lambda[   9] =  -0.35569359154916
lambda[  10] =  -0.32976081871103
lambda[  11] =  -0.23870542857248
lambda[  12] =  -0.21153394742804
lambda[  13] =  -0.03842624011523
lambda[  14] =  -0.02157729184060
lambda[  15] =   0.00393960422028
lambda[  16] =   0.00616238732284
lambda[  17] =   0.02011651389987
lambda[  18] =   0.02208269677766
lambda[  19] =   0.03082531528146
==subpsace eigenproblem: bcast eigvals took 0.037 ms
Total time for solving subspace eigenvalue problem: 0.274 ms
rank =  0, subspace rotation using ScaLAPACK took 6.788 ms
rank =  0, Distributing orbital back into band + domain format took 14.796 ms
rank = 0, Subspace_Rotation used 21.593 ms

Total time for subspace rotation: 21.598 ms
rank = 0, Efermi =  -0.067031976787 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.044 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.871 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.552 ms
rank = 0, Calculating density took 1438.403 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.986 ms
rank = 0, D2D took 2.111 ms
rank = 0, Transfering density took 2.113 ms
Etot    =   -41.964300693548
Eband   =   -11.595847566037
E1      =    25.733094467480
E2      =   -10.749017873827
E3      =   -15.025262571240
Exc     =   -13.320774360080
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 2.554e-05, dEband = 2.725e-03
rank = 0, Calculating/Estimating energy took 0.800 ms, Etot = -41.964300694, dEtot = 2.554e-05, dEband = 2.725e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5810908455336, which took 0.113 ms

iter_count = 114, r_2norm = 1.438e-05, tol*||rhs|| = 2.324e-05

Anderson update took 47.757 ms, out of which F'*F took 25.718 ms; b-Ax took 169.894 ms, out of which Lap took 154.883 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.940 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709928, int_b + int_rho = 8.731e-14, checking this took 0.085 ms
2-norm of RHS = 720.3212652580099, which took 0.091 ms

iter_count = 240, r_2norm = 6.391e-04, tol*||rhs|| = 7.203e-04

Anderson update took 100.695 ms, out of which F'*F took 54.101 ms; b-Ax took 356.036 ms, out of which Lap took 325.162 ms
Solving Poisson took 676.574 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.127 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.166502 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 34.824 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
Total time for convolution: 	 convolve: 5.161359 
Total time for convolution: 	 convolve: 5.165862 
Total time for convolution: 	 convolve: 5.165429 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.271 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.573 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.133 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.739 ms

This SCF took 27118.386 ms, scf error = 3.734e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.130825, lowerbound = -0.951852, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1342.235 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 15.748 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.325 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.083 ms
rank =  0, finding HY took 22.475 ms
rank =  0, distributing HY into block cyclic form took 15.548 ms
rank =  0, finding Y'*HY took 3.483 ms
Rank 0, Project_Hamiltonian used 59.610 ms
Total time for projection: 59.622 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.116 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.116 ms
rank = 0, Solve_Generalized_EigenProblem used 0.235 ms
    first calculated eigval = -0.949101898484090
    last  calculated eigval = 0.031111807566204
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66965606502929
lambda[   4] =  -0.53269540634912
lambda[   5] =  -0.48639342548715
lambda[   6] =  -0.41868694019742
lambda[   7] =  -0.40061375405793
lambda[   8] =  -0.35710389665821
lambda[   9] =  -0.35237612433525
lambda[  10] =  -0.32685396829365
lambda[  11] =  -0.23627538739614
lambda[  12] =  -0.20850094879730
lambda[  13] =  -0.03808704207111
lambda[  14] =  -0.01950803394129
lambda[  15] =   0.00466178714674
lambda[  16] =   0.00616853262575
lambda[  17] =   0.02060125046664
lambda[  18] =   0.02281588521004
lambda[  19] =   0.03111180756620
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 6.800 ms
rank =  0, Distributing orbital back into band + domain format took 15.881 ms
rank = 0, Subspace_Rotation used 22.711 ms

Total time for subspace rotation: 22.716 ms
rank = 0, Efermi =  -0.066692778748 calculate fermi energy took 0.037 ms
rank = 0, --- Calculate rho: sum over local bands took 4.059 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.755 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.594 ms
rank = 0, Calculating density took 1439.377 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.995 ms
rank = 0, D2D took 2.120 ms
rank = 0, Transfering density took 2.122 ms
Etot    =   -41.964054058858
Eband   =   -11.527271325664
E1      =    25.699235083628
E2      =   -10.711004081006
E3      =   -15.037611371007
Exc     =   -13.329579588858
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 2.740e-05, dEband = 7.620e-03
rank = 0, Calculating/Estimating energy took 0.817 ms, Etot = -41.964054059, dEtot = 2.740e-05, dEband = 7.620e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.3058152727460, which took 0.104 ms

iter_count = 114, r_2norm = 8.161e-06, tol*||rhs|| = 1.223e-05

Anderson update took 47.585 ms, out of which F'*F took 25.647 ms; b-Ax took 168.861 ms, out of which Lap took 153.816 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.776 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709929, int_b + int_rho = 1.055e-13, checking this took 0.086 ms
2-norm of RHS = 720.4274689564836, which took 0.080 ms

iter_count = 240, r_2norm = 5.826e-04, tol*||rhs|| = 7.204e-04

Anderson update took 100.656 ms, out of which F'*F took 53.786 ms; b-Ax took 354.329 ms, out of which Lap took 323.972 ms
Solving Poisson took 676.807 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Total time for convolution: 	 convolve: 5.166002 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 23.641 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.292 ms
Total time for convolution: 	 convolve: 5.160926 
Total time for convolution: 	 convolve: 5.165483 
Total time for convolution: 	 convolve: 5.167278 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.276 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.156 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.547 ms
---Transfer Veff_loc: D2D took 3.572 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.147 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.756 ms

This SCF took 27112.317 ms, scf error = 2.187e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.131112, lowerbound = -0.949102, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1339.266 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 16.175 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.298 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.483 ms
rank =  0, finding HY took 22.345 ms
rank =  0, distributing HY into block cyclic form took 15.468 ms
rank =  0, finding Y'*HY took 3.464 ms
Rank 0, Project_Hamiltonian used 59.781 ms
Total time for projection: 59.793 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.107 ms
rank = 0, Solve_Generalized_EigenProblem used 0.218 ms
    first calculated eigval = -0.946018284673101
    last  calculated eigval = 0.032661380083653
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66620674086424
lambda[   4] =  -0.53053267969409
lambda[   5] =  -0.48471983317211
lambda[   6] =  -0.41543718032401
lambda[   7] =  -0.39754369740794
lambda[   8] =  -0.35387973924064
lambda[   9] =  -0.34906150189843
lambda[  10] =  -0.32394524033660
lambda[  11] =  -0.23416616688117
lambda[  12] =  -0.20538553227723
lambda[  13] =  -0.03715526402424
lambda[  14] =  -0.01704146969755
lambda[  15] =   0.00634396843979
lambda[  16] =   0.00680167858915
lambda[  17] =   0.02216208018518
lambda[  18] =   0.02469503680533
lambda[  19] =   0.03266138008365
==subpsace eigenproblem: bcast eigvals took 0.070 ms
Total time for solving subspace eigenvalue problem: 0.295 ms
rank =  0, subspace rotation using ScaLAPACK took 6.772 ms
rank =  0, Distributing orbital back into band + domain format took 14.864 ms
rank = 0, Subspace_Rotation used 21.645 ms

Total time for subspace rotation: 21.649 ms
rank = 0, Efermi =  -0.065761000726 calculate fermi energy took 0.040 ms
rank = 0, --- Calculate rho: sum over local bands took 4.079 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.750 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.567 ms
rank = 0, Calculating density took 1435.577 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.906 ms
rank = 0, D2D took 2.036 ms
rank = 0, Transfering density took 2.038 ms
Etot    =   -41.963989724189
Eband   =   -11.460614332208
E1      =    25.666587015230
E2      =   -10.674761530415
E3      =   -15.045538995631
Exc     =   -13.335209253278
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 7.148e-06, dEband = 7.406e-03
rank = 0, Calculating/Estimating energy took 0.826 ms, Etot = -41.963989724, dEtot = 7.148e-06, dEband = 7.406e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1882479845427, which took 0.134 ms

iter_count = 114, r_2norm = 4.784e-06, tol*||rhs|| = 7.530e-06

Anderson update took 47.741 ms, out of which F'*F took 25.649 ms; b-Ax took 170.436 ms, out of which Lap took 155.051 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.407 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709919, int_b + int_rho = 3.638e-15, checking this took 0.098 ms
2-norm of RHS = 720.4068402970403, which took 0.101 ms

iter_count = 222, r_2norm = 7.041e-04, tol*||rhs|| = 7.204e-04

Anderson update took 92.584 ms, out of which F'*F took 49.656 ms; b-Ax took 330.254 ms, out of which Lap took 300.881 ms
Solving Poisson took 625.229 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Total time for convolution: 	 convolve: 5.161596 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 26.731 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.280 ms
Total time for convolution: 	 convolve: 5.159373 
Total time for convolution: 	 convolve: 5.164115 
Total time for convolution: 	 convolve: 5.167917 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.305 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.274 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.104 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.161 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.047 ms
---Transfer Veff_loc: D2D took 3.589 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.140 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.761 ms

This SCF took 27052.798 ms, scf error = 1.231e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.132661, lowerbound = -0.946018, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1345.341 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.478 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.321 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.808 ms
rank =  0, finding HY took 22.425 ms
rank =  0, distributing HY into block cyclic form took 15.478 ms
rank =  0, finding Y'*HY took 3.496 ms
Rank 0, Project_Hamiltonian used 59.227 ms
Total time for projection: 59.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.118 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.108 ms
rank = 0, Solve_Generalized_EigenProblem used 0.229 ms
    first calculated eigval = -0.943859774396506
    last  calculated eigval = 0.033969578528516
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66424963015191
lambda[   4] =  -0.52896050294714
lambda[   5] =  -0.48340318237900
lambda[   6] =  -0.41339848279157
lambda[   7] =  -0.39558818952929
lambda[   8] =  -0.35186643979169
lambda[   9] =  -0.34692920225288
lambda[  10] =  -0.32202016059962
lambda[  11] =  -0.23262148508962
lambda[  12] =  -0.20331454928535
lambda[  13] =  -0.03522659166196
lambda[  14] =  -0.01505762206317
lambda[  15] =   0.00850398680612
lambda[  16] =   0.00924785822933
lambda[  17] =   0.02419694419559
lambda[  18] =   0.02765172481492
lambda[  19] =   0.03396957852852
==subpsace eigenproblem: bcast eigvals took 0.016 ms
Total time for solving subspace eigenvalue problem: 0.269 ms
rank =  0, subspace rotation using ScaLAPACK took 6.780 ms
rank =  0, Distributing orbital back into band + domain format took 14.875 ms
rank = 0, Subspace_Rotation used 21.664 ms

Total time for subspace rotation: 21.669 ms
rank = 0, Efermi =  -0.063832328331 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.081 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.791 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.572 ms
rank = 0, Calculating density took 1441.101 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.915 ms
rank = 0, D2D took 2.042 ms
rank = 0, Transfering density took 2.043 ms
Etot    =   -41.964018115227
Eband   =   -11.416260963766
E1      =    25.643910988312
E2      =   -10.652048031988
E3      =   -15.049742445094
Exc     =   -13.338404936878
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 3.155e-06, dEband = 4.928e-03
rank = 0, Calculating/Estimating energy took 0.823 ms, Etot = -41.964018115, dEtot = 3.155e-06, dEband = 4.928e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.1349444372240, which took 0.345 ms

iter_count = 108, r_2norm = 5.279e-06, tol*||rhs|| = 5.398e-06

Anderson update took 45.507 ms, out of which F'*F took 24.295 ms; b-Ax took 159.508 ms, out of which Lap took 145.927 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.885 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709922, int_b + int_rho = 2.910e-14, checking this took 0.090 ms
2-norm of RHS = 720.3938173471633, which took 0.081 ms

iter_count = 204, r_2norm = 6.766e-04, tol*||rhs|| = 7.204e-04

Anderson update took 86.939 ms, out of which F'*F took 45.841 ms; b-Ax took 299.787 ms, out of which Lap took 274.412 ms
Solving Poisson took 574.005 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.163505 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.132 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
Total time for convolution: 	 convolve: 5.168088 
Total time for convolution: 	 convolve: 5.161154 
Total time for convolution: 	 convolve: 5.167873 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.545 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 1.048 ms
---Transfer Veff_loc: D2D took 3.621 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.159 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.813 ms

This SCF took 26994.621 ms, scf error = 7.649e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.133970, lowerbound = -0.943860, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1341.628 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.490 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.811 ms
rank =  0, finding HY took 22.395 ms
rank =  0, distributing HY into block cyclic form took 15.543 ms
rank =  0, finding Y'*HY took 4.287 ms
Rank 0, Project_Hamiltonian used 60.078 ms
Total time for projection: 60.088 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.943291920900501
    last  calculated eigval = 0.033866815233012
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66355733496003
lambda[   4] =  -0.52839012005970
lambda[   5] =  -0.48283127027439
lambda[   6] =  -0.41277358235689
lambda[   7] =  -0.39491990959117
lambda[   8] =  -0.35121824066348
lambda[   9] =  -0.34629973720248
lambda[  10] =  -0.32137176457793
lambda[  11] =  -0.23197871980745
lambda[  12] =  -0.20270128465326
lambda[  13] =  -0.03337135189464
lambda[  14] =  -0.01428991008159
lambda[  15] =   0.01091219551316
lambda[  16] =   0.01147323450768
lambda[  17] =   0.02591019504304
lambda[  18] =   0.02963653012825
lambda[  19] =   0.03386681523301
==subpsace eigenproblem: bcast eigvals took 0.061 ms
Total time for solving subspace eigenvalue problem: 0.307 ms
rank =  0, subspace rotation using ScaLAPACK took 6.759 ms
rank =  0, Distributing orbital back into band + domain format took 14.913 ms
rank = 0, Subspace_Rotation used 21.681 ms

Total time for subspace rotation: 21.686 ms
rank = 0, Efermi =  -0.061977088577 calculate fermi energy took 0.104 ms
rank = 0, --- Calculate rho: sum over local bands took 4.095 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.701 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.565 ms
rank = 0, Calculating density took 1438.228 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.974 ms
rank = 0, D2D took 2.112 ms
rank = 0, Transfering density took 2.115 ms
Etot    =   -41.964076032148
Eband   =   -11.401300506818
E1      =    25.636918874428
E2      =   -10.644154431889
E3      =   -15.049461280787
Exc     =   -13.338256432456
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 6.435e-06, dEband = 1.662e-03
rank = 0, Calculating/Estimating energy took 0.805 ms, Etot = -41.964076032, dEtot = 6.435e-06, dEband = 1.662e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0681270532596, which took 0.059 ms

iter_count = 114, r_2norm = 1.948e-06, tol*||rhs|| = 2.725e-06

Anderson update took 48.228 ms, out of which F'*F took 25.630 ms; b-Ax took 168.964 ms, out of which Lap took 155.243 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.979 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709928, int_b + int_rho = 9.459e-14, checking this took 0.104 ms
2-norm of RHS = 720.4017197643124, which took 0.079 ms

iter_count = 198, r_2norm = 6.680e-04, tol*||rhs|| = 7.204e-04

Anderson update took 83.184 ms, out of which F'*F took 44.600 ms; b-Ax took 294.234 ms, out of which Lap took 269.212 ms
Solving Poisson took 558.760 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.172262 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 28.190 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.270 ms
Total time for convolution: 	 convolve: 5.165935 
Total time for convolution: 	 convolve: 5.184942 
Total time for convolution: 	 convolve: 5.177003 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.009 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.718 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.552 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.084 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.222 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.190 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
---Transfer Veff_loc: D2D took 3.580 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.125 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.737 ms

This SCF took 27054.012 ms, scf error = 5.314e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.133867, lowerbound = -0.943292, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1342.714 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.761 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.314 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.086 ms
rank =  0, finding HY took 22.482 ms
rank =  0, distributing HY into block cyclic form took 15.623 ms
rank =  0, finding Y'*HY took 3.506 ms
Rank 0, Project_Hamiltonian used 59.722 ms
Total time for projection: 59.734 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.120 ms
rank = 0, Solve_Generalized_EigenProblem used 0.233 ms
    first calculated eigval = -0.942523902117956
    last  calculated eigval = 0.033877273424504
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66266666856989
lambda[   4] =  -0.52772781688392
lambda[   5] =  -0.48219333971717
lambda[   6] =  -0.41194408608772
lambda[   7] =  -0.39407091708296
lambda[   8] =  -0.35036560875312
lambda[   9] =  -0.34543712513269
lambda[  10] =  -0.32055795342007
lambda[  11] =  -0.23132626553814
lambda[  12] =  -0.20190319543069
lambda[  13] =  -0.03094575130838
lambda[  14] =  -0.01336823835906
lambda[  15] =   0.01342033786945
lambda[  16] =   0.01482388293121
lambda[  17] =   0.02799837836337
lambda[  18] =   0.03145688782246
lambda[  19] =   0.03387727342450
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.260 ms
rank =  0, subspace rotation using ScaLAPACK took 6.835 ms
rank =  0, Distributing orbital back into band + domain format took 15.215 ms
rank = 0, Subspace_Rotation used 22.060 ms

Total time for subspace rotation: 22.064 ms
rank = 0, Efermi =  -0.059551487996 calculate fermi energy took 0.046 ms
rank = 0, --- Calculate rho: sum over local bands took 4.094 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.816 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.586 ms
rank = 0, Calculating density took 1439.472 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.988 ms
rank = 0, D2D took 2.134 ms
rank = 0, Transfering density took 2.137 ms
Etot    =   -41.964158217013
Eband   =   -11.382809259973
E1      =    25.627895088259
E2      =   -10.634298497421
E3      =   -15.051000285985
Exc     =   -13.339489148727
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 9.132e-06, dEband = 2.055e-03
rank = 0, Calculating/Estimating energy took 0.803 ms, Etot = -41.964158217, dEtot = 9.132e-06, dEband = 2.055e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0560884018788, which took 0.125 ms

iter_count = 114, r_2norm = 1.773e-06, tol*||rhs|| = 2.244e-06

Anderson update took 48.528 ms, out of which F'*F took 25.677 ms; b-Ax took 168.793 ms, out of which Lap took 154.428 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.605 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709925, int_b + int_rho = 5.821e-14, checking this took 0.085 ms
2-norm of RHS = 720.4030223046650, which took 0.080 ms

iter_count = 150, r_2norm = 6.564e-04, tol*||rhs|| = 7.204e-04

Anderson update took 63.530 ms, out of which F'*F took 33.542 ms; b-Ax took 222.216 ms, out of which Lap took 202.499 ms
Solving Poisson took 426.608 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.930 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.173874 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.568 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.295 ms
Total time for convolution: 	 convolve: 5.176750 
Total time for convolution: 	 convolve: 5.175549 
Total time for convolution: 	 convolve: 5.197575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.805 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.566 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.094 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.226 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.230 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.059 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.228 ms
---Transfer Veff_loc: D2D took 3.912 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.241 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.216 ms

This SCF took 26970.858 ms, scf error = 3.165e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.133877, lowerbound = -0.942524, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1571.696 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 20.623 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.792 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 23.431 ms
rank =  0, finding HY took 25.855 ms
rank =  0, distributing HY into block cyclic form took 19.935 ms
rank =  0, finding Y'*HY took 3.937 ms
Rank 0, Project_Hamiltonian used 73.186 ms
Total time for projection: 73.205 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.120 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.133 ms
rank = 0, Solve_Generalized_EigenProblem used 0.256 ms
    first calculated eigval = -0.942268115276537
    last  calculated eigval = 0.033629837962676
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66241937185783
lambda[   4] =  -0.52749769741490
lambda[   5] =  -0.48197298013422
lambda[   6] =  -0.41170294683186
lambda[   7] =  -0.39383130539856
lambda[   8] =  -0.35012767646871
lambda[   9] =  -0.34520328623160
lambda[  10] =  -0.32032160487513
lambda[  11] =  -0.23109542451871
lambda[  12] =  -0.20166234745081
lambda[  13] =  -0.03021208045585
lambda[  14] =  -0.01310315654326
lambda[  15] =   0.01394124677179
lambda[  16] =   0.01608777893744
lambda[  17] =   0.02846370434150
lambda[  18] =   0.03192585145377
lambda[  19] =   0.03362983796268
==subpsace eigenproblem: bcast eigvals took 0.050 ms
Total time for solving subspace eigenvalue problem: 0.314 ms
rank =  0, subspace rotation using ScaLAPACK took 8.885 ms
rank =  0, Distributing orbital back into band + domain format took 19.056 ms
rank = 0, Subspace_Rotation used 27.956 ms

Total time for subspace rotation: 27.962 ms
rank = 0, Efermi =  -0.058817817123 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 5.525 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.121 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.805 ms
rank = 0, Calculating density took 1691.743 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.209 ms
rank = 0, D2D took 2.340 ms
rank = 0, Transfering density took 2.343 ms
Etot    =   -41.964193452008
Eband   =   -11.377107183925
E1      =    25.624904252196
E2      =   -10.631463417604
E3      =   -15.051468483659
Exc     =   -13.339868741564
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 3.915e-06, dEband = 6.336e-04
rank = 0, Calculating/Estimating energy took 0.866 ms, Etot = -41.964193452, dEtot = 3.915e-06, dEband = 6.336e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0367419988121, which took 0.105 ms

iter_count = 108, r_2norm = 1.331e-06, tol*||rhs|| = 1.470e-06

Anderson update took 59.242 ms, out of which F'*F took 27.534 ms; b-Ax took 216.386 ms, out of which Lap took 198.903 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 415.788 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709922, int_b + int_rho = 3.274e-14, checking this took 0.116 ms
2-norm of RHS = 720.4214383012088, which took 0.809 ms

iter_count = 180, r_2norm = 6.241e-04, tol*||rhs|| = 7.204e-04

Anderson update took 105.849 ms, out of which F'*F took 47.607 ms; b-Ax took 312.063 ms, out of which Lap took 282.616 ms
Solving Poisson took 648.263 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.142 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.259 ms
Total time for convolution: 	 convolve: 5.244164 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 4.777 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Total time for convolution: 	 convolve: 5.208515 
Total time for convolution: 	 convolve: 5.183547 
Total time for convolution: 	 convolve: 5.210963 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.113 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.177 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.320 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.067 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.285 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.259 ms
---Transfer Veff_loc: D2D took 3.681 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.136 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.851 ms

This SCF took 27626.339 ms, scf error = 2.602e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.133630, lowerbound = -0.942268, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1339.047 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 16.529 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.428 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.970 ms
rank =  0, finding HY took 22.157 ms
rank =  0, distributing HY into block cyclic form took 15.483 ms
rank =  0, finding Y'*HY took 3.483 ms
Rank 0, Project_Hamiltonian used 60.110 ms
Total time for projection: 60.120 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.227 ms
    first calculated eigval = -0.941827763223489
    last  calculated eigval = 0.035087697770191
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66196985586708
lambda[   4] =  -0.52704210337355
lambda[   5] =  -0.48151364520780
lambda[   6] =  -0.41126585393582
lambda[   7] =  -0.39337640604653
lambda[   8] =  -0.34969487503911
lambda[   9] =  -0.34478848674298
lambda[  10] =  -0.31987661730058
lambda[  11] =  -0.23064553058594
lambda[  12] =  -0.20124862109709
lambda[  13] =  -0.02737711786758
lambda[  14] =  -0.01245998353012
lambda[  15] =   0.01581070315024
lambda[  16] =   0.02083074694807
lambda[  17] =   0.03062915495035
lambda[  18] =   0.03434044758112
lambda[  19] =   0.03508769777019
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.268 ms
rank =  0, subspace rotation using ScaLAPACK took 6.809 ms
rank =  0, Distributing orbital back into band + domain format took 14.842 ms
rank = 0, Subspace_Rotation used 21.668 ms

Total time for subspace rotation: 21.673 ms
rank = 0, Efermi =  -0.055982854533 calculate fermi energy took 0.045 ms
rank = 0, --- Calculate rho: sum over local bands took 4.094 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.808 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.557 ms
rank = 0, Calculating density took 1435.732 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.972 ms
rank = 0, D2D took 2.114 ms
rank = 0, Transfering density took 2.116 ms
Etot    =   -41.964259425332
Eband   =   -11.366462008730
E1      =    25.620087533836
E2      =   -10.625492941022
E3      =   -15.051905826777
Exc     =   -13.340230038259
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 7.330e-06, dEband = 1.183e-03
rank = 0, Calculating/Estimating energy took 0.808 ms, Etot = -41.964259425, dEtot = 7.330e-06, dEband = 1.183e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0304629737130, which took 0.048 ms

iter_count = 114, r_2norm = 7.721e-07, tol*||rhs|| = 1.219e-06

Anderson update took 48.128 ms, out of which F'*F took 25.625 ms; b-Ax took 168.911 ms, out of which Lap took 154.618 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 329.608 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709921, int_b + int_rho = 1.455e-14, checking this took 0.093 ms
2-norm of RHS = 720.4213936358252, which took 0.076 ms

iter_count = 126, r_2norm = 6.497e-04, tol*||rhs|| = 7.204e-04

Anderson update took 73.408 ms, out of which F'*F took 31.429 ms; b-Ax took 204.768 ms, out of which Lap took 186.180 ms
Solving Poisson took 422.661 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.276 ms
Total time for convolution: 	 convolve: 5.234198 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.217509 
Total time for convolution: 	 convolve: 5.245960 
Total time for convolution: 	 convolve: 5.212089 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.827 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.551 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.186 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.201 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
---Transfer Veff_loc: D2D took 3.565 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.144 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.742 ms

This SCF took 27153.114 ms, scf error = 1.858e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.135088, lowerbound = -0.941828, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1327.857 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.555 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.388 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.952 ms
rank =  0, finding HY took 22.397 ms
rank =  0, distributing HY into block cyclic form took 15.335 ms
rank =  0, finding Y'*HY took 3.470 ms
Rank 0, Project_Hamiltonian used 59.176 ms
Total time for projection: 59.187 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.109 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.230 ms
    first calculated eigval = -0.941713996011935
    last  calculated eigval = 0.035578022629236
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66186100841797
lambda[   4] =  -0.52693762019536
lambda[   5] =  -0.48141382744029
lambda[   6] =  -0.41115724539933
lambda[   7] =  -0.39327087955652
lambda[   8] =  -0.34958767011563
lambda[   9] =  -0.34468150539583
lambda[  10] =  -0.31977180671961
lambda[  11] =  -0.23054336502478
lambda[  12] =  -0.20114022195650
lambda[  13] =  -0.02683045783383
lambda[  14] =  -0.01233511543409
lambda[  15] =   0.01627432983639
lambda[  16] =   0.02129448314831
lambda[  17] =   0.03089612020639
lambda[  18] =   0.03494906268672
lambda[  19] =   0.03557802262924
==subpsace eigenproblem: bcast eigvals took 0.034 ms
Total time for solving subspace eigenvalue problem: 0.272 ms
rank =  0, subspace rotation using ScaLAPACK took 6.829 ms
rank =  0, Distributing orbital back into band + domain format took 15.053 ms
rank = 0, Subspace_Rotation used 21.890 ms

Total time for subspace rotation: 21.896 ms
rank = 0, Efermi =  -0.055436194518 calculate fermi energy took 0.049 ms
rank = 0, --- Calculate rho: sum over local bands took 4.025 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.001 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 1423.911 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.006 ms
rank = 0, D2D took 2.141 ms
rank = 0, Transfering density took 2.143 ms
Etot    =   -41.964271419579
Eband   =   -11.363910190633
E1      =    25.618712701308
E2      =   -10.624257720141
E3      =   -15.052139138481
Exc     =   -13.340417108897
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 1.333e-06, dEband = 2.835e-04
rank = 0, Calculating/Estimating energy took 0.901 ms, Etot = -41.964271420, dEtot = 1.333e-06, dEband = 2.835e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0282473554952, which took 0.055 ms

iter_count = 108, r_2norm = 1.032e-06, tol*||rhs|| = 1.130e-06

Anderson update took 45.711 ms, out of which F'*F took 24.348 ms; b-Ax took 159.813 ms, out of which Lap took 146.446 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.875 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709923, int_b + int_rho = 4.366e-14, checking this took 0.085 ms
2-norm of RHS = 720.4188899868632, which took 0.087 ms

iter_count = 138, r_2norm = 6.654e-04, tol*||rhs|| = 7.204e-04

Anderson update took 59.442 ms, out of which F'*F took 31.207 ms; b-Ax took 207.757 ms, out of which Lap took 189.095 ms
Solving Poisson took 400.037 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.275 ms
Total time for convolution: 	 convolve: 5.222047 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 33.630 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.181059 
Total time for convolution: 	 convolve: 5.206782 
Total time for convolution: 	 convolve: 5.187023 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.801 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.529 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.096 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.249 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
---Transfer Veff_loc: D2D took 3.568 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.133 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.734 ms

This SCF took 26969.345 ms, scf error = 1.506e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.135578, lowerbound = -0.941714, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1365.167 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.313 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.322 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.644 ms
rank =  0, finding HY took 22.498 ms
rank =  0, distributing HY into block cyclic form took 16.433 ms
rank =  0, finding Y'*HY took 3.870 ms
Rank 0, Project_Hamiltonian used 60.466 ms
Total time for projection: 60.479 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.108 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.226 ms
    first calculated eigval = -0.941554270888001
    last  calculated eigval = 0.035996627156440
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66171536787700
lambda[   4] =  -0.52678984721012
lambda[   5] =  -0.48126860064373
lambda[   6] =  -0.41100806714431
lambda[   7] =  -0.39312700091148
lambda[   8] =  -0.34943739620128
lambda[   9] =  -0.34452882727767
lambda[  10] =  -0.31962536535334
lambda[  11] =  -0.23039582833680
lambda[  12] =  -0.20098626171491
lambda[  13] =  -0.02688252203798
lambda[  14] =  -0.01227074592473
lambda[  15] =   0.01633135915229
lambda[  16] =   0.02020666534235
lambda[  17] =   0.03071334400439
lambda[  18] =   0.03518946792736
lambda[  19] =   0.03599662715644
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 6.795 ms
rank =  0, Distributing orbital back into band + domain format took 14.911 ms
rank = 0, Subspace_Rotation used 21.714 ms

Total time for subspace rotation: 21.719 ms
rank = 0, Efermi =  -0.055488258724 calculate fermi energy took 0.044 ms
rank = 0, --- Calculate rho: sum over local bands took 4.071 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.881 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 1462.243 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.988 ms
rank = 0, D2D took 2.120 ms
rank = 0, Transfering density took 2.126 ms
Etot    =   -41.964299349446
Eband   =   -11.360326031325
E1      =    25.616771892056
E2      =   -10.622538184005
E3      =   -15.052397241280
Exc     =   -13.340626955485
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 3.103e-06, dEband = 3.982e-04
rank = 0, Calculating/Estimating energy took 0.815 ms, Etot = -41.964299349, dEtot = 3.103e-06, dEband = 3.982e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0201932204322, which took 0.095 ms

iter_count = 108, r_2norm = 7.578e-07, tol*||rhs|| = 8.077e-07

Anderson update took 45.576 ms, out of which F'*F took 24.230 ms; b-Ax took 159.716 ms, out of which Lap took 146.237 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 311.092 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709916, int_b + int_rho = -2.910e-14, checking this took 0.089 ms
2-norm of RHS = 720.4169384071781, which took 0.077 ms

iter_count = 132, r_2norm = 7.149e-04, tol*||rhs|| = 7.204e-04

Anderson update took 56.157 ms, out of which F'*F took 29.501 ms; b-Ax took 195.685 ms, out of which Lap took 178.535 ms
Solving Poisson took 375.931 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.210428 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.408 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.243671 
Total time for convolution: 	 convolve: 5.208961 
Total time for convolution: 	 convolve: 5.236359 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.874 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.535 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.124 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.196 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.593 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.437 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.069 ms

This SCF took 27079.183 ms, scf error = 1.033e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.135997, lowerbound = -0.941554, upperbound = 267.579517

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1347.417 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 15.459 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.366 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 17.833 ms
rank =  0, finding HY took 22.455 ms
rank =  0, distributing HY into block cyclic form took 15.716 ms
rank =  0, finding Y'*HY took 3.795 ms
Rank 0, Project_Hamiltonian used 59.818 ms
Total time for projection: 59.830 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.110 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.115 ms
rank = 0, Solve_Generalized_EigenProblem used 0.228 ms
    first calculated eigval = -0.941503024975441
    last  calculated eigval = 0.036365382757913
The last 17 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 24):
lambda[   3] =  -0.66168071500867
lambda[   4] =  -0.52672968266552
lambda[   5] =  -0.48119904497719
lambda[   6] =  -0.41096993607791
lambda[   7] =  -0.39308632803702
lambda[   8] =  -0.34939811466316
lambda[   9] =  -0.34449263355491
lambda[  10] =  -0.31958085576387
lambda[  11] =  -0.23033592166234
lambda[  12] =  -0.20094548865877
lambda[  13] =  -0.02681887544332
lambda[  14] =  -0.01226475381178
lambda[  15] =   0.01592720576385
lambda[  16] =   0.02042309561907
lambda[  17] =   0.03053523879875
lambda[  18] =   0.03520882224390
lambda[  19] =   0.03636538275791
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.255 ms
rank =  0, subspace rotation using ScaLAPACK took 6.804 ms
rank =  0, Distributing orbital back into band + domain format took 14.841 ms
rank = 0, Subspace_Rotation used 21.666 ms

Total time for subspace rotation: 21.670 ms
rank = 0, Efermi =  -0.055424612111 calculate fermi energy took 0.041 ms
rank = 0, --- Calculate rho: sum over local bands took 4.026 ms
rank = 0, --- Calculate rho: reduce over all band groups took 9.638 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.967 ms
rank = 0, Calculating density took 1443.907 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.008 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 2.115 ms
rank = 0, D2D took 2.244 ms
rank = 0, Transfering density took 2.249 ms
Etot    =   -41.964313415285
Eband   =   -11.359162797330
E1      =    25.616178468152
E2      =   -10.621966791739
E3      =   -15.052363039720
Exc     =   -13.340605237588
Esc     =   -68.555053678884
Entropy =    -0.000000001094
dE = 1.563e-06, dEband = 1.292e-04
rank = 0, Calculating/Estimating energy took 0.821 ms, Etot = -41.964313415, dEtot = 1.563e-06, dEband = 1.292e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0151877774848, which took 0.134 ms

iter_count = 114, r_2norm = 4.023e-07, tol*||rhs|| = 6.075e-07

Anderson update took 48.189 ms, out of which F'*F took 25.856 ms; b-Ax took 170.442 ms, out of which Lap took 156.353 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 344.235 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -24.00000003709919, int_rho =  24.00000003709927, int_b + int_rho = 8.004e-14, checking this took 0.083 ms
2-norm of RHS = 720.4170733006868, which took 0.078 ms

iter_count = 114, r_2norm = 6.465e-04, tol*||rhs|| = 7.204e-04

Anderson update took 47.745 ms, out of which F'*F took 25.320 ms; b-Ax took 167.377 ms, out of which Lap took 152.531 ms
Solving Poisson took 322.995 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.265753 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.299 ms
Total time for convolution: 	 convolve: 5.211289 
Total time for convolution: 	 convolve: 5.243742 
Total time for convolution: 	 convolve: 5.247673 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.733 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.569 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.107 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.203 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
---Transfer Veff_loc: D2D took 3.577 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.406 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.014 ms

This SCF took 27105.997 ms, scf error = 8.215e-05
The last 17 occupations of kpoints #1 are (Nelectron = 24):
lambda[   3] =  -0.66168071500867, occ[   3] =   2.00000000000000
lambda[   4] =  -0.52672968266552, occ[   4] =   2.00000000000000
lambda[   5] =  -0.48119904497719, occ[   5] =   2.00000000000000
lambda[   6] =  -0.41096993607791, occ[   6] =   2.00000000000000
lambda[   7] =  -0.39308632803702, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34939811466316, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34449263355491, occ[   9] =   2.00000000000000
lambda[  10] =  -0.31958085576387, occ[  10] =   2.00000000000000
lambda[  11] =  -0.23033592166234, occ[  11] =   2.00000000000000
lambda[  12] =  -0.20094548865877, occ[  12] =   2.00000000000000
lambda[  13] =  -0.02681887544332, occ[  13] =   0.00000003709925
lambda[  14] =  -0.01226475381178, occ[  14] =   0.00000000000000
lambda[  15] =   0.01592720576385, occ[  15] =   0.00000000000000
lambda[  16] =   0.02042309561907, occ[  16] =   0.00000000000000
lambda[  17] =   0.03053523879875, occ[  17] =   0.00000000000000
lambda[  18] =   0.03520882224390, occ[  18] =   0.00000000000000
lambda[  19] =   0.03636538275791, occ[  19] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 17 (90%) = 0.000000000000000.
Occupation of state 19 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.590 ms, time for Allreduce/Reduce: 10.071 ms 
Time for calculating local force components: 20.255 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.30271388875632  -1.15289656237431  -0.00777094276040
  0.02908033430056  -0.03991162255694   0.01156622905724
  0.00876351651997   0.03615808065166   0.03209570527608
  0.01296396659204   0.01559553440896  -0.04441272529752
 -0.06472255403963  -0.01633344577480  -0.00711819152864
  0.01825367032354   0.06409289388078  -0.00780795619810
  0.02083761977249  -0.01953077039893   0.01126071296002
  0.10831800136771  -0.02045462542515  -0.00743842395819
 -0.00148568762446  -0.01338359465402   0.15306188675163
force_loc = 
  0.30003860830777   1.13998168008044   0.00766218065437
 -0.02995630233748   0.04038889925936  -0.01181342461800
 -0.00928847241087  -0.03685077217359  -0.03272522798748
 -0.01326229890135  -0.01579514571312   0.04536850517328
  0.06709074842220   0.01643387496980   0.00699016823803
 -0.01883532209668  -0.06693596565028   0.00757060294094
 -0.02005851514336   0.01946530855265  -0.01117041188145
 -0.11502832364613   0.00055883741799   0.00683343511721
  0.00533440358435   0.01036861258664  -0.14885231936358
Time for calculating nonlocal force components: 34.380 ms
[32mforces_xc: 
[0m[32m  0.00677559045316   0.02760717130981   0.00023948684942
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00138865744920   0.00064280810655  -0.00035613992809
[0m[32m  0.00036895473108   0.00889247724533   0.00048183119942
[0m[32m -0.00095798863778   0.00175512424291  -0.00365835756864
[0mTime for calculating XC forces components: 28.297 ms
 Cartesian force = 
  0.00408615407888   0.01470908923908   0.00012998884032
 -0.00089012396265   0.00049407692556  -0.00024793146382
 -0.00053911181663  -0.00067589129879  -0.00063025861446
 -0.00031248823504  -0.00018281108101   0.00095504397270
  0.00235403845684   0.00011722941813  -0.00012875919368
 -0.00059580769888  -0.00282627154636  -0.00023808916022
 -0.00062370874580   0.00059414648341  -0.00026657475257
 -0.00635552347308  -0.01098651053869  -0.00012389354462
  0.00287657139637  -0.00124305760133   0.00055047391635
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.283 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.256 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.197 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.203 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Time for printing density: 389.526 ms
The program took 467.373 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:36:53
Job ID:        2267022
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:36:00,vmem=8376K,walltime=00:08:00,mem=8160K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-008-7-2
---------------------------------------
