---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:48
Job ID:    2266792
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:21:53
Job ID:    2266792
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.105 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 25.908 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 4.
[32m
Time for finding element is 0.006 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type N is N
[0m[32mDefault atomic mass for N is 14.006855
[0mpseudo_dir # 1 = H.psp8
pseudo_dir # 2 = C.psp8
pseudo_dir # 3 = N.psp8

Reading ion file took 3.850 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: N.psp8
Input element type: N
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.

Reading pseudopotential file took 124.004 ms

Freeing SPARC_INPUT_MPI datatype took 0.010 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 0.972 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type N has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.123 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
   11.707338	   12.199928	   10.000000	
    8.292662	    7.800072	   10.000000	
   10.006324	   11.023348	   10.000000	
   10.006324	    8.679315	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.007 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.196 ms
Set up communicators.

--set up spincomm took 2.356 ms

--set up kptcomm took 0.353 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.010 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 11, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.010 ms
rank = 0, size_blacscomm = 11, ScaLAPACK topology Dims = (11, 1)
nproc = 12, size_blacscomm = 11 = dims[0] * dims[1] = (11, 1)
Nd_blacscomm 1000000, Nstates 11 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 1), actual size (1000000, 1)
rank = 0, mb = nb = 11, mbQ = nbQ = 64
rank = 0, nr_Hp = 11, nc_Hp = 11
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.125 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.324 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 11
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 11
# of bands per bandcomm          : 1
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 7.602 ms

Calculate_SplineDerivRadFun took 0.202 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.785 ms.
time spent on vectorized spline interp: 3.173 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 0, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.571 ms.
time spent on vectorized spline interp: 1.580 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 1, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.505 ms.
time spent on vectorized spline interp: 1.584 ms.
Z = 5,rb_x = 6.685000,rb_y = 6.685000,rb_z = 6.685000,error = 4.749E-08,Bint = -4.9999999525069
Z = 5,rb_x = 4.027500,rb_y = 4.027500,rb_z = 4.027500,error = 1.270E-05,Bint = -5.0000127028765
Z = 5,rb_x = 5.356250,rb_y = 5.356250,rb_z = 5.356250,error = 2.193E-05,Bint = -5.0000219309361
Z = 5,rb_x = 6.020625,rb_y = 6.020625,rb_z = 6.020625,error = 8.947E-06,Bint = -5.0000089468808
Z = 5,rb_x = 6.352813,rb_y = 6.352813,rb_z = 6.352813,error = 1.077E-06,Bint = -4.9999989230957
Z = 5,rb_x = 6.518906,rb_y = 6.518906,rb_z = 6.518906,error = 2.272E-07,Bint = -5.0000002272074
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 4.75E-08, TOL = 1.00E-07, rb = {6.685000, 6.685000, 6.685000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.506 ms.

Calculating rb for all atom types took 15.714 ms
----------------------
Estimated memory usage
Total: 788.88 MB
orbitals             : 503.54 MB
global sized vectors : 213.62 MB
subspace matrices : 2.84 kB
others : 71.72 MB
----------------------------------------------
Estimated memory usage per processor: 65.74 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.926 Bohr) takes 0.000 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.014 ms
Calculating pseudocharge density ... 
the global sum of int_b = -11.0000000106802, sum_int_rho = 10.7968663422130
PosCharge = 11.000000010680, NegCharge = -10.796866342213, scal_fac = 1.018814131992
After scaling, int_rho = 11.0000000106802, PosCharge + NegCharge - NetCharge = -1.954e-14
--Calculate Vref took 0.235 ms
--Calculate rho_guess took 1.289 ms

 integral of b = -11.0000000106802,
 int{b} + Nelectron + NetCharge = -1.068e-08,
 Esc = -29.8275495056297,
 MPI_Reduce took 1.102 ms

Calculating b & b_ref took 6.913 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.046 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.134 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.029 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.261 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.002 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.003 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.001 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 21.912 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = 0.000e+00, checking this took 0.155 ms
2-norm of RHS = 484.2304897621657, which took 0.496 ms

iter_count = 420, r_2norm = 4.528e-04, tol*||rhs|| = 4.842e-04

Anderson update took 188.143 ms, out of which F'*F took 95.637 ms; b-Ax took 631.938 ms, out of which Lap took 577.382 ms
Solving Poisson took 1223.381 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.796 ms
Total time for convolution: 	 convolve: 5.102699 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 92.849 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.815 ms
Total time for convolution: 	 convolve: 5.131185 
Total time for convolution: 	 convolve: 5.153250 
Total time for convolution: 	 convolve: 5.176176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.712 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.509 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.152 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.169 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.356 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.257 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
rank = 0, XC calculation took 24475.129 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.211 ms
---Transfer Veff_loc: D2D took 5.043 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 9.286 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 15.458 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.158 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.000 ms
rank =  0, One H*x took 1.462 ms
    Lanczos iter 53, eigmin  = -0.959672660, eigmax = 264.921164627, err_eigmin = 6.533e-04, err_eigmax = 9.696e-03
rank =   0, Lanczos took 99.016 ms, eigmin = -0.959672660309, eigmax = 267.570376272914

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.255352, lowerbound = -1.059673, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 689.496 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 8.364 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.254 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 10.632 ms
rank =  0, finding HY took 12.914 ms
rank =  0, distributing HY into block cyclic form took 7.990 ms
rank =  0, finding Y'*HY took 2.523 ms
Rank 0, Project_Hamiltonian used 34.083 ms
Total time for projection: 34.095 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.257 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.091 ms
rank = 0, Solve_Generalized_EigenProblem used 0.367 ms
    first calculated eigval = 2.833077500171863
    last  calculated eigval = 3.195664678786663
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =   2.83307750017186
lambda[   2] =   2.87126559746438
lambda[   3] =   2.89939546720205
lambda[   4] =   2.96029234973957
lambda[   5] =   2.97353911859252
lambda[   6] =   2.99028344916778
lambda[   7] =   3.04542157741835
lambda[   8] =   3.05849942741042
lambda[   9] =   3.11777429454066
lambda[  10] =   3.12585541784403
lambda[  11] =   3.19566467878666
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.379 ms
rank =  0, subspace rotation using ScaLAPACK took 1.810 ms
rank =  0, Distributing orbital back into band + domain format took 8.098 ms
rank = 0, Subspace_Rotation used 9.921 ms

Total time for subspace rotation: 9.924 ms
rank = 0, Efermi =   2.990291699999 calculate fermi energy took 0.072 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.295665, lowerbound = -1.059673, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 685.212 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 53.051 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 107.310 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 160.373 ms
rank =  0, finding HY took 10.571 ms
rank =  0, distributing HY into block cyclic form took 306.611 ms
rank =  0, finding Y'*HY took 123.203 ms
Rank 0, Project_Hamiltonian used 600.784 ms
Total time for projection: 600.792 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.078 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.729104294709527
    last  calculated eigval = 0.435909027288458
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.72910429470953
lambda[   2] =  -0.31414121490821
lambda[   3] =   0.00268116986700
lambda[   4] =   0.06813461561070
lambda[   5] =   0.16207050483012
lambda[   6] =   0.33567886924368
lambda[   7] =   0.34502250192751
lambda[   8] =   0.36031426684582
lambda[   9] =   0.37766178650527
lambda[  10] =   0.40083722052816
lambda[  11] =   0.43590902728846
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.182 ms
rank =  0, subspace rotation using ScaLAPACK took 1.973 ms
rank =  0, Distributing orbital back into band + domain format took 84.552 ms
rank = 0, Subspace_Rotation used 86.535 ms

Total time for subspace rotation: 86.539 ms
rank = 0, Efermi =   0.335281810879 calculate fermi energy took 0.024 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.535909, lowerbound = -1.059673, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 662.371 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 332.684 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.097 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 334.794 ms
rank =  0, finding HY took 11.821 ms
rank =  0, distributing HY into block cyclic form took 7.070 ms
rank =  0, finding Y'*HY took 2.527 ms
Rank 0, Project_Hamiltonian used 356.232 ms
Total time for projection: 356.237 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.197 ms
    first calculated eigval = -0.963461656664891
    last  calculated eigval = 0.140690690310940
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.96346165666489
lambda[   2] =  -0.64914271857930
lambda[   3] =  -0.51520820751309
lambda[   4] =  -0.41761652320691
lambda[   5] =  -0.38739034539738
lambda[   6] =  -0.03061420619456
lambda[   7] =   0.04699552422922
lambda[   8] =   0.08668008004455
lambda[   9] =   0.10139688664809
lambda[  10] =   0.10863209007374
lambda[  11] =   0.14069069031094
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.204 ms
rank =  0, subspace rotation using ScaLAPACK took 1.791 ms
rank =  0, Distributing orbital back into band + domain format took 7.819 ms
rank = 0, Subspace_Rotation used 9.622 ms

Total time for subspace rotation: 9.627 ms
rank = 0, Efermi =  -0.030614206125 calculate fermi energy took 0.025 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.240691, lowerbound = -1.059673, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 685.980 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 7.073 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.096 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.179 ms
rank =  0, finding HY took 11.829 ms
rank =  0, distributing HY into block cyclic form took 7.016 ms
rank =  0, finding Y'*HY took 2.493 ms
Rank 0, Project_Hamiltonian used 30.536 ms
Total time for projection: 30.540 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.098 ms
rank = 0, Solve_Generalized_EigenProblem used 0.170 ms
    first calculated eigval = -0.963660412785088
    last  calculated eigval = 0.084231247024828
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.96366041278509
lambda[   2] =  -0.65181710931507
lambda[   3] =  -0.52277608743431
lambda[   4] =  -0.42965116009129
lambda[   5] =  -0.40216209733360
lambda[   6] =  -0.16045941022366
lambda[   7] =  -0.11831949687795
lambda[   8] =   0.03062324303640
lambda[   9] =   0.03576771519102
lambda[  10] =   0.06212409749370
lambda[  11] =   0.08423124702483
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.178 ms
rank =  0, subspace rotation using ScaLAPACK took 1.943 ms
rank =  0, Distributing orbital back into band + domain format took 7.032 ms
rank = 0, Subspace_Rotation used 8.986 ms

Total time for subspace rotation: 8.990 ms
rank = 0, Efermi =  -0.160459410154 calculate fermi energy took 0.024 ms
rank = 0, --- Calculate rho: sum over local bands took 1.672 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.766 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.624 ms
rank = 0, Calculating density took 3975.283 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.795 ms
rank = 0, D2D took 1.933 ms
rank = 0, Transfering density took 1.939 ms
Etot    =   -17.470668190278
Eband   =    -6.100593145855
E1      =    12.859601999295
E2      =    -4.983155944522
E3      =    -6.178179410814
Exc     =    -5.559316176469
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 4.368e+00, dEband = 1.525e+00
rank = 0, Calculating/Estimating energy took 0.820 ms, Etot = -17.470668190, dEtot = 4.368e+00, dEband = 1.525e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 30.9024952743757, which took 0.057 ms

iter_count = 96, r_2norm = 9.193e-04, tol*||rhs|| = 1.236e-03

Anderson update took 40.947 ms, out of which F'*F took 21.560 ms; b-Ax took 142.334 ms, out of which Lap took 130.213 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 276.405 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068023, int_b + int_rho = -1.273e-14, checking this took 0.079 ms
2-norm of RHS = 481.5585512447615, which took 0.077 ms

iter_count = 282, r_2norm = 4.103e-04, tol*||rhs|| = 4.816e-04

Anderson update took 119.676 ms, out of which F'*F took 63.111 ms; b-Ax took 413.808 ms, out of which Lap took 379.242 ms
Solving Poisson took 798.985 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.277 ms
Total time for convolution: 	 convolve: 5.089607 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 9.470 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.288 ms
Total time for convolution: 	 convolve: 5.113034 
Total time for convolution: 	 convolve: 5.144479 
Total time for convolution: 	 convolve: 5.107650 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.247 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.159 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.153 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.242 ms
---Transfer Veff_loc: D2D took 3.722 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.261 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 9.023 ms

This SCF took 29488.094 ms, scf error = 1.623e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.184231, lowerbound = -0.963660, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 674.472 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.208 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.101 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.321 ms
rank =  0, finding HY took 11.752 ms
rank =  0, distributing HY into block cyclic form took 7.168 ms
rank =  0, finding Y'*HY took 2.534 ms
Rank 0, Project_Hamiltonian used 30.810 ms
Total time for projection: 30.821 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.074 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.102 ms
rank = 0, Solve_Generalized_EigenProblem used 0.179 ms
    first calculated eigval = -0.927135117737642
    last  calculated eigval = 0.055777653107590
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.92713511773764
lambda[   2] =  -0.62857504688164
lambda[   3] =  -0.49974592433556
lambda[   4] =  -0.40262844114364
lambda[   5] =  -0.37733255600549
lambda[   6] =  -0.19716242553970
lambda[   7] =  -0.10784141736522
lambda[   8] =  -0.00848626036914
lambda[   9] =   0.00493932580072
lambda[  10] =   0.03748533687521
lambda[  11] =   0.05577765310759
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.190 ms
rank =  0, subspace rotation using ScaLAPACK took 2.023 ms
rank =  0, Distributing orbital back into band + domain format took 7.014 ms
rank = 0, Subspace_Rotation used 9.046 ms

Total time for subspace rotation: 9.050 ms
rank = 0, Efermi =  -0.197162425470 calculate fermi energy took 0.057 ms
rank = 0, --- Calculate rho: sum over local bands took 1.641 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.793 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.703 ms
rank = 0, Calculating density took 727.792 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.794 ms
rank = 0, D2D took 1.926 ms
rank = 0, Transfering density took 1.928 ms
Etot    =   -17.501680081650
Eband   =    -5.867996599853
E1      =    12.604737811069
E2      =    -4.960315313164
E3      =    -6.251086668312
Exc     =    -5.618127051758
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 7.753e-03, dEband = 5.815e-02
rank = 0, Calculating/Estimating energy took 0.825 ms, Etot = -17.501680082, dEtot = 7.753e-03, dEband = 5.815e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 16.3697580173714, which took 0.044 ms

iter_count = 102, r_2norm = 5.132e-04, tol*||rhs|| = 6.548e-04

Anderson update took 43.446 ms, out of which F'*F took 23.060 ms; b-Ax took 152.780 ms, out of which Lap took 138.950 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 296.512 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068028, int_b + int_rho = 3.638e-14, checking this took 0.091 ms
2-norm of RHS = 478.5659352800574, which took 0.064 ms

iter_count = 294, r_2norm = 3.899e-04, tol*||rhs|| = 4.786e-04

Anderson update took 125.222 ms, out of which F'*F took 67.406 ms; b-Ax took 442.930 ms, out of which Lap took 403.110 ms
Solving Poisson took 839.051 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Total time for convolution: 	 convolve: 5.109004 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.820 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Total time for convolution: 	 convolve: 5.109972 
Total time for convolution: 	 convolve: 5.115611 
Total time for convolution: 	 convolve: 5.110608 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.306 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.183 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.205 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.208 ms
---Transfer Veff_loc: D2D took 3.575 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.261 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.865 ms

This SCF took 26348.021 ms, scf error = 1.122e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.155778, lowerbound = -0.927135, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 675.936 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 15.988 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.808 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 18.809 ms
rank =  0, finding HY took 11.805 ms
rank =  0, distributing HY into block cyclic form took 7.187 ms
rank =  0, finding Y'*HY took 2.481 ms
Rank 0, Project_Hamiltonian used 40.305 ms
Total time for projection: 40.319 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.146 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.100 ms
rank = 0, Solve_Generalized_EigenProblem used 0.250 ms
    first calculated eigval = -0.876944942724141
    last  calculated eigval = 0.039007400676193
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.87694494272414
lambda[   2] =  -0.59202012151276
lambda[   3] =  -0.45907133221261
lambda[   4] =  -0.36443969751813
lambda[   5] =  -0.34178185404850
lambda[   6] =  -0.16930819260128
lambda[   7] =  -0.07820034081034
lambda[   8] =  -0.02613171355224
lambda[   9] =  -0.00349310067964
lambda[  10] =   0.02461810523516
lambda[  11] =   0.03900740067619
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.263 ms
rank =  0, subspace rotation using ScaLAPACK took 1.968 ms
rank =  0, Distributing orbital back into band + domain format took 6.989 ms
rank = 0, Subspace_Rotation used 8.965 ms

Total time for subspace rotation: 8.969 ms
rank = 0, Efermi =  -0.169308192531 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.743 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.728 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.636 ms
rank = 0, Calculating density took 738.704 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.814 ms
rank = 0, D2D took 1.940 ms
rank = 0, Transfering density took 1.942 ms
Etot    =   -17.488610946259
Eband   =    -5.437824090447
E1      =    12.236914649318
E2      =    -4.886478948528
E3      =    -6.374167415398
Exc     =    -5.716651646471
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 3.267e-03, dEband = 1.075e-01
rank = 0, Calculating/Estimating energy took 1.204 ms, Etot = -17.488610946, dEtot = 3.267e-03, dEband = 1.075e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.1772449158869, which took 0.053 ms

iter_count = 102, r_2norm = 1.924e-04, tol*||rhs|| = 2.471e-04

Anderson update took 43.717 ms, out of which F'*F took 23.065 ms; b-Ax took 151.957 ms, out of which Lap took 138.530 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 297.399 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = -5.457e-15, checking this took 0.098 ms
2-norm of RHS = 478.2630543009976, which took 0.104 ms

iter_count = 276, r_2norm = 3.925e-04, tol*||rhs|| = 4.783e-04

Anderson update took 117.592 ms, out of which F'*F took 62.575 ms; b-Ax took 413.462 ms, out of which Lap took 375.915 ms
Solving Poisson took 785.122 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.063 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.241 ms
Total time for convolution: 	 convolve: 5.223176 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.032 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.287 ms
Total time for convolution: 	 convolve: 5.162106 
Total time for convolution: 	 convolve: 5.256419 
Total time for convolution: 	 convolve: 5.249377 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.278 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.024 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.185 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.158 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.157 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.227 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.393 ms
---Transfer Veff_loc: D2D took 3.592 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.255 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.879 ms

This SCF took 26722.514 ms, scf error = 4.617e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.139007, lowerbound = -0.876945, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 674.227 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.075 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.105 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.193 ms
rank =  0, finding HY took 12.127 ms
rank =  0, distributing HY into block cyclic form took 7.191 ms
rank =  0, finding Y'*HY took 2.373 ms
Rank 0, Project_Hamiltonian used 30.905 ms
Total time for projection: 30.916 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.075 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.104 ms
rank = 0, Solve_Generalized_EigenProblem used 0.181 ms
    first calculated eigval = -0.861631912037449
    last  calculated eigval = 0.032309893559006
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.86163191203745
lambda[   2] =  -0.57795353523606
lambda[   3] =  -0.44315293420940
lambda[   4] =  -0.35246302059609
lambda[   5] =  -0.33092905443455
lambda[   6] =  -0.15774213389088
lambda[   7] =  -0.06798356960977
lambda[   8] =  -0.03042714760176
lambda[   9] =  -0.00539116853708
lambda[  10] =   0.02124663663789
lambda[  11] =   0.03230989355901
==subpsace eigenproblem: bcast eigvals took 0.006 ms
Total time for solving subspace eigenvalue problem: 0.195 ms
rank =  0, subspace rotation using ScaLAPACK took 1.959 ms
rank =  0, Distributing orbital back into band + domain format took 7.118 ms
rank = 0, Subspace_Rotation used 9.087 ms

Total time for subspace rotation: 9.091 ms
rank = 0, Efermi =  -0.157742133821 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.672 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.179 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.163 ms
rank = 0, Calculating density took 728.552 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.984 ms
rank = 0, D2D took 2.136 ms
rank = 0, Transfering density took 2.140 ms
Etot    =   -17.486687066531
Eband   =    -5.290003048603
E1      =    12.128072496411
E2      =    -4.839245321903
E3      =    -6.420023885895
Exc     =    -5.752329499553
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 4.810e-04, dEband = 3.696e-02
rank = 0, Calculating/Estimating energy took 0.937 ms, Etot = -17.486687067, dEtot = 4.810e-04, dEband = 3.696e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.9997361900122, which took 0.050 ms

iter_count = 108, r_2norm = 6.154e-05, tol*||rhs|| = 7.999e-05

Anderson update took 45.647 ms, out of which F'*F took 24.612 ms; b-Ax took 163.857 ms, out of which Lap took 148.480 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 316.800 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068023, int_b + int_rho = -1.273e-14, checking this took 0.087 ms
2-norm of RHS = 478.7451769025402, which took 0.101 ms

iter_count = 270, r_2norm = 3.866e-04, tol*||rhs|| = 4.787e-04

Anderson update took 114.647 ms, out of which F'*F took 60.734 ms; b-Ax took 405.435 ms, out of which Lap took 368.262 ms
Solving Poisson took 769.326 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.172796 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.134781 
Total time for convolution: 	 convolve: 5.186111 
Total time for convolution: 	 convolve: 5.123904 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.290 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.159 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.219 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.373 ms
---Transfer Veff_loc: D2D took 3.642 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.802 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.480 ms

This SCF took 26503.489 ms, scf error = 2.259e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.132310, lowerbound = -0.861632, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 672.010 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.204 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.049 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.265 ms
rank =  0, finding HY took 12.119 ms
rank =  0, distributing HY into block cyclic form took 7.162 ms
rank =  0, finding Y'*HY took 2.466 ms
Rank 0, Project_Hamiltonian used 31.036 ms
Total time for projection: 31.046 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.089 ms
rank = 0, Solve_Generalized_EigenProblem used 0.165 ms
    first calculated eigval = -0.855483819669063
    last  calculated eigval = 0.029358158761935
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.85548381966906
lambda[   2] =  -0.57067465790775
lambda[   3] =  -0.43533605093463
lambda[   4] =  -0.34687765795007
lambda[   5] =  -0.32625981323548
lambda[   6] =  -0.15223504079352
lambda[   7] =  -0.06353334364988
lambda[   8] =  -0.03107429074455
lambda[   9] =  -0.00573925726590
lambda[  10] =   0.02054871288683
lambda[  11] =   0.02935815876193
==subpsace eigenproblem: bcast eigvals took 0.004 ms
Total time for solving subspace eigenvalue problem: 0.223 ms
rank =  0, subspace rotation using ScaLAPACK took 1.959 ms
rank =  0, Distributing orbital back into band + domain format took 7.090 ms
rank = 0, Subspace_Rotation used 9.059 ms

Total time for subspace rotation: 9.064 ms
rank = 0, Efermi =  -0.152235040724 calculate fermi energy took 1.637 ms
rank = 0, --- Calculate rho: sum over local bands took 1.993 ms
rank = 0, --- Calculate rho: reduce over all band groups took 10.724 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.628 ms
rank = 0, Calculating density took 727.400 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.871 ms
rank = 0, D2D took 1.971 ms
rank = 0, Transfering density took 1.980 ms
Etot    =   -17.485965428266
Eband   =    -5.221499041813
E1      =    12.096000929166
E2      =    -4.797564306095
E3      =    -6.441215240269
Exc     =    -5.767550639399
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.804e-04, dEband = 1.713e-02
rank = 0, Calculating/Estimating energy took 0.998 ms, Etot = -17.485965428, dEtot = 1.804e-04, dEband = 1.713e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.6187839426017, which took 0.116 ms

iter_count = 114, r_2norm = 1.580e-05, tol*||rhs|| = 2.475e-05

Anderson update took 48.082 ms, out of which F'*F took 25.885 ms; b-Ax took 170.673 ms, out of which Lap took 155.360 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.351 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068028, int_b + int_rho = 3.274e-14, checking this took 0.082 ms
2-norm of RHS = 479.0942898568080, which took 0.086 ms

iter_count = 246, r_2norm = 4.061e-04, tol*||rhs|| = 4.791e-04

Anderson update took 103.606 ms, out of which F'*F took 55.619 ms; b-Ax took 370.157 ms, out of which Lap took 336.669 ms
Solving Poisson took 699.015 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.165 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.118122 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 13.407 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.116016 
Total time for convolution: 	 convolve: 5.173541 
Total time for convolution: 	 convolve: 5.126024 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.280 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.281 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.174 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.422 ms
---Transfer Veff_loc: D2D took 3.670 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.524 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.229 ms

This SCF took 26346.912 ms, scf error = 7.859e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.129358, lowerbound = -0.855484, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 673.834 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.167 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.124 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.302 ms
rank =  0, finding HY took 12.161 ms
rank =  0, distributing HY into block cyclic form took 7.146 ms
rank =  0, finding Y'*HY took 2.437 ms
Rank 0, Project_Hamiltonian used 31.070 ms
Total time for projection: 31.081 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.141 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.854664524374309
    last  calculated eigval = 0.028127972516237
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.85466452437431
lambda[   2] =  -0.56926209982974
lambda[   3] =  -0.43406628439090
lambda[   4] =  -0.34555950571291
lambda[   5] =  -0.32522494858363
lambda[   6] =  -0.15103071780982
lambda[   7] =  -0.06256082288750
lambda[   8] =  -0.03081212184659
lambda[   9] =  -0.00601705163703
lambda[  10] =   0.02077832691490
lambda[  11] =   0.02812797251624
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.233 ms
rank =  0, subspace rotation using ScaLAPACK took 1.956 ms
rank =  0, Distributing orbital back into band + domain format took 7.008 ms
rank = 0, Subspace_Rotation used 8.993 ms

Total time for subspace rotation: 8.999 ms
rank = 0, Efermi =  -0.151030717740 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.666 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.949 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.614 ms
rank = 0, Calculating density took 728.494 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.847 ms
rank = 0, D2D took 2.008 ms
rank = 0, Transfering density took 2.010 ms
Etot    =   -17.485801664108
Eband   =    -5.208585445206
E1      =    12.098674330450
E2      =    -4.780889150714
E3      =    -6.443271167318
Exc     =    -5.768354644799
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 4.094e-05, dEband = 3.228e-03
rank = 0, Calculating/Estimating energy took 0.854 ms, Etot = -17.485801664, dEtot = 4.094e-05, dEband = 3.228e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2372713797518, which took 0.051 ms

iter_count = 114, r_2norm = 6.473e-06, tol*||rhs|| = 9.491e-06

Anderson update took 48.251 ms, out of which F'*F took 26.003 ms; b-Ax took 171.870 ms, out of which Lap took 156.619 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.217 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068019, int_b + int_rho = -5.457e-14, checking this took 0.092 ms
2-norm of RHS = 479.2898073940968, which took 0.106 ms

iter_count = 252, r_2norm = 4.384e-04, tol*||rhs|| = 4.793e-04

Anderson update took 109.710 ms, out of which F'*F took 58.064 ms; b-Ax took 379.517 ms, out of which Lap took 344.978 ms
Solving Poisson took 746.137 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.111367 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.269 ms
Total time for convolution: 	 convolve: 5.148331 
Total time for convolution: 	 convolve: 5.117929 
Total time for convolution: 	 convolve: 5.079731 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.797 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.548 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.188 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.559 ms
---Transfer Veff_loc: D2D took 3.621 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.367 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.024 ms

This SCF took 26272.215 ms, scf error = 3.976e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.128128, lowerbound = -0.854665, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 671.871 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.148 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.087 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.246 ms
rank =  0, finding HY took 12.143 ms
rank =  0, distributing HY into block cyclic form took 7.094 ms
rank =  0, finding Y'*HY took 2.413 ms
Rank 0, Project_Hamiltonian used 30.917 ms
Total time for projection: 30.928 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.118 ms
rank = 0, Solve_Generalized_EigenProblem used 0.193 ms
    first calculated eigval = -0.850769717843605
    last  calculated eigval = 0.028554444178540
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.85076971784361
lambda[   2] =  -0.56591630538911
lambda[   3] =  -0.43067103325540
lambda[   4] =  -0.34148777677832
lambda[   5] =  -0.32143543226235
lambda[   6] =  -0.14729595311871
lambda[   7] =  -0.05896801453318
lambda[   8] =  -0.02937259448139
lambda[   9] =  -0.00491019248366
lambda[  10] =   0.02282785755227
lambda[  11] =   0.02855444417854
==subpsace eigenproblem: bcast eigvals took 0.079 ms
Total time for solving subspace eigenvalue problem: 0.280 ms
rank =  0, subspace rotation using ScaLAPACK took 1.967 ms
rank =  0, Distributing orbital back into band + domain format took 7.643 ms
rank = 0, Subspace_Rotation used 9.620 ms

Total time for subspace rotation: 9.625 ms
rank = 0, Efermi =  -0.147295953049 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.824 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.054 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.573 ms
rank = 0, Calculating density took 727.292 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.742 ms
rank = 0, D2D took 1.877 ms
rank = 0, Transfering density took 1.880 ms
Etot    =   -17.485716571115
Eband   =    -5.167856485749
E1      =    12.080969254723
E2      =    -4.755822751348
E3      =    -6.449924762395
Exc     =    -5.772880631247
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 2.127e-05, dEband = 1.018e-02
rank = 0, Calculating/Estimating energy took 0.811 ms, Etot = -17.485716571, dEtot = 2.127e-05, dEband = 1.018e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2387490564963, which took 0.111 ms

iter_count = 108, r_2norm = 8.287e-06, tol*||rhs|| = 9.550e-06

Anderson update took 45.770 ms, out of which F'*F took 24.487 ms; b-Ax took 162.126 ms, out of which Lap took 147.511 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.627 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = 0.000e+00, checking this took 0.080 ms
2-norm of RHS = 479.2557615220499, which took 0.065 ms

iter_count = 216, r_2norm = 4.679e-04, tol*||rhs|| = 4.793e-04

Anderson update took 91.746 ms, out of which F'*F took 49.048 ms; b-Ax took 323.526 ms, out of which Lap took 295.249 ms
Solving Poisson took 614.238 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.117 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.242 ms
Total time for convolution: 	 convolve: 5.121944 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.279 ms
Total time for convolution: 	 convolve: 5.114246 
Total time for convolution: 	 convolve: 5.121503 
Total time for convolution: 	 convolve: 5.084150 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.731 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.564 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.233 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.675 ms
---Transfer Veff_loc: D2D took 3.534 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.160 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.728 ms

This SCF took 26108.502 ms, scf error = 1.775e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.128554, lowerbound = -0.850770, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 672.920 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.074 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.279 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.366 ms
rank =  0, finding HY took 12.106 ms
rank =  0, distributing HY into block cyclic form took 7.149 ms
rank =  0, finding Y'*HY took 2.386 ms
Rank 0, Project_Hamiltonian used 31.031 ms
Total time for projection: 31.041 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.122 ms
rank = 0, Solve_Generalized_EigenProblem used 0.196 ms
    first calculated eigval = -0.849489727468622
    last  calculated eigval = 0.028671424903764
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84948972746862
lambda[   2] =  -0.56483510294407
lambda[   3] =  -0.42951824972775
lambda[   4] =  -0.34026527642385
lambda[   5] =  -0.32023314175213
lambda[   6] =  -0.14611176423103
lambda[   7] =  -0.05773684048057
lambda[   8] =  -0.02856033941585
lambda[   9] =  -0.00389831242297
lambda[  10] =   0.02369697906151
lambda[  11] =   0.02867142490376
==subpsace eigenproblem: bcast eigvals took 0.031 ms
Total time for solving subspace eigenvalue problem: 0.236 ms
rank =  0, subspace rotation using ScaLAPACK took 1.916 ms
rank =  0, Distributing orbital back into band + domain format took 7.690 ms
rank = 0, Subspace_Rotation used 9.617 ms

Total time for subspace rotation: 9.623 ms
rank = 0, Efermi =  -0.146111764161 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 1.646 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.994 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.625 ms
rank = 0, Calculating density took 728.218 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.796 ms
rank = 0, D2D took 1.934 ms
rank = 0, Transfering density took 1.936 ms
Etot    =   -17.485773978838
Eband   =    -5.154794762424
E1      =    12.073350389690
E2      =    -4.749939862082
E3      =    -6.451726550319
Exc     =    -5.774299795921
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.435e-05, dEband = 3.265e-03
rank = 0, Calculating/Estimating energy took 0.807 ms, Etot = -17.485773979, dEtot = 1.435e-05, dEband = 3.265e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0944398937638, which took 0.055 ms

iter_count = 114, r_2norm = 2.418e-06, tol*||rhs|| = 3.778e-06

Anderson update took 48.113 ms, out of which F'*F took 25.836 ms; b-Ax took 170.768 ms, out of which Lap took 156.138 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.578 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068021, int_b + int_rho = -3.092e-14, checking this took 0.086 ms
2-norm of RHS = 479.2300767293048, which took 0.077 ms

iter_count = 228, r_2norm = 3.899e-04, tol*||rhs|| = 4.792e-04

Anderson update took 95.582 ms, out of which F'*F took 51.902 ms; b-Ax took 341.024 ms, out of which Lap took 310.657 ms
Solving Poisson took 648.830 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.238 ms
Total time for convolution: 	 convolve: 5.111890 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.290 ms
Total time for convolution: 	 convolve: 5.122226 
Total time for convolution: 	 convolve: 5.180913 
Total time for convolution: 	 convolve: 5.094163 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.838 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.546 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.088 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.011 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.270 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.238 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.224 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.114 ms
---Transfer Veff_loc: D2D took 3.523 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.146 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.704 ms

This SCF took 26216.311 ms, scf error = 1.324e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.128671, lowerbound = -0.849490, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 672.093 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.078 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.100 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.188 ms
rank =  0, finding HY took 12.178 ms
rank =  0, distributing HY into block cyclic form took 7.024 ms
rank =  0, finding Y'*HY took 2.457 ms
Rank 0, Project_Hamiltonian used 30.883 ms
Total time for projection: 30.893 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.137 ms
rank = 0, Solve_Generalized_EigenProblem used 0.211 ms
    first calculated eigval = -0.848366577172631
    last  calculated eigval = 0.030349953839763
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84836657717263
lambda[   2] =  -0.56370740702494
lambda[   3] =  -0.42839457798217
lambda[   4] =  -0.33908464227032
lambda[   5] =  -0.31906703757827
lambda[   6] =  -0.14499779233378
lambda[   7] =  -0.05638385551079
lambda[   8] =  -0.02573526728477
lambda[   9] =   0.00001984782058
lambda[  10] =   0.02681720350618
lambda[  11] =   0.03034995383976
==subpsace eigenproblem: bcast eigvals took 0.019 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 1.920 ms
rank =  0, Distributing orbital back into band + domain format took 7.702 ms
rank = 0, Subspace_Rotation used 9.635 ms

Total time for subspace rotation: 9.640 ms
rank = 0, Efermi =  -0.144997792264 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 1.686 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.816 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.638 ms
rank = 0, Calculating density took 727.141 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.802 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 1.943 ms
Etot    =   -17.485828174434
Eband   =    -5.142238277939
E1      =    12.067656283131
E2      =    -4.742877703234
E3      =    -6.452618995380
Exc     =    -5.775046655655
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.355e-05, dEband = 3.139e-03
rank = 0, Calculating/Estimating energy took 0.806 ms, Etot = -17.485828174, dEtot = 1.355e-05, dEband = 3.139e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0691824582359, which took 0.059 ms

iter_count = 108, r_2norm = 2.727e-06, tol*||rhs|| = 2.767e-06

Anderson update took 45.502 ms, out of which F'*F took 24.347 ms; b-Ax took 162.310 ms, out of which Lap took 147.934 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.277 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068023, int_b + int_rho = -1.637e-14, checking this took 0.085 ms
2-norm of RHS = 479.2365568178339, which took 0.069 ms

iter_count = 204, r_2norm = 4.310e-04, tol*||rhs|| = 4.792e-04

Anderson update took 85.317 ms, out of which F'*F took 46.098 ms; b-Ax took 305.949 ms, out of which Lap took 278.075 ms
Solving Poisson took 580.504 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.117863 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.120615 
Total time for convolution: 	 convolve: 5.118372 
Total time for convolution: 	 convolve: 5.088100 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.021 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.000 ms
---Transfer Veff_loc: D2D took 3.656 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.352 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.044 ms

This SCF took 26092.731 ms, scf error = 6.716e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.130350, lowerbound = -0.848367, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 674.480 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.041 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.116 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.167 ms
rank =  0, finding HY took 12.181 ms
rank =  0, distributing HY into block cyclic form took 7.056 ms
rank =  0, finding Y'*HY took 2.447 ms
Rank 0, Project_Hamiltonian used 30.874 ms
Total time for projection: 30.885 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.028 ms
rank = 0, Solve_Generalized_EigenProblem used 1.121 ms
    first calculated eigval = -0.847609964859046
    last  calculated eigval = 0.031442840521932
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84760996485905
lambda[   2] =  -0.56297163634794
lambda[   3] =  -0.42765717562247
lambda[   4] =  -0.33834051937483
lambda[   5] =  -0.31832407022614
lambda[   6] =  -0.14430257145784
lambda[   7] =  -0.05559807903746
lambda[   8] =  -0.02344496475586
lambda[   9] =   0.00379537936913
lambda[  10] =   0.02874949340451
lambda[  11] =   0.03144284052193
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 1.139 ms
rank =  0, subspace rotation using ScaLAPACK took 1.958 ms
rank =  0, Distributing orbital back into band + domain format took 7.059 ms
rank = 0, Subspace_Rotation used 9.029 ms

Total time for subspace rotation: 9.034 ms
rank = 0, Efermi =  -0.144302571388 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.662 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.916 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.706 ms
rank = 0, Calculating density took 729.942 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.784 ms
rank = 0, D2D took 1.924 ms
rank = 0, Transfering density took 1.925 ms
Etot    =   -17.485902873251
Eband   =    -5.134109305860
E1      =    12.063500095584
E2      =    -4.738656847134
E3      =    -6.453592695322
Exc     =    -5.775846982846
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.867e-05, dEband = 2.032e-03
rank = 0, Calculating/Estimating energy took 0.802 ms, Etot = -17.485902873, dEtot = 1.867e-05, dEband = 2.032e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0550936228071, which took 0.116 ms

iter_count = 108, r_2norm = 2.134e-06, tol*||rhs|| = 2.204e-06

Anderson update took 45.828 ms, out of which F'*F took 24.612 ms; b-Ax took 161.209 ms, out of which Lap took 147.284 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 313.729 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068025, int_b + int_rho = 9.095e-15, checking this took 0.080 ms
2-norm of RHS = 479.2422154957837, which took 0.084 ms

iter_count = 180, r_2norm = 4.084e-04, tol*||rhs|| = 4.792e-04

Anderson update took 75.142 ms, out of which F'*F took 40.723 ms; b-Ax took 269.906 ms, out of which Lap took 246.100 ms
Solving Poisson took 512.107 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.121 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Total time for convolution: 	 convolve: 5.110041 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 1.283 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.289 ms
Total time for convolution: 	 convolve: 5.145562 
Total time for convolution: 	 convolve: 5.113463 
Total time for convolution: 	 convolve: 5.093343 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.812 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.085 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.172 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.243 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.046 ms
---Transfer Veff_loc: D2D took 3.676 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.093 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.804 ms

This SCF took 26032.794 ms, scf error = 4.280e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.131443, lowerbound = -0.847610, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 671.373 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.216 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.024 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.253 ms
rank =  0, finding HY took 12.183 ms
rank =  0, distributing HY into block cyclic form took 7.187 ms
rank =  0, finding Y'*HY took 2.307 ms
Rank 0, Project_Hamiltonian used 30.972 ms
Total time for projection: 30.982 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 1.246 ms
rank = 0, Solve_Generalized_EigenProblem used 1.323 ms
    first calculated eigval = -0.847436368948230
    last  calculated eigval = 0.031853292843433
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84743636894823
lambda[   2] =  -0.56277522499847
lambda[   3] =  -0.42746317865168
lambda[   4] =  -0.33816839333553
lambda[   5] =  -0.31813405892769
lambda[   6] =  -0.14411734295785
lambda[   7] =  -0.05543142098664
lambda[   8] =  -0.02186222174487
lambda[   9] =   0.00585231636496
lambda[  10] =   0.02987792567727
lambda[  11] =   0.03185329284343
==subpsace eigenproblem: bcast eigvals took 0.009 ms
Total time for solving subspace eigenvalue problem: 1.342 ms
rank =  0, subspace rotation using ScaLAPACK took 1.962 ms
rank =  0, Distributing orbital back into band + domain format took 7.151 ms
rank = 0, Subspace_Rotation used 9.128 ms

Total time for subspace rotation: 9.134 ms
rank = 0, Efermi =  -0.144117342888 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 1.698 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.962 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.619 ms
rank = 0, Calculating density took 727.242 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.880 ms
rank = 0, D2D took 2.015 ms
rank = 0, Transfering density took 2.021 ms
Etot    =   -17.485932827047
Eband   =    -5.132071794220
E1      =    12.062648040139
E2      =    -4.737458620201
E3      =    -6.453639385068
Exc     =    -5.775910855651
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 7.488e-06, dEband = 5.094e-04
rank = 0, Calculating/Estimating energy took 0.798 ms, Etot = -17.485932827, dEtot = 7.488e-06, dEband = 5.094e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0322670446499, which took 0.046 ms

iter_count = 114, r_2norm = 8.220e-07, tol*||rhs|| = 1.291e-06

Anderson update took 48.384 ms, out of which F'*F took 25.802 ms; b-Ax took 171.797 ms, out of which Lap took 156.278 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 331.755 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068020, int_b + int_rho = -4.366e-14, checking this took 0.079 ms
2-norm of RHS = 479.2537631151712, which took 0.067 ms

iter_count = 180, r_2norm = 4.082e-04, tol*||rhs|| = 4.793e-04

Anderson update took 75.736 ms, out of which F'*F took 41.144 ms; b-Ax took 271.718 ms, out of which Lap took 246.481 ms
Solving Poisson took 515.535 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.253 ms
Total time for convolution: 	 convolve: 5.142778 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.307 ms
Total time for convolution: 	 convolve: 5.139793 
Total time for convolution: 	 convolve: 5.158304 
Total time for convolution: 	 convolve: 5.122898 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.804 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.568 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.069 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.173 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.267 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.222 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.704 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.312 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.053 ms

This SCF took 26161.472 ms, scf error = 3.385e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.131853, lowerbound = -0.847436, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 671.766 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 7.088 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.104 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.204 ms
rank =  0, finding HY took 12.143 ms
rank =  0, distributing HY into block cyclic form took 7.454 ms
rank =  0, finding Y'*HY took 2.383 ms
Rank 0, Project_Hamiltonian used 31.228 ms
Total time for projection: 31.238 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.073 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.139 ms
rank = 0, Solve_Generalized_EigenProblem used 0.215 ms
    first calculated eigval = -0.847086390369694
    last  calculated eigval = 0.032322756007332
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84708639036969
lambda[   2] =  -0.56244167354911
lambda[   3] =  -0.42712837248613
lambda[   4] =  -0.33784619869756
lambda[   5] =  -0.31779907659855
lambda[   6] =  -0.14382160109120
lambda[   7] =  -0.05523382564561
lambda[   8] =  -0.01992530116789
lambda[   9] =   0.00796537290767
lambda[  10] =   0.03057347632832
lambda[  11] =   0.03232275600733
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.243 ms
rank =  0, subspace rotation using ScaLAPACK took 1.965 ms
rank =  0, Distributing orbital back into band + domain format took 7.014 ms
rank = 0, Subspace_Rotation used 8.990 ms

Total time for subspace rotation: 8.995 ms
rank = 0, Efermi =  -0.143821601022 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.627 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.041 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.652 ms
rank = 0, Calculating density took 726.680 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.785 ms
rank = 0, D2D took 1.925 ms
rank = 0, Transfering density took 1.927 ms
Etot    =   -17.485987035322
Eband   =    -5.128425026029
E1      =    12.061024633274
E2      =    -4.735317386344
E3      =    -6.453926968751
Exc     =    -5.776134775077
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.355e-05, dEband = 9.117e-04
rank = 0, Calculating/Estimating energy took 0.893 ms, Etot = -17.485987035, dEtot = 1.355e-05, dEband = 9.117e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0321501470633, which took 0.069 ms

iter_count = 108, r_2norm = 1.155e-06, tol*||rhs|| = 1.286e-06

Anderson update took 45.630 ms, out of which F'*F took 24.645 ms; b-Ax took 162.611 ms, out of which Lap took 147.878 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 314.224 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068026, int_b + int_rho = 1.273e-14, checking this took 0.092 ms
2-norm of RHS = 479.2556537371748, which took 0.101 ms

iter_count = 144, r_2norm = 4.599e-04, tol*||rhs|| = 4.793e-04

Anderson update took 60.643 ms, out of which F'*F took 32.514 ms; b-Ax took 215.533 ms, out of which Lap took 195.999 ms
Solving Poisson took 410.401 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.052 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.247 ms
Total time for convolution: 	 convolve: 5.162393 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 193.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.283 ms
Total time for convolution: 	 convolve: 5.146939 
Total time for convolution: 	 convolve: 5.170179 
Total time for convolution: 	 convolve: 5.107978 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.810 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.163 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.218 ms
---Transfer Veff_loc: D2D took 3.556 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.088 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.678 ms

This SCF took 26312.082 ms, scf error = 2.362e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.132323, lowerbound = -0.847086, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 673.312 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.165 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.098 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.280 ms
rank =  0, finding HY took 12.025 ms
rank =  0, distributing HY into block cyclic form took 7.020 ms
rank =  0, finding Y'*HY took 2.435 ms
Rank 0, Project_Hamiltonian used 30.797 ms
Total time for projection: 30.815 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.069 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.130 ms
rank = 0, Solve_Generalized_EigenProblem used 0.202 ms
    first calculated eigval = -0.847111526755830
    last  calculated eigval = 0.032956482015096
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84711152675583
lambda[   2] =  -0.56244915074573
lambda[   3] =  -0.42713989165517
lambda[   4] =  -0.33786071334469
lambda[   5] =  -0.31781158513386
lambda[   6] =  -0.14383565068967
lambda[   7] =  -0.05528885008759
lambda[   8] =  -0.01896720619326
lambda[   9] =   0.00846475341933
lambda[  10] =   0.03095094592994
lambda[  11] =   0.03295648201510
==subpsace eigenproblem: bcast eigvals took 0.100 ms
Total time for solving subspace eigenvalue problem: 0.306 ms
rank =  0, subspace rotation using ScaLAPACK took 1.998 ms
rank =  0, Distributing orbital back into band + domain format took 6.887 ms
rank = 0, Subspace_Rotation used 8.896 ms

Total time for subspace rotation: 8.901 ms
rank = 0, Efermi =  -0.143835650620 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.652 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.981 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.610 ms
rank = 0, Calculating density took 727.693 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.976 ms
rank = 0, D2D took 2.109 ms
rank = 0, Transfering density took 2.115 ms
Etot    =   -17.486002068715
Eband   =    -5.128581387496
E1      =    12.061287525185
E2      =    -4.735251899693
E3      =    -6.453718226059
Exc     =    -5.775982109571
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 3.758e-06, dEband = 3.909e-05
rank = 0, Calculating/Estimating energy took 0.804 ms, Etot = -17.486002069, dEtot = 3.758e-06, dEband = 3.909e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0294361440335, which took 0.051 ms

iter_count = 108, r_2norm = 1.167e-06, tol*||rhs|| = 1.177e-06

Anderson update took 45.922 ms, out of which F'*F took 24.662 ms; b-Ax took 161.069 ms, out of which Lap took 147.142 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 312.682 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068025, int_b + int_rho = 5.457e-15, checking this took 0.085 ms
2-norm of RHS = 479.2543159245056, which took 0.101 ms

iter_count = 90, r_2norm = 4.362e-04, tol*||rhs|| = 4.793e-04

Anderson update took 37.603 ms, out of which F'*F took 20.404 ms; b-Ax took 133.739 ms, out of which Lap took 122.077 ms
Solving Poisson took 256.856 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.263 ms
Total time for convolution: 	 convolve: 5.077022 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 53.164 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.294 ms
Total time for convolution: 	 convolve: 5.145370 
Total time for convolution: 	 convolve: 5.127636 
Total time for convolution: 	 convolve: 5.169627 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.066 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.175 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.229 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
---Transfer Veff_loc: D2D took 3.622 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.100 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.755 ms

This SCF took 25920.820 ms, scf error = 2.455e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.132956, lowerbound = -0.847112, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 670.767 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.070 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.108 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.188 ms
rank =  0, finding HY took 12.251 ms
rank =  0, distributing HY into block cyclic form took 7.058 ms
rank =  0, finding Y'*HY took 2.430 ms
Rank 0, Project_Hamiltonian used 30.948 ms
Total time for projection: 30.959 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.133 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.847043112842776
    last  calculated eigval = 0.032719606782506
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84704311284278
lambda[   2] =  -0.56239152804287
lambda[   3] =  -0.42708187138243
lambda[   4] =  -0.33780319461644
lambda[   5] =  -0.31775582154820
lambda[   6] =  -0.14378810536459
lambda[   7] =  -0.05524361398648
lambda[   8] =  -0.01901549596806
lambda[   9] =   0.00839480756616
lambda[  10] =   0.03070002283045
lambda[  11] =   0.03271960678251
==subpsace eigenproblem: bcast eigvals took 0.022 ms
Total time for solving subspace eigenvalue problem: 0.237 ms
rank =  0, subspace rotation using ScaLAPACK took 1.973 ms
rank =  0, Distributing orbital back into band + domain format took 7.071 ms
rank = 0, Subspace_Rotation used 9.055 ms

Total time for subspace rotation: 9.060 ms
rank = 0, Efermi =  -0.143788105295 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.706 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.866 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.688 ms
rank = 0, Calculating density took 725.412 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.772 ms
rank = 0, D2D took 1.907 ms
rank = 0, Transfering density took 1.909 ms
Etot    =   -17.486002804410
Eband   =    -5.127939163766
E1      =    12.060856290163
E2      =    -4.735002432125
E3      =    -6.453882245385
Exc     =    -5.776108385733
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 1.839e-07, dEband = 1.606e-04
rank = 0, Calculating/Estimating energy took 0.816 ms, Etot = -17.486002804, dEtot = 1.839e-07, dEband = 1.606e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0237604848678, which took 0.120 ms

iter_count = 114, r_2norm = 6.451e-07, tol*||rhs|| = 9.504e-07

Anderson update took 48.611 ms, out of which F'*F took 25.924 ms; b-Ax took 172.221 ms, out of which Lap took 156.369 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 332.966 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068030, int_b + int_rho = 5.093e-14, checking this took 0.082 ms
2-norm of RHS = 479.2524047900682, which took 0.172 ms

iter_count = 132, r_2norm = 4.327e-04, tol*||rhs|| = 4.793e-04

Anderson update took 55.763 ms, out of which F'*F took 30.058 ms; b-Ax took 198.884 ms, out of which Lap took 180.674 ms
Solving Poisson took 378.216 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.234 ms
Total time for convolution: 	 convolve: 5.178076 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.293 ms
Total time for convolution: 	 convolve: 5.127275 
Total time for convolution: 	 convolve: 5.167543 
Total time for convolution: 	 convolve: 5.112406 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.795 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.065 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.167 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.226 ms
---Transfer Veff_loc: D2D took 3.557 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.091 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.694 ms

This SCF took 26044.325 ms, scf error = 2.088e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.132720, lowerbound = -0.847043, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 672.562 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 7.022 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.614 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.645 ms
rank =  0, finding HY took 12.107 ms
rank =  0, distributing HY into block cyclic form took 6.996 ms
rank =  0, finding Y'*HY took 2.443 ms
Rank 0, Project_Hamiltonian used 31.209 ms
Total time for projection: 31.220 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.111 ms
rank = 0, Solve_Generalized_EigenProblem used 0.185 ms
    first calculated eigval = -0.846934925463621
    last  calculated eigval = 0.032882193332479
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84693492546362
lambda[   2] =  -0.56228899948161
lambda[   3] =  -0.42698544619761
lambda[   4] =  -0.33771263571421
lambda[   5] =  -0.31765919692145
lambda[   6] =  -0.14371245880516
lambda[   7] =  -0.05518785423431
lambda[   8] =  -0.01887399941079
lambda[   9] =   0.00803076235038
lambda[  10] =   0.03075019263716
lambda[  11] =   0.03288219333248
==subpsace eigenproblem: bcast eigvals took 0.033 ms
Total time for solving subspace eigenvalue problem: 0.226 ms
rank =  0, subspace rotation using ScaLAPACK took 2.026 ms
rank =  0, Distributing orbital back into band + domain format took 6.918 ms
rank = 0, Subspace_Rotation used 8.953 ms

Total time for subspace rotation: 8.959 ms
rank = 0, Efermi =  -0.143712458736 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.753 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.889 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.580 ms
rank = 0, Calculating density took 727.303 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.755 ms
rank = 0, D2D took 1.889 ms
rank = 0, Transfering density took 1.891 ms
Etot    =   -17.486017715272
Eband   =    -5.126874867897
E1      =    12.060258744235
E2      =    -4.734498000305
E3      =    -6.453989509849
Exc     =    -5.776192879180
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 3.728e-06, dEband = 2.661e-04
rank = 0, Calculating/Estimating energy took 0.809 ms, Etot = -17.486017715, dEtot = 3.728e-06, dEband = 2.661e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0231841330398, which took 0.080 ms

iter_count = 108, r_2norm = 7.286e-07, tol*||rhs|| = 9.274e-07

Anderson update took 46.084 ms, out of which F'*F took 35.195 ms; b-Ax took 173.172 ms, out of which Lap took 158.924 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 324.353 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = 0.000e+00, checking this took 0.082 ms
2-norm of RHS = 479.2545629628270, which took 0.104 ms

iter_count = 150, r_2norm = 4.396e-04, tol*||rhs|| = 4.793e-04

Anderson update took 62.735 ms, out of which F'*F took 33.793 ms; b-Ax took 222.906 ms, out of which Lap took 203.572 ms
Solving Poisson took 426.242 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.084762 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.303 ms
Total time for convolution: 	 convolve: 5.118919 
Total time for convolution: 	 convolve: 5.106528 
Total time for convolution: 	 convolve: 5.116565 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.783 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.561 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.160 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.220 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.640 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.112 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.787 ms

This SCF took 25898.423 ms, scf error = 1.749e-04
-------------
SCF iter 16  
-------------

 Chebfilt 19, in Chebyshev filtering, lambda_cutoff = 0.132882, lowerbound = -0.846935, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 674.155 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 7.017 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.119 ms
rank =  0, finding HY took 11.984 ms
rank =  0, distributing HY into block cyclic form took 6.975 ms
rank =  0, finding Y'*HY took 2.452 ms
Rank 0, Project_Hamiltonian used 30.550 ms
Total time for projection: 30.561 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.070 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.113 ms
rank = 0, Solve_Generalized_EigenProblem used 0.187 ms
    first calculated eigval = -0.846790306583893
    last  calculated eigval = 0.033015449006234
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84679030658389
lambda[   2] =  -0.56214286965479
lambda[   3] =  -0.42684955598332
lambda[   4] =  -0.33758982307239
lambda[   5] =  -0.31752052977907
lambda[   6] =  -0.14359423689202
lambda[   7] =  -0.05507774360948
lambda[   8] =  -0.01905626724556
lambda[   9] =   0.00752991919192
lambda[  10] =   0.03093425143915
lambda[  11] =   0.03301544900623
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.205 ms
rank =  0, subspace rotation using ScaLAPACK took 1.959 ms
rank =  0, Distributing orbital back into band + domain format took 6.930 ms
rank = 0, Subspace_Rotation used 8.897 ms

Total time for subspace rotation: 8.907 ms
rank = 0, Efermi =  -0.143594236822 calculate fermi energy took 0.053 ms
rank = 0, --- Calculate rho: sum over local bands took 1.700 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.717 ms
rank = 0, --- Scale rho: scale by 1/dV took 1.086 ms
rank = 0, Calculating density took 728.441 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.009 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.930 ms
rank = 0, D2D took 2.078 ms
rank = 0, Transfering density took 2.083 ms
Etot    =   -17.486027811990
Eband   =    -5.125380408573
E1      =    12.059496950005
E2      =    -4.733714287418
E3      =    -6.454137941828
Exc     =    -5.776300360084
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 2.524e-06, dEband = 3.736e-04
rank = 0, Calculating/Estimating energy took 0.784 ms, Etot = -17.486027812, dEtot = 2.524e-06, dEband = 3.736e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0246303009743, which took 0.056 ms

iter_count = 102, r_2norm = 8.843e-07, tol*||rhs|| = 9.852e-07

Anderson update took 43.774 ms, out of which F'*F took 23.418 ms; b-Ax took 152.254 ms, out of which Lap took 139.889 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 297.117 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068023, int_b + int_rho = -1.637e-14, checking this took 0.088 ms
2-norm of RHS = 479.2590028425113, which took 0.847 ms

iter_count = 132, r_2norm = 4.505e-04, tol*||rhs|| = 4.793e-04

Anderson update took 55.070 ms, out of which F'*F took 30.143 ms; b-Ax took 196.250 ms, out of which Lap took 179.254 ms
Solving Poisson took 375.958 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.106 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.246 ms
Total time for convolution: 	 convolve: 5.086638 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.305 ms
Total time for convolution: 	 convolve: 5.140080 
Total time for convolution: 	 convolve: 5.120432 
Total time for convolution: 	 convolve: 5.126947 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.793 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.526 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.111 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.171 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.251 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.221 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.598 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.081 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.713 ms

This SCF took 25900.062 ms, scf error = 1.374e-04
-------------
SCF iter 17  
-------------

 Chebfilt 20, in Chebyshev filtering, lambda_cutoff = 0.133015, lowerbound = -0.846790, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 670.578 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 7.151 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.096 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.266 ms
rank =  0, finding HY took 12.118 ms
rank =  0, distributing HY into block cyclic form took 7.076 ms
rank =  0, finding Y'*HY took 2.418 ms
Rank 0, Project_Hamiltonian used 30.900 ms
Total time for projection: 30.911 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.133 ms
rank = 0, Solve_Generalized_EigenProblem used 0.207 ms
    first calculated eigval = -0.846720166173799
    last  calculated eigval = 0.034406142109652
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84672016617380
lambda[   2] =  -0.56205962748932
lambda[   3] =  -0.42677026243526
lambda[   4] =  -0.33750975633835
lambda[   5] =  -0.31744168032681
lambda[   6] =  -0.14351739163173
lambda[   7] =  -0.05501338312126
lambda[   8] =  -0.01819550688455
lambda[   9] =   0.00763737557212
lambda[  10] =   0.03213736430308
lambda[  11] =   0.03440614210965
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.235 ms
rank =  0, subspace rotation using ScaLAPACK took 1.955 ms
rank =  0, Distributing orbital back into band + domain format took 7.066 ms
rank = 0, Subspace_Rotation used 9.032 ms

Total time for subspace rotation: 9.037 ms
rank = 0, Efermi =  -0.143517391562 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 1.683 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.837 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.686 ms
rank = 0, Calculating density took 725.081 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.850 ms
rank = 0, D2D took 1.973 ms
rank = 0, Transfering density took 1.975 ms
Etot    =   -17.486035996119
Eband   =    -5.124520378689
E1      =    12.059257534852
E2      =    -4.733080419056
E3      =    -6.454131579060
Exc     =    -5.776288927814
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 2.046e-06, dEband = 2.150e-04
rank = 0, Calculating/Estimating energy took 0.836 ms, Etot = -17.486035996, dEtot = 2.046e-06, dEband = 2.150e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0239575529642, which took 0.127 ms

iter_count = 108, r_2norm = 5.700e-07, tol*||rhs|| = 9.583e-07

Anderson update took 45.640 ms, out of which F'*F took 24.552 ms; b-Ax took 161.875 ms, out of which Lap took 147.458 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 321.849 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = 0.000e+00, checking this took 0.080 ms
2-norm of RHS = 479.2559602875711, which took 0.076 ms

iter_count = 90, r_2norm = 4.240e-04, tol*||rhs|| = 4.793e-04

Anderson update took 37.852 ms, out of which F'*F took 20.814 ms; b-Ax took 137.741 ms, out of which Lap took 124.593 ms
Solving Poisson took 260.226 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.240 ms
Total time for convolution: 	 convolve: 5.117470 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.291 ms
Total time for convolution: 	 convolve: 5.113278 
Total time for convolution: 	 convolve: 5.114845 
Total time for convolution: 	 convolve: 5.091748 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.833 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.575 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.216 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.254 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.241 ms
---Transfer Veff_loc: D2D took 3.607 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.115 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.755 ms

This SCF took 25734.163 ms, scf error = 1.599e-04
-------------
SCF iter 18  
-------------

 Chebfilt 21, in Chebyshev filtering, lambda_cutoff = 0.134406, lowerbound = -0.846720, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 671.948 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 6.991 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.068 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.071 ms
rank =  0, finding HY took 11.996 ms
rank =  0, distributing HY into block cyclic form took 6.939 ms
rank =  0, finding Y'*HY took 2.439 ms
Rank 0, Project_Hamiltonian used 30.467 ms
Total time for projection: 30.477 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.072 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.131 ms
rank = 0, Solve_Generalized_EigenProblem used 0.206 ms
    first calculated eigval = -0.846693543066802
    last  calculated eigval = 0.033301628014676
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84669354306680
lambda[   2] =  -0.56204700196491
lambda[   3] =  -0.42675776796256
lambda[   4] =  -0.33749802100497
lambda[   5] =  -0.31742838361897
lambda[   6] =  -0.14351624071044
lambda[   7] =  -0.05502235108888
lambda[   8] =  -0.01922535497268
lambda[   9] =   0.00661332360396
lambda[  10] =   0.03131821583876
lambda[  11] =   0.03330162801468
==subpsace eigenproblem: bcast eigvals took 0.013 ms
Total time for solving subspace eigenvalue problem: 0.234 ms
rank =  0, subspace rotation using ScaLAPACK took 1.944 ms
rank =  0, Distributing orbital back into band + domain format took 6.840 ms
rank = 0, Subspace_Rotation used 8.796 ms

Total time for subspace rotation: 8.801 ms
rank = 0, Efermi =  -0.143516240641 calculate fermi energy took 0.058 ms
rank = 0, --- Calculate rho: sum over local bands took 1.656 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.765 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.585 ms
rank = 0, Calculating density took 725.578 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.755 ms
rank = 0, D2D took 1.883 ms
rank = 0, Transfering density took 1.885 ms
Etot    =   -17.486038302493
Eband   =    -5.124365677480
E1      =    12.059027447217
E2      =    -4.733136765702
E3      =    -6.454210577899
Exc     =    -5.776351193246
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 5.766e-07, dEband = 3.868e-05
rank = 0, Calculating/Estimating energy took 0.834 ms, Etot = -17.486038302, dEtot = 5.766e-07, dEband = 3.868e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0127160194937, which took 0.045 ms

iter_count = 114, r_2norm = 3.240e-07, tol*||rhs|| = 5.086e-07

Anderson update took 47.822 ms, out of which F'*F took 25.678 ms; b-Ax took 169.518 ms, out of which Lap took 155.094 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 328.872 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = -5.457e-15, checking this took 0.098 ms
2-norm of RHS = 479.2566690548732, which took 0.103 ms

iter_count = 108, r_2norm = 4.756e-04, tol*||rhs|| = 4.793e-04

Anderson update took 44.297 ms, out of which F'*F took 24.173 ms; b-Ax took 160.047 ms, out of which Lap took 146.113 ms
Solving Poisson took 304.697 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.237 ms
Total time for convolution: 	 convolve: 5.107058 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.181967 
Total time for convolution: 	 convolve: 5.154048 
Total time for convolution: 	 convolve: 5.081460 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.816 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.540 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.060 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.236 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.579 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.097 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.709 ms

This SCF took 25866.445 ms, scf error = 1.074e-04
-------------
SCF iter 19  
-------------

 Chebfilt 22, in Chebyshev filtering, lambda_cutoff = 0.133302, lowerbound = -0.846694, upperbound = 267.570376

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (1 columns, degree = 45): 672.019 ms
New BLOCK CYCLIC DOMAIN: nproc = 11, dims = (11, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 6.988 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 2.093 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 9.091 ms
rank =  0, finding HY took 11.961 ms
rank =  0, distributing HY into block cyclic form took 6.964 ms
rank =  0, finding Y'*HY took 2.406 ms
Rank 0, Project_Hamiltonian used 30.455 ms
Total time for projection: 30.464 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.071 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.114 ms
rank = 0, Solve_Generalized_EigenProblem used 0.189 ms
    first calculated eigval = -0.846664424753014
    last  calculated eigval = 0.032970458906836
The last 11 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 11):
lambda[   1] =  -0.84666442475301
lambda[   2] =  -0.56202714335912
lambda[   3] =  -0.42674116754378
lambda[   4] =  -0.33747730310807
lambda[   5] =  -0.31740513489865
lambda[   6] =  -0.14350520992674
lambda[   7] =  -0.05503620739554
lambda[   8] =  -0.02008647726388
lambda[   9] =   0.00555457679126
lambda[  10] =   0.03075259826488
lambda[  11] =   0.03297045890684
==subpsace eigenproblem: bcast eigvals took 0.021 ms
Total time for solving subspace eigenvalue problem: 0.217 ms
rank =  0, subspace rotation using ScaLAPACK took 1.947 ms
rank =  0, Distributing orbital back into band + domain format took 6.827 ms
rank = 0, Subspace_Rotation used 8.785 ms

Total time for subspace rotation: 8.791 ms
rank = 0, Efermi =  -0.143505209857 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 1.643 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.843 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.558 ms
rank = 0, Calculating density took 725.652 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.754 ms
rank = 0, D2D took 1.892 ms
rank = 0, Transfering density took 1.894 ms
Etot    =   -17.486038299017
Eband   =    -5.124135558785
E1      =    12.058881058139
E2      =    -4.733038497845
E3      =    -6.454255397816
Exc     =    -5.776381471448
Esc     =   -29.827549505630
Entropy =    -0.004146716955
dE = 8.689e-10, dEband = 5.753e-05
rank = 0, Calculating/Estimating energy took 0.844 ms, Etot = -17.486038299, dEtot = 8.689e-10, dEband = 5.753e-05
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0110695548638, which took 0.047 ms

iter_count = 108, r_2norm = 3.717e-07, tol*||rhs|| = 4.428e-07

Anderson update took 45.526 ms, out of which F'*F took 24.342 ms; b-Ax took 159.740 ms, out of which Lap took 146.182 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 310.561 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -11.00000001068024, int_rho =  11.00000001068024, int_b + int_rho = -1.819e-15, checking this took 0.093 ms
2-norm of RHS = 479.2566285438521, which took 0.098 ms

iter_count = 126, r_2norm = 4.311e-04, tol*||rhs|| = 4.793e-04

Anderson update took 52.029 ms, out of which F'*F took 28.267 ms; b-Ax took 185.798 ms, out of which Lap took 169.732 ms
Solving Poisson took 355.979 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Total time for convolution: 	 convolve: 5.072524 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.780 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.298 ms
Total time for convolution: 	 convolve: 5.069659 
Total time for convolution: 	 convolve: 5.082095 
Total time for convolution: 	 convolve: 5.070347 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.558 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.077 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.164 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.250 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.235 ms
---Transfer Veff_loc: D2D took 3.547 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.107 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 5.690 ms

This SCF took 25668.074 ms, scf error = 7.849e-05
The last 11 occupations of kpoints #1 are (Nelectron = 11):
lambda[   1] =  -0.84666442475301, occ[   1] =   2.00000000000000
lambda[   2] =  -0.56202714335912, occ[   2] =   2.00000000000000
lambda[   3] =  -0.42674116754378, occ[   3] =   2.00000000000000
lambda[   4] =  -0.33747730310807, occ[   4] =   2.00000000000000
lambda[   5] =  -0.31740513489865, occ[   5] =   2.00000000000000
lambda[   6] =  -0.14350520992674, occ[   6] =   1.00000001068024
lambda[   7] =  -0.05503620739554, occ[   7] =   0.00000000000000
lambda[   8] =  -0.02008647726388, occ[   8] =   0.00000000000000
lambda[   9] =   0.00555457679126, occ[   9] =   0.00000000000000
lambda[  10] =   0.03075259826488, occ[  10] =   0.00000000000000
lambda[  11] =   0.03297045890684, occ[  11] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 10 (90%) = 0.000000000000000.
Occupation of state 11 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.265 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.279 ms, time for Allreduce/Reduce: 4.657 ms 
Time for calculating local force components: 11.032 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.04018944392256  -0.02944220951793  -0.00000000275192
  0.05570974361665   0.02968632842546   0.00000000296816
  0.17956478111371  -0.20423262388528  -0.00000075360164
 -0.49521369400207   0.42307746352029  -0.00000011800165
force_loc = 
  0.04509740423805   0.03252736431210  -0.00000028883110
 -0.05923473431318  -0.03636530196234   0.00000057567389
 -0.17766549043068   0.20016980689072   0.00000717301077
  0.48268510918118  -0.40693639594147  -0.00000131440453
Time for calculating nonlocal force components: 17.275 ms
[32mforces_xc: 
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m -0.00339831286461  -0.00452371914990   0.00000030790563
[0m[32m  0.01266099286999  -0.00396213040107  -0.00000004824996
[0mTime for calculating XC forces components: 13.408 ms
 Cartesian force = 
  0.00490387144386   0.00308550922152  -0.00000167501243
 -0.00352907956815  -0.00667861910952  -0.00000080478736
 -0.00150311105320  -0.00858618171710   0.00000534388534
  0.00012831917748   0.01217929160510  -0.00000286408555
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.282 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.202 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.182 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.180 ms
Time for printing density: 387.579 ms
The program took 527.162 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:30:41
Job ID:        2266792
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:47:24,vmem=8472K,walltime=00:08:57,mem=8168K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-004-13-2
---------------------------------------
