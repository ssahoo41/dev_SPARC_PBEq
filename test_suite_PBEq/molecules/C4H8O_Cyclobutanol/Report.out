---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:39
Job ID:    2266652
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------
---------------------------------------
Begin Slurm Prolog: Jun-01-2023 11:20:43
Job ID:    2266652
User ID:   ssahoo41
Account:   gts-amedford6-joe
Job name:  molecule_functional
Partition: cpu-small
QOS:       inferno
---------------------------------------

Creating SPARC_INPUT_MPI datatype took 0.054 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 0.014 ms

Set default values took 0.003 ms
Reading input file sprc-calc.inpt

Reading input file took 21.302 ms
Reading ion file sprc-calc.ion
Number of atom types : 3.
Total number of atoms: 13.
[32m
Time for finding element is 0.007 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type H is H
[0m[32mDefault atomic mass for H is 1.007975
[0m[32m
Time for finding element is 0.000 ms
[32mElement type for atom_type C is C
[0m[32mDefault atomic mass for C is 12.010600
[0mpseudo_dir # 1 = O.psp8
pseudo_dir # 2 = H.psp8
pseudo_dir # 3 = C.psp8

Reading ion file took 12.506 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: O.psp8
Input element type: O
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.35246, change to rmax where |UdV| < 1E-8, 1.37000.
l = 1, r_core read 1.45312, change to rmax where |UdV| < 1E-8, 1.47000.
l = 2, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.
Reading pseudopotential: H.psp8
Input element type: H
pspcod = 8, pspxc = 11
l = 0, r_core read 1.03328, change to rmax where |UdV| < 1E-8, 1.05000.
l = 1, r_core read 1.00283, change to rmax where |UdV| < 1E-8, 1.02000.
Reading pseudopotential: C.psp8
Input element type: C
pspcod = 8, pspxc = 11

fchrg = 4.00000000 > 0.0 (icmod != 0)
This pseudopotential contains non-linear core correction. 

fchrg = 4.000000, READING MODEL CORE CHARGE!

l = 0, r_core read 1.20716, change to rmax where |UdV| < 1E-8, 1.22000.
l = 1, r_core read 1.25127, change to rmax where |UdV| < 1E-8, 1.27000.

Reading pseudopotential file took 65.343 ms

Freeing SPARC_INPUT_MPI datatype took 0.008 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 1.592 ms
M_val = 1000000.000000N_val = 15.000000[33m
WARNING: Pseudopotential file for atom type O has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type H has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0m[33m
WARNING: Pseudopotential file for atom type C has pspxc = 11,
not equal to input ixc = 0 (GGA_CONV_PBE_MULTIPOLE). Be careful with the result.
[0mspin_typ: 0, SOC_flag: 0, Nspin: 1, Nspinor: 1, Nspden: 1, occfac 2.00

Checking existence of (0) out file(s) took 0.325 ms


CELL_TYP: 0


Range:
   20.000000	   20.000000	   20.000000

COORD AFTER MAPPING:
    8.347109	   13.878623	   10.000000	
   12.015167	   12.996788	   10.000000	
   11.320396	   10.189727	   13.763548	
    8.267109	    9.412059	   12.595433	
   11.320396	   10.189727	    6.236452	
    8.267109	    9.412059	    7.404567	
   13.278844	    7.953529	   10.000000	
   10.473442	    6.121377	   10.000000	
    6.721156	   13.060946	   10.000000	
   10.207929	   11.989668	   10.000000	
   10.207929	    9.890317	   12.050391	
   10.207929	    9.890317	    7.949609	
   11.214942	    8.045904	   10.000000	

Max eigenvalue of -0.5*Lap is 265.2352092352092, time taken: 0.005 ms
Chebyshev polynomial degree (provided by user): npl = 45
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 0.433 ms
Set up communicators.

--set up spincomm took 0.056 ms

--set up kptcomm took 0.355 ms

 kpt_topo #0, kptcomm topology dims = {2, 2, 3}, nodes/proc = {50.00,50.00,33.33}

--set up bandcomm took 0.009 ms
rank = 0, dmcomm dims = {1, 1, 1}
gridsizes = [100, 100, 100], Nstates = 23, dmcomm dims = [1, 1, 1]

--set up dmcomm took 0.003 ms

--set up blacscomm took 0.009 ms
rank = 0, size_blacscomm = 12, ScaLAPACK topology Dims = (12, 1)
nproc = 12, size_blacscomm = 12 = dims[0] * dims[1] = (12, 1)
Nd_blacscomm 1000000, Nstates 23 
rank =  0, my blacs rank = 0, BLCYC size (1000000, 2), actual size (1000000, 2)
rank = 0, mb = nb = 23, mbQ = nbQ = 64
rank = 0, nr_Hp = 23, nc_Hp = 23
========================================================================
Poisson domain decomposition:np total = 12, {Nx, Ny, Nz} = {100, 100, 100}
nproc used = 12 = {2, 2, 3}, nodes/proc = {50.00, 50.00, 33.33}


--set up dmcomm_phi took 0.077 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.048 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 12
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 12
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 12
# of bands per bandcomm          : 2
npdomain: 1
Embeded Cartesian topology dims: (1,1,1)
# of FD-grid points per processor: 1000000 = (100,100,100)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 12
Embeded Cartesian topology dims: (2,2,3)
# of FD-grid points per processor: 85000 = (50,50,34)
-----------------------------------------------

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 5.083 ms

Calculate_SplineDerivRadFun took 0.208 ms
Rbmax_x = 12.000000, Rbmax_y = 12.000000, Rbmax_z = 12.000000
rlen_ex = 373248, nxp = 72, nyp = 72, nzp = 72
time spent on qsort: 1.892 ms.
time spent on vectorized spline interp: 3.424 ms.
Z = 6,rb_x = 6.735000,rb_y = 6.735000,rb_z = 6.735000,error = 4.498E-08,Bint = -5.9999999550239
Z = 6,rb_x = 4.102500,rb_y = 4.102500,rb_z = 4.102500,error = 1.668E-05,Bint = -6.0000166827181
Z = 6,rb_x = 5.418750,rb_y = 5.418750,rb_z = 5.418750,error = 2.081E-05,Bint = -6.0000208139585
Z = 6,rb_x = 6.076875,rb_y = 6.076875,rb_z = 6.076875,error = 8.482E-06,Bint = -6.0000084824936
Z = 6,rb_x = 6.405938,rb_y = 6.405938,rb_z = 6.405938,error = 2.149E-07,Bint = -6.0000002149401
Z = 6,rb_x = 6.570469,rb_y = 6.570469,rb_z = 6.570469,error = 2.149E-07,Bint = -6.0000002149401
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 0, converged in 6 iters, err_cur = 4.50E-08, TOL = 1.00E-07, rb = {6.735000, 6.735000, 6.735000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.732 ms.
time spent on vectorized spline interp: 1.589 ms.
Z = 1,rb_x = 6.525000,rb_y = 6.525000,rb_z = 6.525000,error = 2.105E-13,Bint = -1.0000000000002
Z = 1,rb_x = 3.787500,rb_y = 3.787500,rb_z = 3.787500,error = 2.241E-08,Bint = -0.9999999775947
Z = 1,rb_x = 2.418750,rb_y = 2.418750,rb_z = 2.418750,error = 1.204E-05,Bint = -1.0000120416347
Z = 1,rb_x = 3.103125,rb_y = 3.103125,rb_z = 3.103125,error = 4.230E-06,Bint = -1.0000042302140
Z = 1,rb_x = 3.445312,rb_y = 3.445312,rb_z = 3.445312,error = 1.064E-07,Bint = -1.0000001064153
Z = 1,rb_x = 3.616406,rb_y = 3.616406,rb_z = 3.616406,error = 2.241E-08,Bint = -0.9999999775947
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 6 iters, err_cur = 2.24E-08, TOL = 1.00E-07, rb = {3.616406, 3.616406, 3.616406}, after proj to grid rb = {3.800000, 3.800000, 3.800000}
time for finding rb using bisection: 2.317 ms.
time spent on vectorized spline interp: 1.862 ms.
Z = 4,rb_x = 6.635000,rb_y = 6.635000,rb_z = 6.635000,error = 3.185E-08,Bint = -3.9999999681490
Z = 4,rb_x = 3.952500,rb_y = 3.952500,rb_z = 3.952500,error = 9.295E-06,Bint = -4.0000092954588
Z = 4,rb_x = 5.293750,rb_y = 5.293750,rb_z = 5.293750,error = 1.410E-05,Bint = -4.0000141026792
Z = 4,rb_x = 5.964375,rb_y = 5.964375,rb_z = 5.964375,error = 1.338E-05,Bint = -4.0000133762367
Z = 4,rb_x = 6.299687,rb_y = 6.299687,rb_z = 6.299687,error = 7.226E-07,Bint = -3.9999992774061
Z = 4,rb_x = 6.467344,rb_y = 6.467344,rb_z = 6.467344,error = 1.525E-07,Bint = -4.0000001524699
dx = 0.200000, dy = 0.200000, dz = 0.200000, Ncube_x = 34, Ncube_y = 34, Ncube_z = 34
ityp = 2, converged in 6 iters, err_cur = 3.19E-08, TOL = 1.00E-07, rb = {6.635000, 6.635000, 6.635000}, after proj to grid rb = {6.800000, 6.800000, 6.800000}
time for finding rb using bisection: 2.554 ms.

Calculating rb for all atom types took 16.380 ms
----------------------
Estimated memory usage
Total: 1.36 GB
orbitals             : 1.03 GB
global sized vectors : 213.62 MB
subspace matrices : 12.40 kB
others : 126.65 MB
----------------------------------------------
Estimated memory usage per processor: 116.10 MB
Start ground-state calculation.

Computing nearest neighbor distance (1.820 Bohr) takes 0.001 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 0.018 ms
Calculating pseudocharge density ... 
the global sum of int_b = -30.0000000384412, sum_int_rho = 29.1965422720569
PosCharge = 30.000000038441, NegCharge = -29.196542272057, scal_fac = 1.027518935595
After scaling, int_rho = 30.0000000384412, PosCharge + NegCharge - NetCharge = 7.105e-15
--Calculate Vref took 0.622 ms
--Calculate rho_guess took 3.229 ms

 integral of b = -30.0000000384412,
 int{b} + Nelectron + NetCharge = -3.844e-08,
 Esc = -77.0491010127096,
 MPI_Reduce took 9.403 ms

Calculating b & b_ref took 20.542 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.087 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 0.097 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.096 ms
[0m
Calculating nonlocal projectors in psi-domain took 0.733 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 0.006 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 0.008 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.000 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 0.005 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 45.572 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844129, int_b + int_rho = -1.091e-13, checking this took 0.337 ms
2-norm of RHS = 852.5884944968722, which took 0.500 ms

iter_count = 420, r_2norm = 7.173e-04, tol*||rhs|| = 8.526e-04

Anderson update took 284.332 ms, out of which F'*F took 141.380 ms; b-Ax took 913.363 ms, out of which Lap took 816.023 ms
Solving Poisson took 2049.272 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.837 ms
Total time for convolution: 	 convolve: 5.127777 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.649 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.806 ms
Total time for convolution: 	 convolve: 5.132790 
Total time for convolution: 	 convolve: 5.115335 
Total time for convolution: 	 convolve: 5.113444 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.746 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.554 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.207 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.398 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.342 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.219 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
rank = 0, XC calculation took 24417.380 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.010 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.258 ms
---Transfer Veff_loc: D2D took 4.885 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 10.172 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 16.197 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 2.168 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.006 ms
rank =  0, One H*x took 1.930 ms
    Lanczos iter 54, eigmin  = -0.949616662, eigmax = 264.938378685, err_eigmin = 1.198e-03, err_eigmax = 9.709e-03
rank =   0, Lanczos took 139.567 ms, eigmin = -0.949616662333, eigmax = 267.587762471802

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 133.269073, lowerbound = -1.049617, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1856.960 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 24.574 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.540 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 28.142 ms
rank =  0, finding HY took 41.400 ms
rank =  0, distributing HY into block cyclic form took 23.142 ms
rank =  0, finding Y'*HY took 6.795 ms
Rank 0, Project_Hamiltonian used 100.435 ms
Total time for projection: 100.463 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.822 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.930 ms
    first calculated eigval = 2.700335862291750
    last  calculated eigval = 3.270106376170991
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =   2.84246727184110
lambda[   7] =   2.87903359397534
lambda[   8] =   2.89444715838640
lambda[   9] =   2.91766216437338
lambda[  10] =   2.95131780330232
lambda[  11] =   2.96739490618759
lambda[  12] =   2.97942122734825
lambda[  13] =   3.00059996439015
lambda[  14] =   3.01463992345107
lambda[  15] =   3.05266863277208
lambda[  16] =   3.06790481123824
lambda[  17] =   3.10241230964737
lambda[  18] =   3.12748004459019
lambda[  19] =   3.15542877899547
lambda[  20] =   3.15917231508719
lambda[  21] =   3.17037062282972
lambda[  22] =   3.22192035394564
lambda[  23] =   3.27010637617099
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.949 ms
rank =  0, subspace rotation using ScaLAPACK took 10.838 ms
rank =  0, Distributing orbital back into band + domain format took 22.954 ms
rank = 0, Subspace_Rotation used 33.815 ms

Total time for subspace rotation: 33.820 ms
rank = 0, Efermi =   3.060286722372 calculate fermi energy took 0.076 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 3.370106, lowerbound = -1.049617, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1858.782 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.015 ms
rank =  0, Distribute orbital to block cyclic format took 22.885 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.333 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.248 ms
rank =  0, finding HY took 30.169 ms
rank =  0, distributing HY into block cyclic form took 22.590 ms
rank =  0, finding Y'*HY took 5.817 ms
Rank 0, Project_Hamiltonian used 84.876 ms
Total time for projection: 84.880 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.187 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.103 ms
rank = 0, Solve_Generalized_EigenProblem used 0.295 ms
    first calculated eigval = -0.781535395686308
    last  calculated eigval = 0.469212821102804
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.24488239973742
lambda[   7] =  -0.18361074459725
lambda[   8] =  -0.11825209966975
lambda[   9] =  -0.02526915055440
lambda[  10] =   0.02755098556403
lambda[  11] =   0.13577530470177
lambda[  12] =   0.15097299324742
lambda[  13] =   0.22778041757807
lambda[  14] =   0.24053501544791
lambda[  15] =   0.25411050286933
lambda[  16] =   0.29239462177029
lambda[  17] =   0.31949995597826
lambda[  18] =   0.35627575754198
lambda[  19] =   0.36478513379851
lambda[  20] =   0.38280920801635
lambda[  21] =   0.41789223827284
lambda[  22] =   0.43421727860247
lambda[  23] =   0.46921282110280
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.306 ms
rank =  0, subspace rotation using ScaLAPACK took 10.739 ms
rank =  0, Distributing orbital back into band + domain format took 23.073 ms
rank = 0, Subspace_Rotation used 33.834 ms

Total time for subspace rotation: 33.839 ms
rank = 0, Efermi =   0.273252673709 calculate fermi energy took 0.045 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.569213, lowerbound = -1.049617, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1851.340 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 22.985 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.224 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.236 ms
rank =  0, finding HY took 30.064 ms
rank =  0, distributing HY into block cyclic form took 22.579 ms
rank =  0, finding Y'*HY took 5.860 ms
Rank 0, Project_Hamiltonian used 84.777 ms
Total time for projection: 84.791 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.245 ms
    first calculated eigval = -0.982047456518224
    last  calculated eigval = 0.160221803789960
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.54957102010203
lambda[   7] =  -0.51823196173389
lambda[   8] =  -0.44153455504664
lambda[   9] =  -0.43809875736148
lambda[  10] =  -0.42879760235338
lambda[  11] =  -0.41232824637057
lambda[  12] =  -0.38749368548188
lambda[  13] =  -0.35785482669358
lambda[  14] =  -0.32523102684045
lambda[  15] =  -0.24004949293760
lambda[  16] =   0.03565065286866
lambda[  17] =   0.05506317065881
lambda[  18] =   0.06671296060575
lambda[  19] =   0.10040062071971
lambda[  20] =   0.12255797011332
lambda[  21] =   0.13092306882400
lambda[  22] =   0.15220893051658
lambda[  23] =   0.16022180378996
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.264 ms
rank =  0, subspace rotation using ScaLAPACK took 10.775 ms
rank =  0, Distributing orbital back into band + domain format took 23.084 ms
rank = 0, Subspace_Rotation used 33.882 ms

Total time for subspace rotation: 33.887 ms
rank = 0, Efermi =   0.007077473182 calculate fermi energy took 0.067 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.260222, lowerbound = -1.049617, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1858.416 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.001 ms
rank =  0, Distribute orbital to block cyclic format took 23.925 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.393 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 27.346 ms
rank =  0, finding HY took 30.080 ms
rank =  0, distributing HY into block cyclic form took 22.526 ms
rank =  0, finding Y'*HY took 5.810 ms
Rank 0, Project_Hamiltonian used 85.797 ms
Total time for projection: 85.802 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.982344060173874
    last  calculated eigval = 0.089673345731078
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.55287674194107
lambda[   7] =  -0.53094094174498
lambda[   8] =  -0.45040358685081
lambda[   9] =  -0.44522975024507
lambda[  10] =  -0.44349640518290
lambda[  11] =  -0.43929857114705
lambda[  12] =  -0.39722253840138
lambda[  13] =  -0.38792373059962
lambda[  14] =  -0.34215186471272
lambda[  15] =  -0.28833761075571
lambda[  16] =  -0.00810548322528
lambda[  17] =   0.00380849590541
lambda[  18] =   0.01610870195137
lambda[  19] =   0.04387735635084
lambda[  20] =   0.05891774911220
lambda[  21] =   0.07166532049871
lambda[  22] =   0.08184108039660
lambda[  23] =   0.08967334573108
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.256 ms
rank =  0, subspace rotation using ScaLAPACK took 11.258 ms
rank =  0, Distributing orbital back into band + domain format took 22.893 ms
rank = 0, Subspace_Rotation used 34.176 ms

Total time for subspace rotation: 34.183 ms
rank = 0, Efermi =  -0.036678663125 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 7.010 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.160 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.601 ms
rank = 0, Calculating density took 8083.848 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.949 ms
rank = 0, D2D took 2.055 ms
rank = 0, Transfering density took 2.062 ms
Etot    =   -45.510209409847
Eband   =   -16.291281774959
E1      =    33.373569546364
E2      =   -12.541520418897
E3      =   -16.904443384741
Exc     =   -14.989359971048
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 3.501e+00, dEband = 1.253e+00
rank = 0, Calculating/Estimating energy took 1.079 ms, Etot = -45.510209410, dEtot = 3.501e+00, dEband = 1.253e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 59.5949298592400, which took 0.400 ms

iter_count = 96, r_2norm = 1.922e-03, tol*||rhs|| = 2.384e-03

Anderson update took 64.034 ms, out of which F'*F took 27.108 ms; b-Ax took 185.787 ms, out of which Lap took 163.267 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 445.741 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844119, int_b + int_rho = -2.074e-13, checking this took 0.127 ms
2-norm of RHS = 848.0247982668011, which took 1.121 ms

iter_count = 288, r_2norm = 7.106e-04, tol*||rhs|| = 8.480e-04

Anderson update took 181.886 ms, out of which F'*F took 80.516 ms; b-Ax took 544.619 ms, out of which Lap took 487.010 ms
Solving Poisson took 1268.988 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.410 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.340 ms
Total time for convolution: 	 convolve: 5.194255 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.358 ms
Total time for convolution: 	 convolve: 5.295515 
Total time for convolution: 	 convolve: 5.151619 
Total time for convolution: 	 convolve: 5.179480 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.319 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.057 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.906 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.105 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.191 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.522 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.096 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.651 ms

This SCF took 34603.925 ms, scf error = 1.735e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.189673, lowerbound = -0.982344, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1795.478 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.017 ms
rank =  0, Distribute orbital to block cyclic format took 46.915 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.327 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 50.267 ms
rank =  0, finding HY took 29.438 ms
rank =  0, distributing HY into block cyclic form took 22.962 ms
rank =  0, finding Y'*HY took 6.207 ms
Rank 0, Project_Hamiltonian used 108.925 ms
Total time for projection: 108.951 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.161 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.251 ms
    first calculated eigval = -0.967571945354540
    last  calculated eigval = 0.062271418699929
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.52460295924253
lambda[   7] =  -0.50474163806750
lambda[   8] =  -0.42265879394166
lambda[   9] =  -0.42087132272474
lambda[  10] =  -0.41700728838388
lambda[  11] =  -0.41205427963437
lambda[  12] =  -0.36495674557981
lambda[  13] =  -0.36277559386714
lambda[  14] =  -0.31771783044532
lambda[  15] =  -0.26705852971582
lambda[  16] =  -0.02746558372802
lambda[  17] =  -0.00658175766859
lambda[  18] =   0.00065588974787
lambda[  19] =   0.01374413289799
lambda[  20] =   0.03720935611973
lambda[  21] =   0.04571564932734
lambda[  22] =   0.05515445540674
lambda[  23] =   0.06227141869993
==subpsace eigenproblem: bcast eigvals took 0.007 ms
Total time for solving subspace eigenvalue problem: 0.267 ms
rank =  0, subspace rotation using ScaLAPACK took 11.060 ms
rank =  0, Distributing orbital back into band + domain format took 22.844 ms
rank = 0, Subspace_Rotation used 33.929 ms

Total time for subspace rotation: 33.937 ms
rank = 0, Efermi =  -0.056038763417 calculate fermi energy took 0.070 ms
rank = 0, --- Calculate rho: sum over local bands took 6.910 ms
rank = 0, --- Calculate rho: reduce over all band groups took 13.143 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.629 ms
rank = 0, Calculating density took 1960.209 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.003 ms
rank = 0, D2D took 2.110 ms
rank = 0, Transfering density took 2.115 ms
Etot    =   -45.444441895708
Eband   =   -15.493844124408
E1      =    32.668783719915
E2      =   -12.475441632872
E3      =   -17.116966734017
Exc     =   -15.162688844261
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 5.059e-03, dEband = 6.134e-02
rank = 0, Calculating/Estimating energy took 1.080 ms, Etot = -45.444441896, dEtot = 5.059e-03, dEband = 6.134e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 17.8723560461142, which took 0.058 ms

iter_count = 102, r_2norm = 6.450e-04, tol*||rhs|| = 7.149e-04

Anderson update took 67.065 ms, out of which F'*F took 28.763 ms; b-Ax took 194.268 ms, out of which Lap took 172.043 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 466.029 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844116, int_b + int_rho = -2.401e-13, checking this took 0.144 ms
2-norm of RHS = 840.8301147372088, which took 0.128 ms

iter_count = 306, r_2norm = 7.485e-04, tol*||rhs|| = 8.408e-04

Anderson update took 186.637 ms, out of which F'*F took 85.218 ms; b-Ax took 579.758 ms, out of which Lap took 519.201 ms
Solving Poisson took 1333.060 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.030 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.310 ms
Total time for convolution: 	 convolve: 5.134072 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 69.676 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.357 ms
Total time for convolution: 	 convolve: 5.147359 
Total time for convolution: 	 convolve: 5.149343 
Total time for convolution: 	 convolve: 5.140820 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.954 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.395 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.022 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.199 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.220 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.193 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.277 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.227 ms
---Transfer Veff_loc: D2D took 3.487 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.091 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.610 ms

This SCF took 28429.079 ms, scf error = 1.213e-01
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.162271, lowerbound = -0.967572, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1817.374 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 35.443 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.713 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 39.177 ms
rank =  0, finding HY took 29.609 ms
rank =  0, distributing HY into block cyclic form took 22.901 ms
rank =  0, finding Y'*HY took 5.641 ms
Rank 0, Project_Hamiltonian used 97.366 ms
Total time for projection: 97.388 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.679 ms
    first calculated eigval = -0.943971336525958
    last  calculated eigval = 0.060610557068544
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.47122109573113
lambda[   7] =  -0.45206313789288
lambda[   8] =  -0.37647483941241
lambda[   9] =  -0.36845541617030
lambda[  10] =  -0.36350905195709
lambda[  11] =  -0.36258548753433
lambda[  12] =  -0.30937283358440
lambda[  13] =  -0.30100972838830
lambda[  14] =  -0.27014420004494
lambda[  15] =  -0.22856166917255
lambda[  16] =  -0.03078412332163
lambda[  17] =  -0.00406888289102
lambda[  18] =   0.00264388955328
lambda[  19] =   0.01280452608221
lambda[  20] =   0.02192347995842
lambda[  21] =   0.04044070969052
lambda[  22] =   0.05188866771031
lambda[  23] =   0.06061055706854
==subpsace eigenproblem: bcast eigvals took 0.014 ms
Total time for solving subspace eigenvalue problem: 0.697 ms
rank =  0, subspace rotation using ScaLAPACK took 10.618 ms
rank =  0, Distributing orbital back into band + domain format took 22.822 ms
rank = 0, Subspace_Rotation used 33.464 ms

Total time for subspace rotation: 33.472 ms
rank = 0, Efermi =  -0.059357303038 calculate fermi energy took 0.067 ms
rank = 0, --- Calculate rho: sum over local bands took 6.852 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.940 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.602 ms
rank = 0, Calculating density took 1970.016 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.000 ms
rank = 0, D2D took 2.105 ms
rank = 0, Transfering density took 2.113 ms
Etot    =   -45.382911540935
Eband   =   -13.960153665654
E1      =    31.367928235391
E2      =   -12.214908209651
E3      =   -17.592716424342
Exc     =   -15.549209730823
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 4.733e-03, dEband = 1.180e-01
rank = 0, Calculating/Estimating energy took 1.053 ms, Etot = -45.382911541, dEtot = 4.733e-03, dEband = 1.180e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 6.0080644220191, which took 0.066 ms

iter_count = 102, r_2norm = 2.376e-04, tol*||rhs|| = 2.403e-04

Anderson update took 64.414 ms, out of which F'*F took 30.060 ms; b-Ax took 204.941 ms, out of which Lap took 180.769 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 465.324 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844124, int_b + int_rho = -1.601e-13, checking this took 0.136 ms
2-norm of RHS = 841.1887908415073, which took 0.123 ms

iter_count = 270, r_2norm = 8.271e-04, tol*||rhs|| = 8.412e-04

Anderson update took 167.142 ms, out of which F'*F took 81.602 ms; b-Ax took 554.537 ms, out of which Lap took 501.788 ms
Solving Poisson took 1238.988 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.319 ms
Total time for convolution: 	 convolve: 5.157689 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 60.198 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 1.676 ms
Total time for convolution: 	 convolve: 5.159842 
Total time for convolution: 	 convolve: 5.156813 
Total time for convolution: 	 convolve: 5.165403 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.339 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.349 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.023 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.011 ms
======D2D: initiated sending and receiving took 0.242 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.179 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.350 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.525 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 5.059 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 8.616 ms

This SCF took 28399.078 ms, scf error = 3.749e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.160611, lowerbound = -0.943971, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1799.353 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.007 ms
rank =  0, Distribute orbital to block cyclic format took 48.605 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.332 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 52.493 ms
rank =  0, finding HY took 29.423 ms
rank =  0, distributing HY into block cyclic form took 22.648 ms
rank =  0, finding Y'*HY took 5.517 ms
Rank 0, Project_Hamiltonian used 110.126 ms
Total time for projection: 110.143 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.152 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.105 ms
rank = 0, Solve_Generalized_EigenProblem used 0.261 ms
    first calculated eigval = -0.942555021249265
    last  calculated eigval = 0.055396720490986
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.46275564267603
lambda[   7] =  -0.44200624782027
lambda[   8] =  -0.36751957029828
lambda[   9] =  -0.36156131816361
lambda[  10] =  -0.35576145141277
lambda[  11] =  -0.35224403016755
lambda[  12] =  -0.29873942045952
lambda[  13] =  -0.29274973910690
lambda[  14] =  -0.26299418474121
lambda[  15] =  -0.22604485208257
lambda[  16] =  -0.03131120634931
lambda[  17] =  -0.00370249512663
lambda[  18] =   0.00322148845234
lambda[  19] =   0.01197373230964
lambda[  20] =   0.01729396337029
lambda[  21] =   0.03392032313525
lambda[  22] =   0.04855927880066
lambda[  23] =   0.05539672049099
==subpsace eigenproblem: bcast eigvals took 0.008 ms
Total time for solving subspace eigenvalue problem: 0.277 ms
rank =  0, subspace rotation using ScaLAPACK took 10.668 ms
rank =  0, Distributing orbital back into band + domain format took 22.652 ms
rank = 0, Subspace_Rotation used 33.340 ms

Total time for subspace rotation: 33.346 ms
rank = 0, Efermi =  -0.059884386061 calculate fermi energy took 0.061 ms
rank = 0, --- Calculate rho: sum over local bands took 7.027 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.621 ms
rank = 0, --- Scale rho: scale by 1/dV took 2.538 ms
rank = 0, Calculating density took 1965.456 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.013 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 2.152 ms
rank = 0, D2D took 2.276 ms
rank = 0, Transfering density took 2.280 ms
Etot    =   -45.377840140348
Eband   =   -13.719466164399
E1      =    31.237968878188
E2      =   -12.088119489438
E3      =   -17.678438513668
Exc     =   -15.613799843401
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 3.901e-04, dEband = 1.851e-02
rank = 0, Calculating/Estimating energy took 1.031 ms, Etot = -45.377840140, dEtot = 3.901e-04, dEband = 1.851e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.8854743091836, which took 0.054 ms

iter_count = 108, r_2norm = 8.804e-05, tol*||rhs|| = 1.154e-04

Anderson update took 66.926 ms, out of which F'*F took 30.936 ms; b-Ax took 210.261 ms, out of which Lap took 186.694 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 482.621 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844124, int_b + int_rho = -1.564e-13, checking this took 0.121 ms
2-norm of RHS = 841.2277777756395, which took 0.123 ms

iter_count = 252, r_2norm = 7.714e-04, tol*||rhs|| = 8.412e-04

Anderson update took 154.232 ms, out of which F'*F took 71.661 ms; b-Ax took 481.222 ms, out of which Lap took 433.657 ms
Solving Poisson took 1096.586 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.289 ms
Total time for convolution: 	 convolve: 5.144842 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 66.540 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.351 ms
Total time for convolution: 	 convolve: 5.160450 
Total time for convolution: 	 convolve: 5.175068 
Total time for convolution: 	 convolve: 5.177787 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.335 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.265 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.215 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.284 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.234 ms
---Transfer Veff_loc: D2D took 3.920 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.344 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.301 ms

This SCF took 28288.085 ms, scf error = 1.256e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.155397, lowerbound = -0.942555, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1825.851 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.002 ms
rank =  0, Distribute orbital to block cyclic format took 30.606 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.405 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 34.044 ms
rank =  0, finding HY took 29.910 ms
rank =  0, distributing HY into block cyclic form took 22.536 ms
rank =  0, finding Y'*HY took 5.673 ms
Rank 0, Project_Hamiltonian used 92.201 ms
Total time for projection: 92.215 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.090 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.938335256908907
    last  calculated eigval = 0.052431583370116
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45730544681513
lambda[   7] =  -0.43617668470645
lambda[   8] =  -0.36241790600101
lambda[   9] =  -0.35619327878382
lambda[  10] =  -0.35077870746377
lambda[  11] =  -0.34619497634472
lambda[  12] =  -0.29267824299855
lambda[  13] =  -0.28683176696810
lambda[  14] =  -0.25780812512907
lambda[  15] =  -0.22133558336837
lambda[  16] =  -0.03121129592771
lambda[  17] =  -0.00347275846777
lambda[  18] =   0.00354024263908
lambda[  19] =   0.01186248159393
lambda[  20] =   0.01586770798156
lambda[  21] =   0.02964891875353
lambda[  22] =   0.04654987241533
lambda[  23] =   0.05243158337012
==subpsace eigenproblem: bcast eigvals took 0.005 ms
Total time for solving subspace eigenvalue problem: 0.251 ms
rank =  0, subspace rotation using ScaLAPACK took 10.605 ms
rank =  0, Distributing orbital back into band + domain format took 22.664 ms
rank = 0, Subspace_Rotation used 33.288 ms

Total time for subspace rotation: 33.293 ms
rank = 0, Efermi =  -0.059784475559 calculate fermi energy took 1.239 ms
rank = 0, --- Calculate rho: sum over local bands took 7.050 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.422 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.589 ms
rank = 0, Calculating density took 1972.978 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.980 ms
rank = 0, D2D took 2.082 ms
rank = 0, Transfering density took 2.084 ms
Etot    =   -45.376543762681
Eband   =   -13.556208417401
E1      =    31.140346535986
E2      =   -12.012096773676
E3      =   -17.725904385656
Exc     =   -15.649582026756
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 9.972e-05, dEband = 1.256e-02
rank = 0, Calculating/Estimating energy took 1.067 ms, Etot = -45.376543763, dEtot = 9.972e-05, dEband = 1.256e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.0353440362847, which took 0.067 ms

iter_count = 114, r_2norm = 2.592e-05, tol*||rhs|| = 4.141e-05

Anderson update took 71.808 ms, out of which F'*F took 34.371 ms; b-Ax took 233.314 ms, out of which Lap took 206.701 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 510.003 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844127, int_b + int_rho = -1.273e-13, checking this took 0.126 ms
2-norm of RHS = 841.5974939765194, which took 0.178 ms

iter_count = 246, r_2norm = 7.481e-04, tol*||rhs|| = 8.416e-04

Anderson update took 154.437 ms, out of which F'*F took 70.505 ms; b-Ax took 473.991 ms, out of which Lap took 423.024 ms
Solving Poisson took 1062.990 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.331 ms
Total time for convolution: 	 convolve: 5.163352 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 32.130 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.382 ms
Total time for convolution: 	 convolve: 5.149320 
Total time for convolution: 	 convolve: 5.180411 
Total time for convolution: 	 convolve: 5.158706 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.341 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.277 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.031 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.208 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.244 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.043 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.049 ms
---Transfer Veff_loc: D2D took 4.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.921 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.292 ms

This SCF took 28248.840 ms, scf error = 7.012e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.152432, lowerbound = -0.938335, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1809.417 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 45.110 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.253 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 48.390 ms
rank =  0, finding HY took 29.739 ms
rank =  0, distributing HY into block cyclic form took 22.595 ms
rank =  0, finding Y'*HY took 5.467 ms
Rank 0, Project_Hamiltonian used 106.225 ms
Total time for projection: 106.254 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.247 ms
    first calculated eigval = -0.934925699226164
    last  calculated eigval = 0.050458604004004
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.45389938807403
lambda[   7] =  -0.43253069429760
lambda[   8] =  -0.35903872964618
lambda[   9] =  -0.35288077128551
lambda[  10] =  -0.34743613189009
lambda[  11] =  -0.34248012390999
lambda[  12] =  -0.28893076421437
lambda[  13] =  -0.28299602247924
lambda[  14] =  -0.25453289878679
lambda[  15] =  -0.21797982414722
lambda[  16] =  -0.03074710570656
lambda[  17] =  -0.00307063995297
lambda[  18] =   0.00411106865801
lambda[  19] =   0.01229134929441
lambda[  20] =   0.01578712953571
lambda[  21] =   0.02706697024116
lambda[  22] =   0.04574974977490
lambda[  23] =   0.05045860400400
==subpsace eigenproblem: bcast eigvals took 0.010 ms
Total time for solving subspace eigenvalue problem: 0.265 ms
rank =  0, subspace rotation using ScaLAPACK took 10.618 ms
rank =  0, Distributing orbital back into band + domain format took 22.949 ms
rank = 0, Subspace_Rotation used 33.591 ms

Total time for subspace rotation: 33.596 ms
rank = 0, Efermi =  -0.059320285392 calculate fermi energy took 0.063 ms
rank = 0, --- Calculate rho: sum over local bands took 7.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.510 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.631 ms
rank = 0, Calculating density took 1969.987 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.961 ms
rank = 0, D2D took 2.070 ms
rank = 0, Transfering density took 2.072 ms
Etot    =   -45.376009708779
Eband   =   -13.451044956953
E1      =    31.095913223820
E2      =   -11.945866255350
E3      =   -17.744435164748
Exc     =   -15.662078381901
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 4.108e-05, dEband = 8.089e-03
rank = 0, Calculating/Estimating energy took 1.081 ms, Etot = -45.376009709, dEtot = 4.108e-05, dEband = 8.089e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.4544211279803, which took 0.079 ms

iter_count = 114, r_2norm = 1.215e-05, tol*||rhs|| = 1.818e-05

Anderson update took 70.236 ms, out of which F'*F took 32.328 ms; b-Ax took 218.728 ms, out of which Lap took 194.185 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 500.846 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844113, int_b + int_rho = -2.692e-13, checking this took 0.115 ms
2-norm of RHS = 841.8507329154460, which took 0.168 ms

iter_count = 246, r_2norm = 7.298e-04, tol*||rhs|| = 8.419e-04

Anderson update took 154.167 ms, out of which F'*F took 71.021 ms; b-Ax took 475.779 ms, out of which Lap took 425.885 ms
Solving Poisson took 1080.667 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.314 ms
Total time for convolution: 	 convolve: 5.158299 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.666 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.346 ms
Total time for convolution: 	 convolve: 5.159134 
Total time for convolution: 	 convolve: 5.165551 
Total time for convolution: 	 convolve: 5.157913 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.817 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.045 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.570 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.080 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.217 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.024 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.296 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.629 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.005 ms
---Transfer Veff_loc: D2D took 3.461 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.927 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.424 ms

This SCF took 28417.770 ms, scf error = 3.560e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.150459, lowerbound = -0.934926, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1820.610 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 36.322 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.276 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 39.624 ms
rank =  0, finding HY took 29.683 ms
rank =  0, distributing HY into block cyclic form took 22.772 ms
rank =  0, finding Y'*HY took 5.419 ms
Rank 0, Project_Hamiltonian used 97.536 ms
Total time for projection: 97.565 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.094 ms
rank = 0, Solve_Generalized_EigenProblem used 0.242 ms
    first calculated eigval = -0.932416092046294
    last  calculated eigval = 0.049697854352466
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44957058906297
lambda[   7] =  -0.42783700937521
lambda[   8] =  -0.35515896116185
lambda[   9] =  -0.34863985004876
lambda[  10] =  -0.34312787014677
lambda[  11] =  -0.33775293425723
lambda[  12] =  -0.28426830578665
lambda[  13] =  -0.27767696364770
lambda[  14] =  -0.25031136723783
lambda[  15] =  -0.21468225176162
lambda[  16] =  -0.02967312519562
lambda[  17] =  -0.00206542849486
lambda[  18] =   0.00595588145071
lambda[  19] =   0.01404800973914
lambda[  20] =   0.01672018848074
lambda[  21] =   0.02652875739028
lambda[  22] =   0.04639912196861
lambda[  23] =   0.04969785435247
==subpsace eigenproblem: bcast eigvals took 0.055 ms
Total time for solving subspace eigenvalue problem: 0.305 ms
rank =  0, subspace rotation using ScaLAPACK took 10.609 ms
rank =  0, Distributing orbital back into band + domain format took 22.847 ms
rank = 0, Subspace_Rotation used 33.477 ms

Total time for subspace rotation: 33.484 ms
rank = 0, Efermi =  -0.058246304875 calculate fermi energy took 0.073 ms
rank = 0, --- Calculate rho: sum over local bands took 7.104 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.702 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.568 ms
rank = 0, Calculating density took 1972.496 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 1.942 ms
rank = 0, D2D took 2.039 ms
rank = 0, Transfering density took 2.041 ms
Etot    =   -45.375647043716
Eband   =   -13.319966200682
E1      =    31.030645933881
E2      =   -11.874782727254
E3      =   -17.763933723616
Exc     =   -15.675942213943
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 2.790e-05, dEband = 1.008e-02
rank = 0, Calculating/Estimating energy took 1.943 ms, Etot = -45.375647044, dEtot = 2.790e-05, dEband = 1.008e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2528374299592, which took 0.066 ms

iter_count = 114, r_2norm = 7.872e-06, tol*||rhs|| = 1.011e-05

Anderson update took 69.480 ms, out of which F'*F took 32.359 ms; b-Ax took 219.826 ms, out of which Lap took 196.026 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.520 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844130, int_b + int_rho = -9.459e-14, checking this took 0.152 ms
2-norm of RHS = 841.8973946545168, which took 0.155 ms

iter_count = 222, r_2norm = 8.265e-04, tol*||rhs|| = 8.419e-04

Anderson update took 135.634 ms, out of which F'*F took 62.634 ms; b-Ax took 424.703 ms, out of which Lap took 380.099 ms
Solving Poisson took 950.319 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.309 ms
Total time for convolution: 	 convolve: 5.173063 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 39.585 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.359 ms
Total time for convolution: 	 convolve: 5.150859 
Total time for convolution: 	 convolve: 5.162097 
Total time for convolution: 	 convolve: 5.333954 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 630.741 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.716 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.044 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.223 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.009 ms
======D2D: initiated sending and receiving took 1.069 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.195 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.406 ms
---Transfer Veff_loc: D2D took 3.449 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.960 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.445 ms

This SCF took 28938.170 ms, scf error = 1.806e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.149698, lowerbound = -0.932416, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1871.270 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 22.869 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.400 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 26.296 ms
rank =  0, finding HY took 29.750 ms
rank =  0, distributing HY into block cyclic form took 22.561 ms
rank =  0, finding Y'*HY took 5.592 ms
Rank 0, Project_Hamiltonian used 84.234 ms
Total time for projection: 84.249 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.141 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.099 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.930640687839459
    last  calculated eigval = 0.049367105360683
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44764598360892
lambda[   7] =  -0.42585897736792
lambda[   8] =  -0.35319582761493
lambda[   9] =  -0.34666992664559
lambda[  10] =  -0.34110152789790
lambda[  11] =  -0.33587460369024
lambda[  12] =  -0.28229279296404
lambda[  13] =  -0.27558392707244
lambda[  14] =  -0.24834955964356
lambda[  15] =  -0.21282498465939
lambda[  16] =  -0.02838997302116
lambda[  17] =  -0.00046243643394
lambda[  18] =   0.00823144527410
lambda[  19] =   0.01636948411649
lambda[  20] =   0.01808613381799
lambda[  21] =   0.02710049697203
lambda[  22] =   0.04794839346340
lambda[  23] =   0.04936710536068
==subpsace eigenproblem: bcast eigvals took 0.020 ms
Total time for solving subspace eigenvalue problem: 0.273 ms
rank =  0, subspace rotation using ScaLAPACK took 10.657 ms
rank =  0, Distributing orbital back into band + domain format took 22.935 ms
rank = 0, Subspace_Rotation used 33.616 ms

Total time for subspace rotation: 33.621 ms
rank = 0, Efermi =  -0.056963152661 calculate fermi energy took 0.068 ms
rank = 0, --- Calculate rho: sum over local bands took 7.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.607 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.571 ms
rank = 0, Calculating density took 2009.805 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.013 ms
======D2D: initiated sending and receiving took 3.324 ms
rank = 0, D2D took 3.425 ms
rank = 0, Transfering density took 3.431 ms
Etot    =   -45.375539802017
Eband   =   -13.260905814867
E1      =    31.002858171537
E2      =   -11.842374684350
E3      =   -17.767813000482
Exc     =   -15.678578829676
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 8.249e-06, dEband = 4.543e-03
rank = 0, Calculating/Estimating energy took 1.796 ms, Etot = -45.375539802, dEtot = 8.249e-06, dEband = 4.543e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2038320554926, which took 0.079 ms

iter_count = 114, r_2norm = 5.108e-06, tol*||rhs|| = 8.153e-06

Anderson update took 69.149 ms, out of which F'*F took 31.830 ms; b-Ax took 216.633 ms, out of which Lap took 191.255 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.192 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844130, int_b + int_rho = -1.019e-13, checking this took 0.118 ms
2-norm of RHS = 841.8687069960364, which took 0.123 ms

iter_count = 216, r_2norm = 7.679e-04, tol*||rhs|| = 8.419e-04

Anderson update took 134.367 ms, out of which F'*F took 61.163 ms; b-Ax took 412.592 ms, out of which Lap took 367.052 ms
Solving Poisson took 928.503 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.273 ms
Total time for convolution: 	 convolve: 5.175837 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 40.731 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.380 ms
Total time for convolution: 	 convolve: 5.156298 
Total time for convolution: 	 convolve: 5.158181 
Total time for convolution: 	 convolve: 5.152081 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.825 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.591 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.140 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.665 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.337 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.294 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.248 ms
---Transfer Veff_loc: D2D took 3.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.406 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.922 ms

This SCF took 28150.788 ms, scf error = 1.179e-03
-------------
SCF iter 9  
-------------

 Chebfilt 12, in Chebyshev filtering, lambda_cutoff = 0.149367, lowerbound = -0.930641, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1809.101 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.005 ms
rank =  0, Distribute orbital to block cyclic format took 37.086 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.346 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 40.459 ms
rank =  0, finding HY took 29.711 ms
rank =  0, distributing HY into block cyclic form took 22.480 ms
rank =  0, finding Y'*HY took 5.677 ms
Rank 0, Project_Hamiltonian used 98.371 ms
Total time for projection: 98.387 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.240 ms
    first calculated eigval = -0.929429369262818
    last  calculated eigval = 0.050818364014125
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44586893014102
lambda[   7] =  -0.42396935977006
lambda[   8] =  -0.35156557283561
lambda[   9] =  -0.34485868541731
lambda[  10] =  -0.33936856829568
lambda[  11] =  -0.33397866880653
lambda[  12] =  -0.28038840441603
lambda[  13] =  -0.27363911102199
lambda[  14] =  -0.24660065555666
lambda[  15] =  -0.21136563076268
lambda[  16] =  -0.02653089237801
lambda[  17] =   0.00196014129297
lambda[  18] =   0.01108650031814
lambda[  19] =   0.01925396294690
lambda[  20] =   0.02026204076368
lambda[  21] =   0.02865720340554
lambda[  22] =   0.04862379402894
lambda[  23] =   0.05081836401413
==subpsace eigenproblem: bcast eigvals took 0.077 ms
Total time for solving subspace eigenvalue problem: 0.326 ms
rank =  0, subspace rotation using ScaLAPACK took 10.601 ms
rank =  0, Distributing orbital back into band + domain format took 22.825 ms
rank = 0, Subspace_Rotation used 34.235 ms

Total time for subspace rotation: 34.243 ms
rank = 0, Efermi =  -0.055104072045 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 8.018 ms
rank = 0, --- Calculate rho: reduce over all band groups took 11.822 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.590 ms
rank = 0, Calculating density took 1962.641 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.958 ms
rank = 0, D2D took 2.064 ms
rank = 0, Transfering density took 2.070 ms
Etot    =   -45.375472992979
Eband   =   -13.207739861575
E1      =    30.974071825880
E2      =   -11.816541554604
E3      =   -17.774452623844
Exc     =   -15.683698121890
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 5.139e-06, dEband = 4.090e-03
rank = 0, Calculating/Estimating energy took 1.076 ms, Etot = -45.375472993, dEtot = 5.139e-06, dEband = 4.090e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0908916041840, which took 0.075 ms

iter_count = 114, r_2norm = 2.635e-06, tol*||rhs|| = 3.636e-06

Anderson update took 69.528 ms, out of which F'*F took 32.077 ms; b-Ax took 216.893 ms, out of which Lap took 194.181 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 495.903 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844127, int_b + int_rho = -1.273e-13, checking this took 0.131 ms
2-norm of RHS = 841.8635086718655, which took 0.205 ms

iter_count = 204, r_2norm = 8.129e-04, tol*||rhs|| = 8.419e-04

Anderson update took 124.187 ms, out of which F'*F took 58.380 ms; b-Ax took 390.738 ms, out of which Lap took 348.988 ms
Solving Poisson took 873.687 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.318 ms
Total time for convolution: 	 convolve: 5.168575 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 45.452 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.376 ms
Total time for convolution: 	 convolve: 5.163626 
Total time for convolution: 	 convolve: 5.186609 
Total time for convolution: 	 convolve: 5.168609 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.041 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.799 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.543 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.079 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.348 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.344 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.004 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.229 ms
---Transfer Veff_loc: D2D took 3.452 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.961 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.448 ms

This SCF took 28078.645 ms, scf error = 8.108e-04
-------------
SCF iter 10  
-------------

 Chebfilt 13, in Chebyshev filtering, lambda_cutoff = 0.150818, lowerbound = -0.929429, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1794.874 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 53.759 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.334 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 57.123 ms
rank =  0, finding HY took 29.899 ms
rank =  0, distributing HY into block cyclic form took 22.573 ms
rank =  0, finding Y'*HY took 5.631 ms
Rank 0, Project_Hamiltonian used 115.264 ms
Total time for projection: 115.286 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.097 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.928646376305853
    last  calculated eigval = 0.054372257047526
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44501019369589
lambda[   7] =  -0.42305429923187
lambda[   8] =  -0.35073466589297
lambda[   9] =  -0.34396835053953
lambda[  10] =  -0.33853181758474
lambda[  11] =  -0.33303908434111
lambda[  12] =  -0.27944752658437
lambda[  13] =  -0.27270839689514
lambda[  14] =  -0.24576348308997
lambda[  15] =  -0.21054288562834
lambda[  16] =  -0.02358035142652
lambda[  17] =   0.00527712886040
lambda[  18] =   0.01459483104226
lambda[  19] =   0.02255333912447
lambda[  20] =   0.02372864511621
lambda[  21] =   0.03086935113333
lambda[  22] =   0.04762737710794
lambda[  23] =   0.05437225704753
==subpsace eigenproblem: bcast eigvals took 0.032 ms
Total time for solving subspace eigenvalue problem: 0.284 ms
rank =  0, subspace rotation using ScaLAPACK took 11.159 ms
rank =  0, Distributing orbital back into band + domain format took 22.893 ms
rank = 0, Subspace_Rotation used 34.078 ms

Total time for subspace rotation: 34.087 ms
rank = 0, Efermi =  -0.052153531086 calculate fermi energy took 0.062 ms
rank = 0, --- Calculate rho: sum over local bands took 7.100 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.624 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.615 ms
rank = 0, Calculating density took 1965.766 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.966 ms
rank = 0, D2D took 2.069 ms
rank = 0, Transfering density took 2.074 ms
Etot    =   -45.375486893287
Eband   =   -13.181524631467
E1      =    30.962688882511
E2      =   -11.801850219306
E3      =   -17.774034714077
Exc     =   -15.683435063871
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 1.069e-06, dEband = 2.017e-03
rank = 0, Calculating/Estimating energy took 1.070 ms, Etot = -45.375486893, dEtot = 1.069e-06, dEband = 2.017e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0641114947571, which took 0.069 ms

iter_count = 114, r_2norm = 2.052e-06, tol*||rhs|| = 2.564e-06

Anderson update took 68.976 ms, out of which F'*F took 34.945 ms; b-Ax took 220.417 ms, out of which Lap took 195.378 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 498.432 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844123, int_b + int_rho = -1.637e-13, checking this took 0.123 ms
2-norm of RHS = 841.8681677180390, which took 0.190 ms

iter_count = 180, r_2norm = 7.242e-04, tol*||rhs|| = 8.419e-04

Anderson update took 112.034 ms, out of which F'*F took 51.187 ms; b-Ax took 343.902 ms, out of which Lap took 306.123 ms
Solving Poisson took 774.452 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.038 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Total time for convolution: 	 convolve: 5.151053 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 62.191 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.372 ms
Total time for convolution: 	 convolve: 5.169569 
Total time for convolution: 	 convolve: 5.169737 
Total time for convolution: 	 convolve: 5.159783 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.047 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 1.835 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.056 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.549 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.062 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.235 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.367 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.328 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.460 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.917 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.412 ms

This SCF took 27971.001 ms, scf error = 4.828e-04
-------------
SCF iter 11  
-------------

 Chebfilt 14, in Chebyshev filtering, lambda_cutoff = 0.154372, lowerbound = -0.928646, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1811.554 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 43.747 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.479 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 47.254 ms
rank =  0, finding HY took 29.625 ms
rank =  0, distributing HY into block cyclic form took 22.567 ms
rank =  0, finding Y'*HY took 5.576 ms
Rank 0, Project_Hamiltonian used 105.066 ms
Total time for projection: 105.090 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.144 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.087 ms
rank = 0, Solve_Generalized_EigenProblem used 0.234 ms
    first calculated eigval = -0.928237315303003
    last  calculated eigval = 0.054383625899622
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44448317390523
lambda[   7] =  -0.42249412698108
lambda[   8] =  -0.35022342484262
lambda[   9] =  -0.34339730859015
lambda[  10] =  -0.33801821852035
lambda[  11] =  -0.33248940848792
lambda[  12] =  -0.27886426397894
lambda[  13] =  -0.27210109674136
lambda[  14] =  -0.24523893087351
lambda[  15] =  -0.21009676294141
lambda[  16] =  -0.02227595745601
lambda[  17] =   0.00604564081217
lambda[  18] =   0.01450365774352
lambda[  19] =   0.02264364423332
lambda[  20] =   0.02529759025195
lambda[  21] =   0.03105032479763
lambda[  22] =   0.04321546530090
lambda[  23] =   0.05438362589962
==subpsace eigenproblem: bcast eigvals took 0.089 ms
Total time for solving subspace eigenvalue problem: 0.331 ms
rank =  0, subspace rotation using ScaLAPACK took 11.186 ms
rank =  0, Distributing orbital back into band + domain format took 22.844 ms
rank = 0, Subspace_Rotation used 34.063 ms

Total time for subspace rotation: 34.074 ms
rank = 0, Efermi =  -0.050849137132 calculate fermi energy took 0.078 ms
rank = 0, --- Calculate rho: sum over local bands took 7.131 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.696 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.583 ms
rank = 0, Calculating density took 1972.399 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.953 ms
rank = 0, D2D took 2.058 ms
rank = 0, Transfering density took 2.063 ms
Etot    =   -45.375608169386
Eband   =   -13.165366493293
E1      =    30.954247446965
E2      =   -11.793738861252
E3      =   -17.775510409828
Exc     =   -15.684637380296
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 9.329e-06, dEband = 1.243e-03
rank = 0, Calculating/Estimating energy took 1.081 ms, Etot = -45.375608169, dEtot = 9.329e-06, dEband = 1.243e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0568347169481, which took 0.149 ms

iter_count = 114, r_2norm = 1.761e-06, tol*||rhs|| = 2.273e-06

Anderson update took 69.902 ms, out of which F'*F took 32.165 ms; b-Ax took 216.556 ms, out of which Lap took 193.634 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.988 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844113, int_b + int_rho = -2.656e-13, checking this took 0.113 ms
2-norm of RHS = 841.8747665037671, which took 0.198 ms

iter_count = 168, r_2norm = 6.879e-04, tol*||rhs|| = 8.419e-04

Anderson update took 102.414 ms, out of which F'*F took 47.866 ms; b-Ax took 321.493 ms, out of which Lap took 287.056 ms
Solving Poisson took 719.845 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.033 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.338 ms
Total time for convolution: 	 convolve: 5.168355 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 29.819 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.392 ms
Total time for convolution: 	 convolve: 5.177278 
Total time for convolution: 	 convolve: 5.174542 
Total time for convolution: 	 convolve: 5.154793 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.042 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.794 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.576 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.149 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.228 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.128 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.345 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.335 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.252 ms
---Transfer Veff_loc: D2D took 3.478 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.946 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.460 ms

This SCF took 28080.779 ms, scf error = 3.358e-04
-------------
SCF iter 12  
-------------

 Chebfilt 15, in Chebyshev filtering, lambda_cutoff = 0.154384, lowerbound = -0.928237, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1802.667 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.008 ms
rank =  0, Distribute orbital to block cyclic format took 42.756 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.367 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 46.155 ms
rank =  0, finding HY took 29.839 ms
rank =  0, distributing HY into block cyclic form took 22.510 ms
rank =  0, finding Y'*HY took 5.547 ms
Rank 0, Project_Hamiltonian used 104.622 ms
Total time for projection: 104.646 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.096 ms
rank = 0, Solve_Generalized_EigenProblem used 0.244 ms
    first calculated eigval = -0.927981742673222
    last  calculated eigval = 0.054575029482852
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44417549557941
lambda[   7] =  -0.42217582847728
lambda[   8] =  -0.34993483648707
lambda[   9] =  -0.34308365886849
lambda[  10] =  -0.33770331706655
lambda[  11] =  -0.33217969939355
lambda[  12] =  -0.27855432088813
lambda[  13] =  -0.27176718613596
lambda[  14] =  -0.24493223471553
lambda[  15] =  -0.20983005636566
lambda[  16] =  -0.02094648352547
lambda[  17] =   0.00673725841300
lambda[  18] =   0.01503214024716
lambda[  19] =   0.02324549529179
lambda[  20] =   0.02648457012173
lambda[  21] =   0.03141895017669
lambda[  22] =   0.04106026702107
lambda[  23] =   0.05457502948285
==subpsace eigenproblem: bcast eigvals took 0.018 ms
Total time for solving subspace eigenvalue problem: 0.270 ms
rank =  0, subspace rotation using ScaLAPACK took 10.653 ms
rank =  0, Distributing orbital back into band + domain format took 22.923 ms
rank = 0, Subspace_Rotation used 33.600 ms

Total time for subspace rotation: 33.606 ms
rank = 0, Efermi =  -0.049519663150 calculate fermi energy took 0.064 ms
rank = 0, --- Calculate rho: sum over local bands took 7.149 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.528 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1961.580 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.947 ms
rank = 0, D2D took 2.060 ms
rank = 0, Transfering density took 2.072 ms
Etot    =   -45.375676125630
Eband   =   -13.156112191560
E1      =    30.949629098295
E2      =   -11.788990934032
E3      =   -17.775916467767
Exc     =   -15.684999420322
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 5.227e-06, dEband = 7.119e-04
rank = 0, Calculating/Estimating energy took 1.074 ms, Etot = -45.375676126, dEtot = 5.227e-06, dEband = 7.119e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0432678055393, which took 0.089 ms

iter_count = 114, r_2norm = 1.245e-06, tol*||rhs|| = 1.731e-06

Anderson update took 69.110 ms, out of which F'*F took 31.737 ms; b-Ax took 217.059 ms, out of which Lap took 191.557 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.064 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844125, int_b + int_rho = -1.492e-13, checking this took 0.123 ms
2-norm of RHS = 841.8822160154363, which took 0.147 ms

iter_count = 162, r_2norm = 7.580e-04, tol*||rhs|| = 8.419e-04

Anderson update took 100.682 ms, out of which F'*F took 46.007 ms; b-Ax took 309.415 ms, out of which Lap took 275.348 ms
Solving Poisson took 697.861 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.129 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.322 ms
Total time for convolution: 	 convolve: 5.153082 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 36.134 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.362 ms
Total time for convolution: 	 convolve: 5.178865 
Total time for convolution: 	 convolve: 5.172644 
Total time for convolution: 	 convolve: 5.153714 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.807 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.046 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.580 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 16.669 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.262 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.340 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.337 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.006 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.249 ms
---Transfer Veff_loc: D2D took 3.490 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.121 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.655 ms

This SCF took 27882.085 ms, scf error = 2.486e-04
-------------
SCF iter 13  
-------------

 Chebfilt 16, in Chebyshev filtering, lambda_cutoff = 0.154575, lowerbound = -0.927982, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1816.831 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.006 ms
rank =  0, Distribute orbital to block cyclic format took 52.239 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.402 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 55.669 ms
rank =  0, finding HY took 29.572 ms
rank =  0, distributing HY into block cyclic form took 22.622 ms
rank =  0, finding Y'*HY took 5.484 ms
Rank 0, Project_Hamiltonian used 113.392 ms
Total time for projection: 113.413 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.143 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.092 ms
rank = 0, Solve_Generalized_EigenProblem used 0.238 ms
    first calculated eigval = -0.927643107095962
    last  calculated eigval = 0.054550701359687
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44383378476207
lambda[   7] =  -0.42183321480366
lambda[   8] =  -0.34961589741944
lambda[   9] =  -0.34276303466191
lambda[  10] =  -0.33734934947015
lambda[  11] =  -0.33183895963611
lambda[  12] =  -0.27823601401006
lambda[  13] =  -0.27143650901546
lambda[  14] =  -0.24459709834259
lambda[  15] =  -0.20950260846064
lambda[  16] =  -0.01928767334481
lambda[  17] =   0.00752665445112
lambda[  18] =   0.01555164670657
lambda[  19] =   0.02384524101384
lambda[  20] =   0.02782885356375
lambda[  21] =   0.03139458737970
lambda[  22] =   0.04028336488983
lambda[  23] =   0.05455070135969
==subpsace eigenproblem: bcast eigvals took 0.011 ms
Total time for solving subspace eigenvalue problem: 0.258 ms
rank =  0, subspace rotation using ScaLAPACK took 10.665 ms
rank =  0, Distributing orbital back into band + domain format took 22.749 ms
rank = 0, Subspace_Rotation used 33.438 ms

Total time for subspace rotation: 33.444 ms
rank = 0, Efermi =  -0.047860852996 calculate fermi energy took 0.065 ms
rank = 0, --- Calculate rho: sum over local bands took 7.176 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.753 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.566 ms
rank = 0, Calculating density took 1985.490 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.005 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 1.952 ms
rank = 0, D2D took 2.058 ms
rank = 0, Transfering density took 2.065 ms
Etot    =   -45.375727534561
Eband   =   -13.146031502170
E1      =    30.944724085619
E2      =   -11.783644419475
E3      =   -17.776498282017
Exc     =   -15.685461805659
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 3.955e-06, dEband = 7.754e-04
rank = 0, Calculating/Estimating energy took 1.078 ms, Etot = -45.375727535, dEtot = 3.955e-06, dEband = 7.754e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0362357660508, which took 0.072 ms

iter_count = 114, r_2norm = 1.022e-06, tol*||rhs|| = 1.449e-06

Anderson update took 69.824 ms, out of which F'*F took 31.928 ms; b-Ax took 215.926 ms, out of which Lap took 192.816 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 494.781 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844129, int_b + int_rho = -1.128e-13, checking this took 0.094 ms
2-norm of RHS = 841.8828967129316, which took 0.189 ms

iter_count = 132, r_2norm = 7.801e-04, tol*||rhs|| = 8.419e-04

Anderson update took 80.421 ms, out of which F'*F took 37.646 ms; b-Ax took 252.615 ms, out of which Lap took 225.393 ms
Solving Poisson took 566.549 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.040 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.330 ms
Total time for convolution: 	 convolve: 5.155634 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 50.318 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.161565 
Total time for convolution: 	 convolve: 5.195857 
Total time for convolution: 	 convolve: 5.188307 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.035 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.787 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.567 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.216 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.026 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.352 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.315 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.230 ms
---Transfer Veff_loc: D2D took 3.474 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 3.426 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.303 ms

This SCF took 27817.885 ms, scf error = 1.790e-04
-------------
SCF iter 14  
-------------

 Chebfilt 17, in Chebyshev filtering, lambda_cutoff = 0.154551, lowerbound = -0.927643, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1807.772 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.003 ms
rank =  0, Distribute orbital to block cyclic format took 38.164 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.350 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 41.544 ms
rank =  0, finding HY took 29.909 ms
rank =  0, distributing HY into block cyclic form took 22.646 ms
rank =  0, finding Y'*HY took 5.444 ms
Rank 0, Project_Hamiltonian used 99.580 ms
Total time for projection: 99.599 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.142 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.106 ms
rank = 0, Solve_Generalized_EigenProblem used 0.253 ms
    first calculated eigval = -0.927442853223896
    last  calculated eigval = 0.054073378480520
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44365886664599
lambda[   7] =  -0.42166561918099
lambda[   8] =  -0.34944350815350
lambda[   9] =  -0.34259997346214
lambda[  10] =  -0.33716688195459
lambda[  11] =  -0.33167338636415
lambda[  12] =  -0.27808028685967
lambda[  13] =  -0.27127493531475
lambda[  14] =  -0.24442310835992
lambda[  15] =  -0.20931905715878
lambda[  16] =  -0.01886938738924
lambda[  17] =   0.00753560467950
lambda[  18] =   0.01542838226440
lambda[  19] =   0.02382550889026
lambda[  20] =   0.02812439034549
lambda[  21] =   0.03105950088363
lambda[  22] =   0.03982921808223
lambda[  23] =   0.05407337848052
==subpsace eigenproblem: bcast eigvals took 0.051 ms
Total time for solving subspace eigenvalue problem: 0.313 ms
rank =  0, subspace rotation using ScaLAPACK took 10.580 ms
rank =  0, Distributing orbital back into band + domain format took 23.060 ms
rank = 0, Subspace_Rotation used 33.663 ms

Total time for subspace rotation: 33.669 ms
rank = 0, Efermi =  -0.047442567075 calculate fermi energy took 0.060 ms
rank = 0, --- Calculate rho: sum over local bands took 7.084 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.457 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.607 ms
rank = 0, Calculating density took 1961.637 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.002 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.953 ms
rank = 0, D2D took 2.055 ms
rank = 0, Transfering density took 2.057 ms
Etot    =   -45.375753245238
Eband   =   -13.140849538027
E1      =    30.942029963482
E2      =   -11.781019006223
E3      =   -17.776963024215
Exc     =   -15.685814687290
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 1.978e-06, dEband = 3.986e-04
rank = 0, Calculating/Estimating energy took 1.069 ms, Etot = -45.375753245, dEtot = 1.978e-06, dEband = 3.986e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0188581867996, which took 0.076 ms

iter_count = 114, r_2norm = 5.587e-07, tol*||rhs|| = 7.543e-07

Anderson update took 68.945 ms, out of which F'*F took 31.818 ms; b-Ax took 218.109 ms, out of which Lap took 192.506 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 496.414 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844123, int_b + int_rho = -1.710e-13, checking this took 0.089 ms
2-norm of RHS = 841.8806109028463, which took 0.219 ms

iter_count = 144, r_2norm = 7.115e-04, tol*||rhs|| = 8.419e-04

Anderson update took 89.320 ms, out of which F'*F took 40.846 ms; b-Ax took 275.482 ms, out of which Lap took 244.971 ms
Solving Poisson took 620.836 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.064 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.317 ms
Total time for convolution: 	 convolve: 5.172478 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 25.594 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.348 ms
Total time for convolution: 	 convolve: 5.158703 
Total time for convolution: 	 convolve: 5.175382 
Total time for convolution: 	 convolve: 5.222241 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.005 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.049 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.562 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.027 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.225 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.025 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.355 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.028 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.323 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.718 ms
---Transfer Veff_loc: D2D took 3.935 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.952 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.290 ms

This SCF took 27853.033 ms, scf error = 1.422e-04
-------------
SCF iter 15  
-------------

 Chebfilt 18, in Chebyshev filtering, lambda_cutoff = 0.154073, lowerbound = -0.927443, upperbound = 267.587762

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (2 columns, degree = 45): 1806.385 ms
New BLOCK CYCLIC DOMAIN: nproc = 12, dims = (12, 1), Elapsed time is 0.004 ms
rank =  0, Distribute orbital to block cyclic format took 45.124 ms
rank = 0, STARTING PDSYRK ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 3.300 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.000 ms
rank =  0, Distribute data + matrix mult took 48.454 ms
rank =  0, finding HY took 29.535 ms
rank =  0, distributing HY into block cyclic form took 22.546 ms
rank =  0, finding Y'*HY took 5.517 ms
Rank 0, Project_Hamiltonian used 106.090 ms
Total time for projection: 106.118 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 0.145 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 0.093 ms
rank = 0, Solve_Generalized_EigenProblem used 0.243 ms
    first calculated eigval = -0.927196240647972
    last  calculated eigval = 0.053827531177178
The last 18 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 30):
lambda[   6] =  -0.44345635804965
lambda[   7] =  -0.42147627080350
lambda[   8] =  -0.34923844456208
lambda[   9] =  -0.34240696006789
lambda[  10] =  -0.33695851289049
lambda[  11] =  -0.33148274991275
lambda[  12] =  -0.27790133676040
lambda[  13] =  -0.27109376508130
lambda[  14] =  -0.24422197909109
lambda[  15] =  -0.20909952310770
lambda[  16] =  -0.01851842861712
lambda[  17] =   0.00706067807694
lambda[  18] =   0.01551464812723
lambda[  19] =   0.02411024705843
lambda[  20] =   0.02838725734908
lambda[  21] =   0.03147039303976
lambda[  22] =   0.04069067377596
lambda[  23] =   0.05382753117718
==subpsace eigenproblem: bcast eigvals took 0.030 ms
Total time for solving subspace eigenvalue problem: 0.281 ms
rank =  0, subspace rotation using ScaLAPACK took 10.606 ms
rank =  0, Distributing orbital back into band + domain format took 22.862 ms
rank = 0, Subspace_Rotation used 33.489 ms

Total time for subspace rotation: 33.495 ms
rank = 0, Efermi =  -0.047091608281 calculate fermi energy took 0.072 ms
rank = 0, --- Calculate rho: sum over local bands took 7.066 ms
rank = 0, --- Calculate rho: reduce over all band groups took 12.666 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.597 ms
rank = 0, Calculating density took 1966.756 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 1.960 ms
rank = 0, D2D took 2.053 ms
rank = 0, Transfering density took 2.055 ms
Etot    =   -45.375777644935
Eband   =   -13.134839561927
E1      =    30.938972116621
E2      =   -11.777951459197
E3      =   -17.777325950833
Exc     =   -15.686086595817
Esc     =   -77.049101012710
Entropy =    -0.000000001133
dE = 1.877e-06, dEband = 4.623e-04
rank = 0, Calculating/Estimating energy took 1.075 ms, Etot = -45.375777645, dEtot = 1.877e-06, dEband = 4.623e-04
Start applying Kerker preconditioner ...
2-norm of RHS = 0.0177073192077, which took 0.076 ms

iter_count = 108, r_2norm = 6.973e-07, tol*||rhs|| = 7.083e-07

Anderson update took 66.151 ms, out of which F'*F took 30.524 ms; b-Ax took 204.809 ms, out of which Lap took 183.311 ms
WARNING: The density after mixing has negative components!
rank = 0, Mixing (+ precond) took 469.707 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -30.00000003844140, int_rho =  30.00000003844115, int_b + int_rho = -2.437e-13, checking this took 0.118 ms
2-norm of RHS = 841.8824538297889, which took 0.155 ms

iter_count = 120, r_2norm = 8.364e-04, tol*||rhs|| = 8.419e-04

Anderson update took 73.182 ms, out of which F'*F took 34.158 ms; b-Ax took 228.755 ms, out of which Lap took 203.980 ms
Solving Poisson took 517.035 ms
Start calculating Vx (GGA_CONV_PBE_MULTIPOLE)
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.053 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.329 ms
Total time for convolution: 	 convolve: 5.158906 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 67.952 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.350 ms
Total time for convolution: 	 convolve: 5.168869 
Total time for convolution: 	 convolve: 5.175323 
Total time for convolution: 	 convolve: 5.176340 
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.802 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.050 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.556 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.239 ms
Saving X potential contribution from PBE.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.036 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.001 ms
======D2D: initiated sending and receiving took 0.346 ms
Start calculating Vc (GGA_CONV_PBE or GGA_CONV_PBE_MULTIPOLE) ...
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.003 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.037 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.808 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.003 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.232 ms
---Transfer Veff_loc: D2D took 3.476 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.000 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.000 ms
---Transfer Veff_loc: mpi_bcast (count = 1000000) to all bandcomms took 2.947 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.460 ms

This SCF took 27718.569 ms, scf error = 8.811e-05
The last 18 occupations of kpoints #1 are (Nelectron = 30):
lambda[   6] =  -0.44345635804965, occ[   6] =   2.00000000000000
lambda[   7] =  -0.42147627080350, occ[   7] =   2.00000000000000
lambda[   8] =  -0.34923844456208, occ[   8] =   2.00000000000000
lambda[   9] =  -0.34240696006789, occ[   9] =   2.00000000000000
lambda[  10] =  -0.33695851289049, occ[  10] =   2.00000000000000
lambda[  11] =  -0.33148274991275, occ[  11] =   2.00000000000000
lambda[  12] =  -0.27790133676040, occ[  12] =   2.00000000000000
lambda[  13] =  -0.27109376508130, occ[  13] =   2.00000000000000
lambda[  14] =  -0.24422197909109, occ[  14] =   2.00000000000000
lambda[  15] =  -0.20909952310770, occ[  15] =   2.00000000000000
lambda[  16] =  -0.01851842861712, occ[  16] =   0.00000003844124
lambda[  17] =   0.00706067807694, occ[  17] =   0.00000000000000
lambda[  18] =   0.01551464812723, occ[  18] =   0.00000000000000
lambda[  19] =   0.02411024705843, occ[  19] =   0.00000000000000
lambda[  20] =   0.02838725734908, occ[  20] =   0.00000000000000
lambda[  21] =   0.03147039303976, occ[  21] =   0.00000000000000
lambda[  22] =   0.04069067377596, occ[  22] =   0.00000000000000
lambda[  23] =   0.05382753117718, occ[  23] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 21 (90%) = 0.000000000000000.
Occupation of state 23 (100%) = 0.000000000000000.
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.001 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.029 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.384 ms
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 0.680 ms, time for Allreduce/Reduce: 13.997 ms 
Time for calculating local force components: 26.343 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.21562370638371  -1.02940264604053   0.00000086613114
 -0.04425641718194  -0.02486385882240   0.00000001269555
 -0.02652700823316  -0.00720065085343  -0.04124541068928
  0.04519085782436   0.01136712207445  -0.01367930333852
 -0.02652703396891  -0.00720063709805   0.04124547975557
  0.04519094515616   0.01136714694046   0.01367934594007
 -0.04935430674954   0.00292754891885   0.00000002225363
  0.01755949124492   0.04665069953027   0.00000003057346
  0.06751334135792   0.03072598580608   0.00000000527627
 -0.11666129087595   0.08888538315950   0.00000003046751
 -0.00792907197458  -0.02354895876737  -0.02525698505339
 -0.00792856462712  -0.02354897027654   0.02525789954389
 -0.01367462672475   0.05132662022927   0.00000019726144
force_loc = 
  0.20580149716753   1.00454068924471   0.00000147713404
  0.04579429117661   0.02576647185386  -0.00000058719604
  0.02744408649502   0.00759811907549   0.04243435637321
 -0.04628907779010  -0.01176880009685   0.01385285618302
  0.02744416772424   0.00759978804771  -0.04243410364014
 -0.04628902483039  -0.01176952840644  -0.01385307157740
  0.05070674218615  -0.00290755426702  -0.00000013922889
 -0.01832058661830  -0.04794840824489  -0.00000005287943
 -0.06981286808362  -0.03105808600996   0.00000014031894
  0.11502290203148  -0.08982870647353  -0.00000267311605
  0.00838345796596   0.02175642287942   0.02453614698508
  0.00838652520130   0.02175659560358  -0.02453460164863
  0.01217146160752  -0.04855918141984  -0.00000110235869
Time for calculating nonlocal force components: 49.992 ms
[32mforces_xc: 
[0m[32m  0.00565787729159   0.03159820437734   0.00000002748422
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00000000000000   0.00000000000000   0.00000000000000
[0m[32m  0.00659617314912  -0.00410596463573  -0.00000016586649
[0m[32m -0.00053519226885   0.00118057227397   0.00083690660783
[0m[32m -0.00053499480888   0.00118052150726  -0.00083695637778
[0m[32m  0.00132022444587  -0.00218940471923  -0.00000004496361
[0mTime for calculating XC forces components: 37.620 ms
 Cartesian force = 
 -0.00415819891736   0.00671112947456   0.00000232436089
  0.00154400700191   0.00087749492450  -0.00000062088899
  0.00092321126910   0.00037235011510   0.00118889929543
 -0.00109208695850  -0.00042679612936   0.00017350645600
  0.00092326676256   0.00037403284271  -0.00118867027307
 -0.00109194666700  -0.00042749957293  -0.00017377202583
  0.00135856844384  -0.00000512345512  -0.00000016336377
 -0.00075496236615  -0.00132282682158  -0.00000006869447
 -0.00229339371846  -0.00035721831083   0.00000009920671
  0.00496391731188  -0.00507440605672  -0.00000285490353
 -0.00007467327023  -0.00063708172093   0.00011602215103
 -0.00007090122746  -0.00063697127265  -0.00011370487102
 -0.00017680766412   0.00055291598325  -0.00000099644936
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.004 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.034 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.000 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.004 ms
======D2D: initiated sending and receiving took 0.362 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 0.002 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 0.039 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.393 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.003 ms
======D2D: initiated sending and receiving took 0.200 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.002 ms
======D2D: initiated sending and receiving took 0.181 ms
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.001 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.005 ms
======D2D: initiated sending and receiving took 0.998 ms
Time for printing density: 387.589 ms
The program took 457.277 s.
---------------------------------------
Begin Slurm Epilog: Jun-01-2023 11:28:21
Job ID:        2266652
Array Job ID:  _4294967294
User ID:       ssahoo41
Account:       gts-amedford6-joe
Job name:      molecule_functional
Resources:     cpu=12,mem=84G,node=1
Rsrc Used:     cput=01:38:00,vmem=8292K,walltime=00:08:10,mem=8156K,energy_used=0
Partition:     cpu-small
QOS:           inferno
Nodes:         atl1-1-02-017-8-1
---------------------------------------
